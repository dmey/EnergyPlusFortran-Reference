<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>SurfaceGeometry.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>SurfaceGeometry.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.8% of total for source files.">7001 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/SurfaceGeometry.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">SurfaceGeometry.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/surfacegeometry.html">SurfaceGeometry</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html#src">SurfaceGeometry.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~surfacegeometry.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilesurfacegeometryf90EfferentGraph" width="641pt" height="579pt"
 viewBox="0.00 0.00 641.00 579.18" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph" class="graph" transform="scale(.4867 .4867) rotate(0) translate(4 1186.0778)">
<title>sourcefile~~surfacegeometry.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1186.0778 1313.114,-1186.0778 1313.114,4 -4,4"/>
<!-- sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~surfacegeometry.f90</title>
<polygon fill="none" stroke="#000000" points="1309.125,-814.4127 1198.0811,-814.4127 1198.0811,-792.4019 1309.125,-792.4019 1309.125,-814.4127"/>
<text text-anchor="middle" x="1253.603" y="-800.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SurfaceGeometry.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1157.809,-936.4127 1043.4791,-936.4127 1043.4791,-914.4019 1157.809,-914.4019 1157.809,-936.4127"/>
<text text-anchor="middle" x="1100.644" y="-922.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1135.136,-914.3794C1144.3036,-910.6613 1153.9198,-906.0037 1162.092,-900.4073 1193.9909,-878.5629 1223.2128,-843.9426 1239.6767,-822.5092"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1242.5112,-824.5634 1245.7289,-814.4689 1236.9186,-820.3536 1242.5112,-824.5634"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="967.9384,-362.4127 874.6907,-362.4127 874.6907,-340.4019 967.9384,-340.4019 967.9384,-362.4127"/>
<text text-anchor="middle" x="921.3146" y="-348.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M925.4085,-340.2105C943.195,-293.3261 1016.6507,-117.5769 1100.644,-169.4073"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="774.1849,-714.4127 707.4474,-714.4127 707.4474,-692.4019 774.1849,-692.4019 774.1849,-714.4127"/>
<text text-anchor="middle" x="740.8162" y="-700.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M921.3146,-703.4073C997.9756,-725.2132 1024.6501,-679.3796 1100.644,-703.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.5067,-698.0022C811.3424,-693.3256 871.7328,-689.304 921.3146,-703.4073"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M921.3146,-703.4073C957.2478,-713.6284 977.158,-695.6176 1003.196,-722.4073 1059.451,-780.2861 987.6963,-838.2596 1039.196,-900.4073 1041.9656,-903.7495 1045.2514,-906.6494 1048.8415,-909.1649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1047.2778,-912.3058 1057.6708,-914.3638 1050.8296,-906.2738 1047.2778,-912.3058"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M765.4655,-692.3045C778.7271,-685.0787 794.2097,-674.3868 803.4331,-660.4073 848.3627,-592.3094 809.0594,-556.1268 839.4331,-480.4073 856.3207,-438.3078 887.1816,-394.8931 905.8134,-370.7043"/>
<polygon fill="#ff5900" stroke="#ff5900" points="908.67,-372.733 912.0759,-362.7005 903.1571,-368.4194 908.67,-372.733"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="976.4526,-753.4127 866.1765,-753.4127 866.1765,-731.4019 976.4526,-731.4019 976.4526,-753.4127"/>
<text text-anchor="middle" x="921.3146" y="-739.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M774.3435,-710.6515C798.4198,-715.8536 831.5534,-723.0128 860.267,-729.2169"/>
<polygon fill="#001dff" stroke="#001dff" points="859.7032,-732.6757 870.2169,-731.3667 861.1816,-725.8336 859.7032,-732.6757"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1156.4608,-581.4127 1044.8272,-581.4127 1044.8272,-559.4019 1156.4608,-559.4019 1156.4608,-581.4127"/>
<text text-anchor="middle" x="1100.644" y="-567.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M760.4817,-692.3871C773.5301,-684.5053 790.5578,-673.0816 803.4331,-660.4073 867.9192,-596.9282 831.3423,-484.7616 921.3146,-494.4073"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="620.0743,-314.4127 526.8163,-314.4127 526.8163,-292.4019 620.0743,-292.4019 620.0743,-314.4127"/>
<text text-anchor="middle" x="573.4453" y="-300.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.4048,-292.3542C642.7853,-249.045 847.5799,-94.1535 921.3146,-112.4073"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M606.6815,-314.4604C618.0759,-318.5209 630.8188,-323.3661 642.1992,-328.4073 687.5029,-348.4758 693.9596,-364.2941 740.8162,-380.4073"/>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M740.8162,-380.4073C790.4085,-397.4613 851.1783,-380.419 888.0365,-366.1903"/>
<polygon fill="#ff5900" stroke="#ff5900" points="889.3396,-369.4387 897.3197,-362.4696 886.7353,-362.9412 889.3396,-369.4387"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M577.2667,-314.525C588.0941,-346.1937 619.6513,-439.6682 642.1992,-518.4073 660.1232,-580.9992 640.9724,-606.9922 678.1992,-660.4073 685.8149,-671.3346 697.1679,-680.3328 708.1239,-687.2231"/>
<polygon fill="#ffb300" stroke="#ffb300" points="706.3521,-690.2415 716.7463,-692.2937 709.9006,-684.2075 706.3521,-690.2415"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M740.8162,-380.4073C769.0002,-390.0993 777.408,-389.8826 803.4331,-404.4073 860.9916,-436.5308 855.7743,-487.3809 921.3146,-494.4073"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M921.3146,-494.4073C979.7056,-500.6673 1041.4046,-533.4115 1075.0497,-553.8247"/>
<polygon fill="#9500ff" stroke="#9500ff" points="1073.4245,-556.935 1083.7694,-559.2231 1077.1093,-550.9833 1073.4245,-556.935"/>
</g>
<!-- sourcefile~datareportingflags.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datareportingflags.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datareportingflags.f90.html" xlink:title="DataReportingFlags.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1162.0401,-814.4127 1039.248,-814.4127 1039.248,-792.4019 1162.0401,-792.4019 1162.0401,-814.4127"/>
<text text-anchor="middle" x="1100.644" y="-800.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataReportingFlags.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datareportingflags.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~datareportingflags.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.4174,-803.4073C1170.7878,-803.4073 1179.4024,-803.4073 1187.8395,-803.4073"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1188.0146,-806.9074 1198.0146,-803.4073 1188.0146,-799.9074 1188.0146,-806.9074"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="798.2193,-84.4127 683.413,-84.4127 683.413,-62.4019 798.2193,-62.4019 798.2193,-84.4127"/>
<text text-anchor="middle" x="740.8162" y="-70.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9117,-84.4209C831.7595,-91.8061 879.4579,-102.0452 921.3146,-112.4073"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="803.5503,-43.4127 678.0821,-43.4127 678.0821,-21.4019 803.5503,-21.4019 803.5503,-43.4127"/>
<text text-anchor="middle" x="740.8162" y="-29.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M776.5703,-43.4346C785.4386,-46.4326 794.8565,-49.8435 803.4331,-53.4073 857.5358,-75.8883 864.4438,-98.3283 921.3146,-112.4073"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-565.4127 -.2403,-565.4127 -.2403,-543.4019 130.719,-543.4019 130.719,-565.4127"/>
<text text-anchor="middle" x="65.2394" y="-551.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-150.4073C267.3095,-114.4469 266.0245,-88.1459 317.2024,-64.4073 421.3177,-16.114 458.675,-32.4967 573.4453,-32.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573.4453,-32.4073C675.968,-28.3592 707.113,22.9441 803.4331,-12.4073 867.9301,-36.079 854.7134,-95.5403 921.3146,-112.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1100.644,-169.4073C1209.5418,-236.6057 1245.3822,-679.3732 1252.282,-782.1327"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1248.7962,-782.4666 1252.9383,-792.2182 1255.7815,-782.012 1248.7962,-782.4666"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M921.3146,-112.4073C1002.5274,-132.3736 1029.4726,-125.489 1100.644,-169.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.8357,-543.126C69.3263,-489.3696 91.839,-257.3957 223.8406,-150.4073"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M392.9469,-1157.4073C470.9093,-1138.5035 493.2468,-1155.4846 573.4453,-1157.4073"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M573.4453,-264.4073C679.3583,-288.0061 802.3115,-319.8011 870.0013,-337.6913"/>
<polygon fill="#ff5900" stroke="#ff5900" points="869.4163,-341.157 879.9791,-340.3336 871.2083,-334.3903 869.4163,-341.157"/>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M223.8406,-150.4073C256.1878,-125.4466 533.1745,-257.5056 573.4453,-264.4073"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M223.8406,-496.4073C412.8743,-457.7181 486.0088,-499.115 642.1992,-612.4073 663.7853,-628.0647 658.9536,-641.9488 678.1992,-660.4073 688.4878,-670.2751 701.2527,-679.4766 712.5679,-686.815"/>
<polygon fill="#ffb300" stroke="#ffb300" points="710.928,-689.9182 721.2567,-692.2779 714.6539,-683.9921 710.928,-689.9182"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M88.7776,-543.2947C119.1965,-529.5251 174.1612,-506.6324 223.8406,-496.4073"/>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M223.8406,-496.4073C310.1848,-478.6359 243.2444,-369.3798 317.2024,-321.4073 376.7281,-282.7963 461.2354,-285.2247 516.6827,-292.5953"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="516.2914,-296.0749 526.6852,-294.0203 517.2788,-289.1448 516.2914,-296.0749"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M573.4453,-32.4073C596.7301,-32.3892 653.582,-47.5526 694.5695,-59.4416"/>
<polygon fill="#3cff00" stroke="#3cff00" points="693.7763,-62.8562 704.3568,-62.3052 695.7421,-56.1378 693.7763,-62.8562"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M573.4453,-32.4073C604.3767,-32.3832 638.5236,-32.3792 667.8637,-32.3827"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="668.0274,-35.8826 678.028,-32.3842 668.0285,-28.8826 668.0274,-35.8826"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-681.4127 180.0456,-681.4127 180.0456,-659.4019 267.6355,-659.4019 267.6355,-681.4127"/>
<text text-anchor="middle" x="223.8406" y="-667.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M80.4467,-565.5299C108.2039,-585.8313 167.2529,-629.0194 200.2618,-653.1619"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="198.3085,-656.0695 208.4462,-659.148 202.4409,-650.4194 198.3085,-656.0695"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-275.4127 168.8556,-275.4127 168.8556,-253.4019 278.8255,-253.4019 278.8255,-275.4127"/>
<text text-anchor="middle" x="223.8406" y="-261.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M71.2631,-543.3931C94.9629,-500.0583 181.9971,-340.9175 212.8811,-284.4466"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="216.0833,-285.8856 217.8109,-275.4325 209.9418,-282.5267 216.0833,-285.8856"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.2469,-1013.4127 338.6469,-1013.4127 338.6469,-991.4019 447.2469,-991.4019 447.2469,-1013.4127"/>
<text text-anchor="middle" x="392.9469" y="-999.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0078ff" stroke-dasharray="5,2" d="M223.8406,-925.4073C262.4749,-953.0347 273.709,-958.323 317.2024,-977.4073 326.0492,-981.2892 335.6996,-984.912 345.0584,-988.1286"/>
<polygon fill="#0078ff" stroke="#0078ff" points="344.0663,-991.4871 354.6599,-991.3274 346.2789,-984.846 344.0663,-991.4871"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M223.8406,-1157.4073C285.897,-1199.8076 320.833,-1178.582 392.9469,-1157.4073"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M392.9469,-1157.4073C426.2482,-1147.6291 443.3314,-1162.1025 468.6914,-1138.4073 506.5869,-1102.9995 473.6263,-1068.9373 504.6914,-1027.4073 560.2196,-953.1735 808.5217,-806.9831 893.0393,-758.4739"/>
<polygon fill="#001dff" stroke="#001dff" points="894.895,-761.4446 901.835,-753.4392 891.4175,-755.3694 894.895,-761.4446"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="464.7845,-122.4127 321.1093,-122.4127 321.1093,-100.4019 464.7845,-100.4019 464.7845,-122.4127"/>
<text text-anchor="middle" x="392.9469" y="-108.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M223.8406,-150.4073C248.5931,-131.307 281.0643,-121.2833 310.9297,-116.1161"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="311.6071,-119.5527 320.9432,-114.5439 310.5213,-112.6375 311.6071,-119.5527"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M740.8162,-494.4073C820.8231,-500.2712 841.497,-486.3668 921.3146,-494.4073"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M223.8406,-496.4073C280.904,-484.6844 263.3001,-426.5028 317.2024,-404.4073 379.5,-378.8705 402.2197,-393.7004 468.6914,-404.4073 594.4577,-424.6651 613.7696,-485.0957 740.8162,-494.4073"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="623.0044,-856.4127 523.8862,-856.4127 523.8862,-834.4019 623.0044,-834.4019 623.0044,-856.4127"/>
<text text-anchor="middle" x="573.4453" y="-842.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M392.9469,-925.4073C425.5706,-913.5633 438.1314,-922.8595 468.6914,-906.4073 487.803,-896.1185 486.3519,-885.0165 504.6914,-873.4073 512.5287,-868.4462 521.3933,-864.0615 530.0881,-860.3214"/>
<polygon fill="#f000ff" stroke="#f000ff" points="531.4649,-863.5398 539.3996,-856.519 528.8186,-857.0592 531.4649,-863.5398"/>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M223.8406,-925.4073C284.9759,-969.1252 322.3002,-951.0555 392.9469,-925.4073"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="441.7467,-662.4127 344.1471,-662.4127 344.1471,-640.4019 441.7467,-640.4019 441.7467,-662.4127"/>
<text text-anchor="middle" x="392.9469" y="-648.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M223.8406,-496.4073C282.4346,-484.2799 272.5744,-553.5492 317.2024,-593.4073 333.6213,-608.0714 353.409,-623.1431 368.6413,-634.2463"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="366.8657,-637.281 377.0236,-640.292 370.9605,-631.6036 366.8657,-637.281"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1003.0777,-180.4127 839.5515,-180.4127 839.5515,-158.4019 1003.0777,-158.4019 1003.0777,-180.4127"/>
<text text-anchor="middle" x="921.3146" y="-166.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M223.8406,-150.4073C269.7623,-113.2967 650.2784,-143.7319 829.1113,-160.3539"/>
<polygon fill="#ff005a" stroke="#ff005a" points="829.0118,-163.8597 839.2942,-161.3057 829.6633,-156.8901 829.0118,-163.8597"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.6467,-1129.4127 328.2471,-1129.4127 328.2471,-1107.4019 457.6467,-1107.4019 457.6467,-1129.4127"/>
<text text-anchor="middle" x="392.9469" y="-1115.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M66.2351,-565.4188C73.3543,-641.3143 119.2686,-1085.9581 223.8406,-1157.4073"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1157.4073C234.0886,-1164.4093 301.2064,-1146.2393 347.7375,-1132.4012"/>
<polygon fill="#00ffff" stroke="#00ffff" points="348.7537,-1135.7505 357.3263,-1129.5246 346.7423,-1129.0456 348.7537,-1135.7505"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450.6399,-584.4127 335.2539,-584.4127 335.2539,-562.4019 450.6399,-562.4019 450.6399,-584.4127"/>
<text text-anchor="middle" x="392.9469" y="-570.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-496.4073C281.59,-484.4547 343.097,-528.8396 373.5453,-555.1948"/>
<polygon fill="#ff0000" stroke="#ff0000" points="371.4865,-558.0482 381.2808,-562.0884 376.1437,-552.8223 371.4865,-558.0482"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="641.954,-772.4127 504.9366,-772.4127 504.9366,-750.4019 641.954,-750.4019 641.954,-772.4127"/>
<text text-anchor="middle" x="573.4453" y="-758.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-496.4073C310.1651,-478.5405 248.581,-616.0697 317.2024,-671.4073 371.683,-715.3416 404.5754,-686.345 468.6914,-714.4073 485.8693,-721.9257 487.796,-728.274 504.6914,-736.4073 512.5056,-740.169 521.0425,-743.7025 529.3608,-746.8621"/>
<polygon fill="#00ffff" stroke="#00ffff" points="528.3753,-750.2286 538.9689,-750.3905 530.7884,-743.6577 528.3753,-750.2286"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="451.4146,-352.4127 334.4792,-352.4127 334.4792,-330.4019 451.4146,-330.4019 451.4146,-352.4127"/>
<text text-anchor="middle" x="392.9469" y="-338.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-496.4073C293.4982,-481.9901 259.8666,-408.5101 317.2024,-366.4073 322.6019,-362.4424 328.6654,-359.0832 334.9492,-356.2424"/>
<polygon fill="#ff0000" stroke="#ff0000" points="336.326,-359.4609 344.2616,-352.4412 333.6805,-352.98 336.326,-359.4609"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="468.9367,-468.4127 316.9571,-468.4127 316.9571,-446.4019 468.9367,-446.4019 468.9367,-468.4127"/>
<text text-anchor="middle" x="392.9469" y="-454.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-496.4073C261.9423,-488.5213 304.6362,-478.667 337.5932,-470.8371"/>
<polygon fill="#ff0000" stroke="#ff0000" points="338.5773,-474.2006 347.4928,-468.4765 336.9536,-467.3915 338.5773,-474.2006"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="433.2384,-897.4127 352.6554,-897.4127 352.6554,-875.4019 433.2384,-875.4019 433.2384,-897.4127"/>
<text text-anchor="middle" x="392.9469" y="-883.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M66.0421,-565.7215C70.3892,-617.5798 95.9231,-833.9336 223.8406,-925.4073"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-925.4073C233.9651,-932.6474 301.479,-914.2909 348.0749,-900.3659"/>
<polygon fill="#0000ff" stroke="#0000ff" points="349.1082,-903.7101 357.6723,-897.4726 347.0876,-897.008 349.1082,-903.7101"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.0588,-681.5899C235.5239,-728.1209 274.0248,-905.5454 317.2024,-939.4073 407.2089,-1009.9946 459.0611,-963.4073 573.4453,-963.4073 573.4453,-963.4073 573.4453,-963.4073 740.8162,-963.4073 857.9163,-963.4073 896.4663,-987.5861 1003.196,-939.4073 1023.2549,-930.3526 1020.1893,-916.5018 1039.196,-905.4073 1063.8839,-890.9967 1074.3705,-897.6704 1100.644,-886.4073"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.4493,-681.706C240.1136,-740.679 303.3373,-1010.8991 317.2024,-1022.4073 405.0755,-1095.3428 460.9145,-1021.9628 573.4453,-1041.4073"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M740.8162,-456.4073C800.3442,-432.2879 863.9278,-391.263 897.4425,-368.2839"/>
<polygon fill="#ff5900" stroke="#ff5900" points="899.4519,-371.1498 905.6827,-362.5808 895.4681,-365.3939 899.4519,-371.1498"/>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M229.6704,-659.1923C242.3573,-635.8947 274.7709,-582.0501 317.2024,-553.4073 477.2883,-445.3438 561.8063,-528.9379 740.8162,-456.4073"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M392.9469,-728.4073C426.0342,-738.8869 438.2547,-730.7281 468.6914,-747.4073 487.9913,-757.9836 485.5189,-770.6017 504.6914,-781.4073 532.3096,-796.973 541.7451,-800.0143 573.4453,-800.4073"/>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M573.4453,-800.4073C605.1455,-800.8003 613.9256,-795.7482 642.1992,-781.4073 673.2019,-765.6822 703.7948,-739.3376 722.4906,-721.6708"/>
<polygon fill="#ffb300" stroke="#ffb300" points="724.967,-724.145 729.7412,-714.6868 720.1108,-719.1034 724.967,-724.145"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M227.6847,-659.1197C242.9197,-614.6485 299.1064,-453.2063 317.2024,-437.4073 343.3473,-414.5812 365.1932,-439.2477 392.9469,-418.4073"/>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M392.9469,-418.4073C444.2236,-379.9035 508.3941,-341.0507 544.7712,-319.8177"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="546.9369,-322.6075 553.8285,-314.5604 543.4228,-316.5535 546.9369,-322.6075"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0078ff" stroke-dasharray="5,2" d="M225.8087,-681.5064C234.8233,-731.2014 273.6065,-932.7713 317.2024,-977.4073 320.858,-981.1502 325.0844,-984.3328 329.6335,-987.039"/>
<polygon fill="#0078ff" stroke="#0078ff" points="328.2165,-990.2454 338.7141,-991.678 331.4012,-984.0117 328.2165,-990.2454"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M573.4453,-800.4073C648.7883,-801.3413 665.5588,-777.1172 740.8162,-773.4073"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M228.6864,-659.401C239.7599,-633.7926 267.051,-568.0074 281.2024,-510.4073 309.0356,-397.1183 280.6982,-361.2068 317.2024,-250.4073 332.1376,-205.0752 361.6688,-157.2777 379.1182,-131.2232"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="382.2181,-132.8891 384.9509,-122.6528 376.4311,-128.9507 382.2181,-132.8891"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M247.6433,-659.2982C266.2889,-650.8826 293.0306,-639.4373 317.2024,-631.4073 383.0769,-609.5235 402.3231,-613.7446 468.6914,-593.4073 591.7432,-555.7006 612.1245,-492.9978 740.8162,-494.4073"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M229.3326,-681.4945C241.5983,-705.0336 273.6063,-760.0779 317.2024,-787.4073 333.778,-797.7982 443.2213,-820.3109 513.6142,-834.0315"/>
<polygon fill="#f000ff" stroke="#f000ff" points="513.2172,-837.5197 523.701,-835.9895 514.5512,-830.6479 513.2172,-837.5197"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M392.9469,-418.4073C487.7476,-347.2211 534.6458,-373.2764 642.1992,-323.4073 737.717,-279.1188 845.408,-215.6103 894.4321,-185.9049"/>
<polygon fill="#ff005a" stroke="#ff005a" points="896.4351,-188.7833 903.1607,-180.5969 892.7979,-182.8023 896.4351,-188.7833"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M235.5973,-659.1845C252.4537,-643.6234 285.0186,-615.4856 317.2024,-598.4073 324.7635,-594.395 333.0892,-590.8628 341.3695,-587.8128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.7265,-591.0464 351.0204,-584.4538 340.4256,-584.4354 342.7265,-591.0464"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M392.9469,-728.4073C425.5569,-738.7357 462.5669,-746.2056 494.5484,-751.3978"/>
<polygon fill="#00ffff" stroke="#00ffff" points="494.3204,-754.905 504.7433,-753.0043 495.41,-747.9903 494.3204,-754.905"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M253.1618,-681.4469C271.4982,-688.2606 295.6466,-697.0709 317.2024,-704.4073 350.6329,-715.7852 359.2814,-717.7446 392.9469,-728.4073"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.9394,-659.1794C237.4418,-633.105 261.6562,-566.4072 281.2024,-510.4073 297.5984,-463.4326 289.019,-445.4092 317.2024,-404.4073 330.037,-385.7353 349.8703,-369.5182 366.0227,-358.2151"/>
<polygon fill="#ff0000" stroke="#ff0000" points="368.2212,-360.9538 374.5497,-352.4568 364.3036,-355.1527 368.2212,-360.9538"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.3077,-659.0475C242.2415,-632.8495 276.6938,-566.8867 317.2024,-520.4073 332.4684,-502.8912 352.8609,-486.2251 368.6407,-474.4391"/>
<polygon fill="#ff0000" stroke="#ff0000" points="370.866,-477.1478 376.8709,-468.419 366.7333,-471.498 370.866,-477.1478"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.1674,-778.4127 328.7264,-778.4127 328.7264,-756.4019 457.1674,-756.4019 457.1674,-778.4127"/>
<text text-anchor="middle" x="392.9469" y="-764.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M235.5973,-681.6301C252.4537,-697.1912 285.0186,-725.3291 317.2024,-742.4073 324.7635,-746.4196 333.0892,-749.9518 341.3695,-753.0019"/>
<polygon fill="#ff0000" stroke="#ff0000" points="340.4256,-756.3792 351.0204,-756.3608 342.7265,-749.7682 340.4256,-756.3792"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="437.4115,-856.4127 348.4823,-856.4127 348.4823,-834.4019 437.4115,-834.4019 437.4115,-856.4127"/>
<text text-anchor="middle" x="392.9469" y="-842.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.7437,-681.6718C237.935,-709.441 268.0165,-781.7246 317.2024,-820.4073 323.7027,-825.5195 331.2921,-829.6071 339.1088,-832.8698"/>
<polygon fill="#00ff00" stroke="#00ff00" points="338.1057,-836.2314 348.6982,-836.454 340.5565,-829.6744 338.1057,-836.2314"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M225.8533,-681.6504C232.4357,-715.0561 256.4945,-814.5469 317.2024,-865.4073 324.5777,-871.5863 333.6361,-875.9546 342.8911,-879.0409"/>
<polygon fill="#0000ff" stroke="#0000ff" points="341.9668,-882.4169 352.5445,-881.8153 343.9003,-875.6892 341.9668,-882.4169"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M230.6127,-253.1391C241.5898,-234.7573 263.7937,-197.0866 281.2024,-164.4073 298.2106,-132.4798 286.4823,-110.5102 317.2024,-91.4073 414.2087,-31.0852 459.3974,-104.9229 573.4453,-111.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573.4453,-111.4073C727.8922,-118.4889 771.2558,-75.1732 921.3146,-112.4073"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M392.9469,-264.4073C473.0523,-268.7218 495.1439,-246.9608 573.4453,-264.4073"/>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M278.7151,-262.9155C311.8232,-262.3867 354.8358,-262.3546 392.9469,-264.4073"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M392.9469,-264.4073C439.9126,-266.9369 492.3269,-279.3754 528.5206,-289.5349"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="527.7038,-292.9416 538.281,-292.3298 529.6309,-286.2121 527.7038,-292.9416"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M264.6628,-253.3547C391.5024,-221.6887 783.4049,-144.399 1003.196,-331.4073 1071.2972,-389.3509 1092.4397,-502.1765 1098.4527,-549.1194"/>
<polygon fill="#9500ff" stroke="#9500ff" points="1095.008,-549.7956 1099.6493,-559.3197 1101.9603,-548.98 1095.008,-549.7956"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M248.0694,-275.4395C277.3283,-288.7621 326.6962,-311.2411 359.5513,-326.2011"/>
<polygon fill="#ff0000" stroke="#ff0000" points="358.2117,-329.4369 368.763,-330.3956 361.1125,-323.0662 358.2117,-329.4369"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.9833,-1013.5404C434.9265,-1025.3416 471.4323,-1043.8393 504.6914,-1055.4073 714.6252,-1128.4253 796.6424,-1177.5014 1003.196,-1095.4073 1133.1662,-1043.7511 1218.0689,-881.1942 1244.6598,-823.7559"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1247.8724,-825.1462 1248.816,-814.5934 1241.4976,-822.2545 1247.8724,-825.1462"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573.4453,-1041.4073C648.8104,-1054.4299 664.3356,-1080.9504 740.8162,-1081.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M921.3146,-1081.4073C991.4738,-1046.4967 1056.2266,-977.5344 1084.9857,-944.2521"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1087.6824,-946.4837 1091.5032,-936.6017 1082.3539,-941.9442 1087.6824,-946.4837"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M740.8162,-1081.4073C821.0362,-1081.8866 849.4932,-1117.145 921.3146,-1081.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.1112,-1013.4938C475.4572,-1021.9524 527.4797,-1033.4648 573.4453,-1041.4073"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M573.4453,-887.4073C596.5071,-865.1025 619.3127,-887.892 642.1992,-865.4073 677.6908,-830.5389 650.7557,-800.908 678.1992,-759.4073 688.2296,-744.2391 703.3437,-730.5618 716.2098,-720.5214"/>
<polygon fill="#ffb300" stroke="#ffb300" points="718.3719,-723.2748 724.2641,-714.4695 714.1669,-717.6785 718.3719,-723.2748"/>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M406.2914,-991.3337C434.7491,-967.7473 499.2588,-914.4435 504.6914,-911.4073 532.9439,-895.6174 550.1808,-909.9082 573.4453,-887.4073"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M409.5802,-991.3914C426.0677,-979.8704 451.3101,-960.5456 468.6914,-939.4073 489.913,-913.5986 479.7726,-895.667 504.6914,-873.4073 510.3083,-868.3898 516.9435,-864.204 523.8394,-860.7316"/>
<polygon fill="#f000ff" stroke="#f000ff" points="525.6706,-863.7443 533.3332,-856.4276 522.7803,-857.3689 525.6706,-863.7443"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M961.923,-731.3445C1010.6742,-718.4129 1087.5431,-699.2651 1100.644,-703.4073"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M926.8771,-753.6119C941.4886,-781.9927 983.6894,-857.497 1039.196,-900.4073 1043.9243,-904.0625 1049.2603,-907.2631 1054.7636,-910.0432"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1053.5568,-913.3403 1064.1053,-914.3308 1056.4769,-906.9784 1053.5568,-913.3403"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M976.2532,-731.3841C985.8008,-727.9112 995.2136,-723.3614 1003.196,-717.4073 1048.18,-683.8543 1078.7014,-622.997 1092.4113,-591.1304"/>
<polygon fill="#9500ff" stroke="#9500ff" points="1095.8016,-592.0934 1096.4129,-581.5162 1089.339,-589.4036 1095.8016,-592.0934"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M465.0226,-109.5355C498.0849,-109.1577 537.7793,-109.3795 573.4453,-111.4073"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1108.0216,-581.6454C1132.3023,-618.6318 1209.9288,-736.8791 1240.7822,-783.8775"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1237.8857,-785.8431 1246.2995,-792.282 1243.7375,-782.0016 1237.8857,-785.8431"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M921.3146,-925.4073C962.0373,-923.1998 1063.1605,-902.4759 1100.644,-886.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1100.644,-886.4073C1146.6972,-866.665 1197.2752,-837.6685 1227.1879,-819.6934"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1229.0383,-822.6646 1235.7797,-814.4913 1225.4127,-816.6767 1229.0383,-822.6646"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M589.2618,-856.4416C609.0519,-869.6203 644.4554,-891.166 678.1992,-901.4073 782.096,-932.9401 812.8973,-931.2846 921.3146,-925.4073"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M921.3146,-925.4073C958.2218,-923.4066 999.4644,-923.2615 1033.0842,-923.6813"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1033.2104,-927.1834 1043.2599,-923.8283 1033.3116,-920.1841 1033.2104,-927.1834"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M607.8358,-834.3818C619.5794,-829.5081 632.2474,-822.9165 642.1992,-814.4073 664.4042,-795.4213 659.1481,-781.5565 678.1992,-759.4073 690.3694,-745.258 706.019,-731.2614 718.6284,-720.8004"/>
<polygon fill="#ffb300" stroke="#ffb300" points="720.8603,-723.4966 726.4083,-714.4705 716.4425,-718.0667 720.8603,-723.4966"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M623.2262,-849.2439C709.6646,-853.2346 889.1644,-849.4036 1003.196,-762.4073 1031.9569,-740.4653 1022.8966,-721.7023 1039.196,-689.4073 1056.7965,-654.5346 1077.7598,-614.1833 1090.0923,-590.5625"/>
<polygon fill="#9500ff" stroke="#9500ff" points="1093.2839,-592.0121 1094.8143,-581.5283 1087.0802,-588.7695 1093.2839,-592.0121"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M740.8162,-646.4073C898.0547,-607.7636 946.2595,-654.5941 1100.644,-703.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1100.644,-703.4073C1154.1654,-720.1112 1206.683,-761.4059 1234.0785,-785.3812"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1231.9542,-788.1763 1241.7473,-792.2193 1236.6129,-782.9517 1231.9542,-788.1763"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573.4453,-722.4073C602.9527,-733.9992 615.8242,-723.8171 642.1992,-741.4073 663.7975,-755.8118 656.9389,-772.5086 678.1992,-787.4073 788.6242,-864.7904 945.1586,-900.8327 1033.384,-915.9149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1032.8336,-919.3713 1043.2736,-917.5664 1033.9867,-912.4669 1032.8336,-919.3713"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M409.1019,-640.3438C451.7164,-611.4694 571.2534,-532.4671 678.1992,-480.4073 704.9968,-467.3626 713.6952,-468.7655 740.8162,-456.4073"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M573.4453,-722.4073C615.6843,-739.0008 668.2153,-728.4955 703.04,-717.6475"/>
<polygon fill="#ffb300" stroke="#ffb300" points="704.3929,-720.8874 712.8083,-714.4507 702.2157,-714.2346 704.3929,-720.8874"/>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M432.1417,-662.4505C444.0969,-666.3194 457.1308,-671.0539 468.6914,-676.4073 485.7067,-684.2867 487.7439,-690.3832 504.6914,-698.4073 533.9438,-712.2574 543.321,-710.573 573.4453,-722.4073"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M740.8162,-773.4073C782.8709,-771.3342 829.7167,-763.1104 865.143,-755.6542"/>
<polygon fill="#001dff" stroke="#001dff" points="866.243,-758.9978 875.2847,-753.4753 864.7725,-752.154 866.243,-758.9978"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M573.4453,-722.4073C602.9527,-733.9992 611.8358,-732.2904 642.1992,-741.4073 686.3322,-754.6586 694.7926,-775.6761 740.8162,-773.4073"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M441.9455,-656.3186C509.8429,-661.8586 636.0232,-667.5695 740.8162,-646.4073"/>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M740.8162,-646.4073C842.6627,-621.377 817.0348,-483.2277 921.3146,-494.4073"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M411.2542,-662.5191C428.2829,-673.7036 453.2798,-692.4165 468.6914,-714.4073 495.8012,-753.0902 472.6183,-779.7284 504.6914,-814.4073 510.5063,-820.6946 517.8379,-825.7928 525.5316,-829.899"/>
<polygon fill="#f000ff" stroke="#f000ff" points="524.1301,-833.1085 534.6605,-834.2756 527.1563,-826.7964 524.1301,-833.1085"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M442.0194,-661.936C451.5067,-665.478 460.9048,-670.18 468.6914,-676.4073 492.9782,-695.8306 480.6983,-716.6225 504.6914,-736.4073 509.274,-740.1862 514.4768,-743.4187 519.9202,-746.1784"/>
<polygon fill="#00ffff" stroke="#00ffff" points="518.687,-749.4618 529.2411,-750.3893 521.5689,-743.0826 518.687,-749.4618"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~surfacegeometry.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M960.1713,-158.3714C998.7993,-149.7879 1058.2518,-143.248 1100.644,-169.4073"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M956.7025,-180.5422C973.0107,-187.3431 991.3342,-197.6332 1003.196,-212.4073 1046.363,-266.1722 1085.4806,-480.3736 1097.1336,-549.0797"/>
<polygon fill="#9500ff" stroke="#9500ff" points="1093.7162,-549.8645 1098.8204,-559.1488 1100.62,-548.7079 1093.7162,-549.8645"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1033.4127 166.6166,-1033.4127 166.6166,-1011.4019 281.0645,-1011.4019 281.0645,-1033.4127"/>
<text text-anchor="middle" x="223.8406" y="-1019.2573" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M392.9469,-1079.4073C547.4401,-1073.3701 586.2078,-1080.4836 740.8162,-1081.4073"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M242.4321,-1033.645C272.8659,-1050.8815 335.6746,-1081.6454 392.9469,-1079.4073"/>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M392.9469,-1079.4073C435.0462,-1077.7622 444.2236,-1056.7058 468.6914,-1022.4073 498.8109,-980.1865 468.4285,-948.4853 504.6914,-911.4073 527.3215,-888.2685 550.1808,-909.9082 573.4453,-887.4073"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M239.2582,-1011.0892C267.9558,-990.6055 332.1823,-947.4678 392.9469,-925.4073"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M235.6276,-1033.4628C252.52,-1048.7942 285.1274,-1076.5253 317.2024,-1093.4073 324.777,-1097.394 333.1097,-1100.913 341.3928,-1103.9578"/>
<polygon fill="#00ffff" stroke="#00ffff" points="340.4504,-1107.3356 351.0452,-1107.3138 342.7493,-1100.7238 340.4504,-1107.3356"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M428.1112,-1129.4848C464.1615,-1140.0128 522.064,-1154.6399 573.4453,-1157.4073"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573.4453,-1157.4073C731.4716,-1165.9187 779.6304,-1151.908 921.3146,-1081.4073"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M450.1792,-1107.2679C457.1954,-1103.8155 463.6537,-1099.3029 468.6914,-1093.4073 533.0556,-1018.0831 442.9226,-950.8742 504.6914,-873.4073 508.5005,-868.6302 513.2566,-864.6621 518.4783,-861.3673"/>
<polygon fill="#f000ff" stroke="#f000ff" points="520.4822,-864.2631 527.6206,-856.434 517.158,-858.1027 520.4822,-864.2631"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M422.606,-584.491C485.3759,-607.9484 631.6362,-662.6064 701.8465,-688.8442"/>
<polygon fill="#ffb300" stroke="#ffb300" points="700.6396,-692.1295 711.2321,-692.3516 703.09,-685.5724 700.6396,-692.1295"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M605.3204,-750.3614C631.9922,-741.1187 670.2398,-727.8646 699.3015,-717.7936"/>
<polygon fill="#ffb300" stroke="#ffb300" points="700.4724,-721.0922 708.7751,-714.5107 698.1803,-714.478 700.4724,-721.0922"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M445.6397,-330.314C468.0284,-325.6005 494.1702,-320.097 516.9569,-315.2997"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="517.7651,-318.7064 526.8296,-313.2212 516.323,-311.8565 517.7651,-318.7064"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M451.2681,-338.294C503.2023,-337.5786 580.3175,-341.6548 642.1992,-366.4073 661.0193,-373.9353 660.6658,-384.2366 678.1992,-394.4073 779.2618,-453.031 805.1454,-481.9531 921.3146,-494.4073"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M457.8036,-468.4584C527.5088,-479.3611 641.6669,-494.4073 740.8162,-494.4073"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M432.1417,-778.4505C444.0969,-782.3194 457.1308,-787.0539 468.6914,-792.4073 485.7067,-800.2867 488.1121,-805.6477 504.6914,-814.4073 515.2573,-819.9898 527.028,-825.5319 537.8015,-830.3529"/>
<polygon fill="#f000ff" stroke="#f000ff" points="536.3948,-833.5577 546.9572,-834.3868 539.2172,-827.1519 536.3948,-833.5577"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M437.5645,-845.4073C460.5031,-845.4073 488.7788,-845.4073 513.5862,-845.4073"/>
<polygon fill="#f000ff" stroke="#f000ff" points="513.6194,-848.9074 523.6194,-845.4073 513.6193,-841.9074 513.6194,-848.9074"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M433.4543,-877.2061C457.4172,-871.763 488.184,-864.7743 514.7687,-858.7356"/>
<polygon fill="#f000ff" stroke="#f000ff" points="515.7536,-862.1012 524.7299,-856.473 514.203,-855.275 515.7536,-862.1012"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilesurfacegeometryf90EfferentGraph = svgPanZoom('#sourcefilesurfacegeometryf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~surfacegeometry.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilesurfacegeometryf90AfferentGraph" width="641pt" height="65pt"
 viewBox="0.00 0.00 641.00 64.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph" class="graph" transform="scale(.9047 .9047) rotate(0) translate(4 67.5)">
<title>sourcefile~~surfacegeometry.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-67.5 704.53,-67.5 704.53,4 -4,4"/>
<!-- sourcefile~surfacegeometry.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~surfacegeometry.f90</title>
<polygon fill="none" stroke="#000000" points="111.033,-42.2554 -.011,-42.2554 -.011,-20.2446 111.033,-20.2446 111.033,-42.2554"/>
<text text-anchor="middle" x="55.511" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SurfaceGeometry.f90</text>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="277.2795,-42.2554 147.2688,-42.2554 147.2688,-20.2446 277.2795,-20.2446 277.2795,-42.2554"/>
<text text-anchor="middle" x="212.2742" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~surfacegeometry.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~surfacegeometry.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M111.2212,-31.25C119.5706,-31.25 128.2956,-31.25 136.9702,-31.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="137.1048,-34.7501 147.1048,-31.25 137.1047,-27.7501 137.1048,-34.7501"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="412.4945,-62.2554 313.537,-62.2554 313.537,-40.2446 412.4945,-40.2446 412.4945,-62.2554"/>
<text text-anchor="middle" x="363.0157" y="-48.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.5149,-39.906C286.0003,-41.0318 294.6601,-42.1807 303.0536,-43.2944"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.7566,-46.7856 313.1301,-44.6313 303.6773,-39.8464 302.7566,-46.7856"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="568.1126,-42.2554 448.3022,-42.2554 448.3022,-20.2446 568.1126,-20.2446 568.1126,-42.2554"/>
<text text-anchor="middle" x="508.2074" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.5843,-31.25C325.0984,-31.25 389.3549,-31.25 437.9743,-31.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="438.1002,-34.7501 448.1001,-31.25 438.1001,-27.7501 438.1002,-34.7501"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.5764,-44.4231C420.8428,-43.2844 429.5537,-42.0845 438.2151,-40.8914"/>
<polygon fill="#ff0000" stroke="#ff0000" points="438.9017,-44.3299 448.3305,-39.498 437.9464,-37.3954 438.9017,-44.3299"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="693.9284,-63.2554 610.5113,-63.2554 610.5113,-41.2446 693.9284,-41.2446 693.9284,-63.2554"/>
<text text-anchor="middle" x="652.2198" y="-49.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M568.0305,-39.9735C578.6951,-41.5286 589.727,-43.1372 600.1533,-44.6576"/>
<polygon fill="#00ffff" stroke="#00ffff" points="599.9414,-48.1637 610.3418,-46.1433 600.9515,-41.2369 599.9414,-48.1637"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~surfacegeometry.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="700.341,-22.2554 604.0987,-22.2554 604.0987,-.2446 700.341,-.2446 700.341,-22.2554"/>
<text text-anchor="middle" x="652.2198" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~surfacegeometry.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M568.0305,-22.942C576.4915,-21.7669 585.1835,-20.5598 593.621,-19.388"/>
<polygon fill="#00ffff" stroke="#00ffff" points="594.3305,-22.8232 603.7539,-17.9808 593.3675,-15.8897 594.3305,-22.8232"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilesurfacegeometryf90AfferentGraph = svgPanZoom('#sourcefilesurfacegeometryf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/surfacegeometry.html">SurfaceGeometry</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html#src">SurfaceGeometry.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">SurfaceGeometry</span>
<a name="ln-2"></a>
<a name="ln-3"></a>  <span class="c">! Module containing the routines dealing with the Surface Geometry</span>
<a name="ln-4"></a>
<a name="ln-5"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>  <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7"></a>  <span class="c">!       DATE WRITTEN   June 2000</span>
<a name="ln-8"></a>  <span class="c">!       MODIFIED       DJS (PSU Dec 2006) to add ecoroof</span>
<a name="ln-9"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10"></a>
<a name="ln-11"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-12"></a>  <span class="c">! This module performs the functions required of the surface geometry.</span>
<a name="ln-13"></a>
<a name="ln-14"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15"></a>  <span class="c">! na</span>
<a name="ln-16"></a>
<a name="ln-17"></a>  <span class="c">! REFERENCES: none</span>
<a name="ln-18"></a>
<a name="ln-19"></a>  <span class="c">! OTHER NOTES: none</span>
<a name="ln-20"></a>
<a name="ln-21"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-22"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-23"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-24"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-25"></a><span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-26"></a><span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-27"></a><span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-28"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataWindowEquivalentLayer</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CFSMAXNL</span>
<a name="ln-30"></a>
<a name="ln-31"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-32"></a>  <span class="c">! na</span>
<a name="ln-33"></a>
<a name="ln-34"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-35"></a>
<a name="ln-36"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-37"></a>
<a name="ln-38"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-39"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-40"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSurfCls</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;WALL &#39;</span><span class="p">,</span><span class="s1">&#39;FLOOR&#39;</span><span class="p">,</span><span class="s1">&#39;ROOF &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-41"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SubSurfCls</span>  <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;WINDOW                 &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-42"></a>                                                            <span class="s1">&#39;DOOR                   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-43"></a>                                                            <span class="s1">&#39;GLASSDOOR              &#39;</span><span class="p">,&amp;</span>
<a name="ln-44"></a>                                                            <span class="s1">&#39;SHADING                &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-45"></a>                                                            <span class="s1">&#39;TUBULARDAYLIGHTDOME    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-46"></a>                                                            <span class="s1">&#39;TUBULARDAYLIGHTDIFFUSER&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-47"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSurfIDs</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-48"></a>           <span class="n">SurfaceClass_Wall</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-49"></a>           <span class="n">SurfaceClass_Floor</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-50"></a>           <span class="n">SurfaceClass_Roof</span><span class="o">/</span><span class="p">)</span>
<a name="ln-51"></a>
<a name="ln-52"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SubSurfIDs</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-53"></a>           <span class="n">SurfaceClass_Window</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-54"></a>           <span class="n">SurfaceClass_Door</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-55"></a>           <span class="n">SurfaceClass_GlassDoor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-56"></a>           <span class="n">SurfaceClass_Shading</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-57"></a>           <span class="n">SurfaceClass_TDD_Dome</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-58"></a>           <span class="n">SurfaceClass_TDD_Diffuser</span><span class="o">/</span><span class="p">)</span>
<a name="ln-59"></a>
<a name="ln-60"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UnenteredAdjacentZoneSurface</span><span class="o">=-</span><span class="mi">998</span>     <span class="c">! allows users to enter one zone surface (&quot;Zone&quot;)</span>
<a name="ln-61"></a>                                                            <span class="c">! referencing another in adjacent zone</span>
<a name="ln-62"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UnreconciledZoneSurface</span><span class="o">=-</span><span class="mi">999</span>          <span class="c">! interim value between entering surfaces (&quot;Surface&quot;) and reconciling</span>
<a name="ln-63"></a>                                                            <span class="c">! surface names in other zones</span>
<a name="ln-64"></a>
<a name="ln-65"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fmt3</span><span class="o">=</span><span class="s2">&quot;(A,3(1x,f18.13))&quot;</span>
<a name="ln-66"></a>
<a name="ln-67"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-68"></a>
<a name="ln-69"></a>  <span class="c">!MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-70"></a>  <span class="c">! Following are used only during getting vertices, so are module variables here.</span>
<a name="ln-71"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CosBldgRelNorth</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of the building rotation (relative north) (includes appendix G rotation)</span>
<a name="ln-72"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SinBldgRelNorth</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sine of the building rotation (relative north)   (includes appendix G rotation)</span>
<a name="ln-73"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CosBldgRotAppGonly</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of the building rotation for appendix G only(relative north)</span>
<a name="ln-74"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SinBldgRotAppGonly</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sine of the building rotation for appendix G only (relative north)</span>
<a name="ln-75"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CosZoneRelNorth</span> <span class="c">! Cosine of the zone rotation (relative north)</span>
<a name="ln-76"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SinZoneRelNorth</span> <span class="c">! Sine of the zone rotation (relative north)</span>
<a name="ln-77"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SurfaceData</span><span class="p">),</span>        <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SurfaceTmp</span>  <span class="c">! Allocated/Deallocated during input processing</span>
<a name="ln-78"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SurfaceData</span><span class="p">),</span>        <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SurfaceTmpSave</span>  <span class="c">! Allocated/Deallocated during input processing</span>
<a name="ln-79"></a>
<a name="ln-80"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">NoGroundTempObjWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! This will cause a warning to be issued if surfaces with &quot;Ground&quot;</span>
<a name="ln-81"></a>                                          <span class="c">! outside environment are used but no ground temperature object was input.</span>
<a name="ln-82"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">NoFCGroundTempObjWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! This will cause a warning to be issued if surfaces with &quot;GroundFCfactorMethod&quot;</span>
<a name="ln-83"></a>                                          <span class="c">! outside environment are used but no FC ground temperatures was input.</span>
<a name="ln-84"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RectSurfRefWorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! GlobalGeometryRules=World (true) or Relative (false)</span>
<a name="ln-85"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Warning1Count</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! counts of Modify Window 5/6 windows</span>
<a name="ln-86"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Warning2Count</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! counts of overriding exterior windows with Window 5/6 glazing systems</span>
<a name="ln-87"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Warning3Count</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! counts of overriding interior windows with Window 5/6 glazing systems</span>
<a name="ln-88"></a>
<a name="ln-89"></a>  <span class="c">!SUBROUTINE SPECIFICATIONS FOR MODULE SurfaceGeometry</span>
<a name="ln-90"></a><span class="k">PUBLIC  </span><span class="n">SetupZoneGeometry</span>
<a name="ln-91"></a><span class="k">PRIVATE </span><span class="n">AllocateModuleArrays</span>
<a name="ln-92"></a><span class="k">PRIVATE </span><span class="n">GetSurfaceData</span>
<a name="ln-93"></a><span class="k">PRIVATE </span><span class="n">GetGeometryParameters</span>
<a name="ln-94"></a><span class="k">PRIVATE </span><span class="n">GetDetShdSurfaceData</span>
<a name="ln-95"></a><span class="k">PRIVATE </span><span class="n">GetRectDetShdSurfaceData</span>
<a name="ln-96"></a><span class="k">PRIVATE </span><span class="n">GetHTSurfaceData</span>
<a name="ln-97"></a><span class="k">PRIVATE </span><span class="n">GetRectSurfaces</span>
<a name="ln-98"></a><span class="k">PRIVATE </span><span class="n">MakeRectangularVertices</span>
<a name="ln-99"></a><span class="k">PRIVATE </span><span class="n">GetHTSubSurfaceData</span>
<a name="ln-100"></a><span class="k">PRIVATE </span><span class="n">GetRectSubSurfaces</span>
<a name="ln-101"></a><span class="k">PRIVATE </span><span class="n">CheckWindowShadingControlFrameDivider</span>
<a name="ln-102"></a><span class="k">PRIVATE </span><span class="n">CheckSubSurfaceMiscellaneous</span>
<a name="ln-103"></a><span class="k">PRIVATE </span><span class="n">MakeRelativeRectangularVertices</span>
<a name="ln-104"></a><span class="k">PRIVATE </span><span class="n">GetAttShdSurfaceData</span>
<a name="ln-105"></a><span class="k">PRIVATE </span><span class="n">GetSimpleShdSurfaceData</span>
<a name="ln-106"></a><span class="k">PRIVATE </span><span class="n">GetIntMassSurfaceData</span>
<a name="ln-107"></a><span class="k">PRIVATE </span><span class="n">GetShadingSurfReflectanceData</span>
<a name="ln-108"></a><span class="k">PRIVATE </span><span class="n">GetHTSurfExtVentedCavityData</span>
<a name="ln-109"></a><span class="k">PRIVATE </span><span class="n">GetSurfaceHeatTransferAlgorithmOverrides</span>
<a name="ln-110"></a><span class="k">PRIVATE </span><span class="n">GetVertices</span>
<a name="ln-111"></a><span class="k">PRIVATE </span><span class="n">MakeMirrorSurface</span>
<a name="ln-112"></a><span class="k">PRIVATE </span><span class="n">GetWindowShadingControlData</span>
<a name="ln-113"></a><span class="k">PRIVATE </span><span class="n">GetStormWindowData</span>
<a name="ln-114"></a><span class="k">PRIVATE </span><span class="n">GetWindowGapAirflowControlData</span>
<a name="ln-115"></a><span class="k">PRIVATE </span><span class="n">GetOSCData</span>
<a name="ln-116"></a><span class="k">PRIVATE </span><span class="n">GetOSCMData</span>
<a name="ln-117"></a><span class="k">PRIVATE </span><span class="n">GetMovableInsulationData</span>
<a name="ln-118"></a><span class="k">PRIVATE </span><span class="n">CalculateZoneVolume</span>
<a name="ln-119"></a><span class="k">PRIVATE </span><span class="n">ProcessSurfaceVertices</span>
<a name="ln-120"></a><span class="k">PRIVATE </span><span class="n">CalcCoordinateTransformation</span>
<a name="ln-121"></a><span class="k">PRIVATE </span><span class="n">CreateShadedWindowConstruction</span>
<a name="ln-122"></a><span class="k">PRIVATE </span><span class="n">CreateStormWindowConstructions</span>
<a name="ln-123"></a><span class="k">PRIVATE </span><span class="n">ModifyWindow</span>
<a name="ln-124"></a><span class="k">PRIVATE </span><span class="n">TransformVertsByAspect</span>
<a name="ln-125"></a><span class="k">PRIVATE </span><span class="n">CalcSurfaceCentroid</span>
<a name="ln-126"></a><span class="k">PRIVATE </span><span class="n">SetupShadeSurfacesForSolarCalcs</span>
<a name="ln-127"></a><span class="k">PRIVATE </span><span class="n">CheckConvexity</span>
<a name="ln-128"></a>
<a name="ln-129"></a><span class="k">CONTAINS</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="k">SUBROUTINE </span><span class="n">SetupZoneGeometry</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-132"></a>
<a name="ln-133"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-134"></a>          <span class="c">!       AUTHOR         George Walton</span>
<a name="ln-135"></a>          <span class="c">!       DATE WRITTEN   September 1977</span>
<a name="ln-136"></a>          <span class="c">!       MODIFIED       April 2002 (FCW): add warning for Solar Distribution</span>
<a name="ln-137"></a>          <span class="c">!                      = FullInteriorExterior when window has reveal</span>
<a name="ln-138"></a>          <span class="c">!                      Add fatal error when triangular window has reveal</span>
<a name="ln-139"></a>          <span class="c">!                      May 2002(FCW): Allow triangular windows to have reveal (subr SHDRVL</span>
<a name="ln-140"></a>          <span class="c">!                      in SolarShading). Remove above warning and fatal error.</span>
<a name="ln-141"></a>          <span class="c">!       RE-ENGINEERED  November 1997 (RKS,LKL)</span>
<a name="ln-142"></a>
<a name="ln-143"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-144"></a>          <span class="c">! This subroutine controls the processing of detached shadowing and</span>
<a name="ln-145"></a>          <span class="c">! zone surfaces for computing their vertices.</span>
<a name="ln-146"></a>
<a name="ln-147"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-148"></a>          <span class="c">! na</span>
<a name="ln-149"></a>
<a name="ln-150"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-151"></a>          <span class="c">! na</span>
<a name="ln-152"></a>
<a name="ln-153"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-154"></a>  <span class="k">USE </span><span class="n">DataVectorTypes</span>
<a name="ln-155"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-156"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-157"></a>  <span class="k">USE </span><span class="n">DataReportingFlags</span>
<a name="ln-158"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumSectionsFound</span>
<a name="ln-159"></a>
<a name="ln-160"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-161"></a>
<a name="ln-162"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-163"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-164"></a>
<a name="ln-165"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-166"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValFmt</span><span class="o">=</span><span class="s2">&quot;(F20.2)&quot;</span>
<a name="ln-167"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmtA</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-168"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SetUpZoneGeometry: &#39;</span>
<a name="ln-169"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-170"></a>          <span class="c">! na</span>
<a name="ln-171"></a>
<a name="ln-172"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-173"></a>          <span class="c">! na</span>
<a name="ln-174"></a>
<a name="ln-175"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AverageHeight</span>   <span class="c">! Used to keep track of average height of a surface/zone</span>
<a name="ln-177"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SurfNum</span>         <span class="c">! Surface number (DO loop counter)</span>
<a name="ln-178"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">ZoneNum</span>         <span class="c">! Zone number for current surface and DO loop counter</span>
<a name="ln-179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ZMax</span>            <span class="c">! Maximum Z of a surface (detailed outside coefficient calculation)</span>
<a name="ln-180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ZMin</span>            <span class="c">! Minimum Z of a surface (detailed outside coefficient calculation)</span>
<a name="ln-181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ZCeilAvg</span>
<a name="ln-182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CeilCount</span>
<a name="ln-183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ZFlrAvg</span>
<a name="ln-184"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FloorCount</span>
<a name="ln-185"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">TotSurfArea</span>
<a name="ln-186"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">Z1</span>
<a name="ln-187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">Z2</span>
<a name="ln-188"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="n">String1</span>
<a name="ln-189"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="n">String2</span>
<a name="ln-190"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="n">String3</span>
<a name="ln-191"></a>  <span class="kt">INTEGER </span><span class="nb">Count</span>    <span class="c">! To count wall surfaces for ceiling height calculation</span>
<a name="ln-192"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZoneCeilingHeightEntered</span>
<a name="ln-193"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZoneCeilingArea</span>
<a name="ln-194"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-195"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NominalUwithConvCoeffs</span>
<a name="ln-196"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cNominalU</span>
<a name="ln-197"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cNominalUwithConvCoeffs</span>
<a name="ln-198"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">isWithConvCoefValid</span>
<a name="ln-199"></a><span class="c">!  INTEGER, ALLOCATABLE, DIMENSION(:) :: ZoneSurfacesCount</span>
<a name="ln-200"></a><span class="c">!  INTEGER, ALLOCATABLE, DIMENSION(:) :: ZoneSubSurfacesCount</span>
<a name="ln-201"></a><span class="c">!  INTEGER, ALLOCATABLE, DIMENSION(:) :: ZoneShadingSurfacesCount</span>
<a name="ln-202"></a>
<a name="ln-203"></a>
<a name="ln-204"></a>
<a name="ln-205"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">nonInternalMassSurfacesPresent</span>
<a name="ln-206"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DetailedWWR</span>
<a name="ln-207"></a>
<a name="ln-208"></a>
<a name="ln-209"></a>          <span class="c">! FLOW:</span>
<a name="ln-210"></a>          <span class="c">! Allocations and initializations...</span>
<a name="ln-211"></a>
<a name="ln-212"></a>          <span class="c">! Zones must have been &quot;gotten&quot; before this call</span>
<a name="ln-213"></a>          <span class="c">! The RelNorth variables are used if &quot;relative&quot; coordinates are input as well</span>
<a name="ln-214"></a>          <span class="c">! as setting up DaylightingCoords</span>
<a name="ln-215"></a>
<a name="ln-216"></a>  <span class="c">! these include building north axis and Building Rotation for Appendix G</span>
<a name="ln-217"></a>  <span class="n">CosBldgRelNorth</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">BuildingAzimuth</span> <span class="o">+</span> <span class="n">BuildingRotationAppendixG</span><span class="p">)</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-218"></a>  <span class="n">SinBldgRelNorth</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">BuildingAzimuth</span> <span class="o">+</span> <span class="n">BuildingRotationAppendixG</span><span class="p">)</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-219"></a>
<a name="ln-220"></a>  <span class="c">! these are only for Building Rotation for Appendix G when using world coordinate system</span>
<a name="ln-221"></a>  <span class="n">CosBldgRotAppGonly</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="o">-</span><span class="n">BuildingRotationAppendixG</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-222"></a>  <span class="n">SinBldgRotAppGonly</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="n">BuildingRotationAppendixG</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-223"></a>
<a name="ln-224"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CosZoneRelNorth</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-225"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SinZoneRelNorth</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-226"></a>
<a name="ln-227"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneCeilingHeightEntered</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-228"></a>  <span class="n">ZoneCeilingHeightEntered</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-229"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneCeilingArea</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-230"></a>  <span class="n">ZoneCeilingArea</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-231"></a>
<a name="ln-232"></a>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-233"></a>
<a name="ln-234"></a>    <span class="n">CosZoneRelNorth</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">COS</span><span class="p">(</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-235"></a>    <span class="n">SinZoneRelNorth</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-236"></a>
<a name="ln-237"></a>  <span class="k">END DO</span>
<a name="ln-238"></a><span class="k">  CALL </span><span class="n">GetSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-239"></a>
<a name="ln-240"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-241"></a><span class="k">    DEALLOCATE</span> <span class="p">(</span><span class="n">CosZoneRelNorth</span><span class="p">)</span>
<a name="ln-242"></a>    <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">SinZoneRelNorth</span><span class="p">)</span>
<a name="ln-243"></a>    <span class="k">RETURN</span>
<a name="ln-244"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-245"></a>
<a name="ln-246"></a>  <span class="k">CALL </span><span class="n">GetWindowGapAirflowControlData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-247"></a>
<a name="ln-248"></a>  <span class="k">CALL </span><span class="n">GetStormWindowData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-249"></a>
<a name="ln-250"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ErrorsFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TotStormWin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">CreateStormWindowConstructions</span>
<a name="ln-251"></a>
<a name="ln-252"></a>  <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">CosZoneRelNorth</span><span class="p">)</span>
<a name="ln-253"></a>  <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">SinZoneRelNorth</span><span class="p">)</span>
<a name="ln-254"></a>
<a name="ln-255"></a>  <span class="k">CALL </span><span class="n">AllocateModuleArrays</span> <span class="c">! This needs to be moved to the main manager routine of SSG at a later date</span>
<a name="ln-256"></a>
<a name="ln-257"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-258"></a>  <span class="n">AirSkyRadSplit</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-259"></a>
<a name="ln-260"></a>  <span class="n">CalcWindowRevealReflection</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set to True in ProcessSurfaceVertices if beam solar reflection from window reveals</span>
<a name="ln-261"></a>                                       <span class="c">! is requested for one or more exterior windows.</span>
<a name="ln-262"></a>  <span class="n">BuildingShadingCount</span> <span class="o">=</span><span class="mi">0</span>
<a name="ln-263"></a>  <span class="n">FixedShadingCount</span>    <span class="o">=</span><span class="mi">0</span>
<a name="ln-264"></a>  <span class="n">AttachedShadingCount</span> <span class="o">=</span><span class="mi">0</span>
<a name="ln-265"></a>
<a name="ln-266"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>   <span class="c">! Loop through all surfaces...</span>
<a name="ln-267"></a>
<a name="ln-268"></a>    <span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">))</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="c">! Set flag that determines whether a surface is a shadowing surface</span>
<a name="ln-271"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-272"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_F</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-273"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-274"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="n">AttachedShadingCount</span><span class="o">=</span><span class="n">AttachedShadingCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-275"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="n">FixedShadingCount</span><span class="o">=</span><span class="n">FixedShadingCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-276"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="n">BuildingShadingCount</span><span class="o">=</span><span class="n">BuildingShadingCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-277"></a>
<a name="ln-278"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ProcessSurfaceVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-279"></a>  <span class="k">END DO</span>
<a name="ln-280"></a>
<a name="ln-281"></a><span class="k">  </span><span class="n">Zone</span><span class="p">%</span><span class="n">ExtWindowArea</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-282"></a>  <span class="n">Zone</span><span class="p">%</span><span class="n">HasInterZoneWindow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-283"></a>  <span class="n">Zone</span><span class="p">%</span><span class="n">HasWindow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-284"></a>  <span class="n">Zone</span><span class="p">%</span><span class="n">ExtGrossWallArea</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-285"></a>  <span class="n">Zone</span><span class="p">%</span><span class="n">ExtNetWallArea</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-286"></a>  <span class="n">Zone</span><span class="p">%</span><span class="n">TotalSurfArea</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-287"></a>
<a name="ln-288"></a>  <span class="n">DetailedWWR</span><span class="o">=</span><span class="p">(</span><span class="n">GetNumSectionsFound</span><span class="p">(</span><span class="s1">&#39;DETAILEDWWR_DEBUG&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-289"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedWWR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-290"></a><span class="k">    WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;=======User Entered Classification =================&#39;</span>
<a name="ln-291"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Surface,Class,Area,Tilt&#39;</span>
<a name="ln-292"></a>  <span class="n">ENDIF</span>
<a name="ln-293"></a>
<a name="ln-294"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span> <span class="c">! Loop through all surfaces to find windows...</span>
<a name="ln-295"></a>
<a name="ln-296"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Skip shadowing (sub)surfaces</span>
<a name="ln-297"></a>    <span class="n">ZoneNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-298"></a>    <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalSurfArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalSurfArea</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-299"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-300"></a><span class="k">      </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalSurfArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalSurfArea</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameArea</span>
<a name="ln-301"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">HasWindow</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-302"></a>    <span class="n">ENDIF</span>
<a name="ln-303"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="n">ZoneCeilingArea</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span><span class="o">=</span><span class="n">ZoneCeilingArea</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-304"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-305"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-306"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-307"></a><span class="k">        </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExteriorTotalSurfArea</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExteriorTotalSurfArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-308"></a>                           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-309"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-310"></a><span class="k">          </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtNetWallArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtNetWallArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-311"></a>                           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-312"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossWallArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossWallArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-313"></a>                           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-314"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossWallArea_Multiplied</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossWallArea_Multiplied</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-315"></a>                           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-316"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedWWR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-317"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,Wall,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-318"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-319"></a>               <span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-320"></a>          <span class="n">ENDIF</span>
<a name="ln-321"></a>        <span class="n">ENDIF</span>
<a name="ln-322"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">GroundFCfactorMethod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-323"></a><span class="k">        </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExteriorTotalGroundSurfArea</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExteriorTotalGroundSurfArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-324"></a>                           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-325"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-326"></a><span class="k">          </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossGroundWallArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossGroundWallArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-327"></a>                           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-328"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossGroundWallArea_Multiplied</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossGroundWallArea_Multiplied</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-329"></a>                           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-330"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedWWR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-331"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,Wall-GroundContact,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-332"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-333"></a>               <span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-334"></a>          <span class="n">ENDIF</span>
<a name="ln-335"></a>        <span class="n">ENDIF</span>
<a name="ln-336"></a>      <span class="n">ENDIF</span>
<a name="ln-337"></a>
<a name="ln-338"></a>    <span class="k">ELSE</span>  <span class="c">! For Windows</span>
<a name="ln-339"></a>
<a name="ln-340"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! Interzone window present</span>
<a name="ln-341"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IgnoreInteriorWindowTransmission</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-342"></a><span class="k">          </span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">HasInterZoneWindow</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-343"></a>        <span class="n">ENDIF</span>
<a name="ln-344"></a>      <span class="k">ELSE</span>
<a name="ln-345"></a><span class="k">        IF</span> <span class="p">((</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-346"></a>                <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">)&amp;</span>
<a name="ln-347"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-348"></a><span class="k">          </span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">ExtWindowArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">ExtWindowArea</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-349"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">ExtWindowArea_Multiplied</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">ExtWindowArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-350"></a>             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-351"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedWWR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-352"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,Window,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-353"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-354"></a>                                   <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-355"></a>                    <span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-356"></a>          <span class="n">ENDIF</span>
<a name="ln-357"></a>       <span class="n">ENDIF</span>
<a name="ln-358"></a>      <span class="n">ENDIF</span>
<a name="ln-359"></a>
<a name="ln-360"></a>    <span class="n">ENDIF</span>
<a name="ln-361"></a>
<a name="ln-362"></a>  <span class="k">END DO</span>    <span class="c">! ...end of surfaces windows DO loop</span>
<a name="ln-363"></a>
<a name="ln-364"></a><span class="c">!  DO SurfNum = 1, TotSurfaces ! Set areas for Sunlit area calculations for Windows</span>
<a name="ln-365"></a><span class="c">!    IF (Surface(SurfNum)%Class /= SurfaceClass_Window) CYCLE</span>
<a name="ln-366"></a><span class="c">!    SurfaceWindow(SurfNum)%AreaCalcForSunlitArea = (Surface(SurfNum)%Area + SurfaceWindow(SurfNum)%DividerArea) /  &amp;</span>
<a name="ln-367"></a><span class="c">!                                  Surface(SurfNum)%Multiplier</span>
<a name="ln-368"></a><span class="c">!  ENDDO</span>
<a name="ln-369"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedWWR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-370"></a><span class="k">    WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;========================&#39;</span>
<a name="ln-371"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Zone,ExtWallArea,ExtWindowArea&#39;</span>
<a name="ln-372"></a>  <span class="n">ENDIF</span>
<a name="ln-373"></a>
<a name="ln-374"></a>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-375"></a>    <span class="n">CeilCount</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-376"></a>    <span class="n">FloorCount</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-377"></a>    <span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-378"></a>    <span class="n">AverageHeight</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-379"></a>    <span class="n">ZCeilAvg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-380"></a>    <span class="n">ZFlrAvg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-381"></a>    <span class="n">ZMax</span><span class="o">=-</span><span class="mi">9999</span><span class="mf">9.0d0</span>
<a name="ln-382"></a>    <span class="n">ZMin</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.0d0</span>
<a name="ln-383"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedWWR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-384"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-385"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossWallArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-386"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtWindowArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-387"></a>    <span class="n">ENDIF</span>
<a name="ln-388"></a>    <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-389"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-390"></a>        <span class="c">! Use Average Z for surface, more important for roofs than floors...</span>
<a name="ln-391"></a>        <span class="n">CeilCount</span><span class="o">=</span><span class="n">CeilCount</span><span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-392"></a>        <span class="n">Z1</span><span class="o">=</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-393"></a>        <span class="n">Z2</span><span class="o">=</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-394"></a><span class="c">!        ZCeilAvg=ZCeilAvg+(Z1+Z2)/2.d0</span>
<a name="ln-395"></a>        <span class="n">ZCeilAvg</span><span class="o">=</span><span class="n">ZCeilAvg</span><span class="o">+</span><span class="p">((</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">ZoneCeilingArea</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-396"></a>      <span class="n">ENDIF</span>
<a name="ln-397"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-398"></a>        <span class="c">! Use Average Z for surface, more important for roofs than floors...</span>
<a name="ln-399"></a>        <span class="n">FloorCount</span><span class="o">=</span><span class="n">FloorCount</span><span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-400"></a>        <span class="n">Z1</span><span class="o">=</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-401"></a>        <span class="n">Z2</span><span class="o">=</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-402"></a><span class="c">!        ZFlrAvg=ZFlrAvg+(Z1+Z2)/2.d0</span>
<a name="ln-403"></a>        <span class="n">ZFlrAvg</span><span class="o">=</span><span class="n">ZFlrAvg</span><span class="o">+</span><span class="p">((</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="p">)</span>
<a name="ln-404"></a>      <span class="n">ENDIF</span>
<a name="ln-405"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-406"></a>        <span class="c">! Use Wall calculation in case no roof &amp; floor in zone</span>
<a name="ln-407"></a>        <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-408"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-409"></a><span class="k">          </span><span class="n">ZMax</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-410"></a>          <span class="n">ZMin</span><span class="o">=</span><span class="n">ZMax</span>
<a name="ln-411"></a>        <span class="n">ENDIF</span>
<a name="ln-412"></a>        <span class="n">ZMax</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ZMax</span><span class="p">,</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-413"></a>        <span class="n">ZMin</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">ZMin</span><span class="p">,</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-414"></a>      <span class="n">ENDIF</span>
<a name="ln-415"></a>    <span class="n">ENDDO</span>
<a name="ln-416"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CeilCount</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">FloorCount</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-417"></a><span class="c">!      ZCeilAvg=ZCeilAvg/CeilCount</span>
<a name="ln-418"></a><span class="c">!      ZFlrAvg=ZFlrAvg/FloorCount</span>
<a name="ln-419"></a>      <span class="n">AverageHeight</span><span class="o">=</span><span class="n">ZCeilAvg</span><span class="o">-</span><span class="n">ZFlrAvg</span>
<a name="ln-420"></a>    <span class="k">ELSE</span>
<a name="ln-421"></a><span class="k">      </span><span class="n">AverageHeight</span><span class="o">=</span><span class="p">(</span><span class="n">ZMax</span><span class="o">-</span><span class="n">ZMin</span><span class="p">)</span>
<a name="ln-422"></a>    <span class="n">ENDIF</span>
<a name="ln-423"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AverageHeight</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-424"></a><span class="k">      </span><span class="n">AverageHeight</span><span class="o">=</span><span class="p">(</span><span class="n">ZMax</span><span class="o">-</span><span class="n">ZMin</span><span class="p">)</span>
<a name="ln-425"></a>    <span class="n">ENDIF</span>
<a name="ln-426"></a>
<a name="ln-427"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-428"></a><span class="k">      </span><span class="n">ZoneCeilingHeightEntered</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-429"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">AverageHeight</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-430"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AverageHeight</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span><span class="p">)</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span>  <span class="o">&gt;</span> <span class="p">.</span><span class="mi">05</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-431"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrCount</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-432"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Entered Ceiling Height for some zone(s) significantly &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-433"></a>               <span class="s1">&#39;different from calculated Ceiling Height&#39;</span><span class="p">)</span>
<a name="ln-434"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-435"></a>                 <span class="s1">&#39;to show more details on each max iteration exceeded.&#39;</span><span class="p">)</span>
<a name="ln-436"></a>          <span class="n">ENDIF</span>
<a name="ln-437"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-438"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Entered Ceiling Height for Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-439"></a>                                  <span class="s1">&#39;&quot; significantly different from calculated Ceiling Height&#39;</span><span class="p">)</span>
<a name="ln-440"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">String1</span><span class="p">,</span><span class="n">ValFmt</span><span class="p">)</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span>
<a name="ln-441"></a>            <span class="n">String1</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">String1</span><span class="p">)</span>
<a name="ln-442"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">String2</span><span class="p">,</span><span class="n">ValFmt</span><span class="p">)</span> <span class="n">AverageHeight</span>
<a name="ln-443"></a>            <span class="n">String2</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">String2</span><span class="p">)</span>
<a name="ln-444"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Entered Ceiling Height=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">String1</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-445"></a>               <span class="s1">&#39;, Calculated Ceiling Height=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">String2</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-446"></a>               <span class="s1">&#39;, entered height will be used in calculations.&#39;</span><span class="p">)</span>
<a name="ln-447"></a>          <span class="n">ENDIF</span>
<a name="ln-448"></a>        <span class="n">ENDIF</span>
<a name="ln-449"></a>      <span class="n">ENDIF</span>
<a name="ln-450"></a>    <span class="n">ENDIF</span>
<a name="ln-451"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">AverageHeight</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-452"></a>         <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span> <span class="o">=</span> <span class="n">AverageHeight</span>
<a name="ln-453"></a>
<a name="ln-454"></a>  <span class="k">END DO</span>
<a name="ln-455"></a>
<a name="ln-456"></a><span class="k">  CALL </span><span class="n">CalculateZoneVolume</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ZoneCeilingHeightEntered</span><span class="p">)</span>    <span class="c">! Calculate Zone Volumes</span>
<a name="ln-457"></a>
<a name="ln-458"></a>  <span class="c">! Calculate zone centroid (and min/max x,y,z for zone)</span>
<a name="ln-459"></a>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-460"></a>    <span class="n">nonInternalMassSurfacesPresent</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-461"></a>    <span class="n">TotSurfArea</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-462"></a>    <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-463"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-464"></a><span class="k">      </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumX</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-465"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumX</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-466"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumY</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-467"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumY</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-468"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-469"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-470"></a>    <span class="n">ENDIF</span>
<a name="ln-471"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-472"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-473"></a><span class="k">      </span><span class="n">nonInternalMassSurfacesPresent</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-474"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span>  <span class="p">&amp;</span>
<a name="ln-475"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-476"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-477"></a>
<a name="ln-478"></a><span class="k">        </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">x</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-479"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">y</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-480"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-481"></a>        <span class="n">TotSurfArea</span> <span class="o">=</span> <span class="n">TotSurfArea</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-482"></a>      <span class="k">END IF</span>
<a name="ln-483"></a><span class="k">      </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumX</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumX</span><span class="p">,</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">))</span>
<a name="ln-484"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumX</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">,</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">))</span>
<a name="ln-485"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumY</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumY</span><span class="p">,</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">))</span>
<a name="ln-486"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumY</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">,</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">))</span>
<a name="ln-487"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="p">,</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">))</span>
<a name="ln-488"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">,</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">))</span>
<a name="ln-489"></a>    <span class="k">END DO</span>
<a name="ln-490"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TotSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-491"></a><span class="k">      </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="n">TotSurfArea</span>
<a name="ln-492"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="n">TotSurfArea</span>
<a name="ln-493"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="n">TotSurfArea</span>
<a name="ln-494"></a>    <span class="n">ENDIF</span>
<a name="ln-495"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">nonInternalMassSurfacesPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-496"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-497"></a>             <span class="s1">&#39;&quot; has only internal mass surfaces.  Need at least one other surface.&#39;</span><span class="p">)</span>
<a name="ln-498"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-499"></a>    <span class="n">ENDIF</span>
<a name="ln-500"></a>  <span class="k">END DO</span>
<a name="ln-501"></a>
<a name="ln-502"></a><span class="k">  DEALLOCATE</span><span class="p">(</span><span class="n">ZoneCeilingHeightEntered</span><span class="p">)</span>
<a name="ln-503"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZoneCeilingArea</span><span class="p">)</span>
<a name="ln-504"></a>
<a name="ln-505"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AdjacentZoneToSurface</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-506"></a>  <span class="n">AdjacentZoneToSurface</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-507"></a>  <span class="c">! note -- adiabatic surfaces will show same zone as surface</span>
<a name="ln-508"></a>  <span class="k">do </span><span class="n">surfnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-509"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-510"></a><span class="k">    </span><span class="n">AdjacentZoneToSurface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-511"></a>  <span class="n">enddo</span>
<a name="ln-512"></a>
<a name="ln-513"></a>  <span class="k">do </span><span class="n">zonenum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-514"></a>    <span class="k">do </span><span class="n">surfnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-515"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">ZoneName</span> <span class="o">==</span> <span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-516"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">NumShadingSurfaces</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">NumShadingSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-517"></a>
<a name="ln-518"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="n">zonenum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-519"></a>
<a name="ln-520"></a><span class="k">      if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>          <span class="p">&amp;</span>
<a name="ln-521"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-522"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">NumSurfaces</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">NumSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-523"></a>
<a name="ln-524"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>                   <span class="p">&amp;</span>
<a name="ln-525"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>     <span class="p">&amp;</span>
<a name="ln-526"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-527"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">NumSubSurfaces</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">NumSubSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-528"></a>
<a name="ln-529"></a>    <span class="n">enddo</span>  <span class="c">! surfaces</span>
<a name="ln-530"></a>  <span class="n">enddo</span> <span class="c">! zones</span>
<a name="ln-531"></a>
<a name="ln-532"></a>  <span class="k">do </span><span class="n">surfnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-533"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&lt;=</span> <span class="n">TotConstructs</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-534"></a><span class="k">      </span><span class="n">NominalUwithConvCoeffs</span> <span class="o">=</span> <span class="n">ComputeNominalUwithConvCoeffs</span><span class="p">(</span><span class="n">surfnum</span><span class="p">,</span><span class="n">isWithConvCoefValid</span><span class="p">)</span>
<a name="ln-535"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">isWithConvCoefValid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-536"></a><span class="k">        </span><span class="n">cNominalUwithConvCoeffs</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NominalUwithConvCoeffs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-537"></a>      <span class="k">ELSE</span>
<a name="ln-538"></a><span class="k">        </span><span class="n">cNominalUwithConvCoeffs</span> <span class="o">=</span> <span class="s1">&#39;[invalid]&#39;</span>
<a name="ln-539"></a>      <span class="k">END IF</span>
<a name="ln-540"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-541"></a>        <span class="c">! SurfaceClass_Window also covers glass doors and TDD:Diffusers</span>
<a name="ln-542"></a>        <span class="n">cNominalU</span><span class="o">=</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-543"></a>      <span class="k">ELSE</span>
<a name="ln-544"></a><span class="k">        </span><span class="n">cNominalU</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NominalU</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-545"></a>      <span class="k">END IF</span>
<a name="ln-546"></a><span class="k">    else</span>
<a name="ln-547"></a><span class="k">      </span><span class="n">CNominalUwithConvCoeffs</span> <span class="o">=</span> <span class="s1">&#39;**&#39;</span>
<a name="ln-548"></a>      <span class="n">CNominalU</span> <span class="o">=</span> <span class="s1">&#39;**&#39;</span>
<a name="ln-549"></a>    <span class="n">endif</span>
<a name="ln-550"></a>
<a name="ln-551"></a>    <span class="c">! save the U-value nominal for use later in tabular report</span>
<a name="ln-552"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">UNomWOFilm</span> <span class="o">=</span> <span class="n">cNominalU</span>
<a name="ln-553"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">UNomFilm</span> <span class="o">=</span> <span class="n">cNominalUwithConvCoeffs</span>
<a name="ln-554"></a>    <span class="c">!populate the predefined report related to u-values with films</span>
<a name="ln-555"></a>    <span class="c">!only exterior surfaces including underground</span>
<a name="ln-556"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Ground</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-557"></a><span class="k">      SELECT CASE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">Class</span><span class="p">)</span>
<a name="ln-558"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SurfaceClass_Wall</span><span class="p">,</span><span class="n">SurfaceClass_Floor</span><span class="p">,</span><span class="n">SurfaceClass_Roof</span><span class="p">)</span>
<a name="ln-559"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchOpUfactFilm</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">NominalUwithConvCoeffs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-560"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SurfaceClass_Door</span><span class="p">)</span>
<a name="ln-561"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDrUfactFilm</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">NominalUwithConvCoeffs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-562"></a>      <span class="k">END SELECT</span>
<a name="ln-563"></a><span class="k">    END IF</span>
<a name="ln-564"></a><span class="k">  </span><span class="n">enddo</span>  <span class="c">! surfaces</span>
<a name="ln-565"></a>
<a name="ln-566"></a>  <span class="c">! Write number of shadings to initialization output file</span>
<a name="ln-567"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;! &lt;Shading Summary&gt;, Number of Fixed Detached Shades, Number of Building Detached Shades, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-568"></a>     <span class="s1">&#39;Number of Attached Shades&#39;</span>
<a name="ln-569"></a>
<a name="ln-570"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39; Shading Summary,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FixedShadingCount</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-571"></a>     <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">BuildingShadingCount</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-572"></a>     <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AttachedShadingCount</span><span class="p">))</span>
<a name="ln-573"></a>
<a name="ln-574"></a>  <span class="c">! Write number of zones header to initialization output file</span>
<a name="ln-575"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;! &lt;Zone Summary&gt;, Number of Zones, Number of Zone Surfaces, Number of SubSurfaces&#39;</span>
<a name="ln-576"></a>
<a name="ln-577"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39; Zone Summary,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-578"></a>     <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="o">-</span><span class="n">FixedShadingCount</span><span class="o">-</span><span class="n">BuildingShadingCount</span><span class="o">-</span><span class="n">AttachedShadingCount</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-579"></a>     <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">NumSubSurfaces</span><span class="p">)))</span>
<a name="ln-580"></a>
<a name="ln-581"></a>  <span class="c">! Write Zone Information header to the initialization output file</span>
<a name="ln-582"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">721</span><span class="p">)</span>
<a name="ln-583"></a>
<a name="ln-584"></a>  <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-585"></a>    <span class="c">! Write Zone Information to the initialization output file</span>
<a name="ln-586"></a>
<a name="ln-587"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InsideConvectionAlgo</span><span class="p">)</span>
<a name="ln-588"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAESimple</span><span class="p">)</span>
<a name="ln-589"></a>        <span class="n">String1</span><span class="o">=</span><span class="s1">&#39;Simple&#39;</span>
<a name="ln-590"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAETARP</span><span class="p">)</span>
<a name="ln-591"></a>        <span class="n">String1</span><span class="o">=</span><span class="s1">&#39;TARP&#39;</span>
<a name="ln-592"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CeilingDiffuser</span><span class="p">)</span>
<a name="ln-593"></a>        <span class="n">String1</span><span class="o">=</span><span class="s1">&#39;CeilingDiffuser&#39;</span>
<a name="ln-594"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">TrombeWall</span><span class="p">)</span>
<a name="ln-595"></a>        <span class="n">String1</span><span class="o">=</span><span class="s1">&#39;TrombeWall&#39;</span>
<a name="ln-596"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AdaptiveConvectionAlgorithm</span><span class="p">)</span>
<a name="ln-597"></a>        <span class="n">String1</span><span class="o">=</span><span class="s1">&#39;AdaptiveConvectionAlgorithm&#39;</span>
<a name="ln-598"></a>    <span class="k">END SELECT</span>
<a name="ln-599"></a>
<a name="ln-600"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span><span class="p">)</span>
<a name="ln-601"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAESimple</span><span class="p">)</span>
<a name="ln-602"></a>        <span class="n">String2</span><span class="o">=</span><span class="s1">&#39;Simple&#39;</span>
<a name="ln-603"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAETARP</span><span class="p">)</span>
<a name="ln-604"></a>        <span class="n">String2</span><span class="o">=</span><span class="s1">&#39;TARP&#39;</span>
<a name="ln-605"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">TarpHcOutside</span><span class="p">)</span>
<a name="ln-606"></a>        <span class="n">String2</span><span class="o">=</span><span class="s1">&#39;TARP&#39;</span>
<a name="ln-607"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">MoWittHcOutside</span><span class="p">)</span>
<a name="ln-608"></a>        <span class="n">String2</span><span class="o">=</span><span class="s1">&#39;MoWitt&#39;</span>
<a name="ln-609"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">DOE2HcOutside</span><span class="p">)</span>
<a name="ln-610"></a>        <span class="n">String2</span><span class="o">=</span><span class="s1">&#39;DOE-2&#39;</span>
<a name="ln-611"></a><span class="c">!      CASE (BLASTHcOutside)</span>
<a name="ln-612"></a><span class="c">!        String2=&#39;BLAST&#39;</span>
<a name="ln-613"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AdaptiveConvectionAlgorithm</span><span class="p">)</span>
<a name="ln-614"></a>        <span class="n">String2</span><span class="o">=</span><span class="s1">&#39;AdaptiveConvectionAlgorithm&#39;</span>
<a name="ln-615"></a>
<a name="ln-616"></a>    <span class="k">END SELECT</span>
<a name="ln-617"></a>
<a name="ln-618"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">isPartOfTotalArea</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-619"></a><span class="k">      </span><span class="n">String3</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-620"></a>    <span class="k">ELSE</span>
<a name="ln-621"></a><span class="k">      </span><span class="n">String3</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-622"></a>    <span class="n">ENDIF</span>
<a name="ln-623"></a>
<a name="ln-624"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>                         <span class="p">&amp;</span>
<a name="ln-625"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginX</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginY</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-626"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>    <span class="p">&amp;</span>
<a name="ln-627"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-628"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OfType</span><span class="p">)),</span>                                                <span class="p">&amp;</span>
<a name="ln-629"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span><span class="p">)),</span>                                            <span class="p">&amp;</span>
<a name="ln-630"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span><span class="p">)),</span>                                        <span class="p">&amp;</span>
<a name="ln-631"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumX</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>     <span class="p">&amp;</span>
<a name="ln-632"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumY</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>     <span class="p">&amp;</span>
<a name="ln-633"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>     <span class="p">&amp;</span>
<a name="ln-634"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-635"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">String1</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">String2</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>                       <span class="p">&amp;</span>
<a name="ln-636"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtGrossWallArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>                                            <span class="p">&amp;</span>
<a name="ln-637"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtNetWallArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>                                              <span class="p">&amp;</span>
<a name="ln-638"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtWindowArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>                                               <span class="p">&amp;</span>
<a name="ln-639"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumSurfaces</span><span class="p">)),</span>                                                  <span class="p">&amp;</span>
<a name="ln-640"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumSubSurfaces</span><span class="p">)),</span>                                               <span class="p">&amp;</span>
<a name="ln-641"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumShadingSurfaces</span><span class="p">)),</span>                                           <span class="p">&amp;</span>
<a name="ln-642"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">String3</span><span class="p">)</span>
<a name="ln-643"></a>
<a name="ln-644"></a>  <span class="k">END DO</span> <span class="c">! ZoneNum</span>
<a name="ln-645"></a>
<a name="ln-646"></a><span class="c">! Do the Stratosphere check</span>
<a name="ln-647"></a>  <span class="k">CALL </span><span class="n">SetOutBulbTempAt</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfZones</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-648"></a>       <span class="n">Zone</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfZones</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfZones</span><span class="p">)%</span><span class="n">OutWetBulbTemp</span><span class="p">,</span> <span class="s1">&#39;Zone&#39;</span><span class="p">)</span>
<a name="ln-649"></a>
<a name="ln-650"></a><span class="c">!  IF (ALLOCATED(ZoneSurfacesCount)) DEALLOCATE(ZoneSurfacesCount)</span>
<a name="ln-651"></a><span class="c">!  IF (ALLOCATED(ZoneSubSurfacesCount)) DEALLOCATE(ZoneSubSurfacesCount)</span>
<a name="ln-652"></a><span class="c">!  IF (ALLOCATED(ZoneShadingSurfacesCount)) DEALLOCATE(ZoneShadingSurfacesCount)</span>
<a name="ln-653"></a>
<a name="ln-654"></a><span class="mi">720</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Zone Information, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">28</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-655"></a><span class="mi">721</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;! &lt;Zone Information&gt;,Zone Name,North Axis {deg},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-656"></a>           <span class="s1">&#39;Origin X-Coordinate {m},Origin Y-Coordinate {m},Origin Z-Coordinate {m},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-657"></a>           <span class="s1">&#39;Centroid X-Coordinate {m},Centroid Y-Coordinate {m},Centroid Z-Coordinate {m},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-658"></a>           <span class="s1">&#39;Type,Zone Multiplier,Zone List Multiplier,Minimum X {m},Maximum X {m},&#39;</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-659"></a>           <span class="s1">&#39;Minimum Y {m},Maximum Y {m},Minimum Z {m},Maximum Z {m},Ceiling Height {m},Volume {m3},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-660"></a>           <span class="s1">&#39;Zone Inside Convection Algorithm {Simple-Detailed-CeilingDiffuser-TrombeWall},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-661"></a>           <span class="s1">&#39;Zone Outside Convection Algorithm {Simple-Detailed-Tarp-MoWitt-DOE-2-BLAST},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-662"></a>          <span class="s1">&#39; Floor Area {m2},Exterior Gross Wall Area {m2},Exterior Net Wall Area {m2},Exterior Window Area {m2},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-663"></a>          <span class="s1">&#39; Number of Surfaces, Number of SubSurfaces, Number of Shading SubSurfaces, &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-664"></a>          <span class="s1">&#39; Part of Total Building Area&#39;</span><span class="p">)</span>
<a name="ln-665"></a>
<a name="ln-666"></a>  <span class="k">RETURN</span>
<a name="ln-667"></a>
<a name="ln-668"></a><span class="k">END SUBROUTINE </span><span class="n">SetUpZoneGeometry</span>
<a name="ln-669"></a>
<a name="ln-670"></a><span class="k">SUBROUTINE </span><span class="n">AllocateModuleArrays</span>
<a name="ln-671"></a>
<a name="ln-672"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-673"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-674"></a>          <span class="c">!       DATE WRITTEN   February 1998</span>
<a name="ln-675"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-676"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-677"></a>
<a name="ln-678"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-679"></a>          <span class="c">! This subroutine allocates all of the arrays at the module level which</span>
<a name="ln-680"></a>          <span class="c">! require allocation.</span>
<a name="ln-681"></a>
<a name="ln-682"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-683"></a>          <span class="c">! Allocation is dependent on the user input file.</span>
<a name="ln-684"></a>
<a name="ln-685"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-686"></a>          <span class="c">! na</span>
<a name="ln-687"></a>
<a name="ln-688"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-689"></a>          <span class="c">! na</span>
<a name="ln-690"></a>
<a name="ln-691"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-692"></a>
<a name="ln-693"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-694"></a>          <span class="c">! na</span>
<a name="ln-695"></a>
<a name="ln-696"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-697"></a>          <span class="c">! na</span>
<a name="ln-698"></a>
<a name="ln-699"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-700"></a>          <span class="c">! na</span>
<a name="ln-701"></a>
<a name="ln-702"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-703"></a>          <span class="c">! na</span>
<a name="ln-704"></a>
<a name="ln-705"></a>          <span class="c">! FLOW:</span>
<a name="ln-706"></a>
<a name="ln-707"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ShadeV</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-708"></a>  <span class="n">ShadeV</span><span class="p">%</span><span class="n">NVert</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-709"></a>  <span class="c">! Individual components (XV,YV,ZV) allocated in routine ProcessSurfaceVertices</span>
<a name="ln-710"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">X0</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-711"></a>  <span class="n">X0</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-712"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">Y0</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-713"></a>  <span class="n">Y0</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-714"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">Z0</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-715"></a>  <span class="n">Z0</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-716"></a>
<a name="ln-717"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CBZone</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-718"></a>  <span class="n">CBZone</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-719"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DSZone</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-720"></a>  <span class="n">DSZone</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-721"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DGZone</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-722"></a>  <span class="n">DGZone</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-723"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DBZone</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-724"></a>  <span class="n">DBZone</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-725"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DBZoneSSG</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-726"></a>  <span class="n">DBZoneSSG</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-727"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QSDifSol</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-728"></a>  <span class="n">QSDifSol</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-729"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">AISurf</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-730"></a>  <span class="n">AISurf</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-731"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">AOSurf</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-732"></a>  <span class="n">AOSurf</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-733"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BmToBmReflFacObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-734"></a>  <span class="n">BmToBmReflFacObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-735"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BmToDiffReflFacObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-736"></a>  <span class="n">BmToDiffReflFacObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-737"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BmToDiffReflFacGnd</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-738"></a>  <span class="n">BmToDiffReflFacGnd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-739"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">AWinSurf</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-740"></a>  <span class="n">AWinSurf</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-741"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">AWinCFOverlap</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">MaxSolidWinLayers</span><span class="p">))</span>
<a name="ln-742"></a>  <span class="n">AWinCFOverlap</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-743"></a>
<a name="ln-744"></a>  <span class="k">RETURN</span>
<a name="ln-745"></a>
<a name="ln-746"></a><span class="k">END SUBROUTINE </span><span class="n">AllocateModuleArrays</span>
<a name="ln-747"></a>
<a name="ln-748"></a><span class="k">SUBROUTINE </span><span class="n">GetSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-749"></a>
<a name="ln-750"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-751"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-752"></a>          <span class="c">!       DATE WRITTEN   November 1997</span>
<a name="ln-753"></a>          <span class="c">!       MODIFIED       April 1999, Linda Lawrie</span>
<a name="ln-754"></a>          <span class="c">!                      Dec. 2000, FW (add &quot;one-wall zone&quot; checks)</span>
<a name="ln-755"></a>          <span class="c">!       RE-ENGINEERED  May 2000, Linda Lawrie (breakout surface type gets)</span>
<a name="ln-756"></a>
<a name="ln-757"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-758"></a>          <span class="c">! The purpose of this subroutine is to read in the surface information</span>
<a name="ln-759"></a>          <span class="c">! from the input data file and interpret and put in the derived type</span>
<a name="ln-760"></a>
<a name="ln-761"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-762"></a>          <span class="c">! The order of surfaces does not matter and the surfaces are resorted into</span>
<a name="ln-763"></a>          <span class="c">! the hierarchical order:</span>
<a name="ln-764"></a>          <span class="c">!  Detached Surfaces</span>
<a name="ln-765"></a>          <span class="c">!  Base Surface for zone x</span>
<a name="ln-766"></a>          <span class="c">!    Subsurfaces for base surface</span>
<a name="ln-767"></a>          <span class="c">!  Base Surface for zone x</span>
<a name="ln-768"></a>          <span class="c">!    etc</span>
<a name="ln-769"></a>          <span class="c">!  Heat Transfer Surfaces and Shading surfaces are mixed in the list</span>
<a name="ln-770"></a>          <span class="c">!  Pointers are set in the zones (First, Last)</span>
<a name="ln-771"></a>
<a name="ln-772"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-773"></a>  <span class="c">!   This routine manages getting the input for the following Objects:</span>
<a name="ln-774"></a>  <span class="c">! SurfaceGeometry</span>
<a name="ln-775"></a>  <span class="c">! Surface:Shading:Detached</span>
<a name="ln-776"></a>  <span class="c">! Surface:HeatTransfer</span>
<a name="ln-777"></a>  <span class="c">! Surface:HeatTransfer:Sub</span>
<a name="ln-778"></a>  <span class="c">! Surface:Shading:Attached</span>
<a name="ln-779"></a>  <span class="c">! Surface:InternalMass</span>
<a name="ln-780"></a>
<a name="ln-781"></a>  <span class="c">!</span>
<a name="ln-782"></a>  <span class="c">! Vertex input:</span>
<a name="ln-783"></a>  <span class="c">!  N3 , \field Number of Surface Vertices -- Number of (X,Y,Z) groups in this surface</span>
<a name="ln-784"></a>  <span class="c">!       \note currently limited 3 or 4, later?</span>
<a name="ln-785"></a>  <span class="c">!       \min 3</span>
<a name="ln-786"></a>  <span class="c">!       \max 4</span>
<a name="ln-787"></a>  <span class="c">!       \memo vertices are given in SurfaceGeometry coordinates -- if relative, all surface coordinates</span>
<a name="ln-788"></a>  <span class="c">!       \memo are &quot;relative&quot; to the Zone Origin.  if WCS, then building and zone origins are used</span>
<a name="ln-789"></a>  <span class="c">!       \memo for some internal calculations, but all coordinates are given in an &quot;absolute&quot; system.</span>
<a name="ln-790"></a>  <span class="c">!  N4,  \field Vertex 1 X-coordinate</span>
<a name="ln-791"></a>  <span class="c">!       \units m</span>
<a name="ln-792"></a>  <span class="c">!       \type real</span>
<a name="ln-793"></a>  <span class="c">!  N5 , \field Vertex 1 Y-coordinate</span>
<a name="ln-794"></a>  <span class="c">!       \units m</span>
<a name="ln-795"></a>  <span class="c">!       \type real</span>
<a name="ln-796"></a>  <span class="c">!  N6 , \field Vertex 1 Z-coordinate</span>
<a name="ln-797"></a>  <span class="c">!       \units m</span>
<a name="ln-798"></a>  <span class="c">!       \type real</span>
<a name="ln-799"></a>  <span class="c">!  N7,  \field Vertex 2 X-coordinate</span>
<a name="ln-800"></a>  <span class="c">!       \units m</span>
<a name="ln-801"></a>  <span class="c">!       \type real</span>
<a name="ln-802"></a>  <span class="c">!  N8,  \field Vertex 2 Y-coordinate</span>
<a name="ln-803"></a>  <span class="c">!       \units m</span>
<a name="ln-804"></a>  <span class="c">!       \type real</span>
<a name="ln-805"></a>  <span class="c">!  N9,  \field Vertex 2 Z-coordinate</span>
<a name="ln-806"></a>  <span class="c">!       \units m</span>
<a name="ln-807"></a>  <span class="c">!       \type real</span>
<a name="ln-808"></a>  <span class="c">!  N10, \field Vertex 3 X-coordinate</span>
<a name="ln-809"></a>  <span class="c">!       \units m</span>
<a name="ln-810"></a>  <span class="c">!       \type real</span>
<a name="ln-811"></a>  <span class="c">!  N11, \field Vertex 3 Y-coordinate</span>
<a name="ln-812"></a>  <span class="c">!       \units m</span>
<a name="ln-813"></a>  <span class="c">!       \type real</span>
<a name="ln-814"></a>  <span class="c">!  N12, \field Vertex 3 Z-coordinate</span>
<a name="ln-815"></a>  <span class="c">!       \units m</span>
<a name="ln-816"></a>  <span class="c">!       \type real</span>
<a name="ln-817"></a>  <span class="c">!  N13, \field Vertex 4 X-coordinate</span>
<a name="ln-818"></a>  <span class="c">!       \units m</span>
<a name="ln-819"></a>  <span class="c">!       \type real</span>
<a name="ln-820"></a>  <span class="c">!  N14, \field Vertex 4 Y-coordinate</span>
<a name="ln-821"></a>  <span class="c">!       \type real</span>
<a name="ln-822"></a>  <span class="c">!       \units m</span>
<a name="ln-823"></a>  <span class="c">!  N15; \field Vertex 4 Z-coordinate</span>
<a name="ln-824"></a>  <span class="c">!       \units m</span>
<a name="ln-825"></a>  <span class="c">!       \type real</span>
<a name="ln-826"></a>
<a name="ln-827"></a>  <span class="c">! The vertices are stored in the surface derived type.</span>
<a name="ln-828"></a>  <span class="c">!</span>
<a name="ln-829"></a>  <span class="c">!      +(1)-------------------------(4)+</span>
<a name="ln-830"></a>  <span class="c">!      |                               |</span>
<a name="ln-831"></a>  <span class="c">!      |                               |</span>
<a name="ln-832"></a>  <span class="c">!      |                               |</span>
<a name="ln-833"></a>  <span class="c">!      +(2)-------------------------(3)+</span>
<a name="ln-834"></a>  <span class="c">!</span>
<a name="ln-835"></a>  <span class="c">!  The above diagram shows the actual coordinate points of a typical wall</span>
<a name="ln-836"></a>  <span class="c">!  (you&#39;re on the outside looking toward the wall) as stored into</span>
<a name="ln-837"></a>  <span class="c">!  Surface%Vertex(1:&lt;number-of-sides&gt;)</span>
<a name="ln-838"></a>  <span class="c">!</span>
<a name="ln-839"></a>  <span class="c">!</span>
<a name="ln-840"></a>  <span class="c">!</span>
<a name="ln-841"></a>
<a name="ln-842"></a>
<a name="ln-843"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-844"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-845"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-846"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-847"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-848"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleMinValue</span><span class="p">,</span> <span class="n">GetScheduleMaxValue</span>
<a name="ln-849"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span>
<a name="ln-850"></a>
<a name="ln-851"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-852"></a>
<a name="ln-853"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-854"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-855"></a>
<a name="ln-856"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-857"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SurfaceClass_Moved</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-858"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetSurfaceData: &#39;</span>
<a name="ln-859"></a>
<a name="ln-860"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-861"></a>          <span class="c">! na</span>
<a name="ln-862"></a>
<a name="ln-863"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-864"></a>          <span class="c">! na</span>
<a name="ln-865"></a>
<a name="ln-866"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-867"></a>
<a name="ln-868"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>         <span class="c">! Construction number</span>
<a name="ln-869"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SubSurfNum</span>        <span class="c">! DO loop counter/index for sub-surface number</span>
<a name="ln-870"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! DO loop counter/index for surface number</span>
<a name="ln-871"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>           <span class="c">! DO loop counter (zones)</span>
<a name="ln-872"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>             <span class="c">! For matching interzone surfaces</span>
<a name="ln-873"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNumFound</span>    <span class="c">! Construction number of matching interzone surface</span>
<a name="ln-874"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">NonMatch</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! Error for non-matching interzone surfaces</span>
<a name="ln-875"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Lay</span>               <span class="c">! Layer number</span>
<a name="ln-876"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MovedSurfs</span>        <span class="c">! Number of Moved Surfaces (when sorting into hierarchical structure)</span>
<a name="ln-877"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! General Surface Error, causes fatal error at end of routine</span>
<a name="ln-878"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-879"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BaseSurfNum</span>
<a name="ln-880"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLay</span>            <span class="c">! Total layers in a construction</span>
<a name="ln-881"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLayFound</span>       <span class="c">! Total layers in the construction of a matching interzone surface</span>
<a name="ln-882"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotDetachedFixed</span>  <span class="c">! Total Shading:Site:Detailed entries</span>
<a name="ln-883"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotDetachedBldg</span>   <span class="c">! Total Shading:Building:Detailed entries</span>
<a name="ln-884"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectDetachedFixed</span>  <span class="c">! Total Shading:Site entries</span>
<a name="ln-885"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectDetachedBldg</span>   <span class="c">! Total Shading:Building entries</span>
<a name="ln-886"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotHTSurfs</span>        <span class="c">! Number of BuildingSurface:Detailed items to obtain</span>
<a name="ln-887"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotDetailedWalls</span>  <span class="c">! Number of Wall:Detailed items to obtain</span>
<a name="ln-888"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotDetailedRoofs</span>  <span class="c">! Number of RoofCeiling:Detailed items to obtain</span>
<a name="ln-889"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotDetailedFloors</span> <span class="c">! Number of Floor:Detailed items to obtain</span>
<a name="ln-890"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotHTSubs</span>         <span class="c">! Number of FenestrationSurface:Detailed items to obtain</span>
<a name="ln-891"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotShdSubs</span>        <span class="c">! Number of Shading:Zone:Detailed items to obtain</span>
<a name="ln-892"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotIntMass</span>        <span class="c">! Number of InternalMass items to obtain</span>
<a name="ln-893"></a>  <span class="c">! Simple Surfaces (Rectangular)</span>
<a name="ln-894"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectExtWalls</span>   <span class="c">! Number of Exterior Walls to obtain</span>
<a name="ln-895"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIntWalls</span>   <span class="c">! Number of Adiabatic Walls to obtain</span>
<a name="ln-896"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIZWalls</span>    <span class="c">! Number of Interzone Walls to obtain</span>
<a name="ln-897"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectUGWalls</span>    <span class="c">! Number of Underground to obtain</span>
<a name="ln-898"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectRoofs</span>      <span class="c">! Number of Roofs to obtain</span>
<a name="ln-899"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectCeilings</span>   <span class="c">! Number of Adiabatic Ceilings to obtain</span>
<a name="ln-900"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIZCeilings</span> <span class="c">! Number of Interzone Ceilings to obtain</span>
<a name="ln-901"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectGCFloors</span>   <span class="c">! Number of Floors with Ground Contact to obtain</span>
<a name="ln-902"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIntFloors</span>  <span class="c">! Number of Adiabatic Walls to obtain</span>
<a name="ln-903"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIZFloors</span>   <span class="c">! Number of Interzone Floors to obtain</span>
<a name="ln-904"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectWindows</span>
<a name="ln-905"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectDoors</span>
<a name="ln-906"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectGlazedDoors</span>
<a name="ln-907"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIZWindows</span>
<a name="ln-908"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIZDoors</span>
<a name="ln-909"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotRectIZGlazedDoors</span>
<a name="ln-910"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotOverhangs</span>
<a name="ln-911"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotOverhangsProjection</span>
<a name="ln-912"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotFins</span>
<a name="ln-913"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotFinsProjection</span>
<a name="ln-914"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="n">ClassMsg</span>
<a name="ln-915"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="n">Msg2</span>
<a name="ln-916"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpaqueHTSurfs</span>     <span class="c">! Number of floors, walls and roofs in a zone</span>
<a name="ln-917"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpaqueHTSurfsWithWin</span> <span class="c">! Number of floors, walls and roofs with windows in a zone</span>
<a name="ln-918"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InternalMassSurfs</span> <span class="c">! Number of internal mass surfaces in a zone</span>
<a name="ln-919"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RelWarning</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-920"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNumSh</span>       <span class="c">! Shaded construction number for a window</span>
<a name="ln-921"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LayNumOutside</span>     <span class="c">! Outside material numbers for a shaded construction</span>
<a name="ln-922"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BlNum</span>             <span class="c">! Blind number</span>
<a name="ln-923"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WinShadingCtrlReferenced</span> <span class="c">! True if a WindowShadingControl is referenced by at least one window</span>
<a name="ln-924"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ShadingCtrl</span>       <span class="c">! WindowShadingControl number</span>
<a name="ln-925"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AddedSubSurfaces</span>  <span class="c">! Subsurfaces (windows) added when windows reference Window5 Data File</span>
<a name="ln-926"></a>                               <span class="c">! entries with two glazing systems</span>
<a name="ln-927"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NeedToAddSurfaces</span> <span class="c">! Surfaces that will be added due to &quot;unentered&quot; other zone surface</span>
<a name="ln-928"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NeedToAddSubSurfaces</span> <span class="c">! SubSurfaces that will be added due to &quot;unentered&quot; other zone surface</span>
<a name="ln-929"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurNewSurf</span>
<a name="ln-930"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FirstTotalSurfaces</span>
<a name="ln-931"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NVert</span>
<a name="ln-932"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Vert</span>
<a name="ln-933"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfWorldAz</span>
<a name="ln-935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">surfTilt</span>
<a name="ln-936"></a>
<a name="ln-937"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MultFound</span><span class="p">,</span> <span class="n">MultSurfNum</span>
<a name="ln-938"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MultString</span>
<a name="ln-939"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">WarningDisplayed</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-940"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrCount1</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-941"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrCount2</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-942"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrCount3</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-943"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrCount4</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! counts of interzone area mismatches.</span>
<a name="ln-944"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SubSurfaceSevereDisplayed</span>
<a name="ln-945"></a> <span class="c">! INTEGER :: Warning4Count=0  ! counts of nonmatched flat surface subsurface orientations</span>
<a name="ln-946"></a> <span class="c">! INTEGER :: Warning5Count=0  ! counts of nonmatched flat surface subsurface orientations - could not be resolved</span>
<a name="ln-947"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-948"></a>
<a name="ln-949"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iTmp1</span>
<a name="ln-950"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iTmp2</span>
<a name="ln-951"></a><span class="c">!unused  INTEGER :: SchID</span>
<a name="ln-952"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BlNumNew</span>
<a name="ln-953"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WinShadingControlPtr</span>
<a name="ln-954"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ShadingType</span>
<a name="ln-955"></a><span class="c">!unused  REAL(r64) :: SchSlatAngle = 0.0D0</span>
<a name="ln-956"></a><span class="c">!unused  LOGICAL :: initmsg</span>
<a name="ln-957"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">errCount</span>
<a name="ln-958"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">diffp</span>
<a name="ln-959"></a><span class="c">!  TYPE (vector), ALLOCATABLE, DIMENSION(:) :: TestVertex</span>
<a name="ln-960"></a><span class="c">!  INTEGER :: Vrt</span>
<a name="ln-961"></a><span class="c">!  INTEGER :: testV</span>
<a name="ln-962"></a><span class="c">!  INTEGER :: testVsave</span>
<a name="ln-963"></a><span class="c">!  INTEGER :: countSides</span>
<a name="ln-964"></a><span class="c">!  INTEGER :: LLCVrt</span>
<a name="ln-965"></a><span class="c">!  REAL(r64) :: maxX</span>
<a name="ln-966"></a><span class="c">!  REAL(r64) :: maxY</span>
<a name="ln-967"></a><span class="c">!  REAL(r64) :: testX</span>
<a name="ln-968"></a><span class="c">!  REAL(r64) :: testY</span>
<a name="ln-969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">surfAzimuth</span>
<a name="ln-970"></a><span class="c">!  LOGICAL :: Located</span>
<a name="ln-971"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">sameSurfNormal</span>
<a name="ln-972"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">izConstDiff</span>  <span class="c">! differences in construction for IZ surfaces</span>
<a name="ln-973"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">izConstDiffMsg</span>  <span class="c">! display message about hb diffs only once.</span>
<a name="ln-974"></a>
<a name="ln-975"></a>          <span class="c">! FLOW:</span>
<a name="ln-976"></a><span class="c">! Get the total number of surfaces to allocate derived type and for surface loops</span>
<a name="ln-977"></a>
<a name="ln-978"></a>  <span class="k">CALL </span><span class="n">GetGeometryParameters</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-979"></a>
<a name="ln-980"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-981"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">BuildingAzimuth</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">RelWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-982"></a>    <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-983"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">RelWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-984"></a>    <span class="n">ENDDO</span>
<a name="ln-985"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RelWarning</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarningDisplayed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-986"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;World Coordinate System selected.  &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-987"></a>                            <span class="s1">&#39;Any non-zero Building/Zone North Axes or non-zero Zone Origins are ignored.&#39;</span><span class="p">)</span>
<a name="ln-988"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;These may be used in daylighting reference point coordinate calculations &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-989"></a>         <span class="s1">&#39; but not in normal geometry inputs.&#39;</span><span class="p">)</span>
<a name="ln-990"></a>      <span class="n">WarningDisplayed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-991"></a>    <span class="n">ENDIF</span>
<a name="ln-992"></a>    <span class="n">RelWarning</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-993"></a>    <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-994"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginX</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">RelWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-995"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginY</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">RelWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-996"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginZ</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">RelWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-997"></a>    <span class="n">ENDDO</span>
<a name="ln-998"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RelWarning</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarningDisplayed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-999"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;World Coordinate System selected.  &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1000"></a>                            <span class="s1">&#39;Any non-zero Building/Zone North Axes or non-zero Zone Origins are ignored.&#39;</span><span class="p">)</span>
<a name="ln-1001"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;These may be used in daylighting reference point coordinate calculations &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1002"></a>         <span class="s1">&#39; but not in normal geometry inputs.&#39;</span><span class="p">)</span>
<a name="ln-1003"></a>      <span class="n">WarningDisplayed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1004"></a>    <span class="n">ENDIF</span>
<a name="ln-1005"></a>  <span class="n">ENDIF</span>
<a name="ln-1006"></a>
<a name="ln-1007"></a>
<a name="ln-1008"></a>  <span class="n">TotDetachedFixed</span>      <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Site:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1009"></a>  <span class="n">TotDetachedBldg</span>       <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Building:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1010"></a>  <span class="n">TotRectDetachedFixed</span>  <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Site&#39;</span><span class="p">)</span>
<a name="ln-1011"></a>  <span class="n">TotRectDetachedBldg</span>   <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Building&#39;</span><span class="p">)</span>
<a name="ln-1012"></a>  <span class="n">TotHTSurfs</span>            <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;BuildingSurface:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1013"></a>  <span class="n">TotDetailedWalls</span>      <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Wall:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1014"></a>  <span class="n">TotDetailedRoofs</span>      <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;RoofCeiling:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1015"></a>  <span class="n">TotDetailedFloors</span>     <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Floor:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1016"></a>  <span class="n">TotHTSubs</span>             <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;FenestrationSurface:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1017"></a>  <span class="n">TotShdSubs</span>            <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Zone:Detailed&#39;</span><span class="p">)</span>
<a name="ln-1018"></a>  <span class="n">TotOverhangs</span>          <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Overhang&#39;</span><span class="p">)</span>
<a name="ln-1019"></a>  <span class="n">TotOverhangsProjection</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Overhang:Projection&#39;</span><span class="p">)</span>
<a name="ln-1020"></a>  <span class="n">TotFins</span>               <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Fin&#39;</span><span class="p">)</span>
<a name="ln-1021"></a>  <span class="n">TotFinsProjection</span>     <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Shading:Fin:Projection&#39;</span><span class="p">)</span>
<a name="ln-1022"></a>  <span class="n">TotIntMass</span>            <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;InternalMass&#39;</span><span class="p">)</span>
<a name="ln-1023"></a>  <span class="n">TotRectWindows</span>        <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Window&#39;</span><span class="p">)</span>
<a name="ln-1024"></a>  <span class="n">TotRectDoors</span>          <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Door&#39;</span><span class="p">)</span>
<a name="ln-1025"></a>  <span class="n">TotRectGlazedDoors</span>    <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;GlazedDoor&#39;</span><span class="p">)</span>
<a name="ln-1026"></a>  <span class="n">TotRectIZWindows</span>      <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Window:Interzone&#39;</span><span class="p">)</span>
<a name="ln-1027"></a>  <span class="n">TotRectIZDoors</span>        <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Door:Interzone&#39;</span><span class="p">)</span>
<a name="ln-1028"></a>  <span class="n">TotRectIZGlazedDoors</span>  <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;GlazedDoor:Interzone&#39;</span><span class="p">)</span>
<a name="ln-1029"></a>  <span class="n">TotRectExtWalls</span>       <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Wall:Exterior&#39;</span><span class="p">)</span>
<a name="ln-1030"></a>  <span class="n">TotRectIntWalls</span>       <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Wall:Adiabatic&#39;</span><span class="p">)</span>
<a name="ln-1031"></a>  <span class="n">TotRectIZWalls</span>        <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Wall:Interzone&#39;</span><span class="p">)</span>
<a name="ln-1032"></a>  <span class="n">TotRectUGWalls</span>        <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Wall:Underground&#39;</span><span class="p">)</span>
<a name="ln-1033"></a>  <span class="n">TotRectRoofs</span>          <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Roof&#39;</span><span class="p">)</span>
<a name="ln-1034"></a>  <span class="n">TotRectCeilings</span>       <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Ceiling:Adiabatic&#39;</span><span class="p">)</span>
<a name="ln-1035"></a>  <span class="n">TotRectIZCeilings</span>     <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Ceiling:Interzone&#39;</span><span class="p">)</span>
<a name="ln-1036"></a>  <span class="n">TotRectGCFloors</span>       <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Floor:GroundContact&#39;</span><span class="p">)</span>
<a name="ln-1037"></a>  <span class="n">TotRectIntFloors</span>      <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Floor:Adiabatic &#39;</span><span class="p">)</span>
<a name="ln-1038"></a>  <span class="n">TotRectIZFloors</span>       <span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Floor:Interzone&#39;</span><span class="p">)</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>  <span class="n">TotOSC</span>     <span class="o">=</span><span class="mi">0</span>
<a name="ln-1041"></a>
<a name="ln-1042"></a>  <span class="n">TotSurfaces</span><span class="o">=</span><span class="p">(</span><span class="n">TotDetachedFixed</span><span class="o">+</span><span class="n">TotDetachedBldg</span><span class="o">+</span><span class="n">TotRectDetachedFixed</span><span class="o">+</span><span class="n">TotRectDetachedBldg</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1043"></a>     <span class="n">TotHTSurfs</span> <span class="o">+</span> <span class="n">TotHTSubs</span> <span class="o">+</span> <span class="n">TotShdSubs</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">TotIntMass</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-1044"></a>     <span class="n">TotOverhangs</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">TotOverhangsProjection</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">TotFins</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="n">TotFinsProjection</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1045"></a>     <span class="n">TotDetailedWalls</span> <span class="o">+</span> <span class="n">TotDetailedRoofs</span> <span class="o">+</span> <span class="n">TotDetailedFloors</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1046"></a>     <span class="n">TotRectWindows</span> <span class="o">+</span> <span class="n">TotRectDoors</span> <span class="o">+</span> <span class="n">TotRectGlazedDoors</span> <span class="o">+</span> <span class="n">TotRectIZWindows</span> <span class="o">+</span> <span class="n">TotRectIZDoors</span> <span class="o">+</span> <span class="n">TotRectIZGlazedDoors</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1047"></a>     <span class="n">TotRectExtWalls</span> <span class="o">+</span> <span class="n">TotRectIntWalls</span> <span class="o">+</span> <span class="n">TotRectIZWalls</span> <span class="o">+</span> <span class="n">TotRectUGWalls</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1048"></a>     <span class="n">TotRectRoofs</span> <span class="o">+</span> <span class="n">TotRectCeilings</span> <span class="o">+</span> <span class="n">TotRectIZCeilings</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1049"></a>     <span class="n">TotRectGCFloors</span> <span class="o">+</span> <span class="n">TotRectIntFloors</span> <span class="o">+</span> <span class="n">TotRectIZFloors</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>   <span class="c">! Allocate the Surface derived type appropriately</span>
<a name="ln-1052"></a>    <span class="c">! SurfaceTmp structure is allocated via derived type initialization.</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a>  <span class="n">SurfNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1055"></a>  <span class="n">AddedSubSurfaces</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1056"></a>  <span class="n">AskForSurfacesReport</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>  <span class="k">CALL </span><span class="n">GetDetShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotDetachedFixed</span><span class="p">,</span><span class="n">TotDetachedBldg</span><span class="p">)</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>  <span class="k">CALL </span><span class="n">GetRectDetShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotRectDetachedFixed</span><span class="p">,</span><span class="n">TotRectDetachedBldg</span><span class="p">)</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a>  <span class="k">CALL </span><span class="n">GetHTSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotHTSurfs</span><span class="p">,</span><span class="n">TotDetailedWalls</span><span class="p">,</span><span class="n">TotDetailedRoofs</span><span class="p">,</span><span class="n">TotDetailedFloors</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1063"></a>                 <span class="n">BaseSurfCls</span><span class="p">,</span><span class="n">BaseSurfIDs</span><span class="p">,</span><span class="n">NeedToAddSurfaces</span><span class="p">)</span>
<a name="ln-1064"></a>
<a name="ln-1065"></a>  <span class="k">CALL </span><span class="n">GetRectSurfaces</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotRectExtWalls</span><span class="p">,</span><span class="n">TotRectIntWalls</span><span class="p">,</span><span class="n">TotRectIZWalls</span><span class="p">,</span><span class="n">TotRectUGWalls</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1066"></a>      <span class="n">TotRectRoofs</span><span class="p">,</span><span class="n">TotRectCeilings</span><span class="p">,</span><span class="n">TotRectIZCeilings</span><span class="p">,</span><span class="n">TotRectGCFloors</span><span class="p">,</span><span class="n">TotRectIntFloors</span><span class="p">,</span><span class="n">TotRectIZFloors</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1067"></a>      <span class="n">BaseSurfIDs</span><span class="p">,</span><span class="n">NeedToAddSurfaces</span><span class="p">)</span>
<a name="ln-1068"></a>
<a name="ln-1069"></a>  <span class="k">CALL </span><span class="n">GetHTSubSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotHTSubs</span><span class="p">,</span><span class="n">SubSurfCls</span><span class="p">,</span><span class="n">SubSurfIDs</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">,</span><span class="n">NeedToAddSubSurfaces</span><span class="p">)</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>  <span class="k">CALL </span><span class="n">GetRectSubSurfaces</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotRectWindows</span><span class="p">,</span><span class="n">TotRectDoors</span><span class="p">,</span><span class="n">TotRectGlazedDoors</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1072"></a>      <span class="n">TotRectIZWindows</span><span class="p">,</span><span class="n">TotRectIZDoors</span><span class="p">,</span><span class="n">TotRectIZGlazedDoors</span><span class="p">,</span><span class="n">SubSurfIDs</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">,</span><span class="n">NeedToAddSubSurfaces</span><span class="p">)</span>
<a name="ln-1073"></a>
<a name="ln-1074"></a>  <span class="k">CALL </span><span class="n">GetAttShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotShdSubs</span><span class="p">)</span>
<a name="ln-1075"></a>
<a name="ln-1076"></a>  <span class="k">CALL </span><span class="n">GetSimpleShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotOverhangs</span><span class="p">,</span><span class="n">TotOverhangsProjection</span><span class="p">,</span><span class="n">TotFins</span><span class="p">,</span><span class="n">TotFinsProjection</span><span class="p">)</span>
<a name="ln-1077"></a>
<a name="ln-1078"></a>  <span class="k">CALL </span><span class="n">GetIntMassSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotIntMass</span><span class="p">)</span>
<a name="ln-1079"></a>
<a name="ln-1080"></a>  <span class="k">CALL </span><span class="n">GetMovableInsulationData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1081"></a>
<a name="ln-1082"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">CALL </span><span class="n">GetShadingSurfReflectanceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1083"></a>
<a name="ln-1084"></a>  <span class="n">TotSurfaces</span><span class="o">=</span><span class="n">SurfNum</span> <span class="o">+</span> <span class="n">AddedSubSurfaces</span> <span class="o">+</span> <span class="n">NeedToAddSurfaces</span> <span class="o">+</span> <span class="n">NeedToAddSubSurfaces</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>  <span class="c">! Have to make room for added surfaces, if needed</span>
<a name="ln-1087"></a>  <span class="n">FirstTotalSurfaces</span><span class="o">=</span><span class="n">SurfNum</span> <span class="o">+</span> <span class="n">AddedSubSurfaces</span>
<a name="ln-1088"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NeedToAddSurfaces</span><span class="o">+</span><span class="n">NeedToAddSubsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1089"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmpSave</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-1090"></a>    <span class="n">SurfaceTmpSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">FirstTotalSurfaces</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span>
<a name="ln-1091"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">)</span>
<a name="ln-1092"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-1093"></a>    <span class="n">SurfaceTmp</span><span class="o">=</span><span class="n">SurfaceTmpSave</span>
<a name="ln-1094"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmpSave</span><span class="p">)</span>
<a name="ln-1095"></a>  <span class="n">ENDIF</span>
<a name="ln-1096"></a>
<a name="ln-1097"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-1098"></a>
<a name="ln-1099"></a><span class="c">! add the &quot;need to add&quot; surfaces</span>
<a name="ln-1100"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">NeedtoAddSurfaces</span><span class="o">+</span><span class="n">NeedToAddSubSurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-1101"></a><span class="c">!Debug    write(outputfiledebug,*) &#39; need to add &#39;,NeedtoAddSurfaces+NeedToAddSubSurfaces</span>
<a name="ln-1102"></a>  <span class="n">CurNewSurf</span><span class="o">=</span><span class="n">FirstTotalSurfaces</span>
<a name="ln-1103"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">FirstTotalSurfaces</span>
<a name="ln-1104"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">UnenteredAdjacentZoneSurface</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1105"></a>    <span class="c">! Need to add surface</span>
<a name="ln-1106"></a>    <span class="n">CurNewSurf</span><span class="o">=</span><span class="n">CurNewSurf</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1107"></a><span class="c">!Debug    write(outputfiledebug,*) &#39; adding surface=&#39;,curnewsurf</span>
<a name="ln-1108"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-1109"></a>    <span class="c">!  Basic parameters are the same for both surfaces.</span>
<a name="ln-1110"></a>    <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1111"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1112"></a><span class="k">    </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1113"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1114"></a>    <span class="c">! Reverse Construction</span>
<a name="ln-1115"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Construction</span><span class="o">=</span><span class="n">AssignReverseConstructionNumber</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">,</span><span class="n">SurfError</span><span class="p">)</span>
<a name="ln-1116"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1117"></a>    <span class="c">! Reverse Vertices</span>
<a name="ln-1118"></a>    <span class="n">NVert</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1119"></a>    <span class="k">DO </span><span class="n">Vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1120"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vert</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NVert</span><span class="p">)</span>
<a name="ln-1121"></a>      <span class="n">NVert</span><span class="o">=</span><span class="n">NVert</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1122"></a>    <span class="n">ENDDO</span>
<a name="ln-1123"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1124"></a><span class="k">      CALL </span><span class="n">CreateNewellAreaVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1125"></a>           <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-1126"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-1127"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Area</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-1128"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-1129"></a>      <span class="k">CALL </span><span class="n">CreateNewellSurfaceNormalVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1130"></a>           <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-1131"></a>      <span class="k">CALL </span><span class="n">DetermineAzimuthAndTilt</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfWorldAz</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1132"></a>                                   <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1133"></a>                                   <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-1134"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfWorldAz</span>
<a name="ln-1135"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">SurfTilt</span>
<a name="ln-1136"></a>
<a name="ln-1137"></a>      <span class="c">! Sine and cosine of azimuth and tilt</span>
<a name="ln-1138"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">SinAzim</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-1139"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-1140"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">SinTilt</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-1141"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-1142"></a>      <span class="c">! Outward normal unit vector (pointing away from room)</span>
<a name="ln-1143"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OutNormVec</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span>
<a name="ln-1144"></a>      <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1145"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-1146"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-1147"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>     <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-1148"></a>      <span class="n">ENDDO</span>
<a name="ln-1149"></a>
<a name="ln-1150"></a>      <span class="c">! Can perform tests on this surface here</span>
<a name="ln-1151"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="o">=</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-1152"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ViewFactorGround</span><span class="o">=</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-1153"></a>
<a name="ln-1154"></a>      <span class="c">! The following IR view factors are modified in subr. SkyDifSolarShading if there are shadowing</span>
<a name="ln-1155"></a>      <span class="c">! surfaces</span>
<a name="ln-1156"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-1157"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-1158"></a>    <span class="n">ENDIF</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a>
<a name="ln-1161"></a>    <span class="c">! Change Name</span>
<a name="ln-1162"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="s1">&#39;iz-&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1163"></a><span class="c">!Debug   write(outputfiledebug,*) &#39; new surf name=&#39;,trim(SurfaceTmp(CurNewSurf)%Name)</span>
<a name="ln-1164"></a><span class="c">!Debug   write(outputfiledebug,*) &#39; new surf in zone=&#39;,trim(surfacetmp(curnewsurf)%zoneName)</span>
<a name="ln-1165"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-1166"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-1167"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1168"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1169"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-1170"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-1171"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1172"></a>        <span class="c">! base surface</span>
<a name="ln-1173"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1174"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceClass_Floor</span>
<a name="ln-1175"></a><span class="c">!Debug          write(outputfiledebug,*) &#39; new surfaces is a floor&#39;</span>
<a name="ln-1176"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1177"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceClass_Roof</span>
<a name="ln-1178"></a><span class="c">!Debug          write(outputfiledebug,*) &#39; new surfaces is a roof&#39;</span>
<a name="ln-1179"></a>        <span class="n">ENDIF</span>
<a name="ln-1180"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">CurNewSurf</span>
<a name="ln-1181"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurnewSurf</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1182"></a><span class="c">!Debug        write(outputfiledebug,*) &#39; basesurf, extboundcondname=&#39;,trim(SurfaceTmp(CurNewSurf)%ExtBoundCondName)</span>
<a name="ln-1183"></a>    <span class="k">ELSE</span>
<a name="ln-1184"></a>        <span class="c">! subsurface</span>
<a name="ln-1185"></a>      <span class="n">Found</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="s1">&#39;iz-&#39;</span><span class="o">//</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FirstTotalSurfaces</span><span class="o">+</span><span class="n">CurNewSurf</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1186"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1187"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="s1">&#39;iz-&#39;</span><span class="o">//</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span>
<a name="ln-1188"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1189"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1190"></a>               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-1191"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1192"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1193"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1194"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-1195"></a>        <span class="k">ELSE</span> <span class="c">! Door, TDD:Diffuser, TDD:DOME</span>
<a name="ln-1196"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1197"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-1198"></a>        <span class="n">ENDIF</span>
<a name="ln-1199"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-1200"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1201"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-1202"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-1203"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-1204"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span>
<a name="ln-1205"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">CurNewSurf</span><span class="p">)%</span><span class="n">OSCPtr</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">OSCPtr</span>
<a name="ln-1206"></a><span class="c">!Debug        write(outputfiledebug,*) &#39; subsurf, extboundcondname=&#39;,trim(SurfaceTmp(CurNewSurf)%ExtBoundCondName)</span>
<a name="ln-1207"></a><span class="c">!Debug        write(outputfiledebug,*) &#39; subsurf, basesurf=&#39;,trim(&#39;iz-&#39;//SurfaceTmp(SurfNum)%BaseSurfName)</span>
<a name="ln-1208"></a>      <span class="k">ELSE</span>
<a name="ln-1209"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Adding unentered subsurface, could not find base surface=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1210"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;iz-&#39;</span><span class="o">//</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">))</span>
<a name="ln-1211"></a>        <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1212"></a>      <span class="n">ENDIF</span>
<a name="ln-1213"></a>    <span class="n">ENDIF</span>
<a name="ln-1214"></a>
<a name="ln-1215"></a>  <span class="n">ENDDO</span>
<a name="ln-1216"></a><span class="c">!**********************************************************************************</span>
<a name="ln-1217"></a><span class="c">! After all of the surfaces have been defined then the base surfaces for the</span>
<a name="ln-1218"></a><span class="c">! sub-surfaces can be defined.  Loop through surfaces and match with the sub-surface</span>
<a name="ln-1219"></a><span class="c">! names.</span>
<a name="ln-1220"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-1221"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>    <span class="c">! why are we doing this again?  this should have already been done.</span>
<a name="ln-1224"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1225"></a><span class="k">      </span><span class="n">Found</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-1226"></a>    <span class="k">ELSE</span>
<a name="ln-1227"></a><span class="k">      </span><span class="n">Found</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-1228"></a>    <span class="n">ENDIF</span>
<a name="ln-1229"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1230"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1231"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNum</span> <span class="o">/=</span> <span class="n">Found</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! for subsurfaces</span>
<a name="ln-1232"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">NumSubSurfaces</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">NumSubSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1233"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">&lt;</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-1234"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">&gt;</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1235"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1236"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Invalid SubSurface detected, Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1237"></a>          <span class="k">ELSE</span>
<a name="ln-1238"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Invalid SubSurface detected, Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1239"></a>               <span class="s1">&#39;, class=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BaseSurfCls</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid class for subsurface&#39;</span><span class="p">)</span>
<a name="ln-1240"></a>            <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1241"></a>          <span class="n">ENDIF</span>
<a name="ln-1242"></a>        <span class="n">ENDIF</span>
<a name="ln-1243"></a>      <span class="n">ENDIF</span>
<a name="ln-1244"></a>    <span class="k">End If</span>
<a name="ln-1245"></a>
<a name="ln-1246"></a><span class="k">  END DO</span>  <span class="c">! ...end of the Surface DO loop for finding BaseSurf</span>
<a name="ln-1247"></a><span class="c">!**********************************************************************************</span>
<a name="ln-1248"></a>
<a name="ln-1249"></a><span class="c">!**********************************************************************************</span>
<a name="ln-1250"></a><span class="c">! orientation of flat subsurfaces (window/door/etc) need to match base surface</span>
<a name="ln-1251"></a><span class="c">! CR8628</span>
<a name="ln-1252"></a><span class="c">!  ALLOCATE(TestVertex(4)) ! subsurfaces we will look at have max of 4 vertices</span>
<a name="ln-1253"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1254"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1255"></a>    <span class="c">! If flat surface</span>
<a name="ln-1256"></a>    <span class="n">surfAzimuth</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-1257"></a>    <span class="n">surfTilt</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-1258"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">surfTilt</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.d-5</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">surfTilt</span><span class="o">-</span><span class="mi">18</span><span class="mf">0.d0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.d-5</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-1259"></a>      <span class="c">! see if there are any subsurfaces on roofs/floors</span>
<a name="ln-1260"></a>      <span class="k">DO </span><span class="n">itmp1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1261"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">itmp1</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1262"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1263"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1264"></a><span class="c">!          write(outputfiledebug,&#39;(A)&#39;) &#39;roof/floor basesurface=&#39;//trim(SurfaceTmp(SurfNum)%Name)</span>
<a name="ln-1265"></a><span class="c">!          write(outputfiledebug,&#39;(A,3f7.2)&#39;) &#39;basesurface lc vectors=&#39;,SurfaceTmp(SurfNum)%lcsx</span>
<a name="ln-1266"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) SurfaceTmp(SurfNum)%lcsy</span>
<a name="ln-1267"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) SurfaceTmp(SurfNum)%lcsz</span>
<a name="ln-1268"></a><span class="c">!          write(outputfiledebug,&#39;(A,3f7.2)&#39;) &#39;basesurface surfnorm=&#39;,SurfaceTmp(SurfNum)%NewellSurfaceNormalVector</span>
<a name="ln-1269"></a><span class="c">!          write(outputfiledebug,&#39;(A)&#39;) &#39;subsurface=&#39;//trim(SurfaceTmp(itmp1)%Name)</span>
<a name="ln-1270"></a><span class="c">!          write(outputfiledebug,&#39;(A,3f7.2)&#39;) &#39;subsurface lc vectors=&#39;,SurfaceTmp(itmp1)%lcsx</span>
<a name="ln-1271"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) SurfaceTmp(itmp1)%lcsy</span>
<a name="ln-1272"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) SurfaceTmp(itmp1)%lcsz</span>
<a name="ln-1273"></a><span class="c">!          write(outputfiledebug,&#39;(A,3f7.2)&#39;) &#39;subsurface surfnorm=&#39;,SurfaceTmp(itmp1)%NewellSurfaceNormalVector</span>
<a name="ln-1274"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="n">surfAzimuth</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1275"></a><span class="k">        CALL </span><span class="n">CompareTwoVectors</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1276"></a>           <span class="n">sameSurfNormal</span><span class="p">,.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span>
<a name="ln-1277"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">sameSurfNormal</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! copy lcs vectors</span>
<a name="ln-1278"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">lcsx</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span>
<a name="ln-1279"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">lcsy</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span>
<a name="ln-1280"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">lcsy</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span>
<a name="ln-1281"></a>          <span class="k">CYCLE</span>
<a name="ln-1282"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1283"></a><span class="c">!        IF (ABS(SurfaceTmp(itmp1)%Azimuth-360.0d0) &lt; .01d0) THEN</span>
<a name="ln-1284"></a><span class="c">!          SurfaceTmp(itmp1)%Azimuth=360.0d0-SurfaceTmp(itmp1)%Azimuth</span>
<a name="ln-1285"></a><span class="c">!        ENDIF</span>
<a name="ln-1286"></a><span class="c">!        IF (ABS(surfAzimuth-360.0d0) &lt; .01d0) THEN</span>
<a name="ln-1287"></a><span class="c">!          surfAzimuth=360.0d0-surfAzimuth</span>
<a name="ln-1288"></a><span class="c">!          SurfaceTmp(SurfNum)%Azimuth=surfAzimuth</span>
<a name="ln-1289"></a><span class="c">!        ENDIF</span>
<a name="ln-1290"></a><span class="c">!        IF (ABS(SurfaceTmp(itmp1)%Azimuth-surfAzimuth) &lt;= 10.d0) CYCLE</span>
<a name="ln-1291"></a>        <span class="c">! have subsurface of base surface</span>
<a name="ln-1292"></a>        <span class="c">! warning error</span>
<a name="ln-1293"></a><span class="c">!        Warning4Count=Warning4Count+1</span>
<a name="ln-1294"></a><span class="c">!        IF (Warning4Count == 1 .and. .not. DisplayExtraWarnings) THEN</span>
<a name="ln-1295"></a><span class="c">!          CALL ShowSevereError(Routinename//&#39;Some Outward Facing angles of subsurfaces differ &#39;//  &amp;</span>
<a name="ln-1296"></a><span class="c">!                               &#39;significantly from flat roof/floor base surface.&#39;)</span>
<a name="ln-1297"></a><span class="c">!          CALL ShowContinueError(&#39;Fixes will be attempted to align subsurface with base surface.&#39;)</span>
<a name="ln-1298"></a><span class="c">!          CALL ShowContinueError(&#39;...use Output:Diagnostics,DisplayExtraWarnings; &#39;//  &amp;</span>
<a name="ln-1299"></a><span class="c">!                   &#39;to show more details on individual surfaces.&#39;)</span>
<a name="ln-1300"></a><span class="c">!        ENDIF</span>
<a name="ln-1301"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1302"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">Routinename</span><span class="o">//</span><span class="s1">&#39;Outward facing angle [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1303"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1304"></a>               <span class="s1">&#39;] of subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">itmp1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1305"></a>               <span class="s1">&#39;&quot; significantly different than&#39;</span><span class="p">)</span>
<a name="ln-1306"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..facing angle [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1307"></a>              <span class="s1">&#39;] of base surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1308"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..surface class of base surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1309"></a><span class="c">!          CALL ShowContinueError(&#39;Fixes will be attempted to align subsurface with base surface.&#39;)</span>
<a name="ln-1310"></a>        <span class="n">ENDIF</span>
<a name="ln-1311"></a><span class="c">!        Vrt=1</span>
<a name="ln-1312"></a><span class="c">!        testV=2</span>
<a name="ln-1313"></a><span class="c">!        testVsave=2</span>
<a name="ln-1314"></a><span class="c">!        Located=.false.</span>
<a name="ln-1315"></a><span class="c">!        DO CountSides=1,SurfaceTmp(itmp1)%Sides</span>
<a name="ln-1316"></a><span class="c">!          DO Vrt=1,SurfaceTmp(itmp1)%Sides</span>
<a name="ln-1317"></a><span class="c">!            TestVertex(Vrt)=SurfaceTmp(itmp1)%Vertex(testV)</span>
<a name="ln-1318"></a><span class="c">!            testV=testV+1</span>
<a name="ln-1319"></a><span class="c">!            if (testV &gt; SurfaceTmp(itmp1)%Sides) testV=1</span>
<a name="ln-1320"></a><span class="c">!          ENDDO</span>
<a name="ln-1321"></a><span class="c">!          CALL CreateNewellSurfaceNormalVector(TestVertex,SurfaceTmp(itmp1)%Sides,  &amp;</span>
<a name="ln-1322"></a><span class="c">!                SurfaceTmp(itmp1)%NewellSurfaceNormalVector)</span>
<a name="ln-1323"></a><span class="c">!          CALL DetermineAzimuthAndTilt(TestVertex,SurfaceTmp(itmp1)%Sides,SurfWorldAz,surfTilt,  &amp;</span>
<a name="ln-1324"></a><span class="c">!                                SurfaceTmp(itmp1)%lcsx,SurfaceTmp(itmp1)%lcsy,SurfaceTmp(itmp1)%lcsz,  &amp;</span>
<a name="ln-1325"></a><span class="c">!                                SurfaceTmp(itmp1)%GrossArea,SurfaceTmp(itmp1)%NewellSurfaceNormalVector)</span>
<a name="ln-1326"></a><span class="c">!          IF (ABS(surfAzimuth-surfWorldAz) &lt;= 1.d-5) THEN  ! found it</span>
<a name="ln-1327"></a><span class="c">!            DO Vrt=1,SurfaceTmp(itmp1)%Sides</span>
<a name="ln-1328"></a><span class="c">!              SurfaceTmp(itmp1)%Vertex(Vrt)=TestVertex(Vrt)</span>
<a name="ln-1329"></a><span class="c">!            ENDDO</span>
<a name="ln-1330"></a><span class="c">!            SurfaceTmp(itmp1)%Azimuth=SurfWorldAz</span>
<a name="ln-1331"></a><span class="c">!            SurfaceTmp(itmp1)%Tilt=surfTilt</span>
<a name="ln-1332"></a><span class="c">!            Located=.true.</span>
<a name="ln-1333"></a><span class="c">!            EXIT</span>
<a name="ln-1334"></a><span class="c">!          ENDIF</span>
<a name="ln-1335"></a><span class="c">!          testV=testVsave+1</span>
<a name="ln-1336"></a><span class="c">!          IF (testV &gt; SurfaceTmp(itmp1)%Sides) EXIT</span>
<a name="ln-1337"></a><span class="c">!        ENDDO</span>
<a name="ln-1338"></a><span class="c">!        IF (.not. Located) THEN</span>
<a name="ln-1339"></a><span class="c">!          Warning5Count=Warning5Count+1</span>
<a name="ln-1340"></a><span class="c">!          ! another warning</span>
<a name="ln-1341"></a><span class="c">!          IF (DisplayExtraWarnings) THEN</span>
<a name="ln-1342"></a><span class="c">!            CALL ShowContinueError(&#39;Fix could not be accomplished.  Original orientation is retained.&#39;)</span>
<a name="ln-1343"></a><span class="c">!          ENDIF</span>
<a name="ln-1344"></a><span class="c">!          CALL CreateNewellSurfaceNormalVector(SurfaceTmp(itmp1)%Vertex,SurfaceTmp(itmp1)%Sides,  &amp;</span>
<a name="ln-1345"></a><span class="c">!                  SurfaceTmp(itmp1)%NewellSurfaceNormalVector)</span>
<a name="ln-1346"></a><span class="c">!          CALL DetermineAzimuthAndTilt(SurfaceTmp(itmp1)%Vertex,SurfaceTmp(itmp1)%Sides,SurfWorldAz,surfTilt,  &amp;</span>
<a name="ln-1347"></a><span class="c">!                                SurfaceTmp(itmp1)%lcsx,SurfaceTmp(itmp1)%lcsy,SurfaceTmp(itmp1)%lcsz,  &amp;</span>
<a name="ln-1348"></a><span class="c">!                                SurfaceTmp(itmp1)%GrossArea,SurfaceTmp(itmp1)%NewellSurfaceNormalVector)</span>
<a name="ln-1349"></a><span class="c">!          SurfaceTmp(itmp1)%Azimuth=SurfWorldAz</span>
<a name="ln-1350"></a><span class="c">!          SurfaceTmp(itmp1)%Tilt=surfTilt</span>
<a name="ln-1351"></a><span class="c">!        ENDIF</span>
<a name="ln-1352"></a>      <span class="n">ENDDO</span>
<a name="ln-1353"></a>    <span class="n">ENDIF</span>
<a name="ln-1354"></a>  <span class="n">ENDDO</span>
<a name="ln-1355"></a><span class="c">!  IF (Warning5Count &gt; 0) THEN</span>
<a name="ln-1356"></a><span class="c">!    CALL ShowMessage(RoutineName//&#39;There were &#39;//trim(RoundSigDigits(Warning5Count))//  &amp;</span>
<a name="ln-1357"></a><span class="c">!       &#39; subsurfaces whose orientation (azimuth) could not be fixed to align with the base surface.&#39;)</span>
<a name="ln-1358"></a><span class="c">!    CALL ShowMessage(&#39;Shadowing calculations may be inaccurate. Use Output:Diagnostics,DisplayExtraWarnings; for details.&#39;)</span>
<a name="ln-1359"></a><span class="c">!  ENDIF</span>
<a name="ln-1360"></a><span class="c">!  DEALLOCATE(TestVertex)</span>
<a name="ln-1361"></a>
<a name="ln-1362"></a><span class="c">! The surfaces need to be hierarchical.  Input is allowed to be in any order.  In</span>
<a name="ln-1363"></a><span class="c">! this section it is reordered into:</span>
<a name="ln-1364"></a>
<a name="ln-1365"></a><span class="c">!    Detached shadowing surfaces</span>
<a name="ln-1366"></a><span class="c">!    For each zone:</span>
<a name="ln-1367"></a><span class="c">!      For each Wall</span>
<a name="ln-1368"></a><span class="c">!        subsurfaces (windows, doors, shading) for that wall</span>
<a name="ln-1369"></a><span class="c">!      For each Floor</span>
<a name="ln-1370"></a><span class="c">!        subsurfaces for that floor</span>
<a name="ln-1371"></a><span class="c">!      For each Roof</span>
<a name="ln-1372"></a><span class="c">!        subsurfaces for that roof/ceiling</span>
<a name="ln-1373"></a><span class="c">!      Internal Mass</span>
<a name="ln-1374"></a><span class="c">!</span>
<a name="ln-1375"></a><span class="c">!    After reordering, MovedSurfs should equal TotSurfaces</span>
<a name="ln-1376"></a>
<a name="ln-1377"></a>  <span class="n">MovedSurfs</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1378"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>   <span class="c">! Allocate the Surface derived type appropriately</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a>  <span class="c">! Move all Detached Surfaces to Front</span>
<a name="ln-1381"></a>
<a name="ln-1382"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1383"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Detached_F</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1384"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Detached_B</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1385"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1386"></a>
<a name="ln-1387"></a>    <span class="c">!  A shading surface</span>
<a name="ln-1388"></a>
<a name="ln-1389"></a>    <span class="n">MovedSurfs</span><span class="o">=</span><span class="n">MovedSurfs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1390"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">MovedSurfs</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-1391"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceClass_Moved</span> <span class="c">!&#39;Moved&#39;</span>
<a name="ln-1392"></a>  <span class="n">ENDDO</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>  <span class="c">!  For each zone</span>
<a name="ln-1395"></a>
<a name="ln-1396"></a>  <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1397"></a>
<a name="ln-1398"></a>    <span class="c">!  For each Base Surface Type (Wall, Floor, Roof)</span>
<a name="ln-1399"></a>
<a name="ln-1400"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1401"></a>
<a name="ln-1402"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1403"></a>
<a name="ln-1404"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1405"></a>
<a name="ln-1406"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-1407"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">BaseSurfIDs</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a><span class="k">        </span><span class="n">MovedSurfs</span><span class="o">=</span><span class="n">MovedSurfs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1410"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">MovedSurfs</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-1411"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceClass_Moved</span> <span class="c">! &#39;Moved&#39;</span>
<a name="ln-1412"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=-</span><span class="mi">1</span> <span class="c">! Default has base surface = base surface</span>
<a name="ln-1413"></a>        <span class="n">BaseSurfNum</span><span class="o">=</span><span class="n">MovedSurfs</span>
<a name="ln-1414"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">MovedSurfs</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">BaseSurfNum</span>
<a name="ln-1415"></a>
<a name="ln-1416"></a>        <span class="c">!  Find all subsurfaces to this surface</span>
<a name="ln-1417"></a>        <span class="k">DO </span><span class="n">SubSurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1418"></a>
<a name="ln-1419"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1420"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a><span class="k">          </span><span class="n">MovedSurfs</span><span class="o">=</span><span class="n">MovedSurfs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1423"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">MovedSurfs</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)</span>
<a name="ln-1424"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceClass_Moved</span> <span class="c">! &#39;Moved&#39;</span>
<a name="ln-1425"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">MovedSurfs</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">BaseSurfNum</span>
<a name="ln-1426"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-1427"></a>        <span class="n">ENDDO</span>
<a name="ln-1428"></a>      <span class="n">ENDDO</span>
<a name="ln-1429"></a>    <span class="n">ENDDO</span>
<a name="ln-1430"></a>
<a name="ln-1431"></a>    <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span> <span class="o">/=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1434"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a><span class="k">      </span><span class="n">MovedSurfs</span><span class="o">=</span><span class="n">MovedSurfs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1437"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">MovedSurfs</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-1438"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">MovedSurfs</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">MovedSurfs</span>
<a name="ln-1439"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceClass_Moved</span> <span class="c">! &#39;Moved&#39;</span>
<a name="ln-1440"></a>    <span class="n">ENDDO</span>
<a name="ln-1441"></a>  <span class="n">ENDDO</span>
<a name="ln-1442"></a>
<a name="ln-1443"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MovedSurfs</span> <span class="o">/=</span> <span class="n">TotSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1444"></a><span class="k">    WRITE</span><span class="p">(</span><span class="n">ClassMsg</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">MovedSurfs</span>
<a name="ln-1445"></a>    <span class="n">ClassMsg</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ClassMsg</span><span class="p">)</span>
<a name="ln-1446"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">Msg2</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">TotSurfaces</span>
<a name="ln-1447"></a>    <span class="n">Msg2</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Msg2</span><span class="p">)</span>
<a name="ln-1448"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Reordered # of Surfaces (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ClassMsg</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1449"></a>       <span class="s1">&#39;) not = Total # of Surfaces (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Msg2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-1450"></a>    <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1451"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1452"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Moved</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1453"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1454"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Error in Surface= &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1455"></a>               <span class="s1">&#39;&quot; Class=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="k">Class</span><span class="o">-</span><span class="mi">100</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1456"></a>               <span class="s1">&#39; indicated Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1457"></a>        <span class="n">ENDIF</span>
<a name="ln-1458"></a>      <span class="n">ENDIF</span>
<a name="ln-1459"></a>    <span class="n">ENDDO</span>
<a name="ln-1460"></a>    <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Remaining surface checks will use &quot;reordered number of surfaces&quot;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1461"></a>       <span class="s1">&#39;not number of original surfaces&#39;</span><span class="p">)</span>
<a name="ln-1462"></a>  <span class="n">ENDIF</span>
<a name="ln-1463"></a>
<a name="ln-1464"></a>  <span class="k">DEALLOCATE</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">)</span>     <span class="c">! DeAllocate the Temp Surface derived type</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>
<a name="ln-1467"></a>  <span class="c">!  For each Base Surface Type (Wall, Floor, Roof)</span>
<a name="ln-1468"></a>
<a name="ln-1469"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1470"></a>
<a name="ln-1471"></a>    <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1474"></a>
<a name="ln-1475"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">BaseSurfIDs</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-1476"></a>
<a name="ln-1477"></a>      <span class="c">!  Find all subsurfaces to this surface</span>
<a name="ln-1478"></a>      <span class="k">DO </span><span class="n">SubSurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1479"></a>
<a name="ln-1480"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="n">SubSurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1481"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1482"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a>        <span class="c">! Check facing angle of Sub compared to base</span>
<a name="ln-1485"></a>        <span class="c">! ignore problems of subsurfaces on roofs/ceilings/floors with azimuth</span>
<a name="ln-1486"></a><span class="c">!          IF (Surface(SurfNum)%Class == SurfaceClass_Roof .or. Surface(SurfNum)%Class == SurfaceClass_Floor) CYCLE</span>
<a name="ln-1487"></a><span class="c">!          write(outputfiledebug,&#39;(A)&#39;) &#39;basesurface=&#39;//trim(surface(SurfNum)%Name)</span>
<a name="ln-1488"></a><span class="c">!          write(outputfiledebug,&#39;(A,3F7.2)&#39;) &#39;basesurface lc vectors=&#39;,Surface(SurfNum)%lcsx</span>
<a name="ln-1489"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) Surface(SurfNum)%lcsy</span>
<a name="ln-1490"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) Surface(SurfNum)%lcsz</span>
<a name="ln-1491"></a><span class="c">!          write(outputfiledebug,&#39;(A,3f7.2)&#39;) &#39;basesurface surfnorm=&#39;,Surface(SurfNum)%NewellSurfaceNormalVector</span>
<a name="ln-1492"></a><span class="c">!          write(outputfiledebug,&#39;(A)&#39;) &#39;subsurface=&#39;//trim(surface(SubSurfNum)%Name)</span>
<a name="ln-1493"></a><span class="c">!          write(outputfiledebug,&#39;(A,3F7.2)&#39;) &#39;subsurface lc vectors=&#39;,Surface(SubSurfNum)%lcsx</span>
<a name="ln-1494"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) Surface(SubSurfNum)%lcsy</span>
<a name="ln-1495"></a><span class="c">!          write(outputfiledebug,&#39;(3f7.2)&#39;) Surface(SubSurfNum)%lcsz</span>
<a name="ln-1496"></a><span class="c">!          write(outputfiledebug,&#39;(A,3f7.2)&#39;) &#39;subsurface surfnorm=&#39;,Surface(SubSurfNum)%NewellSurfaceNormalVector</span>
<a name="ln-1497"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1498"></a><span class="k">        CALL </span><span class="n">CompareTwoVectors</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1499"></a>           <span class="n">sameSurfNormal</span><span class="p">,.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span>
<a name="ln-1500"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">sameSurfNormal</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! copy lcs vectors</span>
<a name="ln-1501"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">lcsx</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span>
<a name="ln-1502"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">lcsy</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span>
<a name="ln-1503"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">lcsy</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span>
<a name="ln-1504"></a>          <span class="k">CYCLE</span>
<a name="ln-1505"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1506"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="mi">36</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">01</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1507"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="mi">36</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-1508"></a>        <span class="n">ENDIF</span>
<a name="ln-1509"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="mi">36</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">01</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1510"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="mi">36</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-1511"></a>        <span class="n">ENDIF</span>
<a name="ln-1512"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1513"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">17</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1514"></a><span class="k">            </span><span class="n">ErrCount1</span><span class="o">=</span><span class="n">ErrCount1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1515"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrCount1</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1516"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">Routinename</span><span class="o">//</span><span class="s1">&#39;Some Outward Facing angles of subsurfaces differ &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1517"></a>                                   <span class="s1">&#39;significantly from base surface.&#39;</span><span class="p">)</span>
<a name="ln-1518"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1519"></a>                       <span class="s1">&#39;to show more details on individual surfaces.&#39;</span><span class="p">)</span>
<a name="ln-1520"></a>            <span class="n">ENDIF</span>
<a name="ln-1521"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1522"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">Routinename</span><span class="o">//</span><span class="s1">&#39;Outward facing angle [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1523"></a>                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1524"></a>                   <span class="s1">&#39;] of subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SubSurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1525"></a>                   <span class="s1">&#39;&quot; significantly different than&#39;</span><span class="p">)</span>
<a name="ln-1526"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..facing angle [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1527"></a>                  <span class="s1">&#39;] of base surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Tilt=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1528"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..surface class of base surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1529"></a>            <span class="n">ENDIF</span>
<a name="ln-1530"></a>          <span class="n">ENDIF</span>
<a name="ln-1531"></a><span class="c">!            SurfError=.true.</span>
<a name="ln-1532"></a>        <span class="n">ENDIF</span>
<a name="ln-1533"></a>      <span class="n">ENDDO</span>
<a name="ln-1534"></a>    <span class="n">ENDDO</span>
<a name="ln-1535"></a>  <span class="n">ENDDO</span>
<a name="ln-1536"></a>
<a name="ln-1537"></a><span class="c">!**********************************************************************************</span>
<a name="ln-1538"></a><span class="c">! Now, match up interzone surfaces</span>
<a name="ln-1539"></a><span class="c">!</span>
<a name="ln-1540"></a>  <span class="n">NonMatch</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1541"></a>  <span class="n">izConstDiffMsg</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1542"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MovedSurfs</span> <span class="c">!TotSurfaces</span>
<a name="ln-1543"></a>    <span class="c">!  Clean up Shading Surfaces, make sure they don&#39;t go through here.</span>
<a name="ln-1544"></a>    <span class="c">!  Shading surfaces have &quot;Zone=0&quot;, should also have &quot;BaseSurf=0&quot;</span>
<a name="ln-1545"></a>    <span class="c">!  PGE: Revised so that shading surfaces can have BaseSurf /= 0 if they are daylighting shelves</span>
<a name="ln-1546"></a>    <span class="c">!       or other exterior reflecting surfaces.</span>
<a name="ln-1547"></a>    <span class="c">!IF (Surface(SurfNum)%Zone == 0) THEN</span>
<a name="ln-1548"></a>    <span class="c">!  Surface(SurfNum)%BaseSurf=0</span>
<a name="ln-1549"></a>    <span class="c">!  CYCLE</span>
<a name="ln-1550"></a>    <span class="c">!ENDIF</span>
<a name="ln-1551"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1552"></a>    <span class="c">!   If other surface, match it up</span>
<a name="ln-1553"></a>    <span class="c">!  Both interzone and &quot;internal&quot; surfaces have this pointer set</span>
<a name="ln-1554"></a>    <span class="c">!  Internal surfaces point to themselves, Interzone to another</span>
<a name="ln-1555"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1556"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">/=</span> <span class="s1">&#39;   &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1557"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1558"></a><span class="k">          </span><span class="n">Found</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-1559"></a>        <span class="k">ELSE</span>
<a name="ln-1560"></a><span class="k">          </span><span class="n">Found</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">MovedSurfs</span><span class="p">)</span>
<a name="ln-1561"></a>        <span class="n">ENDIF</span>
<a name="ln-1562"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1563"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1564"></a>          <span class="c">! Check that matching surface is also &quot;OtherZoneSurface&quot;</span>
<a name="ln-1565"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1566"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Potential &quot;OtherZoneSurface&quot; is not matched correctly:&#39;</span><span class="p">)</span>
<a name="ln-1567"></a>
<a name="ln-1568"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1569"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Nonmatched Other/InterZone Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1570"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1571"></a>            <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1572"></a>          <span class="n">ENDIF</span>
<a name="ln-1573"></a>          <span class="c">! Check that matching interzone surface has construction with reversed layers</span>
<a name="ln-1574"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Interzone surface</span>
<a name="ln-1575"></a>            <span class="c">! Make sure different zones too (CR 4110)</span>
<a name="ln-1576"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1577"></a><span class="k">              </span><span class="n">ErrCount2</span><span class="o">=</span><span class="n">ErrCount2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1578"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ErrCount2</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1579"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;CAUTION -- Interzone surfaces are occuring in the same zone(s).&#39;</span><span class="p">)</span>
<a name="ln-1580"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1581"></a>                      <span class="s1">&#39;to show more details on individual occurrences.&#39;</span><span class="p">)</span>
<a name="ln-1582"></a>              <span class="n">ENDIF</span>
<a name="ln-1583"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1584"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;CAUTION -- Interzone surfaces are usually in different zones&#39;</span><span class="p">)</span>
<a name="ln-1585"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1586"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1587"></a>              <span class="n">ENDIF</span>
<a name="ln-1588"></a>            <span class="n">ENDIF</span>
<a name="ln-1589"></a>            <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1590"></a>            <span class="n">ConstrNumFound</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1591"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ConstrNum</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ConstrNumFound</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1592"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionNumLayersWarning</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-1593"></a>                <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionNumLayersWarning</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1594"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-1595"></a>                <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1596"></a><span class="k">            </span><span class="n">TotLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1597"></a>            <span class="n">TotLayFound</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1598"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotLay</span> <span class="o">/=</span> <span class="n">TotLayFound</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Different number of layers</span>
<a name="ln-1599"></a>              <span class="c">! match on like Uvalues (nominal)</span>
<a name="ln-1600"></a>              <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">NominalU</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span><span class="o">-</span><span class="n">NominalU</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1601"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1602"></a>                                     <span class="s1">&#39; of interzone surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1603"></a>                                     <span class="s1">&#39; does not have the same number of layers as the construction &#39;</span>   <span class="p">&amp;</span>
<a name="ln-1604"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1605"></a>                                     <span class="s1">&#39; of adjacent surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1606"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionNumLayersWarning</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1607"></a>                    <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionNumLayersWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1608"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...this problem for this pair will not be reported again.&#39;</span><span class="p">)</span>
<a name="ln-1609"></a>                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionNumLayersWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1610"></a>                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionNumLayersWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1611"></a>                <span class="n">ENDIF</span>
<a name="ln-1612"></a>                <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1613"></a>              <span class="n">ENDIF</span>
<a name="ln-1614"></a>            <span class="k">ELSE</span>                            <span class="c">! Same number of layers; check for reverse layers</span>
<a name="ln-1615"></a>              <span class="c">! check layers as number of layers is the same</span>
<a name="ln-1616"></a>              <span class="n">izConstDiff</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1617"></a>              <span class="c">! ok if same nominal U</span>
<a name="ln-1618"></a>              <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotLay</span>
<a name="ln-1619"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">/=</span>  <span class="p">&amp;</span>
<a name="ln-1620"></a>                   <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLay</span><span class="o">-</span><span class="n">Lay</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1621"></a><span class="k">                   </span><span class="n">izConstDiff</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1622"></a>                   <span class="k">EXIT</span>  <span class="c">! exit when diff</span>
<a name="ln-1623"></a>                  <span class="k">END IF</span>
<a name="ln-1624"></a><span class="k">              END DO</span>
<a name="ln-1625"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">izConstDiff</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">NominalU</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span><span class="o">-</span><span class="n">NominalU</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1626"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1627"></a>                                    <span class="s1">&#39; of interzone surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1628"></a>                                    <span class="s1">&#39; does not have the same materials in the reverse order as the construction &#39;</span>   <span class="p">&amp;</span>
<a name="ln-1629"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1630"></a>                                    <span class="s1">&#39; of adjacent surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1631"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1632"></a>                    <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1633"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...this problem for this pair will not be reported again.&#39;</span><span class="p">)</span>
<a name="ln-1634"></a>                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1635"></a>                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1636"></a>                <span class="n">ENDIF</span>
<a name="ln-1637"></a>                <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1638"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">izConstDiff</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1639"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1640"></a>                                         <span class="s1">&#39; of interzone surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1641"></a>                                         <span class="s1">&#39; does not have the same materials in the reverse order as the construction &#39;</span>   <span class="p">&amp;</span>
<a name="ln-1642"></a>                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1643"></a>                                         <span class="s1">&#39; of adjacent surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1644"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...but Nominal U values are similar, diff=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1645"></a>                   <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">NominalU</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span><span class="o">-</span><span class="n">NominalU</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] ... simulation proceeds.&#39;</span><span class="p">)</span>
<a name="ln-1646"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">izConstDiffMsg</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1647"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...if the two zones are expected to have significantly different temperatures, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1648"></a>                     <span class="s1">&#39;the proper &quot;reverse&quot; construction should be created.&#39;</span><span class="p">)</span>
<a name="ln-1649"></a>                  <span class="n">izConstDiffMsg</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1650"></a>                <span class="n">ENDIF</span>
<a name="ln-1651"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1652"></a>                    <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1653"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...this problem for this pair will not be reported again.&#39;</span><span class="p">)</span>
<a name="ln-1654"></a>                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1655"></a>                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumFound</span><span class="p">)%</span><span class="n">ReverseConstructionLayersOrderWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1656"></a>                <span class="n">ENDIF</span>
<a name="ln-1657"></a>              <span class="n">ENDIF</span>
<a name="ln-1658"></a>            <span class="k">END IF</span>
<a name="ln-1659"></a>
<a name="ln-1660"></a>            <span class="c">! If significantly different areas -- this would not be good</span>
<a name="ln-1661"></a>            <span class="n">MultFound</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-1662"></a>            <span class="n">MultSurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-1663"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1664"></a><span class="k">              IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">MultFound</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">MultSurfNum</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1665"></a>                       <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">MultFound</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">02</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! 2% difference in areas</span>
<a name="ln-1666"></a>                <span class="n">ErrCount4</span><span class="o">=</span><span class="n">ErrCount4</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1667"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrCount4</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1668"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1669"></a>                    <span class="s1">&#39;InterZone Surface Areas do not match as expected and might not satisfy conservation of energy:&#39;</span><span class="p">)</span>
<a name="ln-1670"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1671"></a>                       <span class="s1">&#39;to show more details on individual mismatches.&#39;</span><span class="p">)</span>
<a name="ln-1672"></a>                <span class="n">ENDIF</span>
<a name="ln-1673"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1674"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1675"></a>                    <span class="s1">&#39;InterZone Surface Areas do not match as expected and might not satisfy conservation of energy:&#39;</span><span class="p">)</span>
<a name="ln-1676"></a>
<a name="ln-1677"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">MultFound</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MultSurfNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1678"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Area=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1679"></a>                                           <span class="s1">&#39; in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1680"></a>                                           <span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1681"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Area=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1682"></a>                                           <span class="s1">&#39; in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1683"></a>                                           <span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1684"></a>                  <span class="k">ELSE</span> <span class="c">! Show multiplier info</span>
<a name="ln-1685"></a>                    <span class="k">WRITE</span><span class="p">(</span><span class="n">MultString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">MultSurfNum</span>
<a name="ln-1686"></a>                    <span class="n">MultString</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">MultString</span><span class="p">)</span>
<a name="ln-1687"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Area=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1688"></a>                                           <span class="s1">&#39;, Multipliers=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MultString</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1689"></a>                                           <span class="s1">&#39;, Total Area=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">MultSurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1690"></a>                                           <span class="s1">&#39; in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1691"></a>                                           <span class="s1">&#39; Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1692"></a>                    <span class="k">WRITE</span><span class="p">(</span><span class="n">MultString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">MultFound</span>
<a name="ln-1693"></a>                    <span class="n">MultString</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">MultString</span><span class="p">)</span>
<a name="ln-1694"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Area=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1695"></a>                                           <span class="s1">&#39;, Multipliers=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MultString</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1696"></a>                                           <span class="s1">&#39;, Total Area=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">MultFound</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1697"></a>                                           <span class="s1">&#39; in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1698"></a>                                           <span class="s1">&#39; Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1699"></a>                  <span class="n">ENDIF</span>
<a name="ln-1700"></a>                <span class="n">ENDIF</span>
<a name="ln-1701"></a>              <span class="n">ENDIF</span>
<a name="ln-1702"></a>            <span class="n">ENDIF</span>
<a name="ln-1703"></a>            <span class="c">! Check opposites Azimuth and Tilt</span>
<a name="ln-1704"></a>            <span class="c">! Tilt</span>
<a name="ln-1705"></a>            <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">)</span><span class="o">-</span><span class="mi">18</span><span class="mf">0.d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1706"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;InterZone Surface Tilts do not match as expected.&#39;</span><span class="p">)</span>
<a name="ln-1707"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Tilt=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1708"></a>                                     <span class="s1">&#39; in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1709"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Tilt=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1710"></a>                                     <span class="s1">&#39; in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1711"></a>            <span class="n">ENDIF</span>
<a name="ln-1712"></a>            <span class="c">! check surface class match.  interzone surface.</span>
<a name="ln-1713"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1714"></a>                <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1715"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;InterZone Surface Classes do not match as expected.&#39;</span><span class="p">)</span>
<a name="ln-1716"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, surface class=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1717"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1718"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Adjacent Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, surface class=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1719"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1720"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Other errors/warnings may follow about these surfaces.&#39;</span><span class="p">)</span>
<a name="ln-1721"></a>            <span class="n">ENDIF</span>
<a name="ln-1722"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1723"></a>                <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1724"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;InterZone Surface Classes do not match as expected.&#39;</span><span class="p">)</span>
<a name="ln-1725"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, surface class=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1726"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1727"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Adjacent Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, surface class=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1728"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1729"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Other errors/warnings may follow about these surfaces.&#39;</span><span class="p">)</span>
<a name="ln-1730"></a>            <span class="n">ENDIF</span>
<a name="ln-1731"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1732"></a>              <span class="c">! Walls, Windows, Doors, Glass Doors</span>
<a name="ln-1733"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1734"></a>                <span class="c">! Surface is a Door, Window or Glass Door</span>
<a name="ln-1735"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! error detected elsewhere</span>
<a name="ln-1736"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-1737"></a>                    <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1738"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-1739"></a>              <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">)</span><span class="o">-</span><span class="mi">18</span><span class="mf">0.d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1740"></a><span class="k">                IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">5</span><span class="n">d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1741"></a>                  <span class="c">! if horizontal surfaces, then these are windows/doors/etc in those items.</span>
<a name="ln-1742"></a>                  <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;InterZone Surface Azimuths do not match as expected.&#39;</span><span class="p">)</span>
<a name="ln-1743"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Azimuth=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1744"></a>                                         <span class="s1">&#39;, Tilt=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>        <span class="p">&amp;</span>
<a name="ln-1745"></a>                                         <span class="s1">&#39;, in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1746"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Azimuth=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1747"></a>                                         <span class="s1">&#39;, Tilt=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>        <span class="p">&amp;</span>
<a name="ln-1748"></a>                                         <span class="s1">&#39;, in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1749"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..surface class of first surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1750"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..surface class of second surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="k">Class</span><span class="p">)))</span>
<a name="ln-1751"></a>                <span class="n">ENDIF</span>
<a name="ln-1752"></a>              <span class="n">ENDIF</span>
<a name="ln-1753"></a>            <span class="k">ELSE</span>  <span class="c">! Roofs, Floors</span>
<a name="ln-1754"></a>              <span class="c">! should be looking at opposite tilts, not azimuth for roof/floor matches...</span>
<a name="ln-1755"></a><span class="c">!              IF (ABS(ABS(Surface(SurfNum)%Azimuth+Surface(Found)%Azimuth)-360.) &gt; 1.0d0) THEN</span>
<a name="ln-1756"></a><span class="c">!                CALL ShowWarningError(&#39;InterZone Surface Azimuths do not match as expected.&#39;)</span>
<a name="ln-1757"></a><span class="c">!                CALL ShowContinueError(&#39;  Azimuth=&#39;//TRIM(TrimSigDigits(Surface(SurfNum)%Azimuth,1))//  &amp;</span>
<a name="ln-1758"></a><span class="c">!                                       &#39; in Surface=&#39;//TRIM(Surface(SurfNum)%Name)//&#39;, Zone=&#39;//TRIM(Surface(SurfNum)%ZoneName))</span>
<a name="ln-1759"></a><span class="c">!                CALL ShowContinueError(&#39;  Azimuth=&#39;//TRIM(TrimSigDigits(Surface(Found)%Azimuth,1))//  &amp;</span>
<a name="ln-1760"></a><span class="c">!                                       &#39; in Surface=&#39;//TRIM(Surface(Found)%Name)//&#39;, Zone=&#39;//TRIM(Surface(Found)%ZoneName))</span>
<a name="ln-1761"></a><span class="c">!              ENDIF</span>
<a name="ln-1762"></a>            <span class="n">ENDIF</span>
<a name="ln-1763"></a>
<a name="ln-1764"></a>            <span class="c">! Make sure exposures (Sun, Wind) are the same.....and are &quot;not&quot;</span>
<a name="ln-1765"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1766"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Interzone surfaces cannot be &quot;SunExposed&quot; -- removing SunExposed&#39;</span><span class="p">)</span>
<a name="ln-1767"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1768"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1769"></a>              <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1770"></a>              <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1771"></a>            <span class="n">ENDIF</span>
<a name="ln-1772"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1773"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Interzone surfaces cannot be &quot;WindExposed&quot; -- removing WindExposed&#39;</span><span class="p">)</span>
<a name="ln-1774"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1775"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1776"></a>              <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1777"></a>              <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1778"></a>            <span class="n">ENDIF</span>
<a name="ln-1779"></a>          <span class="k">END IF</span>
<a name="ln-1780"></a>          <span class="c">! Set opposing surface back to this one (regardless of error)</span>
<a name="ln-1781"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-1782"></a>          <span class="c">! Check subsurfaces...  make sure base surface is also an interzone surface</span>
<a name="ln-1783"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Subsurface</span>
<a name="ln-1784"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">SurfNum</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">/=</span> <span class="s1">&#39;   &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1785"></a>              <span class="c">! if not internal subsurface</span>
<a name="ln-1786"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1787"></a>                     <span class="c">! base surface is not interzone surface</span>
<a name="ln-1788"></a>                <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;SubSurface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; is an interzone subsurface.&#39;</span><span class="p">)</span>
<a name="ln-1789"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..but the Base Surface is not an interzone surface, Surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1790"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1791"></a>                <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1792"></a>              <span class="n">ENDIF</span>
<a name="ln-1793"></a>            <span class="n">ENDIF</span>
<a name="ln-1794"></a>          <span class="n">ENDIF</span>
<a name="ln-1795"></a>        <span class="k">Else</span>
<a name="ln-1796"></a>          <span class="c">!  Seems unlikely that an internal surface would be missing itself, so this message</span>
<a name="ln-1797"></a>          <span class="c">!  only indicates for adjacent (interzone) surfaces.</span>
<a name="ln-1798"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Adjacent Surface not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1799"></a>                               <span class="s1">&#39; adjacent to surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1800"></a>          <span class="n">NonMatch</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1801"></a>          <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1802"></a>        <span class="k">End If</span>
<a name="ln-1803"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Subsurface</span>
<a name="ln-1804"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>    <span class="p">&amp;</span>       <span class="c">! If Interzone surface, subsurface must be also.</span>
<a name="ln-1805"></a>            <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1806"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;SubSurface on Interzone Surface must be an Interzone SubSurface.&#39;</span><span class="p">)</span>
<a name="ln-1807"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...OutsideFaceEnvironment is blank, in Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1808"></a>          <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1809"></a>        <span class="k">ELSE</span>
<a name="ln-1810"></a><span class="k">          </span><span class="n">ErrCount3</span><span class="o">=</span><span class="n">ErrCount3</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1811"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrCount3</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1812"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Blank name for Outside Boundary Condition Objects.&#39;</span><span class="p">)</span>
<a name="ln-1813"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; to show more details on individual surfaces.&#39;</span><span class="p">)</span>
<a name="ln-1814"></a>          <span class="n">ENDIF</span>
<a name="ln-1815"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1816"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Blank name for Outside Boundary Condition Object, in surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1817"></a>                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1818"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting this surface to be an internal zone surface, zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1819"></a>          <span class="n">ENDIF</span>
<a name="ln-1820"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1821"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-1822"></a>        <span class="n">ENDIF</span>
<a name="ln-1823"></a>      <span class="k">ELSE</span>
<a name="ln-1824"></a><span class="k">        </span><span class="n">ErrCount3</span><span class="o">=</span><span class="n">ErrCount3</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1825"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrCount3</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1826"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Blank name for Outside Boundary Condition Objects.&#39;</span><span class="p">)</span>
<a name="ln-1827"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; to show more details on individual surfaces.&#39;</span><span class="p">)</span>
<a name="ln-1828"></a>        <span class="n">ENDIF</span>
<a name="ln-1829"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1830"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Blank name for Outside Boundary Condition Object, in surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1831"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1832"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting this surface to be an internal zone (adiabatic) surface, zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1833"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1834"></a>        <span class="n">ENDIF</span>
<a name="ln-1835"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1836"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-1837"></a>        <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1838"></a>      <span class="n">ENDIF</span>
<a name="ln-1839"></a>    <span class="k">End If</span>
<a name="ln-1840"></a>
<a name="ln-1841"></a><span class="k">  END DO</span>  <span class="c">! ...end of the Surface DO loop for finding BaseSurf</span>
<a name="ln-1842"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">NonMatch</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1843"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Non matching interzone surfaces found&#39;</span><span class="p">)</span>
<a name="ln-1844"></a>  <span class="k">End If</span>
<a name="ln-1845"></a>
<a name="ln-1846"></a><span class="c">!**********************************************************************************</span>
<a name="ln-1847"></a><span class="c">! Warn about interzone surfaces that have adiabatic windows/vice versa</span>
<a name="ln-1848"></a>  <span class="n">SubSurfaceSevereDisplayed</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1849"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1850"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1851"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! base surface</span>
<a name="ln-1852"></a>    <span class="c">! not base surface.  Check it.</span>
<a name="ln-1853"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! exterior or other base surface</span>
<a name="ln-1854"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! should match base surface</span>
<a name="ln-1855"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1856"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1857"></a>             <span class="s1">&#39;&quot; exterior condition [adiabatic surface] in a base surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1858"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1859"></a>             <span class="s1">&#39;&quot; with exterior condition [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1860"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cExtBoundCondition</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-1861"></a>          <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1862"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1863"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1864"></a>             <span class="s1">&#39;&quot; exterior condition [interzone surface] in a base surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1865"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1866"></a>             <span class="s1">&#39;&quot; with exterior condition [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1867"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cExtBoundCondition</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-1868"></a>          <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1869"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1870"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1871"></a>           <span class="s1">&#39;&quot; exterior condition [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1872"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">cExtBoundCondition</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1873"></a>           <span class="s1">&#39;] in a base surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1874"></a>           <span class="s1">&#39;&quot; with exterior condition [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1875"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">cExtBoundCondition</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-1876"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...SubSurface will not use the exterior condition model of the base surface.&#39;</span><span class="p">)</span>
<a name="ln-1877"></a>        <span class="k">ELSE</span>
<a name="ln-1878"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1879"></a>           <span class="s1">&#39;&quot; exterior condition [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1880"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">cExtBoundCondition</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1881"></a>           <span class="s1">&#39;] in a base surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1882"></a>           <span class="s1">&#39;&quot; with exterior condition [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1883"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">cExtBoundCondition</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-1884"></a>          <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1885"></a>        <span class="n">ENDIF</span>
<a name="ln-1886"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SubSurfaceSevereDisplayed</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1887"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...calculations for heat balance would be compromised.&#39;</span><span class="p">)</span>
<a name="ln-1888"></a>          <span class="n">SubSurfaceSevereDisplayed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1889"></a>        <span class="n">ENDIF</span>
<a name="ln-1890"></a>      <span class="n">ENDIF</span>
<a name="ln-1891"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1892"></a>      <span class="c">! adiabatic surface. make sure subsurfaces match</span>
<a name="ln-1893"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! not adiabatic surface</span>
<a name="ln-1894"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1895"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1896"></a>             <span class="s1">&#39;&quot; exterior condition [interzone surface] in a base surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1897"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1898"></a>             <span class="s1">&#39;&quot; with exterior condition [adiabatic surface]&#39;</span><span class="p">)</span>
<a name="ln-1899"></a>        <span class="k">ELSE</span>
<a name="ln-1900"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1901"></a>             <span class="s1">&#39;&quot; exterior condition [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1902"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">cExtBoundCondition</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1903"></a>             <span class="s1">&#39;] in a base surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1904"></a>             <span class="s1">&#39;&quot; with exterior condition [adiabatic surface]&#39;</span><span class="p">)</span>
<a name="ln-1905"></a>        <span class="n">ENDIF</span>
<a name="ln-1906"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SubSurfaceSevereDisplayed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1907"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...calculations for heat balance would be compromised.&#39;</span><span class="p">)</span>
<a name="ln-1908"></a>          <span class="n">SubSurfaceSevereDisplayed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1909"></a>        <span class="n">ENDIF</span>
<a name="ln-1910"></a>        <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1911"></a>      <span class="n">ENDIF</span>
<a name="ln-1912"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! interzone surface</span>
<a name="ln-1913"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1914"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Subsurface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1915"></a>           <span class="s1">&#39;&quot; is an adiabatic surface in an Interzone base surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1916"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SubSurfaceSevereDisplayed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1917"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...calculations for heat balance would be compromised.&#39;</span><span class="p">)</span>
<a name="ln-1918"></a>          <span class="n">SubSurfaceSevereDisplayed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1919"></a>        <span class="n">ENDIF</span>
<a name="ln-1920"></a><span class="c">!        SurfError=.true.</span>
<a name="ln-1921"></a>      <span class="n">ENDIF</span>
<a name="ln-1922"></a>    <span class="n">ENDIF</span>
<a name="ln-1923"></a>  <span class="n">ENDDO</span>
<a name="ln-1924"></a>
<a name="ln-1925"></a><span class="c">!**********************************************************************************</span>
<a name="ln-1926"></a><span class="c">!   Set up Zone Surface Pointers</span>
<a name="ln-1927"></a>  <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1928"></a>    <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MovedSurfs</span> <span class="c">!TotSurfaces</span>
<a name="ln-1929"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1930"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1931"></a><span class="k">          </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-1932"></a>          <span class="k">EXIT</span>
<a name="ln-1933"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1934"></a>      <span class="n">ENDIF</span>
<a name="ln-1935"></a>    <span class="k">END DO</span>
<a name="ln-1936"></a><span class="k">  END DO</span>
<a name="ln-1937"></a>  <span class="c">!  Surface First pointers are set, set last</span>
<a name="ln-1938"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfZones</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1939"></a><span class="k">    </span><span class="n">Zone</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">)%</span><span class="n">SurfaceLast</span><span class="o">=</span><span class="n">TotSurfaces</span>
<a name="ln-1940"></a>  <span class="n">ENDIF</span>
<a name="ln-1941"></a>  <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1942"></a>    <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1943"></a>  <span class="k">END DO</span>
<a name="ln-1944"></a>
<a name="ln-1945"></a><span class="k">  DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1946"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1947"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Zone has no surfaces, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1948"></a>      <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1949"></a>    <span class="n">ENDIF</span>
<a name="ln-1950"></a>  <span class="n">ENDDO</span>
<a name="ln-1951"></a>
<a name="ln-1952"></a><span class="c">! Set up Floor Areas for Zones</span>
<a name="ln-1953"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1954"></a><span class="k">    DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1955"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-1956"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1957"></a><span class="k">          </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-1958"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">HasFloor</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1959"></a>        <span class="n">ENDIF</span>
<a name="ln-1960"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1961"></a><span class="k">          </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">HasRoof</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1962"></a>        <span class="n">ENDIF</span>
<a name="ln-1963"></a>      <span class="k">END DO</span>
<a name="ln-1964"></a><span class="k">    END DO</span>
<a name="ln-1965"></a><span class="k">    </span><span class="n">errCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1966"></a>    <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1967"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CalcFloorArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span>
<a name="ln-1968"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">UserEnteredFloorArea</span> <span class="o">/=</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1969"></a>      <span class="c">! Check entered vs calculated</span>
<a name="ln-1970"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">UserEnteredFloorArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! User entered zone floor area,</span>
<a name="ln-1971"></a>                                                             <span class="c">! produce message if not near calculated</span>
<a name="ln-1972"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CalcFloorArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1973"></a><span class="k">            </span><span class="n">diffp</span><span class="o">=</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CalcFloorArea</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">UserEnteredFloorArea</span><span class="p">)</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">UserEnteredFloorArea</span>
<a name="ln-1974"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">diffp</span>  <span class="o">&gt;</span> <span class="p">.</span><span class="mi">05</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1975"></a><span class="k">              </span><span class="n">ErrCount</span><span class="o">=</span><span class="n">ErrCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1976"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ErrCount</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1977"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Entered Zone Floor Areas differ from calculated Zone Floor Area(s).&#39;</span><span class="p">)</span>
<a name="ln-1978"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; to show more details on individual zones.&#39;</span><span class="p">)</span>
<a name="ln-1979"></a>              <span class="n">ENDIF</span>
<a name="ln-1980"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1981"></a>                <span class="c">! Warn user of using specified Zone Floor Area</span>
<a name="ln-1982"></a>                <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Entered Floor Area entered for Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1983"></a>                            <span class="s1">&#39;&quot; significantly different from calculated Floor Area&#39;</span><span class="p">)</span>
<a name="ln-1984"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered Zone Floor Area value=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1985"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">UserEnteredFloorArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1986"></a>                            <span class="s1">&#39;, Calculated Zone Floor Area value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CalcFloorArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1987"></a>                            <span class="s1">&#39;, entered Floor Area will be used in calculations.&#39;</span><span class="p">)</span>
<a name="ln-1988"></a>              <span class="n">ENDIF</span>
<a name="ln-1989"></a>            <span class="n">ENDIF</span>
<a name="ln-1990"></a>          <span class="n">ENDIF</span>
<a name="ln-1991"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">UserEnteredFloorArea</span>
<a name="ln-1992"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">HasFloor</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1993"></a>        <span class="n">ENDIF</span>
<a name="ln-1994"></a>      <span class="k">ELSE</span>
<a name="ln-1995"></a><span class="k">        </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CalcFloorArea</span>  <span class="c">! redundant, already done.</span>
<a name="ln-1996"></a>      <span class="n">ENDIF</span>
<a name="ln-1997"></a>    <span class="k">END DO</span>
<a name="ln-1998"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-1999"></a>
<a name="ln-2000"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MovedSurfs</span> <span class="c">!TotSurfaces</span>
<a name="ln-2001"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2002"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Zero or negative surface area[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2003"></a>         <span class="s1">&#39;], Surface=&#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2004"></a>      <span class="n">SurfError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2005"></a>    <span class="n">ENDIF</span>
<a name="ln-2006"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&gt;=</span> <span class="mf">1.d-06</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2007"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Very small surface area[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2008"></a>         <span class="s1">&#39;], Surface=&#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2009"></a>    <span class="n">ENDIF</span>
<a name="ln-2010"></a>  <span class="k">END DO</span>
<a name="ln-2011"></a>
<a name="ln-2012"></a><span class="k">  DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MovedSurfs</span> <span class="c">!TotSurfaces</span>
<a name="ln-2013"></a>    <span class="c">! GLASSDOORs and TDD:DIFFUSERs will be treated as windows in the subsequent heat transfer and daylighting</span>
<a name="ln-2014"></a>    <span class="c">! calculations. Reset class to &#39;Window&#39; after saving the original designation in SurfaceWindow.</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-2017"></a>
<a name="ln-2018"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span> <span class="p">&amp;</span>
<a name="ln-2019"></a>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">=</span> <span class="n">SurfaceClass_Window</span>
<a name="ln-2020"></a>
<a name="ln-2021"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2022"></a>      <span class="c">! Reset the TDD:DOME subsurface to act as a base surface that can shade and be shaded</span>
<a name="ln-2023"></a>      <span class="c">! NOTE: This must be set early so that subsequent shading calculations are done correctly</span>
<a name="ln-2024"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-2025"></a>    <span class="k">END IF</span>
<a name="ln-2026"></a><span class="k">  END DO</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a><span class="k">  </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2029"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2030"></a><span class="k">    DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MovedSurfs</span> <span class="c">!TotSurfaces</span>
<a name="ln-2031"></a>      <span class="c">! Set ShadedConstruction numbers for windows whose shaded constructions were created</span>
<a name="ln-2032"></a>      <span class="c">! when shading device was specified in the WindowShadingControl for the window</span>
<a name="ln-2033"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2034"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-2035"></a>
<a name="ln-2036"></a>      <span class="c">! no need to set the below -- it is the default</span>
<a name="ln-2037"></a>      <span class="c">! Set variable that indicates if shading device has movable slats</span>
<a name="ln-2038"></a><span class="c">!      SurfaceWindow(SurfNum)%MovableSlats = .FALSE.</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>      <span class="c">! TH 2/9/2010. Fixed for CR 8010 for speed up purpose rather than fixing the problem</span>
<a name="ln-2041"></a>      <span class="n">WinShadingControlPtr</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-2042"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WinShadingControlPtr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2043"></a><span class="k">        IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadingControlPtr</span><span class="p">)%</span><span class="n">SlatAngleControlForBlinds</span> <span class="o">/=</span> <span class="n">WSC_SAC_FixedSlatAngle</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2044"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2045"></a>        <span class="c">! for a constant schedule of slat angle, it acts the same way as fixed angle</span>
<a name="ln-2046"></a>        <span class="c">! TH 3/14/2011, CR 8347. Code was commented out due to the use of ExternalInterface (BCVTB)</span>
<a name="ln-2047"></a>        <span class="c">!IF(WindowShadingControl(WinShadingControlPtr)%SlatAngleControlForBlinds == WSC_SAC_ScheduledSlatAngle) THEN</span>
<a name="ln-2048"></a>          <span class="c">! get schedule index</span>
<a name="ln-2049"></a>        <span class="c">!  SchID = WindowShadingControl(WinShadingControlPtr)%SlatAngleSchedule</span>
<a name="ln-2050"></a>        <span class="c">!  IF (SchID /= 0 ) THEN</span>
<a name="ln-2051"></a>        <span class="c">!    SchSlatAngle = GetScheduleMinValue(SchID)</span>
<a name="ln-2052"></a>        <span class="c">!    IF (SchSlatAngle == GetScheduleMaxValue(SchID)) THEN</span>
<a name="ln-2053"></a>        <span class="c">!      SurfaceWindow(SurfNum)%MovableSlats = .FALSE.</span>
<a name="ln-2054"></a>        <span class="c">!    ENDIF</span>
<a name="ln-2055"></a>        <span class="c">!  ENDIF</span>
<a name="ln-2056"></a>        <span class="c">!ENDIF</span>
<a name="ln-2057"></a>            <span class="n">ENDIF</span>
<a name="ln-2058"></a>
<a name="ln-2059"></a>      <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-2060"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ConstrNumSh</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2061"></a>
<a name="ln-2062"></a><span class="k">      </span><span class="n">ShadingType</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadingControlPtr</span><span class="p">)%</span><span class="n">ShadingType</span>
<a name="ln-2063"></a>
<a name="ln-2064"></a>      <span class="c">! only for blinds</span>
<a name="ln-2065"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span> <span class="p">&amp;</span>
<a name="ln-2066"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a>        <span class="c">! TH 1/7/2010. CR 7930</span>
<a name="ln-2069"></a>        <span class="c">! The old code did not consider between-glass blind. Also there should not be two blinds - both interior and exterior</span>
<a name="ln-2070"></a>        <span class="c">! Use the new generic code (assuming only one blind) as follows</span>
<a name="ln-2071"></a>        <span class="k">DO </span><span class="n">iTmp1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-2072"></a>          <span class="n">iTmp2</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">iTmp1</span><span class="p">)</span>
<a name="ln-2073"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">iTmp2</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2074"></a><span class="k">            </span><span class="n">BlNum</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">iTmp2</span><span class="p">)%</span><span class="n">BlindDataPtr</span>
<a name="ln-2075"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span> <span class="o">=</span> <span class="n">BlNum</span>
<a name="ln-2076"></a>            <span class="c">! TH 2/18/2010. CR 8010</span>
<a name="ln-2077"></a>            <span class="c">! if it is a blind with movable slats, create one new blind and set it to VariableSlat if not done so yet.</span>
<a name="ln-2078"></a>            <span class="c">!  the new blind is created only once, it can be shared by multiple windows though.</span>
<a name="ln-2079"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatAngleType</span> <span class="o">/=</span> <span class="n">VariableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2080"></a><span class="k">              </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2081"></a>              <span class="k">CALL </span><span class="n">AddVariableSlatBlind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">,</span><span class="n">BlNumNew</span><span class="p">,</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-2082"></a>              <span class="c">! point to the new blind</span>
<a name="ln-2083"></a>              <span class="n">Material</span><span class="p">(</span><span class="n">iTmp2</span><span class="p">)%</span><span class="n">BlindDataPtr</span> <span class="o">=</span> <span class="n">BlNumNew</span>
<a name="ln-2084"></a>              <span class="c">! window surface points to new blind</span>
<a name="ln-2085"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span> <span class="o">=</span> <span class="n">BlNumNew</span>
<a name="ln-2086"></a>            <span class="n">ENDIF</span>
<a name="ln-2087"></a>            <span class="k">EXIT</span>
<a name="ln-2088"></a><span class="k">          END IF</span>
<a name="ln-2089"></a><span class="k">        END DO</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2092"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2093"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;WindowProperty:ShadingControl &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2094"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadingControlPtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2095"></a>            <span class="s1">&#39; has errors, program will terminate.&#39;</span><span class="p">)</span>
<a name="ln-2096"></a>        <span class="n">ENDIF</span>
<a name="ln-2097"></a>
<a name="ln-2098"></a>        <span class="c">! TH 5/17/2010. Fixed for CR 8121. Overwrite the blind slat angle with the constant scheduled value</span>
<a name="ln-2099"></a>        <span class="c">! TH 3/14/2011. With fix for CR 8347, the following code is no longer needed.</span>
<a name="ln-2100"></a>        <span class="c">!IF (SurfaceWindow(SurfNum)%BlindNumber &gt;0 .AND. WinShadingControlPtr &gt;0 ) THEN</span>
<a name="ln-2101"></a>        <span class="c">!  IF (.NOT. SurfaceWindow(SurfNum)%MovableSlats .AND. &amp;</span>
<a name="ln-2102"></a>        <span class="c">!    WindowShadingControl(WinShadingControlPtr)%SlatAngleControlForBlinds == WSC_SAC_ScheduledSlatAngle) THEN</span>
<a name="ln-2103"></a>        <span class="c">!    Blind(SurfaceWindow(SurfNum)%BlindNumber)%SlatAngle = SchSlatAngle</span>
<a name="ln-2104"></a>        <span class="c">!  ENDIF</span>
<a name="ln-2105"></a>        <span class="c">!ENDIF</span>
<a name="ln-2106"></a>
<a name="ln-2107"></a>      <span class="n">ENDIF</span>
<a name="ln-2108"></a>
<a name="ln-2109"></a>    <span class="k">END DO</span>  <span class="c">! End of surface loop</span>
<a name="ln-2110"></a>
<a name="ln-2111"></a>    <span class="c">! Warning if a WindowShadingControl is not referenced by any window; user may think</span>
<a name="ln-2112"></a>    <span class="c">! window shading is occurring when it really isn&#39;t</span>
<a name="ln-2113"></a>    <span class="k">DO </span><span class="n">ShadingCtrl</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotWinShadingControl</span>
<a name="ln-2114"></a>      <span class="n">WinShadingCtrlReferenced</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2115"></a>      <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-2116"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">==</span> <span class="n">ShadingCtrl</span><span class="p">)</span> <span class="n">WinShadingCtrlReferenced</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2117"></a>      <span class="k">END DO</span>
<a name="ln-2118"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">WinShadingCtrlReferenced</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2119"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;WindowProperty:ShadingControl: &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ShadingCtrl</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2120"></a>                    <span class="s1">&#39;&quot; is not referenced by any window.&#39;</span><span class="p">)</span>
<a name="ln-2121"></a>      <span class="k">END IF</span>
<a name="ln-2122"></a><span class="k">    END DO</span>
<a name="ln-2123"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-2124"></a>
<a name="ln-2125"></a>  <span class="c">! Check for zones with not enough surfaces</span>
<a name="ln-2126"></a>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-2127"></a>    <span class="n">OpaqueHTSurfs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2128"></a>    <span class="n">OpaqueHTSurfsWithWin</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2129"></a>    <span class="n">InternalMassSurfs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2130"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Zone with no surfaces</span>
<a name="ln-2131"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-2132"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2133"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="n">OpaqueHTSurfs</span> <span class="o">=</span> <span class="n">OpaqueHTSurfs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2134"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="n">InternalMassSurfs</span> <span class="o">=</span> <span class="n">InternalMassSurfs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2135"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2136"></a>         <span class="c">! Count base surface only once for multiple windows on a wall</span>
<a name="ln-2137"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2138"></a>           <span class="n">OpaqueHTSurfsWithWin</span> <span class="o">=</span> <span class="n">OpaqueHTSurfsWithWin</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2139"></a>      <span class="k">END IF</span>
<a name="ln-2140"></a><span class="k">    END DO</span>
<a name="ln-2141"></a><span class="k">    IF</span><span class="p">(</span><span class="n">OpaqueHTSurfsWithWin</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OpaqueHTSurfs</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">InternalMassSurfs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2142"></a><span class="k">      </span><span class="n">SurfError</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2143"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Zone &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2144"></a>        <span class="s1">&#39; has only one floor, wall or roof, and this surface has a window.&#39;</span><span class="p">)</span>
<a name="ln-2145"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Add more floors, walls or roofs, or an internal mass surface.&#39;</span><span class="p">)</span>
<a name="ln-2146"></a>    <span class="k">END IF</span>
<a name="ln-2147"></a><span class="k">    IF</span><span class="p">((</span><span class="n">OpaqueHTSurfs</span> <span class="o">+</span> <span class="n">InternalMassSurfs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2148"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;The total number of floors, walls, roofs and internal mass surfaces in Zone &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2149"></a>                            <span class="nb">Trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2150"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;is &lt; 6. This may cause an inaccurate zone heat balance calculation.&#39;</span><span class="p">)</span>
<a name="ln-2151"></a>    <span class="k">END IF</span>
<a name="ln-2152"></a><span class="k">  END DO</span>
<a name="ln-2153"></a>
<a name="ln-2154"></a>    <span class="c">! set up vertex of centroid for each surface.</span>
<a name="ln-2155"></a>  <span class="k">CALL </span><span class="n">CalcSurfaceCentroid</span>
<a name="ln-2156"></a>
<a name="ln-2157"></a>  <span class="k">CALL </span><span class="n">SetupShadeSurfacesForSolarCalcs</span>  <span class="c">! if shading surfaces are solar collectors or PV, then we need full solar calc.</span>
<a name="ln-2158"></a>
<a name="ln-2159"></a>  <span class="n">LayNumOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2160"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-2161"></a>    <span class="c">! Check for EcoRoof and only 1 allowed to be used.</span>
<a name="ln-2162"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtEcoRoof</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2163"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">LayNumOutSide</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2164"></a><span class="k">      </span><span class="n">LayNumOutSide</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2165"></a>      <span class="k">CYCLE</span>
<a name="ln-2166"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-2167"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">LayNumOutSide</span> <span class="o">/=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2168"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Only one EcoRoof Material is currently allowed for all constructions.&#39;</span><span class="p">)</span>
<a name="ln-2169"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... first material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">LayNumOutSide</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2170"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... conflicting Construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2171"></a>                    <span class="s1">&#39; uses material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2172"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2173"></a>    <span class="n">ENDIF</span>
<a name="ln-2174"></a>  <span class="n">ENDDO</span>
<a name="ln-2175"></a>
<a name="ln-2176"></a>  <span class="c">! Set flag that determines whether a surface can be an exterior obstruction</span>
<a name="ln-2177"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-2178"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2179"></a>    <span class="c">! Exclude non-exterior heat transfer surfaces (but not OtherSideCondModeledExt = -4 CR7640)</span>
<a name="ln-2180"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2181"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2182"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefNoCalcExt</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2183"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefCalcExt</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2184"></a>    <span class="c">! Exclude windows and doors, i.e., consider only their base surfaces as possible obstructions</span>
<a name="ln-2185"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2186"></a>    <span class="c">! Exclude duplicate shading surfaces</span>
<a name="ln-2187"></a>    <span class="c">! TH 3/25/2010 CR 7872</span>
<a name="ln-2188"></a>    <span class="c">!  Shading surface names can start with Mir, a better way to use another flag</span>
<a name="ln-2189"></a>    <span class="c">!   to indicate whether a surface is a mirrored one.</span>
<a name="ln-2190"></a>    <span class="c">!IF(Surface(SurfNum)%Name(1:3) == &#39;Mir&#39;) CYCLE</span>
<a name="ln-2191"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2192"></a>
<a name="ln-2193"></a><span class="k">    </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2194"></a>  <span class="k">END DO</span>
<a name="ln-2195"></a>
<a name="ln-2196"></a>  <span class="c">! Check for IRT surfaces in invalid places.</span>
<a name="ln-2197"></a>  <span class="n">iTmp1</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2198"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">Construct</span><span class="p">%</span><span class="n">TypeIsIRT</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2199"></a><span class="k">    DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-2200"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! ignore shading surfaces</span>
<a name="ln-2201"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! interzone, not adiabatic surface</span>
<a name="ln-2202"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsIRT</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2203"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2204"></a><span class="k">        </span><span class="n">iTmp1</span><span class="o">=</span><span class="n">iTmp1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2205"></a>      <span class="k">ELSE</span>
<a name="ln-2206"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; uses InfraredTransparent&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2207"></a>           <span class="s1">&#39; construction in a non-interzone surface. (illegal use)&#39;</span><span class="p">)</span>
<a name="ln-2208"></a>      <span class="n">ENDIF</span>
<a name="ln-2209"></a>    <span class="n">ENDDO</span>
<a name="ln-2210"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">iTmp1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2211"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Surfaces use InfraredTransparent constructions &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iTmp1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2212"></a>         <span class="s1">&#39; in non-interzone surfaces. (illegal use)&#39;</span><span class="p">)</span>
<a name="ln-2213"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For explicit details on each use, use Output:Diagnostics,DisplayExtraWarnings;&#39;</span><span class="p">)</span>
<a name="ln-2214"></a>    <span class="n">ENDIF</span>
<a name="ln-2215"></a>  <span class="n">ENDIF</span>
<a name="ln-2216"></a>
<a name="ln-2217"></a><span class="c">! Note, could do same for Window Area and detecting if Interzone Surface in Zone</span>
<a name="ln-2218"></a>
<a name="ln-2219"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Warning1Count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2220"></a><span class="k">    CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Window dimensions differ from Window 5/6 data file dimensions, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2221"></a>          <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Warning1Count</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times.&#39;</span><span class="p">)</span>
<a name="ln-2222"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This will affect the frame heat transfer calculation if the frame in the Data File entry&#39;</span><span class="p">)</span>
<a name="ln-2223"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;is not uniform, i.e., has sections with different geometry and/or thermal properties.&#39;</span><span class="p">)</span>
<a name="ln-2224"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For explicit details on each window, use Output:Diagnostics,DisplayExtraWarnings;&#39;</span><span class="p">)</span>
<a name="ln-2225"></a>  <span class="n">ENDIF</span>
<a name="ln-2226"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Warning2Count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2227"></a><span class="k">    CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Exterior Windows have been replaced with Window 5/6 two glazing systems, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2228"></a>          <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Warning2Count</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times.&#39;</span><span class="p">)</span>
<a name="ln-2229"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Note that originally entered dimensions are overridden.&#39;</span><span class="p">)</span>
<a name="ln-2230"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For explicit details on each window, use Output:Diagnostics,DisplayExtraWarnings;&#39;</span><span class="p">)</span>
<a name="ln-2231"></a>  <span class="n">ENDIF</span>
<a name="ln-2232"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Warning3Count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2233"></a><span class="k">    CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Interior Windows have been replaced with Window 5/6 two glazing systems, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2234"></a>          <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Warning3Count</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times.&#39;</span><span class="p">)</span>
<a name="ln-2235"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Note that originally entered dimensions are overridden.&#39;</span><span class="p">)</span>
<a name="ln-2236"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For explicit details on each window, use Output:Diagnostics,DisplayExtraWarnings;&#39;</span><span class="p">)</span>
<a name="ln-2237"></a>  <span class="n">ENDIF</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotalMultipliedWindows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2240"></a><span class="k">    CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;There are &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalMultipliedWindows</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; window/glass door(s) &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2241"></a>            <span class="s1">&#39;that may cause inaccurate shadowing due to Solar Distribution.&#39;</span><span class="p">)</span>
<a name="ln-2242"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For explicit details on each window, use Output:Diagnostics,DisplayExtraWarnings;&#39;</span><span class="p">)</span>
<a name="ln-2243"></a>    <span class="n">TotalWarningErrors</span><span class="o">=</span><span class="n">TotalWarningErrors</span><span class="o">+</span><span class="n">TotalMultipliedWindows</span>
<a name="ln-2244"></a>  <span class="n">ENDIF</span>
<a name="ln-2245"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotalCoincidentVertices</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2246"></a><span class="k">    CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;There are &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalCoincidentVertices</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2247"></a>       <span class="s1">&#39; coincident/collinear vertices; These have been deleted unless the deletion would bring the number of surface sides &lt; 3.&#39;</span><span class="p">)</span>
<a name="ln-2248"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For explicit details on each problem surface, use Output:Diagnostics,DisplayExtraWarnings;&#39;</span><span class="p">)</span>
<a name="ln-2249"></a>    <span class="n">TotalWarningErrors</span><span class="o">=</span><span class="n">TotalWarningErrors</span><span class="o">+</span><span class="n">TotalCoincidentVertices</span>
<a name="ln-2250"></a>  <span class="n">ENDIF</span>
<a name="ln-2251"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotalDegenerateSurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2252"></a><span class="k">    CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;There are &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalDegenerateSurfaces</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2253"></a>       <span class="s1">&#39; degenerate surfaces; Degenerate surfaces are those with number of sides &lt; 3.&#39;</span><span class="p">)</span>
<a name="ln-2254"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;These surfaces should be deleted.&#39;</span><span class="p">)</span>
<a name="ln-2255"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For explicit details on each problem surface, use Output:Diagnostics,DisplayExtraWarnings;&#39;</span><span class="p">)</span>
<a name="ln-2256"></a>    <span class="n">TotalSevereErrors</span><span class="o">=</span><span class="n">TotalSevereErrors</span><span class="o">+</span><span class="n">TotalDegenerateSurfaces</span>
<a name="ln-2257"></a>  <span class="n">ENDIF</span>
<a name="ln-2258"></a>
<a name="ln-2259"></a> <span class="k">CALL </span><span class="n">GetHTSurfExtVentedCavityData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2260"></a>
<a name="ln-2261"></a> <span class="k">CALL </span><span class="n">GetSurfaceHeatTransferAlgorithmOverrides</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2262"></a>
<a name="ln-2263"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">SurfError</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2264"></a><span class="k">   </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2265"></a>   <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors discovered, program terminates.&#39;</span><span class="p">)</span>
<a name="ln-2266"></a> <span class="n">ENDIF</span>
<a name="ln-2267"></a>
<a name="ln-2268"></a> <span class="k">RETURN</span>
<a name="ln-2269"></a>
<a name="ln-2270"></a><span class="k">END SUBROUTINE </span><span class="n">GetSurfaceData</span>
<a name="ln-2271"></a>
<a name="ln-2272"></a><span class="k">SUBROUTINE </span><span class="n">GetGeometryParameters</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2273"></a>
<a name="ln-2274"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2275"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-2276"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-2277"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2278"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2279"></a>
<a name="ln-2280"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2281"></a>          <span class="c">! This subroutine reads in the &quot;Surface Geometry&quot; parameters, verifies them,</span>
<a name="ln-2282"></a>          <span class="c">! and sets &quot;global&quot; variables that will tell other routines how the surface</span>
<a name="ln-2283"></a>          <span class="c">! vertices are expected in input.</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2286"></a>          <span class="c">! na</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2289"></a>          <span class="c">! GlobalGeometryRules Definition</span>
<a name="ln-2290"></a>          <span class="c">!GlobalGeometryRules,</span>
<a name="ln-2291"></a>          <span class="c">!      \required-object</span>
<a name="ln-2292"></a>          <span class="c">!      \unique-object</span>
<a name="ln-2293"></a>          <span class="c">!  A1, \field Starting Vertex Position</span>
<a name="ln-2294"></a>          <span class="c">!      \required-field</span>
<a name="ln-2295"></a>          <span class="c">!      \note Specified as entry for a 4 sided surface/rectangle</span>
<a name="ln-2296"></a>          <span class="c">!      \note Surfaces are specified as viewed from outside the surface</span>
<a name="ln-2297"></a>          <span class="c">!      \note Shading surfaces as viewed from behind.  (towards what they are shading)</span>
<a name="ln-2298"></a>          <span class="c">!      \type choice</span>
<a name="ln-2299"></a>          <span class="c">!      \key UpperLeftCorner</span>
<a name="ln-2300"></a>          <span class="c">!      \key LowerLeftCorner</span>
<a name="ln-2301"></a>          <span class="c">!      \key UpperRightCorner</span>
<a name="ln-2302"></a>          <span class="c">!      \key LowerRightCorner</span>
<a name="ln-2303"></a>          <span class="c">!  A2, \field Vertex Entry Direction</span>
<a name="ln-2304"></a>          <span class="c">!      \required-field</span>
<a name="ln-2305"></a>          <span class="c">!      \type choice</span>
<a name="ln-2306"></a>          <span class="c">!      \key Counterclockwise</span>
<a name="ln-2307"></a>          <span class="c">!      \key Clockwise</span>
<a name="ln-2308"></a>          <span class="c">!  A3, \field Coordinate System</span>
<a name="ln-2309"></a>          <span class="c">!      \required-field</span>
<a name="ln-2310"></a>          <span class="c">!      \note relative -- coordinates are entered relative to zone origin</span>
<a name="ln-2311"></a>          <span class="c">!      \note world -- all coordinates entered are &quot;absolute&quot; for this facility</span>
<a name="ln-2312"></a>          <span class="c">!      \note absolute -- same as world</span>
<a name="ln-2313"></a>          <span class="c">!      \type choice</span>
<a name="ln-2314"></a>          <span class="c">!      \key Relative</span>
<a name="ln-2315"></a>          <span class="c">!      \key World</span>
<a name="ln-2316"></a>          <span class="c">!      \key Absolute</span>
<a name="ln-2317"></a>          <span class="c">!  A4, \field Daylighting Reference Point Coordinate System</span>
<a name="ln-2318"></a>          <span class="c">!      \type choice</span>
<a name="ln-2319"></a>          <span class="c">!      \key Relative</span>
<a name="ln-2320"></a>          <span class="c">!      \default Relative</span>
<a name="ln-2321"></a>          <span class="c">!      \note Relative -- coordinates are entered relative to zone origin</span>
<a name="ln-2322"></a>          <span class="c">!      \key World</span>
<a name="ln-2323"></a>          <span class="c">!      \note World -- all coordinates entered are &quot;absolute&quot; for this facility</span>
<a name="ln-2324"></a>          <span class="c">!      \key Absolute</span>
<a name="ln-2325"></a>          <span class="c">!      \note absolute -- same as world</span>
<a name="ln-2326"></a>          <span class="c">!  A5; \field Rectangular Surface Coordinate System</span>
<a name="ln-2327"></a>          <span class="c">!      \type choice</span>
<a name="ln-2328"></a>          <span class="c">!      \key Relative</span>
<a name="ln-2329"></a>          <span class="c">!      \default Relative</span>
<a name="ln-2330"></a>          <span class="c">!      \note Relative -- Starting corner is entered relative to zone origin</span>
<a name="ln-2331"></a>          <span class="c">!      \key World</span>
<a name="ln-2332"></a>          <span class="c">!      \note World -- Starting corner is entered in &quot;absolute&quot;</span>
<a name="ln-2333"></a>          <span class="c">!      \key Absolute</span>
<a name="ln-2334"></a>          <span class="c">!      \note absolute -- same as world</span>
<a name="ln-2335"></a>
<a name="ln-2336"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2337"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-2338"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItem</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-2339"></a>
<a name="ln-2340"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2341"></a>
<a name="ln-2342"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2343"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if errors found during input</span>
<a name="ln-2344"></a>
<a name="ln-2345"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2346"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AbCorners</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;ULC&#39;</span><span class="p">,</span><span class="s1">&#39;LLC&#39;</span><span class="p">,</span><span class="s1">&#39;LRC&#39;</span><span class="p">,</span><span class="s1">&#39;URC&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2347"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FlCorners</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;UpperLeftCorner &#39;</span><span class="p">,</span><span class="s1">&#39;LowerLeftCorner &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2348"></a>                                                            <span class="s1">&#39;LowerRightCorner&#39;</span><span class="p">,</span><span class="s1">&#39;UpperRightCorner&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2349"></a>
<a name="ln-2350"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2351"></a>          <span class="c">! na</span>
<a name="ln-2352"></a>
<a name="ln-2353"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2354"></a>          <span class="c">! na</span>
<a name="ln-2355"></a>
<a name="ln-2356"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2357"></a>  <span class="kt">INTEGER </span><span class="n">NumStmt</span>
<a name="ln-2358"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GAlphas</span>
<a name="ln-2359"></a>  <span class="kt">INTEGER </span><span class="n">NAlphas</span>
<a name="ln-2360"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GNum</span>
<a name="ln-2361"></a>  <span class="kt">INTEGER </span><span class="n">NNum</span>
<a name="ln-2362"></a>  <span class="kt">INTEGER </span><span class="n">IOSTAT</span>
<a name="ln-2363"></a>  <span class="kt">LOGICAL </span><span class="n">OK</span>
<a name="ln-2364"></a>  <span class="kt">INTEGER </span><span class="n">Found</span>
<a name="ln-2365"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutMsg</span>
<a name="ln-2366"></a>
<a name="ln-2367"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;GlobalGeometryRules&#39;</span>
<a name="ln-2368"></a>  <span class="n">NumStmt</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-2369"></a>  <span class="n">OutMsg</span><span class="o">=</span><span class="s1">&#39; Surface Geometry,&#39;</span>
<a name="ln-2370"></a>
<a name="ln-2371"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">NumStmt</span><span class="p">)</span>
<a name="ln-2372"></a>
<a name="ln-2373"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2374"></a>    <span class="c">! This is the valid case</span>
<a name="ln-2375"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GAlphas</span><span class="p">,</span><span class="n">NAlphas</span><span class="p">,</span><span class="n">GNum</span><span class="p">,</span><span class="n">NNum</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2376"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2377"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2378"></a>
<a name="ln-2379"></a>    <span class="c">! Even though these will be validated, set defaults in case error here -- wont</span>
<a name="ln-2380"></a>    <span class="c">! cause aborts in later surface gets (hopefully)</span>
<a name="ln-2381"></a>    <span class="n">Corner</span><span class="o">=</span><span class="n">UpperLeftCorner</span>
<a name="ln-2382"></a>    <span class="n">WorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2383"></a>    <span class="n">CCW</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2384"></a>
<a name="ln-2385"></a>    <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2386"></a>    <span class="n">Found</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AbCorners</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2387"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2388"></a><span class="k">      </span><span class="n">Found</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FlCorners</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2389"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2390"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2391"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2392"></a>      <span class="k">ELSE</span>
<a name="ln-2393"></a><span class="k">        </span><span class="n">Corner</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-2394"></a>        <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2395"></a>        <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FLCorners</span><span class="p">(</span><span class="n">Corner</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2396"></a>      <span class="n">ENDIF</span>
<a name="ln-2397"></a>    <span class="k">ELSE</span>
<a name="ln-2398"></a><span class="k">      </span><span class="n">Corner</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-2399"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FLCorners</span><span class="p">(</span><span class="n">Corner</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2400"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2401"></a>    <span class="n">ENDIF</span>
<a name="ln-2402"></a>
<a name="ln-2403"></a>    <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2404"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;CCW&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;Counterclockwise&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2405"></a><span class="k">      </span><span class="n">CCW</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2406"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;Counterclockwise&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2407"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2408"></a>    <span class="n">ENDIF</span>
<a name="ln-2409"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;CW&#39;</span><span class="p">)</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;Clockwise&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2410"></a><span class="k">      </span><span class="n">CCW</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2411"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;Clockwise&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2412"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2413"></a>    <span class="n">ENDIF</span>
<a name="ln-2414"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2415"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2416"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2417"></a>    <span class="n">ENDIF</span>
<a name="ln-2418"></a>
<a name="ln-2419"></a>    <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2420"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;WCS&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;WorldCoordinateSystem&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2421"></a>        <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;World&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Absolute&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2422"></a><span class="k">      </span><span class="n">WorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2423"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;WorldCoordinateSystem&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2424"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2425"></a>    <span class="n">ENDIF</span>
<a name="ln-2426"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Rel&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Relative&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Local&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2427"></a><span class="k">      </span><span class="n">WorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2428"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;RelativeCoordinateSystem&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2429"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2430"></a>    <span class="n">ENDIF</span>
<a name="ln-2431"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2432"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2433"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; defaults to &quot;WorldCoordinateSystem&quot;&#39;</span><span class="p">)</span>
<a name="ln-2434"></a>      <span class="n">WorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2435"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;WorldCoordinateSystem&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2436"></a>    <span class="n">ENDIF</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>    <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2439"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;WCS&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;WorldCoordinateSystem&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2440"></a>        <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;World&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Absolute&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2441"></a><span class="k">      </span><span class="n">DaylRefWorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2442"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;WorldCoordinateSystem&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2443"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2444"></a>    <span class="n">ENDIF</span>
<a name="ln-2445"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Rel&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Relative&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2446"></a>        <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Local&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2447"></a><span class="k">      </span><span class="n">DaylRefWorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2448"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;RelativeCoordinateSystem&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2449"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2450"></a>    <span class="n">ENDIF</span>
<a name="ln-2451"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2452"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-2453"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; defaults to &quot;RelativeToZoneOrigin&quot;&#39;</span><span class="p">)</span>
<a name="ln-2454"></a>      <span class="n">DaylRefWorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2455"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;RelativeToZoneOrigin&#39;</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-2456"></a>    <span class="n">ENDIF</span>
<a name="ln-2457"></a>
<a name="ln-2458"></a>    <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2459"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;WCS&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;WorldCoordinateSystem&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2460"></a>        <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;World&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Absolute&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2461"></a><span class="k">      </span><span class="n">RectSurfRefWorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2462"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;WorldCoordinateSystem&#39;</span>
<a name="ln-2463"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2464"></a>    <span class="n">ENDIF</span>
<a name="ln-2465"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Rel&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Relative&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2466"></a>        <span class="n">SameString</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Local&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2467"></a><span class="k">      </span><span class="n">RectSurfRefWorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2468"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;RelativeToZoneOrigin&#39;</span>
<a name="ln-2469"></a>      <span class="n">OK</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2470"></a>    <span class="n">ENDIF</span>
<a name="ln-2471"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2472"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2473"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; defaults to &quot;RelativeToZoneOrigin&quot;&#39;</span><span class="p">)</span>
<a name="ln-2474"></a>      <span class="n">RectSurfRefWorldCoordSystem</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2475"></a>      <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;RelativeToZoneOrigin&#39;</span>
<a name="ln-2476"></a>    <span class="n">ENDIF</span>
<a name="ln-2477"></a>
<a name="ln-2478"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2479"></a>
<a name="ln-2480"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Required object not found.&#39;</span><span class="p">)</span>
<a name="ln-2481"></a>    <span class="n">OutMsg</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;None found in input&#39;</span>
<a name="ln-2482"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2483"></a>
<a name="ln-2484"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2485"></a>
<a name="ln-2486"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered.  Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-2487"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2488"></a>
<a name="ln-2489"></a>  <span class="k">END SELECT</span>
<a name="ln-2490"></a>
<a name="ln-2491"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2492"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DaylRefWorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2493"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Potential mismatch of coordinate specifications.&#39;</span><span class="p">)</span>
<a name="ln-2494"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;; while &#39;</span><span class="p">)</span>
<a name="ln-2495"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2496"></a>    <span class="n">ENDIF</span>
<a name="ln-2497"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RectSurfRefWorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2498"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Potential mismatch of coordinate specifications.&#39;</span><span class="p">)</span>
<a name="ln-2499"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;; while &#39;</span><span class="p">)</span>
<a name="ln-2500"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GAlphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2501"></a>    <span class="n">ENDIF</span>
<a name="ln-2502"></a>  <span class="n">ENDIF</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="s1">&#39;! &lt;SurfaceGeometry&gt;,Starting Corner,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2505"></a>              <span class="s1">&#39;Vertex Input Direction,Coordinate System,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2506"></a>              <span class="s1">&#39;Daylight Reference Point Coordinate System,&#39;</span><span class="o">//</span><span class="s1">&#39;Rectangular (Simple) Surface Coordinate System&#39;</span>
<a name="ln-2507"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">OutMsg</span><span class="p">)</span>
<a name="ln-2508"></a>
<a name="ln-2509"></a><span class="mi">720</span> <span class="k">Format</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2510"></a>
<a name="ln-2511"></a>  <span class="k">RETURN</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a><span class="k">END SUBROUTINE </span><span class="n">GetGeometryParameters</span>
<a name="ln-2514"></a>
<a name="ln-2515"></a><span class="k">SUBROUTINE </span><span class="n">GetDetShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotDetachedFixed</span><span class="p">,</span><span class="n">TotDetachedBldg</span><span class="p">)</span>
<a name="ln-2516"></a>
<a name="ln-2517"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2518"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-2519"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-2520"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2521"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2522"></a>
<a name="ln-2523"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2524"></a>          <span class="c">! This subroutine gets the Detached Shading Surface Data,</span>
<a name="ln-2525"></a>          <span class="c">! checks it for errors, etc.</span>
<a name="ln-2526"></a>
<a name="ln-2527"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2528"></a>          <span class="c">! na</span>
<a name="ln-2529"></a>
<a name="ln-2530"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2531"></a>  <span class="c">! Detached Shading Surface Definition(s)</span>
<a name="ln-2532"></a>  <span class="c">!Surface:Shading:Detached:Fixed,</span>
<a name="ln-2533"></a>  <span class="c">!       \memo used for shading elements such as trees</span>
<a name="ln-2534"></a>  <span class="c">!       \memo these items are fixed in space and would not move with relative geometry</span>
<a name="ln-2535"></a>  <span class="c">!  A1 , \field User Supplied Surface Name</span>
<a name="ln-2536"></a>  <span class="c">!       \required-field</span>
<a name="ln-2537"></a>  <span class="c">!       \type alpha</span>
<a name="ln-2538"></a>  <span class="c">!  A2,  \field TransSchedShadowSurf</span>
<a name="ln-2539"></a>  <span class="c">!       \note Transmittance schedule for the shading device, defaults to zero (always opaque)</span>
<a name="ln-2540"></a>  <span class="c">!       \type object-list</span>
<a name="ln-2541"></a>  <span class="c">!       \object-list ScheduleNames</span>
<a name="ln-2542"></a>  <span class="c">!  N1 , \field Number of Surface Vertex Groups -- Number of (X,Y,Z) groups in this surface</span>
<a name="ln-2543"></a>  <span class="c">!       \required-field</span>
<a name="ln-2544"></a>  <span class="c">!       \note shown with 12 vertex coordinates -- extensible object</span>
<a name="ln-2545"></a>  <span class="c">!       \autocalculatable</span>
<a name="ln-2546"></a>  <span class="c">!       \default autocalculate</span>
<a name="ln-2547"></a>  <span class="c">!       \minimum 3</span>
<a name="ln-2548"></a>  <span class="c">!       \note Rules for vertices are given in SurfaceGeometry coordinates --</span>
<a name="ln-2549"></a>  <span class="c">!       \note For this object all surface coordinates are relative to the building origin (0,0,0)</span>
<a name="ln-2550"></a>  <span class="c">!       \note and will rotate with the BUILDING north axis.</span>
<a name="ln-2551"></a>  <span class="c">!  N2,  \field Vertex 1 X-coordinate</span>
<a name="ln-2552"></a>  <span class="c">!       \units m</span>
<a name="ln-2553"></a>  <span class="c">!       \type real</span>
<a name="ln-2554"></a>  <span class="c">!  N3-37; as indicated by the N1 value</span>
<a name="ln-2555"></a>  <span class="c">!</span>
<a name="ln-2556"></a>  <span class="c">!Surface:Shading:Detached:Building,</span>
<a name="ln-2557"></a>  <span class="c">!       \memo used for shading elements such as trees, other buildings, parts of this building not being modeled</span>
<a name="ln-2558"></a>  <span class="c">!       \memo these items are relative to the current building and would move with relative geometry</span>
<a name="ln-2559"></a>  <span class="c">!  A1 , \field User Supplied Surface Name</span>
<a name="ln-2560"></a>  <span class="c">!       \required-field</span>
<a name="ln-2561"></a>  <span class="c">!       \type alpha</span>
<a name="ln-2562"></a>  <span class="c">!  A2,  \field TransSchedShadowSurf</span>
<a name="ln-2563"></a>  <span class="c">!       \note Transmittance schedule for the shading device, defaults to zero (always opaque)</span>
<a name="ln-2564"></a>  <span class="c">!       \type object-list</span>
<a name="ln-2565"></a>  <span class="c">!       \object-list ScheduleNames</span>
<a name="ln-2566"></a>  <span class="c">!  N1 , \field Number of Surface Vertex Groups -- Number of (X,Y,Z) groups in this surface</span>
<a name="ln-2567"></a>  <span class="c">!       \required-field</span>
<a name="ln-2568"></a>  <span class="c">!       \note shown with 12 vertex coordinates -- extensible object</span>
<a name="ln-2569"></a>  <span class="c">!       \autocalculatable</span>
<a name="ln-2570"></a>  <span class="c">!       \default autocalculate</span>
<a name="ln-2571"></a>  <span class="c">!       \minimum 3</span>
<a name="ln-2572"></a>  <span class="c">!       \note Rules for vertices are given in SurfaceGeometry coordinates --</span>
<a name="ln-2573"></a>  <span class="c">!       \note For this object all surface coordinates are relative to the building origin (0,0,0)</span>
<a name="ln-2574"></a>  <span class="c">!       \note and will rotate with the BUILDING north axis.</span>
<a name="ln-2575"></a>  <span class="c">!  N2,  \field Vertex 1 X-coordinate</span>
<a name="ln-2576"></a>  <span class="c">!       \units m</span>
<a name="ln-2577"></a>  <span class="c">!       \type real</span>
<a name="ln-2578"></a>  <span class="c">!  N3-37; as indicated by the N1 value</span>
<a name="ln-2579"></a>
<a name="ln-2580"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2581"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-2582"></a>  <span class="k">USE </span><span class="n">DataReportingFlags</span>
<a name="ln-2583"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-2584"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span><span class="p">,</span><span class="n">CheckScheduleValueMinMax</span><span class="p">,</span><span class="n">GetScheduleMinValue</span><span class="p">,</span><span class="n">GetScheduleMaxValue</span>
<a name="ln-2585"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2586"></a>
<a name="ln-2587"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2588"></a>
<a name="ln-2589"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2590"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-2591"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-2592"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">TotDetachedFixed</span>  <span class="c">! Number of Fixed Detached Shading Surfaces to obtain</span>
<a name="ln-2593"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">TotDetachedBldg</span>   <span class="c">! Number of Building Detached Shading Surfaces to obtain</span>
<a name="ln-2594"></a>
<a name="ln-2595"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2596"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cModuleObjects</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2597"></a>    <span class="p">(</span><span class="o">/</span><span class="s1">&#39;Shading:Site:Detailed    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2598"></a>      <span class="s1">&#39;Shading:Building:Detailed&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2599"></a>
<a name="ln-2600"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2601"></a>          <span class="c">! na</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2604"></a>          <span class="c">! na</span>
<a name="ln-2605"></a>
<a name="ln-2606"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2607"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-2608"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>   <span class="c">! Number of material alpha names being passed</span>
<a name="ln-2609"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>    <span class="c">! Number of material properties being passed</span>
<a name="ln-2610"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-2611"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-2612"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-2613"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-2614"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ItemsToGet</span>
<a name="ln-2615"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ClassItem</span>
<a name="ln-2616"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">numSides</span>
<a name="ln-2617"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SchedMinValue</span>
<a name="ln-2618"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SchedMaxValue</span>
<a name="ln-2619"></a>
<a name="ln-2620"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">TotDetachedFixed</span><span class="o">+</span><span class="n">TotDetachedBldg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2621"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Detached shading effects are ignored when Solar Distribution = MinimalShadowing&#39;</span><span class="p">)</span>
<a name="ln-2622"></a>  <span class="n">ENDIF</span>
<a name="ln-2623"></a>
<a name="ln-2624"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">TotDetachedFixed</span><span class="o">+</span><span class="n">TotDetachedBldg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-2625"></a>
<a name="ln-2626"></a><span class="k">  DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-2627"></a>
<a name="ln-2628"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="n">cModuleObjects</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span>
<a name="ln-2629"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2630"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotDetachedFixed</span>
<a name="ln-2631"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="n">SurfaceClass_Detached_F</span>
<a name="ln-2632"></a>    <span class="k">ELSE</span>  <span class="c">!IF (Item == 2) THEN</span>
<a name="ln-2633"></a>      <span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotDetachedBldg</span>
<a name="ln-2634"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="n">SurfaceClass_Detached_B</span>
<a name="ln-2635"></a>    <span class="n">ENDIF</span>
<a name="ln-2636"></a>
<a name="ln-2637"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-2638"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2639"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2640"></a>                           <span class="s1">&#39;not = 2 Alpha Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2641"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumAlphas</span><span class="p">)))</span>
<a name="ln-2642"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2643"></a>    <span class="n">ENDIF</span>
<a name="ln-2644"></a>
<a name="ln-2645"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ItemsToGet</span>
<a name="ln-2646"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2647"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2648"></a>                         <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2649"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2650"></a>      <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2651"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2652"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2653"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2654"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-2655"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2656"></a>        <span class="k">CYCLE</span>
<a name="ln-2657"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-2658"></a>
<a name="ln-2659"></a>      <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2660"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-2661"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">ClassItem</span>
<a name="ln-2662"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2663"></a>    <span class="c">! Base transmittance of a shadowing (sub)surface</span>
<a name="ln-2664"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2665"></a>         <span class="c">! Schedule for a shadowing (sub)surface</span>
<a name="ln-2666"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2667"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2668"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2669"></a>                               <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2670"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2671"></a>        <span class="n">ENDIF</span>
<a name="ln-2672"></a>      <span class="k">ELSE</span>
<a name="ln-2673"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2674"></a>      <span class="n">ENDIF</span>
<a name="ln-2675"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2676"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2677"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2678"></a>                               <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2679"></a>                               <span class="s1">&#39;&quot;, values not in range [0,1].&#39;</span><span class="p">)</span>
<a name="ln-2680"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2681"></a>        <span class="n">ENDIF</span>
<a name="ln-2682"></a>        <span class="n">SchedMinValue</span><span class="o">=</span><span class="n">GetScheduleMinValue</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">)</span>
<a name="ln-2683"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMinValue</span><span class="o">=</span><span class="n">SchedMinValue</span>
<a name="ln-2684"></a>        <span class="n">SchedMaxValue</span><span class="o">=</span><span class="n">GetScheduleMaxValue</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">)</span>
<a name="ln-2685"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SchedMinValue</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2686"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2687"></a>                               <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2688"></a>                               <span class="s1">&#39;&quot;, is always transparent.&#39;</span><span class="p">)</span>
<a name="ln-2689"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IsTransparent</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2690"></a>        <span class="n">ENDIF</span>
<a name="ln-2691"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SchedMinValue</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2692"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2693"></a>                               <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2694"></a>                               <span class="s1">&#39;&quot;, has schedule values &lt; 0.&#39;</span><span class="p">)</span>
<a name="ln-2695"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Schedule values &lt; 0 have no meaning for shading elements.&#39;</span><span class="p">)</span>
<a name="ln-2696"></a>        <span class="n">ENDIF</span>
<a name="ln-2697"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SchedMaxValue</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2698"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2699"></a>                               <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2700"></a>                               <span class="s1">&#39;&quot;, has schedule values &gt; 1.&#39;</span><span class="p">)</span>
<a name="ln-2701"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Schedule values &gt; 1 have no meaning for shading elements.&#39;</span><span class="p">)</span>
<a name="ln-2702"></a>        <span class="n">ENDIF</span>
<a name="ln-2703"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SchedMinValue</span><span class="o">-</span><span class="n">SchedMaxValue</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2704"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfSchedVaries</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2705"></a>          <span class="n">ShadingTransmittanceVaries</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2706"></a>        <span class="n">ENDIF</span>
<a name="ln-2707"></a>      <span class="n">ENDIF</span>
<a name="ln-2708"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2709"></a><span class="k">        </span><span class="n">numSides</span><span class="o">=</span><span class="p">(</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-2710"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">numSides</span>
<a name="ln-2711"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2712"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2713"></a>                          <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-2714"></a>                          <span class="s1">&#39; not even multiple of 3. Will read in &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2715"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-2716"></a>        <span class="n">ENDIF</span>
<a name="ln-2717"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">numSides</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2718"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2719"></a>                          <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (autocalculate) must be &gt;= 3. Only &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2720"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; provided.&#39;</span><span class="p">)</span>
<a name="ln-2721"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2722"></a>          <span class="k">CYCLE</span>
<a name="ln-2723"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-2724"></a>      <span class="k">ELSE</span>
<a name="ln-2725"></a><span class="k">        </span><span class="n">numSides</span><span class="o">=</span><span class="p">(</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-2726"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2727"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">numSides</span> <span class="o">&gt;</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2728"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2729"></a>                          <span class="s1">&#39;&quot;, field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-2730"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...but &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">numSides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; were entered. Only the indicated &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2731"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; will be used.&#39;</span><span class="p">)</span>
<a name="ln-2732"></a>        <span class="n">ENDIF</span>
<a name="ln-2733"></a>      <span class="n">ENDIF</span>
<a name="ln-2734"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-2735"></a>      <span class="k">CALL </span><span class="n">GetVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">:))</span>
<a name="ln-2736"></a>      <span class="k">CALL </span><span class="n">CheckConvexity</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-2737"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MakeMirroredDetachedShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2738"></a><span class="k">        CALL </span><span class="n">MakeMirrorSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-2739"></a>      <span class="n">ENDIF</span>
<a name="ln-2740"></a>    <span class="n">ENDDO</span>
<a name="ln-2741"></a>
<a name="ln-2742"></a>  <span class="n">ENDDO</span> <span class="c">! Item Loop</span>
<a name="ln-2743"></a>
<a name="ln-2744"></a>  <span class="k">RETURN</span>
<a name="ln-2745"></a>
<a name="ln-2746"></a><span class="k">END SUBROUTINE </span><span class="n">GetDetShdSurfaceData</span>
<a name="ln-2747"></a>
<a name="ln-2748"></a><span class="k">SUBROUTINE </span><span class="n">GetRectDetShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotRectDetachedFixed</span><span class="p">,</span><span class="n">TotRectDetachedBldg</span><span class="p">)</span>
<a name="ln-2749"></a>
<a name="ln-2750"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2751"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-2752"></a>          <span class="c">!       DATE WRITTEN   January 2009</span>
<a name="ln-2753"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2754"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2755"></a>
<a name="ln-2756"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2757"></a>          <span class="c">! Gets the simple, rectantular detached surfaces.</span>
<a name="ln-2758"></a>
<a name="ln-2759"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2760"></a>          <span class="c">! na</span>
<a name="ln-2761"></a>
<a name="ln-2762"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2763"></a>          <span class="c">! na</span>
<a name="ln-2764"></a>
<a name="ln-2765"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2766"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-2767"></a>  <span class="k">USE </span><span class="n">DataReportingFlags</span>
<a name="ln-2768"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-2769"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2770"></a>
<a name="ln-2771"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2772"></a>
<a name="ln-2773"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2774"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-2775"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-2776"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">TotRectDetachedFixed</span>  <span class="c">! Number of Fixed Detached Shading Surfaces to obtain</span>
<a name="ln-2777"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">TotRectDetachedBldg</span>   <span class="c">! Number of Building Detached Shading Surfaces to obtain</span>
<a name="ln-2778"></a>
<a name="ln-2779"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2780"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cModuleObjects</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2781"></a>    <span class="p">(</span><span class="o">/</span><span class="s1">&#39;Shading:Site    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2782"></a>      <span class="s1">&#39;Shading:Building&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2783"></a>
<a name="ln-2784"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2785"></a>          <span class="c">! na</span>
<a name="ln-2786"></a>
<a name="ln-2787"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2788"></a>          <span class="c">! na</span>
<a name="ln-2789"></a>
<a name="ln-2790"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2791"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-2792"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>   <span class="c">! Number of material alpha names being passed</span>
<a name="ln-2793"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>    <span class="c">! Number of material properties being passed</span>
<a name="ln-2794"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-2795"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-2796"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-2797"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-2798"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ItemsToGet</span>
<a name="ln-2799"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ClassItem</span>
<a name="ln-2800"></a>
<a name="ln-2801"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">TotRectDetachedFixed</span><span class="o">+</span><span class="n">TotRectDetachedBldg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2802"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Detached shading effects are ignored when Solar Distribution = MinimalShadowing&#39;</span><span class="p">)</span>
<a name="ln-2803"></a>  <span class="n">ENDIF</span>
<a name="ln-2804"></a>
<a name="ln-2805"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotRectDetachedFixed</span><span class="o">+</span><span class="n">TotRectDetachedBldg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-2806"></a>
<a name="ln-2807"></a><span class="k">  DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-2808"></a>
<a name="ln-2809"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="n">cModuleObjects</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span>
<a name="ln-2810"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2811"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectDetachedFixed</span>
<a name="ln-2812"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="n">SurfaceClass_Detached_F</span>
<a name="ln-2813"></a>    <span class="k">ELSE</span>  <span class="c">!IF (Item == 2) THEN</span>
<a name="ln-2814"></a>      <span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectDetachedBldg</span>
<a name="ln-2815"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="n">SurfaceClass_Detached_B</span>
<a name="ln-2816"></a>    <span class="n">ENDIF</span>
<a name="ln-2817"></a>
<a name="ln-2818"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-2819"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2820"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2821"></a>                           <span class="s1">&#39;not = 1 Alpha Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2822"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumAlphas</span><span class="p">)))</span>
<a name="ln-2823"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2824"></a>    <span class="n">ENDIF</span>
<a name="ln-2825"></a>
<a name="ln-2826"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ItemsToGet</span>
<a name="ln-2827"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2828"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2829"></a>                         <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2830"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2831"></a>      <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2832"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2833"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2834"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2835"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-2836"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2837"></a>        <span class="k">CYCLE</span>
<a name="ln-2838"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-2839"></a>
<a name="ln-2840"></a>      <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2841"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-2842"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">ClassItem</span>
<a name="ln-2843"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2844"></a>
<a name="ln-2845"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2846"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2847"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">+</span><span class="n">BuildingAzimuth</span>
<a name="ln-2848"></a>      <span class="n">ENDIF</span>
<a name="ln-2849"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2850"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">+</span><span class="n">BuildingRotationAppendixG</span>
<a name="ln-2851"></a>      <span class="n">ENDIF</span>
<a name="ln-2852"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2853"></a>
<a name="ln-2854"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-2855"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-2856"></a>
<a name="ln-2857"></a>      <span class="k">CALL </span><span class="n">MakeRectangularVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2858"></a>                                   <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">RectSurfRefWorldCoordSystem</span><span class="p">)</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2861"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2862"></a>              <span class="s1">&#39;&quot;, Surface Area &lt;= 0.0; Entered Area=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2863"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2864"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2865"></a>      <span class="n">ENDIF</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MakeMirroredDetachedShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2868"></a><span class="k">        CALL </span><span class="n">MakeMirrorSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-2869"></a>      <span class="n">ENDIF</span>
<a name="ln-2870"></a>    <span class="n">ENDDO</span>
<a name="ln-2871"></a>
<a name="ln-2872"></a>  <span class="n">ENDDO</span> <span class="c">! Item Loop</span>
<a name="ln-2873"></a>
<a name="ln-2874"></a>  <span class="k">RETURN</span>
<a name="ln-2875"></a>
<a name="ln-2876"></a><span class="k">END SUBROUTINE </span><span class="n">GetRectDetShdSurfaceData</span>
<a name="ln-2877"></a>
<a name="ln-2878"></a><span class="k">SUBROUTINE </span><span class="n">GetHTSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotHTSurfs</span><span class="p">,</span><span class="n">TotDetailedWalls</span><span class="p">,</span><span class="n">TotDetailedRoofs</span><span class="p">,</span><span class="n">TotDetailedFloors</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2879"></a>                  <span class="n">BaseSurfCls</span><span class="p">,</span><span class="n">BaseSurfIDs</span><span class="p">,</span><span class="n">NeedToAddSurfaces</span><span class="p">)</span>
<a name="ln-2880"></a>
<a name="ln-2881"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2882"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-2883"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-2884"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2885"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2886"></a>
<a name="ln-2887"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2888"></a>          <span class="c">! This subroutine gets the HeatTransfer Surface Data,</span>
<a name="ln-2889"></a>          <span class="c">! checks it for errors, etc.</span>
<a name="ln-2890"></a>
<a name="ln-2891"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2892"></a>          <span class="c">! na</span>
<a name="ln-2893"></a>
<a name="ln-2894"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2895"></a>  <span class="c">! Heat Transfer Surface Definition</span>
<a name="ln-2896"></a>  <span class="c">!BuildingSurface:Detailed,</span>
<a name="ln-2897"></a>  <span class="c">!  \extensible:3 -- duplicate last set of x,y,z coordinates (last 3 fields), remembering to remove ; from &quot;inner&quot; fields.</span>
<a name="ln-2898"></a>  <span class="c">!  \format vertices</span>
<a name="ln-2899"></a>  <span class="c">!  A1 , \field Name</span>
<a name="ln-2900"></a>  <span class="c">!       \required-field</span>
<a name="ln-2901"></a>  <span class="c">!       \type alpha</span>
<a name="ln-2902"></a>  <span class="c">!       \reference SurfaceNames</span>
<a name="ln-2903"></a>  <span class="c">!       \reference SurfAndSubSurfNames</span>
<a name="ln-2904"></a>  <span class="c">!       \reference AllHeatTranSurfNames</span>
<a name="ln-2905"></a>  <span class="c">!       \reference HeatTranBaseSurfNames</span>
<a name="ln-2906"></a>  <span class="c">!       \reference OutFaceEnvNames</span>
<a name="ln-2907"></a>  <span class="c">!       \reference AllHeatTranAngFacNames</span>
<a name="ln-2908"></a>  <span class="c">!       \reference RadGroupAndSurfNames</span>
<a name="ln-2909"></a>  <span class="c">!       \reference SurfGroupAndHTSurfNames</span>
<a name="ln-2910"></a>  <span class="c">!       \reference AllShadingAndHTSurfNames</span>
<a name="ln-2911"></a>  <span class="c">!  A2 , \field Surface Type</span>
<a name="ln-2912"></a>  <span class="c">!       \required-field</span>
<a name="ln-2913"></a>  <span class="c">!       \type choice</span>
<a name="ln-2914"></a>  <span class="c">!       \key Floor</span>
<a name="ln-2915"></a>  <span class="c">!       \key Wall</span>
<a name="ln-2916"></a>  <span class="c">!       \key Ceiling</span>
<a name="ln-2917"></a>  <span class="c">!       \key Roof</span>
<a name="ln-2918"></a>  <span class="c">!  A3 , \field Construction Name</span>
<a name="ln-2919"></a>  <span class="c">!       \required-field</span>
<a name="ln-2920"></a>  <span class="c">!       \note To be matched with a construction in this input file</span>
<a name="ln-2921"></a>  <span class="c">!       \type object-list</span>
<a name="ln-2922"></a>  <span class="c">!       \object-list ConstructionNames</span>
<a name="ln-2923"></a>  <span class="c">!  A4 , \field Zone Name</span>
<a name="ln-2924"></a>  <span class="c">!       \required-field</span>
<a name="ln-2925"></a>  <span class="c">!       \note Zone the surface is a part of</span>
<a name="ln-2926"></a>  <span class="c">!       \type object-list</span>
<a name="ln-2927"></a>  <span class="c">!       \object-list ZoneNames</span>
<a name="ln-2928"></a>  <span class="c">!  A5 , \field Outside Boundary Condition</span>
<a name="ln-2929"></a>  <span class="c">!       \required-field</span>
<a name="ln-2930"></a>  <span class="c">!       \type choice</span>
<a name="ln-2931"></a>  <span class="c">!       \key Adiabatic</span>
<a name="ln-2932"></a>  <span class="c">!       \key Surface</span>
<a name="ln-2933"></a>  <span class="c">!       \key Zone</span>
<a name="ln-2934"></a>  <span class="c">!       \key Outdoors</span>
<a name="ln-2935"></a>  <span class="c">!       \key Ground</span>
<a name="ln-2936"></a>  <span class="c">!       \key GroundFCfactorMethod</span>
<a name="ln-2937"></a>  <span class="c">!       \key OtherSideCoefficients</span>
<a name="ln-2938"></a>  <span class="c">!       \key OtherSideConditionsModel</span>
<a name="ln-2939"></a>  <span class="c">!       \key GroundSlabPreprocessorAverage</span>
<a name="ln-2940"></a>  <span class="c">!       \key GroundSlabPreprocessorCore</span>
<a name="ln-2941"></a>  <span class="c">!       \key GroundSlabPreprocessorPerimeter</span>
<a name="ln-2942"></a>  <span class="c">!       \key GroundBasementPreprocessorAverageWall</span>
<a name="ln-2943"></a>  <span class="c">!       \key GroundBasementPreprocessorAverageFloor</span>
<a name="ln-2944"></a>  <span class="c">!       \key GroundBasementPreprocessorUpperWall</span>
<a name="ln-2945"></a>  <span class="c">!       \key GroundBasementPreprocessorLowerWall</span>
<a name="ln-2946"></a>  <span class="c">!  A6,  \field Outside Boundary Condition Object</span>
<a name="ln-2947"></a>  <span class="c">!       \type object-list</span>
<a name="ln-2948"></a>  <span class="c">!       \object-list OutFaceEnvNames</span>
<a name="ln-2949"></a>  <span class="c">!       \note Non-blank only if the field Outside Boundary Condition is Surface,</span>
<a name="ln-2950"></a>  <span class="c">!       \note Zone, OtherSideCoefficients or OtherSideConditionsModel</span>
<a name="ln-2951"></a>  <span class="c">!       \note If Surface, specify name of corresponding surface in adjacent zone or</span>
<a name="ln-2952"></a>  <span class="c">!       \note specify current surface name for internal partition separating like zones</span>
<a name="ln-2953"></a>  <span class="c">!       \note If Zone, specify the name of the corresponding zone and</span>
<a name="ln-2954"></a>  <span class="c">!       \note the program will generate the corresponding interzone surface</span>
<a name="ln-2955"></a>  <span class="c">!       \note If OtherSideCoefficients, specify name of SurfaceProperty:OtherSideCoefficients</span>
<a name="ln-2956"></a>  <span class="c">!       \note If OtherSideConditionsModel, specify name of SurfaceProperty:OtherSideConditionsModel</span>
<a name="ln-2957"></a>  <span class="c">!  A7 , \field Sun Exposure</span>
<a name="ln-2958"></a>  <span class="c">!       \required-field</span>
<a name="ln-2959"></a>  <span class="c">!       \type choice</span>
<a name="ln-2960"></a>  <span class="c">!       \key SunExposed</span>
<a name="ln-2961"></a>  <span class="c">!       \key NoSun</span>
<a name="ln-2962"></a>  <span class="c">!       \default SunExposed</span>
<a name="ln-2963"></a>  <span class="c">!  A8,  \field Wind Exposure</span>
<a name="ln-2964"></a>  <span class="c">!       \required-field</span>
<a name="ln-2965"></a>  <span class="c">!       \type choice</span>
<a name="ln-2966"></a>  <span class="c">!       \key WindExposed</span>
<a name="ln-2967"></a>  <span class="c">!       \key NoWind</span>
<a name="ln-2968"></a>  <span class="c">!       \default WindExposed</span>
<a name="ln-2969"></a>  <span class="c">!  N1,  \field View Factor to Ground</span>
<a name="ln-2970"></a>  <span class="c">!       \type real</span>
<a name="ln-2971"></a>  <span class="c">!       \note From the exterior of the surface</span>
<a name="ln-2972"></a>  <span class="c">!       \note Unused if one uses the &quot;reflections&quot; options in Solar Distribution in Building input</span>
<a name="ln-2973"></a>  <span class="c">!       \note unless a DaylightingDevice:Shelf or DaylightingDevice:Tubular object has been specified.</span>
<a name="ln-2974"></a>  <span class="c">!       \note autocalculate will automatically calculate this value from the tilt of the surface</span>
<a name="ln-2975"></a>  <span class="c">!       \autocalculatable</span>
<a name="ln-2976"></a>  <span class="c">!       \minimum 0.0</span>
<a name="ln-2977"></a>  <span class="c">!       \maximum 1.0</span>
<a name="ln-2978"></a>  <span class="c">!       \default autocalculate</span>
<a name="ln-2979"></a>  <span class="c">!  N2 , \field Number of Vertices</span>
<a name="ln-2980"></a>  <span class="c">!       \note shown with 120 vertex coordinates -- extensible object</span>
<a name="ln-2981"></a>  <span class="c">!       \note  &quot;extensible&quot; -- duplicate last set of x,y,z coordinates (last 3 fields),</span>
<a name="ln-2982"></a>  <span class="c">!       \note remembering to remove ; from &quot;inner&quot; fields.</span>
<a name="ln-2983"></a>  <span class="c">!       \note for clarity in any error messages, renumber the fields as well.</span>
<a name="ln-2984"></a>  <span class="c">!       \note (and changing z terminator to a comma &quot;,&quot; for all but last one which needs a semi-colon &quot;;&quot;)</span>
<a name="ln-2985"></a>  <span class="c">!       \autocalculatable</span>
<a name="ln-2986"></a>  <span class="c">!       \minimum 3</span>
<a name="ln-2987"></a>  <span class="c">!       \default autocalculate</span>
<a name="ln-2988"></a>  <span class="c">!       \note vertices are given in GlobalGeometryRules coordinates -- if relative, all surface coordinates</span>
<a name="ln-2989"></a>  <span class="c">!       \note are &quot;relative&quot; to the Zone Origin.  If world, then building and zone origins are used</span>
<a name="ln-2990"></a>  <span class="c">!       \note for some internal calculations, but all coordinates are given in an &quot;absolute&quot; system.</span>
<a name="ln-2991"></a>  <span class="c">!  N3-xx as indicated by the N3 value</span>
<a name="ln-2992"></a>
<a name="ln-2993"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2994"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-2995"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-2996"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span><span class="n">TrimSigDigits</span>
<a name="ln-2997"></a>
<a name="ln-2998"></a>
<a name="ln-2999"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3000"></a>
<a name="ln-3001"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3002"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-3003"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-3004"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotHTSurfs</span>        <span class="c">! Number of Heat Transfer Base Surfaces to obtain</span>
<a name="ln-3005"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotDetailedWalls</span>  <span class="c">! Number of Wall:Detailed items to obtain</span>
<a name="ln-3006"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotDetailedRoofs</span>  <span class="c">! Number of RoofCeiling:Detailed items to obtain</span>
<a name="ln-3007"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotDetailedFloors</span> <span class="c">! Number of Floor:Detailed items to obtain</span>
<a name="ln-3008"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSurfCls</span>  <span class="c">! Valid Classes for Base Surfaces</span>
<a name="ln-3009"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSurfIDs</span>
<a name="ln-3010"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NeedToAddSurfaces</span> <span class="c">! Number of surfaces to add, based on unentered IZ surfaces</span>
<a name="ln-3011"></a>
<a name="ln-3012"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3013"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cModuleObjects</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-3014"></a>    <span class="p">(</span><span class="o">/</span><span class="s1">&#39;BuildingSurface:Detailed&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3015"></a>      <span class="s1">&#39;Wall:Detailed           &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3016"></a>      <span class="s1">&#39;Floor:Detailed          &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3017"></a>      <span class="s1">&#39;RoofCeiling:Detailed    &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-3018"></a>
<a name="ln-3019"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3020"></a>          <span class="c">! na</span>
<a name="ln-3021"></a>
<a name="ln-3022"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3023"></a>          <span class="c">! na</span>
<a name="ln-3024"></a>
<a name="ln-3025"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3026"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-3027"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceNumAlpha</span>   <span class="c">! Number of material alpha names being passed</span>
<a name="ln-3028"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceNumProp</span>    <span class="c">! Number of material properties being passed</span>
<a name="ln-3029"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>           <span class="c">! DO loop counter (zones)</span>
<a name="ln-3030"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>             <span class="c">! For matching interzone surfaces</span>
<a name="ln-3031"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-3032"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-3033"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-3034"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-3035"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ItemsToGet</span>
<a name="ln-3036"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ClassItem</span>
<a name="ln-3037"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ArgPointer</span>
<a name="ln-3038"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">numSides</span>
<a name="ln-3039"></a>
<a name="ln-3040"></a>  <span class="k">CALL </span><span class="n">GetOSCData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-3041"></a>  <span class="k">Call </span><span class="n">GetOSCMData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-3042"></a>
<a name="ln-3043"></a>  <span class="n">NeedToAddSurfaces</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3044"></a>
<a name="ln-3045"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-3046"></a>
<a name="ln-3047"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="n">cModuleObjects</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span>
<a name="ln-3048"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3049"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotHTSurfs</span>
<a name="ln-3050"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3051"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3052"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotDetailedWalls</span>
<a name="ln-3053"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-3054"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3055"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotDetailedFloors</span>
<a name="ln-3056"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-3057"></a>    <span class="k">ELSE</span> <span class="c">!IF (Item == 4) THEN</span>
<a name="ln-3058"></a>      <span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotDetailedRoofs</span>
<a name="ln-3059"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-3060"></a>    <span class="n">ENDIF</span>
<a name="ln-3061"></a>
<a name="ln-3062"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">SurfaceNumAlpha</span><span class="p">,</span><span class="n">SurfaceNumProp</span><span class="p">)</span>
<a name="ln-3063"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3064"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceNumAlpha</span> <span class="o">/=</span> <span class="mi">8</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3065"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3066"></a>                             <span class="s1">&#39;not = 8 Alpha Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3067"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceNumAlpha</span><span class="p">)))</span>
<a name="ln-3068"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3069"></a>      <span class="n">ENDIF</span>
<a name="ln-3070"></a>    <span class="k">ELSE</span>
<a name="ln-3071"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceNumAlpha</span> <span class="o">/=</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3072"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3073"></a>                             <span class="s1">&#39;not = 7 Alpha Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3074"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceNumAlpha</span><span class="p">)))</span>
<a name="ln-3075"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3076"></a>      <span class="n">ENDIF</span>
<a name="ln-3077"></a>    <span class="n">ENDIF</span>
<a name="ln-3078"></a>
<a name="ln-3079"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ItemsToGet</span>
<a name="ln-3080"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">SurfaceNumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">SurfaceNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3081"></a>                     <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3082"></a>                     <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3083"></a>      <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3084"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3085"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3086"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3087"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-3088"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3089"></a>        <span class="k">CYCLE</span>
<a name="ln-3090"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-3091"></a>
<a name="ln-3092"></a>      <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3093"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-3094"></a>      <span class="n">ArgPointer</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-3095"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3096"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CEILING&#39;</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;ROOF&#39;</span>
<a name="ln-3097"></a>        <span class="n">ClassItem</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">BaseSurfCls</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3098"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ClassItem</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3099"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3100"></a>                                 <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3101"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3102"></a>        <span class="k">ELSE</span>
<a name="ln-3103"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">=</span> <span class="n">BaseSurfIDs</span><span class="p">(</span><span class="n">ClassItem</span><span class="p">)</span>
<a name="ln-3104"></a>        <span class="n">ENDIF</span>
<a name="ln-3105"></a>        <span class="n">ArgPointer</span><span class="o">=</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3106"></a>      <span class="k">ELSE</span>
<a name="ln-3107"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">=</span> <span class="n">BaseSurfIDs</span><span class="p">(</span><span class="n">ClassItem</span><span class="p">)</span>
<a name="ln-3108"></a>      <span class="n">ENDIF</span>
<a name="ln-3109"></a>
<a name="ln-3110"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-3111"></a>
<a name="ln-3112"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3113"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3114"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3115"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3116"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3117"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3118"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3119"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3120"></a>                               <span class="s1">&#39;&quot; - has Window materials.&#39;</span><span class="p">)</span>
<a name="ln-3121"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3122"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3123"></a>        <span class="k">ELSE</span>
<a name="ln-3124"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because Surface Type=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">BaseSurfCls</span><span class="p">(</span><span class="n">ClassItem</span><span class="p">)))</span>
<a name="ln-3125"></a>        <span class="n">ENDIF</span>
<a name="ln-3126"></a>      <span class="k">ELSE</span>
<a name="ln-3127"></a><span class="k">        </span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3128"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-3129"></a>      <span class="k">END IF</span>
<a name="ln-3130"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3131"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-3132"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-3133"></a>
<a name="ln-3134"></a>      <span class="n">ArgPointer</span><span class="o">=</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3135"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">)</span>
<a name="ln-3136"></a>      <span class="n">ZoneNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">,</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3137"></a>
<a name="ln-3138"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3139"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">=</span> <span class="n">ZoneNum</span>
<a name="ln-3140"></a>      <span class="k">ELSE</span>
<a name="ln-3141"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3142"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3143"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">+</span><span class="mi">100</span>
<a name="ln-3144"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="s1">&#39;Unknown Zone&#39;</span>
<a name="ln-3145"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3146"></a>      <span class="n">ENDIF</span>
<a name="ln-3147"></a>  <span class="c">! Get the ExteriorBoundaryCondition flag from input There are 4 conditions that</span>
<a name="ln-3148"></a>  <span class="c">! can take place. The conditions are set with a 0, -1, or -2, or all of the</span>
<a name="ln-3149"></a>  <span class="c">! zone names have to be looked at and generate the interzone array number</span>
<a name="ln-3150"></a>      <span class="n">ArgPointer</span><span class="o">=</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3151"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3152"></a>
<a name="ln-3153"></a>      <span class="k">If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;Outdoors&#39;</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3154"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>
<a name="ln-3155"></a>
<a name="ln-3156"></a>      <span class="k">Else If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;Adiabatic&#39;</span><span class="p">))</span>         <span class="k">Then</span>
<a name="ln-3157"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">UnreconciledZoneSurface</span>
<a name="ln-3158"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-3159"></a>
<a name="ln-3160"></a>      <span class="k">Else If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;Ground&#39;</span><span class="p">))</span>         <span class="k">Then</span>
<a name="ln-3161"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">Ground</span>
<a name="ln-3162"></a>
<a name="ln-3163"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NoGroundTempObjWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3164"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GroundTempObjInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3165"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetHTSurfaceData: Surfaces with interface to Ground &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3166"></a>               <span class="s1">&#39;found but no &quot;Ground Temperatures&quot; were input.&#39;</span><span class="p">)</span>
<a name="ln-3167"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Found first in surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3168"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Defaults, constant throughout the year of (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GroundTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3169"></a>                               <span class="s1">&#39;) will be used.&#39;</span><span class="p">)</span>
<a name="ln-3170"></a>          <span class="n">ENDIF</span>
<a name="ln-3171"></a>          <span class="n">NoGroundTempObjWarning</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3172"></a>        <span class="n">ENDIF</span>
<a name="ln-3173"></a>
<a name="ln-3174"></a>      <span class="c">! Added for FCfactor method</span>
<a name="ln-3175"></a>      <span class="k">Else If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundFCfactorMethod&#39;</span><span class="p">))</span>         <span class="k">Then</span>
<a name="ln-3176"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">GroundFCfactorMethod</span>
<a name="ln-3177"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NoFCGroundTempObjWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3178"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">FCGroundTemps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3179"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetHTSurfaceData: Surfaces with interface to GroundFCfactorMethod found &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3180"></a>                <span class="s1">&#39;but no &quot;FC Ground Temperatures&quot; were input.&#39;</span><span class="p">)</span>
<a name="ln-3181"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Found first in surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3182"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Either add a &quot;Site:GroundTemperature:FCfactorMethod&quot; object or &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3183"></a>                <span class="s1">&#39; use a weather file with Ground Temperatures.&#39;</span><span class="p">)</span>
<a name="ln-3184"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3185"></a>            <span class="n">NoFCGroundTempObjWarning</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3186"></a>          <span class="n">ENDIF</span>
<a name="ln-3187"></a>        <span class="k">End IF</span>
<a name="ln-3188"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3189"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3190"></a>              <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsCfactorWall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3191"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3192"></a>                                 <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">)))</span>
<a name="ln-3193"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Construction=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3194"></a>               <span class="s1">&#39;&quot; is not type Construction:CfactorUndergroundWall.&#39;</span><span class="p">)</span>
<a name="ln-3195"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3196"></a>          <span class="n">ENDIF</span>
<a name="ln-3197"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3198"></a>              <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsFfactorFloor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3199"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3200"></a>                                 <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">)))</span>
<a name="ln-3201"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Construction=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3202"></a>               <span class="s1">&#39;&quot; is not type Construction:FfactorGroundFloor.&#39;</span><span class="p">)</span>
<a name="ln-3203"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3204"></a>          <span class="n">ENDIF</span>
<a name="ln-3205"></a>        <span class="n">ENDIF</span>
<a name="ln-3206"></a>
<a name="ln-3207"></a>      <span class="k">Else If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;OtherSideCoefficients&#39;</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3208"></a><span class="k">        </span><span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">OSC</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotOSC</span><span class="p">)</span>
<a name="ln-3209"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3210"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3211"></a>                      <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3212"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; no OtherSideCoefficients of that name.&#39;</span><span class="p">)</span>
<a name="ln-3213"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3214"></a>        <span class="k">ELSE</span>
<a name="ln-3215"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-3216"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">SurfFilmCoef</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3217"></a><span class="k">            </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">OtherSideCoefCalcExt</span>
<a name="ln-3218"></a>          <span class="k">ELSE</span>
<a name="ln-3219"></a><span class="k">            </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">OtherSideCoefNoCalcExt</span>
<a name="ln-3220"></a>          <span class="n">ENDIF</span>
<a name="ln-3221"></a>        <span class="n">ENDIF</span>
<a name="ln-3222"></a>
<a name="ln-3223"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;Surface&#39;</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3224"></a>            <span class="c">! it has to be another surface which needs to be found</span>
<a name="ln-3225"></a>            <span class="c">! this will be found on the second pass through the surface input</span>
<a name="ln-3226"></a>            <span class="c">! for flagging, set the value to UnreconciledZoneSurface</span>
<a name="ln-3227"></a>        <span class="c">! name (ExtBoundCondName) will be validated later.</span>
<a name="ln-3228"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">UnreconciledZoneSurface</span>
<a name="ln-3229"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3230"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-3231"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3232"></a>                        <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&lt;blank&gt;.&#39;</span><span class="p">)</span>
<a name="ln-3233"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;Surface&quot; must be non-blank.&#39;</span><span class="p">)</span>
<a name="ln-3234"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..This surface will become an adiabatic surface - no doors/windows allowed.&#39;</span><span class="p">)</span>
<a name="ln-3235"></a>        <span class="n">ENDIF</span>
<a name="ln-3236"></a>
<a name="ln-3237"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3238"></a>            <span class="c">! This is the code for an unmatched &quot;other surface&quot;</span>
<a name="ln-3239"></a>            <span class="c">! will be set up later.</span>
<a name="ln-3240"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">UnenteredAdjacentZoneSurface</span>
<a name="ln-3241"></a>        <span class="c">! check OutsideFaceEnvironment for legal zone</span>
<a name="ln-3242"></a>        <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3243"></a>        <span class="n">NeedToAddSurfaces</span><span class="o">=</span><span class="n">NeedToAddSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3244"></a>
<a name="ln-3245"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3246"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3247"></a>                        <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3248"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Referenced as Zone for this surface.&#39;</span><span class="p">)</span>
<a name="ln-3249"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3250"></a>        <span class="n">ENDIF</span>
<a name="ln-3251"></a>
<a name="ln-3252"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span> <span class="s1">&#39;OtherSideConditionsModel&#39;</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3253"></a><span class="k">        </span><span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">OSCM</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotOSCM</span><span class="p">)</span>
<a name="ln-3254"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3255"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3256"></a>                        <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3257"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3258"></a>        <span class="n">ENDIF</span>
<a name="ln-3259"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCMPtr</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-3260"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">OtherSideCondModeledExt</span>
<a name="ln-3261"></a>
<a name="ln-3262"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundSlabPreprocessorAverage&#39;</span><span class="p">)</span>          <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3263"></a>               <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundSlabPreprocessorCore&#39;</span><span class="p">)</span>             <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3264"></a>               <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundSlabPreprocessorPerimeter&#39;</span><span class="p">)</span>        <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3265"></a>               <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundBasementPreprocessorAverageFloor&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3266"></a>               <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundBasementPreprocessorAverageWall&#39;</span><span class="p">)</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3267"></a>               <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundBasementPreprocessorUpperWall&#39;</span><span class="p">)</span>    <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3268"></a>               <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;GroundBasementPreprocessorLowerWall&#39;</span><span class="p">)</span> <span class="p">)</span>  <span class="k">Then</span>
<a name="ln-3269"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3270"></a>                      <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3271"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The ExpandObjects program has not been run or is not in your EnergyPlus.exe folder.&#39;</span><span class="p">)</span>
<a name="ln-3272"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3273"></a>
<a name="ln-3274"></a>      <span class="k">Else</span>
<a name="ln-3275"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3276"></a>                      <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3277"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Should be one of &quot;Outdoors&quot;, &quot;Adiabatic&quot;, Ground&quot;, &quot;Surface&quot;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3278"></a>                               <span class="s1">&#39; &quot;OtherSideCoefficients&quot;, &quot;OtherSideConditionsModel&quot; or &quot;Zone&quot;&#39;</span><span class="p">)</span>
<a name="ln-3279"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3280"></a>      <span class="k">End If</span>  <span class="c">! ... End of the ExtBoundCond logical IF Block</span>
<a name="ln-3281"></a>
<a name="ln-3282"></a>
<a name="ln-3283"></a>      <span class="n">ArgPointer</span><span class="o">=</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-3284"></a>      <span class="c">!Set the logical flag for the exterior solar</span>
<a name="ln-3285"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;SunExposed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3286"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3287"></a>
<a name="ln-3288"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3289"></a>            <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3290"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3291"></a>                         <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3292"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..This surface is not exposed to External Environment.  Sun exposure has no effect.&#39;</span><span class="p">)</span>
<a name="ln-3293"></a>        <span class="n">ENDIF</span>
<a name="ln-3294"></a>
<a name="ln-3295"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;NoSun&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3296"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3297"></a>      <span class="k">ELSE</span>
<a name="ln-3298"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3299"></a>                      <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3300"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3301"></a>      <span class="k">END IF</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a><span class="k">      </span><span class="n">ArgPointer</span><span class="o">=</span><span class="n">ArgPointer</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3304"></a>      <span class="c">!Set the logical flag for the exterior wind</span>
<a name="ln-3305"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;WindExposed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3306"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3307"></a>      <span class="n">ElseIf</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">),</span><span class="s1">&#39;NoWind&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3308"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3309"></a>      <span class="k">Else</span>
<a name="ln-3310"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3311"></a>                      <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">ArgPointer</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3312"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3313"></a>      <span class="k">End If</span>
<a name="ln-3314"></a>
<a name="ln-3315"></a>      <span class="c">!Set the logical flag for the EcoRoof presented, this is only based on the flag in the construction type</span>
<a name="ln-3316"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3317"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtEcoRoof</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsEcoRoof</span>
<a name="ln-3318"></a>
<a name="ln-3319"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3320"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="n">AutoCalculate</span>
<a name="ln-3321"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3322"></a><span class="k">        </span><span class="n">numSides</span><span class="o">=</span><span class="p">(</span><span class="n">SurfaceNumProp</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-3323"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">numSides</span>
<a name="ln-3324"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">SurfaceNumProp</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3325"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3326"></a>                          <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-3327"></a>                          <span class="s1">&#39; not even multiple of 3. Will read in &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-3328"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-3329"></a>        <span class="n">ENDIF</span>
<a name="ln-3330"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">numSides</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3331"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3332"></a>                         <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (autocalculate) must be &gt;= 3. Only &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3333"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; provided.&#39;</span><span class="p">)</span>
<a name="ln-3334"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3335"></a>          <span class="k">CYCLE</span>
<a name="ln-3336"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3337"></a>      <span class="k">ELSE</span>
<a name="ln-3338"></a><span class="k">        </span><span class="n">numSides</span><span class="o">=</span><span class="p">(</span><span class="n">SurfaceNumProp</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-3339"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3340"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">numSides</span> <span class="o">&gt;</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3341"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3342"></a>                          <span class="s1">&#39;&quot;, field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-3343"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...but &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">numSides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; were entered. Only the indicated &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3344"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; will be used.&#39;</span><span class="p">)</span>
<a name="ln-3345"></a>        <span class="n">ENDIF</span>
<a name="ln-3346"></a>      <span class="n">ENDIF</span>
<a name="ln-3347"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-3348"></a>      <span class="k">CALL </span><span class="n">GetVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">:))</span>
<a name="ln-3349"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3350"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3351"></a>              <span class="s1">&#39;&quot;, Surface Area &lt;= 0.0; Entered Area=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3352"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3353"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3354"></a>      <span class="n">ENDIF</span>
<a name="ln-3355"></a>
<a name="ln-3356"></a>      <span class="k">CALL </span><span class="n">CheckConvexity</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-3357"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3358"></a>        <span class="c">!Check wall height for the CFactor walls</span>
<a name="ln-3359"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3360"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsCfactorWall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3361"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">-</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.05d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3362"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3363"></a>                       <span class="s1">&#39;&quot;, underground Wall Height = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3364"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..which does not match its construction height.&#39;</span><span class="p">)</span>
<a name="ln-3365"></a>          <span class="n">ENDIF</span>
<a name="ln-3366"></a>        <span class="n">ENDIF</span>
<a name="ln-3367"></a>
<a name="ln-3368"></a>        <span class="c">!Check area and perimeter for the FFactor floors</span>
<a name="ln-3369"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3370"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsFfactorFloor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3371"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3372"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3373"></a>                       <span class="s1">&#39;&quot;, underground Floor Area = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3374"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..which does not match its construction area.&#39;</span><span class="p">)</span>
<a name="ln-3375"></a>          <span class="n">ENDIF</span>
<a name="ln-3376"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span> <span class="o">&lt;</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">PerimeterExposed</span> <span class="o">-</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3377"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3378"></a>                       <span class="s1">&#39;&quot;, underground Floor Perimeter = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3379"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..which is less than its construction exposed perimeter.&#39;</span><span class="p">)</span>
<a name="ln-3380"></a>          <span class="n">ENDIF</span>
<a name="ln-3381"></a>        <span class="n">ENDIF</span>
<a name="ln-3382"></a>      <span class="n">ENDIF</span>
<a name="ln-3383"></a>
<a name="ln-3384"></a>    <span class="n">ENDDO</span>
<a name="ln-3385"></a>  <span class="n">ENDDO</span>  <span class="c">! Item Looop</span>
<a name="ln-3386"></a>  <span class="k">RETURN</span>
<a name="ln-3387"></a>
<a name="ln-3388"></a><span class="k">END SUBROUTINE </span><span class="n">GetHTSurfaceData</span>
<a name="ln-3389"></a>
<a name="ln-3390"></a><span class="k">SUBROUTINE </span><span class="n">GetRectSurfaces</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotRectExtWalls</span><span class="p">,</span><span class="n">TotRectIntWalls</span><span class="p">,</span><span class="n">TotRectIZWalls</span><span class="p">,</span><span class="n">TotRectUGWalls</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3391"></a>      <span class="n">TotRectRoofs</span><span class="p">,</span><span class="n">TotRectCeilings</span><span class="p">,</span><span class="n">TotRectIZCeilings</span><span class="p">,</span><span class="n">TotRectGCFloors</span><span class="p">,</span><span class="n">TotRectIntFloors</span><span class="p">,</span><span class="n">TotRectIZFloors</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3392"></a>      <span class="n">BaseSurfIDs</span><span class="p">,</span><span class="n">NeedToAddSurfaces</span><span class="p">)</span>
<a name="ln-3393"></a>
<a name="ln-3394"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3395"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-3396"></a>          <span class="c">!       DATE WRITTEN   December 2008</span>
<a name="ln-3397"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3398"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3399"></a>
<a name="ln-3400"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3401"></a>          <span class="c">! Get simple (rectangular, LLC corner specified) walls</span>
<a name="ln-3402"></a>
<a name="ln-3403"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3404"></a>          <span class="c">! na</span>
<a name="ln-3405"></a>
<a name="ln-3406"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3407"></a>          <span class="c">! na</span>
<a name="ln-3408"></a>
<a name="ln-3409"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3410"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-3411"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-3412"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-3413"></a>
<a name="ln-3414"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3415"></a>
<a name="ln-3416"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3417"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-3418"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-3419"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectExtWalls</span>   <span class="c">! Number of Exterior Walls to obtain</span>
<a name="ln-3420"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectIntWalls</span>   <span class="c">! Number of Adiabatic Walls to obtain</span>
<a name="ln-3421"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectIZWalls</span>    <span class="c">! Number of Interzone Walls to obtain</span>
<a name="ln-3422"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectUGWalls</span>    <span class="c">! Number of Underground to obtain</span>
<a name="ln-3423"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectRoofs</span>      <span class="c">! Number of Roofs to obtain</span>
<a name="ln-3424"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectCeilings</span>   <span class="c">! Number of Adiabatic Ceilings to obtain</span>
<a name="ln-3425"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectIZCeilings</span> <span class="c">! Number of Interzone Ceilings to obtain</span>
<a name="ln-3426"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectGCFloors</span>   <span class="c">! Number of Floors with Ground Contact to obtain</span>
<a name="ln-3427"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectIntFloors</span>  <span class="c">! Number of Adiabatic Walls to obtain</span>
<a name="ln-3428"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotRectIZFloors</span>   <span class="c">! Number of Interzone Floors to obtain</span>
<a name="ln-3429"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSurfIDs</span>    <span class="c">! ID Assignments for valid surface classes</span>
<a name="ln-3430"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NeedToAddSurfaces</span> <span class="c">! Number of surfaces to add, based on unentered IZ surfaces</span>
<a name="ln-3431"></a>
<a name="ln-3432"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3433"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cModuleObjects</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-3434"></a>    <span class="p">(</span><span class="o">/</span><span class="s1">&#39;Wall:Exterior      &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3435"></a>      <span class="s1">&#39;Wall:Adiabatic     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3436"></a>      <span class="s1">&#39;Wall:Interzone     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3437"></a>      <span class="s1">&#39;Wall:Underground   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3438"></a>      <span class="s1">&#39;Roof               &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3439"></a>      <span class="s1">&#39;Ceiling:Adiabatic  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3440"></a>      <span class="s1">&#39;Ceiling:Interzone  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3441"></a>      <span class="s1">&#39;Floor:GroundContact&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3442"></a>      <span class="s1">&#39;Floor:Adiabatic    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3443"></a>      <span class="s1">&#39;Floor:Interzone    &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-3444"></a>
<a name="ln-3445"></a>
<a name="ln-3446"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3447"></a>          <span class="c">! na</span>
<a name="ln-3448"></a>
<a name="ln-3449"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3450"></a>          <span class="c">! na</span>
<a name="ln-3451"></a>
<a name="ln-3452"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3453"></a>          <span class="c">! na</span>
<a name="ln-3454"></a>
<a name="ln-3455"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-3456"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ItemsToGet</span>
<a name="ln-3457"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-3458"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-3459"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>
<a name="ln-3460"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-3461"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>             <span class="c">! For matching base surfaces</span>
<a name="ln-3462"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-3463"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-3464"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">GettingIZSurfaces</span>
<a name="ln-3465"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OtherSurfaceField</span>
<a name="ln-3466"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ExtBoundCondition</span>
<a name="ln-3467"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ClassItem</span>
<a name="ln-3468"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-3469"></a>
<a name="ln-3470"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span>
<a name="ln-3471"></a>
<a name="ln-3472"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="n">cModuleObjects</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span>
<a name="ln-3473"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3474"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectExtWalls</span>
<a name="ln-3475"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3476"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3477"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">ExternalEnvironment</span>
<a name="ln-3478"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-3479"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3480"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectIntWalls</span>
<a name="ln-3481"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3482"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3483"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-3484"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-3485"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3486"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectIZWalls</span>
<a name="ln-3487"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3488"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-3489"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-3490"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-3491"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3492"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectUGWalls</span>
<a name="ln-3493"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3494"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3495"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">Ground</span>
<a name="ln-3496"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-3497"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3498"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectRoofs</span>
<a name="ln-3499"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3500"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3501"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">ExternalEnvironment</span>
<a name="ln-3502"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-3503"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3504"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectCeilings</span>
<a name="ln-3505"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3506"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3507"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-3508"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-3509"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3510"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectIZCeilings</span>
<a name="ln-3511"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3512"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-3513"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-3514"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-3515"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3516"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectGCFloors</span>
<a name="ln-3517"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3518"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3519"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">Ground</span>
<a name="ln-3520"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-3521"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3522"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectIntFloors</span>
<a name="ln-3523"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3524"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3525"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-3526"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-3527"></a>    <span class="k">ELSE</span>  <span class="c">!IF (Item == 10) THEN</span>
<a name="ln-3528"></a>      <span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotRectIZFloors</span>
<a name="ln-3529"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3530"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-3531"></a>      <span class="n">ExtBoundCondition</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-3532"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-3533"></a>    <span class="n">ENDIF</span>
<a name="ln-3534"></a>
<a name="ln-3535"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ItemsToGet</span>
<a name="ln-3536"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3537"></a>                     <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3538"></a>                     <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3539"></a>      <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3540"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3541"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3542"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3543"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-3544"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3545"></a>        <span class="k">CYCLE</span>
<a name="ln-3546"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-3547"></a>
<a name="ln-3548"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumNumbers</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3549"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3550"></a>                        <span class="s1">&#39;&quot;, Too few number of numeric args=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumNumbers</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-3551"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3552"></a>      <span class="n">ENDIF</span>
<a name="ln-3553"></a>
<a name="ln-3554"></a>      <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3555"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-3556"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">=</span> <span class="n">BaseSurfIDs</span><span class="p">(</span><span class="n">ClassItem</span><span class="p">)</span> <span class="c">! Set class number</span>
<a name="ln-3557"></a>
<a name="ln-3558"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-3559"></a>
<a name="ln-3560"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3561"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3562"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3563"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3564"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3565"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3566"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3567"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3568"></a>                               <span class="s1">&#39;&quot; - has Window materials.&#39;</span><span class="p">)</span>
<a name="ln-3569"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3570"></a>      <span class="k">ELSE</span>
<a name="ln-3571"></a><span class="k">        </span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3572"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-3573"></a>      <span class="k">END IF</span>
<a name="ln-3574"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3575"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-3576"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-3577"></a>
<a name="ln-3578"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3579"></a>      <span class="n">ZoneNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">,</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3580"></a>
<a name="ln-3581"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3582"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">=</span> <span class="n">ZoneNum</span>
<a name="ln-3583"></a>      <span class="k">ELSE</span>
<a name="ln-3584"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3585"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3586"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">+</span><span class="mi">100</span>
<a name="ln-3587"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="s1">&#39;Unknown Zone&#39;</span>
<a name="ln-3588"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3589"></a>      <span class="n">ENDIF</span>
<a name="ln-3590"></a>
<a name="ln-3591"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExtBoundCondition</span>
<a name="ln-3592"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3593"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3594"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsCfactorWall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3595"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3596"></a><span class="k">              </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">GroundFCfactorMethod</span>
<a name="ln-3597"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsCfactorWall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3598"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3599"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3600"></a>            <span class="s1">&#39;&quot;, Construction type is &quot;Construction:CfactorUndergroundWall&quot; but invalid for this object.&#39;</span><span class="p">)</span>
<a name="ln-3601"></a>        <span class="n">ENDIF</span>
<a name="ln-3602"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3603"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsFfactorFloor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3604"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3605"></a><span class="k">              </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">GroundFCfactorMethod</span>
<a name="ln-3606"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsFfactorFloor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3607"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3608"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3609"></a>            <span class="s1">&#39;&quot;, Construction type is &quot;Construction:FfactorGroundFloor&quot; but invalid for this object.&#39;</span><span class="p">)</span>
<a name="ln-3610"></a>        <span class="n">ENDIF</span>
<a name="ln-3611"></a>      <span class="n">ENDIF</span>
<a name="ln-3612"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3613"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3614"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="n">AutoCalculate</span>
<a name="ln-3615"></a>
<a name="ln-3616"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3617"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3618"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3619"></a>
<a name="ln-3620"></a>        <span class="c">!Set the logical flag for the EcoRoof presented, this is only based on the flag in the construction type</span>
<a name="ln-3621"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3622"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtEcoRoof</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsEcoRoof</span>
<a name="ln-3623"></a>
<a name="ln-3624"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3625"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">GettingIZSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3626"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">OtherSurfaceField</span><span class="p">)</span>
<a name="ln-3627"></a>          <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3628"></a>          <span class="c">! see if match to zone, then it&#39;s an unentered other surface, else reconciled later</span>
<a name="ln-3629"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3630"></a><span class="k">            </span><span class="n">NeedToAddSurfaces</span><span class="o">=</span><span class="n">NeedToAddSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3631"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">UnenteredAdjacentZoneSurface</span>
<a name="ln-3632"></a>          <span class="n">ENDIF</span>
<a name="ln-3633"></a>        <span class="k">ELSE</span>
<a name="ln-3634"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-3635"></a>        <span class="n">ENDIF</span>
<a name="ln-3636"></a>
<a name="ln-3637"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3638"></a>
<a name="ln-3639"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NoGroundTempObjWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3640"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GroundTempObjInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3641"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetRectSurfaces: Surfaces with interface to Ground found &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3642"></a>                 <span class="s1">&#39;but no &quot;Ground Temperatures&quot; were input.&#39;</span><span class="p">)</span>
<a name="ln-3643"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Found first in surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3644"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Defaults, constant throughout the year of (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GroundTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3645"></a>                               <span class="s1">&#39;) will be used.&#39;</span><span class="p">)</span>
<a name="ln-3646"></a>          <span class="n">ENDIF</span>
<a name="ln-3647"></a>          <span class="n">NoGroundTempObjWarning</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3648"></a>        <span class="n">ENDIF</span>
<a name="ln-3649"></a>
<a name="ln-3650"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">GroundFCfactorMethod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3651"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NoFCGroundTempObjWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3652"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">FCGroundTemps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3653"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetRectSurfaces: Surfaces with interface to GroundFCfactorMethod found &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3654"></a>                <span class="s1">&#39;but no &quot;FC Ground Temperatures&quot; were input.&#39;</span><span class="p">)</span>
<a name="ln-3655"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Found first in surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3656"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Either add a &quot;Site:GroundTemperature:FCfactorMethod&quot; object or &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3657"></a>                <span class="s1">&#39; use a weather file with Ground Temperatures.&#39;</span><span class="p">)</span>
<a name="ln-3658"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3659"></a>            <span class="n">NoFCGroundTempObjWarning</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3660"></a>          <span class="n">ENDIF</span>
<a name="ln-3661"></a>        <span class="k">End IF</span>
<a name="ln-3662"></a>
<a name="ln-3663"></a><span class="k">      End If</span>  <span class="c">! ... End of the ExtBoundCond logical IF Block</span>
<a name="ln-3664"></a>
<a name="ln-3665"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3666"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3667"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3668"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ZoneNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3669"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">+</span><span class="n">BuildingAzimuth</span><span class="o">+</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span>
<a name="ln-3670"></a>        <span class="n">ENDIF</span>
<a name="ln-3671"></a>      <span class="n">ENDIF</span>
<a name="ln-3672"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3673"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">+</span><span class="n">BuildingRotationAppendixG</span>
<a name="ln-3674"></a>      <span class="n">ENDIF</span>
<a name="ln-3675"></a>
<a name="ln-3676"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-3677"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-3678"></a>
<a name="ln-3679"></a>      <span class="k">CALL </span><span class="n">MakeRectangularVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3680"></a>                                   <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">RectSurfRefWorldCoordSystem</span><span class="p">)</span>
<a name="ln-3681"></a>
<a name="ln-3682"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3683"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3684"></a>              <span class="s1">&#39;&quot;, Surface Area &lt;= 0.0; Entered Area=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3685"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3686"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3687"></a>      <span class="n">ENDIF</span>
<a name="ln-3688"></a>
<a name="ln-3689"></a>      <span class="c">!Check wall height for the CFactor walls</span>
<a name="ln-3690"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">GroundFCfactorMethod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3691"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">-</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.05d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3692"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3693"></a>                     <span class="s1">&#39;&quot;, underground Wall Height = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3694"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..which deos not match its construction height.&#39;</span><span class="p">)</span>
<a name="ln-3695"></a>        <span class="n">ENDIF</span>
<a name="ln-3696"></a>      <span class="n">ENDIF</span>
<a name="ln-3697"></a>
<a name="ln-3698"></a>      <span class="c">!Check area and perimeter for the FFactor floors</span>
<a name="ln-3699"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">GroundFCfactorMethod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3700"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3701"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3702"></a>                     <span class="s1">&#39;&quot;, underground Floor Area = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3703"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..which does not match its construction area.&#39;</span><span class="p">)</span>
<a name="ln-3704"></a>        <span class="n">ENDIF</span>
<a name="ln-3705"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span> <span class="o">&lt;</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">PerimeterExposed</span> <span class="o">-</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3706"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3707"></a>                     <span class="s1">&#39;&quot;, underground Floor Perimeter = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3708"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..which is less than its construction exposed perimeter.&#39;</span><span class="p">)</span>
<a name="ln-3709"></a>        <span class="n">ENDIF</span>
<a name="ln-3710"></a>      <span class="n">ENDIF</span>
<a name="ln-3711"></a>    <span class="n">ENDDO</span>  <span class="c">! Getting Items</span>
<a name="ln-3712"></a>
<a name="ln-3713"></a>  <span class="n">ENDDO</span>
<a name="ln-3714"></a>
<a name="ln-3715"></a>  <span class="k">RETURN</span>
<a name="ln-3716"></a>
<a name="ln-3717"></a><span class="k">END SUBROUTINE </span><span class="n">GetRectSurfaces</span>
<a name="ln-3718"></a>
<a name="ln-3719"></a><span class="k">SUBROUTINE </span><span class="n">MakeRectangularVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">XCoord</span><span class="p">,</span><span class="n">YCoord</span><span class="p">,</span><span class="n">ZCoord</span><span class="p">,</span><span class="n">Length</span><span class="p">,</span><span class="n">Height</span><span class="p">,</span><span class="n">SurfWorldCoordSystem</span><span class="p">)</span>
<a name="ln-3720"></a>
<a name="ln-3721"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3722"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-3723"></a>          <span class="c">!       DATE WRITTEN   December 2008</span>
<a name="ln-3724"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3725"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3726"></a>
<a name="ln-3727"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3728"></a>          <span class="c">! This routine creates world/3d coordinates for rectangular surfaces using azimuth, tilt, LLC (X,Y,Z), length &amp; height.</span>
<a name="ln-3729"></a>
<a name="ln-3730"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3731"></a>          <span class="c">! na</span>
<a name="ln-3732"></a>
<a name="ln-3733"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3734"></a>          <span class="c">! na</span>
<a name="ln-3735"></a>
<a name="ln-3736"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3737"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-3738"></a>
<a name="ln-3739"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3740"></a>
<a name="ln-3741"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3742"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-3743"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XCoord</span>
<a name="ln-3744"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YCoord</span>
<a name="ln-3745"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZCoord</span>
<a name="ln-3746"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Length</span>
<a name="ln-3747"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span>
<a name="ln-3748"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfWorldCoordSystem</span>
<a name="ln-3749"></a>
<a name="ln-3750"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3751"></a>          <span class="c">! na</span>
<a name="ln-3752"></a>
<a name="ln-3753"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3754"></a>          <span class="c">! na</span>
<a name="ln-3755"></a>
<a name="ln-3756"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3757"></a>          <span class="c">! na</span>
<a name="ln-3758"></a>
<a name="ln-3759"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3760"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAzimuth</span>  <span class="c">! Surface Azimuth/Facing (same as Base Surface)</span>
<a name="ln-3761"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTilt</span>     <span class="c">! Tilt (same as Base Surface)</span>
<a name="ln-3762"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XLLC</span>
<a name="ln-3763"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YLLC</span>
<a name="ln-3764"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZLLC</span>
<a name="ln-3765"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosSurfAzimuth</span>
<a name="ln-3766"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinSurfAzimuth</span>
<a name="ln-3767"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosSurfTilt</span>
<a name="ln-3768"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinSurfTilt</span>
<a name="ln-3769"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XX</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">YY</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3770"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span>
<a name="ln-3771"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Perimeter</span>
<a name="ln-3772"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-3773"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Vrt</span>
<a name="ln-3774"></a>
<a name="ln-3775"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3776"></a>     <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Detached_F</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3777"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-3778"></a>
<a name="ln-3779"></a><span class="k">  </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">Height</span>
<a name="ln-3780"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">Length</span>
<a name="ln-3781"></a>
<a name="ln-3782"></a>  <span class="n">SurfAzimuth</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-3783"></a>  <span class="n">SurfTilt</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-3784"></a>  <span class="n">CosSurfAzimuth</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfAzimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-3785"></a>  <span class="n">SinSurfAzimuth</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfAzimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-3786"></a>  <span class="n">CosSurfTilt</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-3787"></a>  <span class="n">SinSurfTilt</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-3788"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfWorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3789"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3790"></a><span class="k">      </span><span class="n">Xb</span>    <span class="o">=</span> <span class="n">XCoord</span><span class="o">*</span><span class="n">CosZoneRelNorth</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3791"></a>             <span class="o">-</span><span class="n">YCoord</span><span class="o">*</span><span class="n">SinZoneRelNorth</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OriginX</span>
<a name="ln-3792"></a>      <span class="n">Yb</span>    <span class="o">=</span> <span class="n">XCoord</span><span class="o">*</span><span class="n">SinZoneRelNorth</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3793"></a>             <span class="o">+</span><span class="n">YCoord</span><span class="o">*</span><span class="n">CosZoneRelNorth</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OriginY</span>
<a name="ln-3794"></a>      <span class="n">XLLC</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span>
<a name="ln-3795"></a>      <span class="n">YLLC</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span>
<a name="ln-3796"></a>      <span class="n">ZLLC</span>  <span class="o">=</span> <span class="n">ZCoord</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OriginZ</span>
<a name="ln-3797"></a>    <span class="k">ELSE</span>
<a name="ln-3798"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3799"></a><span class="k">        </span><span class="n">Xb</span>    <span class="o">=</span> <span class="n">XCoord</span>
<a name="ln-3800"></a>        <span class="n">Yb</span>    <span class="o">=</span> <span class="n">YCoord</span>
<a name="ln-3801"></a>        <span class="n">XLLC</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span>
<a name="ln-3802"></a>        <span class="n">YLLC</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span>
<a name="ln-3803"></a>        <span class="n">ZLLC</span>  <span class="o">=</span> <span class="n">ZCoord</span>
<a name="ln-3804"></a>      <span class="k">ELSE</span>
<a name="ln-3805"></a><span class="k">        </span><span class="n">XLLC</span>  <span class="o">=</span> <span class="n">XCoord</span>
<a name="ln-3806"></a>        <span class="n">YLLC</span>  <span class="o">=</span> <span class="n">YCoord</span>
<a name="ln-3807"></a>        <span class="n">ZLLC</span>  <span class="o">=</span> <span class="n">ZCoord</span>
<a name="ln-3808"></a>      <span class="n">ENDIF</span>
<a name="ln-3809"></a>    <span class="n">ENDIF</span>
<a name="ln-3810"></a>  <span class="k">ELSE</span>
<a name="ln-3811"></a>    <span class="c">! for world coordinates, only rotate for appendix G</span>
<a name="ln-3812"></a>    <span class="n">Xb</span>  <span class="o">=</span> <span class="n">XCoord</span>
<a name="ln-3813"></a>    <span class="n">Yb</span>  <span class="o">=</span> <span class="n">YCoord</span>
<a name="ln-3814"></a>    <span class="n">ZLLC</span>  <span class="o">=</span> <span class="n">ZCoord</span>
<a name="ln-3815"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3816"></a><span class="k">      </span><span class="n">XLLC</span><span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span>
<a name="ln-3817"></a>      <span class="n">YLLC</span><span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span>
<a name="ln-3818"></a>    <span class="k">ELSE</span>
<a name="ln-3819"></a><span class="k">      </span><span class="n">XLLC</span> <span class="o">=</span> <span class="n">Xb</span>
<a name="ln-3820"></a>      <span class="n">YLLC</span> <span class="o">=</span> <span class="n">Yb</span>
<a name="ln-3821"></a>    <span class="n">ENDIF</span>
<a name="ln-3822"></a>  <span class="n">ENDIF</span>
<a name="ln-3823"></a>
<a name="ln-3824"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3825"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3826"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">Length</span>
<a name="ln-3827"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">Length</span>
<a name="ln-3828"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Height</span>
<a name="ln-3829"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">Height</span>
<a name="ln-3830"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3831"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3832"></a>
<a name="ln-3833"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-3834"></a>    <span class="n">Vrt</span><span class="o">=</span><span class="n">N</span>
<a name="ln-3835"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">X</span><span class="o">=</span><span class="n">XLLC</span><span class="o">-</span><span class="n">XX</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">CosSurfAzimuth</span><span class="o">-</span><span class="n">YY</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">CosSurfTilt</span><span class="o">*</span><span class="n">SinSurfAzimuth</span>
<a name="ln-3836"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">Y</span><span class="o">=</span><span class="n">YLLC</span><span class="o">+</span><span class="n">XX</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">SinSurfAzimuth</span><span class="o">-</span><span class="n">YY</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">CosSurfTilt</span><span class="o">*</span><span class="n">CosSurfAzimuth</span>
<a name="ln-3837"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">Z</span><span class="o">=</span><span class="n">ZLLC</span><span class="o">+</span><span class="n">YY</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">SinSurfTilt</span>
<a name="ln-3838"></a>  <span class="k">END DO</span>
<a name="ln-3839"></a>
<a name="ln-3840"></a><span class="k">  CALL </span><span class="n">CreateNewellAreaVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-3841"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-3842"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-3843"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-3844"></a>  <span class="k">CALL </span><span class="n">CreateNewellSurfaceNormalVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3845"></a>     <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-3846"></a>  <span class="k">CALL </span><span class="n">DetermineAzimuthAndTilt</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfAzimuth</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3847"></a>                               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3848"></a>                               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-3849"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfAzimuth</span>
<a name="ln-3850"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">SurfTilt</span>
<a name="ln-3851"></a>  <span class="c">! Sine and cosine of azimuth and tilt</span>
<a name="ln-3852"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span> <span class="o">=</span> <span class="n">SinSurfAzimuth</span>
<a name="ln-3853"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">=</span> <span class="n">CosSurfAzimuth</span>
<a name="ln-3854"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span> <span class="o">=</span> <span class="n">SinSurfTilt</span>
<a name="ln-3855"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">=</span> <span class="n">CosSurfTilt</span>
<a name="ln-3856"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-3857"></a>  <span class="c">! Outward normal unit vector (pointing away from room)</span>
<a name="ln-3858"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span>
<a name="ln-3859"></a>  <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-3860"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-3861"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-3862"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>     <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-3863"></a>  <span class="n">ENDDO</span>
<a name="ln-3864"></a>
<a name="ln-3865"></a><span class="c">!  IF (SurfaceTmp(SurfNum)%Class == SurfaceClass_Roof .and. SurfTilt &gt; 80.) THEN</span>
<a name="ln-3866"></a><span class="c">!    WRITE(TiltString,&#39;(F5.1)&#39;) SurfTilt</span>
<a name="ln-3867"></a><span class="c">!    TiltString=ADJUSTL(TiltString)</span>
<a name="ln-3868"></a><span class="c">!    CALL ShowWarningError(&#39;Roof/Ceiling Tilt=&#39;//TRIM(TiltString)//&#39;, much greater than expected tilt of 0,&#39;// &amp;</span>
<a name="ln-3869"></a><span class="c">!                          &#39; for Surface=&#39;//TRIM(SurfaceTmp(SurfNum)%Name)//  &amp;</span>
<a name="ln-3870"></a><span class="c">!                          &#39;, in Zone=&#39;//TRIM(SurfaceTmp(SurfNum)%ZoneName))</span>
<a name="ln-3871"></a><span class="c">!  ENDIF</span>
<a name="ln-3872"></a><span class="c">!  IF (SurfaceTmp(SurfNum)%Class == SurfaceClass_Floor .and. SurfTilt &lt; 170.) THEN</span>
<a name="ln-3873"></a><span class="c">!    WRITE(TiltString,&#39;(F5.1)&#39;) SurfTilt</span>
<a name="ln-3874"></a><span class="c">!    TiltString=ADJUSTL(TiltString)</span>
<a name="ln-3875"></a><span class="c">!    CALL ShowWarningError(&#39;Floor Tilt=&#39;//TRIM(TiltString)//&#39;, much less than expected tilt of 180,&#39;//   &amp;</span>
<a name="ln-3876"></a><span class="c">!                          &#39; for Surface=&#39;//TRIM(SurfaceTmp(SurfNum)%Name)//  &amp;</span>
<a name="ln-3877"></a><span class="c">!                          &#39;, in Zone=&#39;//TRIM(SurfaceTmp(SurfNum)%ZoneName))</span>
<a name="ln-3878"></a><span class="c">!  ENDIF</span>
<a name="ln-3879"></a>
<a name="ln-3880"></a>  <span class="c">! Can perform tests on this surface here</span>
<a name="ln-3881"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="o">=</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-3882"></a>  <span class="c">! The following IR view factors are modified in subr. SkyDifSolarShading if there are shadowing</span>
<a name="ln-3883"></a>  <span class="c">! surfaces</span>
<a name="ln-3884"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-3885"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-3886"></a>
<a name="ln-3887"></a>  <span class="n">Perimeter</span><span class="o">=</span><span class="n">Distance</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3888"></a>  <span class="k">DO </span><span class="n">Vrt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-3889"></a>    <span class="n">Perimeter</span> <span class="o">=</span> <span class="n">Perimeter</span><span class="o">+</span><span class="n">Distance</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3890"></a>  <span class="n">ENDDO</span>
<a name="ln-3891"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span><span class="o">=</span><span class="n">Perimeter</span>
<a name="ln-3892"></a>
<a name="ln-3893"></a>  <span class="c">! Call to transform vertices</span>
<a name="ln-3894"></a>
<a name="ln-3895"></a>  <span class="k">Call </span><span class="n">TransformVertsByAspect</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-3896"></a>
<a name="ln-3897"></a>  <span class="k">RETURN</span>
<a name="ln-3898"></a>
<a name="ln-3899"></a><span class="k">END SUBROUTINE </span><span class="n">MakeRectangularVertices</span>
<a name="ln-3900"></a>
<a name="ln-3901"></a><span class="k">SUBROUTINE </span><span class="n">GetHTSubSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotHTSubs</span><span class="p">,</span><span class="n">SubSurfCls</span><span class="p">,</span><span class="n">SubSurfIDs</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">,</span><span class="n">NeedToAddSurfaces</span><span class="p">)</span>
<a name="ln-3902"></a>
<a name="ln-3903"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3904"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-3905"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-3906"></a>          <span class="c">!       MODIFIED       August 2012 - line up subsurfaces with base surface types</span>
<a name="ln-3907"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3908"></a>
<a name="ln-3909"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3910"></a>          <span class="c">! This subroutine gets the HeatTransfer Sub Surface Data,</span>
<a name="ln-3911"></a>          <span class="c">! checks it for errors, etc.</span>
<a name="ln-3912"></a>
<a name="ln-3913"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3914"></a>          <span class="c">! na</span>
<a name="ln-3915"></a>
<a name="ln-3916"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3917"></a>  <span class="c">! Heat Transfer Subsurface Definition</span>
<a name="ln-3918"></a>  <span class="c">! FenestrationSurface:Detailed,</span>
<a name="ln-3919"></a>  <span class="c">!        \min-fields 19</span>
<a name="ln-3920"></a>  <span class="c">!        \memo Used for windows, doors, glass doors, tubular daylighting devices</span>
<a name="ln-3921"></a>  <span class="c">!        \format vertices</span>
<a name="ln-3922"></a>  <span class="c">!   A1 , \field Name</span>
<a name="ln-3923"></a>  <span class="c">!        \required-field</span>
<a name="ln-3924"></a>  <span class="c">!        \type alpha</span>
<a name="ln-3925"></a>  <span class="c">!   A2 , \field Surface Type</span>
<a name="ln-3926"></a>  <span class="c">!        \required-field</span>
<a name="ln-3927"></a>  <span class="c">!        \type choice</span>
<a name="ln-3928"></a>  <span class="c">!        \key Window</span>
<a name="ln-3929"></a>  <span class="c">!        \key Door</span>
<a name="ln-3930"></a>  <span class="c">!        \key GlassDoor</span>
<a name="ln-3931"></a>  <span class="c">!        \key TubularDaylightDome</span>
<a name="ln-3932"></a>  <span class="c">!        \key TubularDaylightDiffuser</span>
<a name="ln-3933"></a>  <span class="c">!   A3 , \field Construction Name</span>
<a name="ln-3934"></a>  <span class="c">!        \required-field</span>
<a name="ln-3935"></a>  <span class="c">!        \note To be matched with a construction in this input file</span>
<a name="ln-3936"></a>  <span class="c">!        \type object-list</span>
<a name="ln-3937"></a>  <span class="c">!        \object-list ConstructionNames</span>
<a name="ln-3938"></a>  <span class="c">!   A4 , \field Building Surface Name</span>
<a name="ln-3939"></a>  <span class="c">!        \required-field</span>
<a name="ln-3940"></a>  <span class="c">!        \type object-list</span>
<a name="ln-3941"></a>  <span class="c">!        \object-list SurfaceNames</span>
<a name="ln-3942"></a>  <span class="c">!   A5,  \field Outside Boundary Condition Object</span>
<a name="ln-3943"></a>  <span class="c">!        \type object-list</span>
<a name="ln-3944"></a>  <span class="c">!        \object-list OutFaceEnvNames</span>
<a name="ln-3945"></a>  <span class="c">!        \note Non-blank only if base surface field Outside Boundary Condition is</span>
<a name="ln-3946"></a>  <span class="c">!        \note Surface or OtherSideCoefficients</span>
<a name="ln-3947"></a>  <span class="c">!        \note If Base Surface&#39;s Surface, specify name of corresponding subsurface in adjacent zone or</span>
<a name="ln-3948"></a>  <span class="c">!        \note specify current subsurface name for internal partition separating like zones</span>
<a name="ln-3949"></a>  <span class="c">!        \note If OtherSideCoefficients, specify name of SurfaceProperty:OtherSideCoefficients</span>
<a name="ln-3950"></a>  <span class="c">!        \note  or leave blank to inherit Base Surface&#39;s OtherSide Coefficients</span>
<a name="ln-3951"></a>  <span class="c">!   N1, \field View Factor to Ground</span>
<a name="ln-3952"></a>  <span class="c">!        \type real</span>
<a name="ln-3953"></a>  <span class="c">!        \note From the exterior of the surface</span>
<a name="ln-3954"></a>  <span class="c">!        \note Unused if one uses the &quot;reflections&quot; options in Solar Distribution in Building input</span>
<a name="ln-3955"></a>  <span class="c">!        \note unless a DaylightingDevice:Shelf or DaylightingDevice:Tubular object has been specified.</span>
<a name="ln-3956"></a>  <span class="c">!        \note autocalculate will automatically calculate this value from the tilt of the surface</span>
<a name="ln-3957"></a>  <span class="c">!        \autocalculatable</span>
<a name="ln-3958"></a>  <span class="c">!        \minimum 0.0</span>
<a name="ln-3959"></a>  <span class="c">!        \maximum 1.0</span>
<a name="ln-3960"></a>  <span class="c">!        \default autocalculate</span>
<a name="ln-3961"></a>  <span class="c">!   A6, \field Shading Control Name</span>
<a name="ln-3962"></a>  <span class="c">!        \note enter the name of a WindowProperty:ShadingControl object</span>
<a name="ln-3963"></a>  <span class="c">!        \type object-list</span>
<a name="ln-3964"></a>  <span class="c">!        \object-list WindowShadeControlNames</span>
<a name="ln-3965"></a>  <span class="c">!        \note used for windows and glass doors only</span>
<a name="ln-3966"></a>  <span class="c">!        \note If not specified, window or glass door has no shading (blind, roller shade, etc.)</span>
<a name="ln-3967"></a>  <span class="c">!   A7, \field Frame and Divider Name</span>
<a name="ln-3968"></a>  <span class="c">!        \note Enter the name of a WindowProperty:FrameAndDivider object</span>
<a name="ln-3969"></a>  <span class="c">!        \type object-list</span>
<a name="ln-3970"></a>  <span class="c">!        \object-list WindowFrameAndDividerNames</span>
<a name="ln-3971"></a>  <span class="c">!        \note Used only for exterior windows (rectangular) and glass doors.</span>
<a name="ln-3972"></a>  <span class="c">!        \note Unused for triangular windows.</span>
<a name="ln-3973"></a>  <span class="c">!        \note If not specified (blank), window or glass door has no frame or divider</span>
<a name="ln-3974"></a>  <span class="c">!        \note and no beam solar reflection from reveal surfaces.</span>
<a name="ln-3975"></a>  <span class="c">!   N2 , \field Multiplier</span>
<a name="ln-3976"></a>  <span class="c">!        \note Used only for Surface Type = WINDOW, GLASSDOOR or DOOR</span>
<a name="ln-3977"></a>  <span class="c">!        \note Non-integer values will be truncated to integer</span>
<a name="ln-3978"></a>  <span class="c">!        \default 1.0</span>
<a name="ln-3979"></a>  <span class="c">!        \minimum 1.0</span>
<a name="ln-3980"></a>  <span class="c">!   N3 , \field Number of Vertices</span>
<a name="ln-3981"></a>  <span class="c">!        \minimum 3</span>
<a name="ln-3982"></a>  <span class="c">!        \maximum 4</span>
<a name="ln-3983"></a>  <span class="c">!        \autocalculatable</span>
<a name="ln-3984"></a>  <span class="c">!        \default autocalculate</span>
<a name="ln-3985"></a>  <span class="c">!        \note vertices are given in GlobalGeometryRules coordinates -- if relative, all surface coordinates</span>
<a name="ln-3986"></a>  <span class="c">!        \note are &quot;relative&quot; to the Zone Origin.  If world, then building and zone origins are used</span>
<a name="ln-3987"></a>  <span class="c">!        \note for some internal calculations, but all coordinates are given in an &quot;absolute&quot; system.</span>
<a name="ln-3988"></a>  <span class="c">!  N4-15 as indicated by the N3 value</span>
<a name="ln-3989"></a>
<a name="ln-3990"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3991"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-3992"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-3993"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-3994"></a>
<a name="ln-3995"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3996"></a>
<a name="ln-3997"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3998"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-3999"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-4000"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotHTSubs</span>         <span class="c">! Number of Heat Transfer SubSurfaces to obtain</span>
<a name="ln-4001"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SubSurfCls</span>   <span class="c">! Valid Classes for Sub Surfaces</span>
<a name="ln-4002"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SubSurfIDs</span>     <span class="c">! ID Assignments for valid sub surface classes</span>
<a name="ln-4003"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">AddedSubSurfaces</span>  <span class="c">! Subsurfaces added when windows reference Window5</span>
<a name="ln-4004"></a>                                                      <span class="c">!  data file entry with two glazing systems</span>
<a name="ln-4005"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NeedToAddSurfaces</span> <span class="c">! Number of surfaces to add, based on unentered IZ surfaces</span>
<a name="ln-4006"></a>
<a name="ln-4007"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4008"></a>          <span class="c">! na</span>
<a name="ln-4009"></a>
<a name="ln-4010"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4011"></a>          <span class="c">! na</span>
<a name="ln-4012"></a>
<a name="ln-4013"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4014"></a>          <span class="c">! na</span>
<a name="ln-4015"></a>
<a name="ln-4016"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4017"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-4018"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceNumAlpha</span>   <span class="c">! Number of material alpha names being passed</span>
<a name="ln-4019"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceNumProp</span>    <span class="c">! Number of material properties being passed</span>
<a name="ln-4020"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>             <span class="c">! For matching interzone surfaces</span>
<a name="ln-4021"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-4022"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-4023"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-4024"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ValidChk</span>
<a name="ln-4025"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">numSides</span>
<a name="ln-4026"></a>
<a name="ln-4027"></a>  <span class="k">CALL </span><span class="n">GetWindowShadingControlData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4028"></a>
<a name="ln-4029"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;FenestrationSurface:Detailed&#39;</span>
<a name="ln-4030"></a>  <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">SurfaceNumAlpha</span><span class="p">,</span><span class="n">SurfaceNumProp</span><span class="p">)</span>
<a name="ln-4031"></a>
<a name="ln-4032"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceNumAlpha</span> <span class="o">/=</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4033"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4034"></a>                         <span class="s1">&#39;not = 7 Alpha Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4035"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceNumAlpha</span><span class="p">)))</span>
<a name="ln-4036"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4037"></a>  <span class="n">ENDIF</span>
<a name="ln-4038"></a>
<a name="ln-4039"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceNumProp</span> <span class="o">/=</span> <span class="mi">15</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4040"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4041"></a>                         <span class="s1">&#39;&gt; 15 Numeric Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4042"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceNumAlpha</span><span class="p">)))</span>
<a name="ln-4043"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4044"></a>  <span class="n">ENDIF</span>
<a name="ln-4045"></a>  <span class="n">NeedToAddSurfaces</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4046"></a>
<a name="ln-4047"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotHTSubs</span>
<a name="ln-4048"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">SurfaceNumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">SurfaceNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4049"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4050"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4051"></a>    <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4052"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4053"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4054"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4055"></a><span class="k">      CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-4056"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4057"></a>      <span class="k">CYCLE</span>
<a name="ln-4058"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4059"></a>
<a name="ln-4060"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceNumProp</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4061"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4062"></a>                      <span class="s1">&#39;&quot;, Too few number of numeric args=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceNumProp</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4063"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4064"></a>    <span class="n">ENDIF</span>
<a name="ln-4065"></a>
<a name="ln-4066"></a>    <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4067"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-4068"></a>    <span class="n">ValidChk</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">SubSurfCls</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4069"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ValidChk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4070"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4071"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4072"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4073"></a>    <span class="k">ELSE</span>
<a name="ln-4074"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">=</span> <span class="n">SubSurfIDs</span><span class="p">(</span><span class="n">ValidChk</span><span class="p">)</span> <span class="c">! Set class number</span>
<a name="ln-4075"></a>    <span class="n">ENDIF</span>
<a name="ln-4076"></a>
<a name="ln-4077"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-4078"></a>
<a name="ln-4079"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4080"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4081"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4082"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4083"></a>    <span class="k">ELSE</span>
<a name="ln-4084"></a><span class="k">      </span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4085"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-4086"></a>    <span class="k">END IF</span>
<a name="ln-4087"></a>
<a name="ln-4088"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Window</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_GlassDoor</span> <span class="p">&amp;</span>
<a name="ln-4089"></a>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4090"></a>
<a name="ln-4091"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4092"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4093"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4094"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4095"></a>                 <span class="s1">&#39;&quot; has an opaque surface construction; it should have a window construction.&#39;</span><span class="p">)</span>
<a name="ln-4096"></a>        <span class="n">ENDIF</span>
<a name="ln-4097"></a>      <span class="n">ENDIF</span>
<a name="ln-4098"></a>
<a name="ln-4099"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4100"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4101"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4102"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4103"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4104"></a>                               <span class="s1">&#39;&quot; - has Window materials.&#39;</span><span class="p">)</span>
<a name="ln-4105"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4106"></a>      <span class="n">ENDIF</span>
<a name="ln-4107"></a>    <span class="n">ENDIF</span>
<a name="ln-4108"></a>
<a name="ln-4109"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4110"></a>
<a name="ln-4111"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4112"></a>    <span class="c">!  The subsurface inherits properties from the base surface</span>
<a name="ln-4113"></a>    <span class="c">!  Exterior conditions, Zone, etc.</span>
<a name="ln-4114"></a>    <span class="c">!  We can figure out the base surface though, because they&#39;ve all been entered</span>
<a name="ln-4115"></a>    <span class="n">Found</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-4116"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4117"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-4118"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-4119"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCondName</span>
<a name="ln-4120"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-4121"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-4122"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4123"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span>
<a name="ln-4124"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">OSCPtr</span>
<a name="ln-4125"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4126"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">==</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Adiabatic surface, no windows or doors allowed</span>
<a name="ln-4127"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4128"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4129"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... adiabatic surfaces cannot have windows or doors.&#39;</span><span class="p">)</span>
<a name="ln-4130"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... no solar transmission will result for these windows or doors. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4131"></a>          <span class="s1">&#39;You must have interior windows or doors on Interzone surfaces for transmission to result.&#39;</span><span class="p">)</span>
<a name="ln-4132"></a>      <span class="n">ENDIF</span>
<a name="ln-4133"></a>    <span class="k">ELSE</span>
<a name="ln-4134"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4135"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-4136"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="s1">&#39;Unknown Zone&#39;</span>
<a name="ln-4137"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4138"></a>    <span class="n">ENDIF</span>
<a name="ln-4139"></a>
<a name="ln-4140"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_TDD_Dome</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4141"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>
<a name="ln-4142"></a>    <span class="k">END IF</span>
<a name="ln-4143"></a>
<a name="ln-4144"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4145"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4146"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4147"></a>                             <span class="s1">&#39;&quot;, invalid field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-4148"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...when Base surface uses &quot;Outdoors&quot; as &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4149"></a>           <span class="s1">&#39;, subsurfaces need to be blank to inherit the outdoor characteristics.&#39;</span><span class="p">)</span>
<a name="ln-4150"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Surface external characteristics changed to reflect base surface.&#39;</span><span class="p">)</span>
<a name="ln-4151"></a>      <span class="n">ENDIF</span>
<a name="ln-4152"></a>    <span class="n">ENDIF</span>
<a name="ln-4153"></a>
<a name="ln-4154"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! &quot;Surface&quot; Base Surface</span>
<a name="ln-4155"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4156"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4157"></a>      <span class="k">ELSE</span>
<a name="ln-4158"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4159"></a>                             <span class="s1">&#39;&quot;, invalid blank &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-4160"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...when Base surface uses &quot;Surface&quot; as &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4161"></a>           <span class="s1">&#39;, subsurfaces must also specify specific surfaces in the adjacent zone.&#39;</span><span class="p">)</span>
<a name="ln-4162"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c">! putting it as blank will not confuse things later.</span>
<a name="ln-4163"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4164"></a>      <span class="n">ENDIF</span>
<a name="ln-4165"></a>    <span class="n">ENDIF</span>
<a name="ln-4166"></a>
<a name="ln-4167"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnenteredAdjacentZoneSurface</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! &quot;Zone&quot; - unmatched interior surface</span>
<a name="ln-4168"></a>      <span class="n">NeedToAddSurfaces</span><span class="o">=</span><span class="n">NeedToAddSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4169"></a>      <span class="c">! ignoring window5datafiles for now -- will need to add.</span>
<a name="ln-4170"></a>    <span class="n">ENDIF</span>
<a name="ln-4171"></a>
<a name="ln-4172"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefNoCalcExt</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4173"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefCalcExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4174"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">! Otherside Coef special Name</span>
<a name="ln-4175"></a>          <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">OSC</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotOSC</span><span class="p">)</span>
<a name="ln-4176"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4177"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4178"></a>                          <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4179"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...base surface requires that this subsurface have OtherSideCoefficients -- not found.&#39;</span><span class="p">)</span>
<a name="ln-4180"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4181"></a>          <span class="k">ELSE</span>  <span class="c">! found</span>
<a name="ln-4182"></a>            <span class="c">! The following allows for a subsurface that has different characteristics than</span>
<a name="ln-4183"></a>            <span class="c">! the base surface with OtherSide Coeff -- do we want that or is it an error?</span>
<a name="ln-4184"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-4185"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4186"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">SurfFilmCoef</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4187"></a><span class="k">              </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">OtherSideCoefCalcExt</span>
<a name="ln-4188"></a>            <span class="k">ELSE</span>
<a name="ln-4189"></a><span class="k">              </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">OtherSideCoefNoCalcExt</span>
<a name="ln-4190"></a>            <span class="n">ENDIF</span>
<a name="ln-4191"></a>          <span class="n">ENDIF</span>
<a name="ln-4192"></a>        <span class="n">ENDIF</span>
<a name="ln-4193"></a>    <span class="n">ENDIF</span>
<a name="ln-4194"></a>
<a name="ln-4195"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4196"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>
<a name="ln-4197"></a>    <span class="n">ENDIF</span>
<a name="ln-4198"></a>
<a name="ln-4199"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4200"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-4201"></a>    <span class="n">ENDIF</span>
<a name="ln-4202"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4203"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="n">AutoCalculate</span>
<a name="ln-4204"></a>
<a name="ln-4205"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4206"></a><span class="k">      </span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">SurfaceNumProp</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-4207"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4208"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">SurfaceNumProp</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4209"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4210"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-4211"></a>                              <span class="s1">&#39; not even multiple of 3. Will read in &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-4212"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-4213"></a>      <span class="n">ENDIF</span>
<a name="ln-4214"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4215"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4216"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (autocalculate) must be &gt;= 3. Only &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4217"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; provided.&#39;</span><span class="p">)</span>
<a name="ln-4218"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4219"></a>        <span class="k">CYCLE</span>
<a name="ln-4220"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-4221"></a>    <span class="k">ELSE</span>
<a name="ln-4222"></a><span class="k">      </span><span class="n">numSides</span><span class="o">=</span><span class="p">(</span><span class="n">SurfaceNumProp</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-4223"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4224"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">numSides</span> <span class="o">&gt;</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4225"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4226"></a>                  <span class="s1">&#39;&quot;, field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-4227"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...but &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">numSides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; were entered. Only the indicated &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4228"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; will be used.&#39;</span><span class="p">)</span>
<a name="ln-4229"></a>      <span class="n">ENDIF</span>
<a name="ln-4230"></a>    <span class="n">ENDIF</span>
<a name="ln-4231"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-4232"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4233"></a>       <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4234"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4235"></a>    <span class="c">! Only windows, glass doors and doors can have Multiplier &gt; 1:</span>
<a name="ln-4236"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4237"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4238"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4239"></a>                          <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4240"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-4241"></a>      <span class="s1">&#39; multiplier will be set to 1.0.&#39;</span><span class="p">)</span>
<a name="ln-4242"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4243"></a>    <span class="k">END IF</span>
<a name="ln-4244"></a>
<a name="ln-4245"></a><span class="k">    CALL </span><span class="n">GetVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">:))</span>
<a name="ln-4246"></a>
<a name="ln-4247"></a>    <span class="k">CALL </span><span class="n">CheckConvexity</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-4248"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4249"></a>
<a name="ln-4250"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Window</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_GlassDoor</span> <span class="p">&amp;</span>
<a name="ln-4251"></a>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4252"></a>
<a name="ln-4253"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefNoCalcExt</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4254"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefCalcExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4255"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4256"></a>            <span class="s1">&#39;&quot;, Other side coefficients are not allowed with windows.&#39;</span><span class="p">)</span>
<a name="ln-4257"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4258"></a>      <span class="k">END IF</span>
<a name="ln-4259"></a>
<a name="ln-4260"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4261"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4262"></a>            <span class="s1">&#39;&quot;, Exterior boundary condition = Ground is not be allowed with windows.&#39;</span><span class="p">)</span>
<a name="ln-4263"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4264"></a>      <span class="k">END IF</span>
<a name="ln-4265"></a>
<a name="ln-4266"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4267"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">TotWinShadingControl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4268"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4269"></a>            <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">WindowShadingControl</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotWinShadingControl</span><span class="p">)</span>
<a name="ln-4270"></a>        <span class="n">ENDIF</span>
<a name="ln-4271"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4272"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4273"></a>                           <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4274"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4275"></a>        <span class="k">END IF</span>
<a name="ln-4276"></a>
<a name="ln-4277"></a>
<a name="ln-4278"></a>        <span class="c">! Error if this is not an exterior window and shading device has been specified</span>
<a name="ln-4279"></a>        <span class="c">! PETER: should doors be disallowed too?</span>
<a name="ln-4280"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4281"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4282"></a>
<a name="ln-4283"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4284"></a>                           <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; because it is not an exterior window.&#39;</span><span class="p">)</span>
<a name="ln-4285"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4286"></a>
<a name="ln-4287"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">WindowTypeEQL</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4288"></a>                <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4289"></a>
<a name="ln-4290"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4291"></a>                           <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4292"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. equivalent layer window model does not use shading control object.&#39;</span><span class="p">)</span>
<a name="ln-4293"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. Shading control is set to none or zero, and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4294"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4295"></a>        <span class="k">END IF</span>
<a name="ln-4296"></a><span class="k">      END IF</span>
<a name="ln-4297"></a>
<a name="ln-4298"></a><span class="k">      CALL </span><span class="n">CheckWindowShadingControlFrameDivider</span><span class="p">(</span><span class="s1">&#39;GetHTSubSurfaceData&#39;</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4299"></a>
<a name="ln-4300"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Triangular window</span>
<a name="ln-4301"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4302"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4303"></a>                           <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4304"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. because it is a triangular window and cannot have a frame or divider or reveal reflection.&#39;</span><span class="p">)</span>
<a name="ln-4305"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Frame, divider and reveal reflection will be ignored for this window.&#39;</span><span class="p">)</span>
<a name="ln-4306"></a>        <span class="k">END IF</span>
<a name="ln-4307"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4308"></a>      <span class="k">END IF</span>  <span class="c">! End of check if window is triangular or rectangular</span>
<a name="ln-4309"></a>
<a name="ln-4310"></a>    <span class="k">END IF</span>  <span class="c">! check on non-opaquedoor subsurfaces</span>
<a name="ln-4311"></a>
<a name="ln-4312"></a>    <span class="k">CALL </span><span class="n">CheckSubSurfaceMiscellaneous</span><span class="p">(</span><span class="s1">&#39;GetHTSubSurfaceData&#39;</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-4313"></a>
<a name="ln-4314"></a>  <span class="n">ENDDO</span>  <span class="c">! End of main loop over subsurfaces</span>
<a name="ln-4315"></a>
<a name="ln-4316"></a>  <span class="k">RETURN</span>
<a name="ln-4317"></a>
<a name="ln-4318"></a><span class="k">END SUBROUTINE </span><span class="n">GetHTSubSurfaceData</span>
<a name="ln-4319"></a>
<a name="ln-4320"></a><span class="k">SUBROUTINE </span><span class="n">GetRectSubSurfaces</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotWindows</span><span class="p">,</span><span class="n">TotDoors</span><span class="p">,</span><span class="n">TotGlazedDoors</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4321"></a>                               <span class="n">TotIZWindows</span><span class="p">,</span><span class="n">TotIZDoors</span><span class="p">,</span><span class="n">TotIZGlazedDoors</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4322"></a>                               <span class="n">SubSurfIDs</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">,</span><span class="n">NeedToAddSubSurfaces</span><span class="p">)</span>
<a name="ln-4323"></a>
<a name="ln-4324"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4325"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4326"></a>          <span class="c">!       DATE WRITTEN   December 2008</span>
<a name="ln-4327"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4328"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4329"></a>
<a name="ln-4330"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4331"></a>          <span class="c">! Get simple (rectangular, relative origin to base surface) windows, doors, glazed doors.</span>
<a name="ln-4332"></a>
<a name="ln-4333"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4334"></a>          <span class="c">! na</span>
<a name="ln-4335"></a>
<a name="ln-4336"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4337"></a>          <span class="c">! na</span>
<a name="ln-4338"></a>
<a name="ln-4339"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4340"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-4341"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-4342"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-4343"></a>
<a name="ln-4344"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4345"></a>
<a name="ln-4346"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4347"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-4348"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-4349"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotWindows</span>        <span class="c">! Number of Window SubSurfaces to obtain</span>
<a name="ln-4350"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotDoors</span>          <span class="c">! Number of Door SubSurfaces to obtain</span>
<a name="ln-4351"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotGlazedDoors</span>    <span class="c">! Number of Glass Door SubSurfaces to obtain</span>
<a name="ln-4352"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotIZWindows</span>      <span class="c">! Number of Interzone Window SubSurfaces to obtain</span>
<a name="ln-4353"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotIZDoors</span>        <span class="c">! Number of Interzone Door SubSurfaces to obtain</span>
<a name="ln-4354"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotIZGlazedDoors</span>  <span class="c">! Number of Interzone Glass Door SubSurfaces to obtain</span>
<a name="ln-4355"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SubSurfIDs</span>     <span class="c">! ID Assignments for valid sub surface classes</span>
<a name="ln-4356"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">AddedSubSurfaces</span>  <span class="c">! Subsurfaces added when windows reference Window5</span>
<a name="ln-4357"></a>                                                      <span class="c">!  data file entry with two glazing systems</span>
<a name="ln-4358"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NeedToAddSubSurfaces</span> <span class="c">! Number of surfaces to add, based on unentered IZ surfaces</span>
<a name="ln-4359"></a>
<a name="ln-4360"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4361"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cModuleObjects</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4362"></a>    <span class="p">(</span><span class="o">/</span><span class="s1">&#39;Window              &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4363"></a>      <span class="s1">&#39;Door                &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4364"></a>      <span class="s1">&#39;GlazedDoor          &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4365"></a>      <span class="s1">&#39;Window:Interzone    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4366"></a>      <span class="s1">&#39;Door:Interzone      &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4367"></a>      <span class="s1">&#39;GlazedDoor:Interzone&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-4368"></a>
<a name="ln-4369"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4370"></a>          <span class="c">! na</span>
<a name="ln-4371"></a>
<a name="ln-4372"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4373"></a>          <span class="c">! na</span>
<a name="ln-4374"></a>
<a name="ln-4375"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4376"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-4377"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ItemsToGet</span>
<a name="ln-4378"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-4379"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-4380"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>
<a name="ln-4381"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-4382"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>             <span class="c">! For matching base surfaces</span>
<a name="ln-4383"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-4384"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-4385"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">GettingIZSurfaces</span>
<a name="ln-4386"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WindowShadingField</span>
<a name="ln-4387"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FrameField</span>
<a name="ln-4388"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OtherSurfaceField</span>
<a name="ln-4389"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ClassItem</span>
<a name="ln-4390"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IZFound</span>
<a name="ln-4391"></a>
<a name="ln-4392"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-4393"></a>
<a name="ln-4394"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="n">cModuleObjects</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span>
<a name="ln-4395"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4396"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotWindows</span>
<a name="ln-4397"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4398"></a>      <span class="n">WindowShadingField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-4399"></a>      <span class="n">FrameField</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-4400"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4401"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-4402"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4403"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotDoors</span>
<a name="ln-4404"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4405"></a>      <span class="n">WindowShadingField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4406"></a>      <span class="n">FrameField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4407"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4408"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-4409"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4410"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotGlazedDoors</span>
<a name="ln-4411"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4412"></a>      <span class="n">WindowShadingField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-4413"></a>      <span class="n">FrameField</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-4414"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4415"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-4416"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4417"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotIZWindows</span>
<a name="ln-4418"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4419"></a>      <span class="n">WindowShadingField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4420"></a>      <span class="n">FrameField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4421"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-4422"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-4423"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4424"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotIZDoors</span>
<a name="ln-4425"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4426"></a>      <span class="n">WindowShadingField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4427"></a>      <span class="n">FrameField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4428"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-4429"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-4430"></a>    <span class="k">ELSE</span>  <span class="c">! Item = 6</span>
<a name="ln-4431"></a>      <span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotIZGlazedDoors</span>
<a name="ln-4432"></a>      <span class="n">GettingIZSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4433"></a>      <span class="n">WindowShadingField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4434"></a>      <span class="n">FrameField</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4435"></a>      <span class="n">OtherSurfaceField</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-4436"></a>      <span class="n">ClassItem</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-4437"></a>    <span class="n">ENDIF</span>
<a name="ln-4438"></a>
<a name="ln-4439"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ItemsToGet</span>
<a name="ln-4440"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4441"></a>                     <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4442"></a>                     <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4443"></a>      <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4444"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4445"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4446"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4447"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-4448"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4449"></a>        <span class="k">CYCLE</span>
<a name="ln-4450"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-4451"></a>
<a name="ln-4452"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumNumbers</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4453"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4454"></a>                        <span class="s1">&#39;&quot;, Too few number of numeric args=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumNumbers</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4455"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4456"></a>      <span class="n">ENDIF</span>
<a name="ln-4457"></a>
<a name="ln-4458"></a>      <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4459"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-4460"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">=</span> <span class="n">SubSurfIDs</span><span class="p">(</span><span class="n">ClassItem</span><span class="p">)</span> <span class="c">! Set class number</span>
<a name="ln-4461"></a>
<a name="ln-4462"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-4463"></a>
<a name="ln-4464"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4465"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4466"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4467"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4468"></a>      <span class="k">ELSE</span>
<a name="ln-4469"></a><span class="k">        </span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4470"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-4471"></a>      <span class="k">END IF</span>
<a name="ln-4472"></a>
<a name="ln-4473"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Window</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4474"></a>
<a name="ln-4475"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4476"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4477"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4478"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4479"></a>                   <span class="s1">&#39;&quot; has an opaque surface construction; it should have a window construction.&#39;</span><span class="p">)</span>
<a name="ln-4480"></a>          <span class="n">ENDIF</span>
<a name="ln-4481"></a>        <span class="n">ENDIF</span>
<a name="ln-4482"></a>
<a name="ln-4483"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4484"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4485"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4486"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4487"></a>                                 <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4488"></a>                                 <span class="s1">&#39;&quot; - has Window materials.&#39;</span><span class="p">)</span>
<a name="ln-4489"></a>        <span class="n">ENDIF</span>
<a name="ln-4490"></a>      <span class="n">ENDIF</span>
<a name="ln-4491"></a>
<a name="ln-4492"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4493"></a>
<a name="ln-4494"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4495"></a>      <span class="c">!  The subsurface inherits properties from the base surface</span>
<a name="ln-4496"></a>      <span class="c">!  Exterior conditions, Zone, etc.</span>
<a name="ln-4497"></a>      <span class="c">!  We can figure out the base surface though, because they&#39;ve all been entered</span>
<a name="ln-4498"></a>      <span class="n">Found</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-4499"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4500"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-4501"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-4502"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCondName</span>
<a name="ln-4503"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-4504"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-4505"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-4506"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-4507"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4508"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span>
<a name="ln-4509"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">OSCPtr</span>
<a name="ln-4510"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ViewFactorGround</span>
<a name="ln-4511"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-4512"></a>      <span class="k">ELSE</span>
<a name="ln-4513"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4514"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4515"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="s1">&#39;Unknown Zone&#39;</span>
<a name="ln-4516"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4517"></a>        <span class="k">CYCLE</span>
<a name="ln-4518"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-4519"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4520"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">==</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Adiabatic surface, no windows or doors allowed</span>
<a name="ln-4521"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4522"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4523"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... adiabatic surfaces cannot have windows or doors.&#39;</span><span class="p">)</span>
<a name="ln-4524"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... no solar transmission will result for these windows or doors. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4525"></a>          <span class="s1">&#39;You must have interior windows or doors on Interzone surfaces for transmission to result.&#39;</span><span class="p">)</span>
<a name="ln-4526"></a>      <span class="n">ENDIF</span>
<a name="ln-4527"></a>
<a name="ln-4528"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! &quot;Surface&quot; Base Surface</span>
<a name="ln-4529"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GettingIZSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4530"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4531"></a>                               <span class="s1">&#39;&quot;, invalid use of object&#39;</span><span class="p">)</span>
<a name="ln-4532"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...when Base surface uses &quot;Surface&quot; as &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4533"></a>             <span class="s1">&#39;, subsurfaces must also specify specific surfaces in the adjacent zone.&#39;</span><span class="p">)</span>
<a name="ln-4534"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Please use &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:Interzone to enter this surface.&#39;</span><span class="p">)</span>
<a name="ln-4535"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">blank</span>  <span class="c">! putting it as blank will not confuse things later.</span>
<a name="ln-4536"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4537"></a>        <span class="n">ENDIF</span>
<a name="ln-4538"></a>      <span class="n">ENDIF</span>
<a name="ln-4539"></a>
<a name="ln-4540"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! &quot;Surface&quot; Base Surface</span>
<a name="ln-4541"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GettingIZSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4542"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">OtherSurfaceField</span><span class="p">)</span>
<a name="ln-4543"></a>          <span class="n">IZFound</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-4544"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IZFound</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">UnenteredAdjacentZoneSurface</span>
<a name="ln-4545"></a>        <span class="k">ELSE</span>  <span class="c">! Interior Window</span>
<a name="ln-4546"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-4547"></a>        <span class="n">ENDIF</span>
<a name="ln-4548"></a>      <span class="n">ENDIF</span>
<a name="ln-4549"></a>
<a name="ln-4550"></a>      <span class="c">! This is the parent&#39;s property:</span>
<a name="ln-4551"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnenteredAdjacentZoneSurface</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! OtherZone - unmatched interior surface</span>
<a name="ln-4552"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GettingIZSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4553"></a><span class="k">          </span><span class="n">NeedToAddSubSurfaces</span><span class="o">=</span><span class="n">NeedToAddSubSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4554"></a>        <span class="k">ELSE</span>  <span class="c">! Interior Window</span>
<a name="ln-4555"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4556"></a>                               <span class="s1">&#39;&quot;, invalid Interzone Surface, specify &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:InterZone&#39;</span><span class="p">)</span>
<a name="ln-4557"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...when base surface is an interzone surface, subsurface must also be an interzone surface.&#39;</span><span class="p">)</span>
<a name="ln-4558"></a>          <span class="n">NeedToAddSubSurfaces</span><span class="o">=</span><span class="n">NeedToAddSubSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4559"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4560"></a>        <span class="n">ENDIF</span>
<a name="ln-4561"></a>      <span class="n">ENDIF</span>
<a name="ln-4562"></a>
<a name="ln-4563"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GettingIZSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4564"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">OtherSurfaceField</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4565"></a>          <span class="c">! blank -- set it up for unentered adjacent zone</span>
<a name="ln-4566"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnenteredAdjacentZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! already set but need Zone</span>
<a name="ln-4567"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCondName</span>  <span class="c">! base surface has it</span>
<a name="ln-4568"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4569"></a><span class="k">            </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span>  <span class="c">! base surface has it</span>
<a name="ln-4570"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">UnenteredAdjacentZoneSurface</span>
<a name="ln-4571"></a>          <span class="k">ELSE</span>  <span class="c">! not correct boundary condition for interzone subsurface</span>
<a name="ln-4572"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4573"></a>                                 <span class="s1">&#39;&quot;, invalid Base Surface type for Interzone Surface&#39;</span><span class="p">)</span>
<a name="ln-4574"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...when base surface is not an interzone surface, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4575"></a>               <span class="s1">&#39;subsurface must also not be an interzone surface.&#39;</span><span class="p">)</span>
<a name="ln-4576"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4577"></a>          <span class="n">ENDIF</span>
<a name="ln-4578"></a>        <span class="n">ENDIF</span>
<a name="ln-4579"></a>      <span class="n">ENDIF</span>
<a name="ln-4580"></a>
<a name="ln-4581"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4582"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>
<a name="ln-4583"></a>      <span class="n">ENDIF</span>
<a name="ln-4584"></a>
<a name="ln-4585"></a><span class="c">!      SurfaceTmp(SurfNum)%ViewFactorGround = AutoCalculate</span>
<a name="ln-4586"></a>
<a name="ln-4587"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-4588"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-4589"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4590"></a>         <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4591"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4592"></a>      <span class="c">! Only windows, glass doors and doors can have Multiplier &gt; 1:</span>
<a name="ln-4593"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4594"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4595"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4596"></a>                            <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4597"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-4598"></a>        <span class="s1">&#39; multiplier will be set to 1.0.&#39;</span><span class="p">)</span>
<a name="ln-4599"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4600"></a>      <span class="k">END IF</span>
<a name="ln-4601"></a>
<a name="ln-4602"></a><span class="k">      CALL </span><span class="n">MakeRelativeRectangularVertices</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4603"></a>                         <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-4604"></a>
<a name="ln-4605"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4606"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4607"></a>              <span class="s1">&#39;&quot;, Surface Area &lt;= 0.0; Entered Area=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4608"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4609"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4610"></a>      <span class="n">ENDIF</span>
<a name="ln-4611"></a>
<a name="ln-4612"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4613"></a>
<a name="ln-4614"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">GettingIZSurfaces</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4615"></a>          <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_Window</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">SurfaceClass_GlassDoor</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4616"></a>
<a name="ln-4617"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefNoCalcExt</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4618"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCoefCalcExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4619"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4620"></a>              <span class="s1">&#39;&quot;, Other side coefficients are not allowed with windows.&#39;</span><span class="p">)</span>
<a name="ln-4621"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4622"></a>        <span class="k">END IF</span>
<a name="ln-4623"></a>
<a name="ln-4624"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4625"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4626"></a>              <span class="s1">&#39;&quot;, Exterior boundary condition = Ground is not be allowed with windows.&#39;</span><span class="p">)</span>
<a name="ln-4627"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4628"></a>        <span class="k">END IF</span>
<a name="ln-4629"></a>
<a name="ln-4630"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">WindowShadingField</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4631"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">TotWinShadingControl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4632"></a><span class="k">            </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4633"></a>              <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">WindowShadingField</span><span class="p">),</span><span class="n">WindowShadingControl</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotWinShadingControl</span><span class="p">)</span>
<a name="ln-4634"></a>          <span class="n">ENDIF</span>
<a name="ln-4635"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4636"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4637"></a>                   <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">WindowShadingField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">WindowShadingField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4638"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4639"></a>          <span class="k">END IF</span>
<a name="ln-4640"></a>
<a name="ln-4641"></a>
<a name="ln-4642"></a>          <span class="c">! Error if this is not an exterior window and shading device has been specified</span>
<a name="ln-4643"></a>          <span class="c">! PETER: should doors be disallowed too?</span>
<a name="ln-4644"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4645"></a>              <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4646"></a>
<a name="ln-4647"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4648"></a>                   <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">WindowShadingField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; because it is not an exterior window.&#39;</span><span class="p">)</span>
<a name="ln-4649"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4650"></a>          <span class="k">END IF</span>
<a name="ln-4651"></a><span class="k">        END IF</span>
<a name="ln-4652"></a>
<a name="ln-4653"></a><span class="k">        CALL </span><span class="n">CheckWindowShadingControlFrameDivider</span><span class="p">(</span><span class="s1">&#39;GetRectSubSurfaces&#39;</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">FrameField</span><span class="p">)</span>
<a name="ln-4654"></a>
<a name="ln-4655"></a>      <span class="k">END IF</span>  <span class="c">! check on non-opaquedoor subsurfaces</span>
<a name="ln-4656"></a>
<a name="ln-4657"></a>      <span class="k">CALL </span><span class="n">CheckSubSurfaceMiscellaneous</span><span class="p">(</span><span class="s1">&#39;GetRectSubSurfaces&#39;</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-4658"></a>
<a name="ln-4659"></a>    <span class="n">ENDDO</span>  <span class="c">! Getting Items</span>
<a name="ln-4660"></a>
<a name="ln-4661"></a>  <span class="n">ENDDO</span>
<a name="ln-4662"></a>
<a name="ln-4663"></a>  <span class="k">RETURN</span>
<a name="ln-4664"></a>
<a name="ln-4665"></a><span class="k">END SUBROUTINE </span><span class="n">GetRectSubSurfaces</span>
<a name="ln-4666"></a>
<a name="ln-4667"></a><span class="k">SUBROUTINE </span><span class="n">CheckWindowShadingControlFrameDivider</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">FrameField</span><span class="p">)</span>
<a name="ln-4668"></a>
<a name="ln-4669"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4670"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4671"></a>          <span class="c">!       DATE WRITTEN   December 2008</span>
<a name="ln-4672"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4673"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4674"></a>
<a name="ln-4675"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4676"></a>          <span class="c">! This routine performs checks on WindowShadingControl settings and Frame/Divider Settings.</span>
<a name="ln-4677"></a>
<a name="ln-4678"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4679"></a>          <span class="c">! na</span>
<a name="ln-4680"></a>
<a name="ln-4681"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4682"></a>          <span class="c">! na</span>
<a name="ln-4683"></a>
<a name="ln-4684"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4685"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-4686"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-4687"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-4688"></a>
<a name="ln-4689"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4690"></a>
<a name="ln-4691"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4692"></a>          <span class="c">! na</span>
<a name="ln-4693"></a>
<a name="ln-4694"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4695"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cRoutineName</span>  <span class="c">! routine name calling this one (for error messages)</span>
<a name="ln-4696"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! true if errors have been found or are found here</span>
<a name="ln-4697"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SurfNum</span>      <span class="c">! current surface number</span>
<a name="ln-4698"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FrameField</span>   <span class="c">! field number for frame/divider</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4701"></a>          <span class="c">! na</span>
<a name="ln-4702"></a>
<a name="ln-4703"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4704"></a>          <span class="c">! na</span>
<a name="ln-4705"></a>
<a name="ln-4706"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4707"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WSCPtr</span>       <span class="c">! WindowShadingControl Index</span>
<a name="ln-4708"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNumSh</span>  <span class="c">! Construction number with Shade</span>
<a name="ln-4709"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>    <span class="c">! Construction number</span>
<a name="ln-4710"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ShDevNum</span>     <span class="c">! Shading Device number</span>
<a name="ln-4711"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Lay</span>               <span class="c">! Layer number</span>
<a name="ln-4712"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotGlassLayers</span>    <span class="c">! Number of glass layers in window construction</span>
<a name="ln-4713"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLayers</span>         <span class="c">! Number of layers in unshaded construction</span>
<a name="ln-4714"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotShLayers</span>       <span class="c">! Number of layers in shaded construction</span>
<a name="ln-4715"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatGap</span>            <span class="c">! Gap material number</span>
<a name="ln-4716"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatGap1</span>           <span class="c">! Material number of gap to left (outer side) of between-glass shade/blind</span>
<a name="ln-4717"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatGap2</span>           <span class="c">! Material number of gap to right (inner side) of between-glass shade/blind</span>
<a name="ln-4718"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatSh</span>             <span class="c">! Between-glass shade/blind material number</span>
<a name="ln-4719"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MatGapCalc</span>      <span class="c">! Calculated MatGap diff for shaded vs non-shaded constructions</span>
<a name="ln-4720"></a>
<a name="ln-4721"></a>  <span class="c">! If WindowShadingControl has been specified for this window --</span>
<a name="ln-4722"></a>  <span class="c">! Set shaded construction number if shaded construction was specified in WindowShadingControl.</span>
<a name="ln-4723"></a>  <span class="c">! Otherwise, create shaded construction if WindowShadingControl for this window has</span>
<a name="ln-4724"></a>  <span class="c">! interior or exterior shade/blind (but not between-glass shade/blind) specified.</span>
<a name="ln-4725"></a>
<a name="ln-4726"></a>
<a name="ln-4727"></a>  <span class="n">WSCptr</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-4728"></a>  <span class="n">ConstrNumSh</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4729"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ErrorsFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WSCptr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4730"></a><span class="k">    </span><span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-4731"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ConstrNumSh</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4732"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">=</span> <span class="n">ConstrNumSh</span>
<a name="ln-4733"></a>    <span class="k">ELSE</span>
<a name="ln-4734"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4735"></a>         <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorBlind</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4736"></a>         <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_ExteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4737"></a>         <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_ExteriorScreen</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4738"></a>         <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_ExteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4739"></a><span class="k">        </span><span class="n">ShDevNum</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingDevice</span>
<a name="ln-4740"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShDevNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4741"></a><span class="k">          CALL </span><span class="n">CreateShadedWindowConstruction</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">WSCptr</span><span class="p">,</span><span class="n">ShDevNum</span><span class="p">)</span>
<a name="ln-4742"></a>          <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-4743"></a>        <span class="n">ENDIF</span>
<a name="ln-4744"></a>      <span class="k">END IF</span>
<a name="ln-4745"></a><span class="k">    END IF</span>
<a name="ln-4746"></a><span class="k">  END IF</span>
<a name="ln-4747"></a>
<a name="ln-4748"></a>  <span class="c">! Error checks for shades and blinds</span>
<a name="ln-4749"></a>
<a name="ln-4750"></a>  <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-4751"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ErrorsFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WSCptr</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ConstrNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ConstrNumSh</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4752"></a>
<a name="ln-4753"></a><span class="k">    IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4754"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4755"></a><span class="k">      </span><span class="n">TotLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4756"></a>      <span class="n">TotShLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4757"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotShLayers</span><span class="o">-</span><span class="mi">1</span> <span class="o">/=</span> <span class="n">TotLayers</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4758"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;WindowProperty:ShadingControl: Interior shade or blind: Potential problem in match of &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4759"></a>                              <span class="s1">&#39;unshaded/shaded constructions, shaded should have 1 more layers than unshaded.&#39;</span><span class="p">)</span>
<a name="ln-4760"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Unshaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4761"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4762"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;If preceding two constructions are same name, you have likely specified a &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-4763"></a>                               <span class="s1">&#39;WindowProperty:ShadingControl (Field #3) with the Window Construction rather than &#39;</span><span class="o">//</span>    <span class="p">&amp;</span>
<a name="ln-4764"></a>                               <span class="s1">&#39;a shaded construction.&#39;</span><span class="p">)</span>
<a name="ln-4765"></a>      <span class="n">ENDIF</span>
<a name="ln-4766"></a>      <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4767"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4768"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4769"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span> <span class="p">&amp;</span>
<a name="ln-4770"></a>            <span class="p">(</span><span class="s1">&#39; The glass and gas layers in the shaded and unshaded constructions do not match for window=&#39;</span> <span class="p">&amp;</span>
<a name="ln-4771"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4772"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Unshaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4773"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4774"></a>          <span class="k">EXIT</span>
<a name="ln-4775"></a><span class="k">        END IF</span>
<a name="ln-4776"></a><span class="k">      END DO</span>
<a name="ln-4777"></a><span class="k">    END IF</span>
<a name="ln-4778"></a>
<a name="ln-4779"></a><span class="k">    IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_ExteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4780"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_ExteriorScreen</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4781"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_ExteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4782"></a><span class="k">      </span><span class="n">TotLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4783"></a>      <span class="n">TotShLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4784"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotShLayers</span><span class="o">-</span><span class="mi">1</span> <span class="o">/=</span> <span class="n">TotLayers</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4785"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;WindowProperty:ShadingControl: Exterior shade, screen or blind: &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4786"></a>           <span class="s1">&#39;Potential problem in match of unshaded/shaded constructions, shaded should have 1 more layer than unshaded.&#39;</span><span class="p">)</span>
<a name="ln-4787"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Unshaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4788"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4789"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;If preceding two constructions have the same name, you have likely specified a &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-4790"></a>                               <span class="s1">&#39;WindowProperty:ShadingControl (Field #3) with the Window Construction rather than &#39;</span><span class="o">//</span>    <span class="p">&amp;</span>
<a name="ln-4791"></a>                               <span class="s1">&#39;a shaded construction.&#39;</span><span class="p">)</span>
<a name="ln-4792"></a>      <span class="n">ENDIF</span>
<a name="ln-4793"></a>      <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4794"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4795"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4796"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span> <span class="p">&amp;</span>
<a name="ln-4797"></a>            <span class="p">(</span><span class="s1">&#39; The glass and gas layers in the shaded and unshaded constructions do not match for window=&#39;</span> <span class="p">&amp;</span>
<a name="ln-4798"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4799"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Unshaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4800"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4801"></a>          <span class="k">EXIT</span>
<a name="ln-4802"></a><span class="k">        END IF</span>
<a name="ln-4803"></a><span class="k">      END DO</span>
<a name="ln-4804"></a><span class="k">    END IF</span>
<a name="ln-4805"></a>
<a name="ln-4806"></a><span class="k">    IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4807"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4808"></a>          <span class="c">! Divider not allowed with between-glass shade or blind</span>
<a name="ln-4809"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4810"></a><span class="k">        IF</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="p">)%</span><span class="n">DividerWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4811"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;A divider cannot be specified for window &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4812"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;, which has a between-glass shade or blind.&#39;</span><span class="p">)</span>
<a name="ln-4813"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculation will proceed without the divider for this window.&#39;</span><span class="p">)</span>
<a name="ln-4814"></a>          <span class="n">FrameDivider</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="p">)%</span><span class="n">DividerWidth</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4815"></a>        <span class="k">END IF</span>
<a name="ln-4816"></a><span class="k">      END IF</span>
<a name="ln-4817"></a>          <span class="c">! Check consistency of gap widths between unshaded and shaded constructions</span>
<a name="ln-4818"></a>      <span class="n">TotGlassLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-4819"></a>      <span class="n">TotLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4820"></a>      <span class="n">TotShLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-4821"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotShLayers</span><span class="o">-</span><span class="mi">2</span> <span class="o">/=</span> <span class="n">TotLayers</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4822"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;WindowProperty:ShadingControl: Between Glass Shade/Blind: Potential problem in match of &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4823"></a>                              <span class="s1">&#39;unshaded/shaded constructions, shaded should have 2 more layers than unshaded.&#39;</span><span class="p">)</span>
<a name="ln-4824"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Unshaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4825"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4826"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;If preceding two constructions are same name, you have likely specified a &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-4827"></a>                               <span class="s1">&#39;WindowProperty:ShadingControl (Field #3) with the Window Construction rather than &#39;</span><span class="o">//</span>    <span class="p">&amp;</span>
<a name="ln-4828"></a>                               <span class="s1">&#39;a shaded construction.&#39;</span><span class="p">)</span>
<a name="ln-4829"></a>      <span class="n">ENDIF</span>
<a name="ln-4830"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLayers</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotShLayers</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4831"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Mis-match in unshaded/shaded inside layer materials.  These should match.&#39;</span><span class="p">)</span>
<a name="ln-4832"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Unshaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4833"></a>                 <span class="s1">&#39;, Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLayers</span><span class="p">))%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4834"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4835"></a>                 <span class="s1">&#39;, Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotShLayers</span><span class="p">))%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4836"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4837"></a>      <span class="n">ENDIF</span>
<a name="ln-4838"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4839"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Mis-match in unshaded/shaded inside layer materials.  These should match.&#39;</span><span class="p">)</span>
<a name="ln-4840"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Unshaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4841"></a>                 <span class="s1">&#39;, Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4842"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shaded construction=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4843"></a>                 <span class="s1">&#39;, Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4844"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4845"></a>      <span class="n">ENDIF</span>
<a name="ln-4846"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">TotGlassLayers</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TotGlassLayers</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4847"></a><span class="k">        </span><span class="n">MatGap</span> <span class="o">=</span>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">TotGlassLayers</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4848"></a>        <span class="n">MatGap1</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">TotGlassLayers</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4849"></a>        <span class="n">MatGap2</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">TotGlassLayers</span><span class="p">)</span>
<a name="ln-4850"></a>        <span class="n">MatSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">TotGlassLayers</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4851"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4852"></a><span class="k">          </span><span class="n">MatGapCalc</span><span class="o">=</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">-</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap1</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">+</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap2</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">))</span>
<a name="ln-4853"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">MatGapCalc</span> <span class="o">&gt;</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4854"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: The gap width(s) for the unshaded window construction &#39;</span> <span class="p">&amp;</span>
<a name="ln-4855"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4856"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;are inconsistent with the gap widths for shaded window construction &#39;</span> <span class="p">&amp;</span>
<a name="ln-4857"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4858"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;for window &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, which has a between-glass blind.&#39;</span><span class="p">)</span>
<a name="ln-4859"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-4860"></a>                            <span class="s1">&#39; thickness=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; -&#39;</span><span class="p">)</span>
<a name="ln-4861"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..( Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4862"></a>                            <span class="s1">&#39; thickness=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap1</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; +&#39;</span><span class="p">)</span>
<a name="ln-4863"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap2</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4864"></a>                            <span class="s1">&#39; thickness=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap2</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; )=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4865"></a>                            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MatGapCalc</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] &gt;.001&#39;</span><span class="p">)</span>
<a name="ln-4866"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4867"></a>          <span class="k">END IF</span>
<a name="ln-4868"></a><span class="k">        ELSE</span>  <span class="c">! Between-glass shade</span>
<a name="ln-4869"></a>          <span class="n">MatGapCalc</span><span class="o">=</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-4870"></a>                         <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap1</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">+</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap2</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">+</span><span class="n">Material</span><span class="p">(</span><span class="n">MatSh</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">))</span>
<a name="ln-4871"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">MatGapCalc</span> <span class="o">&gt;</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4872"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: The gap width(s) for the unshaded window construction &#39;</span> <span class="p">&amp;</span>
<a name="ln-4873"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4874"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;are inconsistent with the gap widths for shaded window construction &#39;</span> <span class="p">&amp;</span>
<a name="ln-4875"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4876"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;for window &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, which has a between-glass shade.&#39;</span><span class="p">)</span>
<a name="ln-4877"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4878"></a>                            <span class="s1">&#39; thickness=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; -&#39;</span><span class="p">)</span>
<a name="ln-4879"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...( Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4880"></a>                            <span class="s1">&#39; thickness=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap1</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; +&#39;</span><span class="p">)</span>
<a name="ln-4881"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap2</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4882"></a>                            <span class="s1">&#39; thickness=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGap2</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; +&#39;</span><span class="p">)</span>
<a name="ln-4883"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatSh</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>    <span class="p">&amp;</span>
<a name="ln-4884"></a>                            <span class="s1">&#39; thickness=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatSh</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; )=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4885"></a>                            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MatGapCalc</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] &gt;.001&#39;</span><span class="p">)</span>
<a name="ln-4886"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4887"></a>          <span class="k">END IF</span>
<a name="ln-4888"></a><span class="k">        END IF</span>
<a name="ln-4889"></a><span class="k">      END IF</span>
<a name="ln-4890"></a><span class="k">    END IF</span>
<a name="ln-4891"></a><span class="k">  END IF</span>
<a name="ln-4892"></a>
<a name="ln-4893"></a><span class="k">  IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">/=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Rectangular Window</span>
<a name="ln-4894"></a>    <span class="c">! Initialize the FrameDivider number for this window. W5FrameDivider will be positive if</span>
<a name="ln-4895"></a>    <span class="c">! this window&#39;s construction came from the Window5 data file and that construction had an</span>
<a name="ln-4896"></a>    <span class="c">! associated frame or divider. It will be zero if the window&#39;s construction is not from the</span>
<a name="ln-4897"></a>    <span class="c">! Window5 data file, or the construction is from the data file, but the construction has no</span>
<a name="ln-4898"></a>    <span class="c">! associated frame or divider. Note that if there is a FrameDivider candidate for this</span>
<a name="ln-4899"></a>    <span class="c">! window from the Window5 data file it is used instead of the window&#39;s input FrameDivider.</span>
<a name="ln-4900"></a>
<a name="ln-4901"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4902"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">W5FrameDivider</span>
<a name="ln-4903"></a>
<a name="ln-4904"></a>      <span class="c">! Warning if FrameAndDivider for this window is over-ridden by one from Window5 Data File</span>
<a name="ln-4905"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4906"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4907"></a>                       <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4908"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;will be replaced with FrameAndDivider from Window5 Data File entry &#39;</span> <span class="p">&amp;</span>
<a name="ln-4909"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4910"></a>      <span class="k">END IF</span>
<a name="ln-4911"></a>
<a name="ln-4912"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">FrameField</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4913"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4914"></a>          <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">FrameField</span><span class="p">),</span><span class="n">FrameDivider</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotFrameDivider</span><span class="p">)</span>
<a name="ln-4915"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4916"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">WindowTypeEQL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4917"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4918"></a>                    <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4919"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4920"></a>          <span class="k">ELSE</span>
<a name="ln-4921"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4922"></a>                   <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4923"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Frame/Divider is not supported in Equivalent Layer Window model.&#39;</span><span class="p">)</span>
<a name="ln-4924"></a>          <span class="n">ENDIF</span>
<a name="ln-4925"></a>        <span class="k">END IF</span>
<a name="ln-4926"></a>            <span class="c">! Divider not allowed with between-glass shade or blind</span>
<a name="ln-4927"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ErrorsFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WSCptr</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ConstrNumSh</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4928"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4929"></a>            <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4930"></a><span class="k">            IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4931"></a><span class="k">              IF</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="p">)%</span><span class="n">DividerWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4932"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4933"></a>                       <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4934"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Divider cannot be specified because the construction has a between-glass shade or blind.&#39;</span><span class="p">)</span>
<a name="ln-4935"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculation will proceed without the divider for this window.&#39;</span><span class="p">)</span>
<a name="ln-4936"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Divider width = [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4937"></a>                   <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="p">)%</span><span class="n">DividerWidth</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4938"></a>                <span class="n">FrameDivider</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="p">)%</span><span class="n">DividerWidth</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4939"></a>              <span class="k">END IF</span>
<a name="ln-4940"></a><span class="k">            END IF</span> <span class="c">! End of check if window has divider</span>
<a name="ln-4941"></a>          <span class="k">END IF</span>  <span class="c">! End of check if window has a between-glass shade or blind</span>
<a name="ln-4942"></a>        <span class="k">END IF</span>  <span class="c">! End of check if window has a shaded construction</span>
<a name="ln-4943"></a>      <span class="k">END IF</span>  <span class="c">! End of check if window has an associated FrameAndDivider</span>
<a name="ln-4944"></a>    <span class="k">END IF</span>  <span class="c">! End of check if window has a construction</span>
<a name="ln-4945"></a>  <span class="k">END IF</span>
<a name="ln-4946"></a>
<a name="ln-4947"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">WindowTypeEQL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4948"></a><span class="k">     IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4949"></a>        <span class="c">! Equivalent Layer window does not have frame/divider model</span>
<a name="ln-4950"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4951"></a>             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">FrameField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4952"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Frame/Divider is not supported in Equivalent Layer Window model.&#39;</span><span class="p">)</span>
<a name="ln-4953"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4954"></a>     <span class="n">ENDIF</span>
<a name="ln-4955"></a>  <span class="n">ENDIF</span>
<a name="ln-4956"></a>
<a name="ln-4957"></a>  <span class="k">RETURN</span>
<a name="ln-4958"></a>
<a name="ln-4959"></a><span class="k">END SUBROUTINE </span><span class="n">CheckWindowShadingControlFrameDivider</span>
<a name="ln-4960"></a>
<a name="ln-4961"></a><span class="k">SUBROUTINE </span><span class="n">CheckSubSurfaceMiscellaneous</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SubSurfaceName</span><span class="p">,</span><span class="n">SubSurfaceConstruction</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-4962"></a>
<a name="ln-4963"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4964"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4965"></a>          <span class="c">!       DATE WRITTEN   December 2008</span>
<a name="ln-4966"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4967"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4968"></a>
<a name="ln-4969"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4970"></a>          <span class="c">! This routine performs miscellaneous checks on subsurfaces: Windows, GlassDoors, Doors, Tubular Devices.</span>
<a name="ln-4971"></a>
<a name="ln-4972"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4973"></a>          <span class="c">! na</span>
<a name="ln-4974"></a>
<a name="ln-4975"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4976"></a>          <span class="c">! na</span>
<a name="ln-4977"></a>
<a name="ln-4978"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4979"></a><span class="c">!  USE DataIPShortCuts</span>
<a name="ln-4980"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-4981"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-4982"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span>
<a name="ln-4983"></a>
<a name="ln-4984"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4985"></a>
<a name="ln-4986"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4987"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cRoutineName</span>  <span class="c">! routine name calling this one (for error messages)</span>
<a name="ln-4988"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! true if errors have been found or are found here</span>
<a name="ln-4989"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SurfNum</span>      <span class="c">! current surface number</span>
<a name="ln-4990"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SubSurfaceName</span>    <span class="c">!  name of the surface</span>
<a name="ln-4991"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SubSurfaceConstruction</span>    <span class="c">!  name of the construction</span>
<a name="ln-4992"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AddedSubSurfaces</span>
<a name="ln-4993"></a>
<a name="ln-4994"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4995"></a>          <span class="c">! na</span>
<a name="ln-4996"></a>
<a name="ln-4997"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4998"></a>          <span class="c">! na</span>
<a name="ln-4999"></a>
<a name="ln-5000"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5001"></a>          <span class="c">! na</span>
<a name="ln-5002"></a>
<a name="ln-5003"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5004"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumShades</span>  <span class="c">! count on number of shading layers</span>
<a name="ln-5005"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Lay</span>               <span class="c">! Layer number</span>
<a name="ln-5006"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LayerPtr</span>          <span class="c">! Layer pointer</span>
<a name="ln-5007"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>    <span class="c">! Construction number</span>
<a name="ln-5008"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>        <span class="c">! when item is found</span>
<a name="ln-5009"></a>
<a name="ln-5010"></a>  <span class="c">! Warning if window has multiplier &gt; 1 and SolarDistribution = FullExterior or FullInteriorExterior</span>
<a name="ln-5011"></a>
<a name="ln-5012"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5013"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SolarDistribution</span> <span class="o">&gt;</span> <span class="n">MinimalShadowing</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5014"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5015"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: A Multiplier &gt; 1.0 for window/glass door &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5016"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;in conjunction with SolarDistribution = FullExterior or FullInteriorExterior&#39;</span><span class="p">)</span>
<a name="ln-5017"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;can cause inaccurate shadowing on the window and/or&#39;</span><span class="p">)</span>
<a name="ln-5018"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;inaccurate interior solar distribution from the window.&#39;</span><span class="p">)</span>
<a name="ln-5019"></a>    <span class="n">ENDIF</span>
<a name="ln-5020"></a>    <span class="n">TotalMultipliedWindows</span><span class="o">=</span><span class="n">TotalMultipliedWindows</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5021"></a>  <span class="k">END IF</span>
<a name="ln-5022"></a>
<a name="ln-5023"></a>  <span class="c">!  Require that a construction referenced by a surface that is a window</span>
<a name="ln-5024"></a>  <span class="c">!  NOT have a shading device layer; use WindowShadingControl to specify a shading device.</span>
<a name="ln-5025"></a>  <span class="n">ConstrNum</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-5026"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ConstrNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5027"></a><span class="k">    </span><span class="n">NumShades</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5028"></a>    <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-5029"></a>      <span class="n">LayerPtr</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5030"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">LayerPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Error is caught already, will terminate later</span>
<a name="ln-5031"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">LayerPtr</span><span class="p">)%</span><span class="n">Group</span><span class="o">==</span><span class="n">Shade</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">LayerPtr</span><span class="p">)%</span><span class="n">Group</span><span class="o">==</span><span class="n">WindowBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5032"></a>         <span class="n">Material</span><span class="p">(</span><span class="n">LayerPtr</span><span class="p">)%</span><span class="n">Group</span><span class="o">==</span><span class="n">Screen</span><span class="p">)</span> <span class="n">NumShades</span> <span class="o">=</span> <span class="n">NumShades</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5033"></a>    <span class="k">END DO</span>
<a name="ln-5034"></a><span class="k">    IF</span><span class="p">(</span><span class="n">NumShades</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5035"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Window &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SubSurfaceName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; must not directly reference&#39;</span><span class="p">)</span>
<a name="ln-5036"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;a Construction (i.e, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SubSurfaceConstruction</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;) with a shading device.&#39;</span><span class="p">)</span>
<a name="ln-5037"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Use WindowProperty:ShadingControl to specify a shading device for a window.&#39;</span><span class="p">)</span>
<a name="ln-5038"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5039"></a>    <span class="k">END IF</span>
<a name="ln-5040"></a><span class="k">  END IF</span>
<a name="ln-5041"></a>
<a name="ln-5042"></a>  <span class="c">! Disallow glass transmittance dirt factor for interior windows and glass doors</span>
<a name="ln-5043"></a>
<a name="ln-5044"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5045"></a>    <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5046"></a><span class="k">    </span><span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-5047"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ConstrNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5048"></a><span class="k">      DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-5049"></a>        <span class="n">LayerPtr</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5050"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">LayerPtr</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">WindowGlass</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">LayerPtr</span><span class="p">)%</span><span class="n">GlassTransDirtFactor</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5051"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Interior Window or GlassDoor &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SubSurfaceName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5052"></a>            <span class="s1">&#39; has a glass layer with&#39;</span><span class="p">)</span>
<a name="ln-5053"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dirt Correction Factor for Solar and Visible Transmittance &lt; 1.0&#39;</span><span class="p">)</span>
<a name="ln-5054"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;A value less than 1.0 for this factor is only allowed for exterior windows and glass doors.&#39;</span><span class="p">)</span>
<a name="ln-5055"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5056"></a>        <span class="k">END IF</span>
<a name="ln-5057"></a><span class="k">      END DO</span>
<a name="ln-5058"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-5059"></a>  <span class="k">END IF</span>
<a name="ln-5060"></a>
<a name="ln-5061"></a>  <span class="c">! If this is a window with a construction from the Window5DataFile, call routine that will</span>
<a name="ln-5062"></a>  <span class="c">! (1) if one glazing system on Data File, give warning message if window height or width</span>
<a name="ln-5063"></a>  <span class="c">!     differ by more than 10% from those of the glazing system on the Data File;</span>
<a name="ln-5064"></a>  <span class="c">! (2) if two glazing systems (separated by a mullion) on Data File, create a second window</span>
<a name="ln-5065"></a>  <span class="c">!     and adjust the dimensions of the original and second windows to those on the Data File</span>
<a name="ln-5066"></a>
<a name="ln-5067"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5068"></a>
<a name="ln-5069"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">FromWindow5DataFile</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5070"></a>
<a name="ln-5071"></a><span class="k">      CALL </span><span class="n">ModifyWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-5072"></a>
<a name="ln-5073"></a>    <span class="k">ELSE</span>
<a name="ln-5074"></a>         <span class="c">! Calculate net area for base surface (note that ModifyWindow, above, adjusts net area of</span>
<a name="ln-5075"></a>         <span class="c">! base surface for case where window construction is from Window5 Data File</span>
<a name="ln-5076"></a>         <span class="c">! In case there is in error in this window&#39;s base surface (i.e. none)..</span>
<a name="ln-5077"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5078"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5079"></a>               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5080"></a>
<a name="ln-5081"></a>        <span class="c">! Subtract TDD:DIFFUSER area from other side interzone surface</span>
<a name="ln-5082"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5083"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">/=</span> <span class="s1">&#39;   &#39;</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Base surface is an interzone surface</span>
<a name="ln-5084"></a>
<a name="ln-5085"></a>          <span class="c">! Lookup interzone surface of the base surface</span>
<a name="ln-5086"></a>          <span class="c">! (Interzone surfaces have not been assigned yet, but all base surfaces should already be loaded.)</span>
<a name="ln-5087"></a>          <span class="n">Found</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-5088"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5089"></a>        <span class="k">END IF</span>
<a name="ln-5090"></a>
<a name="ln-5091"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5092"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cRoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Surface Openings have too much area for base surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5093"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5094"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Opening Surface creating error=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5095"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5096"></a>        <span class="n">ENDIF</span>
<a name="ln-5097"></a>           <span class="c">! Net area of base surface with unity window multipliers (used in shadowing checks)</span>
<a name="ln-5098"></a>           <span class="c">! For Windows, Glass Doors and Doors, just one area is subtracted.  For the rest, should be</span>
<a name="ln-5099"></a>           <span class="c">! full area.</span>
<a name="ln-5100"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5101"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5102"></a>              <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">-</span>   <span class="p">&amp;</span>
<a name="ln-5103"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-5104"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Door, TDD:Diffuser, TDD:DOME</span>
<a name="ln-5105"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5106"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">-</span>   <span class="p">&amp;</span>
<a name="ln-5107"></a>               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-5108"></a>        <span class="k">ELSE</span>
<a name="ln-5109"></a><span class="k">          </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5110"></a>             <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5111"></a>        <span class="n">ENDIF</span>
<a name="ln-5112"></a>      <span class="n">ENDIF</span>
<a name="ln-5113"></a>    <span class="n">ENDIF</span>
<a name="ln-5114"></a>  <span class="n">ENDIF</span>
<a name="ln-5115"></a>
<a name="ln-5116"></a>  <span class="k">RETURN</span>
<a name="ln-5117"></a>
<a name="ln-5118"></a><span class="k">END SUBROUTINE </span><span class="n">CheckSubSurfaceMiscellaneous</span>
<a name="ln-5119"></a>
<a name="ln-5120"></a><span class="k">SUBROUTINE </span><span class="n">MakeRelativeRectangularVertices</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">XCoord</span><span class="p">,</span><span class="n">ZCoord</span><span class="p">,</span><span class="n">Length</span><span class="p">,</span><span class="n">Height</span><span class="p">)</span>
<a name="ln-5121"></a>
<a name="ln-5122"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5123"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-5124"></a>          <span class="c">!       DATE WRITTEN   December 2008</span>
<a name="ln-5125"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5126"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5127"></a>
<a name="ln-5128"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5129"></a>          <span class="c">! This routine creates world/3d coordinates for rectangular surfaces using relative X and Z, length &amp; height.</span>
<a name="ln-5130"></a>
<a name="ln-5131"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5132"></a>          <span class="c">! na</span>
<a name="ln-5133"></a>
<a name="ln-5134"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5135"></a>          <span class="c">! na</span>
<a name="ln-5136"></a>
<a name="ln-5137"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5138"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-5139"></a>
<a name="ln-5140"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5141"></a>
<a name="ln-5142"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5143"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSurfNum</span>  <span class="c">! Base surface</span>
<a name="ln-5144"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-5145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XCoord</span>
<a name="ln-5146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZCoord</span>
<a name="ln-5147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Length</span>
<a name="ln-5148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span>
<a name="ln-5149"></a>
<a name="ln-5150"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5151"></a>          <span class="c">! na</span>
<a name="ln-5152"></a>
<a name="ln-5153"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5154"></a>          <span class="c">! na</span>
<a name="ln-5155"></a>
<a name="ln-5156"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5157"></a>          <span class="c">! na</span>
<a name="ln-5158"></a>
<a name="ln-5159"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAzimuth</span>  <span class="c">! Surface Azimuth/Facing (same as Base Surface)</span>
<a name="ln-5161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTilt</span>     <span class="c">! Tilt (same as Base Surface)</span>
<a name="ln-5162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XLLC</span>
<a name="ln-5163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YLLC</span>
<a name="ln-5164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZLLC</span>
<a name="ln-5165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosSurfAzimuth</span>
<a name="ln-5166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinSurfAzimuth</span>
<a name="ln-5167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosSurfTilt</span>
<a name="ln-5168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinSurfTilt</span>
<a name="ln-5169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseCosSurfAzimuth</span>
<a name="ln-5170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSinSurfAzimuth</span>
<a name="ln-5171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseCosSurfTilt</span>
<a name="ln-5172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSinSurfTilt</span>
<a name="ln-5173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XX</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">YY</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-5174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Perimeter</span>
<a name="ln-5175"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-5176"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Vrt</span>
<a name="ln-5177"></a>
<a name="ln-5178"></a>
<a name="ln-5179"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BaseSurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! invalid base surface, don&#39;t bother</span>
<a name="ln-5180"></a>
<a name="ln-5181"></a>  <span class="c">! Tilt and Facing (Azimuth) will be same as the Base Surface</span>
<a name="ln-5182"></a>
<a name="ln-5183"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">Height</span>
<a name="ln-5184"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">Length</span>
<a name="ln-5185"></a>
<a name="ln-5186"></a>  <span class="n">SurfAzimuth</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-5187"></a>  <span class="n">SurfTilt</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-5188"></a>  <span class="n">CosSurfAzimuth</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfAzimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5189"></a>  <span class="n">SinSurfAzimuth</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfAzimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5190"></a>  <span class="n">CosSurfTilt</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5191"></a>  <span class="n">SinSurfTilt</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5192"></a>  <span class="n">BaseCosSurfAzimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosAzim</span>
<a name="ln-5193"></a>  <span class="n">BaseSinSurfAzimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinAzim</span>
<a name="ln-5194"></a>  <span class="n">BaseCosSurfTilt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosTilt</span>
<a name="ln-5195"></a>  <span class="n">BaseSinSurfTilt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-5196"></a>
<a name="ln-5197"></a>  <span class="n">XLLC</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span><span class="o">-</span><span class="n">XCoord</span><span class="o">*</span><span class="n">BaseCosSurfAzimuth</span><span class="o">-</span><span class="n">ZCoord</span><span class="o">*</span><span class="n">BaseCosSurfTilt</span><span class="o">*</span><span class="n">BaseSinSurfAzimuth</span>
<a name="ln-5198"></a>  <span class="n">YLLC</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span><span class="o">+</span><span class="n">XCoord</span><span class="o">*</span><span class="n">BaseSinSurfAzimuth</span><span class="o">-</span><span class="n">ZCoord</span><span class="o">*</span><span class="n">BaseCosSurfTilt</span><span class="o">*</span><span class="n">BaseCosSurfAzimuth</span>
<a name="ln-5199"></a>  <span class="n">ZLLC</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span><span class="o">+</span><span class="n">ZCoord</span><span class="o">*</span><span class="n">BaseSinSurfTilt</span>
<a name="ln-5200"></a>
<a name="ln-5201"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5202"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5203"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">Length</span>
<a name="ln-5204"></a>  <span class="n">XX</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">Length</span>
<a name="ln-5205"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Height</span>
<a name="ln-5206"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">Height</span>
<a name="ln-5207"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5208"></a>  <span class="n">YY</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5209"></a>
<a name="ln-5210"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-5211"></a>    <span class="n">Vrt</span><span class="o">=</span><span class="n">N</span>
<a name="ln-5212"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">X</span><span class="o">=</span><span class="n">XLLC</span><span class="o">-</span><span class="n">XX</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">CosSurfAzimuth</span><span class="o">-</span><span class="n">YY</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">CosSurfTilt</span><span class="o">*</span><span class="n">SinSurfAzimuth</span>
<a name="ln-5213"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">Y</span><span class="o">=</span><span class="n">YLLC</span><span class="o">+</span><span class="n">XX</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">SinSurfAzimuth</span><span class="o">-</span><span class="n">YY</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">CosSurfTilt</span><span class="o">*</span><span class="n">CosSurfAzimuth</span>
<a name="ln-5214"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">Z</span><span class="o">=</span><span class="n">ZLLC</span><span class="o">+</span><span class="n">YY</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">SinSurfTilt</span>
<a name="ln-5215"></a>  <span class="k">END DO</span>
<a name="ln-5216"></a>
<a name="ln-5217"></a><span class="k">  CALL </span><span class="n">CreateNewellAreaVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-5218"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-5219"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-5220"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5221"></a>  <span class="k">CALL </span><span class="n">CreateNewellSurfaceNormalVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5222"></a>     <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-5223"></a>  <span class="k">CALL </span><span class="n">DetermineAzimuthAndTilt</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfAzimuth</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5224"></a>                               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5225"></a>                               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-5226"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfAzimuth</span>
<a name="ln-5227"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">SurfTilt</span>
<a name="ln-5228"></a>  <span class="c">! Sine and cosine of azimuth and tilt</span>
<a name="ln-5229"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span> <span class="o">=</span> <span class="n">SinSurfAzimuth</span>
<a name="ln-5230"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">=</span> <span class="n">CosSurfAzimuth</span>
<a name="ln-5231"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span> <span class="o">=</span> <span class="n">SinSurfTilt</span>
<a name="ln-5232"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">=</span> <span class="n">CosSurfTilt</span>
<a name="ln-5233"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5234"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5235"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-5236"></a>  <span class="c">! Outward normal unit vector (pointing away from room)</span>
<a name="ln-5237"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span>
<a name="ln-5238"></a>  <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-5239"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-5240"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-5241"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>     <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-5242"></a>  <span class="n">ENDDO</span>
<a name="ln-5243"></a>
<a name="ln-5244"></a><span class="c">!  IF (SurfaceTmp(SurfNum)%Class == SurfaceClass_Roof .and. SurfTilt &gt; 80.) THEN</span>
<a name="ln-5245"></a><span class="c">!    WRITE(TiltString,&#39;(F5.1)&#39;) SurfTilt</span>
<a name="ln-5246"></a><span class="c">!    TiltString=ADJUSTL(TiltString)</span>
<a name="ln-5247"></a><span class="c">!    CALL ShowWarningError(&#39;Roof/Ceiling Tilt=&#39;//TRIM(TiltString)//&#39;, much greater than expected tilt of 0,&#39;// &amp;</span>
<a name="ln-5248"></a><span class="c">!                          &#39; for Surface=&#39;//TRIM(SurfaceTmp(SurfNum)%Name)//  &amp;</span>
<a name="ln-5249"></a><span class="c">!                          &#39;, in Zone=&#39;//TRIM(SurfaceTmp(SurfNum)%ZoneName))</span>
<a name="ln-5250"></a><span class="c">!  ENDIF</span>
<a name="ln-5251"></a><span class="c">!  IF (SurfaceTmp(SurfNum)%Class == SurfaceClass_Floor .and. SurfTilt &lt; 170.) THEN</span>
<a name="ln-5252"></a><span class="c">!    WRITE(TiltString,&#39;(F5.1)&#39;) SurfTilt</span>
<a name="ln-5253"></a><span class="c">!    TiltString=ADJUSTL(TiltString)</span>
<a name="ln-5254"></a><span class="c">!    CALL ShowWarningError(&#39;Floor Tilt=&#39;//TRIM(TiltString)//&#39;, much less than expected tilt of 180,&#39;//   &amp;</span>
<a name="ln-5255"></a><span class="c">!                          &#39; for Surface=&#39;//TRIM(SurfaceTmp(SurfNum)%Name)//  &amp;</span>
<a name="ln-5256"></a><span class="c">!                          &#39;, in Zone=&#39;//TRIM(SurfaceTmp(SurfNum)%ZoneName))</span>
<a name="ln-5257"></a><span class="c">!  ENDIF</span>
<a name="ln-5258"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5259"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5260"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-5261"></a>  <span class="c">! Can perform tests on this surface here</span>
<a name="ln-5262"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="o">=</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-5263"></a>  <span class="c">! The following IR view factors are modified in subr. SkyDifSolarShading if there are shadowing</span>
<a name="ln-5264"></a>  <span class="c">! surfaces</span>
<a name="ln-5265"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-5266"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-5267"></a>
<a name="ln-5268"></a>  <span class="n">Perimeter</span><span class="o">=</span><span class="n">Distance</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5269"></a>  <span class="k">DO </span><span class="n">Vrt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-5270"></a>    <span class="n">Perimeter</span> <span class="o">=</span> <span class="n">Perimeter</span><span class="o">+</span><span class="n">Distance</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5271"></a>  <span class="n">ENDDO</span>
<a name="ln-5272"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span><span class="o">=</span><span class="n">Perimeter</span>
<a name="ln-5273"></a>
<a name="ln-5274"></a>  <span class="c">! Call to transform vertices</span>
<a name="ln-5275"></a>
<a name="ln-5276"></a>  <span class="k">Call </span><span class="n">TransformVertsByAspect</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-5277"></a>
<a name="ln-5278"></a>  <span class="k">RETURN</span>
<a name="ln-5279"></a>
<a name="ln-5280"></a><span class="k">END SUBROUTINE </span><span class="n">MakeRelativeRectangularVertices</span>
<a name="ln-5281"></a>
<a name="ln-5282"></a><span class="k">SUBROUTINE </span><span class="n">GetAttShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotShdSubs</span><span class="p">)</span>
<a name="ln-5283"></a>
<a name="ln-5284"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5285"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-5286"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-5287"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5288"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5289"></a>
<a name="ln-5290"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5291"></a>          <span class="c">! This subroutine gets the HeatTransfer Surface Data,</span>
<a name="ln-5292"></a>          <span class="c">! checks it for errors, etc.</span>
<a name="ln-5293"></a>
<a name="ln-5294"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5295"></a>          <span class="c">! na</span>
<a name="ln-5296"></a>
<a name="ln-5297"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5298"></a>  <span class="c">!  Attached Shading Surface Definition</span>
<a name="ln-5299"></a>  <span class="c">!Surface:Shading:Attached,</span>
<a name="ln-5300"></a>  <span class="c">!       \memo used For fins, overhangs, elements that shade the building, are attached to the building</span>
<a name="ln-5301"></a>  <span class="c">!       \memo but are not part of the heat transfer calculations</span>
<a name="ln-5302"></a>  <span class="c">!  A1 , \field User Supplied Surface Name</span>
<a name="ln-5303"></a>  <span class="c">!       \required-field</span>
<a name="ln-5304"></a>  <span class="c">!       \type alpha</span>
<a name="ln-5305"></a>  <span class="c">!       \reference AttachedShadingSurfNames</span>
<a name="ln-5306"></a>  <span class="c">!  A2 , \field Base Surface Name</span>
<a name="ln-5307"></a>  <span class="c">!       \required-field</span>
<a name="ln-5308"></a>  <span class="c">!       \type object-list</span>
<a name="ln-5309"></a>  <span class="c">!       \object-list SurfaceNames</span>
<a name="ln-5310"></a>  <span class="c">!  A3,  \field TransSchedShadowSurf</span>
<a name="ln-5311"></a>  <span class="c">!       \note Transmittance schedule for the shading device, defaults to zero (always opaque)</span>
<a name="ln-5312"></a>  <span class="c">!       \type object-list</span>
<a name="ln-5313"></a>  <span class="c">!       \object-list ScheduleNames</span>
<a name="ln-5314"></a>  <span class="c">!  N1 , \field Number of Surface Vertex Groups -- Number of (X,Y,Z) groups in this surface</span>
<a name="ln-5315"></a>  <span class="c">!       \required-field</span>
<a name="ln-5316"></a>  <span class="c">!       \note currently limited 3 or 4, later?</span>
<a name="ln-5317"></a>  <span class="c">!       \minimum 3</span>
<a name="ln-5318"></a>  <span class="c">!       \maximum 4</span>
<a name="ln-5319"></a>  <span class="c">!       \note vertices are given in SurfaceGeometry coordinates -- if relative, all surface coordinates</span>
<a name="ln-5320"></a>  <span class="c">!       \note are &quot;relative&quot; to the Zone Origin.  if WCS, then building and zone origins are used</span>
<a name="ln-5321"></a>  <span class="c">!       \note for some internal calculations, but all coordinates are given in an &quot;absolute&quot; system.</span>
<a name="ln-5322"></a>  <span class="c">!  N2,  \field Vertex 1 X-coordinate</span>
<a name="ln-5323"></a>  <span class="c">!       \units m</span>
<a name="ln-5324"></a>  <span class="c">!       \type real</span>
<a name="ln-5325"></a>  <span class="c">!  N3-13; as indicated by the N2 value</span>
<a name="ln-5326"></a>
<a name="ln-5327"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5328"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-5329"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-5330"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span><span class="p">,</span><span class="n">CheckScheduleValueMinMax</span><span class="p">,</span><span class="n">GetScheduleMinValue</span><span class="p">,</span><span class="n">GetScheduleMaxValue</span>
<a name="ln-5331"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-5332"></a>  <span class="k">USE </span><span class="n">DataReportingFlags</span>
<a name="ln-5333"></a>
<a name="ln-5334"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5335"></a>
<a name="ln-5336"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5337"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-5338"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-5339"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TotShdSubs</span>        <span class="c">! Number of Attached Shading SubSurfaces to obtain</span>
<a name="ln-5340"></a>
<a name="ln-5341"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5342"></a>          <span class="c">! na</span>
<a name="ln-5343"></a>
<a name="ln-5344"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5345"></a>          <span class="c">! na</span>
<a name="ln-5346"></a>
<a name="ln-5347"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5348"></a>          <span class="c">! na</span>
<a name="ln-5349"></a>
<a name="ln-5350"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5351"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-5352"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>         <span class="c">! Number of alpha names being passed</span>
<a name="ln-5353"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>        <span class="c">! Number of properties being passed</span>
<a name="ln-5354"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>             <span class="c">! For matching interzone surfaces</span>
<a name="ln-5355"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-5356"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-5357"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-5358"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SchedMinValue</span>
<a name="ln-5359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SchedMaxValue</span>
<a name="ln-5360"></a>
<a name="ln-5361"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotShdSubs</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5362"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Shading effects of Fins and Overhangs are ignored when Solar Distribution = MinimalShadowing&#39;</span><span class="p">)</span>
<a name="ln-5363"></a>  <span class="n">ENDIF</span>
<a name="ln-5364"></a>
<a name="ln-5365"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Shading:Zone:Detailed&#39;</span>
<a name="ln-5366"></a>  <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-5367"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">/=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5368"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5369"></a>                         <span class="s1">&#39;not = 3 Alpha Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5370"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumAlphas</span><span class="p">)))</span>
<a name="ln-5371"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5372"></a>  <span class="n">ENDIF</span>
<a name="ln-5373"></a>
<a name="ln-5374"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotShdSubs</span>
<a name="ln-5375"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5376"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5377"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5378"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-5379"></a>    <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5380"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5381"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-5382"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5383"></a><span class="k">      CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-5384"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5385"></a>      <span class="k">CYCLE</span>
<a name="ln-5386"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-5387"></a>
<a name="ln-5388"></a>    <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5389"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-5390"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span> <span class="n">SurfaceClass_Shading</span>
<a name="ln-5391"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5392"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5393"></a>    <span class="c">!  The subsurface inherits properties from the base surface</span>
<a name="ln-5394"></a>    <span class="c">!  Exterior conditions, Zone, etc.</span>
<a name="ln-5395"></a>    <span class="c">!  We can figure out the base surface though, because they&#39;ve all been entered</span>
<a name="ln-5396"></a>    <span class="n">Found</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-5397"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5398"></a>      <span class="c">!SurfaceTmp(SurfNum)%BaseSurf=Found</span>
<a name="ln-5399"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-5400"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-5401"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-5402"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span> <span class="c">! Necessary to do relative coordinates in GetVertices below</span>
<a name="ln-5403"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span> <span class="c">! Necessary to have surface drawn in OutputReports</span>
<a name="ln-5404"></a>    <span class="k">ELSE</span>
<a name="ln-5405"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5406"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5407"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5408"></a>    <span class="n">ENDIF</span>
<a name="ln-5409"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnenteredAdjacentZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5410"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5411"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5412"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...trying to attach a shading device to an interzone surface.&#39;</span><span class="p">)</span>
<a name="ln-5413"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5414"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>  <span class="c">! reset so program won&#39;t crash during &quot;add surfaces&quot;</span>
<a name="ln-5415"></a>    <span class="n">ENDIF</span>
<a name="ln-5416"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5417"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5418"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5419"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...trying to attach a shading device to an interior surface.&#39;</span><span class="p">)</span>
<a name="ln-5420"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5421"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>  <span class="c">! reset so program won&#39;t crash during &quot;add surfaces&quot;</span>
<a name="ln-5422"></a>    <span class="n">ENDIF</span>
<a name="ln-5423"></a>
<a name="ln-5424"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5425"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-5426"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5427"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5428"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-5429"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5430"></a>      <span class="n">ENDIF</span>
<a name="ln-5431"></a>    <span class="k">ELSE</span>
<a name="ln-5432"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5433"></a>    <span class="n">ENDIF</span>
<a name="ln-5434"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5435"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5436"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5437"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5438"></a>                             <span class="s1">&#39;&quot;, values not in range [0,1].&#39;</span><span class="p">)</span>
<a name="ln-5439"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5440"></a>      <span class="n">ENDIF</span>
<a name="ln-5441"></a>      <span class="n">SchedMinValue</span><span class="o">=</span><span class="n">GetScheduleMinValue</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">)</span>
<a name="ln-5442"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMinValue</span><span class="o">=</span><span class="n">SchedMinValue</span>
<a name="ln-5443"></a>      <span class="n">SchedMaxValue</span><span class="o">=</span><span class="n">GetScheduleMaxValue</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">)</span>
<a name="ln-5444"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SchedMinValue</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5445"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5446"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5447"></a>                             <span class="s1">&#39;&quot;, is always transparent.&#39;</span><span class="p">)</span>
<a name="ln-5448"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IsTransparent</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5449"></a>      <span class="n">ENDIF</span>
<a name="ln-5450"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SchedMinValue</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5451"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5452"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5453"></a>                             <span class="s1">&#39;&quot;, has schedule values &lt; 0.&#39;</span><span class="p">)</span>
<a name="ln-5454"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Schedule values &lt; 0 have no meaning for shading elements.&#39;</span><span class="p">)</span>
<a name="ln-5455"></a>      <span class="n">ENDIF</span>
<a name="ln-5456"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SchedMaxValue</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5457"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5458"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5459"></a>                             <span class="s1">&#39;&quot;, has schedule values &gt; 1.&#39;</span><span class="p">)</span>
<a name="ln-5460"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Schedule values &gt; 1 have no meaning for shading elements.&#39;</span><span class="p">)</span>
<a name="ln-5461"></a>      <span class="n">ENDIF</span>
<a name="ln-5462"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SchedMinValue</span><span class="o">-</span><span class="n">SchedMaxValue</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5463"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfSchedVaries</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5464"></a>        <span class="n">ShadingTransmittanceVaries</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5465"></a>      <span class="n">ENDIF</span>
<a name="ln-5466"></a>    <span class="n">ENDIF</span>
<a name="ln-5467"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5468"></a><span class="k">      </span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-5469"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5470"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5471"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5472"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-5473"></a>                              <span class="s1">&#39; not even multiple of 3. Will read in &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5474"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-5475"></a>      <span class="n">ENDIF</span>
<a name="ln-5476"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5477"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5478"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (autocalculate) must be &gt;= 3. Only &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5479"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; provided.&#39;</span><span class="p">)</span>
<a name="ln-5480"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5481"></a>        <span class="k">CYCLE</span>
<a name="ln-5482"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-5483"></a>    <span class="k">ELSE</span>
<a name="ln-5484"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5485"></a>    <span class="n">ENDIF</span>
<a name="ln-5486"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-5487"></a>    <span class="k">CALL </span><span class="n">GetVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">:))</span>
<a name="ln-5488"></a>    <span class="k">CALL </span><span class="n">CheckConvexity</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-5489"></a><span class="c">!    IF (SurfaceTmp(SurfNum)%Sides == 3) THEN</span>
<a name="ln-5490"></a><span class="c">!      CALL ShowWarningError(TRIM(cCurrentModuleObject)//&#39;=&quot;&#39;//TRIM(SurfaceTmp(SurfNum)%Name)//  &amp;</span>
<a name="ln-5491"></a><span class="c">!                        &#39; should not be triangular.&#39;)</span>
<a name="ln-5492"></a><span class="c">!      CALL ShowContinueError(&#39;...Check results carefully.&#39;)</span>
<a name="ln-5493"></a><span class="c">!      ErrorsFound=.true.</span>
<a name="ln-5494"></a><span class="c">!    ENDIF</span>
<a name="ln-5495"></a>    <span class="c">! Reset surface to be &quot;detached&quot;</span>
<a name="ln-5496"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5497"></a><span class="c">!    SurfaceTmp(SurfNum)%BaseSurfName=&#39;  &#39;</span>
<a name="ln-5498"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5499"></a>    <span class="c">!SurfaceTmp(SurfNum)%ZoneName=&#39;  &#39;</span>
<a name="ln-5500"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MakeMirroredAttachedShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5501"></a><span class="k">      CALL </span><span class="n">MakeMirrorSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-5502"></a>    <span class="k">END IF</span>
<a name="ln-5503"></a>
<a name="ln-5504"></a><span class="k">  </span><span class="n">ENDDO</span>
<a name="ln-5505"></a>
<a name="ln-5506"></a>  <span class="k">RETURN</span>
<a name="ln-5507"></a>
<a name="ln-5508"></a><span class="k">END SUBROUTINE </span><span class="n">GetAttShdSurfaceData</span>
<a name="ln-5509"></a>
<a name="ln-5510"></a><span class="k">SUBROUTINE </span><span class="n">GetSimpleShdSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotOverhangs</span><span class="p">,</span><span class="n">TotOverhangsProjection</span><span class="p">,</span><span class="n">TotFins</span><span class="p">,</span><span class="n">TotFinsProjection</span><span class="p">)</span>
<a name="ln-5511"></a>
<a name="ln-5512"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5513"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-5514"></a>          <span class="c">!       DATE WRITTEN   January 2009</span>
<a name="ln-5515"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5516"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5517"></a>
<a name="ln-5518"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5519"></a>          <span class="c">! Get simple overhang and fin descriptions.</span>
<a name="ln-5520"></a>
<a name="ln-5521"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5522"></a>          <span class="c">! na</span>
<a name="ln-5523"></a>
<a name="ln-5524"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5525"></a>          <span class="c">! na</span>
<a name="ln-5526"></a>
<a name="ln-5527"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5528"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-5529"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-5530"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-5531"></a>  <span class="k">USE </span><span class="n">DataReportingFlags</span>
<a name="ln-5532"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-5533"></a>
<a name="ln-5534"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5535"></a>
<a name="ln-5536"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5537"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-5538"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-5539"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotOverhangs</span>      <span class="c">! Number of Overhangs to obtain</span>
<a name="ln-5540"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotOverhangsProjection</span>  <span class="c">! Number of Overhangs (projection) to obtain</span>
<a name="ln-5541"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotFins</span>           <span class="c">! Number of Fins to obtain</span>
<a name="ln-5542"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">TotFinsProjection</span> <span class="c">! Number of Fins (projection) to obtain</span>
<a name="ln-5543"></a>
<a name="ln-5544"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5545"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cModuleObjects</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5546"></a>    <span class="p">(</span><span class="o">/</span><span class="s1">&#39;Shading:Overhang           &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5547"></a>      <span class="s1">&#39;Shading:Overhang:Projection&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5548"></a>      <span class="s1">&#39;Shading:Fin                &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5549"></a>      <span class="s1">&#39;Shading:Fin:Projection     &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-5550"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">dfmt</span><span class="o">=</span><span class="s1">&#39;(A,3(2x,f6.2))&#39;</span>
<a name="ln-5551"></a>
<a name="ln-5552"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5553"></a>          <span class="c">! na</span>
<a name="ln-5554"></a>
<a name="ln-5555"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5556"></a>          <span class="c">! na</span>
<a name="ln-5557"></a>
<a name="ln-5558"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5559"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-5560"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ItemsToGet</span>
<a name="ln-5561"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-5562"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-5563"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>
<a name="ln-5564"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-5565"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>             <span class="c">! For matching base surfaces</span>
<a name="ln-5566"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-5567"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-5568"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Depth</span>
<a name="ln-5569"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Length</span>
<a name="ln-5570"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xp</span>
<a name="ln-5571"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Yp</span>
<a name="ln-5572"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Zp</span>
<a name="ln-5573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XLLC</span>
<a name="ln-5574"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YLLC</span>
<a name="ln-5575"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BaseSurfNum</span>
<a name="ln-5576"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TiltAngle</span>
<a name="ln-5577"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">MakeFin</span>
<a name="ln-5578"></a>
<a name="ln-5579"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">TotOverhangs</span><span class="o">+</span><span class="n">TotOverhangsProjection</span><span class="o">+</span><span class="n">TotFins</span><span class="o">+</span><span class="n">TotFinsProjection</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5580"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Shading effects of Fins and Overhangs are ignored when Solar Distribution = MinimalShadowing&#39;</span><span class="p">)</span>
<a name="ln-5581"></a>  <span class="n">ENDIF</span>
<a name="ln-5582"></a>
<a name="ln-5583"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-5584"></a>
<a name="ln-5585"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="n">cModuleObjects</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span>
<a name="ln-5586"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5587"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotOverhangs</span>
<a name="ln-5588"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5589"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotOverhangsProjection</span>
<a name="ln-5590"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5591"></a><span class="k">      </span><span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotFins</span>
<a name="ln-5592"></a>    <span class="k">ELSE</span>  <span class="c">! ! (Item == 4) THEN</span>
<a name="ln-5593"></a>      <span class="n">ItemsToGet</span><span class="o">=</span><span class="n">TotFinsProjection</span>
<a name="ln-5594"></a>    <span class="n">ENDIF</span>
<a name="ln-5595"></a>
<a name="ln-5596"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ItemsToGet</span>
<a name="ln-5597"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5598"></a>                     <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5599"></a>                     <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-5600"></a>      <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5601"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5602"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-5603"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5604"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-5605"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5606"></a>        <span class="k">CYCLE</span>
<a name="ln-5607"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-5608"></a>
<a name="ln-5609"></a>      <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5610"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-5611"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span> <span class="n">SurfaceClass_Shading</span>
<a name="ln-5612"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5613"></a>      <span class="c">! this object references a window or door....</span>
<a name="ln-5614"></a>      <span class="n">Found</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-5615"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5616"></a><span class="k">        </span><span class="n">BaseSurfNum</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-5617"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">BaseSurfName</span>
<a name="ln-5618"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-5619"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-5620"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-5621"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span> <span class="c">! Necessary to do relative coordinates in GetVertices below</span>
<a name="ln-5622"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span> <span class="c">! Necessary to have surface drawn in OutputReports</span>
<a name="ln-5623"></a>      <span class="k">ELSE</span>
<a name="ln-5624"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5625"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5626"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5627"></a>        <span class="k">CYCLE</span>
<a name="ln-5628"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-5629"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnenteredAdjacentZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5630"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5631"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5632"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...trying to attach a shading device to an interzone surface.&#39;</span><span class="p">)</span>
<a name="ln-5633"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5634"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>  <span class="c">! reset so program won&#39;t crash during &quot;add surfaces&quot;</span>
<a name="ln-5635"></a>      <span class="n">ENDIF</span>
<a name="ln-5636"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">UnreconciledZoneSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5637"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5638"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5639"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...trying to attach a shading device to an interior surface.&#39;</span><span class="p">)</span>
<a name="ln-5640"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5641"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">ExternalEnvironment</span>  <span class="c">! reset so program won&#39;t crash during &quot;add surfaces&quot;</span>
<a name="ln-5642"></a>      <span class="n">ENDIF</span>
<a name="ln-5643"></a>
<a name="ln-5644"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5645"></a>
<a name="ln-5646"></a><span class="c">!===== Overhang =====</span>
<a name="ln-5647"></a>
<a name="ln-5648"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5649"></a>        <span class="c">!  Found is the surface window or door.</span>
<a name="ln-5650"></a>        <span class="c">!   N1,  \field Height above Window or Door</span>
<a name="ln-5651"></a>        <span class="c">!        \units m</span>
<a name="ln-5652"></a>        <span class="c">!   N2,  \field Tilt Angle from Window/Door</span>
<a name="ln-5653"></a>        <span class="c">!        \units deg</span>
<a name="ln-5654"></a>        <span class="c">!        \default 90</span>
<a name="ln-5655"></a>        <span class="c">!        \minimum 0</span>
<a name="ln-5656"></a>        <span class="c">!        \maximum 180</span>
<a name="ln-5657"></a>        <span class="c">!   N3,  \field Left extension from Window/Door Width</span>
<a name="ln-5658"></a>        <span class="c">!        \units m</span>
<a name="ln-5659"></a>        <span class="c">!   N4,  \field Right extension from Window/Door Width</span>
<a name="ln-5660"></a>        <span class="c">!        \note N3 + N4 + Window/Door Width is Overhang Length</span>
<a name="ln-5661"></a>        <span class="c">!        \units m</span>
<a name="ln-5662"></a>        <span class="c">!   N5;  \field Depth</span>
<a name="ln-5663"></a>        <span class="c">!        \units m</span>
<a name="ln-5664"></a>        <span class="c">! for projection option:</span>
<a name="ln-5665"></a>        <span class="c">!   N5;  \field Depth as Fraction of Window/Door Height</span>
<a name="ln-5666"></a>        <span class="c">!        \units m</span>
<a name="ln-5667"></a>        <span class="n">Length</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-5668"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5669"></a><span class="k">          </span><span class="n">Depth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-5670"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5671"></a><span class="k">          </span><span class="n">Depth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-5672"></a>        <span class="n">ENDIF</span>
<a name="ln-5673"></a>
<a name="ln-5674"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Length</span><span class="o">*</span><span class="n">Depth</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5675"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, illegal surface area=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5676"></a>            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Length</span><span class="o">*</span><span class="n">Depth</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]. Surface will NOT be entered.&#39;</span><span class="p">)</span>
<a name="ln-5677"></a>          <span class="k">CYCLE</span>
<a name="ln-5678"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-5679"></a>
<a name="ln-5680"></a>        <span class="n">TiltAngle</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">+</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5681"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">TiltAngle</span>
<a name="ln-5682"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-5683"></a>
<a name="ln-5684"></a>        <span class="c">! Make it relative to surface origin.....</span>
<a name="ln-5685"></a>        <span class="n">Xp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-5686"></a>        <span class="n">Yp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-5687"></a>        <span class="n">Zp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-5688"></a>
<a name="ln-5689"></a>        <span class="n">XLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinAzim</span>
<a name="ln-5690"></a>
<a name="ln-5691"></a>        <span class="n">YLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinAzim</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-5692"></a>           <span class="n">Yp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-5693"></a>
<a name="ln-5694"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-5695"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-5696"></a>
<a name="ln-5697"></a>        <span class="k">CALL </span><span class="n">MakeRelativeRectangularVertices</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5698"></a>                         <span class="n">XLLC</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">YLLC</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Height</span><span class="o">+</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Length</span><span class="p">,</span><span class="n">Depth</span><span class="p">)</span>
<a name="ln-5699"></a>
<a name="ln-5700"></a>
<a name="ln-5701"></a>      <span class="c">! Reset surface to be &quot;detached&quot;</span>
<a name="ln-5702"></a>      <span class="c">!    SurfaceTmp(SurfNum)%BaseSurfName=&#39;  &#39;</span>
<a name="ln-5703"></a>      <span class="c">!    SurfaceTmp(SurfNum)%ZoneName=&#39;  &#39;</span>
<a name="ln-5704"></a>
<a name="ln-5705"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5706"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5707"></a>
<a name="ln-5708"></a>      <span class="c">! and mirror</span>
<a name="ln-5709"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MakeMirroredAttachedShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5710"></a><span class="k">          CALL </span><span class="n">MakeMirrorSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-5711"></a>        <span class="k">END IF</span>
<a name="ln-5712"></a>
<a name="ln-5713"></a><span class="k">      ELSE</span>  <span class="c">! Fins</span>
<a name="ln-5714"></a>
<a name="ln-5715"></a><span class="c">!===== Fins =====</span>
<a name="ln-5716"></a>
<a name="ln-5717"></a><span class="c">!===== Left Fin =====</span>
<a name="ln-5718"></a>
<a name="ln-5719"></a>        <span class="c">!   N1,  \field Left Extension from Window/Door</span>
<a name="ln-5720"></a>        <span class="c">!        \units m</span>
<a name="ln-5721"></a>        <span class="c">!   N2,  \field Left Distance Above Top of Window</span>
<a name="ln-5722"></a>        <span class="c">!        \units m</span>
<a name="ln-5723"></a>        <span class="c">!   N3,  \field Left Distance Below Bottom of Window</span>
<a name="ln-5724"></a>        <span class="c">!        \units m</span>
<a name="ln-5725"></a>        <span class="c">!        \note N2 + N3 + height of Window/Door is height of Fin</span>
<a name="ln-5726"></a>        <span class="c">!   N4,  \field Left Tilt Angle from Window/Door</span>
<a name="ln-5727"></a>        <span class="c">!        \units deg</span>
<a name="ln-5728"></a>        <span class="c">!        \default 90</span>
<a name="ln-5729"></a>        <span class="c">!        \minimum 0</span>
<a name="ln-5730"></a>        <span class="c">!        \maximum 180</span>
<a name="ln-5731"></a>        <span class="c">!   N5,  \field Left Depth</span>
<a name="ln-5732"></a>        <span class="c">!        \units m</span>
<a name="ln-5733"></a>        <span class="c">! for projection option:</span>
<a name="ln-5734"></a>        <span class="c">!   N5,  \field Left Depth as Fraction of Window/Door Width</span>
<a name="ln-5735"></a>        <span class="c">!        \units m</span>
<a name="ln-5736"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Left&#39;</span>
<a name="ln-5737"></a>        <span class="n">Length</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-5738"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5739"></a><span class="k">          </span><span class="n">Depth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-5740"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5741"></a><span class="k">          </span><span class="n">Depth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-5742"></a>        <span class="n">ENDIF</span>
<a name="ln-5743"></a>
<a name="ln-5744"></a>        <span class="n">MakeFin</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5745"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Length</span><span class="o">*</span><span class="n">Depth</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5746"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=Left Fin of &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5747"></a>            <span class="s1">&#39;&quot;, illegal surface area=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5748"></a>            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Length</span><span class="o">*</span><span class="n">Depth</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]. Surface will NOT be entered.&#39;</span><span class="p">)</span>
<a name="ln-5749"></a>          <span class="n">MakeFin</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5750"></a>        <span class="n">ENDIF</span>
<a name="ln-5751"></a>
<a name="ln-5752"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MakeFin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5753"></a><span class="k">          </span><span class="n">TiltAngle</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-5754"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">TiltAngle</span>
<a name="ln-5755"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="p">(</span><span class="mi">18</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-5756"></a>
<a name="ln-5757"></a>          <span class="c">! Make it relative to surface origin.....</span>
<a name="ln-5758"></a>
<a name="ln-5759"></a>          <span class="n">Xp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-5760"></a>          <span class="n">Yp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-5761"></a>          <span class="n">Zp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-5762"></a>
<a name="ln-5763"></a>          <span class="n">XLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinAzim</span>
<a name="ln-5764"></a>
<a name="ln-5765"></a>          <span class="n">YLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinAzim</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-5766"></a>             <span class="n">Yp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-5767"></a>
<a name="ln-5768"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5769"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5770"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5771"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5772"></a>
<a name="ln-5773"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-5774"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-5775"></a>
<a name="ln-5776"></a>          <span class="k">CALL </span><span class="n">MakeRelativeRectangularVertices</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5777"></a>                           <span class="n">XLLC</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">YLLC</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="n">Depth</span><span class="p">,</span><span class="n">Length</span><span class="p">)</span>
<a name="ln-5778"></a>
<a name="ln-5779"></a>        <span class="c">! Reset surface to be &quot;detached&quot;</span>
<a name="ln-5780"></a>        <span class="c">!    SurfaceTmp(SurfNum)%BaseSurfName=&#39;  &#39;</span>
<a name="ln-5781"></a>        <span class="c">!    SurfaceTmp(SurfNum)%ZoneName=&#39;  &#39;</span>
<a name="ln-5782"></a>
<a name="ln-5783"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5784"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5785"></a>
<a name="ln-5786"></a>        <span class="c">! and mirror</span>
<a name="ln-5787"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MakeMirroredAttachedShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5788"></a><span class="k">            CALL </span><span class="n">MakeMirrorSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-5789"></a>          <span class="k">END IF</span>
<a name="ln-5790"></a><span class="k">        ELSE</span>
<a name="ln-5791"></a><span class="k">          </span><span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5792"></a>        <span class="n">ENDIF</span>
<a name="ln-5793"></a>
<a name="ln-5794"></a><span class="c">!===== Right Fin =====</span>
<a name="ln-5795"></a>
<a name="ln-5796"></a>        <span class="c">!   N6,  \field Right Extension from Window/Door</span>
<a name="ln-5797"></a>        <span class="c">!        \units m</span>
<a name="ln-5798"></a>        <span class="c">!   N7,  \field Right Distance Above Top of Window</span>
<a name="ln-5799"></a>        <span class="c">!        \units m</span>
<a name="ln-5800"></a>        <span class="c">!   N8,  \field Right Distance Below Bottom of Window</span>
<a name="ln-5801"></a>        <span class="c">!        \note N7 + N8 + height of Window/Door is height of Fin</span>
<a name="ln-5802"></a>        <span class="c">!        \units m</span>
<a name="ln-5803"></a>        <span class="c">!   N9,  \field Right Tilt Angle from Window/Door</span>
<a name="ln-5804"></a>        <span class="c">!        \units deg</span>
<a name="ln-5805"></a>        <span class="c">!        \default 90</span>
<a name="ln-5806"></a>        <span class="c">!        \minimum 0</span>
<a name="ln-5807"></a>        <span class="c">!        \maximum 180</span>
<a name="ln-5808"></a>        <span class="c">!   N10; \field Right Depth</span>
<a name="ln-5809"></a>        <span class="c">!        \units m</span>
<a name="ln-5810"></a>        <span class="c">! for projection option:</span>
<a name="ln-5811"></a>        <span class="c">!   N10; \field Right Depth as Fraction of Window/Door Width</span>
<a name="ln-5812"></a>        <span class="c">!        \units m</span>
<a name="ln-5813"></a>
<a name="ln-5814"></a>        <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5815"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Right&#39;</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-5816"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span> <span class="n">SurfaceClass_Shading</span>
<a name="ln-5817"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5818"></a>        <span class="n">BaseSurfNum</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-5819"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">BaseSurfName</span>
<a name="ln-5820"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-5821"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-5822"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-5823"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Zone</span> <span class="c">! Necessary to do relative coordinates in GetVertices below</span>
<a name="ln-5824"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ZoneName</span> <span class="c">! Necessary to have surface drawn in OutputReports</span>
<a name="ln-5825"></a>
<a name="ln-5826"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5827"></a>        <span class="n">Length</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-5828"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5829"></a><span class="k">          </span><span class="n">Depth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-5830"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Item</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5831"></a><span class="k">          </span><span class="n">Depth</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-5832"></a>        <span class="n">ENDIF</span>
<a name="ln-5833"></a>
<a name="ln-5834"></a>        <span class="n">MakeFin</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5835"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Length</span><span class="o">*</span><span class="n">Depth</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5836"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=Right Fin of &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5837"></a>            <span class="s1">&#39;&quot;, illegal surface area=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5838"></a>            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Length</span><span class="o">*</span><span class="n">Depth</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]. Surface will NOT be entered.&#39;</span><span class="p">)</span>
<a name="ln-5839"></a>          <span class="n">MakeFin</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5840"></a>        <span class="n">ENDIF</span>
<a name="ln-5841"></a>
<a name="ln-5842"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MakeFin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5843"></a>          <span class="c">! Make it relative to surface origin.....</span>
<a name="ln-5844"></a>
<a name="ln-5845"></a>          <span class="n">Xp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-5846"></a>          <span class="n">Yp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-5847"></a>          <span class="n">Zp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-5848"></a>
<a name="ln-5849"></a>          <span class="n">XLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinAzim</span>
<a name="ln-5850"></a>
<a name="ln-5851"></a>          <span class="n">YLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinAzim</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-5852"></a>              <span class="n">Yp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-5853"></a>
<a name="ln-5854"></a>          <span class="n">TiltAngle</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-5855"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">TiltAngle</span>
<a name="ln-5856"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">-</span><span class="p">(</span><span class="mi">18</span><span class="mf">0.0</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-5857"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5858"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5859"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5860"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-5861"></a>
<a name="ln-5862"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-5863"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-5864"></a>
<a name="ln-5865"></a>          <span class="k">CALL </span><span class="n">MakeRelativeRectangularVertices</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5866"></a>                           <span class="n">XLLC</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Width</span><span class="o">+</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">YLLC</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="o">-</span><span class="n">Depth</span><span class="p">,</span><span class="n">Length</span><span class="p">)</span>
<a name="ln-5867"></a>
<a name="ln-5868"></a>        <span class="c">! Reset surface to be &quot;detached&quot;</span>
<a name="ln-5869"></a>        <span class="c">!    SurfaceTmp(SurfNum)%BaseSurfName=&#39;  &#39;</span>
<a name="ln-5870"></a>        <span class="c">!    SurfaceTmp(SurfNum)%ZoneName=&#39;  &#39;</span>
<a name="ln-5871"></a>
<a name="ln-5872"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5873"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5874"></a>
<a name="ln-5875"></a>        <span class="c">! and mirror</span>
<a name="ln-5876"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MakeMirroredAttachedShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5877"></a><span class="k">            CALL </span><span class="n">MakeMirrorSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-5878"></a>          <span class="k">END IF</span>
<a name="ln-5879"></a><span class="k">        ELSE</span>
<a name="ln-5880"></a><span class="k">          </span><span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5881"></a>        <span class="n">ENDIF</span>
<a name="ln-5882"></a>      <span class="n">ENDIF</span>
<a name="ln-5883"></a>
<a name="ln-5884"></a>    <span class="n">ENDDO</span>
<a name="ln-5885"></a>
<a name="ln-5886"></a>  <span class="n">ENDDO</span>
<a name="ln-5887"></a>
<a name="ln-5888"></a>  <span class="k">RETURN</span>
<a name="ln-5889"></a>
<a name="ln-5890"></a><span class="k">END SUBROUTINE </span><span class="n">GetSimpleShdSurfaceData</span>
<a name="ln-5891"></a>
<a name="ln-5892"></a><span class="k">SUBROUTINE </span><span class="n">GetIntMassSurfaceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TotIntMass</span><span class="p">)</span>
<a name="ln-5893"></a>
<a name="ln-5894"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5895"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-5896"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-5897"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5898"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5899"></a>
<a name="ln-5900"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5901"></a>          <span class="c">! This subroutine gets the Internal Surface Data,</span>
<a name="ln-5902"></a>          <span class="c">! checks it for errors, etc.</span>
<a name="ln-5903"></a>
<a name="ln-5904"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5905"></a>          <span class="c">! na</span>
<a name="ln-5906"></a>
<a name="ln-5907"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5908"></a>  <span class="c">! Internal Mass Surface Definition</span>
<a name="ln-5909"></a>  <span class="c">!Surface:HeatTransfer:InternalMass,</span>
<a name="ln-5910"></a>  <span class="c">!       \note used to describe internal zone surface area that does not need to be part of geometric representation</span>
<a name="ln-5911"></a>  <span class="c">!  A1 , \field User Supplied Surface Name</span>
<a name="ln-5912"></a>  <span class="c">!       \type alpha</span>
<a name="ln-5913"></a>  <span class="c">!       \reference SurfaceNames</span>
<a name="ln-5914"></a>  <span class="c">!  A2 , \field Construction Name of the Surface</span>
<a name="ln-5915"></a>  <span class="c">!       \note To be matched with a construction in this input file</span>
<a name="ln-5916"></a>  <span class="c">!       \type object-list</span>
<a name="ln-5917"></a>  <span class="c">!       \object-list ConstructionNames</span>
<a name="ln-5918"></a>  <span class="c">!  A3 , \field Interior Environment</span>
<a name="ln-5919"></a>  <span class="c">!       \note Zone the surface is a part of</span>
<a name="ln-5920"></a>  <span class="c">!       \type object-list</span>
<a name="ln-5921"></a>  <span class="c">!       \object-list ZoneNames</span>
<a name="ln-5922"></a>  <span class="c">!  N1,  \field View factor to Person (to people?)</span>
<a name="ln-5923"></a>  <span class="c">!       \type real</span>
<a name="ln-5924"></a>  <span class="c">!       \note from the interior of the surface</span>
<a name="ln-5925"></a>  <span class="c">!  N2 ; \field Surface area</span>
<a name="ln-5926"></a>  <span class="c">!       \units m2</span>
<a name="ln-5927"></a>
<a name="ln-5928"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5929"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-5930"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-5931"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-5932"></a>
<a name="ln-5933"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5934"></a>
<a name="ln-5935"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5936"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-5937"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Count of Current SurfaceNumber</span>
<a name="ln-5938"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TotIntMass</span>        <span class="c">! Number of Internal Mass Surfaces to obtain</span>
<a name="ln-5939"></a>
<a name="ln-5940"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5941"></a>          <span class="c">! na</span>
<a name="ln-5942"></a>
<a name="ln-5943"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5944"></a>          <span class="c">! na</span>
<a name="ln-5945"></a>
<a name="ln-5946"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5947"></a>          <span class="c">! na</span>
<a name="ln-5948"></a>
<a name="ln-5949"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5950"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-5951"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceNumAlpha</span>   <span class="c">! Number of material alpha names being passed</span>
<a name="ln-5952"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceNumProp</span>    <span class="c">! Number of material properties being passed</span>
<a name="ln-5953"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>           <span class="c">! DO loop counter (zones)</span>
<a name="ln-5954"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-5955"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-5956"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-5957"></a>
<a name="ln-5958"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;InternalMass&#39;</span>
<a name="ln-5959"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotIntMass</span>
<a name="ln-5960"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">SurfaceNumAlpha</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5961"></a>                   <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">SurfaceNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5962"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5963"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-5964"></a>    <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5965"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5966"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-5967"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5968"></a><span class="k">      CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...each surface name must not duplicate other surface names (of any type)&#39;</span><span class="p">)</span>
<a name="ln-5969"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5970"></a>      <span class="k">CYCLE</span>
<a name="ln-5971"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-5972"></a>
<a name="ln-5973"></a>    <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5974"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Surface Name in the Derived Type</span>
<a name="ln-5975"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span> <span class="n">SurfaceClass_IntMass</span>
<a name="ln-5976"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5977"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-5978"></a>
<a name="ln-5979"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5980"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5981"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5982"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5983"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5984"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5985"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5986"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5987"></a>                             <span class="s1">&#39;&quot; - has Window materials.&#39;</span><span class="p">)</span>
<a name="ln-5988"></a>    <span class="k">ELSE</span>
<a name="ln-5989"></a><span class="k">      </span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5990"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-5991"></a>    <span class="k">END IF</span>
<a name="ln-5992"></a><span class="k">    </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5993"></a>    <span class="n">ZoneNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">,</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-5994"></a>
<a name="ln-5995"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5996"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">=</span> <span class="n">ZoneNum</span>
<a name="ln-5997"></a>    <span class="k">ELSE</span>
<a name="ln-5998"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5999"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6000"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span><span class="o">+</span><span class="mi">100</span>
<a name="ln-6001"></a><span class="c">!      SurfaceTmp(SurfNum)%Class=0</span>
<a name="ln-6002"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="s1">&#39;Unknown Zone&#39;</span>
<a name="ln-6003"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6004"></a>    <span class="n">ENDIF</span>
<a name="ln-6005"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6006"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-6007"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6008"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6009"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-6010"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="mi">9</span><span class="mf">0.d0</span>
<a name="ln-6011"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="mi">9</span><span class="mf">0.d0</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-6012"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="mi">9</span><span class="mf">0.d0</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-6013"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6014"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6015"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6016"></a>    <span class="c">! Outward normal unit vector (pointing away from room)</span>
<a name="ln-6017"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsz</span>
<a name="ln-6018"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="n">d0</span>
<a name="ln-6019"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6020"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6021"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-6022"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-6023"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-6024"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">UnreconciledZoneSurface</span>
<a name="ln-6025"></a>
<a name="ln-6026"></a>  <span class="n">ENDDO</span>
<a name="ln-6027"></a>
<a name="ln-6028"></a>  <span class="k">RETURN</span>
<a name="ln-6029"></a>
<a name="ln-6030"></a><span class="k">END SUBROUTINE </span><span class="n">GetIntMassSurfaceData</span>
<a name="ln-6031"></a>
<a name="ln-6032"></a><span class="k">SUBROUTINE </span><span class="n">GetShadingSurfReflectanceData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6033"></a>
<a name="ln-6034"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6035"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-6036"></a>          <span class="c">!       DATE WRITTEN   Sept 2003</span>
<a name="ln-6037"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6038"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6039"></a>
<a name="ln-6040"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6041"></a>          <span class="c">! Gets data for a Shading Surface Reflectance object.  This is only called when the</span>
<a name="ln-6042"></a>          <span class="c">! Solar Distribution is to be calculated for reflectances.</span>
<a name="ln-6043"></a>
<a name="ln-6044"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-6045"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-6046"></a>
<a name="ln-6047"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6048"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-6049"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span>
<a name="ln-6050"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-6051"></a>
<a name="ln-6052"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6053"></a>
<a name="ln-6054"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6055"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-6056"></a>
<a name="ln-6057"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6058"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmtA</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span>
<a name="ln-6059"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-6060"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-6061"></a>
<a name="ln-6062"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6063"></a>
<a name="ln-6064"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>                   <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-6065"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlpha</span>                 <span class="c">! Number of alpha names being passed</span>
<a name="ln-6066"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumProp</span>                  <span class="c">! Number of properties being passed</span>
<a name="ln-6067"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotShadingSurfaceReflectance</span>  <span class="c">! Total Shading Surface Refleftance statements</span>
<a name="ln-6068"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>                     <span class="c">! DO loop index</span>
<a name="ln-6069"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>                  <span class="c">! Surface number</span>
<a name="ln-6070"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GlConstrNum</span>              <span class="c">! Glazing construction number</span>
<a name="ln-6071"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WrongSurfaceType</span>
<a name="ln-6072"></a>
<a name="ln-6073"></a>  <span class="c">! For shading surfaces, initialize value of reflectance values to default values. These values</span>
<a name="ln-6074"></a>  <span class="c">! may be overridden below for shading surfaces with an associated Shading Surface Reflectance object.</span>
<a name="ln-6075"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-6076"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>      <span class="p">&amp;</span>
<a name="ln-6077"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_F</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6078"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6079"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Overhang</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>     <span class="p">&amp;</span>
<a name="ln-6080"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Fin</span><span class="p">)</span> <span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6081"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseSolRefl</span>  <span class="o">=</span> <span class="mf">0.2d0</span>
<a name="ln-6082"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span>  <span class="o">=</span> <span class="mf">0.2d0</span>
<a name="ln-6083"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6084"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6085"></a>  <span class="k">END DO</span>
<a name="ln-6086"></a>
<a name="ln-6087"></a>  <span class="c">! Get the total number of Shading Surface Reflectance objects</span>
<a name="ln-6088"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;ShadingProperty:Reflectance&#39;</span>
<a name="ln-6089"></a>  <span class="n">TotShadingSurfaceReflectance</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6090"></a><span class="c">!  IF(TotShadingSurfaceReflectance.EQ.0) RETURN</span>
<a name="ln-6091"></a>
<a name="ln-6092"></a>  <span class="k">DO </span><span class="n">Loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotShadingSurfaceReflectance</span>
<a name="ln-6093"></a>
<a name="ln-6094"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6095"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6096"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6097"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-6098"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6099"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6100"></a>                             <span class="s1">&#39;&quot;, invalid specification&#39;</span><span class="p">)</span>
<a name="ln-6101"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6102"></a><span class="c">!      ErrorsFound =.true.</span>
<a name="ln-6103"></a>      <span class="k">CYCLE</span>
<a name="ln-6104"></a><span class="k">    END IF</span>
<a name="ln-6105"></a>
<a name="ln-6106"></a>    <span class="c">! Check that associated surface is a shading surface</span>
<a name="ln-6107"></a>    <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6108"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6109"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>      <span class="p">&amp;</span>
<a name="ln-6110"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_F</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6111"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6112"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Overhang</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>     <span class="p">&amp;</span>
<a name="ln-6113"></a>                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Fin</span><span class="p">)</span> <span class="p">)</span> <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6114"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WrongSurfaceType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6115"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetShadingSurfReflectanceData: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6116"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6117"></a>                  <span class="s1">&#39;&quot;, surface is not a shading surface.&#39;</span><span class="p">)</span>
<a name="ln-6118"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6119"></a>        <span class="k">CYCLE</span>
<a name="ln-6120"></a><span class="k">      END IF</span>
<a name="ln-6121"></a><span class="k">    END IF</span>
<a name="ln-6122"></a>
<a name="ln-6123"></a>    <span class="c">! If associated surface is a shading surface, set reflectance values</span>
<a name="ln-6124"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6125"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseSolRefl</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6126"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6127"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6128"></a><span class="k">      </span><span class="n">GlConstrNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-6129"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">GlConstrNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6130"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6131"></a>                           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6132"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6133"></a>      <span class="k">ELSE</span>
<a name="ln-6134"></a><span class="k">        </span><span class="n">Construct</span><span class="p">(</span><span class="n">GlConstrNum</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6135"></a>      <span class="k">END IF</span>
<a name="ln-6136"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">=</span> <span class="n">GlConstrNum</span>
<a name="ln-6137"></a>    <span class="k">END IF</span>
<a name="ln-6138"></a><span class="k">    </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="s1">&#39;Mir-&#39;</span><span class="o">//</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-6139"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6140"></a><span class="k">    </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6141"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseSolRefl</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6142"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6143"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6144"></a><span class="k">      </span><span class="n">GlConstrNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-6145"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">GlConstrNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6146"></a><span class="k">        </span><span class="n">Construct</span><span class="p">(</span><span class="n">GlConstrNum</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6147"></a>      <span class="k">END IF</span>
<a name="ln-6148"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">=</span> <span class="n">GlConstrNum</span>
<a name="ln-6149"></a>    <span class="k">END IF</span>
<a name="ln-6150"></a>
<a name="ln-6151"></a><span class="k">  END DO</span>  <span class="c">! End of loop over Shading Surface Reflectance objects</span>
<a name="ln-6152"></a>
<a name="ln-6153"></a>  <span class="c">! Write reflectance values to .eio file.</span>
<a name="ln-6154"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;! &lt;ShadingProperty Reflectance&gt;,Shading Surface Name,Shading Type,Diffuse Solar Reflectance, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6155"></a>     <span class="s1">&#39;Diffuse Visible Reflectance,Surface Glazing Fraction,Surface Glazing Contruction&#39;</span>
<a name="ln-6156"></a>
<a name="ln-6157"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-6158"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>      <span class="p">&amp;</span>
<a name="ln-6159"></a>               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_F</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6160"></a>               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6161"></a>               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Overhang</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>     <span class="p">&amp;</span>
<a name="ln-6162"></a>               <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Fin</span><span class="p">)</span> <span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6163"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6164"></a><span class="k">      Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;ShadingProperty Reflectance,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6165"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6166"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseSolRefl</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6167"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6168"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6169"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6170"></a>    <span class="k">ELSE</span>
<a name="ln-6171"></a><span class="k">      Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;ShadingProperty Reflectance,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6172"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6173"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseSolRefl</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6174"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6175"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, N/A&#39;</span>
<a name="ln-6176"></a>    <span class="n">ENDIF</span>
<a name="ln-6177"></a>  <span class="k">END DO</span>
<a name="ln-6178"></a>
<a name="ln-6179"></a>
<a name="ln-6180"></a><span class="k">  RETURN</span>
<a name="ln-6181"></a>
<a name="ln-6182"></a><span class="k">END SUBROUTINE </span><span class="n">GetShadingSurfReflectanceData</span>
<a name="ln-6183"></a>
<a name="ln-6184"></a><span class="k">SUBROUTINE </span><span class="n">GetHTSurfExtVentedCavityData</span><span class="p">(</span><span class="n">ErrorsFound</span> <span class="p">)</span>
<a name="ln-6185"></a>
<a name="ln-6186"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6187"></a>          <span class="c">!       AUTHOR         BGriffith</span>
<a name="ln-6188"></a>          <span class="c">!       DATE WRITTEN   January 2005</span>
<a name="ln-6189"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6190"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6191"></a>
<a name="ln-6192"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6193"></a>          <span class="c">! load input data for Exterior Vented Cavity Special case for heat transfer surfaces</span>
<a name="ln-6194"></a>
<a name="ln-6195"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6196"></a>          <span class="c">! usual E+ input processes</span>
<a name="ln-6197"></a>
<a name="ln-6198"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6199"></a>          <span class="c">! derived from SUBROUTINE GetTranspiredCollectorInput</span>
<a name="ln-6200"></a>
<a name="ln-6201"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6202"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-6203"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span><span class="p">,</span> <span class="n">FindItemInList</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6204"></a>                              <span class="n">SameString</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-6205"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-6206"></a>
<a name="ln-6207"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6208"></a>
<a name="ln-6209"></a>       <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6210"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ErrorsFound</span>       <span class="c">! Error flag indicator (true if errors found)</span>
<a name="ln-6211"></a>
<a name="ln-6212"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6213"></a>          <span class="c">! na</span>
<a name="ln-6214"></a>
<a name="ln-6215"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6216"></a>          <span class="c">! na</span>
<a name="ln-6217"></a>
<a name="ln-6218"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6219"></a>          <span class="c">! na</span>
<a name="ln-6220"></a>
<a name="ln-6221"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6222"></a>
<a name="ln-6223"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">Item</span>    <span class="c">! Item to be &quot;gotten&quot;</span>
<a name="ln-6224"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of Alphas for each GetObjectItem call</span>
<a name="ln-6225"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">NumNumbers</span> <span class="c">! Number of Numbers for each GetObjectItem call</span>
<a name="ln-6226"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">MaxNumAlphas</span> <span class="c">!argument for call to GetObjectDefMaxArgs</span>
<a name="ln-6227"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">MaxNumNumbers</span> <span class="c">!argument for call to GetObjectDefMaxArgs</span>
<a name="ln-6228"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">Dummy</span> <span class="c">!argument for call to GetObjectDefMaxArgs</span>
<a name="ln-6229"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">IOStatus</span>   <span class="c">! Used in GetObjectItem</span>
<a name="ln-6230"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">Found</span>
<a name="ln-6231"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">AlphaOffset</span> <span class="c">!local temp var</span>
<a name="ln-6232"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Roughness</span>
<a name="ln-6233"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">thisSurf</span>  <span class="c">! do loop counter</span>
<a name="ln-6234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">AvgAzimuth</span> <span class="c">! temp for error checking</span>
<a name="ln-6235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">AvgTilt</span>    <span class="c">! temp for error checking</span>
<a name="ln-6236"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">SurfID</span>  <span class="c">! local surface &quot;pointer&quot;</span>
<a name="ln-6237"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-6238"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-6239"></a>
<a name="ln-6240"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceProperty:ExteriorNaturalVentedCavity&#39;</span>
<a name="ln-6241"></a>  <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span> <span class="n">MaxNumAlphas</span><span class="p">,</span><span class="n">MaxNumNumbers</span><span class="p">)</span>
<a name="ln-6242"></a>
<a name="ln-6243"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MaxNumNumbers</span> <span class="o">/=</span> <span class="mi">8</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6244"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Object Definition indicates &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6245"></a>                         <span class="s1">&#39;not = 8 Number Objects, Number Indicated=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6246"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxNumNumbers</span><span class="p">)))</span>
<a name="ln-6247"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6248"></a>  <span class="n">ENDIF</span>
<a name="ln-6249"></a>
<a name="ln-6250"></a>  <span class="n">TotExtVentCav</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6251"></a>
<a name="ln-6252"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">TotExtVentCav</span><span class="p">))</span>
<a name="ln-6253"></a>
<a name="ln-6254"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotExtVentCav</span>
<a name="ln-6255"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6256"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6257"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6258"></a>    <span class="c">! first handle cAlphaArgs</span>
<a name="ln-6259"></a>    <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6260"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6261"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ExtVentedCavity</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">Item</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-6262"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6263"></a><span class="k">      CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...cannot not duplicate other names&#39;</span><span class="p">)</span>
<a name="ln-6264"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6265"></a>      <span class="k">CYCLE</span>
<a name="ln-6266"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-6267"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6268"></a>
<a name="ln-6269"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">OSCMName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6270"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6271"></a><span class="k">      </span><span class="n">Found</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">OSCMName</span><span class="p">,</span><span class="n">OSCM</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotOSCM</span><span class="p">)</span>
<a name="ln-6272"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6273"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6274"></a>                               <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6275"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6276"></a>      <span class="n">ENDIF</span>
<a name="ln-6277"></a>    <span class="k">ELSE</span>
<a name="ln-6278"></a><span class="k">      </span><span class="n">Found</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6279"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6280"></a>                           <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be blank.&#39;</span><span class="p">)</span>
<a name="ln-6281"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6282"></a>    <span class="n">ENDIF</span>
<a name="ln-6283"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">OSCMPtr</span> <span class="o">=</span> <span class="n">Found</span>
<a name="ln-6284"></a>
<a name="ln-6285"></a>    <span class="n">Roughness</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6286"></a>    <span class="c">!Select the correct Number for the associated ascii name for the roughness type</span>
<a name="ln-6287"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span><span class="s1">&#39;VeryRough&#39;</span><span class="p">))</span>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">BaffleRoughness</span><span class="o">=</span><span class="n">VeryRough</span>
<a name="ln-6288"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span><span class="s1">&#39;Rough&#39;</span><span class="p">))</span>        <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">BaffleRoughness</span><span class="o">=</span><span class="n">Rough</span>
<a name="ln-6289"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span><span class="s1">&#39;MediumRough&#39;</span><span class="p">))</span>  <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">BaffleRoughness</span><span class="o">=</span><span class="n">MediumRough</span>
<a name="ln-6290"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span><span class="s1">&#39;MediumSmooth&#39;</span><span class="p">))</span> <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">BaffleRoughness</span><span class="o">=</span><span class="n">MediumSmooth</span>
<a name="ln-6291"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span><span class="s1">&#39;Smooth&#39;</span><span class="p">))</span>       <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">BaffleRoughness</span><span class="o">=</span><span class="n">Smooth</span>
<a name="ln-6292"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span><span class="s1">&#39;VerySmooth&#39;</span><span class="p">))</span>   <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">BaffleRoughness</span><span class="o">=</span><span class="n">VerySmooth</span>
<a name="ln-6293"></a>
<a name="ln-6294"></a>    <span class="c">! Was it set?</span>
<a name="ln-6295"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">BaffleRoughness</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6296"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6297"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6298"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6299"></a>    <span class="n">ENDIF</span>
<a name="ln-6300"></a>
<a name="ln-6301"></a>    <span class="n">AlphaOffset</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-6302"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">NumSurfs</span> <span class="o">=</span> <span class="n">NumAlphas</span> <span class="o">-</span> <span class="n">AlphaOffset</span>
<a name="ln-6303"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">NumSurfs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6304"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6305"></a>                           <span class="s1">&#39;&quot;, no underlying surfaces specified. Must have at least one.&#39;</span><span class="p">)</span>
<a name="ln-6306"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6307"></a>      <span class="k">CYCLE</span>
<a name="ln-6308"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-6309"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">NumSurfs</span><span class="p">))</span>
<a name="ln-6310"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6311"></a>    <span class="k">DO </span><span class="n">thisSurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">NumSurfs</span>
<a name="ln-6312"></a>        <span class="n">Found</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">),</span> <span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-6313"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6314"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6315"></a>                                <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6316"></a>                                <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">)))</span>
<a name="ln-6317"></a>           <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6318"></a>           <span class="k">CYCLE</span>
<a name="ln-6319"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6320"></a>        <span class="c">! check that surface is appropriate, Heat transfer, Sun, Wind,</span>
<a name="ln-6321"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6322"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6323"></a>                                <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6324"></a>                                <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">)))</span>
<a name="ln-6325"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because it is not a Heat Transfer Surface.&#39;</span><span class="p">)</span>
<a name="ln-6326"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6327"></a>            <span class="k">CYCLE</span>
<a name="ln-6328"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6329"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">surface</span><span class="p">(</span><span class="n">found</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6330"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6331"></a>                                <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6332"></a>                                <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">)))</span>
<a name="ln-6333"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because it is not exposed to Sun.&#39;</span><span class="p">)</span>
<a name="ln-6334"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6335"></a>            <span class="k">CYCLE</span>
<a name="ln-6336"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6337"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">surface</span><span class="p">(</span><span class="n">found</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6338"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6339"></a>                                <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6340"></a>                                <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">)))</span>
<a name="ln-6341"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because it is not exposed to Wind.&#39;</span><span class="p">)</span>
<a name="ln-6342"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6343"></a>            <span class="k">CYCLE</span>
<a name="ln-6344"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6345"></a>        <span class="k">If</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">found</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6346"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6347"></a>                                <span class="s1">&#39;&quot;, is invalid&#39;</span><span class="p">)</span>
<a name="ln-6348"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6349"></a>                                <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">thisSurf</span> <span class="o">+</span> <span class="n">AlphaOffset</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6350"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...is not an OtherSideConditionedModel surface.&#39;</span><span class="p">)</span>
<a name="ln-6351"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6352"></a>            <span class="k">CYCLE</span>
<a name="ln-6353"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6354"></a>        <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">Found</span>
<a name="ln-6355"></a>
<a name="ln-6356"></a>        <span class="c">! now set info in Surface structure</span>
<a name="ln-6357"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtCavNum</span>        <span class="o">=</span> <span class="n">Item</span>
<a name="ln-6358"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtCavityPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6359"></a>
<a name="ln-6360"></a>    <span class="n">ENDDO</span>
<a name="ln-6361"></a>
<a name="ln-6362"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! previous inner do loop may have detected problems that need to be cycle&#39;d again to avoid crash</span>
<a name="ln-6363"></a>
<a name="ln-6364"></a>    <span class="c">! now that we should have all the surfaces, do some preperations and checks.</span>
<a name="ln-6365"></a>
<a name="ln-6366"></a>    <span class="c">! are they all similar tilt and azimuth? Issue warnings so people can do it if they really want</span>
<a name="ln-6367"></a>    <span class="n">AvgAzimuth</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6368"></a>                <span class="o">/</span><span class="nb">SUM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-6369"></a>    <span class="n">AvgTilt</span>    <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6370"></a>                <span class="o">/</span><span class="nb">SUM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-6371"></a>    <span class="k">DO </span><span class="n">thisSurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">NumSurfs</span>
<a name="ln-6372"></a>       <span class="n">SurfID</span> <span class="o">=</span> <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)</span>
<a name="ln-6373"></a>       <span class="k">If</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfID</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">-</span> <span class="n">AvgAzimuth</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-6374"></a><span class="k">            Call </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6375"></a>            <span class="s1">&#39;, Surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfID</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; has Azimuth different from others in &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6376"></a>            <span class="s1">&#39;the associated group.&#39;</span><span class="p">)</span>
<a name="ln-6377"></a>       <span class="n">ENDIF</span>
<a name="ln-6378"></a>       <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfID</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">-</span> <span class="n">AvgTilt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="mf">0.d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-6379"></a><span class="k">            Call </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6380"></a>            <span class="s1">&#39;, Surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfID</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; has Tilt different from others in &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6381"></a>            <span class="s1">&#39;the associated group.&#39;</span><span class="p">)</span>
<a name="ln-6382"></a>       <span class="n">ENDIF</span>
<a name="ln-6383"></a>
<a name="ln-6384"></a>       <span class="c">!test that there are no windows.  Now allow windows</span>
<a name="ln-6385"></a>      <span class="c">! If (Surface(SurfID)%GrossArea &gt;  Surface(SurfID)%Area) Then</span>
<a name="ln-6386"></a>      <span class="c">!      Call ShowWarningError(&#39;Surface &#39;//TRIM(Surface(SurfID)%name)//&#39; has a subsurface whose area is not being &#39; &amp;</span>
<a name="ln-6387"></a>      <span class="c">!         //&#39;subtracted in the group of surfaces associated with &#39;//TRIM(ExtVentedCavity(Item)%Name))</span>
<a name="ln-6388"></a>      <span class="c">! endif</span>
<a name="ln-6389"></a>
<a name="ln-6390"></a>    <span class="n">ENDDO</span>
<a name="ln-6391"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Tilt</span>    <span class="o">=</span> <span class="n">AvgTilt</span>
<a name="ln-6392"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">=</span> <span class="n">AvgAzimuth</span>
<a name="ln-6393"></a>
<a name="ln-6394"></a>    <span class="c">! find area weighted centroid.</span>
<a name="ln-6395"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6396"></a>                <span class="nb">SUM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6397"></a>                            <span class="o">/</span><span class="nb">SUM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-6398"></a>
<a name="ln-6399"></a>    <span class="c">!now handle rNumericArgs from input object</span>
<a name="ln-6400"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Porosity</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6401"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">LWEmitt</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6402"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SolAbsorp</span>     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6403"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">HdeltaNPL</span>     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-6404"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">PlenGapThick</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-6405"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">PlenGapThick</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6406"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6407"></a>                                <span class="s1">&#39;&quot;, invalid .&#39;</span><span class="p">)</span>
<a name="ln-6408"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6409"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because Plenum gap must be greater than Zero=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6410"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-6411"></a>         <span class="k">CYCLE</span>
<a name="ln-6412"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-6413"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">AreaRatio</span>     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-6414"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Cv</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-6415"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Cd</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-6416"></a>
<a name="ln-6417"></a>    <span class="c">! Fill out data we now know</span>
<a name="ln-6418"></a>    <span class="c">! sum areas of HT surface areas</span>
<a name="ln-6419"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">ProjArea</span>      <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SurfPtrs</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-6420"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">ProjArea</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6421"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6422"></a>                                <span class="s1">&#39;&quot;, invalid .&#39;</span><span class="p">)</span>
<a name="ln-6423"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6424"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...because gross area of underlying surfaces must be greater than Zero=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6425"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">ProjArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-6426"></a>         <span class="k">CYCLE</span>
<a name="ln-6427"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-6428"></a>    <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">ActualArea</span>    <span class="o">=</span> <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">ProjArea</span> <span class="o">*</span> <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">AreaRatio</span>
<a name="ln-6429"></a>
<a name="ln-6430"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Exterior Cavity Baffle Surface Temperature [C]&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Tbaffle</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6431"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6432"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Exterior Cavity Air Drybulb Temperature [C]&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">TAirCav</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6433"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6434"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Exterior Cavity Total Natural Ventilation Air Change Rate [ACH]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6435"></a>                              <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">PassiveACH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6436"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6437"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Exterior Cavity Total Natural Ventilation Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6438"></a>                              <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">PassiveMdotVent</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6439"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6440"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Exterior Cavity Natural Ventilation from Wind Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6441"></a>                              <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">PassiveMdotWind</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6442"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6443"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Exterior Cavity Natural Ventilation from Buoyancy Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6444"></a>                               <span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">PassiveMdotTherm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6445"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ExtVentedCavity</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6446"></a>
<a name="ln-6447"></a>  <span class="n">ENDDO</span>
<a name="ln-6448"></a>
<a name="ln-6449"></a>  <span class="k">RETURN</span>
<a name="ln-6450"></a>
<a name="ln-6451"></a><span class="k">END SUBROUTINE </span><span class="n">GetHTSurfExtVentedCavityData</span>
<a name="ln-6452"></a>
<a name="ln-6453"></a><span class="k">SUBROUTINE </span><span class="n">GetSurfaceHeatTransferAlgorithmOverrides</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6454"></a>
<a name="ln-6455"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6456"></a>          <span class="c">!       AUTHOR         B. Griffith, portions from ApplyConvectionValue by Linda Lawrie</span>
<a name="ln-6457"></a>          <span class="c">!       DATE WRITTEN   July 2012</span>
<a name="ln-6458"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6459"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6460"></a>
<a name="ln-6461"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6462"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6463"></a>
<a name="ln-6464"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6465"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6466"></a>
<a name="ln-6467"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6468"></a>          <span class="c">! na</span>
<a name="ln-6469"></a>
<a name="ln-6470"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6471"></a>  <span class="k">USE </span><span class="n">DataIPShortcuts</span>
<a name="ln-6472"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span>
<a name="ln-6473"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">Surface</span>
<a name="ln-6474"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HeatTransferAlgosUsed</span><span class="p">,</span> <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="p">&amp;</span>
<a name="ln-6475"></a>                             <span class="p">,</span><span class="n">LowHConvLimit</span><span class="p">,</span> <span class="n">HighHConvLimit</span>
<a name="ln-6476"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-6477"></a>
<a name="ln-6478"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span> <span class="p">,</span><span class="n">ONLY</span><span class="p">:</span><span class="n">MaxSurfaceTempLimit</span>
<a name="ln-6479"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6480"></a>
<a name="ln-6481"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6482"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-6483"></a>
<a name="ln-6484"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6485"></a>
<a name="ln-6486"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmtA</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-6487"></a>
<a name="ln-6488"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6489"></a>          <span class="c">! na</span>
<a name="ln-6490"></a>
<a name="ln-6491"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6492"></a>          <span class="c">! na</span>
<a name="ln-6493"></a>
<a name="ln-6494"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6495"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CountHTAlgoObjectsSingleSurf</span>
<a name="ln-6496"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CountHTAlgoObjectsMultiSurf</span>
<a name="ln-6497"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CountHTAlgoObjectsSurfList</span>
<a name="ln-6498"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>   <span class="c">! Used in GetObjectItem</span>
<a name="ln-6499"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFoundSingleSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6500"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFoundMultiSurf</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6501"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFoundSurfList</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6502"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFoundByConstruct</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6503"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6504"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-6505"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item1</span>
<a name="ln-6506"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-6507"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>
<a name="ln-6508"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>
<a name="ln-6509"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SurfacesOfType</span>
<a name="ln-6510"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-6511"></a><span class="c">!  INTEGER :: Index</span>
<a name="ln-6512"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">tmpHeatTransferAlgosUsed</span>
<a name="ln-6513"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumEMPDMat</span>
<a name="ln-6514"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumPCMat</span>
<a name="ln-6515"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumVTCMat</span>
<a name="ln-6516"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHAMTMat1</span>
<a name="ln-6517"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHAMTMat2</span>
<a name="ln-6518"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHAMTMat3</span>
<a name="ln-6519"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHAMTMat4</span>
<a name="ln-6520"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHAMTMat5</span>
<a name="ln-6521"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHAMTMat6</span>
<a name="ln-6522"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SumHAMTMat</span>
<a name="ln-6523"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">msgneeded</span>
<a name="ln-6524"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlgoName</span>
<a name="ln-6525"></a>
<a name="ln-6526"></a>
<a name="ln-6527"></a>  <span class="c">! first initialize each heat transfer surface with the overall model type, array assignment</span>
<a name="ln-6528"></a>  <span class="n">Surface</span><span class="p">%</span><span class="n">HeatTransferAlgorithm</span>  <span class="o">=</span> <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6529"></a><span class="c">!</span>
<a name="ln-6530"></a>
<a name="ln-6531"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SurfaceProperty:HeatTransferAlgorithm&#39;</span>
<a name="ln-6532"></a>  <span class="n">CountHTAlgoObjectsSingleSurf</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6533"></a>
<a name="ln-6534"></a>
<a name="ln-6535"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SurfaceProperty:HeatTransferAlgorithm&#39;</span>
<a name="ln-6536"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CountHTAlgoObjectsSingleSurf</span>
<a name="ln-6537"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6538"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6539"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6540"></a>    <span class="n">ErrorsFoundSingleSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6541"></a>    <span class="n">Found</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span>  <span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-6542"></a>
<a name="ln-6543"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6544"></a><span class="k">      Call </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6545"></a>                                <span class="s1">&#39;&quot;, did not find matching surface.&#39;</span><span class="p">)</span>
<a name="ln-6546"></a>      <span class="n">ErrorsFoundSingleSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6547"></a>
<a name="ln-6548"></a>    <span class="n">ENDIF</span>
<a name="ln-6549"></a>
<a name="ln-6550"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6551"></a>
<a name="ln-6552"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6553"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CTF</span>
<a name="ln-6554"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;MOISTUREPENETRATIONDEPTHCONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6555"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_EMPD</span>
<a name="ln-6556"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COMBINEDHEATANDMOISTUREFINITEELEMENT&#39;</span><span class="p">)</span>
<a name="ln-6557"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_HAMT</span>
<a name="ln-6558"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONFINITEDIFFERENCE&#39;</span><span class="p">)</span>
<a name="ln-6559"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-6560"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-6561"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6562"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6563"></a>      <span class="n">ErrorsFoundSingleSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6564"></a>    <span class="k">END SELECT</span>
<a name="ln-6565"></a>
<a name="ln-6566"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFoundSingleSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6567"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6568"></a>
<a name="ln-6569"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">tmpAlgoInput</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! add new algo</span>
<a name="ln-6570"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6571"></a>        <span class="n">tmpHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">HeatTransferAlgosUsed</span>
<a name="ln-6572"></a>        <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6573"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6574"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6575"></a>        <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpHeatTransferAlgosUsed</span>
<a name="ln-6576"></a>        <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6577"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6578"></a>      <span class="n">ENDIF</span>
<a name="ln-6579"></a>
<a name="ln-6580"></a>    <span class="k">ELSE</span>
<a name="ln-6581"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6582"></a>    <span class="n">ENDIF</span>
<a name="ln-6583"></a>  <span class="n">ENDDO</span>  <span class="c">! single surface heat transfer algorithm override</span>
<a name="ln-6584"></a>
<a name="ln-6585"></a>
<a name="ln-6586"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SurfaceProperty:HeatTransferAlgorithm:MultipleSurface&#39;</span>
<a name="ln-6587"></a>  <span class="n">CountHTAlgoObjectsMultiSurf</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6588"></a>
<a name="ln-6589"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CountHTAlgoObjectsMultiSurf</span>
<a name="ln-6590"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6591"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6592"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6593"></a>    <span class="n">ErrorsFoundMultiSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6594"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6595"></a>
<a name="ln-6596"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6597"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CTF</span>
<a name="ln-6598"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;MOISTUREPENETRATIONDEPTHCONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6599"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_EMPD</span>
<a name="ln-6600"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COMBINEDHEATANDMOISTUREFINITEELEMENT&#39;</span><span class="p">)</span>
<a name="ln-6601"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_HAMT</span>
<a name="ln-6602"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONFINITEDIFFERENCE&#39;</span><span class="p">)</span>
<a name="ln-6603"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-6604"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-6605"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6606"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6607"></a>      <span class="n">ErrorsFoundMultiSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6608"></a>    <span class="k">END SELECT</span>
<a name="ln-6609"></a>
<a name="ln-6610"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6611"></a>
<a name="ln-6612"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLEXTERIORSURFACES&#39;</span><span class="p">)</span>
<a name="ln-6613"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6614"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6615"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6616"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-6617"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6618"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6619"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6620"></a>        <span class="n">ENDDO</span>
<a name="ln-6621"></a>
<a name="ln-6622"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLEXTERIORWALLS&#39;</span><span class="p">)</span>
<a name="ln-6623"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6624"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6625"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6626"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-6627"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6628"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6629"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6630"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6631"></a>       <span class="n">ENDDO</span>
<a name="ln-6632"></a>
<a name="ln-6633"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLEXTERIORROOFS&#39;</span><span class="p">)</span>
<a name="ln-6634"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6635"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6636"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6637"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-6638"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6639"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6640"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6641"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6642"></a>        <span class="n">ENDDO</span>
<a name="ln-6643"></a>
<a name="ln-6644"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLEXTERIORFLOORS&#39;</span><span class="p">)</span>
<a name="ln-6645"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6646"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6647"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6648"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-6649"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6650"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6651"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6652"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6653"></a>        <span class="n">ENDDO</span>
<a name="ln-6654"></a>
<a name="ln-6655"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLGROUNDCONTACTSURFACES&#39;</span><span class="p">)</span>
<a name="ln-6656"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6657"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6658"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6659"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! ground BC</span>
<a name="ln-6660"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6661"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6662"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6663"></a>        <span class="n">ENDDO</span>
<a name="ln-6664"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLINTERIORSURFACES&#39;</span><span class="p">)</span>
<a name="ln-6665"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6666"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6667"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6668"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-6669"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6670"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6671"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6672"></a>        <span class="n">ENDDO</span>
<a name="ln-6673"></a>
<a name="ln-6674"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLINTERIORWALLS&#39;</span><span class="p">)</span>
<a name="ln-6675"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6676"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6677"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6678"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-6679"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6680"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6681"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6682"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6683"></a>        <span class="n">ENDDO</span>
<a name="ln-6684"></a>
<a name="ln-6685"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLINTERIORROOFS&#39;</span><span class="p">,</span><span class="s1">&#39;ALLINTERIORCEILINGS&#39;</span><span class="p">)</span>
<a name="ln-6686"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6687"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6688"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6689"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-6690"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6691"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6692"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6693"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6694"></a>        <span class="n">ENDDO</span>
<a name="ln-6695"></a>
<a name="ln-6696"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLINTERIORFLOORS&#39;</span><span class="p">)</span>
<a name="ln-6697"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6698"></a>        <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6699"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6700"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-6701"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6702"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6703"></a><span class="k">          </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6704"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6705"></a>        <span class="n">ENDDO</span>
<a name="ln-6706"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-6707"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6708"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6709"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6710"></a>        <span class="n">ErrorsFoundMultiSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6711"></a>    <span class="k">END SELECT</span>
<a name="ln-6712"></a>
<a name="ln-6713"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfacesOfType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6714"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;In &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6715"></a>         <span class="s1">&#39;&quot;, for Multiple Surface Assignment=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6716"></a>         <span class="s1">&#39;&quot;, there were no surfaces of that type found for assignment.&#39;</span><span class="p">)</span>
<a name="ln-6717"></a>    <span class="k">ELSE</span>
<a name="ln-6718"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">tmpAlgoInput</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! add new algo</span>
<a name="ln-6719"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6720"></a>        <span class="n">tmpHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">HeatTransferAlgosUsed</span>
<a name="ln-6721"></a>        <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6722"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6723"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6724"></a>        <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpHeatTransferAlgosUsed</span>
<a name="ln-6725"></a>        <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6726"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6727"></a>      <span class="n">ENDIF</span>
<a name="ln-6728"></a>    <span class="n">ENDIF</span>
<a name="ln-6729"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFoundMultiSurf</span><span class="p">)</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6730"></a>
<a name="ln-6731"></a>
<a name="ln-6732"></a>  <span class="n">ENDDO</span> <span class="c">! multi surface heat transfer algo override</span>
<a name="ln-6733"></a>
<a name="ln-6734"></a>
<a name="ln-6735"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SurfaceProperty:HeatTransferAlgorithm:SurfaceList&#39;</span>
<a name="ln-6736"></a>  <span class="n">CountHTAlgoObjectsSurfList</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6737"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CountHTAlgoObjectsSurfList</span>
<a name="ln-6738"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6739"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6740"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6741"></a>    <span class="n">ErrorsFoundSurfList</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6742"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6743"></a>
<a name="ln-6744"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6745"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CTF</span>
<a name="ln-6746"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;MOISTUREPENETRATIONDEPTHCONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6747"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_EMPD</span>
<a name="ln-6748"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COMBINEDHEATANDMOISTUREFINITEELEMENT&#39;</span><span class="p">)</span>
<a name="ln-6749"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_HAMT</span>
<a name="ln-6750"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONFINITEDIFFERENCE&#39;</span><span class="p">)</span>
<a name="ln-6751"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-6752"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-6753"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6754"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6755"></a>      <span class="n">ErrorsFoundSurfList</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6756"></a>    <span class="k">END SELECT</span>
<a name="ln-6757"></a>
<a name="ln-6758"></a>
<a name="ln-6759"></a><span class="k">    Do </span><span class="n">item1</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">NumAlphas</span>
<a name="ln-6760"></a>
<a name="ln-6761"></a>      <span class="n">Found</span> <span class="o">=</span> <span class="n">FinditemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">item1</span><span class="p">),</span> <span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span>  <span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-6762"></a>
<a name="ln-6763"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6764"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6765"></a>                                <span class="s1">&#39;&quot;, did not find matching surface.&#39;</span><span class="p">)</span>
<a name="ln-6766"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Name of surface not found = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">item1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-6767"></a>        <span class="n">ErrorsFoundSurfList</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6768"></a>
<a name="ln-6769"></a>      <span class="n">ENDIF</span>
<a name="ln-6770"></a>
<a name="ln-6771"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFoundSurfList</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6772"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6773"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">tmpAlgoInput</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! add new algo</span>
<a name="ln-6774"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6775"></a>          <span class="n">tmpHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">HeatTransferAlgosUsed</span>
<a name="ln-6776"></a>          <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6777"></a>          <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6778"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6779"></a>          <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpHeatTransferAlgosUsed</span>
<a name="ln-6780"></a>          <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6781"></a>          <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6782"></a>        <span class="n">ENDIF</span>
<a name="ln-6783"></a>      <span class="k">ELSE</span>
<a name="ln-6784"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6785"></a>      <span class="n">ENDIF</span>
<a name="ln-6786"></a>
<a name="ln-6787"></a>    <span class="n">ENDDO</span>
<a name="ln-6788"></a>
<a name="ln-6789"></a>  <span class="n">ENDDO</span>
<a name="ln-6790"></a>
<a name="ln-6791"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SurfaceProperty:HeatTransferAlgorithm:Construction&#39;</span>
<a name="ln-6792"></a>  <span class="n">CountHTAlgoObjectsSurfList</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6793"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CountHTAlgoObjectsSurfList</span>
<a name="ln-6794"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6795"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6796"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6797"></a>    <span class="n">ErrorsFoundByConstruct</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6798"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6799"></a>
<a name="ln-6800"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6801"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CTF</span>
<a name="ln-6802"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;MOISTUREPENETRATIONDEPTHCONDUCTIONTRANSFERFUNCTION&#39;</span><span class="p">)</span>
<a name="ln-6803"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_EMPD</span>
<a name="ln-6804"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COMBINEDHEATANDMOISTUREFINITEELEMENT&#39;</span><span class="p">)</span>
<a name="ln-6805"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_HAMT</span>
<a name="ln-6806"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CONDUCTIONFINITEDIFFERENCE&#39;</span><span class="p">)</span>
<a name="ln-6807"></a>      <span class="n">tmpAlgoInput</span> <span class="o">=</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-6808"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-6809"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6810"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6811"></a>      <span class="n">ErrorsFoundByConstruct</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6812"></a>    <span class="k">END SELECT</span>
<a name="ln-6813"></a>
<a name="ln-6814"></a><span class="k">    </span><span class="n">Found</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6815"></a>    <span class="n">Found</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span>  <span class="n">TotConstructs</span> <span class="p">)</span>
<a name="ln-6816"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6817"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6818"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6819"></a>      <span class="n">ErrorsFoundByConstruct</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6820"></a>    <span class="n">ENDIF</span>
<a name="ln-6821"></a>
<a name="ln-6822"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrorsFoundByConstruct</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6823"></a><span class="k">      DO </span><span class="n">item1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-6824"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">item1</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">==</span> <span class="n">Found</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6825"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">item1</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span>   <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6826"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">tmpAlgoInput</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! add new algo</span>
<a name="ln-6827"></a>            <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6828"></a>            <span class="n">tmpHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">HeatTransferAlgosUsed</span>
<a name="ln-6829"></a>            <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">=</span> <span class="n">NumberOfHeatTransferAlgosUsed</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6830"></a>            <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6831"></a>            <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">))</span>
<a name="ln-6832"></a>            <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpHeatTransferAlgosUsed</span>
<a name="ln-6833"></a>            <span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">NumberOfHeatTransferAlgosUsed</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpAlgoInput</span>
<a name="ln-6834"></a>            <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">tmpHeatTransferAlgosUsed</span><span class="p">)</span>
<a name="ln-6835"></a>          <span class="n">ENDIF</span>
<a name="ln-6836"></a>        <span class="n">ENDIF</span>
<a name="ln-6837"></a>      <span class="n">ENDDO</span>
<a name="ln-6838"></a>    <span class="n">ENDIF</span>
<a name="ln-6839"></a>  <span class="n">ENDDO</span>
<a name="ln-6840"></a>
<a name="ln-6841"></a>  <span class="c">! test for missing materials for algorithms selected</span>
<a name="ln-6842"></a>  <span class="n">NumEMPDMat</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:MoisturePenetrationDepth:Settings&#39;</span><span class="p">)</span>
<a name="ln-6843"></a>  <span class="n">NumPCMat</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:PhaseChange&#39;</span><span class="p">)</span> <span class="c">! needs detailed algo</span>
<a name="ln-6844"></a>  <span class="n">NumVTCMat</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:VariableThermalConductivity&#39;</span><span class="p">)</span>
<a name="ln-6845"></a>  <span class="n">NumHAMTMat1</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Settings&#39;</span><span class="p">)</span>
<a name="ln-6846"></a>  <span class="n">NumHAMTMat2</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:SorptionIsotherm&#39;</span><span class="p">)</span>
<a name="ln-6847"></a>  <span class="n">NumHAMTMat3</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Suction&#39;</span><span class="p">)</span>
<a name="ln-6848"></a>  <span class="n">NumHAMTMat4</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Redistribution&#39;</span><span class="p">)</span>
<a name="ln-6849"></a>  <span class="n">NumHAMTMat5</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Diffusion&#39;</span><span class="p">)</span>
<a name="ln-6850"></a>  <span class="n">NumHAMTMat6</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:ThermalConductivity&#39;</span><span class="p">)</span>
<a name="ln-6851"></a>  <span class="n">SumHAMTMat</span><span class="o">=</span><span class="n">NumHAMTMat1</span><span class="o">+</span><span class="n">NumHAMTMat2</span><span class="o">+</span><span class="n">NumHAMTMat3</span><span class="o">+</span><span class="n">NumHAMTMat4</span><span class="o">+</span><span class="n">NumHAMTMat5</span><span class="o">+</span><span class="n">NumHAMTMat6</span>
<a name="ln-6852"></a>  <span class="n">msgneeded</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6853"></a>
<a name="ln-6854"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumEMPDMat</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">HeatTransferModel_EMPD</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6855"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The input file includes &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6856"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumEMPDMat</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; MaterialProperty:MoisturePenetrationDepth:Settings objects&#39;</span> <span class="p">&amp;</span>
<a name="ln-6857"></a>           <span class="o">//</span> <span class="s1">&#39; but the moisture penetration depth algorithm is not used anywhere.&#39;</span><span class="p">)</span>
<a name="ln-6858"></a>    <span class="n">msgneeded</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6859"></a>  <span class="n">ENDIF</span>
<a name="ln-6860"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumPCMat</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">HeatTransferModel_CondFD</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6861"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The input file includes &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6862"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumPCMat</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; MaterialProperty:PhaseChange objects&#39;</span> <span class="p">&amp;</span>
<a name="ln-6863"></a>        <span class="o">//</span> <span class="s1">&#39; but the conduction finite difference algorithm is not used anywhere.&#39;</span><span class="p">)</span>
<a name="ln-6864"></a>    <span class="n">msgneeded</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6865"></a>  <span class="n">ENDIF</span>
<a name="ln-6866"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumVTCMat</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">HeatTransferModel_CondFD</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6867"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The input file includes &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6868"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumVTCMat</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; MaterialProperty:VariableThermalConductivity objects&#39;</span> <span class="p">&amp;</span>
<a name="ln-6869"></a>        <span class="o">//</span> <span class="s1">&#39; but the conduction finite difference algorithm is not used anywhere.&#39;</span><span class="p">)</span>
<a name="ln-6870"></a>    <span class="n">msgneeded</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6871"></a>  <span class="n">ENDIF</span>
<a name="ln-6872"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SumHAMTMat</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">HeatTransferModel_HAMT</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6873"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The input file includes &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6874"></a>        <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SumHAMTMat</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; MaterialProperty:HeatAndMoistureTransfer:* objects&#39;</span> <span class="p">&amp;</span>
<a name="ln-6875"></a>        <span class="o">//</span> <span class="s1">&#39; but the combined heat and moisture finite difference algorithm is not used anywhere.&#39;</span><span class="p">)</span>
<a name="ln-6876"></a>    <span class="n">msgneeded</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6877"></a>  <span class="n">ENDIF</span>
<a name="ln-6878"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">msgneeded</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6879"></a><span class="k">    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Previous materials will be ignored due to HeatBalanceAlgorithm choice.&#39;</span><span class="p">)</span>
<a name="ln-6880"></a>  <span class="n">ENDIF</span>
<a name="ln-6881"></a>  <span class="n">msgneeded</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6882"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumEMPDMat</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">HeatTransferModel_EMPD</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6883"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The moisture penetration depth conduction transfer function algorithm is used&#39;</span> <span class="p">&amp;</span>
<a name="ln-6884"></a>               <span class="o">//</span> <span class="s1">&#39; but the input file includes no MaterialProperty:MoisturePenetrationDepth:Settings objects.&#39;</span><span class="p">)</span>
<a name="ln-6885"></a>    <span class="n">msgneeded</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6886"></a>  <span class="n">ENDIF</span>
<a name="ln-6887"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SumHAMTMat</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">HeatTransferModel_HAMT</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6888"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The combined heat and moisture finite element algorithm is used but the input file includes &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6889"></a>                            <span class="s1">&#39; no MaterialProperty:HeatAndMoistureTransfer:* objects.&#39;</span><span class="p">)</span>
<a name="ln-6890"></a>    <span class="n">msgneeded</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6891"></a>  <span class="n">ENDIF</span>
<a name="ln-6892"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">msgneeded</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6893"></a><span class="k">    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Certain materials objects are necessary to achieve proper results with the heat transfer &#39;</span> <span class="p">&amp;</span>
<a name="ln-6894"></a>                            <span class="o">//</span> <span class="s1">&#39;algorithm(s) selected.&#39;</span><span class="p">)</span>
<a name="ln-6895"></a>  <span class="n">ENDIF</span>
<a name="ln-6896"></a>
<a name="ln-6897"></a>
<a name="ln-6898"></a>     <span class="c">! Write Solution Algorithm to the initialization output file for User Verification</span>
<a name="ln-6899"></a>   <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;! &lt;Surface Heat Transfer Algorithm&gt;, Value {CTF - ConductionTransferFunction | &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6900"></a>           <span class="s1">&#39;EMPD - MoisturePenetrationDepthConductionTransferFunction | &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6901"></a>           <span class="s1">&#39;CondFD - ConductionFiniteDifference | &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6902"></a>           <span class="s1">&#39;HAMT - CombinedHeatAndMoistureFiniteElement} - Description,Inside Surface Max Temperature Limit{C}, &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6903"></a>           <span class="s1">&#39;Surface Convection Coefficient Lower Limit {W/m2-K}, Surface Convection Coefficient Upper Limit {W/m2-K}&#39;</span>
<a name="ln-6904"></a>
<a name="ln-6905"></a>   <span class="k">DO </span><span class="n">item1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumberOfHeatTransferAlgosUsed</span>
<a name="ln-6906"></a>     <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-6907"></a>     <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">HeatTransferAlgosUsed</span><span class="p">(</span><span class="n">item1</span><span class="p">))</span>
<a name="ln-6908"></a>
<a name="ln-6909"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CTF</span><span class="p">)</span>
<a name="ln-6910"></a>       <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CTF - ConductionTransferFunction&#39;</span>
<a name="ln-6911"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CondFD</span><span class="p">)</span>
<a name="ln-6912"></a>       <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CondFD - ConductionFiniteDifference&#39;</span>
<a name="ln-6913"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_EMPD</span><span class="p">)</span>
<a name="ln-6914"></a>       <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;EMPD - MoisturePenetrationDepthConductionTransferFunction&#39;</span>
<a name="ln-6915"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_HAMT</span><span class="p">)</span>
<a name="ln-6916"></a>       <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;HAMT - CombinedHeatAndMoistureFiniteElement&#39;</span>
<a name="ln-6917"></a>     <span class="k">END SELECT</span>
<a name="ln-6918"></a>
<a name="ln-6919"></a><span class="k">     WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">725</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlgoName</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6920"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowHConvLimit</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighHConvLimit</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-6921"></a>   <span class="n">ENDDO</span>
<a name="ln-6922"></a>
<a name="ln-6923"></a>   <span class="mi">725</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;Surface Heat Transfer Algorithm, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<a name="ln-6924"></a>
<a name="ln-6925"></a>   <span class="c">!Assign model type to windows, shading surfaces, and TDDs</span>
<a name="ln-6926"></a>   <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-6927"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6928"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6929"></a>       <span class="c">! todo, add complex fenestration switch  HeatTransferModel_ComplexFenestration</span>
<a name="ln-6930"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6931"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">=</span> <span class="n">HeatTransferModel_ComplexFenestration</span>
<a name="ln-6932"></a>       <span class="k">ELSE</span>
<a name="ln-6933"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">=</span> <span class="n">HeatTransferModel_Window5</span>
<a name="ln-6934"></a>       <span class="n">ENDIF</span>
<a name="ln-6935"></a>     <span class="n">ENDIF</span>
<a name="ln-6936"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6937"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_F</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6938"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span>  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6939"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Overhang</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6940"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Fin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6941"></a><span class="k">       </span><span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">=</span> <span class="n">HeatTransferModel_None</span>
<a name="ln-6942"></a>     <span class="n">ENDIF</span>
<a name="ln-6943"></a>     <span class="k">IF</span> <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6944"></a><span class="k">       </span><span class="n">Surface</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">=</span> <span class="n">HeatTransferModel_TDD</span>
<a name="ln-6945"></a>     <span class="n">ENDIF</span>
<a name="ln-6946"></a>
<a name="ln-6947"></a>   <span class="n">ENDDO</span>
<a name="ln-6948"></a>
<a name="ln-6949"></a>
<a name="ln-6950"></a>  <span class="k">RETURN</span>
<a name="ln-6951"></a>
<a name="ln-6952"></a><span class="k">END SUBROUTINE </span><span class="n">GetSurfaceHeatTransferAlgorithmOverrides</span>
<a name="ln-6953"></a>
<a name="ln-6954"></a><span class="k">SUBROUTINE </span><span class="n">GetVertices</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">NSides</span><span class="p">,</span><span class="n">Vertices</span><span class="p">)</span>
<a name="ln-6955"></a>
<a name="ln-6956"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6957"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-6958"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-6959"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6960"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6961"></a>
<a name="ln-6962"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6963"></a>          <span class="c">! This subroutine gets the surface vertices from the arrays</span>
<a name="ln-6964"></a>          <span class="c">! passed by the calling routine.  These had previously been obtained</span>
<a name="ln-6965"></a>          <span class="c">! from the InputProcessor (GetObjectItem).  This routine will provide</span>
<a name="ln-6966"></a>          <span class="c">! a standard place for determining various properties of the surface</span>
<a name="ln-6967"></a>          <span class="c">! from the vertices.</span>
<a name="ln-6968"></a>
<a name="ln-6969"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6970"></a>          <span class="c">! na</span>
<a name="ln-6971"></a>
<a name="ln-6972"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6973"></a>          <span class="c">! na</span>
<a name="ln-6974"></a>
<a name="ln-6975"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6976"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-6977"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-6978"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span>
<a name="ln-6979"></a>
<a name="ln-6980"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6981"></a>
<a name="ln-6982"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6983"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SurfNum</span>     <span class="c">! Current surface number</span>
<a name="ln-6984"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">NSides</span>      <span class="c">! Number of sides to figure</span>
<a name="ln-6985"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NSides</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vertices</span>    <span class="c">! Vertices, in specified order</span>
<a name="ln-6986"></a>
<a name="ln-6987"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6988"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetVertices: &#39;</span>
<a name="ln-6989"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fmt3</span><span class="o">=</span><span class="s2">&quot;(A,I5,A,3(1x,f18.13))&quot;</span>
<a name="ln-6990"></a>    <span class="k">TYPE</span> <span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">TestVector</span><span class="o">=</span><span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-6991"></a>
<a name="ln-6992"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6993"></a>          <span class="c">! na</span>
<a name="ln-6994"></a>
<a name="ln-6995"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6996"></a>          <span class="c">! na</span>
<a name="ln-6997"></a>
<a name="ln-6998"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6999"></a>    <span class="kt">INTEGER </span><span class="n">Ptr</span>  <span class="c">! Pointer into Vertice array</span>
<a name="ln-7000"></a>    <span class="kt">INTEGER </span><span class="n">N</span>    <span class="c">! Loop counter</span>
<a name="ln-7001"></a>    <span class="kt">INTEGER </span><span class="n">NSrc</span>   <span class="c">! Used for CW -&gt; CCW transformation</span>
<a name="ln-7002"></a>    <span class="kt">INTEGER </span><span class="n">NTar</span>   <span class="c">! Used for CW -&gt; CCW transformation</span>
<a name="ln-7003"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfWorldAz</span>
<a name="ln-7004"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfTilt</span>
<a name="ln-7005"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Perimeter</span>       <span class="c">! Perimeter length of the surface</span>
<a name="ln-7006"></a>    <span class="kt">INTEGER </span><span class="n">Vrt</span>   <span class="c">! Used for calculating perimeter</span>
<a name="ln-7007"></a>    <span class="k">TYPE</span> <span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-7008"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Xb</span>                 <span class="c">! Intermediate calculation</span>
<a name="ln-7009"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Yb</span>                 <span class="c">! Intermediate calculation</span>
<a name="ln-7010"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-7011"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisCorner</span>
<a name="ln-7012"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TiltString</span>
<a name="ln-7013"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ThisWidth</span>
<a name="ln-7014"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ThisHeight</span>
<a name="ln-7015"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DistanceCheck</span>
<a name="ln-7016"></a><span class="c">!unused    REAL(r64) :: ccwtest</span>
<a name="ln-7017"></a><span class="c">!unused    LOGICAL   :: SurfaceCCW</span>
<a name="ln-7018"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dotp</span>
<a name="ln-7019"></a>
<a name="ln-7020"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NSides</span> <span class="o">&gt;</span> <span class="n">MaxVerticesPerSurface</span><span class="p">)</span> <span class="n">MaxVerticesPerSurface</span><span class="o">=</span><span class="n">NSides</span>
<a name="ln-7021"></a>    <span class="n">Ptr</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7022"></a>    <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-7023"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span><span class="o">=</span><span class="n">Vertices</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-7024"></a>      <span class="n">Ptr</span><span class="o">=</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7025"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span><span class="o">=</span><span class="n">Vertices</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-7026"></a>      <span class="n">Ptr</span><span class="o">=</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7027"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span><span class="o">=</span><span class="n">Vertices</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-7028"></a>      <span class="n">Ptr</span><span class="o">=</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7029"></a>    <span class="n">ENDDO</span>
<a name="ln-7030"></a>
<a name="ln-7031"></a>    <span class="c">! Address changing vertices if they were put in in CW order rather than CCW</span>
<a name="ln-7032"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CCW</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7033"></a>      <span class="c">! If even number of sides, this will transfer appropriately</span>
<a name="ln-7034"></a>      <span class="c">! If odd number, will leave the &quot;odd&quot; one, which is what you want.</span>
<a name="ln-7035"></a>      <span class="n">NSrc</span><span class="o">=</span><span class="n">NSides</span>
<a name="ln-7036"></a>      <span class="n">NTar</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-7037"></a>      <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,(</span><span class="n">NSides</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-7038"></a>        <span class="n">temp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NSrc</span><span class="p">)</span>
<a name="ln-7039"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NSrc</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NTar</span><span class="p">)</span>
<a name="ln-7040"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NTar</span><span class="p">)</span><span class="o">=</span><span class="n">temp</span>
<a name="ln-7041"></a>        <span class="n">NSrc</span><span class="o">=</span><span class="n">NSrc</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7042"></a>        <span class="n">NTar</span><span class="o">=</span><span class="n">NTar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7043"></a>      <span class="n">ENDDO</span>
<a name="ln-7044"></a>    <span class="n">ENDIF</span>
<a name="ln-7045"></a>    <span class="c">! Now address which &quot;Corner&quot; has been put in first.  Note: the azimuth and tilt and area</span>
<a name="ln-7046"></a>    <span class="c">! calculations do not care which corner is put in first.</span>
<a name="ln-7047"></a>    <span class="c">! 2/2011 - don&#39;t think the shading calculations have a corner preference.  Will keep this for</span>
<a name="ln-7048"></a>    <span class="c">! consistency (for now)</span>
<a name="ln-7049"></a>    <span class="n">ThisCorner</span><span class="o">=</span><span class="n">Corner</span>
<a name="ln-7050"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">ThisCorner</span> <span class="o">/=</span> <span class="n">UpperLeftCorner</span><span class="p">)</span>
<a name="ln-7051"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NSides</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7052"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ThisCorner</span> <span class="o">==</span> <span class="n">UpperRightCorner</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7053"></a><span class="k">          </span><span class="n">ThisCorner</span><span class="o">=</span><span class="n">UpperLeftCorner</span>
<a name="ln-7054"></a>          <span class="k">EXIT</span>
<a name="ln-7055"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-7056"></a>      <span class="n">ENDIF</span>
<a name="ln-7057"></a>      <span class="n">NTar</span><span class="o">=</span><span class="n">ThisCorner</span>
<a name="ln-7058"></a>      <span class="n">NSrc</span><span class="o">=</span><span class="n">ThisCorner</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7059"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NSrc</span> <span class="o">&gt;</span> <span class="n">NSides</span><span class="p">)</span> <span class="n">NSrc</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7060"></a>      <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7061"></a>        <span class="n">temp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NTar</span><span class="p">)</span>
<a name="ln-7062"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NTar</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NSrc</span><span class="p">)</span>
<a name="ln-7063"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NSrc</span><span class="p">)</span><span class="o">=</span><span class="n">temp</span>
<a name="ln-7064"></a>        <span class="n">NTar</span><span class="o">=</span><span class="n">NTar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7065"></a>        <span class="n">NSrc</span><span class="o">=</span><span class="n">NSrc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7066"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NTar</span> <span class="o">&gt;</span> <span class="n">NSides</span><span class="p">)</span> <span class="n">NTar</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7067"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NSrc</span> <span class="o">&gt;</span> <span class="n">NSides</span><span class="p">)</span> <span class="n">NSrc</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7068"></a>      <span class="n">ENDDO</span>
<a name="ln-7069"></a>      <span class="n">ThisCorner</span><span class="o">=</span><span class="n">ThisCorner</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7070"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ThisCorner</span> <span class="o">&gt;</span> <span class="n">NSides</span><span class="p">)</span> <span class="n">ThisCorner</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7071"></a>    <span class="n">ENDDO</span> <span class="c">! Corners</span>
<a name="ln-7072"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7073"></a>      <span class="c">! Input in &quot;relative&quot; coordinates, use Building and Zone North Axes and Origins</span>
<a name="ln-7074"></a>      <span class="c">!                                  to translate each point (including rotation for Appendix G)</span>
<a name="ln-7075"></a>      <span class="n">ZoneNum</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7076"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7077"></a><span class="k">        DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-7078"></a>          <span class="n">Xb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span><span class="o">*</span><span class="n">CosZoneRelNorth</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7079"></a>                 <span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span><span class="o">*</span><span class="n">SinZoneRelNorth</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginX</span>
<a name="ln-7080"></a>          <span class="n">Yb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span><span class="o">*</span><span class="n">SinZoneRelNorth</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7081"></a>                 <span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span><span class="o">*</span><span class="n">CosZoneRelNorth</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginY</span>
<a name="ln-7082"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span>
<a name="ln-7083"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span>
<a name="ln-7084"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span>  <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginZ</span>
<a name="ln-7085"></a>        <span class="n">ENDDO</span>
<a name="ln-7086"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7087"></a><span class="k">        DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-7088"></a>          <span class="n">Xb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-7089"></a>          <span class="n">Yb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-7090"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span>
<a name="ln-7091"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span>
<a name="ln-7092"></a>        <span class="n">ENDDO</span>
<a name="ln-7093"></a>      <span class="n">ENDIF</span>
<a name="ln-7094"></a>    <span class="k">ELSE</span>
<a name="ln-7095"></a>      <span class="c">!if world coordinate only need to rotate for Appendix G</span>
<a name="ln-7096"></a>      <span class="n">ZoneNum</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7097"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7098"></a><span class="k">        DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-7099"></a>          <span class="n">Xb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-7100"></a>          <span class="n">Yb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-7101"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span>
<a name="ln-7102"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span>
<a name="ln-7103"></a>        <span class="n">ENDDO</span>
<a name="ln-7104"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7105"></a><span class="k">        DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-7106"></a>          <span class="n">Xb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-7107"></a>          <span class="n">Yb</span>    <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-7108"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span>
<a name="ln-7109"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>  <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span>
<a name="ln-7110"></a>        <span class="n">ENDDO</span>
<a name="ln-7111"></a>      <span class="k">END IF</span>
<a name="ln-7112"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-7113"></a>
<a name="ln-7114"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NSides</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7115"></a><span class="k">      </span><span class="n">DistanceCheck</span><span class="o">=</span><span class="n">Distance</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-7116"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DistanceCheck</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">01</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7117"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7118"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Distance between two vertices &lt; .01, possibly coincident.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7119"></a>                                <span class="s1">&#39; for Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7120"></a>                                <span class="s1">&#39;, in Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-7121"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7122"></a>             <span class="s1">&#39;]=(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-7123"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-7124"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-7125"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7126"></a>             <span class="s1">&#39;]=(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-7127"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-7128"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-7129"></a>        <span class="n">ENDIF</span>
<a name="ln-7130"></a>        <span class="n">TotalCoincidentVertices</span><span class="o">=</span><span class="n">TotalCoincidentVertices</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7131"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7132"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7133"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dropping Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7134"></a>          <span class="n">ENDIF</span>
<a name="ln-7135"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7136"></a>        <span class="k">ELSE</span>
<a name="ln-7137"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7138"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cannot Drop Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7139"></a>                 <span class="s1">&#39;Number of Surface Sides at minimum. This surface is now a degenerate surface.&#39;</span><span class="p">)</span>
<a name="ln-7140"></a>          <span class="n">ENDIF</span>
<a name="ln-7141"></a>          <span class="n">TotalDegenerateSurfaces</span><span class="o">=</span><span class="n">TotalDegenerateSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7142"></a>          <span class="c">! mark degenerate surface?</span>
<a name="ln-7143"></a>        <span class="n">ENDIF</span>
<a name="ln-7144"></a>        <span class="n">DistanceCheck</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7145"></a>      <span class="n">ENDIF</span>
<a name="ln-7146"></a>      <span class="n">Perimeter</span><span class="o">=</span><span class="n">DistanceCheck</span>
<a name="ln-7147"></a><span class="c">!      DO Vrt=2,SurfaceTmp(SurfNum)%Sides</span>
<a name="ln-7148"></a>      <span class="n">Vrt</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-7149"></a>      <span class="k">DO</span>
<a name="ln-7150"></a><span class="k">        </span><span class="n">DistanceCheck</span><span class="o">=</span><span class="n">Distance</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-7151"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DistanceCheck</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">01</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7152"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7153"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Distance between two vertices &lt; .01, possibly coincident.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7154"></a>                                  <span class="s1">&#39; for Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7155"></a>                                  <span class="s1">&#39;, in Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-7156"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Vrt</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7157"></a>               <span class="s1">&#39;]=(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-7158"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-7159"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-7160"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Vrt</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7161"></a>               <span class="s1">&#39;]=(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-7162"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>                 <span class="p">&amp;</span>
<a name="ln-7163"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vrt</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-7164"></a>          <span class="n">ENDIF</span>
<a name="ln-7165"></a>          <span class="n">TotalCoincidentVertices</span><span class="o">=</span><span class="n">TotalCoincidentVertices</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7166"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Vrt</span> <span class="o">==</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7167"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7168"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7169"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dropping Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7170"></a>              <span class="n">ENDIF</span>
<a name="ln-7171"></a>              <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7172"></a>            <span class="k">ELSE</span>
<a name="ln-7173"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7174"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cannot Drop Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7175"></a>                     <span class="s1">&#39;Number of Surface Sides at minimum. This surface is now a degenerate surface.&#39;</span><span class="p">)</span>
<a name="ln-7176"></a>              <span class="n">ENDIF</span>
<a name="ln-7177"></a>              <span class="n">TotalDegenerateSurfaces</span><span class="o">=</span><span class="n">TotalDegenerateSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7178"></a>              <span class="c">! mark degenerate surface?</span>
<a name="ln-7179"></a>            <span class="n">ENDIF</span>
<a name="ln-7180"></a>            <span class="n">DistanceCheck</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7181"></a>          <span class="k">ELSE</span>
<a name="ln-7182"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7183"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7184"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dropping Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Vrt</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7185"></a>              <span class="n">ENDIF</span>
<a name="ln-7186"></a>              <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="n">Vrt</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7187"></a>                <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">x</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-7188"></a>                <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">y</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-7189"></a>                <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">z</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-7190"></a>              <span class="n">ENDDO</span>
<a name="ln-7191"></a>              <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7192"></a>            <span class="k">ELSE</span>
<a name="ln-7193"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7194"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cannot Drop Vertex [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7195"></a>                   <span class="s1">&#39;Number of Surface Sides at minimum. This surface is now a degenerate surface.&#39;</span><span class="p">)</span>
<a name="ln-7196"></a>              <span class="n">ENDIF</span>
<a name="ln-7197"></a>              <span class="n">TotalDegenerateSurfaces</span><span class="o">=</span><span class="n">TotalDegenerateSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7198"></a>              <span class="c">! mark degenerate surface?</span>
<a name="ln-7199"></a>            <span class="n">ENDIF</span>
<a name="ln-7200"></a>            <span class="n">DistanceCheck</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7201"></a>          <span class="n">ENDIF</span>
<a name="ln-7202"></a>        <span class="n">ENDIF</span>
<a name="ln-7203"></a>        <span class="n">Perimeter</span> <span class="o">=</span> <span class="n">Perimeter</span><span class="o">+</span><span class="n">DistanceCheck</span>
<a name="ln-7204"></a>        <span class="n">Vrt</span><span class="o">=</span><span class="n">Vrt</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7205"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Vrt</span> <span class="o">&gt;</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-7206"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-7207"></a>
<a name="ln-7208"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span><span class="o">=</span><span class="n">Perimeter</span>
<a name="ln-7209"></a>
<a name="ln-7210"></a>      <span class="k">CALL </span><span class="n">CreateNewellSurfaceNormalVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7211"></a>         <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-7212"></a>      <span class="k">CALL </span><span class="n">CreateNewellAreaVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-7213"></a>      <span class="c">! For surfaces with subsurfaces, the following two areas are turned into net areas later by</span>
<a name="ln-7214"></a>      <span class="c">! subtracting subsurface areas</span>
<a name="ln-7215"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-7216"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-7217"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7218"></a>      <span class="k">CALL </span><span class="n">DetermineAzimuthAndTilt</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfWorldAz</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7219"></a>                                   <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7220"></a>                                   <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-7221"></a>      <span class="n">dotp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span> <span class="p">.</span><span class="n">dot</span><span class="p">.</span> <span class="n">TestVector</span>
<a name="ln-7222"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">dotp</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.000001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7223"></a><span class="k">        </span><span class="n">TiltString</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfTilt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7224"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Roof/Ceiling is upside down! Tilt angle=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TiltString</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7225"></a>           <span class="s1">&#39;], should be near 0,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-7226"></a>           <span class="s1">&#39; Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7227"></a>           <span class="s1">&#39;&quot;, in Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7228"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Automatic fix is attempted.&#39;</span><span class="p">)</span>
<a name="ln-7229"></a>        <span class="k">CALL </span><span class="n">ReverseAndRecalculate</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfWorldAz</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">)</span>
<a name="ln-7230"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfTilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7231"></a><span class="k">        </span><span class="n">TiltString</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfTilt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7232"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Roof/Ceiling is not oriented correctly! Tilt angle=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TiltString</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7233"></a>           <span class="s1">&#39;], should be near 0,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-7234"></a>           <span class="s1">&#39; Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7235"></a>           <span class="s1">&#39;&quot;, in Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7236"></a>      <span class="n">ENDIF</span>
<a name="ln-7237"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">dotp</span> <span class="o">&gt;</span> <span class="mf">0.000001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7238"></a><span class="k">        </span><span class="n">TiltString</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfTilt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7239"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Floor is upside down! Tilt angle=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TiltString</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7240"></a>           <span class="s1">&#39;], should be near 180,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-7241"></a>           <span class="s1">&#39; Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7242"></a>           <span class="s1">&#39;&quot;, in Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7243"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Automatic fix is attempted.&#39;</span><span class="p">)</span>
<a name="ln-7244"></a>        <span class="k">CALL </span><span class="n">ReverseAndRecalculate</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfWorldAz</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">)</span>
<a name="ln-7245"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfTilt</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="mf">8.2d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! slope/grade = 40%!</span>
<a name="ln-7246"></a>        <span class="n">TiltString</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfTilt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7247"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Floor is not oriented correctly! Tilt angle=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TiltString</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7248"></a>           <span class="s1">&#39;], should be near 180,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-7249"></a>           <span class="s1">&#39; Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7250"></a>           <span class="s1">&#39;&quot;, in Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7251"></a>      <span class="n">ENDIF</span>
<a name="ln-7252"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfWorldAz</span>
<a name="ln-7253"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">SurfTilt</span>
<a name="ln-7254"></a>
<a name="ln-7255"></a>      <span class="c">! Sine and cosine of azimuth and tilt</span>
<a name="ln-7256"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7257"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7258"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7259"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7260"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7261"></a><span class="k">        </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-7262"></a>      <span class="n">ENDIF</span>
<a name="ln-7263"></a>      <span class="c">! Outward normal unit vector (pointing away from room)</span>
<a name="ln-7264"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span>
<a name="ln-7265"></a>      <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-7266"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-7267"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-7268"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>     <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-7269"></a>      <span class="n">ENDDO</span>
<a name="ln-7270"></a>
<a name="ln-7271"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7272"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7273"></a>          <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-7274"></a>      <span class="c">! Can perform tests on this surface here</span>
<a name="ln-7275"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="o">=</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-7276"></a>      <span class="c">! The following IR view factors are modified in subr. SkyDifSolarShading if there are shadowing</span>
<a name="ln-7277"></a>      <span class="c">! surfaces</span>
<a name="ln-7278"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-7279"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-7280"></a>
<a name="ln-7281"></a>
<a name="ln-7282"></a>      <span class="c">! Call to transform vertices</span>
<a name="ln-7283"></a>
<a name="ln-7284"></a>      <span class="k">Call </span><span class="n">TransformVertsByAspect</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-7285"></a>
<a name="ln-7286"></a>    <span class="k">ELSE</span>
<a name="ln-7287"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Called with less than 2 sides, Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7288"></a>    <span class="n">ENDIF</span>
<a name="ln-7289"></a>
<a name="ln-7290"></a>    <span class="c">! Preliminary Height/Width</span>
<a name="ln-7291"></a>    <span class="n">temp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7292"></a>    <span class="n">ThisWidth</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-7293"></a>    <span class="n">temp</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7294"></a>    <span class="n">ThisHeight</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-7295"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">ThisHeight</span>
<a name="ln-7296"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">ThisWidth</span>
<a name="ln-7297"></a>
<a name="ln-7298"></a>  <span class="k">RETURN</span>
<a name="ln-7299"></a>
<a name="ln-7300"></a><span class="k">END SUBROUTINE </span><span class="n">GetVertices</span>
<a name="ln-7301"></a>
<a name="ln-7302"></a><span class="k">SUBROUTINE </span><span class="n">ReverseAndRecalculate</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">NSides</span><span class="p">,</span><span class="n">SurfAzimuth</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">)</span>
<a name="ln-7303"></a>
<a name="ln-7304"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7305"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7306"></a>          <span class="c">!       DATE WRITTEN   February 2011</span>
<a name="ln-7307"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7308"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7309"></a>
<a name="ln-7310"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7311"></a>          <span class="c">! This routine reverses the vertices for a surface (needed when roof/floor is upside down)</span>
<a name="ln-7312"></a>          <span class="c">! and recalculates the azimuth, etc for the surface.</span>
<a name="ln-7313"></a>
<a name="ln-7314"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7315"></a>          <span class="c">! na</span>
<a name="ln-7316"></a>
<a name="ln-7317"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7318"></a>          <span class="c">! na</span>
<a name="ln-7319"></a>
<a name="ln-7320"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7321"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-7322"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-7323"></a>
<a name="ln-7324"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7325"></a>
<a name="ln-7326"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7327"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>   <span class="c">! Surface number for the surface</span>
<a name="ln-7328"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSides</span>    <span class="c">! number of sides to surface</span>
<a name="ln-7329"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAzimuth</span> <span class="c">! Surface Facing angle (will be 0 for roofs/floors)</span>
<a name="ln-7330"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTilt</span>    <span class="c">! Surface tilt (</span>
<a name="ln-7331"></a>
<a name="ln-7332"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7333"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fmt3</span><span class="o">=</span><span class="s2">&quot;(A,I5,A,3(1x,f18.13))&quot;</span>
<a name="ln-7334"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;ReverseAndRecalculate: &#39;</span>
<a name="ln-7335"></a>
<a name="ln-7336"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7337"></a>          <span class="c">! na</span>
<a name="ln-7338"></a>
<a name="ln-7339"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7340"></a>          <span class="c">! na</span>
<a name="ln-7341"></a>
<a name="ln-7342"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7343"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span> <span class="c">! Loop Control</span>
<a name="ln-7344"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RevPtr</span> <span class="c">! pointer for reversing vertices</span>
<a name="ln-7345"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">NSides</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vertices</span>    <span class="c">! Vertices, in specified order</span>
<a name="ln-7346"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TiltString</span>
<a name="ln-7347"></a>
<a name="ln-7348"></a>    <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-7349"></a>      <span class="n">Vertices</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7350"></a>    <span class="n">ENDDO</span>
<a name="ln-7351"></a>    <span class="n">RevPtr</span><span class="o">=</span><span class="n">NSides</span>
<a name="ln-7352"></a>    <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-7353"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">Vertices</span><span class="p">(</span><span class="n">RevPtr</span><span class="p">)</span>
<a name="ln-7354"></a>      <span class="n">RevPtr</span><span class="o">=</span><span class="n">RevPtr</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7355"></a>    <span class="n">ENDDO</span>
<a name="ln-7356"></a>
<a name="ln-7357"></a>    <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Reversing Surface Name=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surfacetmp</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7358"></a>    <span class="k">do </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nsides</span>
<a name="ln-7359"></a>      <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="n">fmt3</span><span class="p">)</span> <span class="s1">&#39;side=&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39; abs coord vertex=&#39;</span><span class="p">,</span><span class="n">surfacetmp</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7360"></a>         <span class="n">surfacetmp</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surfacetmp</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">n</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-7361"></a>    <span class="n">enddo</span>
<a name="ln-7362"></a>
<a name="ln-7363"></a>    <span class="k">CALL </span><span class="n">CreateNewellSurfaceNormalVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7364"></a>       <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-7365"></a>    <span class="k">CALL </span><span class="n">DetermineAzimuthAndTilt</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfAzimuth</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7366"></a>                                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7367"></a>                                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-7368"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfTilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7369"></a><span class="k">      </span><span class="n">TiltString</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfTilt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7370"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Roof/Ceiling is still upside down! Tilt angle=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TiltString</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7371"></a>           <span class="s1">&#39;], should be near 0, please fix manually.&#39;</span><span class="p">)</span>
<a name="ln-7372"></a>    <span class="n">ENDIF</span>
<a name="ln-7373"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfTilt</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="mf">8.2d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! 40% grade!</span>
<a name="ln-7374"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Floor is still upside down! Tilt angle=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TiltString</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7375"></a>         <span class="s1">&#39;], should be near 180, please fix manually.&#39;</span><span class="p">)</span>
<a name="ln-7376"></a>    <span class="n">ENDIF</span>
<a name="ln-7377"></a>
<a name="ln-7378"></a>  <span class="k">RETURN</span>
<a name="ln-7379"></a>
<a name="ln-7380"></a><span class="k">END SUBROUTINE </span><span class="n">ReverseAndRecalculate</span>
<a name="ln-7381"></a>
<a name="ln-7382"></a><span class="k">SUBROUTINE </span><span class="n">MakeMirrorSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7383"></a>
<a name="ln-7384"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7385"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7386"></a>          <span class="c">!       DATE WRITTEN   June 2002</span>
<a name="ln-7387"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7388"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7389"></a>
<a name="ln-7390"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7391"></a>          <span class="c">! This subroutine creates a &quot;mirror&quot; surface using the indicated surface.</span>
<a name="ln-7392"></a>          <span class="c">! This is the simple approach for bi-directional shading devices.  If, perchance,</span>
<a name="ln-7393"></a>          <span class="c">! the user has already taken care of this (e.g. fins in middle of wall), there will</span>
<a name="ln-7394"></a>          <span class="c">! be extra shading devices shown.</span>
<a name="ln-7395"></a>
<a name="ln-7396"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7397"></a>          <span class="c">! Reverse the vertices in the original surface.  Add &quot;bi&quot; to name.</span>
<a name="ln-7398"></a>
<a name="ln-7399"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7400"></a>          <span class="c">! na</span>
<a name="ln-7401"></a>
<a name="ln-7402"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7403"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-7404"></a>
<a name="ln-7405"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7406"></a>
<a name="ln-7407"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7408"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! In=&gt;Surface to Mirror, Out=&gt;new Surface index</span>
<a name="ln-7409"></a>
<a name="ln-7410"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7411"></a>          <span class="c">! na</span>
<a name="ln-7412"></a>
<a name="ln-7413"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7414"></a>          <span class="c">! na</span>
<a name="ln-7415"></a>
<a name="ln-7416"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7417"></a>          <span class="c">! na</span>
<a name="ln-7418"></a>
<a name="ln-7419"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7420"></a>  <span class="kt">INTEGER </span><span class="n">Vert</span>
<a name="ln-7421"></a>  <span class="kt">INTEGER </span><span class="n">NVert</span>
<a name="ln-7422"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfWorldAz</span>
<a name="ln-7423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfTilt</span>
<a name="ln-7424"></a>  <span class="kt">INTEGER </span><span class="n">N</span>
<a name="ln-7425"></a><span class="c">!  TYPE (Vector) :: temp1</span>
<a name="ln-7426"></a>
<a name="ln-7427"></a>  <span class="n">NVert</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-7428"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NVert</span><span class="p">))</span>
<a name="ln-7429"></a><span class="c">! doesn&#39;t work when Vertex are pointers  SurfaceTmp(SurfNum+1)=SurfaceTmp(SurfNum)</span>
<a name="ln-7430"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-7431"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Construction</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-7432"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span>
<a name="ln-7433"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="k">Class</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-7434"></a><span class="k">  </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-7435"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Area</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7436"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-7437"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-7438"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Reveal</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Reveal</span>
<a name="ln-7439"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="nb">Shape</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="nb">Shape</span>
<a name="ln-7440"></a><span class="nb">  </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Sides</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-7441"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-7442"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-7443"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span>
<a name="ln-7444"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span>
<a name="ln-7445"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-7446"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ZoneName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span>
<a name="ln-7447"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7448"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span>
<a name="ln-7449"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-7450"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-7451"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ExtWind</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-7452"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ViewFactorGround</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span>
<a name="ln-7453"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-7454"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span>
<a name="ln-7455"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span>
<a name="ln-7456"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span>
<a name="ln-7457"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShadowSurfSchedVaries</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfSchedVaries</span>
<a name="ln-7458"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">SchedMinValue</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMinValue</span>
<a name="ln-7459"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">IsTransparent</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IsTransparent</span>
<a name="ln-7460"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span>
<a name="ln-7461"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">MaterialMovInsulExt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulExt</span>
<a name="ln-7462"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span>
<a name="ln-7463"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span>
<a name="ln-7464"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">SchedMovInsulInt</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulInt</span>
<a name="ln-7465"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-7466"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShadedConstruction</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-7467"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span>
<a name="ln-7468"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-7469"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-7470"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Perimeter</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span>
<a name="ln-7471"></a>
<a name="ln-7472"></a>  <span class="k">DO </span><span class="n">Vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-7473"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">Vert</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NVert</span><span class="p">)</span>
<a name="ln-7474"></a>    <span class="n">NVert</span><span class="o">=</span><span class="n">NVert</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7475"></a>  <span class="n">ENDDO</span>
<a name="ln-7476"></a>  <span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7477"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="s1">&#39;Mir-&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7478"></a>
<a name="ln-7479"></a>  <span class="c">! TH 3/26/2010</span>
<a name="ln-7480"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MirroredSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7481"></a>
<a name="ln-7482"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7483"></a><span class="k">    CALL </span><span class="n">CreateNewellAreaVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-7484"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-7485"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-7486"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7487"></a>    <span class="k">CALL </span><span class="n">CreateNewellSurfaceNormalVector</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7488"></a>       <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-7489"></a>    <span class="k">CALL </span><span class="n">DetermineAzimuthAndTilt</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">SurfWorldAz</span><span class="p">,</span><span class="n">SurfTilt</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7490"></a>                                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7491"></a>                                 <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span><span class="p">)</span>
<a name="ln-7492"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="o">=</span><span class="n">SurfWorldAz</span>
<a name="ln-7493"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">=</span><span class="n">SurfTilt</span>
<a name="ln-7494"></a>
<a name="ln-7495"></a>      <span class="c">! Sine and cosine of azimuth and tilt</span>
<a name="ln-7496"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7497"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7498"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7499"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-7500"></a>      <span class="c">! Outward normal unit vector (pointing away from room)</span>
<a name="ln-7501"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span>
<a name="ln-7502"></a>      <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-7503"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-7504"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-7505"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>       <span class="o">&lt;</span> <span class="mf">1.d-06</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-7506"></a>      <span class="n">ENDDO</span>
<a name="ln-7507"></a>
<a name="ln-7508"></a>    <span class="c">! Can perform tests on this surface here</span>
<a name="ln-7509"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="o">=</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-7510"></a>    <span class="c">! The following IR view factors are modified in subr. SkyDifSolarShading if there are shadowing</span>
<a name="ln-7511"></a>    <span class="c">! surfaces</span>
<a name="ln-7512"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-7513"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-7514"></a>  <span class="n">ENDIF</span>
<a name="ln-7515"></a>
<a name="ln-7516"></a>  <span class="k">RETURN</span>
<a name="ln-7517"></a>
<a name="ln-7518"></a><span class="k">END SUBROUTINE </span><span class="n">MakeMirrorSurface</span>
<a name="ln-7519"></a>
<a name="ln-7520"></a><span class="k">SUBROUTINE </span><span class="n">GetWindowShadingControlData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-7521"></a>
<a name="ln-7522"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7523"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-7524"></a>          <span class="c">!       DATE WRITTEN   November 1998</span>
<a name="ln-7525"></a>          <span class="c">!       MODIFIED       Aug 2001 (FW): add handling of new ShadingControlIsScheduled</span>
<a name="ln-7526"></a>          <span class="c">!                      and GlareControlIsActive fields</span>
<a name="ln-7527"></a>          <span class="c">!                      Nov 2001 (FW): add ShadingDevice as alternative to ShadedConstruction</span>
<a name="ln-7528"></a>          <span class="c">!                      Dec 2001 (FW): add slat angle controls for blinds</span>
<a name="ln-7529"></a>          <span class="c">!                      Aug 2002 (FW): add Setpoint2; check that specified control type is legal</span>
<a name="ln-7530"></a>          <span class="c">!                      Feb 2003 (FW): add error if Material Name of Shading Device is used with</span>
<a name="ln-7531"></a>          <span class="c">!                        Shading Type = BetweenGlassShade or BetweenGlassBlind</span>
<a name="ln-7532"></a>          <span class="c">!                      Dec 2003 (FW): improve BetweenGlassBlind error messages</span>
<a name="ln-7533"></a>          <span class="c">!                      Feb 2009 (BG): improve error checking for OnIfScheduleAllows</span>
<a name="ln-7534"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7535"></a>
<a name="ln-7536"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7537"></a>          <span class="c">! Reads in the window shading control information</span>
<a name="ln-7538"></a>          <span class="c">! from the input data file, interprets it and puts it in the derived type</span>
<a name="ln-7539"></a>
<a name="ln-7540"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7541"></a>
<a name="ln-7542"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7543"></a>
<a name="ln-7544"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7545"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-7546"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-7547"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-7548"></a>
<a name="ln-7549"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7550"></a>
<a name="ln-7551"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7552"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-7553"></a>
<a name="ln-7554"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7555"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidShadingTypes</span><span class="o">=</span><span class="mi">8</span>
<a name="ln-7556"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">NumValidShadingTypes</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cValidShadingTypes</span><span class="o">=</span><span class="p">(</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-7557"></a>                <span class="s1">&#39;INTERIORSHADE    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7558"></a>                <span class="s1">&#39;EXTERIORSHADE    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7559"></a>                <span class="s1">&#39;EXTERIORSCREEN   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7560"></a>                <span class="s1">&#39;INTERIORBLIND    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7561"></a>                <span class="s1">&#39;EXTERIORBLIND    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7562"></a>                <span class="s1">&#39;BETWEENGLASSSHADE&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7563"></a>                <span class="s1">&#39;BETWEENGLASSBLIND&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7564"></a>                <span class="s1">&#39;SWITCHABLEGLAZING&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-7565"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">NumValidShadingTypes</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ValidShadingTypes</span><span class="o">=</span><span class="p">(</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-7566"></a>       <span class="n">WSC_ST_InteriorShade</span>     <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7567"></a>       <span class="n">WSC_ST_ExteriorShade</span>     <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7568"></a>       <span class="n">WSC_ST_ExteriorScreen</span>    <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7569"></a>       <span class="n">WSC_ST_InteriorBlind</span>     <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7570"></a>       <span class="n">WSC_ST_ExteriorBlind</span>     <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7571"></a>       <span class="n">WSC_ST_BetweenGlassShade</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7572"></a>       <span class="n">WSC_ST_BetweenGlassBlind</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7573"></a>       <span class="n">WSC_ST_SwitchableGlazing</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-7574"></a>
<a name="ln-7575"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidWindowShadingControlTypes</span><span class="o">=</span><span class="mi">21</span>
<a name="ln-7576"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">NumValidWindowShadingControlTypes</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cValidWindowShadingControlTypes</span><span class="o">=</span><span class="p">(</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-7577"></a>       <span class="s1">&#39;ALWAYSON                                      &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7578"></a>       <span class="s1">&#39;ALWAYSOFF                                     &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7579"></a>       <span class="s1">&#39;ONIFSCHEDULEALLOWS                            &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7580"></a>       <span class="s1">&#39;ONIFHIGHSOLARONWINDOW                         &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7581"></a>       <span class="s1">&#39;ONIFHIGHHORIZONTALSOLAR                       &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7582"></a>       <span class="s1">&#39;ONIFHIGHOUTDOORAIRTEMPERATURE                 &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7583"></a>       <span class="s1">&#39;ONIFHIGHZONEAIRTEMPERATURE                    &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7584"></a>       <span class="s1">&#39;ONIFHIGHZONECOOLING                           &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7585"></a>       <span class="s1">&#39;ONIFHIGHGLARE                                 &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7586"></a>       <span class="s1">&#39;MEETDAYLIGHTILLUMINANCESETPOINT               &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7587"></a>       <span class="s1">&#39;ONNIGHTIFLOWOUTDOORTEMPANDOFFDAY              &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7588"></a>       <span class="s1">&#39;ONNIGHTIFLOWINSIDETEMPANDOFFDAY               &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7589"></a>       <span class="s1">&#39;ONNIGHTIFHEATINGANDOFFDAY                     &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7590"></a>       <span class="s1">&#39;ONNIGHTIFLOWOUTDOORTEMPANDONDAYIFCOOLING      &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7591"></a>       <span class="s1">&#39;ONNIGHTIFHEATINGANDONDAYIFCOOLING             &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7592"></a>       <span class="s1">&#39;OFFNIGHTANDONDAYIFCOOLINGANDHIGHSOLARONWINDOW &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7593"></a>       <span class="s1">&#39;ONNIGHTANDONDAYIFCOOLINGANDHIGHSOLARONWINDOW  &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7594"></a>       <span class="s1">&#39;ONIFHIGHOUTDOORAIRTEMPANDHIGHSOLARONWINDOW    &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7595"></a>       <span class="s1">&#39;ONIFHIGHOUTDOORAIRTEMPANDHIGHHORIZONTALSOLAR  &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7596"></a>       <span class="s1">&#39;ONIFHIGHZONEAIRTEMPANDHIGHSOLARONWINDOW       &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7597"></a>       <span class="s1">&#39;ONIFHIGHZONEAIRTEMPANDHIGHHORIZONTALSOLAR     &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-7598"></a>
<a name="ln-7599"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">NumValidWindowShadingControlTypes</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ValidWindowShadingControlTypes</span><span class="o">=</span><span class="p">(</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-7600"></a>       <span class="n">WSCT_ALWAYSON</span>                      <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ALWAYSON                                    &#39;, &amp;</span>
<a name="ln-7601"></a>       <span class="n">WSCT_ALWAYSOFF</span>                     <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ALWAYSOFF                                   &#39;, &amp;</span>
<a name="ln-7602"></a>       <span class="n">WSCT_ONIFSCHEDULED</span>                 <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFSCHEDULEALLOWS                          &#39;, &amp;</span>
<a name="ln-7603"></a>       <span class="n">WSCT_HISOLAR</span>                       <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHSOLARONWINDOW                       &#39;, &amp;</span>
<a name="ln-7604"></a>       <span class="n">WSCT_HIHORZSOLAR</span>                   <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHHORIZONTALSOLAR                     &#39;, &amp;</span>
<a name="ln-7605"></a>       <span class="n">WSCT_HIOUTAIRTEMP</span>                  <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHOUTDOORAIRTEMPERATURE                      &#39;, &amp;</span>
<a name="ln-7606"></a>       <span class="n">WSCT_HIZONEAIRTEMP</span>                 <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHZONEAIRTEMPERATURE                         &#39;, &amp;</span>
<a name="ln-7607"></a>       <span class="n">WSCT_HIZONECOOLING</span>                 <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHZONECOOLING                         &#39;, &amp;</span>
<a name="ln-7608"></a>       <span class="n">WSCT_HIGLARE</span>                       <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHGLARE                               &#39;, &amp;</span>
<a name="ln-7609"></a>       <span class="n">WSCT_MEETDAYLILUMSETP</span>              <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;MEETDAYLIGHTILLUMINANCESETPOINT             &#39;, &amp;</span>
<a name="ln-7610"></a>       <span class="n">WSCT_ONNIGHTLOOUTTEMP_OFFDAY</span>       <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONNIGHTIFLOWOUTDOORTEMPANDOFFDAY              &#39;, &amp;</span>
<a name="ln-7611"></a>       <span class="n">WSCT_ONNIGHTLOINTEMP_OFFDAY</span>        <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONNIGHTIFLOWINSIDETEMPANDOFFDAY               &#39;, &amp;</span>
<a name="ln-7612"></a>       <span class="n">WSCT_ONNIGHTIFHEATING_OFFDAY</span>       <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONNIGHTIFHEATINGANDOFFDAY                     &#39;, &amp;</span>
<a name="ln-7613"></a>       <span class="n">WSCT_ONNIGHTLOOUTTEMP_ONDAYCOOLING</span> <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONNIGHTIFLOWOUTDOORTEMPANDONDAYIFCOOLING      &#39;, &amp;</span>
<a name="ln-7614"></a>       <span class="n">WSCT_ONNIGHTIFHEATING_ONDAYCOOLING</span> <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONNIGHTIFHEATINGANDONDAYIFCOOLING             &#39;, &amp;</span>
<a name="ln-7615"></a>       <span class="n">WSCT_OFFNIGHT_ONDAY_HISOLARWINDOW</span>  <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;OFFNIGHTANDONDAYIFCOOLINGANDHIGHSOLARONWINDOW &#39;, &amp;</span>
<a name="ln-7616"></a>       <span class="n">WSCT_ONNIGHT_ONDAY_HISOLARWINDOW</span>   <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONNIGHTANDONDAYIFCOOLINGANDHIGHSOLARONWINDOW  &#39;, &amp;</span>
<a name="ln-7617"></a>       <span class="n">WSCT_ONHIOUTTEMP_HISOLARWINDOW</span>     <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHOUTDOORAIRTEMPANDHIGHSOLARONWINDOW  &#39;, &amp;</span>
<a name="ln-7618"></a>       <span class="n">WSCT_ONHIOUTTEMP_HIHORZSOLAR</span>       <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHOUTDOORAIRTEMPANDHIGHHORIZONTALSOLAR&#39;, &amp;</span>
<a name="ln-7619"></a>       <span class="n">WSCT_ONHIZONETEMP_HISOLARWINDOW</span>    <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! &#39;ONIFHIGHZONEAIRTEMPANDHIGHSOLARONWINDOW     &#39;, &amp;</span>
<a name="ln-7620"></a>       <span class="n">WSCT_ONHIZONETEMP_HIHORZSOLAR</span>      <span class="o">/</span><span class="p">)</span> <span class="c">!  &#39;ONIFHIGHZONEAIRTEMPANDHIGHHORIZONTALSOLAR   &#39;/)</span>
<a name="ln-7621"></a>
<a name="ln-7622"></a>
<a name="ln-7623"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-7624"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-7625"></a>
<a name="ln-7626"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7627"></a>
<a name="ln-7628"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-7629"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ControlNumAlpha</span>   <span class="c">! Number of control alpha names being passed</span>
<a name="ln-7630"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ControlNumProp</span>    <span class="c">! Number of control properties being passed</span>
<a name="ln-7631"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ControlNum</span>        <span class="c">! DO loop counter/index for window shading control number</span>
<a name="ln-7632"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IShadedConst</span>      <span class="c">! Construction number of shaded construction</span>
<a name="ln-7633"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IShadingDevice</span>    <span class="c">! Material number of shading device</span>
<a name="ln-7634"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NLayers</span>           <span class="c">! Layers in shaded construction</span>
<a name="ln-7635"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInName</span>
<a name="ln-7636"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-7637"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-7638"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ShTyp</span>       <span class="c">! Shading type</span>
<a name="ln-7639"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ControlType</span> <span class="c">! Shading control type</span>
<a name="ln-7640"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">BGShadeBlindError</span>  <span class="c">! True if problem with construction that is supposed to have between-glass</span>
<a name="ln-7641"></a>                                <span class="c">! shade or blind</span>
<a name="ln-7642"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>
<a name="ln-7643"></a>
<a name="ln-7644"></a>          <span class="c">! FLOW:</span>
<a name="ln-7645"></a><span class="c">! Get the total number of window shading control blocks</span>
<a name="ln-7646"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;WindowProperty:ShadingControl&#39;</span>
<a name="ln-7647"></a>  <span class="n">TotWinShadingControl</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7648"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">TotWinShadingControl</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-7649"></a>
<a name="ln-7650"></a><span class="k">  ALLOCATE</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">TotWinShadingControl</span><span class="p">))</span>
<a name="ln-7651"></a>
<a name="ln-7652"></a>  <span class="n">ControlNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7653"></a>  <span class="k">DO </span><span class="n">Loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotWinShadingControl</span>
<a name="ln-7654"></a>
<a name="ln-7655"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">ControlNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7656"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">ControlNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7657"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7658"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-7659"></a>
<a name="ln-7660"></a>    <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7661"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7662"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WindowShadingControl</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">ControlNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-7663"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7664"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7665"></a>      <span class="k">CYCLE</span>
<a name="ln-7666"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-7667"></a>
<a name="ln-7668"></a>    <span class="n">ControlNum</span><span class="o">=</span><span class="n">ControlNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7669"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set the Control Name in the Derived Type</span>
<a name="ln-7670"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-7671"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingDevice</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-7672"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-7673"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">SetPoint</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7674"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">SetPoint2</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7675"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7676"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7677"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7678"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7679"></a>    <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">SlatAngleSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-7680"></a>
<a name="ln-7681"></a>    <span class="n">ControlType</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-7682"></a>
<a name="ln-7683"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ControlType</span><span class="o">==</span><span class="s1">&#39;SCHEDULE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7684"></a><span class="k">      </span><span class="n">ControlType</span> <span class="o">=</span> <span class="s1">&#39;ONIFSCHEDULEALLOWS&#39;</span>
<a name="ln-7685"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7686"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7687"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7688"></a>             <span class="s1">&#39;&quot; is using obsolete &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7689"></a>             <span class="s1">&#39;&quot;, changing to &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7690"></a>      <span class="c">! Error if schedule has not been specified</span>
<a name="ln-7691"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7692"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7693"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7694"></a>              <span class="s1">&#39; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7695"></a>              <span class="s1">&#39;&quot; but a schedule has not been specified.&#39;</span><span class="p">)</span>
<a name="ln-7696"></a>      <span class="k">END IF</span>
<a name="ln-7697"></a><span class="k">    END IF</span>
<a name="ln-7698"></a>
<a name="ln-7699"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ControlType</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;SCHEDULEAND&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7700"></a><span class="k">      </span><span class="n">ControlType</span> <span class="o">=</span> <span class="s1">&#39;ONIFHIGH&#39;</span><span class="o">//</span><span class="n">ControlType</span><span class="p">(</span><span class="mi">12</span><span class="p">:)</span>
<a name="ln-7701"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7702"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7703"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7704"></a>             <span class="s1">&#39;&quot; is using obsolete &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7705"></a>             <span class="s1">&#39;&quot;, changing to &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7706"></a>      <span class="c">! Error if schedule has not been specified</span>
<a name="ln-7707"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7708"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7709"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7710"></a>              <span class="s1">&#39; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7711"></a>              <span class="s1">&#39;&quot; but a schedule has not been specified.&#39;</span><span class="p">)</span>
<a name="ln-7712"></a>      <span class="k">END IF</span>
<a name="ln-7713"></a><span class="k">    END IF</span>
<a name="ln-7714"></a>
<a name="ln-7715"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ControlType</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;GLAREOR&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7716"></a><span class="k">      </span><span class="n">ControlType</span> <span class="o">=</span> <span class="s1">&#39;ONIFHIGH&#39;</span><span class="o">//</span><span class="n">ControlType</span><span class="p">(</span><span class="mi">8</span><span class="p">:)</span>
<a name="ln-7717"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7718"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7719"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7720"></a>             <span class="s1">&#39;&quot; is using obsolete &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7721"></a>             <span class="s1">&#39;&quot;, changing to &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7722"></a>    <span class="k">END IF</span>
<a name="ln-7723"></a>
<a name="ln-7724"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ControlType</span><span class="o">==</span><span class="s1">&#39;GLARE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7725"></a><span class="k">      </span><span class="n">ControlType</span> <span class="o">=</span> <span class="s1">&#39;ONIFHIGHGLARE&#39;</span>
<a name="ln-7726"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7727"></a>      <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7728"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7729"></a>             <span class="s1">&#39;&quot; is using obsolete &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7730"></a>             <span class="s1">&#39;&quot;, changing to &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7731"></a>    <span class="k">END IF</span>
<a name="ln-7732"></a>
<a name="ln-7733"></a><span class="k">    IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingDevice</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7734"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingDevice</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">Screen</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7735"></a>         <span class="p">(</span><span class="n">ControlType</span> <span class="o">==</span> <span class="s1">&#39;ALWAYSON&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ControlType</span> <span class="o">==</span> <span class="s1">&#39;ALWAYSOFF&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7736"></a>          <span class="n">ControlType</span> <span class="o">==</span> <span class="s1">&#39;ONIFSCHEDULEALLOWS&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7737"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7738"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7739"></a>             <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7740"></a>             <span class="s1">&#39;&quot; for exterior screens.&#39;</span><span class="p">)</span>
<a name="ln-7741"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid shading control types for exterior window screens&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7742"></a>             <span class="s1">&#39; are ALWAYSON, ALWAYSOFF, or ONIFSCHEDULEALLOWS.&#39;</span><span class="p">)</span>
<a name="ln-7743"></a>      <span class="k">END IF</span>
<a name="ln-7744"></a><span class="k">    ELSE</span>
<a name="ln-7745"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7746"></a><span class="k">        </span><span class="n">Construct</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span><span class="p">)%</span><span class="n">IsUsed</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7747"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">Screen</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7748"></a>           <span class="p">(</span><span class="n">ControlType</span> <span class="o">==</span> <span class="s1">&#39;ALWAYSON&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ControlType</span> <span class="o">==</span> <span class="s1">&#39;ALWAYSOFF&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7749"></a>            <span class="n">ControlType</span> <span class="o">==</span> <span class="s1">&#39;ONIFSCHEDULEALLOWS&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7750"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7751"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7752"></a>               <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7753"></a>               <span class="s1">&#39;&quot; for exterior screens.&#39;</span><span class="p">)</span>
<a name="ln-7754"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid shading control types for exterior window screens&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7755"></a>               <span class="s1">&#39; are ALWAYSON, ALWAYSOFF, or ONIFSCHEDULEALLOWS.&#39;</span><span class="p">)</span>
<a name="ln-7756"></a>        <span class="k">END IF</span>
<a name="ln-7757"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7758"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7759"></a>           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7760"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;A valid construction is required.&#39;</span><span class="p">)</span>
<a name="ln-7761"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7762"></a>      <span class="k">ELSE</span>
<a name="ln-7763"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7764"></a>           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is invalid.&#39;</span><span class="p">)</span>
<a name="ln-7765"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Construction=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; was used. A valid construction is required.&#39;</span><span class="p">)</span>
<a name="ln-7766"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7767"></a>      <span class="n">ENDIF</span>
<a name="ln-7768"></a>    <span class="k">END IF</span>
<a name="ln-7769"></a>
<a name="ln-7770"></a>    <span class="c">! Warning if setpoint is unintentionally zero</span>
<a name="ln-7771"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">SetPoint</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7772"></a>      <span class="n">ControlType</span> <span class="o">/=</span> <span class="s1">&#39;ALWAYSON&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7773"></a>      <span class="n">ControlType</span> <span class="o">/=</span> <span class="s1">&#39;ALWAYSOFF&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7774"></a>      <span class="n">ControlType</span> <span class="o">/=</span> <span class="s1">&#39;ONIFSCHEDULEALLOWS&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ControlType</span> <span class="o">/=</span> <span class="s1">&#39;SCHEDULE&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7775"></a>      <span class="n">ControlType</span> <span class="o">/=</span> <span class="s1">&#39;ONIFHIGHGLARE&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ControlType</span> <span class="o">/=</span> <span class="s1">&#39;GLARE&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7776"></a>      <span class="n">ControlType</span> <span class="o">/=</span> <span class="s1">&#39;DAYLIGHTILLUMINANCE&#39;</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7777"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7778"></a>             <span class="s1">&#39;&quot;, The first SetPoint is zero.&#39;</span><span class="p">)</span>
<a name="ln-7779"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..You may have forgotten to specify that setpoint.&#39;</span><span class="p">)</span>
<a name="ln-7780"></a>    <span class="k">END IF</span>
<a name="ln-7781"></a>
<a name="ln-7782"></a>    <span class="c">! Upward compatibility for old Shading Control Type names</span>
<a name="ln-7783"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ControlType</span><span class="o">==</span><span class="s1">&#39;SOLARONWINDOW&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ControlType</span><span class="o">==</span><span class="s1">&#39;HORIZONTALSOLAR&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ControlType</span><span class="o">==</span><span class="s1">&#39;OUTSIDEAIRTEMP&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7784"></a>       <span class="n">ControlType</span><span class="o">==</span><span class="s1">&#39;ZONEAIRTEMP&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ControlType</span><span class="o">==</span><span class="s1">&#39;ZONECOOLING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7785"></a><span class="k">       </span><span class="n">ControlType</span> <span class="o">=</span> <span class="s1">&#39;ONIFHIGH&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span>
<a name="ln-7786"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7787"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7788"></a>       <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7789"></a>             <span class="s1">&#39;&quot; is using obsolete &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7790"></a>             <span class="s1">&#39;&quot;, changing to &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7791"></a>    <span class="k">END IF</span>
<a name="ln-7792"></a>
<a name="ln-7793"></a>    <span class="c">! Error if illegal control type</span>
<a name="ln-7794"></a>    <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">ControlType</span><span class="p">,</span><span class="n">cValidWindowShadingControlTypes</span><span class="p">,</span><span class="n">NumValidWindowShadingControlTypes</span><span class="p">)</span>
<a name="ln-7795"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7796"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7797"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7798"></a>             <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7799"></a>    <span class="k">ELSE</span>
<a name="ln-7800"></a><span class="k">     </span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">=</span> <span class="n">ValidWindowShadingControlTypes</span><span class="p">(</span><span class="n">Found</span><span class="p">)</span>
<a name="ln-7801"></a>    <span class="k">END IF</span>
<a name="ln-7802"></a>
<a name="ln-7803"></a>
<a name="ln-7804"></a>    <span class="c">! Error checks</span>
<a name="ln-7805"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;YES&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;NO&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7806"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7807"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7808"></a>             <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7809"></a>    <span class="k">END IF</span>
<a name="ln-7810"></a><span class="k">    IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;YES&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;NO&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7811"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7812"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7813"></a>             <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7814"></a>    <span class="k">END IF</span>
<a name="ln-7815"></a>
<a name="ln-7816"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">==</span> <span class="n">WSCT_ONIFSCHEDULED</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7817"></a>        <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! CR 7709 BG</span>
<a name="ln-7818"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7819"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; invalid, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7820"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be set to &quot;Yes&quot; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = OnIfScheduleAllows&#39;</span><span class="p">)</span>
<a name="ln-7821"></a>    <span class="n">ENDIF</span>
<a name="ln-7822"></a>
<a name="ln-7823"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;FIXEDSLATANGLE&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;SCHEDULEDSLATANGLE&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7824"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;BLOCKBEAMSOLAR&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7825"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7826"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7827"></a>             <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7828"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;FIXEDSLATANGLE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7829"></a><span class="k">      </span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">SlatAngleControlForBlinds</span> <span class="o">=</span> <span class="n">WSC_SAC_FixedSlatAngle</span>
<a name="ln-7830"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;SCHEDULEDSLATANGLE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7831"></a><span class="k">      </span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">SlatAngleControlForBlinds</span> <span class="o">=</span> <span class="n">WSC_SAC_ScheduledSlatAngle</span>
<a name="ln-7832"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;BLOCKBEAMSOLAR&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7833"></a><span class="k">      </span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">SlatAngleControlForBlinds</span> <span class="o">=</span> <span class="n">WSC_SAC_BlockBeamSolar</span>
<a name="ln-7834"></a>    <span class="k">END IF</span>
<a name="ln-7835"></a>
<a name="ln-7836"></a>    <span class="c">! For upward compatibility change old &quot;noninsulating&quot; and &quot;insulating&quot; shade types to</span>
<a name="ln-7837"></a>    <span class="c">! INTERIORSHADE or EXTERIORSHADE</span>
<a name="ln-7838"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;INTERIORNONINSULATINGSHADE&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-7839"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;INTERIORINSULATINGSHADE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7840"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7841"></a>             <span class="s1">&#39;&quot; is using obsolete &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7842"></a>             <span class="s1">&#39;&quot;, changing to &quot;InteriorShade&quot;&#39;</span><span class="p">)</span>
<a name="ln-7843"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">=</span> <span class="n">WSC_ST_InteriorShade</span>
<a name="ln-7844"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;INTERIORSHADE&#39;</span>
<a name="ln-7845"></a>    <span class="n">ENDIF</span>
<a name="ln-7846"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;EXTERIORNONINSULATINGSHADE&#39;</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-7847"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;EXTERIORINSULATINGSHADE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7848"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7849"></a>             <span class="s1">&#39;&quot; is using obsolete &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7850"></a>             <span class="s1">&#39;&quot;, changing to &quot;ExteriorShade&quot;&#39;</span><span class="p">)</span>
<a name="ln-7851"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">=</span> <span class="n">WSC_ST_ExteriorShade</span>
<a name="ln-7852"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;EXTERIORSHADE&#39;</span>
<a name="ln-7853"></a>    <span class="n">ENDIF</span>
<a name="ln-7854"></a>
<a name="ln-7855"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ControlType</span> <span class="o">==</span> <span class="s1">&#39;MEETDAYLIGHTILLUMINANCESETPOINT&#39;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7856"></a>        <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;SWITCHABLEGLAZING&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7857"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7858"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7859"></a>             <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7860"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be SwitchableGlazing for this control, but&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7861"></a>                <span class="s1">&#39; entered type=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7862"></a>    <span class="n">ENDIF</span>
<a name="ln-7863"></a>
<a name="ln-7864"></a>    <span class="c">! Check for illegal shading type name</span>
<a name="ln-7865"></a>    <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">cValidShadingTypes</span><span class="p">,</span><span class="n">NumValidShadingTypes</span><span class="p">)</span>
<a name="ln-7866"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7867"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7868"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7869"></a>             <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7870"></a>    <span class="k">ELSE</span>
<a name="ln-7871"></a><span class="k">      </span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">=</span><span class="n">ValidShadingTypes</span><span class="p">(</span><span class="n">Found</span><span class="p">)</span>
<a name="ln-7872"></a>    <span class="k">END IF</span>
<a name="ln-7873"></a>
<a name="ln-7874"></a><span class="k">    </span><span class="n">ShTyp</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span>
<a name="ln-7875"></a>    <span class="n">IShadedConst</span>   <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-7876"></a>    <span class="n">IShadingDevice</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingDevice</span>
<a name="ln-7877"></a>
<a name="ln-7878"></a>
<a name="ln-7879"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">IShadedConst</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IShadingDevice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7880"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7881"></a>          <span class="s1">&#39;&quot; has no matching shaded construction or shading device.&#39;</span><span class="p">)</span>
<a name="ln-7882"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7883"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">IShadedConst</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IShadingDevice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7884"></a><span class="k">      IF</span><span class="p">(</span><span class="n">ShTyp</span> <span class="o">==</span> <span class="n">WSC_ST_SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7885"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7886"></a>          <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= SwitchableGlazing but no matching shaded construction&#39;</span><span class="p">)</span>
<a name="ln-7887"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7888"></a>      <span class="k">END IF</span>
<a name="ln-7889"></a><span class="k">      IF</span><span class="p">((</span><span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_InteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_ExteriorShade</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Shade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7890"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7891"></a>          <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= InteriorShade or ExteriorShade but matching shading device is not a window shade&#39;</span><span class="p">)</span>
<a name="ln-7892"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in error=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7893"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7894"></a>      <span class="k">END IF</span>
<a name="ln-7895"></a><span class="k">      IF</span><span class="p">((</span><span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_ExteriorScreen</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Screen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7896"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7897"></a>          <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= ExteriorScreen but matching shading device is not a window screen&#39;</span><span class="p">)</span>
<a name="ln-7898"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in error=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7899"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7900"></a>      <span class="k">END IF</span>
<a name="ln-7901"></a><span class="k">      IF</span><span class="p">((</span><span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_InteriorBlind</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_ExteriorBlind</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7902"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7903"></a>          <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= InteriorBlind or ExteriorBlind but matching shading device is not a window blind&#39;</span><span class="p">)</span>
<a name="ln-7904"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in error=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7905"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7906"></a>      <span class="k">END IF</span>
<a name="ln-7907"></a><span class="k">      IF</span><span class="p">(</span><span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7908"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7909"></a>        <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= BetweenGlassShade or BetweenGlassBlind and&#39;</span><span class="p">)</span>
<a name="ln-7910"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is specified. This is illegal. Specify shaded construction instead.&#39;</span><span class="p">)</span>
<a name="ln-7911"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7912"></a>      <span class="k">END IF</span>
<a name="ln-7913"></a><span class="k">    ELSE IF</span><span class="p">(</span><span class="n">IShadedConst</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IShadingDevice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7914"></a><span class="k">      </span><span class="n">IShadingDevice</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7915"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7916"></a>                  <span class="s1">&#39;&quot; Both &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; are specified.&#39;</span><span class="p">)</span>
<a name="ln-7917"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; will be used.&#39;</span><span class="p">)</span>
<a name="ln-7918"></a>    <span class="k">END IF</span>
<a name="ln-7919"></a>
<a name="ln-7920"></a>    <span class="c">! If type = interior or exterior shade or blind require that the shaded construction</span>
<a name="ln-7921"></a>    <span class="c">! have a shade layer in the correct position</span>
<a name="ln-7922"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">IShadedConst</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7923"></a>
<a name="ln-7924"></a><span class="k">      </span><span class="n">NLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-7925"></a>      <span class="n">BGShadeBlindError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7926"></a>      <span class="n">IShadingDevice</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7927"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">NLayers</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7928"></a><span class="k">        IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorShade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7929"></a><span class="k">          </span><span class="n">IShadingDevice</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">NLayers</span><span class="p">)</span>
<a name="ln-7930"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">NLayers</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Shade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7931"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7932"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7933"></a>              <span class="s1">&#39;&quot; the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7934"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7935"></a>               <span class="s1">&#39;&quot; should have a shade layer on the inside of the window.&#39;</span><span class="p">)</span>
<a name="ln-7936"></a>          <span class="k">END IF</span>
<a name="ln-7937"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorShade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7938"></a><span class="k">          </span><span class="n">IShadingDevice</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7939"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Shade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7940"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7941"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7942"></a>              <span class="s1">&#39;&quot; the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7943"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7944"></a>               <span class="s1">&#39;&quot; should have a shade layer on the outside of the window.&#39;</span><span class="p">)</span>
<a name="ln-7945"></a>          <span class="k">END IF</span>
<a name="ln-7946"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorScreen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7947"></a><span class="k">          </span><span class="n">IShadingDevice</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7948"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Screen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7949"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7950"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7951"></a>              <span class="s1">&#39;&quot; the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7952"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7953"></a>               <span class="s1">&#39;&quot; should have a screen layer on the outside of the window.&#39;</span><span class="p">)</span>
<a name="ln-7954"></a>          <span class="k">END IF</span>
<a name="ln-7955"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7956"></a><span class="k">          </span><span class="n">IShadingDevice</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">NLayers</span><span class="p">)</span>
<a name="ln-7957"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">NLayers</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7958"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7959"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7960"></a>              <span class="s1">&#39;&quot; the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7961"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7962"></a>               <span class="s1">&#39;&quot; should have a blind layer on the inside of the window.&#39;</span><span class="p">)</span>
<a name="ln-7963"></a>          <span class="k">END IF</span>
<a name="ln-7964"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7965"></a><span class="k">          </span><span class="n">IShadingDevice</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7966"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7967"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7968"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7969"></a>              <span class="s1">&#39;&quot; the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7970"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7971"></a>               <span class="s1">&#39;&quot; should have a blind layer on the outside of the window.&#39;</span><span class="p">)</span>
<a name="ln-7972"></a>          <span class="k">END IF</span>
<a name="ln-7973"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassShade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7974"></a><span class="k">          IF</span><span class="p">(</span><span class="n">NLayers</span> <span class="o">/=</span> <span class="mi">5</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NLayers</span> <span class="o">/=</span> <span class="mi">7</span><span class="p">)</span> <span class="n">BGShadeBlindError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7975"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">NLayers</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7976"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Shade</span><span class="p">)</span> <span class="n">BGShadeBlindError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7977"></a>          <span class="k">END IF</span>
<a name="ln-7978"></a><span class="k">          IF</span><span class="p">(</span><span class="n">NLayers</span><span class="o">==</span><span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7979"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">5</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Shade</span><span class="p">)</span> <span class="n">BGShadeBlindError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7980"></a>          <span class="k">END IF</span>
<a name="ln-7981"></a><span class="k">          IF</span><span class="p">(</span><span class="n">BGShadeBlindError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7982"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7983"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7984"></a>              <span class="s1">&#39;&quot; the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7985"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7986"></a>               <span class="s1">&#39;&quot; should have two or three glass layers and a&#39;</span><span class="p">)</span>
<a name="ln-7987"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;between-glass shade layer with a gas layer on each side.&#39;</span><span class="p">)</span>
<a name="ln-7988"></a>          <span class="k">END IF</span>
<a name="ln-7989"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7990"></a><span class="k">          IF</span><span class="p">(</span><span class="n">NLayers</span> <span class="o">/=</span> <span class="mi">5</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NLayers</span> <span class="o">/=</span> <span class="mi">7</span><span class="p">)</span> <span class="n">BGShadeBlindError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7991"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">NLayers</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7992"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="n">BGShadeBlindError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7993"></a>          <span class="k">END IF</span>
<a name="ln-7994"></a><span class="k">          IF</span><span class="p">(</span><span class="n">NLayers</span><span class="o">==</span><span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7995"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IShadedConst</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">5</span><span class="p">))%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="n">BGShadeBlindError</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7996"></a>          <span class="k">END IF</span>
<a name="ln-7997"></a><span class="k">          IF</span><span class="p">(</span><span class="n">BGShadeBlindError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7998"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7999"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8000"></a>              <span class="s1">&#39;&quot; the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8001"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8002"></a>               <span class="s1">&#39;&quot; should have two or three glass layers and a&#39;</span><span class="p">)</span>
<a name="ln-8003"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;between-glass blind layer with a gas layer on each side.&#39;</span><span class="p">)</span>
<a name="ln-8004"></a>          <span class="k">END IF</span>
<a name="ln-8005"></a><span class="k">        END IF</span>
<a name="ln-8006"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-8007"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">IShadingDevice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8008"></a><span class="k">        IF</span><span class="p">((</span><span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_InteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_ExteriorShade</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Shade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8009"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8010"></a>            <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= InteriorShade or ExteriorShade &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8011"></a>            <span class="s1">&#39;but matching shading device is not a window shade&#39;</span><span class="p">)</span>
<a name="ln-8012"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shading Device in error=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-8013"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8014"></a>        <span class="k">END IF</span>
<a name="ln-8015"></a><span class="k">        IF</span><span class="p">((</span><span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_ExteriorScreen</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">Screen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8016"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8017"></a>            <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= ExteriorScreen &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8018"></a>            <span class="s1">&#39;but matching shading device is not an exterior window screen.&#39;</span><span class="p">)</span>
<a name="ln-8019"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shading Device in error=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-8020"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8021"></a>        <span class="k">END IF</span>
<a name="ln-8022"></a><span class="k">        IF</span><span class="p">((</span><span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_InteriorBlind</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShTyp</span><span class="o">==</span><span class="n">WSC_ST_ExteriorBlind</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8023"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ControlNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8024"></a>            <span class="s1">&#39;&quot; has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;= InteriorBlind or ExteriorBlind &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8025"></a>            <span class="s1">&#39;but matching shading device is not a window blind.&#39;</span><span class="p">)</span>
<a name="ln-8026"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Shading Device in error=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">IShadingDevice</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-8027"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8028"></a>        <span class="k">END IF</span>
<a name="ln-8029"></a><span class="k">      END IF</span>
<a name="ln-8030"></a>
<a name="ln-8031"></a><span class="k">    END IF</span>
<a name="ln-8032"></a>
<a name="ln-8033"></a><span class="k">  END DO</span>  <span class="c">! End of loop over window shading controls</span>
<a name="ln-8034"></a>
<a name="ln-8035"></a><span class="k">RETURN</span>
<a name="ln-8036"></a>
<a name="ln-8037"></a><span class="k">END SUBROUTINE </span><span class="n">GetWindowShadingControlData</span>
<a name="ln-8038"></a>
<a name="ln-8039"></a><span class="k">SUBROUTINE </span><span class="n">GetStormWindowData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8040"></a>
<a name="ln-8041"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8042"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8043"></a>          <span class="c">!       DATE WRITTEN   December 2003</span>
<a name="ln-8044"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8045"></a>
<a name="ln-8046"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8047"></a>
<a name="ln-8048"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8049"></a>          <span class="c">! Reads in the storm window data from the input file,</span>
<a name="ln-8050"></a>          <span class="c">! interprets it and puts it in the derived type</span>
<a name="ln-8051"></a>
<a name="ln-8052"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8053"></a>
<a name="ln-8054"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8055"></a>
<a name="ln-8056"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8057"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-8058"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-8059"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span><span class="p">,</span><span class="n">TrimSigDigits</span>
<a name="ln-8060"></a>
<a name="ln-8061"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8062"></a>
<a name="ln-8063"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8064"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-8065"></a>
<a name="ln-8066"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-8067"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-8068"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-8069"></a>
<a name="ln-8070"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8071"></a>
<a name="ln-8072"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>            <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-8073"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StormWinNumAlpha</span>   <span class="c">! Number of alpha names being passed</span>
<a name="ln-8074"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StormWinNumProp</span>    <span class="c">! Number of properties being passed</span>
<a name="ln-8075"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StormWinNum</span>        <span class="c">! Index for storm window number</span>
<a name="ln-8076"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">loop</span>               <span class="c">! Do loop counter</span>
<a name="ln-8077"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>            <span class="c">! Surface number</span>
<a name="ln-8078"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatNum</span>             <span class="c">! Material number</span>
<a name="ln-8079"></a>
<a name="ln-8080"></a>          <span class="c">! FLOW:</span>
<a name="ln-8081"></a>
<a name="ln-8082"></a>  <span class="c">! Get the total number of storm window input objects</span>
<a name="ln-8083"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;WindowProperty:StormWindow&#39;</span>
<a name="ln-8084"></a>  <span class="n">TotStormWin</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8085"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">TotStormWin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-8086"></a>
<a name="ln-8087"></a><span class="k">  ALLOCATE</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">TotStormWin</span><span class="p">))</span>
<a name="ln-8088"></a>
<a name="ln-8089"></a>  <span class="n">StormWinNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8090"></a>  <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotStormWin</span>
<a name="ln-8091"></a>
<a name="ln-8092"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">StormWinNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8093"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">StormWinNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8094"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8095"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-8096"></a>    <span class="n">StormWinNum</span><span class="o">=</span><span class="n">StormWinNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8097"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">BaseWindowNum</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-8098"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">StormWinMaterialNum</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-8099"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">StormWinDistance</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8100"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOn</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8101"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-8102"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DateOn</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOn</span><span class="p">,</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8103"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8104"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-8105"></a>    <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DateOff</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOff</span><span class="p">,</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8106"></a>
<a name="ln-8107"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DateOn</span> <span class="o">==</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DateOff</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8108"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date On = Date Off -- not allowed,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8109"></a>                           <span class="s1">&#39; occured in WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8110"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8111"></a>    <span class="n">ENDIF</span>
<a name="ln-8112"></a>
<a name="ln-8113"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOn</span><span class="p">)</span>
<a name="ln-8114"></a>
<a name="ln-8115"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-8116"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8117"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date On (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8118"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8119"></a>                                 <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8120"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8121"></a>       <span class="n">ENDIF</span>
<a name="ln-8122"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-8123"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8124"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date On (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8125"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8126"></a>                                 <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8127"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8128"></a>       <span class="n">ENDIF</span>
<a name="ln-8129"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8130"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span> <span class="o">&gt;</span> <span class="mi">29</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8131"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date On (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8132"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8133"></a>                                 <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8134"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8135"></a>       <span class="n">ENDIF</span>
<a name="ln-8136"></a>     <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-8137"></a>       <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date On Month [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8138"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOn</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8139"></a>                               <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8140"></a>       <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8141"></a>    <span class="k">END SELECT</span>
<a name="ln-8142"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOff</span><span class="p">)</span>
<a name="ln-8143"></a>
<a name="ln-8144"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-8145"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8146"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date Off (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8147"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8148"></a>                                 <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8149"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8150"></a>       <span class="n">ENDIF</span>
<a name="ln-8151"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-8152"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8153"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date Off (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8154"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8155"></a>                                 <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8156"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8157"></a>       <span class="n">ENDIF</span>
<a name="ln-8158"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8159"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span> <span class="o">&gt;</span> <span class="mi">29</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8160"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date Off (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8161"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8162"></a>                                 <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8163"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8164"></a>       <span class="n">ENDIF</span>
<a name="ln-8165"></a>     <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-8166"></a>       <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Date Off Month [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8167"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOff</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8168"></a>                               <span class="s1">&#39; invalid for WindowProperty:StormWindow Input #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)))</span>
<a name="ln-8169"></a>       <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8170"></a>    <span class="k">END SELECT</span>
<a name="ln-8171"></a><span class="k">  END DO</span>
<a name="ln-8172"></a>
<a name="ln-8173"></a>  <span class="c">! Error checks</span>
<a name="ln-8174"></a>
<a name="ln-8175"></a>  <span class="k">DO </span><span class="n">StormWinNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotStormWin</span>
<a name="ln-8176"></a>    <span class="c">! Require BaseWindowNum be that of an exterior window</span>
<a name="ln-8177"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">BaseWindowNum</span>
<a name="ln-8178"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8179"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8180"></a>         <span class="s1">&#39;&quot; invalid.&#39;</span><span class="p">)</span>
<a name="ln-8181"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8182"></a>    <span class="k">ELSE</span>
<a name="ln-8183"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8184"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8185"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;cannot be used with surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8186"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;because that surface is not an exterior window.&#39;</span><span class="p">)</span>
<a name="ln-8187"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8188"></a>      <span class="k">END IF</span>
<a name="ln-8189"></a><span class="k">    END IF</span>
<a name="ln-8190"></a>
<a name="ln-8191"></a>    <span class="c">! Require that storm window material be glass</span>
<a name="ln-8192"></a>    <span class="n">MatNum</span> <span class="o">=</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">StormWinMaterialNum</span>
<a name="ln-8193"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8194"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MatNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8195"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8196"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8197"></a>            <span class="s1">&#39;&quot; not found as storm window layer.&#39;</span><span class="p">)</span>
<a name="ln-8198"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8199"></a>      <span class="k">ELSE</span>
<a name="ln-8200"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatNum</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">WindowGlass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8201"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8202"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8203"></a>              <span class="s1">&#39;must be a WindowMaterial:Glazing or WindowMaterial:Glazing:RefractionExtinctionMethod&#39;</span><span class="p">)</span>
<a name="ln-8204"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8205"></a>        <span class="k">END IF</span>
<a name="ln-8206"></a><span class="k">      END IF</span>
<a name="ln-8207"></a><span class="k">    END IF</span>
<a name="ln-8208"></a>
<a name="ln-8209"></a>    <span class="c">! Error if base window has airflow control</span>
<a name="ln-8210"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8211"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowControlType</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8212"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8213"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; cannot be used &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8214"></a>          <span class="s1">&#39;because it is an airflow window (i.e., has WindowProperty:AirflowControl specified)&#39;</span><span class="p">)</span>
<a name="ln-8215"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8216"></a>      <span class="k">END IF</span>
<a name="ln-8217"></a><span class="k">    END IF</span>
<a name="ln-8218"></a>
<a name="ln-8219"></a>    <span class="c">! Check for reversal of on and off times</span>
<a name="ln-8220"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8221"></a><span class="k">      IF</span><span class="p">((</span><span class="n">Latitude</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOn</span> <span class="o">&lt;</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOff</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8222"></a>         <span class="p">(</span><span class="n">Latitude</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOn</span> <span class="o">&gt;</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOff</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-8223"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; check times that storm window&#39;</span><span class="p">)</span>
<a name="ln-8224"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;is put on (month=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOn</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8225"></a>           <span class="s1">&#39;, day=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOn</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8226"></a>           <span class="s1">&#39; and taken off (month=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">MonthOff</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8227"></a>           <span class="s1">&#39;, day=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">DayOfMonthOff</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;);&#39;</span><span class="p">)</span>
<a name="ln-8228"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;these times may be reversed for your building latitude=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8229"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Latitude</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; deg.&#39;</span><span class="p">)</span>
<a name="ln-8230"></a>      <span class="k">END IF</span>
<a name="ln-8231"></a><span class="k">    END IF</span>
<a name="ln-8232"></a><span class="k">  END DO</span>
<a name="ln-8233"></a>
<a name="ln-8234"></a><span class="k">RETURN</span>
<a name="ln-8235"></a><span class="k">END SUBROUTINE </span><span class="n">GetStormWindowData</span>
<a name="ln-8236"></a>
<a name="ln-8237"></a><span class="k">SUBROUTINE </span><span class="n">GetWindowGapAirflowControlData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8238"></a>
<a name="ln-8239"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8240"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8241"></a>          <span class="c">!       DATE WRITTEN   Feb 2003</span>
<a name="ln-8242"></a>          <span class="c">!       MODIFIED       June 2003, FCW: add destination = return air;</span>
<a name="ln-8243"></a>          <span class="c">!                        more error messages</span>
<a name="ln-8244"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8245"></a>
<a name="ln-8246"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8247"></a>          <span class="c">! Reads in the window airflow control information from the input data file,</span>
<a name="ln-8248"></a>          <span class="c">! interprets it and puts it in the SurfaceWindow derived type</span>
<a name="ln-8249"></a>
<a name="ln-8250"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-8251"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-8252"></a>
<a name="ln-8253"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8254"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-8255"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-8256"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-8257"></a>
<a name="ln-8258"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8259"></a>
<a name="ln-8260"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8261"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-8262"></a>
<a name="ln-8263"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-8264"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-8265"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-8266"></a>
<a name="ln-8267"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8268"></a>
<a name="ln-8269"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>                   <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-8270"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ControlNumAlpha</span>          <span class="c">! Number of control alpha names being passed</span>
<a name="ln-8271"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ControlNumProp</span>           <span class="c">! Number of control properties being passed</span>
<a name="ln-8272"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotWinAirflowControl</span>     <span class="c">! Total window airflow control statements</span>
<a name="ln-8273"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WrongSurfaceType</span>         <span class="c">! True if associated surface is not 2- or 3-pane exterior window</span>
<a name="ln-8274"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-8275"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>                  <span class="c">! Surface number</span>
<a name="ln-8276"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>                <span class="c">! Construction number</span>
<a name="ln-8277"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNumSh</span>              <span class="c">! Shaded Construction number</span>
<a name="ln-8278"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WSCptr</span>                   <span class="c">! Window shading control pointer</span>
<a name="ln-8279"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatGapFlow</span>               <span class="c">! Material number of gas in airflow gap of window&#39;s construction</span>
<a name="ln-8280"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatGapFlow1</span><span class="p">,</span><span class="n">MatGapFlow2</span>  <span class="c">! Material number of gas on either side of a between-glass shade/blind</span>
<a name="ln-8281"></a>                                      <span class="c">! of the shaded construction of airflow window</span>
<a name="ln-8282"></a>
<a name="ln-8283"></a>        <span class="c">! Get the total number of window airflow control statements</span>
<a name="ln-8284"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;WindowProperty:AirflowControl&#39;</span>
<a name="ln-8285"></a>  <span class="n">TotWinAirflowControl</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8286"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">TotWinAirflowControl</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-8287"></a>
<a name="ln-8288"></a><span class="k">  DO </span><span class="n">Loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotWinAirflowControl</span>   <span class="c">! Loop through all surfaces in the input...</span>
<a name="ln-8289"></a>
<a name="ln-8290"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">ControlNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8291"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">ControlNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8292"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8293"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-8294"></a>
<a name="ln-8295"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-8296"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8297"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-8298"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8299"></a>    <span class="k">END IF</span>
<a name="ln-8300"></a>          <span class="c">! Check that associated surface is a 2- or 3-pane exterior window</span>
<a name="ln-8301"></a>    <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8302"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8303"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8304"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8305"></a><span class="k">        </span><span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-8306"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">/=</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">/=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8307"></a>           <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8308"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8309"></a>      <span class="k">END IF</span>
<a name="ln-8310"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WrongSurfaceType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8311"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8312"></a>          <span class="s1">&#39;&quot; is not an exterior window with 2 or 3 glass layers.&#39;</span><span class="p">)</span>
<a name="ln-8313"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8314"></a>      <span class="k">END IF</span>
<a name="ln-8315"></a><span class="k">    END IF</span>
<a name="ln-8316"></a>
<a name="ln-8317"></a>    <span class="c">! Error if illegal airflow source</span>
<a name="ln-8318"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;INDOORAIR&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;OUTDOORAIR&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8319"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8320"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8321"></a>         <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8322"></a>    <span class="k">END IF</span>
<a name="ln-8323"></a>
<a name="ln-8324"></a>    <span class="c">! Error if illegal airflow destination</span>
<a name="ln-8325"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;INDOORAIR&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;OUTDOORAIR&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8326"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;RETURNAIR&#39;</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8327"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8328"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8329"></a>         <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8330"></a>    <span class="k">END IF</span>
<a name="ln-8331"></a>
<a name="ln-8332"></a>
<a name="ln-8333"></a>    <span class="c">! Error if source = OutsideAir and destination = ReturnAir</span>
<a name="ln-8334"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;OUTDOORAIR&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;RETURNAIR&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8335"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8336"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8337"></a>         <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8338"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..when &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8339"></a>    <span class="k">END IF</span>
<a name="ln-8340"></a>
<a name="ln-8341"></a>    <span class="c">! Error if illegal airflow control type</span>
<a name="ln-8342"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;ALWAYSONATMAXIMUMFLOW&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;ALWAYSOFF&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8343"></a>          <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;SCHEDULEDONLY&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8344"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8345"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8346"></a>         <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8347"></a>    <span class="k">END IF</span>
<a name="ln-8348"></a>
<a name="ln-8349"></a>    <span class="c">! Error if illegal value for Airflow Has Multiplier Schedule</span>
<a name="ln-8350"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;YES&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;NO&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8351"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8352"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8353"></a>         <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8354"></a>    <span class="k">END IF</span>
<a name="ln-8355"></a>
<a name="ln-8356"></a>    <span class="c">! Error if Airflow Control Type = ScheduledOnly and Airflow Has Multiplier Schedule = No</span>
<a name="ln-8357"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;SCHEDULEDONLY&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8358"></a><span class="k">      </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8359"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8360"></a>         <span class="s1">&#39;&quot; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8361"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..when &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8362"></a>
<a name="ln-8363"></a>    <span class="k">END IF</span>
<a name="ln-8364"></a>
<a name="ln-8365"></a>    <span class="c">! Warning if Airflow Control Type = AlwaysOnAtMaxFlow and Airflow Has Multiplier Schedule = Yes</span>
<a name="ln-8366"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ALWAYSONATMAXIMUMFLOW&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8367"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8368"></a>        <span class="s1">&#39;has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8369"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..but &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8370"></a>        <span class="s1">&#39;If specified, the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; will be ignored.&#39;</span><span class="p">)</span>
<a name="ln-8371"></a>    <span class="k">END IF</span>
<a name="ln-8372"></a>
<a name="ln-8373"></a>    <span class="c">! Warning if Airflow Control Type = AlwaysOff and Airflow Has Multiplier Schedule = Yes</span>
<a name="ln-8374"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ALWAYSOFF&#39;</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8375"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8376"></a>        <span class="s1">&#39;has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8377"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..but &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8378"></a>        <span class="s1">&#39;&quot;. If specified, the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; will be ignored.&#39;</span><span class="p">)</span>
<a name="ln-8379"></a>    <span class="k">END IF</span>
<a name="ln-8380"></a>
<a name="ln-8381"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8382"></a><span class="k">      </span><span class="n">AirflowWindows</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8383"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;IndoorAir&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8384"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowSource</span> <span class="o">=</span> <span class="n">AirFlowWindow_Source_IndoorAir</span>
<a name="ln-8385"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;OutdoorAir&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8386"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowSource</span> <span class="o">=</span> <span class="n">AirFlowWindow_Source_OutdoorAir</span>
<a name="ln-8387"></a>      <span class="n">ENDIF</span>
<a name="ln-8388"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;IndoorAir&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8389"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowDestination</span> <span class="o">=</span> <span class="n">AirFlowWindow_Destination_IndoorAir</span>
<a name="ln-8390"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;OutdoorAir&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8391"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowDestination</span> <span class="o">=</span> <span class="n">AirFlowWindow_Destination_OutdoorAir</span>
<a name="ln-8392"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;ReturnAir&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8393"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowDestination</span> <span class="o">=</span> <span class="n">AirFlowWindow_Destination_ReturnAir</span>
<a name="ln-8394"></a>      <span class="n">ENDIF</span>
<a name="ln-8395"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;AlwaysOnAtMaximumFlow&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-8396"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowControlType</span> <span class="o">=</span> <span class="n">AirFlowWindow_ControlType_MaxFlow</span>
<a name="ln-8397"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;AlwaysOff&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-8398"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowControlType</span> <span class="o">=</span> <span class="n">AirFlowWindow_ControlType_AlwaysOff</span>
<a name="ln-8399"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;ScheduledOnly&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-8400"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowControlType</span> <span class="o">=</span> <span class="n">AirFlowWindow_ControlType_Schedule</span>
<a name="ln-8401"></a>      <span class="n">ENDIF</span>
<a name="ln-8402"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaxAirflow</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8403"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;SCHEDULEDONLY&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8404"></a><span class="k">        IF</span><span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8405"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8406"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8407"></a>             <span class="s1">&#39;&quot;, has &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8408"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..and &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8409"></a>             <span class="s1">&#39;&quot;, but no &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; specified.&#39;</span><span class="p">)</span>
<a name="ln-8410"></a>        <span class="k">ELSE</span>
<a name="ln-8411"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowHasSchedule</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8412"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowSchedulePtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-8413"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">AirflowSchedulePtr</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8414"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8415"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8416"></a>              <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8417"></a>          <span class="k">END IF</span>
<a name="ln-8418"></a><span class="k">        END IF</span>
<a name="ln-8419"></a><span class="k">      END IF</span>
<a name="ln-8420"></a>      <span class="c">! Warning if associated window is an interior window</span>
<a name="ln-8421"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8422"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8423"></a>                 <span class="s1">&#39;&quot;, is an Interior window; cannot be an airflow window.&#39;</span><span class="p">)</span>
<a name="ln-8424"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8425"></a>        <span class="c">! Require that gas in airflow gap has type = air</span>
<a name="ln-8426"></a>        <span class="n">MatGapFlow</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8427"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="n">MatGapFlow</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8428"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGapFlow</span><span class="p">)%</span><span class="n">GasType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8429"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8430"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8431"></a>            <span class="s1">&#39;&quot;, Gas type not air in airflow gap of construction &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8432"></a>        <span class="k">END IF</span>
<a name="ln-8433"></a>        <span class="c">! Require that gas be air in airflow gaps on either side of a between glass shade/blind</span>
<a name="ln-8434"></a>        <span class="n">WSCptr</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-8435"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WSCptr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8436"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassShade</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8437"></a>             <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8438"></a><span class="k">             </span><span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-8439"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8440"></a><span class="k">               </span><span class="n">MatGapFlow1</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8441"></a>               <span class="n">MatGapFlow2</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8442"></a>             <span class="k">ELSE</span>
<a name="ln-8443"></a><span class="k">               </span><span class="n">MatGapFlow1</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8444"></a>               <span class="n">MatGapFlow2</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-8445"></a>             <span class="k">END IF</span>
<a name="ln-8446"></a><span class="k">             IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatGapFlow1</span><span class="p">)%</span><span class="n">GasType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatGapFlow2</span><span class="p">)%</span><span class="n">GasType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8447"></a><span class="k">               </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8448"></a>               <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8449"></a>                   <span class="s1">&#39;&quot;, gas type must be air on either side of the shade/blind&#39;</span><span class="p">)</span>
<a name="ln-8450"></a>             <span class="k">END IF</span>
<a name="ln-8451"></a><span class="k">          END IF</span>
<a name="ln-8452"></a><span class="k">        END IF</span>
<a name="ln-8453"></a><span class="k">      END IF</span>
<a name="ln-8454"></a><span class="k">    END IF</span>
<a name="ln-8455"></a>
<a name="ln-8456"></a><span class="k">  END DO</span>  <span class="c">! End of loop over window airflow controls</span>
<a name="ln-8457"></a>
<a name="ln-8458"></a><span class="k">RETURN</span>
<a name="ln-8459"></a>
<a name="ln-8460"></a><span class="k">END SUBROUTINE </span><span class="n">GetWindowGapAirflowControlData</span>
<a name="ln-8461"></a>
<a name="ln-8462"></a><span class="k">SUBROUTINE </span><span class="n">GetOSCData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8463"></a>
<a name="ln-8464"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8465"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-8466"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-8467"></a>          <span class="c">!       MODIFIED       Jul 2011, M.J. Witte and C.O. Pedersen, add new fields to OSC for last T, max and min</span>
<a name="ln-8468"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8469"></a>
<a name="ln-8470"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8471"></a>          <span class="c">! This subroutine gets the OtherSideCoefficient data.</span>
<a name="ln-8472"></a>
<a name="ln-8473"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8474"></a>          <span class="c">! na</span>
<a name="ln-8475"></a>
<a name="ln-8476"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8477"></a>          <span class="c">! Other Side Coefficient Definition</span>
<a name="ln-8478"></a>          <span class="c">! OtherSideCoefficients,</span>
<a name="ln-8479"></a>          <span class="c">!       \memo This object sets the other side conditions for a surface in a variety of ways.</span>
<a name="ln-8480"></a>          <span class="c">!   A1, \field OtherSideCoeff Name</span>
<a name="ln-8481"></a>          <span class="c">!       \required-field</span>
<a name="ln-8482"></a>          <span class="c">!       \reference OSCNames</span>
<a name="ln-8483"></a>          <span class="c">!       \reference OutFaceEnvNames</span>
<a name="ln-8484"></a>          <span class="c">!   N1, \field Combined convective/radiative film coefficient</span>
<a name="ln-8485"></a>          <span class="c">!       \required-field</span>
<a name="ln-8486"></a>          <span class="c">!       \type real</span>
<a name="ln-8487"></a>          <span class="c">!       \note if&gt;0, N1 becomes exterior convective/radiative film coefficient and other fields</span>
<a name="ln-8488"></a>          <span class="c">!       \note are used to calc outside air temp then exterior surface temp based on outside air</span>
<a name="ln-8489"></a>          <span class="c">!       \note and specified coefficient</span>
<a name="ln-8490"></a>          <span class="c">!       \note if&lt;=0, then remaining fields calculate the outside surface temperature(?)</span>
<a name="ln-8491"></a>          <span class="c">!       \note following fields are used in the equation:</span>
<a name="ln-8492"></a>          <span class="c">!       \note SurfTemp=N7*TempZone + N4*OutsideDryBulb + N2*N3 + GroundTemp*N5 + WindSpeed*N6*OutsideDryBulb</span>
<a name="ln-8493"></a>          <span class="c">!   N2, \field User selected Constant Temperature</span>
<a name="ln-8494"></a>          <span class="c">!       \units C</span>
<a name="ln-8495"></a>          <span class="c">!       \type real</span>
<a name="ln-8496"></a>          <span class="c">!       \note This parameter will be overwritten by the values from the schedule(A2 below) if one is present</span>
<a name="ln-8497"></a>          <span class="c">!   N3, \field Coefficient modifying the user selected constant temperature</span>
<a name="ln-8498"></a>          <span class="c">!       \note This coefficient is used even with a schedule.  It should normally be 1.0 in that case</span>
<a name="ln-8499"></a>          <span class="c">!   N4, \field Coefficient modifying the external dry bulb temperature</span>
<a name="ln-8500"></a>          <span class="c">!       \type real</span>
<a name="ln-8501"></a>          <span class="c">!   N5, \field Coefficient modifying the ground temperature</span>
<a name="ln-8502"></a>          <span class="c">!       \type real</span>
<a name="ln-8503"></a>          <span class="c">!   N6, \field Coefficient modifying the wind speed term (s/m)</span>
<a name="ln-8504"></a>          <span class="c">!       \type real</span>
<a name="ln-8505"></a>          <span class="c">!   N7, \field Coefficient modifying the zone air temperature part of the equation</span>
<a name="ln-8506"></a>          <span class="c">!       \type real</span>
<a name="ln-8507"></a>          <span class="c">!   A2, \field ScheduleName for constant temperature</span>
<a name="ln-8508"></a>          <span class="c">!       \note Name of Schedule for values of &quot;const&quot; temperature.</span>
<a name="ln-8509"></a>          <span class="c">!       \note Schedule values replace N2 - User selected constant temperature.</span>
<a name="ln-8510"></a>          <span class="c">!       \type object-list</span>
<a name="ln-8511"></a>          <span class="c">!       \object-list ScheduleNames</span>
<a name="ln-8512"></a>          <span class="c">!   A3, \field Sinusoidal Variation of Constant Temperature Coefficient</span>
<a name="ln-8513"></a>          <span class="c">!       \note Optionally used to vary Constant Temperature Coefficient with unitary sine wave</span>
<a name="ln-8514"></a>          <span class="c">!       \type choice</span>
<a name="ln-8515"></a>          <span class="c">!       \key Yes</span>
<a name="ln-8516"></a>          <span class="c">!       \key No</span>
<a name="ln-8517"></a>          <span class="c">!       \default No</span>
<a name="ln-8518"></a>          <span class="c">!   N8; \field Period of Sinusoidal Variation</span>
<a name="ln-8519"></a>          <span class="c">!       \note Use with sinusoidal variation to define the time period</span>
<a name="ln-8520"></a>          <span class="c">!       \type real</span>
<a name="ln-8521"></a>          <span class="c">!       \units hr</span>
<a name="ln-8522"></a>          <span class="c">!       \default 24</span>
<a name="ln-8523"></a>          <span class="c">!  N9, \field Previous Other Side Temperature Coefficient</span>
<a name="ln-8524"></a>          <span class="c">!      \note This coeffient multiplies the other side temperature result from the</span>
<a name="ln-8525"></a>          <span class="c">!      \note previous zone timestep</span>
<a name="ln-8526"></a>          <span class="c">!      \type real</span>
<a name="ln-8527"></a>          <span class="c">!      \default 0</span>
<a name="ln-8528"></a>          <span class="c">! N10, \field Minimum Other Side Temperature</span>
<a name="ln-8529"></a>          <span class="c">!      \type real</span>
<a name="ln-8530"></a>          <span class="c">!      \units C</span>
<a name="ln-8531"></a>          <span class="c">!      \default -100</span>
<a name="ln-8532"></a>          <span class="c">! N11; \field Maximum Other Side Temperature</span>
<a name="ln-8533"></a>          <span class="c">!      \type real</span>
<a name="ln-8534"></a>          <span class="c">!      \units C</span>
<a name="ln-8535"></a>          <span class="c">!      \default 200</span>
<a name="ln-8536"></a>
<a name="ln-8537"></a>
<a name="ln-8538"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8539"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-8540"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-8541"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-8542"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-8543"></a>
<a name="ln-8544"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8545"></a>
<a name="ln-8546"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8547"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-8548"></a>
<a name="ln-8549"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8550"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OSCFormat1</span><span class="o">=</span><span class="s2">&quot;(&#39;! &lt;Other Side Coefficients&gt;,Name,&quot;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8551"></a>                            <span class="s2">&quot;Combined convective/radiative film coefficient {W/m2-K},&quot;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8552"></a>                            <span class="s2">&quot;User selected Constant Temperature {C},Coefficient modifying the constant temperature term,&quot;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8553"></a>                            <span class="s2">&quot;Coefficient modifying the external dry bulb temperature term,&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8554"></a>                            <span class="s2">&quot;Coefficient modifying the ground temperature term,&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8555"></a>                            <span class="s2">&quot;Coefficient modifying the wind speed term {s/m},&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8556"></a>                            <span class="s2">&quot;Coefficient modifying the zone air temperature term,&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8557"></a>                            <span class="s2">&quot;Constant Temperature Schedule Name,&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8558"></a>                            <span class="s2">&quot;Sinusoidal Variation,&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8559"></a>                            <span class="s2">&quot;Period of Sinusoidal Variation,&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8560"></a>                            <span class="s2">&quot;Previous Other Side Temperature Coefficient,&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8561"></a>                            <span class="s2">&quot;Minimum Other Side Temperature {C},&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8562"></a>                            <span class="s2">&quot;Maximum Other Side Temperature {C}&#39;)&quot;</span>
<a name="ln-8563"></a>
<a name="ln-8564"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8565"></a>          <span class="c">! na</span>
<a name="ln-8566"></a>
<a name="ln-8567"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8568"></a>          <span class="c">! na</span>
<a name="ln-8569"></a>
<a name="ln-8570"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8571"></a>  <span class="kt">INTEGER </span><span class="n">NumAlphas</span>
<a name="ln-8572"></a>  <span class="kt">INTEGER </span><span class="n">NumProps</span>
<a name="ln-8573"></a>  <span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-8574"></a>  <span class="kt">INTEGER </span><span class="n">IOSTAT</span>
<a name="ln-8575"></a>  <span class="kt">INTEGER </span><span class="n">OSCNum</span>
<a name="ln-8576"></a>  <span class="kt">LOGICAL </span><span class="n">ErrorInName</span>
<a name="ln-8577"></a>  <span class="kt">LOGICAL </span><span class="n">IsBlank</span>
<a name="ln-8578"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span> <span class="n">cOSCLimitsString</span>
<a name="ln-8579"></a>
<a name="ln-8580"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceProperty:OtherSideCoefficients&#39;</span>
<a name="ln-8581"></a>  <span class="n">TotOSC</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8582"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">TotOSC</span><span class="p">))</span>
<a name="ln-8583"></a>
<a name="ln-8584"></a>  <span class="n">OSCNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8585"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotOSC</span>
<a name="ln-8586"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8587"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumProps</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8588"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8589"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-8590"></a>    <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8591"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8592"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">OSC</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">OSCNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-8593"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8594"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8595"></a>      <span class="k">CYCLE</span>
<a name="ln-8596"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8597"></a>
<a name="ln-8598"></a>    <span class="n">OSCNum</span><span class="o">=</span><span class="n">OSCNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8599"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8600"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">SurfFilmCoef</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8601"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ConstTemp</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c">!  This will be replaced if  schedule is used</span>
<a name="ln-8602"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ConstTempCoef</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c">!  This multiplier is used (even with schedule).  It should normally be 1.0</span>
<a name="ln-8603"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ExtDryBulbCoef</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8604"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">GroundTempCoef</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-8605"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">WindSpeedCoef</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-8606"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ZoneAirTempCoef</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-8607"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">SinusoidPeriod</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-8608"></a>
<a name="ln-8609"></a>    <span class="k">IF</span><span class="p">((</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">!  Const temp will come from schedule specified below.</span>
<a name="ln-8610"></a>      <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ConstTempScheduleName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8611"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ConstTempScheduleName</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8612"></a><span class="k">        </span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ConstTempScheduleIndex</span><span class="o">=</span><span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ConstTempScheduleName</span><span class="p">)</span>
<a name="ln-8613"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">ConstTempScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8614"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8615"></a>            <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-8616"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8617"></a>        <span class="n">ENDIF</span>
<a name="ln-8618"></a>      <span class="n">ENDIF</span>
<a name="ln-8619"></a>    <span class="n">ENDIF</span>
<a name="ln-8620"></a>
<a name="ln-8621"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8622"></a>
<a name="ln-8623"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8624"></a><span class="k">        </span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">SinusoidalConstTempCoef</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8625"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;Yes&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8626"></a><span class="k">        </span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">SinusoidalConstTempCoef</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-8627"></a>      <span class="k">ELSE</span>
<a name="ln-8628"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8629"></a>            <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8630"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8631"></a>      <span class="n">ENDIF</span>
<a name="ln-8632"></a>    <span class="n">ENDIF</span>
<a name="ln-8633"></a>
<a name="ln-8634"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8635"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">SinusoidalConstTempCoef</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8636"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8637"></a>              <span class="s1">&#39;&quot; has zeros for all coefficients.&#39;</span><span class="p">)</span>
<a name="ln-8638"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The outdoor air temperature for surfaces using this OtherSideCoefficients &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8639"></a>        <span class="s1">&#39;object will always be 0C.&#39;</span><span class="p">)</span>
<a name="ln-8640"></a>    <span class="n">ENDIF</span>
<a name="ln-8641"></a>
<a name="ln-8642"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8643"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">SinusoidalConstTempCoef</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8644"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8645"></a>              <span class="s1">&#39;&quot; has zeros for all coefficients.&#39;</span><span class="p">)</span>
<a name="ln-8646"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The outside surface temperature for surfaces using this OtherSideCoefficients &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8647"></a>        <span class="s1">&#39;object will always be 0C.&#39;</span><span class="p">)</span>
<a name="ln-8648"></a>    <span class="n">ENDIF</span>
<a name="ln-8649"></a>
<a name="ln-8650"></a>    <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">TPreviousCoef</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-8651"></a>
<a name="ln-8652"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8653"></a><span class="k">      </span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">MinLimitPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8654"></a>      <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">MinTempLimit</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-8655"></a>      <span class="n">cOSCLimitsString</span> <span class="o">=</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-8656"></a>    <span class="k">ELSE</span>
<a name="ln-8657"></a><span class="k">      </span><span class="n">cOSCLimitsString</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
<a name="ln-8658"></a>    <span class="n">ENDIF</span>
<a name="ln-8659"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8660"></a><span class="k">      </span><span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">MaxLimitPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8661"></a>      <span class="n">OSC</span><span class="p">(</span><span class="n">OSCNum</span><span class="p">)%</span><span class="n">MaxTempLimit</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-8662"></a>      <span class="n">cOSCLimitsString</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cOSCLimitsString</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8663"></a>    <span class="k">ELSE</span>
<a name="ln-8664"></a><span class="k">      </span><span class="n">cOSCLimitsString</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cOSCLimitsString</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-8665"></a>    <span class="n">ENDIF</span>
<a name="ln-8666"></a>
<a name="ln-8667"></a>  <span class="n">ENDDO</span>
<a name="ln-8668"></a>
<a name="ln-8669"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotOSC</span>
<a name="ln-8670"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Loop</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8671"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">OSCFormat1</span><span class="p">)</span>
<a name="ln-8672"></a>    <span class="n">ENDIF</span>
<a name="ln-8673"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">SurfFilmCoef</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8674"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">SurfFilmCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-8675"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Other Side Coefficients Exterior Air Drybulb Temperature [C]&#39;</span><span class="p">,</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">OSCTempCalc</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8676"></a>                                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8677"></a>    <span class="k">ELSE</span>
<a name="ln-8678"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-8679"></a>    <span class="n">ENDIF</span>
<a name="ln-8680"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ConstTempScheduleIndex</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8681"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ConstTempScheduleName</span>
<a name="ln-8682"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Other Side Coefficients,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8683"></a>        <span class="s1">&#39;N/A,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ConstTempCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8684"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ExtDryBulbCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">GroundTempCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8685"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WindSpeedCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ZoneAirTempCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8686"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">SinusoidPeriod</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8687"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">TPreviousCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cOSCLimitsString</span><span class="p">)</span>
<a name="ln-8688"></a>    <span class="k">ELSE</span>
<a name="ln-8689"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-8690"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Other Side Coefficients,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8691"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ConstTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ConstTempCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8692"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ExtDryBulbCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">GroundTempCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8693"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WindSpeedCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ZoneAirTempCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8694"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">SinusoidPeriod</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8695"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">TPreviousCoef</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cOSCLimitsString</span><span class="p">)</span>
<a name="ln-8696"></a>    <span class="n">ENDIF</span>
<a name="ln-8697"></a>
<a name="ln-8698"></a>  <span class="n">ENDDO</span>
<a name="ln-8699"></a>  <span class="k">RETURN</span>
<a name="ln-8700"></a>
<a name="ln-8701"></a><span class="k">END SUBROUTINE </span><span class="n">GetOSCData</span>
<a name="ln-8702"></a>
<a name="ln-8703"></a><span class="k">SUBROUTINE </span><span class="n">GetOSCMData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8704"></a>
<a name="ln-8705"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8706"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8707"></a>          <span class="c">!       DATE WRITTEN   November 2004</span>
<a name="ln-8708"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8709"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8710"></a>
<a name="ln-8711"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8712"></a>          <span class="c">! This subroutine gets the OtherSideConditionsModel data.</span>
<a name="ln-8713"></a>
<a name="ln-8714"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8715"></a>          <span class="c">! na</span>
<a name="ln-8716"></a>
<a name="ln-8717"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8718"></a>          <span class="c">! derived from GetOSCData subroutine by Linda Lawrie</span>
<a name="ln-8719"></a>
<a name="ln-8720"></a>          <span class="c">!  OtherSideConditionsModel,</span>
<a name="ln-8721"></a>          <span class="c">!      \memo This object sets up modifying the other side conditions for a surface from other model results.</span>
<a name="ln-8722"></a>          <span class="c">!  A1, \field OtherSideConditionsModel Name</span>
<a name="ln-8723"></a>          <span class="c">!      \required-field</span>
<a name="ln-8724"></a>          <span class="c">!      \reference OSCMNames</span>
<a name="ln-8725"></a>          <span class="c">!      \reference OutFaceEnvNames</span>
<a name="ln-8726"></a>          <span class="c">!  A2; \field Type of Model to determine Boundary Conditions</span>
<a name="ln-8727"></a>          <span class="c">!      \type choice</span>
<a name="ln-8728"></a>          <span class="c">!      \key Transpired Collector</span>
<a name="ln-8729"></a>          <span class="c">!      \key Vented PV Cavity</span>
<a name="ln-8730"></a>          <span class="c">!      \key Hybrid PV Transpired Collector</span>
<a name="ln-8731"></a>
<a name="ln-8732"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8733"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-8734"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-8735"></a>
<a name="ln-8736"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8737"></a>
<a name="ln-8738"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8739"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-8740"></a>
<a name="ln-8741"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8742"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OSCMFormat1</span><span class="o">=</span><span class="s2">&quot;(&#39;! &lt;Other Side Conditions Model&gt;,Name,Class&#39;)&quot;</span>
<a name="ln-8743"></a>
<a name="ln-8744"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8745"></a>          <span class="c">! na</span>
<a name="ln-8746"></a>
<a name="ln-8747"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8748"></a>          <span class="c">! na</span>
<a name="ln-8749"></a>
<a name="ln-8750"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8751"></a>  <span class="kt">INTEGER </span><span class="n">NumAlphas</span>
<a name="ln-8752"></a>  <span class="kt">INTEGER </span><span class="n">NumProps</span>
<a name="ln-8753"></a>  <span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-8754"></a>  <span class="kt">INTEGER </span><span class="n">IOSTAT</span>
<a name="ln-8755"></a>  <span class="kt">INTEGER </span><span class="n">OSCMNum</span>
<a name="ln-8756"></a>  <span class="kt">LOGICAL </span><span class="n">ErrorInName</span>
<a name="ln-8757"></a>  <span class="kt">LOGICAL </span><span class="n">IsBlank</span>
<a name="ln-8758"></a>
<a name="ln-8759"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceProperty:OtherSideConditionsModel&#39;</span>
<a name="ln-8760"></a>  <span class="n">TotOSCM</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8761"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">OSCM</span><span class="p">(</span><span class="n">TotOSCM</span><span class="p">))</span>
<a name="ln-8762"></a>  <span class="c">! OSCM is already initialized in derived type defn.</span>
<a name="ln-8763"></a>
<a name="ln-8764"></a>  <span class="n">OSCMNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8765"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotOSCM</span>
<a name="ln-8766"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8767"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumProps</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-8768"></a>    <span class="n">ErrorInName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8769"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8770"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">OSCM</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">OSCMNum</span><span class="p">,</span><span class="n">ErrorInName</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-8771"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8772"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8773"></a>      <span class="k">CYCLE</span>
<a name="ln-8774"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8775"></a>
<a name="ln-8776"></a>    <span class="n">OSCMNum</span><span class="o">=</span><span class="n">OSCMNum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8777"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8778"></a>    <span class="c">! Note no validation of the below at this time:</span>
<a name="ln-8779"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="k">Class</span>           <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8780"></a>    <span class="c">! setup output vars for modeled coefficients</span>
<a name="ln-8781"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Other Side Conditions Modeled Convection Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">TConv</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8782"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8783"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Other Side Conditions Modeled Convection Heat Transfer Coefficient [W/m2-K]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8784"></a>                              <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">HConv</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8785"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8786"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Other Side Conditions Modeled Radiation Temperature [C]&#39;</span><span class="p">,</span><span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">TRad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8787"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8788"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Other Side Conditions Modeled Radiation Heat Transfer Coefficient [W/m2-K]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8789"></a>                              <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">HRad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8790"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8791"></a>
<a name="ln-8792"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8793"></a><span class="k">      CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Other Side Boundary Conditions&#39;</span><span class="p">,</span>  <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8794"></a>                           <span class="s1">&#39;Convection Bulk Air Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;[C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8795"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideOnTConv</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8796"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideTConvValue</span><span class="p">)</span>
<a name="ln-8797"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Other Side Boundary Conditions&#39;</span><span class="p">,</span>  <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8798"></a>                           <span class="s1">&#39;Convection Heat Transfer Coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;[W/m2-K]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8799"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideOnHConv</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8800"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideHConvValue</span><span class="p">)</span>
<a name="ln-8801"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Other Side Boundary Conditions&#39;</span><span class="p">,</span>  <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8802"></a>                           <span class="s1">&#39;Radiation Effective Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;[C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8803"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideOnTRad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8804"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideTRadValue</span><span class="p">)</span>
<a name="ln-8805"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Other Side Boundary Conditions&#39;</span><span class="p">,</span>  <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8806"></a>                           <span class="s1">&#39;Radiation Linear Heat Transfer Coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;[W/m2-K]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8807"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideOnHrad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8808"></a>                           <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMNum</span><span class="p">)%</span><span class="n">EMSOverrideHradValue</span><span class="p">)</span>
<a name="ln-8809"></a>    <span class="n">ENDIF</span>
<a name="ln-8810"></a>  <span class="n">ENDDO</span>
<a name="ln-8811"></a>
<a name="ln-8812"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotOSCM</span>
<a name="ln-8813"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Loop</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8814"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">OSCMFormat1</span><span class="p">)</span>
<a name="ln-8815"></a>    <span class="n">ENDIF</span>
<a name="ln-8816"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Other Side Conditions Model,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OSCM</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OSCM</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="k">Class</span><span class="p">)</span>
<a name="ln-8817"></a>  <span class="n">ENDDO</span>
<a name="ln-8818"></a>
<a name="ln-8819"></a>  <span class="k">RETURN</span>
<a name="ln-8820"></a>
<a name="ln-8821"></a><span class="k">END SUBROUTINE </span><span class="n">GetOSCMData</span>
<a name="ln-8822"></a>
<a name="ln-8823"></a><span class="k">SUBROUTINE </span><span class="n">GetMovableInsulationData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8824"></a>
<a name="ln-8825"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8826"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-8827"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-8828"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8829"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8830"></a>
<a name="ln-8831"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8832"></a>          <span class="c">! This subroutine gets the movable insulation data that can be associated with</span>
<a name="ln-8833"></a>          <span class="c">! a surface.</span>
<a name="ln-8834"></a>
<a name="ln-8835"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8836"></a>          <span class="c">! na</span>
<a name="ln-8837"></a>
<a name="ln-8838"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8839"></a>  <span class="c">! Movable Insulation Definition</span>
<a name="ln-8840"></a>  <span class="c">! SurfaceControl:MovableInsulation,</span>
<a name="ln-8841"></a>  <span class="c">!       \memo Exterior or Interior Insulation on opaque surfaces</span>
<a name="ln-8842"></a>  <span class="c">!   A1, \field Insulation Type</span>
<a name="ln-8843"></a>  <span class="c">!       \required-field</span>
<a name="ln-8844"></a>  <span class="c">!       \type choice</span>
<a name="ln-8845"></a>  <span class="c">!       \key Outside</span>
<a name="ln-8846"></a>  <span class="c">!       \key Inside</span>
<a name="ln-8847"></a>  <span class="c">!   A2, \field Surface Name</span>
<a name="ln-8848"></a>  <span class="c">!       \required-field</span>
<a name="ln-8849"></a>  <span class="c">!       \type object-list</span>
<a name="ln-8850"></a>  <span class="c">!       \object-list SurfaceNames</span>
<a name="ln-8851"></a>  <span class="c">!   A3, \field Material Name</span>
<a name="ln-8852"></a>  <span class="c">!       \required-field</span>
<a name="ln-8853"></a>  <span class="c">!       \object-list MaterialName</span>
<a name="ln-8854"></a>  <span class="c">!   A4; \field Schedule Name</span>
<a name="ln-8855"></a>  <span class="c">!        \required-field</span>
<a name="ln-8856"></a>  <span class="c">!        \type object-list</span>
<a name="ln-8857"></a>  <span class="c">!        \object-list ScheduleNames</span>
<a name="ln-8858"></a>
<a name="ln-8859"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8860"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-8861"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-8862"></a>    <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-8863"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-8864"></a>
<a name="ln-8865"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8866"></a>
<a name="ln-8867"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8868"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-8869"></a>
<a name="ln-8870"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8871"></a>          <span class="c">! na</span>
<a name="ln-8872"></a>
<a name="ln-8873"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8874"></a>          <span class="c">! na</span>
<a name="ln-8875"></a>
<a name="ln-8876"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8877"></a>          <span class="c">! na</span>
<a name="ln-8878"></a>
<a name="ln-8879"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8880"></a>  <span class="kt">INTEGER </span><span class="n">NAlphas</span>
<a name="ln-8881"></a>  <span class="kt">INTEGER </span><span class="n">NNums</span>
<a name="ln-8882"></a>  <span class="kt">INTEGER </span><span class="n">IOSTAT</span>
<a name="ln-8883"></a>  <span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-8884"></a>  <span class="kt">INTEGER </span><span class="n">NMatInsul</span>
<a name="ln-8885"></a>  <span class="kt">INTEGER </span><span class="n">SurfNum</span>
<a name="ln-8886"></a>  <span class="kt">INTEGER </span><span class="n">MaterNum</span>
<a name="ln-8887"></a>  <span class="kt">INTEGER </span><span class="n">SchNum</span>
<a name="ln-8888"></a>  <span class="kt">INTEGER </span><span class="n">InslType</span>
<a name="ln-8889"></a>
<a name="ln-8890"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceControl:MovableInsulation&#39;</span>
<a name="ln-8891"></a>  <span class="n">NMatInsul</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8892"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NMatInsul</span>
<a name="ln-8893"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8894"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8895"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-8896"></a>    <span class="n">SurfNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">SurfaceTmp</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-8897"></a>    <span class="n">MaterNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-8898"></a>    <span class="n">SchNum</span><span class="o">=</span><span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-8899"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Outside&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8900"></a><span class="k">      </span><span class="n">InslType</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-8901"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Inside&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8902"></a><span class="k">      </span><span class="n">InslType</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-8903"></a>    <span class="k">ELSE</span>
<a name="ln-8904"></a><span class="k">      </span><span class="n">InslType</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8905"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8906"></a>         <span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-8907"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8908"></a>         <span class="s1">&#39;&quot;, [should be Inside or Outside]&#39;</span><span class="p">)</span>
<a name="ln-8909"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8910"></a>    <span class="n">ENDIF</span>
<a name="ln-8911"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8912"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8913"></a>         <span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-8914"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; invalid (not found) &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-8915"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8916"></a>    <span class="k">ELSE</span>
<a name="ln-8917"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MaterNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8918"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8919"></a>           <span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-8920"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; invalid (not found) &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8921"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8922"></a>      <span class="k">ELSE</span>
<a name="ln-8923"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SchNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8924"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8925"></a>           <span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-8926"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; invalid (not found) &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8927"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8928"></a>        <span class="k">ELSE</span>
<a name="ln-8929"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">InslType</span><span class="p">)</span>
<a name="ln-8930"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8931"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulExt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8932"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8933"></a>                 <span class="s1">&#39;&quot;, already assigned.&#39;</span><span class="p">)</span>
<a name="ln-8934"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;Outside&quot;, was already assigned Material=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8935"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-8936"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;attempting to assign Material=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-8937"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8938"></a>            <span class="n">ENDIF</span>
<a name="ln-8939"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulExt</span><span class="o">=</span><span class="n">MaterNum</span>
<a name="ln-8940"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span><span class="o">=</span><span class="n">SchNum</span>
<a name="ln-8941"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Resistance</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8942"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8943"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8944"></a>                   <span class="s1">&#39;&quot;, invalid material.&#39;</span><span class="p">)</span>
<a name="ln-8945"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;Outside&quot;, invalid material for movable insulation.&#39;</span><span class="p">)</span>
<a name="ln-8946"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8947"></a>                   <span class="s1">&#39;Resistance=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Resistance</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8948"></a>                   <span class="s1">&#39;], must be &gt; 0 for use in Movable Insulation.&#39;</span><span class="p">)</span>
<a name="ln-8949"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8950"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8951"></a><span class="k">                </span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Resistance</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-8952"></a>              <span class="n">ENDIF</span>
<a name="ln-8953"></a>            <span class="n">ENDIF</span>
<a name="ln-8954"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8955"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Resistance</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8956"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8957"></a>                   <span class="s1">&#39;&quot;, invalid material.&#39;</span><span class="p">)</span>
<a name="ln-8958"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;Outside&quot;, invalid material for movable insulation.&#39;</span><span class="p">)</span>
<a name="ln-8959"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8960"></a>                   <span class="s1">&#39;Conductivity=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8961"></a>                   <span class="s1">&#39;], must be &gt; 0 for use in Movable Insulation.&#39;</span><span class="p">)</span>
<a name="ln-8962"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8963"></a>              <span class="n">ENDIF</span>
<a name="ln-8964"></a>            <span class="n">ENDIF</span>
<a name="ln-8965"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8966"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8967"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8968"></a>                 <span class="s1">&#39;&quot;, already assigned.&#39;</span><span class="p">)</span>
<a name="ln-8969"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;Inside&quot;, was already assigned Material=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8970"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-8971"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;attempting to assign Material=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-8972"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8973"></a>            <span class="n">ENDIF</span>
<a name="ln-8974"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="o">=</span><span class="n">MaterNum</span>
<a name="ln-8975"></a>            <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulInt</span><span class="o">=</span><span class="n">SchNum</span>
<a name="ln-8976"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Resistance</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8977"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8978"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8979"></a>                   <span class="s1">&#39;&quot;, invalid material.&#39;</span><span class="p">)</span>
<a name="ln-8980"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;Inside&quot;, invalid material for movable insulation.&#39;</span><span class="p">)</span>
<a name="ln-8981"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8982"></a>                   <span class="s1">&#39;Resistance=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Resistance</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8983"></a>                   <span class="s1">&#39;], must be &gt; 0 for use in Movable Insulation.&#39;</span><span class="p">)</span>
<a name="ln-8984"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8985"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8986"></a><span class="k">                </span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Resistance</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-8987"></a>              <span class="n">ENDIF</span>
<a name="ln-8988"></a>            <span class="n">ENDIF</span>
<a name="ln-8989"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-8990"></a>          <span class="k">END SELECT</span>
<a name="ln-8991"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8992"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8993"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;invalid use on a Window. Use WindowProperty:ShadingControl instead.&#39;</span><span class="p">)</span>
<a name="ln-8994"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8995"></a>          <span class="n">ENDIF</span>
<a name="ln-8996"></a>        <span class="n">ENDIF</span>
<a name="ln-8997"></a>      <span class="n">ENDIF</span>
<a name="ln-8998"></a>    <span class="n">ENDIF</span>
<a name="ln-8999"></a>  <span class="n">ENDDO</span>
<a name="ln-9000"></a>
<a name="ln-9001"></a>  <span class="k">RETURN</span>
<a name="ln-9002"></a>
<a name="ln-9003"></a><span class="k">END SUBROUTINE </span><span class="n">GetMovableInsulationData</span>
<a name="ln-9004"></a>
<a name="ln-9005"></a><span class="k">SUBROUTINE </span><span class="n">CalculateZoneVolume</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CeilingHeightEntered</span><span class="p">)</span>
<a name="ln-9006"></a>
<a name="ln-9007"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9008"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-9009"></a>          <span class="c">!       DATE WRITTEN   1992-1994</span>
<a name="ln-9010"></a>          <span class="c">!       MODIFIED       Sep 2007</span>
<a name="ln-9011"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9012"></a>
<a name="ln-9013"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9014"></a>          <span class="c">! This subroutine calculates the volume (m3) of a zone using the</span>
<a name="ln-9015"></a>          <span class="c">! surfaces as possible.</span>
<a name="ln-9016"></a>
<a name="ln-9017"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9018"></a>          <span class="c">! Uses surface area information for calculations.  Modified to use the</span>
<a name="ln-9019"></a>          <span class="c">! user-entered ceiling height (x floor area, if applicable) instead of using</span>
<a name="ln-9020"></a>          <span class="c">! the calculated volume when the user enters the ceiling height.</span>
<a name="ln-9021"></a>
<a name="ln-9022"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9023"></a>          <span class="c">! Legacy Code (IBLAST)</span>
<a name="ln-9024"></a>
<a name="ln-9025"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9026"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span><span class="n">GetNumSectionsFound</span>
<a name="ln-9027"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-9028"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-9029"></a>
<a name="ln-9030"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9031"></a>
<a name="ln-9032"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9033"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-9034"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CeilingHeightEntered</span>
<a name="ln-9035"></a>
<a name="ln-9036"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9037"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">VolFmt</span><span class="o">=</span><span class="s2">&quot;(F20.2)&quot;</span>
<a name="ln-9038"></a>
<a name="ln-9039"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9040"></a>          <span class="c">! na</span>
<a name="ln-9041"></a>
<a name="ln-9042"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9043"></a>          <span class="c">! na</span>
<a name="ln-9044"></a>
<a name="ln-9045"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9046"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">MinimumVolume</span>        <span class="c">! The minimum allowable Zone volume (equivalent to a ceiling height of 2.5 meters)</span>
<a name="ln-9047"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SumAreas</span>             <span class="c">! Sum of the Zone surface areas that are not &quot;internal mass&quot;</span>
<a name="ln-9048"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfCount</span>            <span class="c">! Surface Count</span>
<a name="ln-9049"></a>  <span class="kt">INTEGER </span><span class="n">SurfNum</span>           <span class="c">! Loop counter for surfaces</span>
<a name="ln-9050"></a>  <span class="kt">INTEGER </span><span class="n">ZoneNum</span>           <span class="c">! Loop counter for Zones</span>
<a name="ln-9051"></a>  <span class="kt">LOGICAL </span><span class="n">ErrorFlag</span>
<a name="ln-9052"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempVolume</span>           <span class="c">! Temporary for calculating volume</span>
<a name="ln-9053"></a>  <span class="k">type</span><span class="p">(</span><span class="n">polyhedron</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneStruct</span>
<a name="ln-9054"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">surfacenotused</span>
<a name="ln-9055"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">notused</span>
<a name="ln-9056"></a>  <span class="kt">INTEGER </span><span class="n">NFaces</span>
<a name="ln-9057"></a>  <span class="kt">INTEGER </span><span class="n">NActFaces</span>
<a name="ln-9058"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CalcVolume</span>
<a name="ln-9059"></a>  <span class="kt">LOGICAL </span><span class="n">initmsg</span>
<a name="ln-9060"></a>  <span class="kt">integer </span><span class="n">iside</span>
<a name="ln-9061"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ShowZoneSurfaces</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9062"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ShowZoneSurfaceHeaders</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9063"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9064"></a>
<a name="ln-9065"></a>  <span class="n">initmsg</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9066"></a>  <span class="n">ShowZoneSurfaces</span><span class="o">=</span><span class="p">(</span><span class="n">GetNumSectionsFound</span><span class="p">(</span><span class="s1">&#39;SHOWZONESURFACES_DEBUG&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-9067"></a>
<a name="ln-9068"></a>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-9069"></a>
<a name="ln-9070"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">HasFloor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9071"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;No floor exists in Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9072"></a>         <span class="s1">&#39;&quot;, zone floor area is zero. All values for this zone that are entered per floor area will be zero.&#39;</span><span class="p">)</span>
<a name="ln-9073"></a>    <span class="n">ENDIF</span>
<a name="ln-9074"></a>
<a name="ln-9075"></a>    <span class="n">SumAreas</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9076"></a>    <span class="n">SurfCount</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9077"></a>    <span class="n">NFaces</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9078"></a>    <span class="n">notused</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9079"></a>    <span class="n">ZoneStruct</span><span class="p">%</span><span class="n">NumSurfaceFaces</span><span class="o">=</span><span class="n">NFaces</span>
<a name="ln-9080"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NFaces</span><span class="p">))</span>
<a name="ln-9081"></a>    <span class="n">NActFaces</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9082"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">surfacenotused</span><span class="p">(</span><span class="n">NFaces</span><span class="p">))</span>
<a name="ln-9083"></a>    <span class="n">surfacenotused</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9084"></a>
<a name="ln-9085"></a>    <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-9086"></a>
<a name="ln-9087"></a>      <span class="c">! Only include Base Surfaces in Calc.</span>
<a name="ln-9088"></a>
<a name="ln-9089"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Floor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9090"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9091"></a><span class="k">        </span><span class="n">notused</span><span class="o">=</span><span class="n">notused</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9092"></a>        <span class="n">surfacenotused</span><span class="p">(</span><span class="n">notused</span><span class="p">)</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-9093"></a>        <span class="k">CYCLE</span>
<a name="ln-9094"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-9095"></a>
<a name="ln-9096"></a>      <span class="n">NActFaces</span><span class="o">=</span><span class="n">NActFaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9097"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">FacePoints</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-9098"></a>      <span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">NSides</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-9099"></a>      <span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">SurfNum</span><span class="o">=</span><span class="n">SurfNum</span>
<a name="ln-9100"></a>      <span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">FacePoints</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-9101"></a>      <span class="k">CALL </span><span class="n">CreateNewellAreaVector</span><span class="p">(</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">FacePoints</span><span class="p">,</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">NSides</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9102"></a>                              <span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-9103"></a>      <span class="n">SumAreas</span><span class="o">=</span><span class="n">SumAreas</span><span class="o">+</span><span class="n">VecLength</span><span class="p">(</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">)%</span><span class="n">NewellAreaVector</span><span class="p">)</span>
<a name="ln-9104"></a>    <span class="n">ENDDO</span>
<a name="ln-9105"></a>    <span class="n">ZoneStruct</span><span class="p">%</span><span class="n">NumSurfaceFaces</span><span class="o">=</span><span class="n">NActFaces</span>
<a name="ln-9106"></a>    <span class="n">SurfCount</span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NActFaces</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9107"></a>    <span class="k">CALL </span><span class="n">CalcPolyhedronVolume</span><span class="p">(</span><span class="n">ZoneStruct</span><span class="p">,</span><span class="n">CalcVolume</span><span class="p">)</span>
<a name="ln-9108"></a>
<a name="ln-9109"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9110"></a><span class="k">      </span><span class="n">MinimumVolume</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">*</span> <span class="mf">2.5d0</span>
<a name="ln-9111"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9112"></a><span class="k">        </span><span class="n">MinimumVolume</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span>
<a name="ln-9113"></a>      <span class="n">ENDIF</span>
<a name="ln-9114"></a>    <span class="k">ELSE</span>
<a name="ln-9115"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9116"></a><span class="k">        </span><span class="n">MinimumVolume</span><span class="o">=</span><span class="nb">SQRT</span><span class="p">(</span><span class="n">SumAreas</span><span class="o">/</span><span class="n">SurfCount</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-9117"></a>      <span class="k">ELSE</span>
<a name="ln-9118"></a><span class="k">        </span><span class="n">MinimumVolume</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9119"></a>      <span class="n">ENDIF</span>
<a name="ln-9120"></a>    <span class="n">ENDIF</span>
<a name="ln-9121"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CalcVolume</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9122"></a><span class="k">      </span><span class="n">TempVolume</span><span class="o">=</span><span class="n">CalcVolume</span>
<a name="ln-9123"></a>    <span class="k">ELSE</span>
<a name="ln-9124"></a><span class="k">      </span><span class="n">TempVolume</span><span class="o">=</span><span class="n">MinimumVolume</span>
<a name="ln-9125"></a>    <span class="n">ENDIF</span>
<a name="ln-9126"></a>
<a name="ln-9127"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! User entered zone volume, produce message if not near calculated</span>
<a name="ln-9128"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TempVolume</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9129"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TempVolume</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">)</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span>  <span class="o">&gt;</span> <span class="p">.</span><span class="mi">05</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9130"></a><span class="k">          </span><span class="n">ErrCount</span><span class="o">=</span><span class="n">ErrCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9131"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrCount</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9132"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">initmsg</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9133"></a><span class="k">              CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;Note that the following warning(s) may/will occur if you have not enclosed your zone completely.&#39;</span><span class="p">)</span>
<a name="ln-9134"></a>              <span class="n">initmsg</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9135"></a>            <span class="n">ENDIF</span>
<a name="ln-9136"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Entered Zone Volumes differ from calculated zone volume(s).&#39;</span><span class="p">)</span>
<a name="ln-9137"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...use Output:Diagnostics,DisplayExtraWarnings; to show more details on individual zones.&#39;</span><span class="p">)</span>
<a name="ln-9138"></a>          <span class="n">ENDIF</span>
<a name="ln-9139"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9140"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">initmsg</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9141"></a><span class="k">              CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;Note that the following warning(s) may/will occur if you have not enclosed your zone completely.&#39;</span><span class="p">)</span>
<a name="ln-9142"></a>              <span class="n">initmsg</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9143"></a>            <span class="n">ENDIF</span>
<a name="ln-9144"></a>            <span class="c">! Warn user of using specified Zone Volume</span>
<a name="ln-9145"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Entered Volume entered for Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9146"></a>                                  <span class="s1">&#39;&quot; significantly different from calculated Volume&#39;</span><span class="p">)</span>
<a name="ln-9147"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered Zone Volume value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9148"></a>                                   <span class="s1">&#39;, Calculated Zone Volume value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TempVolume</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9149"></a>                                  <span class="s1">&#39;, entered volume will be used in calculations.&#39;</span><span class="p">)</span>
<a name="ln-9150"></a>          <span class="n">ENDIF</span>
<a name="ln-9151"></a>        <span class="n">ENDIF</span>
<a name="ln-9152"></a>      <span class="n">ENDIF</span>
<a name="ln-9153"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CeilingHeightEntered</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! User did not enter zone volume, but entered ceiling height</span>
<a name="ln-9154"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9155"></a><span class="k">        </span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span>
<a name="ln-9156"></a>      <span class="k">ELSE</span> <span class="c">! ceiling height entered but floor area zero</span>
<a name="ln-9157"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="o">=</span><span class="n">TempVolume</span>
<a name="ln-9158"></a>      <span class="n">ENDIF</span>
<a name="ln-9159"></a>    <span class="k">ELSE</span>  <span class="c">! Neither ceiling height nor volume entered</span>
<a name="ln-9160"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="o">=</span><span class="n">TempVolume</span>
<a name="ln-9161"></a>    <span class="n">ENDIF</span>
<a name="ln-9162"></a>
<a name="ln-9163"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9164"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Indicated Zone Volume &lt;= 0.0 for Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9165"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone Volume calculated was=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-9166"></a>    <span class="n">ENDIF</span>
<a name="ln-9167"></a>
<a name="ln-9168"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShowZoneSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9169"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ShowZoneSurfaceHeaders</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9170"></a><span class="k">        write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;===================================&#39;</span>
<a name="ln-9171"></a>        <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;showing zone surfaces used and not used in volume calculation&#39;</span>
<a name="ln-9172"></a>        <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;for volume calculation, only floors, walls and roofs/ceilings are used&#39;</span>
<a name="ln-9173"></a>        <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;surface class, 1=wall, 2=floor, 3=roof/ceiling&#39;</span>
<a name="ln-9174"></a>        <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;unused surface class(es), 5=internal mass, 11=window, 12=glass door&#39;</span>
<a name="ln-9175"></a>        <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;                          13=door, 14=shading, 15=overhang, 16=fin&#39;</span>
<a name="ln-9176"></a>        <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;                          17=TDD Dome, 18=TDD Diffuser&#39;</span>
<a name="ln-9177"></a>        <span class="n">ShowZoneSurfaceHeaders</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9178"></a>      <span class="n">ENDIF</span>
<a name="ln-9179"></a>      <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;===================================&#39;</span>
<a name="ln-9180"></a>      <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;zone=&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">name</span><span class="p">),</span><span class="s1">&#39; calc volume=&#39;</span><span class="p">,</span><span class="n">calcvolume</span>
<a name="ln-9181"></a>      <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39; nsurfaces=&#39;</span><span class="p">,</span><span class="n">nfaces</span><span class="p">,</span><span class="s1">&#39; nactual=&#39;</span><span class="p">,</span><span class="n">nactfaces</span>
<a name="ln-9182"></a>    <span class="n">ENDIF</span>
<a name="ln-9183"></a>    <span class="k">do </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">NumSurfaceFaces</span>
<a name="ln-9184"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ShowZoneSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9185"></a><span class="k">        if</span> <span class="p">(</span><span class="n">surfnum</span> <span class="o">&lt;=</span> <span class="n">nactfaces</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9186"></a><span class="k">          write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;surface=&#39;</span><span class="p">,</span><span class="n">zonestruct</span><span class="p">%</span><span class="n">surfaceface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">surfnum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9187"></a>                                   <span class="s1">&#39; nsides=&#39;</span><span class="p">,</span><span class="n">zonestruct</span><span class="p">%</span><span class="n">surfaceface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Nsides</span>
<a name="ln-9188"></a>          <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;surface name=&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">zonestruct</span><span class="p">%</span><span class="n">surfaceface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-9189"></a>                                    <span class="s1">&#39; class=&#39;</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">zonestruct</span><span class="p">%</span><span class="n">surfaceface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">surfnum</span><span class="p">)%</span><span class="k">class</span>
<a name="ln-9190"></a><span class="k">          write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;area=&#39;</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">zonestruct</span><span class="p">%</span><span class="n">surfaceface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">grossarea</span>
<a name="ln-9191"></a>          <span class="k">do </span><span class="n">iside</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zonestruct</span><span class="p">%</span><span class="n">surfaceface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Nsides</span>
<a name="ln-9192"></a>            <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">zonestruct</span><span class="p">%</span><span class="n">surfaceface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">facepoints</span><span class="p">(</span><span class="n">iside</span><span class="p">)</span>
<a name="ln-9193"></a>          <span class="n">enddo</span>
<a name="ln-9194"></a>        <span class="n">endif</span>
<a name="ln-9195"></a>      <span class="n">ENDIF</span>
<a name="ln-9196"></a>      <span class="k">deallocate</span><span class="p">(</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FacePoints</span><span class="p">)</span>
<a name="ln-9197"></a>    <span class="n">enddo</span>
<a name="ln-9198"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShowZoneSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9199"></a><span class="k">      do </span><span class="n">surfnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">notused</span>
<a name="ln-9200"></a>        <span class="k">write</span><span class="p">(</span><span class="n">outputfiledebug</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;notused:surface=&#39;</span><span class="p">,</span><span class="n">surfacenotused</span><span class="p">(</span><span class="n">surfnum</span><span class="p">),</span><span class="s1">&#39; name=&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9201"></a>          <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surfacenotused</span><span class="p">(</span><span class="n">surfnum</span><span class="p">))%</span><span class="n">name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-9202"></a>          <span class="s1">&#39; class=&#39;</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surfacenotused</span><span class="p">(</span><span class="n">surfnum</span><span class="p">))%</span><span class="k">class</span>
<a name="ln-9203"></a><span class="k">      </span><span class="n">enddo</span>
<a name="ln-9204"></a>    <span class="n">ENDIF</span>
<a name="ln-9205"></a>
<a name="ln-9206"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">ZoneStruct</span><span class="p">%</span><span class="n">SurfaceFace</span><span class="p">)</span>
<a name="ln-9207"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">surfacenotused</span><span class="p">)</span>
<a name="ln-9208"></a>
<a name="ln-9209"></a>  <span class="k">END DO</span>
<a name="ln-9210"></a>
<a name="ln-9211"></a><span class="k">  </span><span class="n">ErrorFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9212"></a>  <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-9213"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ErrorFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9214"></a>  <span class="k">END DO</span>
<a name="ln-9215"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9216"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;All ZONE Volumes must be &gt; 0.0&#39;</span><span class="p">)</span>
<a name="ln-9217"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9218"></a>  <span class="n">ENDIF</span>
<a name="ln-9219"></a>
<a name="ln-9220"></a>  <span class="k">RETURN</span>
<a name="ln-9221"></a>
<a name="ln-9222"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateZoneVolume</span>
<a name="ln-9223"></a>
<a name="ln-9224"></a><span class="k">SUBROUTINE </span><span class="n">ProcessSurfaceVertices</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-9225"></a>
<a name="ln-9226"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9227"></a>          <span class="c">!       AUTHOR         Legacy Code (Walton)</span>
<a name="ln-9228"></a>          <span class="c">!       DATE WRITTEN   1976</span>
<a name="ln-9229"></a>          <span class="c">!       MODIFIED        FW, Mar 2002: Add triangular windows</span>
<a name="ln-9230"></a>          <span class="c">!                       FW, May 2002: modify test for 4-sided but non-rectangular subsurfaces</span>
<a name="ln-9231"></a>          <span class="c">!                       FW, Sep 2002: add shape for base surfaces (walls and detached shading surfaces)</span>
<a name="ln-9232"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9233"></a>
<a name="ln-9234"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9235"></a>          <span class="c">! This subroutine processes each surface into the vertex representation used</span>
<a name="ln-9236"></a>          <span class="c">! by the shading procedures.</span>
<a name="ln-9237"></a>          <span class="c">! This routine depends on the surfaces coming in:</span>
<a name="ln-9238"></a>          <span class="c">!  Base Surface</span>
<a name="ln-9239"></a>          <span class="c">!   SubSurface (Window/Door)</span>
<a name="ln-9240"></a>          <span class="c">!   SubSurface</span>
<a name="ln-9241"></a>          <span class="c">!  Base Surface</span>
<a name="ln-9242"></a>          <span class="c">!   SubSurface</span>
<a name="ln-9243"></a>          <span class="c">!   SubSurface</span>
<a name="ln-9244"></a>          <span class="c">!  Thus, some attributes of the &quot;Base Surface&quot; must be SAVEd.</span>
<a name="ln-9245"></a>
<a name="ln-9246"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9247"></a>          <span class="c">! Detached Shading, Base Surfaces, Attached Shading surfaces are represented in the</span>
<a name="ln-9248"></a>          <span class="c">! same manner as original.  Subsurfaces (windows, doors) are a &quot;relative coordinate&quot;.</span>
<a name="ln-9249"></a>
<a name="ln-9250"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9251"></a>          <span class="c">! na</span>
<a name="ln-9252"></a>
<a name="ln-9253"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9254"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-9255"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-9256"></a>
<a name="ln-9257"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9258"></a>
<a name="ln-9259"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9260"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ThisSurf</span>    <span class="c">! Surface Number</span>
<a name="ln-9261"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-9262"></a>
<a name="ln-9263"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9264"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;ProcessSurfaceVertices: &#39;</span>
<a name="ln-9265"></a>
<a name="ln-9266"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9267"></a>          <span class="c">! na</span>
<a name="ln-9268"></a>
<a name="ln-9269"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9270"></a>          <span class="c">! na</span>
<a name="ln-9271"></a>
<a name="ln-9272"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9273"></a>          <span class="c">! na</span>
<a name="ln-9274"></a>
<a name="ln-9275"></a>          <span class="c">! LOCAL VARIABLES</span>
<a name="ln-9276"></a><span class="c">!  REAL(r64) :: X00    ! Intermediate Result</span>
<a name="ln-9277"></a><span class="c">!  REAL(r64) :: Y00    ! Intermediate Result</span>
<a name="ln-9278"></a><span class="c">!  REAL(r64) :: Z00    ! Intermediate Result</span>
<a name="ln-9279"></a><span class="c">!  REAL(r64) :: A(3,3) ! Surface Rotation Matrix</span>
<a name="ln-9280"></a><span class="c">!  REAL(r64), SAVE :: B(3,3) ! Inverse Of Rotation Matrix</span>
<a name="ln-9281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X1</span>    <span class="c">! Intermediate Result</span>
<a name="ln-9282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y1</span>    <span class="c">! Intermediate Result</span>
<a name="ln-9283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Z1</span>    <span class="c">! Intermediate Result</span>
<a name="ln-9284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">XSHIFT</span>  <span class="c">! Shift of X to Lower Left Corner</span>
<a name="ln-9285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">YSHIFT</span>  <span class="c">! Shift of Y to Lower Left Corner</span>
<a name="ln-9286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">XLLC</span>   <span class="c">! X-coordinate of lower left corner</span>
<a name="ln-9287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">YLLC</span>   <span class="c">! Y-coordinate of lower left corner</span>
<a name="ln-9288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZLLC</span>   <span class="c">! Z-coordinate of lower left corner</span>
<a name="ln-9289"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9290"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9291"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-9292"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9293"></a><span class="c">!  INTEGER :: I  ! Loop Control</span>
<a name="ln-9294"></a><span class="c">!  INTEGER :: J  ! Loop Control</span>
<a name="ln-9295"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">N</span>  <span class="c">! Vertex Number in Loop</span>
<a name="ln-9296"></a>  <span class="kt">INTEGER </span><span class="n">ThisBaseSurface</span>  <span class="c">! Current base surface</span>
<a name="ln-9297"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Xp</span>
<a name="ln-9298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Yp</span>
<a name="ln-9299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Zp</span>
<a name="ln-9300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BaseCosAzimuth</span>
<a name="ln-9301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BaseCosTilt</span>
<a name="ln-9302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BaseSinAzimuth</span>
<a name="ln-9303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BaseSinTilt</span>
<a name="ln-9304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BaseXLLC</span>
<a name="ln-9305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BaseYLLC</span>
<a name="ln-9306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">BaseZLLC</span>
<a name="ln-9307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfWorldAz</span>  <span class="c">! Surface Azimuth (facing)</span>
<a name="ln-9308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfTilt</span>     <span class="c">! Surface Tilt</span>
<a name="ln-9309"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">planeeq</span><span class="p">)</span> <span class="n">BasePlane</span>
<a name="ln-9310"></a><span class="c">!  type (planeeq) PlanarEQ</span>
<a name="ln-9311"></a><span class="c">!  type (vector), dimension(3) :: TriVect</span>
<a name="ln-9312"></a><span class="c">!  REAL(r64) testval</span>
<a name="ln-9313"></a><span class="c">!  INTEGER ploop</span>
<a name="ln-9314"></a><span class="c">!  INTEGER vloop</span>
<a name="ln-9315"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="n">TVect</span>
<a name="ln-9316"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="n">CoordinateTransVector</span>
<a name="ln-9317"></a>  <span class="kt">INTEGER </span><span class="n">ThisShape</span>
<a name="ln-9318"></a>  <span class="kt">LOGICAL </span><span class="n">BaseSurface</span>   <span class="c">! True if a base surface or a detached shading surface</span>
<a name="ln-9319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ThisSurfAz</span>
<a name="ln-9320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ThisSurfTilt</span>
<a name="ln-9321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ThisReveal</span>
<a name="ln-9322"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ThisWidth</span>
<a name="ln-9323"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ThisHeight</span>
<a name="ln-9324"></a>  <span class="kt">INTEGER </span><span class="n">FrDivNum</span> <span class="c">! Frame/divider number</span>
<a name="ln-9325"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">FrWidth</span>    <span class="c">! Frame width for exterior windows (m)</span>
<a name="ln-9326"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">FrArea</span>     <span class="c">! Frame area for exterior windows(m2)</span>
<a name="ln-9327"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DivWidth</span>   <span class="c">! Divider width for exterior windows (m)</span>
<a name="ln-9328"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DivArea</span>    <span class="c">! Divider area for exterior windows (m2)</span>
<a name="ln-9329"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DivFrac</span>    <span class="c">! Fraction of divider area without overlaps</span>
<a name="ln-9330"></a>  <span class="kt">LOGICAL </span><span class="n">ErrorInSurface</span> <span class="c">! false/true, depending on pass through routine</span>
<a name="ln-9331"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Diagonal1</span>  <span class="c">! Length of diagonal of 4-sided figure (m)</span>
<a name="ln-9332"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Diagonal2</span>  <span class="c">! Length of diagonal of 4-sided figure (m)</span>
<a name="ln-9333"></a>  <span class="kt">LOGICAL </span><span class="n">SError</span>
<a name="ln-9334"></a>  <span class="kt">LOGICAL </span><span class="n">HeatTransSurf</span>
<a name="ln-9335"></a>  <span class="kt">LOGICAL </span><span class="n">IsCoplanar</span>
<a name="ln-9336"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">OutOfLine</span>
<a name="ln-9337"></a>  <span class="kt">INTEGER </span><span class="n">LastVertexInError</span>
<a name="ln-9338"></a>
<a name="ln-9339"></a>  <span class="n">ErrorInSurface</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9340"></a>
<a name="ln-9341"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9342"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">))</span>
<a name="ln-9343"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">))</span>
<a name="ln-9344"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">))</span>
<a name="ln-9345"></a>    <span class="n">X</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9346"></a>    <span class="n">Y</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9347"></a>    <span class="n">Z</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9348"></a>    <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9349"></a>  <span class="n">ENDIF</span>
<a name="ln-9350"></a>
<a name="ln-9351"></a><span class="c">! Categorize this surface</span>
<a name="ln-9352"></a>
<a name="ln-9353"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">ThisSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9354"></a><span class="k">     </span><span class="n">BaseSurface</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9355"></a>   <span class="k">ELSE</span>
<a name="ln-9356"></a><span class="k">     </span><span class="n">BaseSurface</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9357"></a>   <span class="n">ENDIF</span>
<a name="ln-9358"></a>
<a name="ln-9359"></a>   <span class="n">ThisBaseSurface</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span>  <span class="c">! Dont know if this is still needed or not</span>
<a name="ln-9360"></a>   <span class="n">HeatTransSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">HeatTransSurf</span>
<a name="ln-9361"></a>
<a name="ln-9362"></a>   <span class="c">! Kludge for daylighting shelves</span>
<a name="ln-9363"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9364"></a><span class="k">     </span><span class="n">ThisBaseSurface</span> <span class="o">=</span> <span class="n">ThisSurf</span>
<a name="ln-9365"></a>     <span class="n">HeatTransSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9366"></a>   <span class="k">END IF</span>
<a name="ln-9367"></a>
<a name="ln-9368"></a>   <span class="c">!IF (Surface(ThisSurf)%Name(1:3) /= &#39;Mir&#39;) THEN</span>
<a name="ln-9369"></a>   <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9370"></a><span class="k">     CALL </span><span class="n">CalcCoPlanarNess</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">IsCoplanar</span><span class="p">,</span><span class="n">OutOfLine</span><span class="p">,</span><span class="n">LastVertexInError</span><span class="p">)</span>
<a name="ln-9371"></a>     <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsCoPlanar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9372"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">OutOfLine</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">01</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9373"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Suspected non-planar surface:&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9374"></a>                              <span class="s1">&#39; Max &quot;out of line&quot;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">OutOfLine</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; at Vertex # &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9375"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LastVertexInError</span><span class="p">)))</span>
<a name="ln-9376"></a>       <span class="k">ELSE</span>
<a name="ln-9377"></a><span class="k">         CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Possible non-planar surface:&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9378"></a>                              <span class="s1">&#39; Max &quot;out of line&quot;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">OutOfLine</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; at Vertex # &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9379"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LastVertexInError</span><span class="p">)))</span>
<a name="ln-9380"></a>       <span class="n">ENDIF</span>
<a name="ln-9381"></a><span class="c">!       ErrorInSurface=.true.</span>
<a name="ln-9382"></a>     <span class="n">ENDIF</span>
<a name="ln-9383"></a>   <span class="n">ENDIF</span>
<a name="ln-9384"></a>
<a name="ln-9385"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">BaseSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9386"></a><span class="k">     </span><span class="n">SurfWorldAz</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-9387"></a>     <span class="n">SurfTilt</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-9388"></a>     <span class="n">BaseCosAzimuth</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-9389"></a>     <span class="n">BaseSinAzimuth</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfWorldAz</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-9390"></a>     <span class="n">BaseCosTilt</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-9391"></a>     <span class="n">BaseSinTilt</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SurfTilt</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-9392"></a>     <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-9393"></a>       <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-9394"></a>       <span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-9395"></a>       <span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-9396"></a>     <span class="n">ENDDO</span>
<a name="ln-9397"></a>     <span class="n">BaseXLLC</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-9398"></a>     <span class="n">BaseYLLC</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-9399"></a>     <span class="n">BaseZLLC</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-9400"></a>     <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9401"></a>     <span class="n">ThisWidth</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9402"></a>     <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9403"></a>     <span class="n">ThisHeight</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9404"></a>     <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">ThisWidth</span>
<a name="ln-9405"></a>     <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">ThisHeight</span> <span class="c">! For a horizontal surface this is actually length!</span>
<a name="ln-9406"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">Triangle</span>
<a name="ln-9407"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9408"></a><span class="k">       </span><span class="n">Diagonal1</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-9409"></a>       <span class="n">Diagonal2</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-9410"></a>       <span class="c">! Test for rectangularity</span>
<a name="ln-9411"></a>       <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Diagonal1</span><span class="o">-</span><span class="n">Diagonal2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.020d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9412"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">Rectangle</span>
<a name="ln-9413"></a>       <span class="k">ELSE</span>
<a name="ln-9414"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">Quadrilateral</span>
<a name="ln-9415"></a>       <span class="k">END IF</span>
<a name="ln-9416"></a><span class="k">     END IF</span>
<a name="ln-9417"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">&gt;</span><span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9418"></a><span class="k">       </span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">Polygonal</span>
<a name="ln-9419"></a>       <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">thisheight</span><span class="o">*</span><span class="n">thiswidth</span><span class="o">-</span><span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">grossarea</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9420"></a><span class="k">         </span><span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">width</span><span class="o">=</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">grossarea</span><span class="p">)</span>
<a name="ln-9421"></a>         <span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">height</span><span class="o">=</span><span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">width</span>
<a name="ln-9422"></a>         <span class="n">thiswidth</span><span class="o">=</span><span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">width</span>
<a name="ln-9423"></a>         <span class="n">thisheight</span><span class="o">=</span><span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">height</span>
<a name="ln-9424"></a>       <span class="n">endif</span>
<a name="ln-9425"></a>     <span class="n">ENDIF</span>
<a name="ln-9426"></a>
<a name="ln-9427"></a>   <span class="k">ELSE</span>   <span class="c">! It&#39;s a subsurface to previous basesurface in this set of calls</span>
<a name="ln-9428"></a>
<a name="ln-9429"></a>     <span class="n">ThisSurfAz</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-9430"></a>     <span class="n">ThisSurfTilt</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-9431"></a>
<a name="ln-9432"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9433"></a>
<a name="ln-9434"></a><span class="k">       IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9435"></a><span class="k">          </span><span class="n">ThisShape</span><span class="o">=</span><span class="n">RectangularDoorWindow</span>
<a name="ln-9436"></a>       <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9437"></a><span class="k">          </span><span class="n">ThisShape</span><span class="o">=</span><span class="n">TriangularWindow</span>
<a name="ln-9438"></a>       <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9439"></a><span class="k">          </span><span class="n">ThisShape</span><span class="o">=</span><span class="n">TriangularDoor</span>
<a name="ln-9440"></a>       <span class="k">END IF</span>
<a name="ln-9441"></a>
<a name="ln-9442"></a><span class="k">     ELSE</span>    <span class="c">!  this is a shadowing subsurface</span>
<a name="ln-9443"></a>
<a name="ln-9444"></a>       <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Basesurf</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">-</span><span class="n">ThisSurfTilt</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">.</span><span class="mi">01</span><span class="n">d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9445"></a>         <span class="c">! left or right fin</span>
<a name="ln-9446"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ThisSurfAz</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ThisSurfAz</span><span class="o">=</span><span class="n">ThisSurfAz</span><span class="o">+</span><span class="mi">36</span><span class="mf">0.d0</span>
<a name="ln-9447"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ThisSurfAz</span> <span class="o">&gt;</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9448"></a><span class="k">           </span><span class="n">ThisShape</span><span class="o">=</span><span class="n">RectangularLeftFin</span>
<a name="ln-9449"></a>         <span class="k">ELSE</span>
<a name="ln-9450"></a><span class="k">           </span><span class="n">ThisShape</span><span class="o">=</span><span class="n">RectangularRightFin</span>
<a name="ln-9451"></a>         <span class="n">ENDIF</span>
<a name="ln-9452"></a>       <span class="k">ELSE</span>
<a name="ln-9453"></a><span class="k">         </span><span class="n">ThisShape</span><span class="o">=</span><span class="n">RectangularOverhang</span>
<a name="ln-9454"></a>       <span class="n">ENDIF</span>
<a name="ln-9455"></a>
<a name="ln-9456"></a>     <span class="n">ENDIF</span>
<a name="ln-9457"></a>
<a name="ln-9458"></a>     <span class="c">! Setting relative coordinates for shadowing calculations for subsurfaces</span>
<a name="ln-9459"></a>     <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ThisShape</span><span class="p">)</span>
<a name="ln-9460"></a>
<a name="ln-9461"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">RectangularDoorWindow</span><span class="p">)</span> <span class="c">! Rectangular heat transfer subsurface</span>
<a name="ln-9462"></a>
<a name="ln-9463"></a>       <span class="k">CALL </span><span class="n">PlaneEquation</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">BasePlane</span><span class="p">,</span><span class="n">SError</span><span class="p">)</span>
<a name="ln-9464"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">SError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9465"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Degenerate surface (likely two vertices equal):&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-9466"></a>         <span class="n">ErrorInSurface</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9467"></a>       <span class="n">ENDIF</span>
<a name="ln-9468"></a>       <span class="n">ThisReveal</span><span class="o">=-</span><span class="n">Pt2Plane</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">BasePlane</span><span class="p">)</span>
<a name="ln-9469"></a>       <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ThisReveal</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">0002</span><span class="n">d0</span><span class="p">)</span> <span class="n">ThisReveal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9470"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Reveal</span><span class="o">=</span><span class="n">ThisReveal</span>
<a name="ln-9471"></a>       <span class="n">Xp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">BaseXLLC</span>
<a name="ln-9472"></a>       <span class="n">Yp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">BaseYLLC</span>
<a name="ln-9473"></a>       <span class="n">Zp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">BaseZLLC</span>
<a name="ln-9474"></a>       <span class="n">XLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span>
<a name="ln-9475"></a>       <span class="n">YLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">-</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseSinTilt</span>
<a name="ln-9476"></a>       <span class="n">ZLLC</span><span class="o">=</span> <span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseCosTilt</span>
<a name="ln-9477"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9478"></a>       <span class="n">ThisWidth</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9479"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9480"></a>       <span class="n">ThisHeight</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9481"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">ThisWidth</span>
<a name="ln-9482"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">ThisHeight</span>
<a name="ln-9483"></a>       <span class="n">Diagonal1</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-9484"></a>       <span class="n">Diagonal2</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-9485"></a>
<a name="ln-9486"></a>       <span class="c">! Test for rectangularity</span>
<a name="ln-9487"></a>       <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Diagonal1</span><span class="o">-</span><span class="n">Diagonal2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.020d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9488"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Suspected 4-sided but non-rectangular Window, Door or GlassDoor:&#39;</span><span class="p">)</span>
<a name="ln-9489"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9490"></a>                     <span class="o">//</span><span class="s1">&#39;, Diagonal1=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Diagonal1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Diagonal2=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Diagonal2</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-9491"></a>         <span class="n">ErrorInSurface</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9492"></a>       <span class="n">ENDIF</span>
<a name="ln-9493"></a>
<a name="ln-9494"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9495"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9496"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9497"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9498"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9499"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9500"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9501"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9502"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZLLC</span>
<a name="ln-9503"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZLLC</span>
<a name="ln-9504"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZLLC</span>
<a name="ln-9505"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZLLC</span>
<a name="ln-9506"></a>
<a name="ln-9507"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9508"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9509"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9510"></a><span class="k">         </span><span class="n">FrDivNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">FrameDivider</span>
<a name="ln-9511"></a>         <span class="c">! Set flag for calculating beam solar reflection from outside and/or inside window reveal</span>
<a name="ln-9512"></a>         <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Reveal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">OutsideRevealSolAbs</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9513"></a>            <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">InsideSillDepth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">InsideSillSolAbs</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9514"></a>            <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">InsideReveal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">InsideRevealSolAbs</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-9515"></a>           <span class="n">CalcWindowRevealReflection</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9516"></a>
<a name="ln-9517"></a>         <span class="c">! For exterior window with frame, subtract frame area from base surface</span>
<a name="ln-9518"></a>         <span class="c">! (only rectangular windows are allowed to have a frame and/or divider;</span>
<a name="ln-9519"></a>         <span class="c">! Surface(ThisSurf)%FrameDivider will be 0 for triangular windows)</span>
<a name="ln-9520"></a>         <span class="n">FrWidth</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameWidth</span>
<a name="ln-9521"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">FrWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9522"></a><span class="k">           </span><span class="n">FrArea</span> <span class="o">=</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">FrWidth</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">FrWidth</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9523"></a>                        <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-9524"></a>           <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">FrameArea</span> <span class="o">=</span> <span class="n">FrArea</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-9525"></a>           <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">FrameArea</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9526"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Base Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-9527"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Window Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9528"></a>                <span class="s1">&#39;&quot; area (with frame) is too large to fit on the surface.&#39;</span><span class="p">)</span>
<a name="ln-9529"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Base surface area (-windows and doors)=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9530"></a>                <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9531"></a>                <span class="s1">&#39;] m2, frame area=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">FrameArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] m2.&#39;</span><span class="p">)</span>
<a name="ln-9532"></a>             <span class="n">ErrorInSurface</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9533"></a>           <span class="n">ENDIF</span>
<a name="ln-9534"></a>           <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-9535"></a>               <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">FrameArea</span>
<a name="ln-9536"></a>         <span class="k">END IF</span>
<a name="ln-9537"></a>       <span class="c">! If exterior window has divider, subtract divider area to get glazed area</span>
<a name="ln-9538"></a>         <span class="n">DivWidth</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="p">)%</span><span class="n">DividerWidth</span>
<a name="ln-9539"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">DivWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorInSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9540"></a><span class="k">           </span><span class="n">DivArea</span> <span class="o">=</span> <span class="n">DivWidth</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9541"></a>             <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">HorDividers</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9542"></a>              <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">VertDividers</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9543"></a>              <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">HorDividers</span> <span class="o">*</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">VertDividers</span> <span class="o">*</span> <span class="n">DivWidth</span><span class="p">)</span>
<a name="ln-9544"></a>           <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">DividerArea</span> <span class="o">=</span> <span class="n">DivArea</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-9545"></a>           <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9546"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Divider area exceeds glazed opening for window &#39;</span><span class="p">&amp;</span>
<a name="ln-9547"></a>                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9548"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Window surface area=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9549"></a>                <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9550"></a>                <span class="s1">&#39;] m2, divider area=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] m2.&#39;</span><span class="p">)</span>
<a name="ln-9551"></a>             <span class="n">ErrorInSurface</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9552"></a>           <span class="n">ENDIF</span>
<a name="ln-9553"></a>           <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">DividerArea</span>  <span class="c">! Glazed area</span>
<a name="ln-9554"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">DivArea</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9555"></a><span class="k">             CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Calculated Divider Area &lt;= 0.0 for Window=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9556"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9557"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">HorDividers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9558"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Number of Horizontal Dividers = 0.&#39;</span><span class="p">)</span>
<a name="ln-9559"></a>             <span class="n">ENDIF</span>
<a name="ln-9560"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">VertDividers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9561"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Number of Vertical Dividers = 0.&#39;</span><span class="p">)</span>
<a name="ln-9562"></a>             <span class="n">ENDIF</span>
<a name="ln-9563"></a>           <span class="k">ELSE</span>
<a name="ln-9564"></a><span class="k">             </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9565"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-9566"></a>             <span class="c">! Correction factor for portion of divider subject to divider projection correction</span>
<a name="ln-9567"></a>             <span class="n">DivFrac</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">HorDividers</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9568"></a>               <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">VertDividers</span> <span class="o">*</span> <span class="n">DivWidth</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">DivArea</span><span class="p">)</span>
<a name="ln-9569"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ProjCorrDivOut</span> <span class="o">=</span> <span class="n">DivFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9570"></a>               <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerProjectionOut</span><span class="o">/</span><span class="n">DivWidth</span>
<a name="ln-9571"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ProjCorrDivIn</span> <span class="o">=</span> <span class="n">DivFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9572"></a>               <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerProjectionIn</span><span class="o">/</span><span class="n">DivWidth</span>
<a name="ln-9573"></a>             <span class="c">! Correction factor for portion of frame subject to frame projection correction</span>
<a name="ln-9574"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">FrWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9575"></a><span class="k">               </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ProjCorrFrOut</span> <span class="o">=</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameProjectionOut</span><span class="o">/</span><span class="n">FrWidth</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9576"></a>                   <span class="p">(</span><span class="n">ThisHeight</span><span class="o">+</span><span class="n">ThisWidth</span><span class="o">-</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">HorDividers</span> <span class="o">+</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">VertDividers</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9577"></a>                  <span class="n">DivWidth</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ThisHeight</span><span class="o">+</span><span class="n">ThisWidth</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">FrWidth</span><span class="p">)</span>
<a name="ln-9578"></a>               <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ProjCorrFrIn</span> <span class="o">=</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameProjectionIn</span><span class="o">/</span><span class="n">FrWidth</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9579"></a>                   <span class="p">(</span><span class="n">ThisHeight</span><span class="o">+</span><span class="n">ThisWidth</span><span class="o">-</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">HorDividers</span> <span class="o">+</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">VertDividers</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9580"></a>                   <span class="n">DivWidth</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ThisHeight</span><span class="o">+</span><span class="n">ThisWidth</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">FrWidth</span><span class="p">)</span>
<a name="ln-9581"></a>
<a name="ln-9582"></a>             <span class="k">END IF</span>
<a name="ln-9583"></a><span class="k">           END IF</span>
<a name="ln-9584"></a><span class="k">         END IF</span>
<a name="ln-9585"></a><span class="k">       END IF</span>
<a name="ln-9586"></a>
<a name="ln-9587"></a><span class="k">     CASE</span> <span class="p">(</span><span class="n">TriangularWindow</span><span class="p">,</span><span class="n">TriangularDoor</span><span class="p">)</span>
<a name="ln-9588"></a>
<a name="ln-9589"></a>       <span class="k">CALL </span><span class="n">PlaneEquation</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">BasePlane</span><span class="p">,</span><span class="n">SError</span><span class="p">)</span>
<a name="ln-9590"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">SError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9591"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Degenerate surface (likely two vertices equal):&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-9592"></a>         <span class="n">ErrorInSurface</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9593"></a>       <span class="n">ENDIF</span>
<a name="ln-9594"></a>       <span class="n">ThisReveal</span><span class="o">=-</span><span class="n">Pt2Plane</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">BasePlane</span><span class="p">)</span>
<a name="ln-9595"></a>       <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ThisReveal</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">0002</span><span class="n">d0</span><span class="p">)</span> <span class="n">ThisReveal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9596"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Reveal</span><span class="o">=</span><span class="n">ThisReveal</span>
<a name="ln-9597"></a>       <span class="n">Xp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">BaseXLLC</span>
<a name="ln-9598"></a>       <span class="n">Yp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">BaseYLLC</span>
<a name="ln-9599"></a>       <span class="n">Zp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">BaseZLLC</span>
<a name="ln-9600"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span>
<a name="ln-9601"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">-</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseSinTilt</span>
<a name="ln-9602"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span> <span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseCosTilt</span>
<a name="ln-9603"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9604"></a>       <span class="n">ThisWidth</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9605"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9606"></a>       <span class="n">ThisHeight</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9607"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">ThisWidth</span>
<a name="ln-9608"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">ThisHeight</span>
<a name="ln-9609"></a>       <span class="c">! Effective height and width of a triangular window for use in calc of convective air flow</span>
<a name="ln-9610"></a>       <span class="c">! in gap between glass and shading device when shading device is present</span>
<a name="ln-9611"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="mf">4.d0</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="p">(</span><span class="mf">3.d0</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span><span class="p">)</span>
<a name="ln-9612"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>  <span class="o">=</span> <span class="mf">0.75d0</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9613"></a>
<a name="ln-9614"></a>       <span class="n">Xp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">BaseXLLC</span>
<a name="ln-9615"></a>       <span class="n">Yp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">BaseYLLC</span>
<a name="ln-9616"></a>       <span class="n">Zp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">BaseZLLC</span>
<a name="ln-9617"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span>
<a name="ln-9618"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">-</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseSinTilt</span>
<a name="ln-9619"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span> <span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseCosTilt</span>
<a name="ln-9620"></a>
<a name="ln-9621"></a>       <span class="n">Xp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">BaseXLLC</span>
<a name="ln-9622"></a>       <span class="n">Yp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">BaseYLLC</span>
<a name="ln-9623"></a>       <span class="n">Zp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">BaseZLLC</span>
<a name="ln-9624"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span>
<a name="ln-9625"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">-</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseSinTilt</span>
<a name="ln-9626"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span> <span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseCosTilt</span>
<a name="ln-9627"></a>
<a name="ln-9628"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">RectangularOverhang</span><span class="p">)</span>
<a name="ln-9629"></a>
<a name="ln-9630"></a>       <span class="n">Xp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">BaseXLLC</span>
<a name="ln-9631"></a>       <span class="n">Yp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">BaseYLLC</span>
<a name="ln-9632"></a>       <span class="n">Zp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">BaseZLLC</span>
<a name="ln-9633"></a>       <span class="n">XLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span>
<a name="ln-9634"></a>       <span class="n">YLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">-</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseSinTilt</span>
<a name="ln-9635"></a>       <span class="n">ZLLC</span><span class="o">=</span> <span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseCosTilt</span>
<a name="ln-9636"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9637"></a>       <span class="n">ThisWidth</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9638"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9639"></a>       <span class="n">ThisHeight</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9640"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">ThisWidth</span>
<a name="ln-9641"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">ThisHeight</span>
<a name="ln-9642"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9643"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9644"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9645"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9646"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9647"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9648"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9649"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9650"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9651"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9652"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9653"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9654"></a>
<a name="ln-9655"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">RectangularLeftFin</span><span class="p">)</span>
<a name="ln-9656"></a>
<a name="ln-9657"></a>       <span class="n">Xp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">BaseXLLC</span>
<a name="ln-9658"></a>       <span class="n">Yp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">BaseYLLC</span>
<a name="ln-9659"></a>       <span class="n">Zp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">BaseZLLC</span>
<a name="ln-9660"></a>       <span class="n">XLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span>
<a name="ln-9661"></a>       <span class="n">YLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">-</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseSinTilt</span>
<a name="ln-9662"></a>       <span class="n">ZLLC</span><span class="o">=</span> <span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseCosTilt</span>
<a name="ln-9663"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9664"></a>       <span class="n">ThisWidth</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9665"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9666"></a>       <span class="n">ThisHeight</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9667"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">ThisWidth</span>
<a name="ln-9668"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">ThisHeight</span>
<a name="ln-9669"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9670"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9671"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9672"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9673"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9674"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9675"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9676"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9677"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9678"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9679"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9680"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9681"></a>
<a name="ln-9682"></a>     <span class="k">CASE</span> <span class="p">(</span><span class="n">RectangularRightFin</span><span class="p">)</span>
<a name="ln-9683"></a>
<a name="ln-9684"></a>       <span class="n">Xp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">BaseXLLC</span>
<a name="ln-9685"></a>       <span class="n">Yp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">BaseYLLC</span>
<a name="ln-9686"></a>       <span class="n">Zp</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">BaseZLLC</span>
<a name="ln-9687"></a>       <span class="n">XLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span>
<a name="ln-9688"></a>       <span class="n">YLLC</span><span class="o">=-</span><span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">-</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseCosTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseSinTilt</span>
<a name="ln-9689"></a>       <span class="n">ZLLC</span><span class="o">=</span> <span class="n">Xp</span><span class="o">*</span><span class="n">BaseSinAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Yp</span><span class="o">*</span><span class="n">BaseCosAzimuth</span><span class="o">*</span><span class="n">BaseSinTilt</span><span class="o">+</span><span class="n">Zp</span><span class="o">*</span><span class="n">BaseCosTilt</span>
<a name="ln-9690"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9691"></a>       <span class="n">ThisWidth</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9692"></a>       <span class="n">TVect</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9693"></a>       <span class="n">ThisHeight</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>
<a name="ln-9694"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span><span class="o">=</span><span class="n">ThisWidth</span>
<a name="ln-9695"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span><span class="o">=</span><span class="n">ThisHeight</span>
<a name="ln-9696"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9697"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9698"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9699"></a>       <span class="n">X</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">XLLC</span>
<a name="ln-9700"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9701"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9702"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9703"></a>       <span class="n">Y</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">YLLC</span>
<a name="ln-9704"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9705"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9706"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9707"></a>       <span class="n">Z</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9708"></a>
<a name="ln-9709"></a>     <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-9710"></a>       <span class="c">! Error Condition</span>
<a name="ln-9711"></a>       <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Incorrect surface shape number.&#39;</span><span class="p">,</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-9712"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Please notify EnergyPlus support of this error and send input file.&#39;</span><span class="p">)</span>
<a name="ln-9713"></a>       <span class="n">ErrorInSurface</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9714"></a>
<a name="ln-9715"></a>     <span class="k">END SELECT</span>
<a name="ln-9716"></a>
<a name="ln-9717"></a><span class="k">     DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-9718"></a>      <span class="c">! if less than 1/10 inch</span>
<a name="ln-9719"></a>       <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="nb">ANINT</span><span class="p">(</span><span class="mi">1000</span><span class="mf">0.d0</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="mf">0.d0</span>
<a name="ln-9720"></a>       <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">0025</span><span class="n">d0</span><span class="p">)</span> <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9721"></a>       <span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="nb">ANINT</span><span class="p">(</span><span class="mi">1000</span><span class="mf">0.d0</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="mf">0.d0</span>
<a name="ln-9722"></a>       <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">0025</span><span class="n">d0</span><span class="p">)</span> <span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9723"></a>       <span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="nb">ANINT</span><span class="p">(</span><span class="mi">1000</span><span class="mf">0.d0</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="mf">0.d0</span>
<a name="ln-9724"></a>       <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">0025</span><span class="n">d0</span><span class="p">)</span> <span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9725"></a>     <span class="n">ENDDO</span>
<a name="ln-9726"></a>
<a name="ln-9727"></a>     <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="nb">Shape</span><span class="o">=</span><span class="n">ThisShape</span>
<a name="ln-9728"></a>
<a name="ln-9729"></a>   <span class="n">ENDIF</span>  <span class="c">! End of check if ThisSurf is a base surface</span>
<a name="ln-9730"></a>
<a name="ln-9731"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9732"></a><span class="k">     </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9733"></a>     <span class="k">RETURN</span>
<a name="ln-9734"></a><span class="k">   </span><span class="n">ENDIF</span>
<a name="ln-9735"></a>
<a name="ln-9736"></a>    <span class="c">! Transfer to XV,YV,ZV arrays</span>
<a name="ln-9737"></a>
<a name="ln-9738"></a>   <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">NVert</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-9739"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-9740"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-9741"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ZV</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-9742"></a>
<a name="ln-9743"></a>   <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-9744"></a>    <span class="c">! if less than 1/10 inch</span>
<a name="ln-9745"></a>     <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-9746"></a>     <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-9747"></a>     <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">ZV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-9748"></a>   <span class="k">END DO</span>
<a name="ln-9749"></a>
<a name="ln-9750"></a>          <span class="c">! Process Surfaces According to Type of Coordinate Origin.</span>
<a name="ln-9751"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">BaseSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9752"></a>
<a name="ln-9753"></a>          <span class="c">! General Surfaces:</span>
<a name="ln-9754"></a>     <span class="k">CALL </span><span class="n">CalcCoordinateTransformation</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">,</span><span class="n">CoordinateTransVector</span><span class="p">)</span> <span class="c">!X00,Y00,Z00,X,Y,Z,A)    ! Compute Coordinate Transformation</span>
<a name="ln-9755"></a>
<a name="ln-9756"></a>          <span class="c">! RECORD DIRECTION COSINES.</span>
<a name="ln-9757"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! This is a general surface but not detached shading surface</span>
<a name="ln-9758"></a>
<a name="ln-9759"></a>          <span class="c">! RECORD COORDINATE TRANSFORMATION FOR BASE SURFACES.</span>
<a name="ln-9760"></a>       <span class="n">X0</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)</span> <span class="o">=</span> <span class="n">CoordinateTransVector</span><span class="p">%</span><span class="n">x</span>
<a name="ln-9761"></a>       <span class="n">Y0</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)</span> <span class="o">=</span> <span class="n">CoordinateTransVector</span><span class="p">%</span><span class="n">y</span>
<a name="ln-9762"></a>       <span class="n">Z0</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)</span> <span class="o">=</span> <span class="n">CoordinateTransVector</span><span class="p">%</span><span class="n">z</span>
<a name="ln-9763"></a>
<a name="ln-9764"></a>          <span class="c">! COMPUTE INVERSE TRANSFORMATION.</span>
<a name="ln-9765"></a>       <span class="n">X1</span>     <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">CoordinateTransVector</span><span class="p">%</span><span class="n">x</span>
<a name="ln-9766"></a>       <span class="n">Y1</span>     <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">CoordinateTransVector</span><span class="p">%</span><span class="n">y</span>
<a name="ln-9767"></a>       <span class="n">Z1</span>     <span class="o">=</span> <span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">CoordinateTransVector</span><span class="p">%</span><span class="n">z</span>
<a name="ln-9768"></a>       <span class="n">XSHIFT</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">X1</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">Y1</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">Z1</span>
<a name="ln-9769"></a>       <span class="n">YSHIFT</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">X1</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">Y1</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisBaseSurface</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">Z1</span>
<a name="ln-9770"></a>
<a name="ln-9771"></a>     <span class="n">ENDIF</span>
<a name="ln-9772"></a>
<a name="ln-9773"></a>          <span class="c">! SUBSURFACES: (Surface(ThisSurf)%BaseSurf /= ThisSurf)</span>
<a name="ln-9774"></a>   <span class="k">ELSE</span>
<a name="ln-9775"></a>          <span class="c">! WINDOWS OR DOORS:</span>
<a name="ln-9776"></a>
<a name="ln-9777"></a>          <span class="c">! SHIFT RELATIVE COORDINATES FROM LOWER LEFT CORNER TO ORIGIN DEFINED</span>
<a name="ln-9778"></a>          <span class="c">! BY CTRAN AND SET DIRECTION COSINES SAME AS BASE SURFACE.</span>
<a name="ln-9779"></a>
<a name="ln-9780"></a>     <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-9781"></a>       <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">XSHIFT</span>
<a name="ln-9782"></a>       <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">ThisSurf</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">YSHIFT</span>
<a name="ln-9783"></a>     <span class="n">ENDDO</span>
<a name="ln-9784"></a>
<a name="ln-9785"></a>   <span class="n">ENDIF</span>
<a name="ln-9786"></a>
<a name="ln-9787"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorInSurface</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9788"></a><span class="k">     </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9789"></a>   <span class="n">ENDIF</span>
<a name="ln-9790"></a>
<a name="ln-9791"></a>  <span class="k">RETURN</span>
<a name="ln-9792"></a>
<a name="ln-9793"></a><span class="k">END SUBROUTINE </span><span class="n">ProcessSurfaceVertices</span>
<a name="ln-9794"></a>
<a name="ln-9795"></a><span class="k">SUBROUTINE </span><span class="n">CalcCoordinateTransformation</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">CompCoordTranslVector</span><span class="p">)</span>
<a name="ln-9796"></a>
<a name="ln-9797"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9798"></a>          <span class="c">!       AUTHOR         George Walton, BLAST</span>
<a name="ln-9799"></a>          <span class="c">!       DATE WRITTEN   August 1976</span>
<a name="ln-9800"></a>          <span class="c">!       MODIFIED       LKL, May 2004 -- &gt;4 sided polygons</span>
<a name="ln-9801"></a>          <span class="c">!       RE-ENGINEERED  Yes</span>
<a name="ln-9802"></a>
<a name="ln-9803"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9804"></a>          <span class="c">! This subroutine develops a coordinate transformation such that the X-axis goes</span>
<a name="ln-9805"></a>          <span class="c">! through points 2 and 3 and the Y-axis goes through point 1</span>
<a name="ln-9806"></a>          <span class="c">! of a plane figure in 3-d space.</span>
<a name="ln-9807"></a>
<a name="ln-9808"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9809"></a>          <span class="c">! na</span>
<a name="ln-9810"></a>
<a name="ln-9811"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9812"></a>          <span class="c">! &#39;NECAP&#39; - NASA&#39;S Energy-Cost Analysis Program</span>
<a name="ln-9813"></a>
<a name="ln-9814"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9815"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-9816"></a>
<a name="ln-9817"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9818"></a>
<a name="ln-9819"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9820"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SurfNum</span>                 <span class="c">! Surface Number</span>
<a name="ln-9821"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompCoordTranslVector</span>  <span class="c">! Coordinate Translation Vector</span>
<a name="ln-9822"></a>
<a name="ln-9823"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9824"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ErrFmt</span><span class="o">=</span><span class="s2">&quot;(&#39; (&#39;,F8.3,&#39;,&#39;,F8.3,&#39;,&#39;,F8.3,&#39;)&#39;)&quot;</span>
<a name="ln-9825"></a>
<a name="ln-9826"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9827"></a>          <span class="c">! na</span>
<a name="ln-9828"></a>
<a name="ln-9829"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9830"></a>          <span class="c">! na</span>
<a name="ln-9831"></a>
<a name="ln-9832"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9833"></a>  <span class="kt">INTEGER </span><span class="n">I</span>               <span class="c">! Loop Control</span>
<a name="ln-9834"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="nb">GAMMA</span>              <span class="c">! Intermediate Result</span>
<a name="ln-9835"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DotSelfX23</span>
<a name="ln-9836"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">132</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrLineOut</span><span class="o">=</span><span class="n">Blank</span> <span class="c">! Character string for producing error messages</span>
<a name="ln-9837"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x21</span>
<a name="ln-9838"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x23</span>
<a name="ln-9839"></a>
<a name="ln-9840"></a>          <span class="c">! Determine Components of the Coordinate Translation Vector.</span>
<a name="ln-9841"></a>
<a name="ln-9842"></a>  <span class="n">x21</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9843"></a>  <span class="n">x23</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-9844"></a>
<a name="ln-9845"></a>  <span class="n">DotSelfX23</span><span class="o">=</span><span class="p">(</span><span class="n">x23</span> <span class="p">.</span><span class="n">dot</span><span class="p">.</span> <span class="n">x23</span><span class="p">)</span>
<a name="ln-9846"></a>
<a name="ln-9847"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DotSelfX23</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">.</span><span class="mi">1</span><span class="n">d</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9848"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CalcCoordinateTransformation: Invalid dot product, surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9849"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-9850"></a>    <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-9851"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrLineOut</span><span class="p">,</span><span class="n">ErrFmt</span><span class="p">)</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-9852"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">ErrLineOut</span><span class="p">)</span>
<a name="ln-9853"></a>    <span class="n">ENDDO</span>
<a name="ln-9854"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CalcCoordinateTransformation: Program terminates due to preceding condition.&#39;</span><span class="p">,</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-9855"></a>    <span class="k">RETURN</span>
<a name="ln-9856"></a><span class="k">  END IF</span>
<a name="ln-9857"></a>
<a name="ln-9858"></a><span class="k">  </span><span class="nb">Gamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">x21</span> <span class="p">.</span><span class="n">dot</span><span class="p">.</span> <span class="n">x23</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x23</span> <span class="p">.</span><span class="n">dot</span><span class="p">.</span> <span class="n">x23</span><span class="p">)</span>
<a name="ln-9859"></a>
<a name="ln-9860"></a>  <span class="n">CompCoordTranslVector</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-9861"></a>
<a name="ln-9862"></a>  <span class="k">RETURN</span>
<a name="ln-9863"></a>
<a name="ln-9864"></a><span class="k">END SUBROUTINE </span><span class="n">CalcCoordinateTransformation</span>
<a name="ln-9865"></a>
<a name="ln-9866"></a><span class="k">SUBROUTINE </span><span class="n">CreateShadedWindowConstruction</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">WSCptr</span><span class="p">,</span><span class="n">ShDevNum</span><span class="p">)</span>
<a name="ln-9867"></a>
<a name="ln-9868"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9869"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-9870"></a>          <span class="c">!       DATE WRITTEN   Nov 2001</span>
<a name="ln-9871"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9872"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9873"></a>
<a name="ln-9874"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9875"></a>          <span class="c">! Creates a shaded window construction for windows whose WindowShadingControl</span>
<a name="ln-9876"></a>          <span class="c">! has a shading device specified instead of a shaded construction</span>
<a name="ln-9877"></a>
<a name="ln-9878"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-9879"></a>
<a name="ln-9880"></a>          <span class="c">! REFERENCES:na</span>
<a name="ln-9881"></a>
<a name="ln-9882"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9883"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-9884"></a>
<a name="ln-9885"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9886"></a>
<a name="ln-9887"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9888"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface number</span>
<a name="ln-9889"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">WSCptr</span>            <span class="c">! Pointer to WindowShadingControl for SurfNum</span>
<a name="ln-9890"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ShDevNum</span>          <span class="c">! Shading device material number for WSCptr</span>
<a name="ln-9891"></a>
<a name="ln-9892"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-9893"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS;na</span>
<a name="ln-9894"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-9895"></a>
<a name="ln-9896"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9897"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>                       <span class="c">! Number of unshaded construction</span>
<a name="ln-9898"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNewSh</span>                     <span class="c">! Number of shaded construction that is created</span>
<a name="ln-9899"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ShDevName</span>  <span class="c">! Shading device material name</span>
<a name="ln-9900"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstrName</span> <span class="c">! Unshaded construction name</span>
<a name="ln-9901"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstrNameSh</span> <span class="c">! Shaded construction name</span>
<a name="ln-9902"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLayersOld</span>                    <span class="c">! Total layers in old (unshaded) construction</span>
<a name="ln-9903"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLayersNew</span>                    <span class="c">! Total layers in new (shaded) construction</span>
<a name="ln-9904"></a><span class="c">!  INTEGER :: loop                            ! DO loop index</span>
<a name="ln-9905"></a>
<a name="ln-9906"></a><span class="n">ShDevName</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">ShDevNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-9907"></a><span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-9908"></a><span class="n">ConstrName</span><span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-9909"></a><span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9910"></a>   <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9911"></a><span class="k">  </span><span class="n">ConstrNameSh</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstrName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ShDevName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="s1">&#39;INT&#39;</span>
<a name="ln-9912"></a><span class="k">ELSE</span>
<a name="ln-9913"></a><span class="k">  </span><span class="n">ConstrNameSh</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstrName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ShDevName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="s1">&#39;EXT&#39;</span>
<a name="ln-9914"></a><span class="k">END IF</span>
<a name="ln-9915"></a>
<a name="ln-9916"></a><span class="c">! If this construction name already exists, set the surface&#39;s shaded construction number to it</span>
<a name="ln-9917"></a>
<a name="ln-9918"></a><span class="n">ConstrNewSh</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">ConstrNameSh</span><span class="p">,</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-9919"></a>
<a name="ln-9920"></a><span class="k">IF</span><span class="p">(</span><span class="n">ConstrNewSh</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9921"></a><span class="k">  </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">=</span> <span class="n">ConstrNewSh</span>
<a name="ln-9922"></a><span class="k">ELSE</span>
<a name="ln-9923"></a>
<a name="ln-9924"></a>  <span class="c">! Create new construction</span>
<a name="ln-9925"></a>
<a name="ln-9926"></a>  <span class="n">ConstrNewSh</span> <span class="o">=</span> <span class="n">TotConstructs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-9927"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">=</span> <span class="n">ConstrNewSh</span>
<a name="ln-9928"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ConstructSave</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-9929"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalRSave</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-9930"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalUSave</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-9931"></a>  <span class="n">ConstructSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-9932"></a>  <span class="n">NominalRSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalRforNominalUCalculation</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-9933"></a>  <span class="n">NominalUSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-9934"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Construct</span><span class="p">)</span>
<a name="ln-9935"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalRforNominalUCalculation</span><span class="p">)</span>
<a name="ln-9936"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalU</span><span class="p">)</span>
<a name="ln-9937"></a>  <span class="n">TotConstructs</span> <span class="o">=</span> <span class="n">ConstrNewSh</span>
<a name="ln-9938"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-9939"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalRforNominalUCalculation</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-9940"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalU</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-9941"></a>  <span class="n">NominalRforNominalUCalculation</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9942"></a>  <span class="n">NominalU</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9943"></a>  <span class="n">Construct</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ConstructSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9944"></a>  <span class="n">NominalRforNominalUCalculation</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalRSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9945"></a>  <span class="n">NominalU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalUSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9946"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ConstructSave</span><span class="p">)</span>
<a name="ln-9947"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalRSave</span><span class="p">)</span>
<a name="ln-9948"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalUSave</span><span class="p">)</span>
<a name="ln-9949"></a>
<a name="ln-9950"></a>  <span class="n">TotLayersOld</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-9951"></a>  <span class="n">TotLayersNew</span> <span class="o">=</span> <span class="n">TotLayersOld</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-9952"></a>
<a name="ln-9953"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9954"></a>
<a name="ln-9955"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9956"></a>     <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WSCptr</span><span class="p">)%</span><span class="n">ShadingType</span><span class="o">==</span><span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9957"></a>    <span class="c">! Interior shading device</span>
<a name="ln-9958"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotLayersOld</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotLayersOld</span><span class="p">)</span>
<a name="ln-9959"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLayersNew</span><span class="p">)</span>   <span class="o">=</span> <span class="n">ShDevNum</span>
<a name="ln-9960"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>    <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">ShDevNum</span><span class="p">)%</span><span class="n">AbsorpSolar</span>
<a name="ln-9961"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">OutsideAbsorpSolar</span>   <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">AbsorpSolar</span>
<a name="ln-9962"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">OutsideAbsorpThermal</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">AbsorpThermalFront</span>
<a name="ln-9963"></a>  <span class="k">ELSE</span>
<a name="ln-9964"></a>    <span class="c">! Exterior shading device</span>
<a name="ln-9965"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShDevNum</span>
<a name="ln-9966"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">TotLayersNew</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotLayersOld</span><span class="p">)</span>
<a name="ln-9967"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9968"></a>      <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLayersNew</span><span class="p">))%</span><span class="n">AbsorpSolar</span>
<a name="ln-9969"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">OutsideAbsorpSolar</span>   <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">ShDevNum</span><span class="p">)%</span><span class="n">AbsorpSolar</span>
<a name="ln-9970"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">OutsideAbsorpThermal</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">ShDevNum</span><span class="p">)%</span><span class="n">AbsorpThermalFront</span>
<a name="ln-9971"></a>  <span class="k">END IF</span>
<a name="ln-9972"></a>  <span class="c">! The following InsideAbsorpThermal applies only to inside glass; it is corrected</span>
<a name="ln-9973"></a>  <span class="c">!  later in InitGlassOpticalCalculations if construction has inside shade or blind.</span>
<a name="ln-9974"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">InsideAbsorpThermal</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9975"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLayersOld</span><span class="p">))%</span><span class="n">AbsorpThermalBack</span>
<a name="ln-9976"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">OutSideRoughness</span>     <span class="o">=</span> <span class="n">VerySmooth</span>
<a name="ln-9977"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">DayltPropPtr</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9978"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFCross</span>            <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9979"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFFlux</span>             <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9980"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFInside</span>           <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9981"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFOutside</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9982"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFSourceIn</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9983"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFSourceOut</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9984"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFTimeStep</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9985"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFTSourceOut</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9986"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFTSourceIn</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9987"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFTSourceQ</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9988"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFTUserOut</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9989"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFTUserIn</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9990"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">CTFTUserSource</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9991"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">NumHistories</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9992"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">NumCTFTerms</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9993"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">UValue</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9994"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">SourceSinkPresent</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9995"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">SolutionDimensions</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9996"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">SourceAfterLayer</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9997"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TempAfterLayer</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9998"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ThicknessPerpend</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9999"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">AbsDiff</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10000"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">AbsDiffBack</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10001"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">AbsDiffShade</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10002"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">AbsDiffBackShade</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10003"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ShadeAbsorpThermal</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10004"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">AbsBeamCoef</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10005"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10006"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">AbsBeamShadeCoef</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10007"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TransDiff</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10008"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TransDiffVis</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10009"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10010"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10011"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10012"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10013"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10014"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10015"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10016"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">ReflSolBeamBackCoef</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10017"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">W5FrameDivider</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10018"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">FromWindow5DataFile</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10019"></a>
<a name="ln-10020"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">ConstrNameSh</span>
<a name="ln-10021"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TotLayers</span> <span class="o">=</span> <span class="n">TotLayersNew</span>
<a name="ln-10022"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TotSolidLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotSolidLayers</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10023"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-10024"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">TypeIsWindow</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10025"></a>  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNewSh</span><span class="p">)%</span><span class="n">IsUsed</span>       <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10026"></a>
<a name="ln-10027"></a><span class="k">END IF</span>
<a name="ln-10028"></a>
<a name="ln-10029"></a><span class="k">RETURN</span>
<a name="ln-10030"></a><span class="k">END SUBROUTINE </span><span class="n">CreateShadedWindowConstruction</span>
<a name="ln-10031"></a>
<a name="ln-10032"></a><span class="k">SUBROUTINE </span><span class="n">CreateStormWindowConstructions</span>
<a name="ln-10033"></a>
<a name="ln-10034"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10035"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-10036"></a>          <span class="c">!       DATE WRITTEN   Jan 2004</span>
<a name="ln-10037"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10038"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10039"></a>
<a name="ln-10040"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10041"></a>          <span class="c">! For windows with an associated StormWindow object, creates a construction</span>
<a name="ln-10042"></a>          <span class="c">! consisting of the base construction plus a storm window and air gap on the outside.</span>
<a name="ln-10043"></a>          <span class="c">! If the window has an interior or between-glass shade/blind, also creates a</span>
<a name="ln-10044"></a>          <span class="c">! construction consisting of the storm window added to the shaded construction.</span>
<a name="ln-10045"></a>
<a name="ln-10046"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-10047"></a>          <span class="c">! REFERENCES:na</span>
<a name="ln-10048"></a>
<a name="ln-10049"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10050"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-10051"></a>
<a name="ln-10052"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10053"></a>
<a name="ln-10054"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10055"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-10056"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS;na</span>
<a name="ln-10057"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-10058"></a>
<a name="ln-10059"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10060"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>               <span class="c">! Surface number</span>
<a name="ln-10061"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StormWinNum</span>           <span class="c">! Number of StormWindow object</span>
<a name="ln-10062"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>             <span class="c">! Number of unshaded construction</span>
<a name="ln-10063"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNumSh</span>           <span class="c">! Number of shaded construction</span>
<a name="ln-10064"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrOld</span>             <span class="c">! Number of old construction (unshaded or shaded)</span>
<a name="ln-10065"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNewSt</span>           <span class="c">! Number of unshaded storm window construction that is created</span>
<a name="ln-10066"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNewStSh</span>         <span class="c">! Number of shaded storm window construction that is created</span>
<a name="ln-10067"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNew</span>             <span class="c">! Number of new construction with storm window (unshaded or shaded)</span>
<a name="ln-10068"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatNewStAir</span>           <span class="c">! Number of created air layer material</span>
<a name="ln-10069"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstrName</span>   <span class="c">! Name of original unshaded window construction</span>
<a name="ln-10070"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstrNameSh</span> <span class="c">! Name of original shaded window construction</span>
<a name="ln-10071"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstrNameSt</span> <span class="c">! Name of unshaded construction with storm window</span>
<a name="ln-10072"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstrNameStsh</span> <span class="c">! Name of shaded construction with storm window</span>
<a name="ln-10073"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MatNameStAir</span> <span class="c">! Name of created air layer material</span>
<a name="ln-10074"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StormWinMatNum</span>        <span class="c">! Material number of storm window glass layer</span>
<a name="ln-10075"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IntDistance</span>           <span class="c">! Thickness of air gap between storm window and rest of window (mm)</span>
<a name="ln-10076"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChrIntDistance</span> <span class="c">! Character representation of IntDistance</span>
<a name="ln-10077"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">29</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChrNum</span>      <span class="c">! Character representation of storm window number</span>
<a name="ln-10078"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLayers</span>             <span class="c">! Total layers in a construction</span>
<a name="ln-10079"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotGlassLayers</span>        <span class="c">! Total glass layers in a construction</span>
<a name="ln-10080"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLayersOld</span>          <span class="c">! Total layers in old (without storm window) construction</span>
<a name="ln-10081"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatIntSh</span>              <span class="c">! Material number of interior shade or blind</span>
<a name="ln-10082"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatBGsh</span>               <span class="c">! Material number of between-glass shade or blind</span>
<a name="ln-10083"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">loop</span>                  <span class="c">! DO loop index</span>
<a name="ln-10084"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ShAndSt</span>               <span class="c">! True if unshaded and shaded window can have a storm window</span>
<a name="ln-10085"></a><span class="c">!  INTEGER :: LenName               ! Name length</span>
<a name="ln-10086"></a>
<a name="ln-10087"></a><span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Creating Storm Window Constructions&#39;</span><span class="p">)</span>
<a name="ln-10088"></a>
<a name="ln-10089"></a><span class="k">DO </span><span class="n">StormWinNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotStormWin</span>
<a name="ln-10090"></a>  <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">BaseWindowNum</span>
<a name="ln-10091"></a>  <span class="n">ConstrNum</span>    <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10092"></a>  <span class="c">! Fatal error if base construction has more than three glass layers</span>
<a name="ln-10093"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10094"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Window=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10095"></a>         <span class="o">//</span><span class="s1">&#39; has more than 3 glass layers; a storm window cannot be applied.&#39;</span><span class="p">)</span>
<a name="ln-10096"></a>  <span class="k">END IF</span>
<a name="ln-10097"></a><span class="k">  </span><span class="n">ConstrNumSh</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-10098"></a>  <span class="n">ConstrName</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-10099"></a>  <span class="n">StormWinMatNum</span> <span class="o">=</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">StormWinMaterialNum</span>
<a name="ln-10100"></a>  <span class="n">IntDistance</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">StormWinDistance</span><span class="p">)</span>
<a name="ln-10101"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">ChrIntDistance</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">IntDistance</span>
<a name="ln-10102"></a>  <span class="n">ChrIntDistance</span> <span class="o">=</span> <span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ChrIntDistance</span><span class="p">)</span>
<a name="ln-10103"></a>  <span class="c">! Set ShAndSt, which is true if the window has a shaded construction to which a storm window</span>
<a name="ln-10104"></a>  <span class="c">! can be added. (A storm window can be added if there is an interior shade or blind and up to three</span>
<a name="ln-10105"></a>  <span class="c">! glass layers, or there is a between-glass shade or blind and two glass layers.)</span>
<a name="ln-10106"></a>  <span class="n">ShAndSt</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10107"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ConstrNumSh</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10108"></a><span class="k">    </span><span class="n">ConstrNameSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-10109"></a>    <span class="n">TotLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-10110"></a>    <span class="n">TotGlassLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-10111"></a>    <span class="n">MatIntSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLayers</span><span class="p">)</span>
<a name="ln-10112"></a>    <span class="n">MatBGsh</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10113"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">TotLayers</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="n">MatBGsh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-10114"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">TotGlassLayers</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatIntSh</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">Shade</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10115"></a>              <span class="n">Material</span><span class="p">(</span><span class="n">MatIntSh</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">WindowBlind</span><span class="p">))</span> <span class="n">ShAndSt</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10116"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MatBGsh</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10117"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatBGsh</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">Shade</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatBGsh</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="n">WindowBlind</span><span class="p">)</span> <span class="n">ShAndSt</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10118"></a>    <span class="k">END IF</span>
<a name="ln-10119"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">ShAndSt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10120"></a><span class="k">      CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Window=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10121"></a>         <span class="o">//</span><span class="s1">&#39; has a shaded construction to which a storm window cannot be applied.&#39;</span><span class="p">)</span>
<a name="ln-10122"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Storm windows can only be applied to shaded constructions that:&#39;</span><span class="p">)</span>
<a name="ln-10123"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;have an interior shade or blind and up to three glass layers, or&#39;</span><span class="p">)</span>
<a name="ln-10124"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;have a between-glass shade or blind and two glass layers.&#39;</span><span class="p">)</span>
<a name="ln-10125"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;EnergyPlus is exiting due to reason stated above.&#39;</span><span class="p">)</span>
<a name="ln-10126"></a>    <span class="k">END IF</span>
<a name="ln-10127"></a><span class="k">  END IF</span>
<a name="ln-10128"></a>
<a name="ln-10129"></a>  <span class="c">! Loop over unshaded (loop=1) and shaded (loop=2) constructions and create new constructions</span>
<a name="ln-10130"></a>  <span class="c">! with storm window and air gap added on outside</span>
<a name="ln-10131"></a>  <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-10132"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">loop</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10133"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">ChrNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">StormWinNum</span>
<a name="ln-10134"></a>      <span class="n">ChrNum</span> <span class="o">=</span> <span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ChrNum</span><span class="p">)</span>
<a name="ln-10135"></a>      <span class="n">ConstrNameSt</span> <span class="o">=</span> <span class="s1">&#39;BARECONSTRUCTIONWITHSTORMWIN:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ChrNum</span><span class="p">)</span>
<a name="ln-10136"></a>      <span class="c">! If this construction name already exists, set the surface&#39;s storm window construction number to it</span>
<a name="ln-10137"></a>      <span class="n">ConstrNewSt</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">ConstrNameSt</span><span class="p">,</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-10138"></a>      <span class="n">ConstrNewStSh</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10139"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ConstrNewSt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span> <span class="o">=</span> <span class="n">ConstrNewSt</span>
<a name="ln-10140"></a>    <span class="k">ELSE</span>
<a name="ln-10141"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">ShAndSt</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-10142"></a><span class="k">      </span><span class="n">ConstrNameStSh</span> <span class="o">=</span> <span class="s1">&#39;SHADEDCONSTRUCTIONWITHSTORMWIN:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ChrNum</span><span class="p">)</span>
<a name="ln-10143"></a>      <span class="n">ConstrNewStSh</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">ConstrNameStSh</span><span class="p">,</span><span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-10144"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ConstrNewStSh</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span> <span class="o">=</span> <span class="n">ConstrNewStSh</span>
<a name="ln-10145"></a>    <span class="k">END IF</span>
<a name="ln-10146"></a>
<a name="ln-10147"></a><span class="k">    IF</span><span class="p">(</span><span class="n">loop</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ConstrNewSt</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10148"></a>      <span class="c">! If necessary, create new material corresponding to the air layer between the storm winddow</span>
<a name="ln-10149"></a>      <span class="c">! and the rest of the window</span>
<a name="ln-10150"></a>      <span class="n">MatNameStAir</span> <span class="o">=</span> <span class="s1">&#39;AIR:STORMWIN:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ChrIntDistance</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;MM&#39;</span>
<a name="ln-10151"></a>      <span class="n">MatNewStAir</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">MatNameStAir</span><span class="p">,</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-10152"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">MatNewStAir</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10153"></a>        <span class="c">! Create new material</span>
<a name="ln-10154"></a>        <span class="n">MatNewStAir</span> <span class="o">=</span> <span class="n">TotMaterials</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10155"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MaterialSave</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">))</span>
<a name="ln-10156"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalRSave</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">))</span>
<a name="ln-10157"></a>        <span class="n">MaterialSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="p">)</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-10158"></a>        <span class="n">NominalRSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-10159"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Material</span><span class="p">)</span>
<a name="ln-10160"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalR</span><span class="p">)</span>
<a name="ln-10161"></a>        <span class="n">TotMaterials</span> <span class="o">=</span> <span class="n">MatNewStAir</span>
<a name="ln-10162"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">))</span>
<a name="ln-10163"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalR</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">))</span>
<a name="ln-10164"></a>        <span class="n">Material</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MaterialSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10165"></a>        <span class="n">NominalR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalRSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotMaterials</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10166"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">MaterialSave</span><span class="p">)</span>
<a name="ln-10167"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalRSave</span><span class="p">)</span>
<a name="ln-10168"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">MatNameStAir</span>
<a name="ln-10169"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Group</span> <span class="o">=</span> <span class="n">WindowGas</span>
<a name="ln-10170"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Roughness</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-10171"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Conductivity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10172"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Density</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10173"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">IsoMoistCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10174"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Porosity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10175"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10176"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">SpecHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10177"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ThermGradCoef</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10178"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">=</span> <span class="n">StormWindow</span><span class="p">(</span><span class="n">StormWinNum</span><span class="p">)%</span><span class="n">StormWinDistance</span>
<a name="ln-10179"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">VaporDiffus</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10180"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasType</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10181"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasCon</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10182"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasVis</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10183"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasCp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10184"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasWght</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10185"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasFract</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10186"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-10187"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GlassSpectralDataPtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10188"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">NumberOfGasesInMixture</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-10189"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasCon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.873d-3</span>
<a name="ln-10190"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasCon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">7.760d-5</span>
<a name="ln-10191"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasVis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.723d-6</span>
<a name="ln-10192"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasVis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">4.940d-8</span>
<a name="ln-10193"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasCp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="mi">100</span><span class="mf">2.737d0</span>
<a name="ln-10194"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasCp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.2324d-2</span>
<a name="ln-10195"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasWght</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">8.97d0</span>
<a name="ln-10196"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GasFract</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10197"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">AbsorpSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10198"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">AbsorpThermal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10199"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">AbsorpVisible</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10200"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">Trans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10201"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">TransVis</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10202"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">GlassTransDirtFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10203"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectShade</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10204"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectShadeVis</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10205"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">AbsorpThermalBack</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10206"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">AbsorpThermalFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10207"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectSolBeamBack</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10208"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectSolBeamFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10209"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10210"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10211"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectVisBeamBack</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10212"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectVisBeamFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10213"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10214"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10215"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">TransSolBeam</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10216"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">TransThermal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10217"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">TransVisBeam</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10218"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">BlindDataPtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10219"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">WinShadeToGlassDist</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10220"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">WinShadeTopOpeningMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10221"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">WinShadeBottomOpeningMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10222"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">WinShadeLeftOpeningMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10223"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">WinShadeRightOpeningMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10224"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">WinShadeAirFlowPermeability</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10225"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">EMPDVALUE</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10226"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">MoistACoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10227"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">MoistBCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10228"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">MoistCCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10229"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">MoistDCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10230"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">EMPDaCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10231"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">EMPDbCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10232"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">EMPDcCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10233"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">)%</span><span class="n">EMPDdCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10234"></a>      <span class="k">END IF</span>  <span class="c">! End of check if new air layer material has to be created</span>
<a name="ln-10235"></a>    <span class="k">END IF</span>
<a name="ln-10236"></a>
<a name="ln-10237"></a><span class="k">    IF</span><span class="p">((</span><span class="n">loop</span><span class="o">==</span><span class="mf">1.</span><span class="nb">AND</span><span class="p">.</span><span class="n">ConstrNewSt</span><span class="o">==</span><span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">loop</span><span class="o">==</span><span class="mf">2.</span><span class="nb">AND</span><span class="p">.</span><span class="n">ConstrNewStSh</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10238"></a>      <span class="c">! Create new constructions</span>
<a name="ln-10239"></a>      <span class="n">ConstrNew</span> <span class="o">=</span> <span class="n">TotConstructs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10240"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">loop</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10241"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span> <span class="o">=</span> <span class="n">ConstrNew</span>
<a name="ln-10242"></a>      <span class="k">ELSE</span>
<a name="ln-10243"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span> <span class="o">=</span> <span class="n">ConstrNew</span>
<a name="ln-10244"></a>      <span class="k">END IF</span>
<a name="ln-10245"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">ConstructSave</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-10246"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalRSave</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-10247"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalUSave</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-10248"></a>      <span class="n">ConstructSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-10249"></a>      <span class="n">NominalRSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalRforNominalUCalculation</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-10250"></a>      <span class="n">NominalUSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-10251"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Construct</span><span class="p">)</span>
<a name="ln-10252"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalRforNominalUCalculation</span><span class="p">)</span>
<a name="ln-10253"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalU</span><span class="p">)</span>
<a name="ln-10254"></a>      <span class="n">TotConstructs</span> <span class="o">=</span> <span class="n">ConstrNew</span>
<a name="ln-10255"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-10256"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalRforNominalUCalculation</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-10257"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NominalU</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-10258"></a>      <span class="n">Construct</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ConstructSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10259"></a>      <span class="n">NominalRforNominalUCalculation</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalRSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10260"></a>      <span class="n">NominalU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NominalUSave</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotConstructs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10261"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ConstructSave</span><span class="p">)</span>
<a name="ln-10262"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalRSave</span><span class="p">)</span>
<a name="ln-10263"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NominalUSave</span><span class="p">)</span>
<a name="ln-10264"></a>
<a name="ln-10265"></a>      <span class="n">ConstrOld</span> <span class="o">=</span> <span class="n">ConstrNum</span>
<a name="ln-10266"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">loop</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="n">ConstrOld</span> <span class="o">=</span> <span class="n">ConstrNumSh</span>
<a name="ln-10267"></a>      <span class="n">TotLayersOld</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrOld</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-10268"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10269"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">StormWinMatNum</span>
<a name="ln-10270"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">MatNewStAir</span>
<a name="ln-10271"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="n">TotLayersOld</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrOld</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotLayersOld</span><span class="p">)</span>
<a name="ln-10272"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">ConstrNameSt</span>
<a name="ln-10273"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">loop</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">ConstrNameStSh</span>
<a name="ln-10274"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TotLayers</span> <span class="o">=</span> <span class="n">TotLayersOld</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-10275"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TotSolidLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrOld</span><span class="p">)%</span><span class="n">TotSolidLayers</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10276"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrOld</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10277"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TypeIsWindow</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10278"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">InsideAbsorpVis</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10279"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">OutsideAbsorpVis</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10280"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10281"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">OutsideAbsorpSolar</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10282"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">InsideAbsorpThermal</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrOld</span><span class="p">)%</span><span class="n">InsideAbsorpThermal</span>
<a name="ln-10283"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">OutsideAbsorpThermal</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">StormWinMatNum</span><span class="p">)%</span><span class="n">AbsorpThermalFront</span>
<a name="ln-10284"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">OutSideRoughness</span>     <span class="o">=</span> <span class="n">VerySmooth</span>
<a name="ln-10285"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">DayltPropPtr</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10286"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFCross</span>            <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10287"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFFlux</span>             <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10288"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFInside</span>           <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10289"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFOutside</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10290"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFSourceIn</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10291"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFSourceOut</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10292"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFTimeStep</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10293"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFTSourceOut</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10294"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFTSourceIn</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10295"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFTSourceQ</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10296"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFTUserOut</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10297"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFTUserIn</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10298"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">CTFTUserSource</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10299"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">NumHistories</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10300"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">NumCTFTerms</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10301"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">UValue</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10302"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">SourceSinkPresent</span>   <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10303"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">SolutionDimensions</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10304"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">SourceAfterLayer</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10305"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TempAfterLayer</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10306"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ThicknessPerpend</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10307"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsDiffIn</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10308"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsDiffOut</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10309"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsDiff</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10310"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsDiffBack</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10311"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsDiffShade</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10312"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsDiffBackShade</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10313"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ShadeAbsorpThermal</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10314"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsBeamCoef</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10315"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10316"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">AbsBeamShadeCoef</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10317"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TransDiff</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10318"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TransDiffVis</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10319"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10320"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10321"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10322"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10323"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10324"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10325"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10326"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">ReflSolBeamBackCoef</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10327"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">W5FrameDivider</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10328"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">FromWindow5DataFile</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10329"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">W5FileMullionWidth</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10330"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">W5FileMullionOrientation</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10331"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">W5FileGlazingSysWidth</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10332"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNew</span><span class="p">)%</span><span class="n">W5FileGlazingSysHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10333"></a>    <span class="k">END IF</span>  <span class="c">! End of check if new window constructions have to be created</span>
<a name="ln-10334"></a>  <span class="k">END DO</span>  <span class="c">! End of loop over unshaded and shaded window constructions</span>
<a name="ln-10335"></a><span class="k">END DO</span>  <span class="c">! End of loop over storm window objects</span>
<a name="ln-10336"></a>
<a name="ln-10337"></a><span class="k">RETURN</span>
<a name="ln-10338"></a><span class="k">END SUBROUTINE </span><span class="n">CreateStormWindowConstructions</span>
<a name="ln-10339"></a>
<a name="ln-10340"></a><span class="k">SUBROUTINE </span><span class="n">ModifyWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-10341"></a>
<a name="ln-10342"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10343"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-10344"></a>          <span class="c">!       DATE WRITTEN   Feb 2002</span>
<a name="ln-10345"></a>          <span class="c">!       MODIFIED       June 2004, FCW: SinAzim, CosAzim, SinTilt, CosTilt, OutNormVec, GrossArea</span>
<a name="ln-10346"></a>          <span class="c">!                       and Perimeter weren&#39;t being set for created window for case when</span>
<a name="ln-10347"></a>          <span class="c">!                       window from Window5DataFile had two different glazing systems. Also,</span>
<a name="ln-10348"></a>          <span class="c">!                       GrossArea and Perimeter of original window were not being recalculated.</span>
<a name="ln-10349"></a>          <span class="c">!                      October 2007, LKL: Net area for shading calculations was not being</span>
<a name="ln-10350"></a>          <span class="c">!                       recalculated.</span>
<a name="ln-10351"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10352"></a>
<a name="ln-10353"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10354"></a>          <span class="c">! If a window from the Window5DataFile has one glazing system, modify the</span>
<a name="ln-10355"></a>          <span class="c">! vertex coordinates of the original window to correspond to the dimensions</span>
<a name="ln-10356"></a>          <span class="c">! of the glazing system on the Data File.</span>
<a name="ln-10357"></a>          <span class="c">! If a window from the Window5DataFile has two different glazing systems, split</span>
<a name="ln-10358"></a>          <span class="c">! the window into two separate windows with different properties and adjust the</span>
<a name="ln-10359"></a>          <span class="c">! vertices of these windows taking into account the dimensions of the glazing systems</span>
<a name="ln-10360"></a>          <span class="c">! on the Data File and the width and orientation of the mullion that separates</span>
<a name="ln-10361"></a>          <span class="c">! the glazing systems.</span>
<a name="ln-10362"></a>
<a name="ln-10363"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-10364"></a>          <span class="c">! REFERENCES:na</span>
<a name="ln-10365"></a>
<a name="ln-10366"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10367"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-10368"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-10369"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-10370"></a>
<a name="ln-10371"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10372"></a>
<a name="ln-10373"></a>
<a name="ln-10374"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10375"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">SurfNum</span>     <span class="c">! SurfNum has construction of glazing system from Window5 Data File;</span>
<a name="ln-10376"></a>                                           <span class="c">! If there is a second glazing systme on the Data File, SurfNum+1</span>
<a name="ln-10377"></a>                                           <span class="c">! has the construction of the second glazing system.</span>
<a name="ln-10378"></a>
<a name="ln-10379"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! Set to true if errors found</span>
<a name="ln-10380"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AddedSubSurfaces</span> <span class="c">! Subsurfaces added when window references a</span>
<a name="ln-10381"></a>                                                <span class="c">! 2-glazing system Window5 data file entry</span>
<a name="ln-10382"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10383"></a>          <span class="c">! na</span>
<a name="ln-10384"></a>
<a name="ln-10385"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10386"></a>          <span class="c">! na</span>
<a name="ln-10387"></a>
<a name="ln-10388"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10389"></a>  <span class="k">type </span><span class="n">rectangularwindow</span>
<a name="ln-10390"></a>    <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vertex</span>
<a name="ln-10391"></a>  <span class="k">end type </span><span class="n">rectangularwindow</span>
<a name="ln-10392"></a>
<a name="ln-10393"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10394"></a><span class="c">!unused1208  INTEGER :: TotSurfacesPrev                 ! Total number of surfaces before splitting window</span>
<a name="ln-10395"></a><span class="c">!unused1208  INTEGER :: loop                            ! DO loop index</span>
<a name="ln-10396"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">H</span><span class="p">,</span><span class="n">W</span>                             <span class="c">! Height and width of original window (m)</span>
<a name="ln-10397"></a><span class="c">!unused1208  REAL(r64)    :: MulWidth                        ! Mullion width (m)</span>
<a name="ln-10398"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">h1</span><span class="p">,</span><span class="n">w1</span>                           <span class="c">! height and width of first glazing system (m)</span>
<a name="ln-10399"></a><span class="c">!unused1208  REAL(r64)    :: h2,w2                           ! height and width of second glazing system (m)</span>
<a name="ln-10400"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="n">TVect</span>
<a name="ln-10401"></a><span class="c">!unused1208  type (rectangularwindow) :: NewCoord</span>
<a name="ln-10402"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">rectangularwindow</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OriginalCoord</span>
<a name="ln-10403"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IConst</span>                          <span class="c">! Construction number of first glazing system</span>
<a name="ln-10404"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IConst2</span>                         <span class="c">! Construction number of second glazing system</span>
<a name="ln-10405"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Const2Name</span> <span class="c">! Name of construction of second glazing system</span>
<a name="ln-10406"></a><span class="c">!unused1208  REAL(r64)    :: AreaNew                         ! Sum of areas of the two glazing systems (m2)</span>
<a name="ln-10407"></a>
<a name="ln-10408"></a><span class="n">IConst</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10409"></a>
<a name="ln-10410"></a><span class="c">! Height and width of original window</span>
<a name="ln-10411"></a><span class="n">TVect</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10412"></a><span class="n">W</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>  <span class="c">!SQRT((X(3)-X(2))**2 + (Y(3)-Y(2))**2 + (Z(3)-Z(2))**2)</span>
<a name="ln-10413"></a><span class="n">TVect</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10414"></a><span class="n">H</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>  <span class="c">!SQRT((X(1)-X(2))**2 + (Y(1)-Y(2))**2 + (Z(1)-Z(2))**2)</span>
<a name="ln-10415"></a>
<a name="ln-10416"></a><span class="c">! Save coordinates of original window in case Window 5 data overwrites.</span>
<a name="ln-10417"></a><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-10418"></a>
<a name="ln-10419"></a><span class="c">! Height and width of first glazing system</span>
<a name="ln-10420"></a><span class="n">h1</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">W5FileGlazingSysHeight</span>
<a name="ln-10421"></a><span class="n">w1</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">W5FileGlazingSysWidth</span>
<a name="ln-10422"></a>
<a name="ln-10423"></a><span class="n">Const2Name</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:2&#39;</span>
<a name="ln-10424"></a><span class="n">IConst2</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Const2Name</span><span class="p">,</span> <span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-10425"></a>
<a name="ln-10426"></a><span class="k">IF</span><span class="p">(</span><span class="n">IConst2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Only one glazing system on Window5 Data File for this window.</span>
<a name="ln-10427"></a>
<a name="ln-10428"></a>  <span class="c">! So... original dimensions and area of window are used (entered in IDF)</span>
<a name="ln-10429"></a>  <span class="c">! Warning if dimensions of original window differ from those on Data File by more than 10%</span>
<a name="ln-10430"></a>
<a name="ln-10431"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">H</span><span class="o">-</span><span class="n">h1</span><span class="p">)</span><span class="o">/</span><span class="n">H</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.10d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">W</span><span class="o">-</span><span class="n">w1</span><span class="p">)</span><span class="o">/</span><span class="n">W</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.10d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10432"></a>
<a name="ln-10433"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10434"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SurfaceGeometry: ModifyWindow: Window &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10435"></a>       <span class="s1">&#39; uses the Window5 Data File Construction &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10436"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The height &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;(m) or width &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10437"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">W</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (m) of this window differs by more than 10%&#39;</span><span class="p">)</span>
<a name="ln-10438"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;from the corresponding height &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10439"></a>       <span class="s1">&#39; (m) or width &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (m) on the Window5 Data file.&#39;</span><span class="p">)</span>
<a name="ln-10440"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This will affect the frame heat transfer calculation if the frame in the Data File entry&#39;</span><span class="p">)</span>
<a name="ln-10441"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;is not uniform, i.e., has sections with different geometry and/or thermal properties.&#39;</span><span class="p">)</span>
<a name="ln-10442"></a>    <span class="k">ELSE</span>
<a name="ln-10443"></a><span class="k">      </span><span class="n">Warning1Count</span><span class="o">=</span><span class="n">Warning1Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10444"></a>    <span class="n">ENDIF</span>
<a name="ln-10445"></a>
<a name="ln-10446"></a>  <span class="k">END IF</span>
<a name="ln-10447"></a>
<a name="ln-10448"></a>     <span class="c">! Calculate net area for base surface</span>
<a name="ln-10449"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-10450"></a>         <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-10451"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10452"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Subsurfaces have too much area for base surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10453"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10454"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Subsurface creating error=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10455"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10456"></a>  <span class="n">ENDIF</span>
<a name="ln-10457"></a>
<a name="ln-10458"></a>     <span class="c">! Net area of base surface with unity window multipliers (used in shadowing checks)</span>
<a name="ln-10459"></a>  <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-10460"></a>     <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">-</span>   <span class="p">&amp;</span>
<a name="ln-10461"></a>         <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-10462"></a>
<a name="ln-10463"></a><span class="k">ELSE</span> <span class="c">! Two glazing systems on Window5 data file for this window</span>
<a name="ln-10464"></a>
<a name="ln-10465"></a><span class="c">! if exterior window, okay.</span>
<a name="ln-10466"></a>
<a name="ln-10467"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10468"></a>    <span class="c">!There are two glazing systems (separated by a vertical or horizontal mullion) on the Window5 Data File.</span>
<a name="ln-10469"></a>    <span class="c">! Fill in geometry data for the second window (corresponding to the second glazing system on the data file.</span>
<a name="ln-10470"></a>    <span class="c">! The first glazing system is assumed to be at left for vertical mullion, at bottom for horizontal mullion.</span>
<a name="ln-10471"></a>    <span class="c">! The second glazing system is assumed to be at right for vertical mullion, at top for horizontal mullion.</span>
<a name="ln-10472"></a>    <span class="c">! The lower left-hand corner of the original window (its vertex #2) is assumed to coincide with</span>
<a name="ln-10473"></a>    <span class="c">! vertex #2 of the first glazing system.</span>
<a name="ln-10474"></a>
<a name="ln-10475"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10476"></a><span class="k">      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SurfaceGeometry: ModifyWindow: Window &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10477"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; has been replaced with the Window 5/6 two glazing system=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10478"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-10479"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Note that originally entered dimensions are overridden.&#39;</span><span class="p">)</span>
<a name="ln-10480"></a>    <span class="k">ELSE</span>
<a name="ln-10481"></a><span class="k">      </span><span class="n">Warning2Count</span><span class="o">=</span><span class="n">Warning2Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10482"></a>    <span class="n">ENDIF</span>
<a name="ln-10483"></a>
<a name="ln-10484"></a>      <span class="c">! Allocate another window</span>
<a name="ln-10485"></a>    <span class="k">CALL </span><span class="n">AddWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-10486"></a>
<a name="ln-10487"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Interior window, specified  ! not external environment</span>
<a name="ln-10488"></a>
<a name="ln-10489"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10490"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SurfaceGeometry: ModifyWindow: Interior Window &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10491"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; has been replaced with the Window 5/6 two glazing system=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10492"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-10493"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Please check to make sure interior window is correct. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10494"></a>         <span class="s1">&#39;Note that originally entered dimensions are overridden.&#39;</span><span class="p">)</span>
<a name="ln-10495"></a>    <span class="k">ELSE</span>
<a name="ln-10496"></a><span class="k">      </span><span class="n">Warning3Count</span><span class="o">=</span><span class="n">Warning3Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10497"></a>    <span class="n">ENDIF</span>
<a name="ln-10498"></a>
<a name="ln-10499"></a>    <span class="k">CALL </span><span class="n">AddWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-10500"></a>
<a name="ln-10501"></a>  <span class="k">ELSE</span>    <span class="c">! Interior window, specified not entered</span>
<a name="ln-10502"></a>
<a name="ln-10503"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SurfaceGeometry: ModifyWindow: Interior Window &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10504"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is a window in an adjacent zone.&#39;</span><span class="p">)</span>
<a name="ln-10505"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Attempted to add/reverse Window 5/6 multiple glazing system=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10506"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-10507"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cannot use these Window 5/6 constructs for these Interior Windows. Program will terminate.&#39;</span><span class="p">)</span>
<a name="ln-10508"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10509"></a>
<a name="ln-10510"></a>  <span class="n">ENDIF</span>
<a name="ln-10511"></a>
<a name="ln-10512"></a><span class="k">END IF</span> <span class="c">! End of check if one or two glazing systems are on the Window5 Data File</span>
<a name="ln-10513"></a>
<a name="ln-10514"></a><span class="k">END SUBROUTINE </span><span class="n">ModifyWindow</span>
<a name="ln-10515"></a>
<a name="ln-10516"></a><span class="k">SUBROUTINE </span><span class="n">AddWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">AddedSubSurfaces</span><span class="p">)</span>
<a name="ln-10517"></a>
<a name="ln-10518"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10519"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-10520"></a>          <span class="c">!       DATE WRITTEN   Nov 2008</span>
<a name="ln-10521"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10522"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10523"></a>
<a name="ln-10524"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10525"></a>          <span class="c">! This routine is called from ModifyWindow to add a window.  Allows it to be</span>
<a name="ln-10526"></a>          <span class="c">! called in more than one place in the calling routine so as to be able to have</span>
<a name="ln-10527"></a>          <span class="c">! specific warnings or errors issued.</span>
<a name="ln-10528"></a>
<a name="ln-10529"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10530"></a>          <span class="c">! na</span>
<a name="ln-10531"></a>
<a name="ln-10532"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10533"></a>          <span class="c">! na</span>
<a name="ln-10534"></a>
<a name="ln-10535"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10536"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-10537"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-10538"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-10539"></a>
<a name="ln-10540"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10541"></a>
<a name="ln-10542"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10543"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">SurfNum</span>     <span class="c">! SurfNum has construction of glazing system from Window5 Data File;</span>
<a name="ln-10544"></a>                                           <span class="c">! If there is a second glazing systme on the Data File, SurfNum+1</span>
<a name="ln-10545"></a>                                           <span class="c">! has the construction of the second glazing system.</span>
<a name="ln-10546"></a>
<a name="ln-10547"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! Set to true if errors found</span>
<a name="ln-10548"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AddedSubSurfaces</span> <span class="c">! Subsurfaces added when window references a</span>
<a name="ln-10549"></a>                                                <span class="c">! 2-glazing system Window5 data file entry</span>
<a name="ln-10550"></a>
<a name="ln-10551"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10552"></a>          <span class="c">! na</span>
<a name="ln-10553"></a>
<a name="ln-10554"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10555"></a>          <span class="c">! na</span>
<a name="ln-10556"></a>
<a name="ln-10557"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10558"></a>  <span class="k">type </span><span class="n">rectangularwindow</span>
<a name="ln-10559"></a>    <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vertex</span>
<a name="ln-10560"></a>  <span class="k">end type </span><span class="n">rectangularwindow</span>
<a name="ln-10561"></a>
<a name="ln-10562"></a>
<a name="ln-10563"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10564"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotSurfacesPrev</span>                 <span class="c">! Total number of surfaces before splitting window</span>
<a name="ln-10565"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">loop</span>                            <span class="c">! DO loop index</span>
<a name="ln-10566"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">H</span><span class="p">,</span><span class="n">W</span>                             <span class="c">! Height and width of original window (m)</span>
<a name="ln-10567"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MulWidth</span>                        <span class="c">! Mullion width (m)</span>
<a name="ln-10568"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">h1</span><span class="p">,</span><span class="n">w1</span>                           <span class="c">! height and width of first glazing system (m)</span>
<a name="ln-10569"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">h2</span><span class="p">,</span><span class="n">w2</span>                           <span class="c">! height and width of second glazing system (m)</span>
<a name="ln-10570"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xa</span><span class="p">,</span><span class="n">ya</span><span class="p">,</span><span class="n">za</span><span class="p">,</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">,</span><span class="n">zb</span>               <span class="c">! Vertex intermediate variables (m)</span>
<a name="ln-10571"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dx</span><span class="p">,</span><span class="n">dy</span>                           <span class="c">! Vertex displacements from original window (m)</span>
<a name="ln-10572"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="n">TVect</span>
<a name="ln-10573"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">rectangularwindow</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NewCoord</span>
<a name="ln-10574"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">rectangularwindow</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OriginalCoord</span>
<a name="ln-10575"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IConst</span>                          <span class="c">! Construction number of first glazing system</span>
<a name="ln-10576"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IConst2</span>                         <span class="c">! Construction number of second glazing system</span>
<a name="ln-10577"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Const2Name</span> <span class="c">! Name of construction of second glazing system</span>
<a name="ln-10578"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AreaNew</span>                         <span class="c">! Sum of areas of the two glazing systems (m2)</span>
<a name="ln-10579"></a>
<a name="ln-10580"></a>  <span class="n">IConst</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10581"></a>
<a name="ln-10582"></a>  <span class="c">! Height and width of original window</span>
<a name="ln-10583"></a>  <span class="n">TVect</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10584"></a>  <span class="n">W</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>  <span class="c">!SQRT((X(3)-X(2))**2 + (Y(3)-Y(2))**2 + (Z(3)-Z(2))**2)</span>
<a name="ln-10585"></a>  <span class="n">TVect</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10586"></a>  <span class="n">H</span> <span class="o">=</span> <span class="n">VecLength</span><span class="p">(</span><span class="n">TVect</span><span class="p">)</span>  <span class="c">!SQRT((X(1)-X(2))**2 + (Y(1)-Y(2))**2 + (Z(1)-Z(2))**2)</span>
<a name="ln-10587"></a>
<a name="ln-10588"></a>  <span class="c">! Save coordinates of original window in case Window 5 data overwrites.</span>
<a name="ln-10589"></a>  <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span><span class="o">=</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span>
<a name="ln-10590"></a>
<a name="ln-10591"></a>  <span class="c">! Height and width of first glazing system</span>
<a name="ln-10592"></a>  <span class="n">h1</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">W5FileGlazingSysHeight</span>
<a name="ln-10593"></a>  <span class="n">w1</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">W5FileGlazingSysWidth</span>
<a name="ln-10594"></a>
<a name="ln-10595"></a>  <span class="n">Const2Name</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:2&#39;</span>
<a name="ln-10596"></a>  <span class="n">IConst2</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Const2Name</span><span class="p">,</span> <span class="n">Construct</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotConstructs</span><span class="p">)</span>
<a name="ln-10597"></a>
<a name="ln-10598"></a>    <span class="n">AddedSubSurfaces</span> <span class="o">=</span> <span class="n">AddedSubSurfaces</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10599"></a>    <span class="n">TotSurfacesPrev</span> <span class="o">=</span> <span class="n">TotSurfaces</span>
<a name="ln-10600"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmpSave</span><span class="p">(</span><span class="n">TotSurfacesPrev</span><span class="p">))</span>
<a name="ln-10601"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfacesPrev</span>
<a name="ln-10602"></a>      <span class="n">SurfaceTmpSave</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10603"></a>    <span class="k">END DO</span>
<a name="ln-10604"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">)</span>
<a name="ln-10605"></a>    <span class="n">TotSurfaces</span> <span class="o">=</span> <span class="n">TotSurfaces</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10606"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-10607"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfacesPrev</span>
<a name="ln-10608"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmpSave</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10609"></a>    <span class="k">END DO</span>
<a name="ln-10610"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmpSave</span><span class="p">)</span>
<a name="ln-10611"></a>
<a name="ln-10612"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-10613"></a>
<a name="ln-10614"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:2&#39;</span>
<a name="ln-10615"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">=</span> <span class="n">IConst2</span>
<a name="ln-10616"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ConstructionStoredInputValue</span> <span class="o">=</span> <span class="n">IConst2</span>
<a name="ln-10617"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="k">Class</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-10618"></a><span class="k">    </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-10619"></a>    <span class="c">! Sine and cosine of azimuth and tilt</span>
<a name="ln-10620"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">SinAzim</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span>
<a name="ln-10621"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span>
<a name="ln-10622"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">SinTilt</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-10623"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span>
<a name="ln-10624"></a>    <span class="c">! Outward normal unit vector (pointing away from room)</span>
<a name="ln-10625"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Centroid</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Centroid</span>
<a name="ln-10626"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">lcsx</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsx</span>
<a name="ln-10627"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">lcsy</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsy</span>
<a name="ln-10628"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">lcsz</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">lcsz</span>
<a name="ln-10629"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">NewellAreaVector</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NewellAreaVector</span>
<a name="ln-10630"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">OutNormVec</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span>
<a name="ln-10631"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Reveal</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Reveal</span>
<a name="ln-10632"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="nb">Shape</span>
<a name="ln-10633"></a><span class="nb">    </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-10634"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-10635"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span>
<a name="ln-10636"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">BaseSurfName</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurfName</span>
<a name="ln-10637"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-10638"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ZoneName</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ZoneName</span>
<a name="ln-10639"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-10640"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ExtBoundCondName</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCondName</span>
<a name="ln-10641"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-10642"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ExtSolar</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span>
<a name="ln-10643"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ExtWind</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span>
<a name="ln-10644"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span>
<a name="ln-10645"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-10646"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span>
<a name="ln-10647"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span>
<a name="ln-10648"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span>
<a name="ln-10649"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span>
<a name="ln-10650"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ShadowSurfSchedVaries</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfSchedVaries</span>
<a name="ln-10651"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">MaterialMovInsulExt</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulExt</span>
<a name="ln-10652"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span>
<a name="ln-10653"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span>
<a name="ln-10654"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-10655"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">ShadedConstruction</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-10656"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span>
<a name="ln-10657"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-10658"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-10659"></a>
<a name="ln-10660"></a>    <span class="n">MulWidth</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">W5FileMullionWidth</span>
<a name="ln-10661"></a>    <span class="n">w2</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst2</span><span class="p">)%</span><span class="n">W5FileGlazingSysWidth</span>
<a name="ln-10662"></a>    <span class="n">h2</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst2</span><span class="p">)%</span><span class="n">W5FileGlazingSysHeight</span>
<a name="ln-10663"></a>
<a name="ln-10664"></a>    <span class="c">! Correction to net area of base surface. Add back in the original glazing area and subtract the</span>
<a name="ln-10665"></a>    <span class="c">! area of the two glazing systems. Note that for Surface(SurfNum)%Class = &#39;Window&#39; the effect</span>
<a name="ln-10666"></a>    <span class="c">! of a window multiplier is included in the glazing area. Note that frame areas are subtracted later.</span>
<a name="ln-10667"></a>
<a name="ln-10668"></a>    <span class="n">AreaNew</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="p">(</span><span class="n">h1</span><span class="o">*</span><span class="n">w1</span> <span class="o">+</span> <span class="n">h2</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>  <span class="c">! both glazing systems</span>
<a name="ln-10669"></a>       <span class="c">! Adjust net area for base surface</span>
<a name="ln-10670"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-10671"></a>           <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">-</span> <span class="n">AreaNew</span>
<a name="ln-10672"></a>
<a name="ln-10673"></a>       <span class="c">! Net area of base surface with unity window multipliers (used in shadowing checks)</span>
<a name="ln-10674"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-10675"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">-</span> <span class="n">AreaNew</span><span class="o">/</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span>
<a name="ln-10676"></a>
<a name="ln-10677"></a>       <span class="c">! Reset area, etc. of original window</span>
<a name="ln-10678"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="p">(</span><span class="n">h1</span><span class="o">*</span><span class="n">w1</span><span class="p">)</span>
<a name="ln-10679"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-10680"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">h1</span><span class="o">*</span><span class="n">w1</span>
<a name="ln-10681"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">h1</span><span class="o">+</span><span class="n">w1</span><span class="p">)</span>
<a name="ln-10682"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="n">h1</span>
<a name="ln-10683"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span>  <span class="o">=</span> <span class="n">w1</span>
<a name="ln-10684"></a>       <span class="c">! Set area, etc. of new window</span>
<a name="ln-10685"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="p">(</span><span class="n">h2</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>
<a name="ln-10686"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-10687"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span> <span class="o">=</span> <span class="n">h2</span><span class="o">*</span><span class="n">w2</span>
<a name="ln-10688"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">h2</span><span class="o">+</span><span class="n">w2</span><span class="p">)</span>
<a name="ln-10689"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="n">h2</span>
<a name="ln-10690"></a>    <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Width</span>  <span class="o">=</span> <span class="n">w2</span>
<a name="ln-10691"></a>
<a name="ln-10692"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10693"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SurfaceGeometry: ModifyWindow: Subsurfaces have too much area for base surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10694"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10695"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Subsurface (window) creating error=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10696"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This window has been replaced by two windows from the Window5 Data File of total area &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10697"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AreaNew</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m2&#39;</span><span class="p">)</span>
<a name="ln-10698"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10699"></a>    <span class="n">ENDIF</span>
<a name="ln-10700"></a>
<a name="ln-10701"></a>    <span class="c">! Assign vertices to the new window; modify vertices of original window.</span>
<a name="ln-10702"></a>    <span class="c">! In the following, vertices are numbered counter-clockwise with vertex #1 at the upper left.</span>
<a name="ln-10703"></a>
<a name="ln-10704"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">W5FileMullionOrientation</span> <span class="o">==</span> <span class="n">Vertical</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10705"></a>
<a name="ln-10706"></a>      <span class="c">! VERTICAL MULLION: original window is modified to become left-hand glazing (system #1);</span>
<a name="ln-10707"></a>      <span class="c">! new window is created to become right-hand glazing (system #2)</span>
<a name="ln-10708"></a>
<a name="ln-10709"></a>      <span class="c">! Left-hand glazing</span>
<a name="ln-10710"></a>
<a name="ln-10711"></a>      <span class="c">! Vertex 1</span>
<a name="ln-10712"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10713"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="n">h1</span>
<a name="ln-10714"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10715"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10716"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10717"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10718"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10719"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10720"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10721"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10722"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10723"></a>
<a name="ln-10724"></a>      <span class="c">! Vertex 2</span>
<a name="ln-10725"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10726"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span>
<a name="ln-10727"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10728"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10729"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10730"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10731"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10732"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10733"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10734"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10735"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10736"></a>
<a name="ln-10737"></a>      <span class="c">! Vertex 3</span>
<a name="ln-10738"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span>
<a name="ln-10739"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span>
<a name="ln-10740"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10741"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10742"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10743"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10744"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10745"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10746"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10747"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10748"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10749"></a>
<a name="ln-10750"></a>      <span class="c">! Vertex 4</span>
<a name="ln-10751"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span>
<a name="ln-10752"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="n">h1</span>
<a name="ln-10753"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10754"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10755"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10756"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10757"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10758"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10759"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10760"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10761"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10762"></a>
<a name="ln-10763"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-10764"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10765"></a>      <span class="k">END DO</span>
<a name="ln-10766"></a>
<a name="ln-10767"></a>      <span class="c">! Right-hand glazing</span>
<a name="ln-10768"></a>
<a name="ln-10769"></a>      <span class="c">! Vertex 1</span>
<a name="ln-10770"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">MulWidth</span>
<a name="ln-10771"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="p">(</span><span class="n">h1</span><span class="o">+</span><span class="n">h2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10772"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10773"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10774"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10775"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10776"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10777"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10778"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10779"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10780"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10781"></a>
<a name="ln-10782"></a>      <span class="c">! Vertex 2</span>
<a name="ln-10783"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">MulWidth</span>
<a name="ln-10784"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">+</span> <span class="p">(</span><span class="n">h2</span><span class="o">-</span><span class="n">h1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10785"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10786"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10787"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10788"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10789"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10790"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10791"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10792"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10793"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10794"></a>
<a name="ln-10795"></a>      <span class="c">! Vertex 3</span>
<a name="ln-10796"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">MulWidth</span> <span class="o">+</span> <span class="n">w2</span>
<a name="ln-10797"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">+</span> <span class="p">(</span><span class="n">h2</span><span class="o">-</span><span class="n">h1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10798"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10799"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10800"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10801"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10802"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10803"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10804"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10805"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10806"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10807"></a>
<a name="ln-10808"></a>      <span class="c">! Vertex 4</span>
<a name="ln-10809"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">MulWidth</span> <span class="o">+</span> <span class="n">w2</span>
<a name="ln-10810"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="p">(</span><span class="n">h1</span><span class="o">+</span><span class="n">h2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10811"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10812"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10813"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10814"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10815"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10816"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10817"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10818"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10819"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10820"></a>
<a name="ln-10821"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-10822"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10823"></a>      <span class="k">END DO</span>
<a name="ln-10824"></a>
<a name="ln-10825"></a><span class="k">    ELSE</span> <span class="c">! Horizontal mullion</span>
<a name="ln-10826"></a>
<a name="ln-10827"></a>      <span class="c">! HORIZONTAL MULLION: original window is modified to become bottom glazing (system #1);</span>
<a name="ln-10828"></a>      <span class="c">! new window is created to become top glazing (system #2)</span>
<a name="ln-10829"></a>
<a name="ln-10830"></a>      <span class="c">! Bottom glazing</span>
<a name="ln-10831"></a>
<a name="ln-10832"></a>      <span class="c">! Vertex 1</span>
<a name="ln-10833"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10834"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="n">h1</span>
<a name="ln-10835"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10836"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10837"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10838"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10839"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10840"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10841"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10842"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10843"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10844"></a>
<a name="ln-10845"></a>      <span class="c">! Vertex 2</span>
<a name="ln-10846"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10847"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span>
<a name="ln-10848"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10849"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10850"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10851"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10852"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10853"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10854"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10855"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10856"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10857"></a>
<a name="ln-10858"></a>      <span class="c">! Vertex 3</span>
<a name="ln-10859"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span>
<a name="ln-10860"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span>
<a name="ln-10861"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10862"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10863"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10864"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10865"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10866"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10867"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10868"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10869"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10870"></a>
<a name="ln-10871"></a>      <span class="c">! Vertex 4</span>
<a name="ln-10872"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="n">w1</span>
<a name="ln-10873"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="n">h1</span>
<a name="ln-10874"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10875"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10876"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10877"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10878"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10879"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10880"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10881"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10882"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10883"></a>
<a name="ln-10884"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-10885"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10886"></a>      <span class="k">END DO</span>
<a name="ln-10887"></a>
<a name="ln-10888"></a>      <span class="c">! Top glazing</span>
<a name="ln-10889"></a>
<a name="ln-10890"></a>      <span class="c">! Vertex 1</span>
<a name="ln-10891"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w1</span> <span class="o">-</span> <span class="n">w2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10892"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="p">(</span><span class="n">h1</span><span class="o">+</span><span class="n">h2</span><span class="o">+</span><span class="n">MulWidth</span><span class="p">)</span>
<a name="ln-10893"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10894"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10895"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10896"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10897"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10898"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10899"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10900"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10901"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10902"></a>
<a name="ln-10903"></a>      <span class="c">! Vertex 2</span>
<a name="ln-10904"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w1</span> <span class="o">-</span> <span class="n">w2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10905"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="p">(</span><span class="n">h1</span><span class="o">+</span><span class="n">MulWidth</span><span class="p">)</span>
<a name="ln-10906"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10907"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10908"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10909"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10910"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10911"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10912"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10913"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10914"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10915"></a>
<a name="ln-10916"></a>      <span class="c">! Vertex 3</span>
<a name="ln-10917"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w1</span> <span class="o">+</span> <span class="n">w2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10918"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="p">(</span><span class="n">h1</span><span class="o">+</span><span class="n">MulWidth</span><span class="p">)</span>
<a name="ln-10919"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10920"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10921"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10922"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10923"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10924"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10925"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10926"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10927"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10928"></a>
<a name="ln-10929"></a>      <span class="c">! Vertex 4</span>
<a name="ln-10930"></a>      <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w1</span> <span class="o">+</span> <span class="n">w2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-10931"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="p">(</span><span class="n">h1</span><span class="o">+</span><span class="n">h2</span><span class="o">+</span><span class="n">MulWidth</span><span class="p">)</span>
<a name="ln-10932"></a>      <span class="n">xa</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10933"></a>      <span class="n">ya</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10934"></a>      <span class="n">za</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10935"></a>      <span class="n">xb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-10936"></a>      <span class="n">yb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-10937"></a>      <span class="n">zb</span> <span class="o">=</span> <span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span><span class="o">-</span><span class="n">OriginalCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-10938"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span><span class="o">-</span><span class="n">xa</span><span class="p">)</span>
<a name="ln-10939"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">ya</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span><span class="o">-</span><span class="n">ya</span><span class="p">)</span>
<a name="ln-10940"></a>      <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">W</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span>
<a name="ln-10941"></a>
<a name="ln-10942"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-10943"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">NewCoord</span><span class="p">%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10944"></a>      <span class="k">END DO</span>
<a name="ln-10945"></a>
<a name="ln-10946"></a><span class="k">    END IF</span>  <span class="c">! End of check if vertical or horizontal mullion</span>
<a name="ln-10947"></a>
<a name="ln-10948"></a>  <span class="k">RETURN</span>
<a name="ln-10949"></a>
<a name="ln-10950"></a><span class="k">END SUBROUTINE </span><span class="n">AddWindow</span>
<a name="ln-10951"></a>
<a name="ln-10952"></a><span class="k">SUBROUTINE </span><span class="n">TransformVertsByAspect</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">NSides</span><span class="p">)</span>
<a name="ln-10953"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10954"></a>          <span class="c">!       AUTHOR         Brent T Griffith</span>
<a name="ln-10955"></a>          <span class="c">!       DATE WRITTEN   April 2003</span>
<a name="ln-10956"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10957"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10958"></a>
<a name="ln-10959"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10960"></a>          <span class="c">! Alter input for surface geometry</span>
<a name="ln-10961"></a>          <span class="c">! Optimizing building design for energy can involve</span>
<a name="ln-10962"></a>          <span class="c">!  altering building geometry.  Rather than assemble routines to transform</span>
<a name="ln-10963"></a>          <span class="c">!  geometry through pre-processing on input, it may be simpler to change</span>
<a name="ln-10964"></a>          <span class="c">!  vertices within EnergyPlus since it already reads the data from the input</span>
<a name="ln-10965"></a>          <span class="c">!  file and there would no longer be a need to rewrite the text data.</span>
<a name="ln-10966"></a>          <span class="c">!  This is essentially a crude hack to allow adjusting geometry with</span>
<a name="ln-10967"></a>          <span class="c">!  a single parameter...</span>
<a name="ln-10968"></a>          <span class="c">!</span>
<a name="ln-10969"></a>
<a name="ln-10970"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10971"></a>          <span class="c">! once vertices have been converted to WCS, change them to reflect a different aspect</span>
<a name="ln-10972"></a>          <span class="c">! ratio for the entire building based on user input.</span>
<a name="ln-10973"></a>          <span class="c">! This routine is called once for each surface by subroutine GetVertices</span>
<a name="ln-10974"></a>
<a name="ln-10975"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10976"></a>          <span class="c">! na</span>
<a name="ln-10977"></a>
<a name="ln-10978"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10979"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-10980"></a>  <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-10981"></a>
<a name="ln-10982"></a> <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10983"></a>
<a name="ln-10984"></a>
<a name="ln-10985"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10986"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SurfNum</span>     <span class="c">! Current surface number</span>
<a name="ln-10987"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">NSides</span>      <span class="c">! Number of sides to figure</span>
<a name="ln-10988"></a>
<a name="ln-10989"></a>
<a name="ln-10990"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10991"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;GeometryTransform&#39;</span>
<a name="ln-10992"></a>
<a name="ln-10993"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10994"></a>          <span class="c">! na</span>
<a name="ln-10995"></a>
<a name="ln-10996"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10997"></a>          <span class="c">! na</span>
<a name="ln-10998"></a>
<a name="ln-10999"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11000"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cAlphas</span>
<a name="ln-11001"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rNumerics</span>
<a name="ln-11002"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NAlphas</span>
<a name="ln-11003"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NNum</span>
<a name="ln-11004"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">IOSTAT</span>
<a name="ln-11005"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">OldAspectRatio</span>
<a name="ln-11006"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">NewAspectRatio</span>
<a name="ln-11007"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">save</span>      <span class="kd">::</span> <span class="n">firstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11008"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">save</span>      <span class="kd">::</span> <span class="n">noTransform</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11009"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="k">save</span>   <span class="kd">::</span> <span class="n">transformPlane</span>
<a name="ln-11010"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">N</span>
<a name="ln-11011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">Xo</span><span class="p">,</span> <span class="n">XnoRot</span><span class="p">,</span> <span class="n">Xtrans</span>
<a name="ln-11012"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">YnoRot</span><span class="p">,</span> <span class="n">Ytrans</span>
<a name="ln-11013"></a>  <span class="c">!begin execution</span>
<a name="ln-11014"></a>  <span class="c">!get user input...</span>
<a name="ln-11015"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">firstTime</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11016"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11017"></a><span class="k">       CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphas</span><span class="p">,</span><span class="n">NAlphas</span><span class="p">,</span><span class="n">rNumerics</span><span class="p">,</span><span class="n">NNum</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11018"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11019"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-11020"></a>       <span class="n">OldAspectRatio</span> <span class="o">=</span> <span class="n">rNumerics</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-11021"></a>       <span class="n">NewAspectRatio</span> <span class="o">=</span> <span class="n">rNumerics</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-11022"></a>       <span class="n">transformPlane</span> <span class="o">=</span> <span class="n">cAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-11023"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">transformPlane</span> <span class="o">/=</span> <span class="s1">&#39;XY&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11024"></a><span class="k">         CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11025"></a>           <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;...ignored.&#39;</span><span class="p">)</span>
<a name="ln-11026"></a>       <span class="n">ENDIF</span>
<a name="ln-11027"></a>       <span class="n">firstTime</span>   <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11028"></a>       <span class="n">noTransform</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11029"></a>       <span class="n">AspectTransform</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11030"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">WorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11031"></a><span class="k">         CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="o">//</span><span class="s1">&#39;: must use Relative Coordinate System.  &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11032"></a>               <span class="s1">&#39;Transform request ignored.&#39;</span><span class="p">)</span>
<a name="ln-11033"></a>         <span class="n">noTransform</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11034"></a>         <span class="n">AspectTransform</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11035"></a>       <span class="n">ENDIF</span>
<a name="ln-11036"></a>    <span class="k">ELSE</span>
<a name="ln-11037"></a><span class="k">       </span><span class="n">firstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11038"></a>    <span class="n">Endif</span>
<a name="ln-11039"></a>  <span class="n">endif</span>
<a name="ln-11040"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">noTransform</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-11041"></a>
<a name="ln-11042"></a>  <span class="c">!check surface type.</span>
<a name="ln-11043"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11044"></a>    <span class="c">! Site Shading do not get transformed.</span>
<a name="ln-11045"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-11046"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-11047"></a>
<a name="ln-11048"></a>
<a name="ln-11049"></a>    <span class="c">!testing method of transforming  x and y coordinates as follows</span>
<a name="ln-11050"></a>
<a name="ln-11051"></a>
<a name="ln-11052"></a>    <span class="c">! this works if not rotated wrt north axis ... but if it is, then trouble</span>
<a name="ln-11053"></a>    <span class="c">! try to first derotate it , transform by aspect and then rotate back.</span>
<a name="ln-11054"></a>
<a name="ln-11055"></a>    <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NSides</span>
<a name="ln-11056"></a>      <span class="n">Xo</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span> <span class="c">! world coordinates.... shifted by relative north angle...</span>
<a name="ln-11057"></a>      <span class="n">Yo</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-11058"></a>      <span class="c">! next derotate the building</span>
<a name="ln-11059"></a>      <span class="n">XnoRot</span><span class="o">=</span><span class="n">Xo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">+</span> <span class="n">Yo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-11060"></a>      <span class="n">YnoRot</span><span class="o">=</span><span class="n">Yo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Xo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-11061"></a>      <span class="c">! translate</span>
<a name="ln-11062"></a>      <span class="n">Xtrans</span> <span class="o">=</span> <span class="n">XnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">NewAspectRatio</span><span class="o">/</span><span class="n">OldAspectRatio</span><span class="p">)</span>
<a name="ln-11063"></a>      <span class="n">Ytrans</span> <span class="o">=</span> <span class="n">YnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">OldAspectRatio</span><span class="o">/</span><span class="n">NewAspectRatio</span><span class="p">)</span>
<a name="ln-11064"></a>      <span class="c">! rerotate</span>
<a name="ln-11065"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-11066"></a>
<a name="ln-11067"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span>
<a name="ln-11068"></a>    <span class="n">ENDDO</span>
<a name="ln-11069"></a>
<a name="ln-11070"></a>  <span class="k">Return</span>
<a name="ln-11071"></a>
<a name="ln-11072"></a><span class="k">END SUBROUTINE </span><span class="n">TransformVertsByAspect</span>
<a name="ln-11073"></a>
<a name="ln-11074"></a><span class="k">SUBROUTINE </span><span class="n">CalcSurfaceCentroid</span>
<a name="ln-11075"></a>
<a name="ln-11076"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11077"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-11078"></a>          <span class="c">!       DATE WRITTEN   Feb. 2004</span>
<a name="ln-11079"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11080"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11081"></a>
<a name="ln-11082"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11083"></a>          <span class="c">! compute centroid of all the surfaces in the main</span>
<a name="ln-11084"></a>          <span class="c">! surface structure. Store the vertex coordinates of</span>
<a name="ln-11085"></a>          <span class="c">! the centroid in the &#39;SURFACE&#39; derived type.</span>
<a name="ln-11086"></a>
<a name="ln-11087"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11088"></a>          <span class="c">! The centroid of triangle is easily computed by averaging the vertices</span>
<a name="ln-11089"></a>          <span class="c">! The centroid of a quadrilateral is computed by area weighting the centroids</span>
<a name="ln-11090"></a>          <span class="c">! of two triangles.</span>
<a name="ln-11091"></a>          <span class="c">! (Algorithm would need to be changed for higher order</span>
<a name="ln-11092"></a>          <span class="c">! polygons with more than four sides).</span>
<a name="ln-11093"></a>
<a name="ln-11094"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11095"></a>          <span class="c">! na</span>
<a name="ln-11096"></a>
<a name="ln-11097"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11098"></a>    <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-11099"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-11100"></a>
<a name="ln-11101"></a>    <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11102"></a>
<a name="ln-11103"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11104"></a>          <span class="c">! na</span>
<a name="ln-11105"></a>
<a name="ln-11106"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11107"></a>          <span class="c">! na</span>
<a name="ln-11108"></a>
<a name="ln-11109"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11110"></a>          <span class="c">! na</span>
<a name="ln-11111"></a>
<a name="ln-11112"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11113"></a>          <span class="c">! na</span>
<a name="ln-11114"></a>
<a name="ln-11115"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11116"></a>    <span class="k">Type</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">Dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Triangle1</span> <span class="c">!working struct for a 3-sided surface</span>
<a name="ln-11117"></a>    <span class="k">Type</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">Dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Triangle2</span> <span class="c">!working struct for a 3-sided surface</span>
<a name="ln-11118"></a>
<a name="ln-11119"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisSurf</span>  <span class="c">! working variable for do loop</span>
<a name="ln-11120"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tri1Area</span>  <span class="c">! working variable for denominator</span>
<a name="ln-11121"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tri2Area</span>  <span class="c">! working variable for denominator</span>
<a name="ln-11122"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalArea</span> <span class="c">! working variable for denominator</span>
<a name="ln-11123"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xcm</span>       <span class="c">! temporary X coord for centriod</span>
<a name="ln-11124"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ycm</span>       <span class="c">! temporary Y coord for centriod</span>
<a name="ln-11125"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Zcm</span>       <span class="c">! temporary Z coord for centriod</span>
<a name="ln-11126"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XcmTri1</span>   <span class="c">! temporary X coord for centriod of triangle 1</span>
<a name="ln-11127"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YcmTri1</span>   <span class="c">! temporary Y coord for centriod of triangle 1</span>
<a name="ln-11128"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZcmTri1</span>   <span class="c">! temporary Z coord for centriod of triangle 1</span>
<a name="ln-11129"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XcmTri2</span>   <span class="c">! temporary X coord for centriod of triangle 2</span>
<a name="ln-11130"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YcmTri2</span>   <span class="c">! temporary Y coord for centriod of triangle 2</span>
<a name="ln-11131"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZcmTri2</span>   <span class="c">! temporary Z coord for centriod of triangle 2</span>
<a name="ln-11132"></a>    <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VecAvg</span> <span class="c">! Average (calc for multisided polygons (&gt;4 sides))</span>
<a name="ln-11133"></a>    <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">vert</span>
<a name="ln-11134"></a>    <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">negZcount</span>  <span class="c">! for warning error in surface centroids</span>
<a name="ln-11135"></a>
<a name="ln-11136"></a>    <span class="n">negZcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-11137"></a>
<a name="ln-11138"></a>    <span class="c">! loop through all the surfaces</span>
<a name="ln-11139"></a>    <span class="k">Do </span><span class="n">thisSurf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-11140"></a>
<a name="ln-11141"></a><span class="c">!      IF (Surface(thisSurf)%CLASS == &#39;INTMASS&#39;) CYCLE</span>
<a name="ln-11142"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="k">CLASS</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-11143"></a>
<a name="ln-11144"></a>      <span class="c">!re-init</span>
<a name="ln-11145"></a>      <span class="n">Xcm</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11146"></a>      <span class="n">Ycm</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11147"></a>      <span class="n">Zcm</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11148"></a>
<a name="ln-11149"></a>
<a name="ln-11150"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span>  <span class="c">!is this a 3- or 4-sided surface</span>
<a name="ln-11151"></a>
<a name="ln-11152"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">!3-sided polygon</span>
<a name="ln-11153"></a>        <span class="c">! centriod is simple average</span>
<a name="ln-11154"></a>        <span class="n">Xcm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11155"></a>        <span class="n">Ycm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11156"></a>        <span class="n">Zcm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">%</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11157"></a>
<a name="ln-11158"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">!4-sided polygon</span>
<a name="ln-11159"></a>
<a name="ln-11160"></a>        <span class="c">! re-init</span>
<a name="ln-11161"></a>        <span class="n">Triangle1</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11162"></a>        <span class="n">Triangle1</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11163"></a>        <span class="n">Triangle1</span><span class="p">%</span><span class="n">Z</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11164"></a>
<a name="ln-11165"></a>        <span class="n">Triangle2</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11166"></a>        <span class="n">Triangle2</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11167"></a>        <span class="n">Triangle2</span><span class="p">%</span><span class="n">Z</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11168"></a>
<a name="ln-11169"></a>        <span class="n">XcmTri1</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11170"></a>        <span class="n">YcmTri1</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11171"></a>        <span class="n">ZcmTri1</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11172"></a>
<a name="ln-11173"></a>        <span class="n">XcmTri2</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11174"></a>        <span class="n">YcmTri2</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11175"></a>        <span class="n">ZcmTri2</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11176"></a>
<a name="ln-11177"></a>        <span class="n">Tri1Area</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11178"></a>        <span class="n">Tri2Area</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11179"></a>
<a name="ln-11180"></a>        <span class="c">! split into 2 3-sided polygons (Triangle 1 and Triangle 2)</span>
<a name="ln-11181"></a>        <span class="n">Triangle1</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span> <span class="p">)%</span><span class="n">X</span>
<a name="ln-11182"></a>        <span class="n">Triangle1</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span> <span class="p">)%</span><span class="n">Y</span>
<a name="ln-11183"></a>        <span class="n">Triangle1</span><span class="p">%</span><span class="n">Z</span> <span class="o">=</span> <span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span> <span class="p">)%</span><span class="n">Z</span>
<a name="ln-11184"></a>
<a name="ln-11185"></a>        <span class="n">Triangle2</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span> <span class="p">)%</span><span class="n">X</span>
<a name="ln-11186"></a>        <span class="n">Triangle2</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span> <span class="p">)%</span><span class="n">Y</span>
<a name="ln-11187"></a>        <span class="n">Triangle2</span><span class="p">%</span><span class="n">Z</span> <span class="o">=</span> <span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="p">)</span> <span class="p">)%</span><span class="n">Z</span>
<a name="ln-11188"></a>
<a name="ln-11189"></a>        <span class="c">! get area of triangles.</span>
<a name="ln-11190"></a>        <span class="n">Tri1Area</span> <span class="o">=</span> <span class="n">AreaPolygon</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">Triangle1</span><span class="p">)</span>
<a name="ln-11191"></a>        <span class="n">Tri2Area</span> <span class="o">=</span> <span class="n">AreaPolygon</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">Triangle2</span><span class="p">)</span>
<a name="ln-11192"></a>
<a name="ln-11193"></a>        <span class="c">! get total Area of quad.</span>
<a name="ln-11194"></a>        <span class="n">TotalArea</span> <span class="o">=</span> <span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">grossarea</span>
<a name="ln-11195"></a>
<a name="ln-11196"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TotalArea</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-11197"></a>           <span class="c">!catch a problem....</span>
<a name="ln-11198"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcSurfaceCentroid: zero area surface, for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-11199"></a>            <span class="k">cycle</span>
<a name="ln-11200"></a><span class="k">        </span><span class="n">endif</span>
<a name="ln-11201"></a>        <span class="c">! get centroid of Triangle 1</span>
<a name="ln-11202"></a>        <span class="n">XcmTri1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Triangle1</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11203"></a>        <span class="n">YcmTri1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Triangle1</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11204"></a>        <span class="n">ZcmTri1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Triangle1</span><span class="p">%</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11205"></a>
<a name="ln-11206"></a>        <span class="c">! get centroid of Triangle 2</span>
<a name="ln-11207"></a>        <span class="n">XcmTri2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Triangle2</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11208"></a>        <span class="n">YcmTri2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Triangle2</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11209"></a>        <span class="n">ZcmTri2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Triangle2</span><span class="p">%</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-11210"></a>
<a name="ln-11211"></a>        <span class="c">! find area weighted combination of the two centroids.</span>
<a name="ln-11212"></a>
<a name="ln-11213"></a>        <span class="n">Xcm</span> <span class="o">=</span> <span class="p">(</span><span class="n">XcmTri1</span><span class="o">*</span><span class="n">Tri1Area</span> <span class="o">+</span> <span class="n">XcmTri2</span><span class="o">*</span><span class="n">Tri2Area</span><span class="p">)</span> <span class="o">/</span> <span class="n">TotalArea</span>
<a name="ln-11214"></a>        <span class="n">Ycm</span> <span class="o">=</span> <span class="p">(</span><span class="n">YcmTri1</span><span class="o">*</span><span class="n">Tri1Area</span> <span class="o">+</span> <span class="n">YcmTri2</span><span class="o">*</span><span class="n">Tri2Area</span><span class="p">)</span> <span class="o">/</span> <span class="n">TotalArea</span>
<a name="ln-11215"></a>        <span class="n">Zcm</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZcmTri1</span><span class="o">*</span><span class="n">Tri1Area</span> <span class="o">+</span> <span class="n">ZcmTri2</span><span class="o">*</span><span class="n">Tri2Area</span><span class="p">)</span> <span class="o">/</span> <span class="n">TotalArea</span>
<a name="ln-11216"></a>
<a name="ln-11217"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">5</span><span class="p">:)</span> <span class="c">!multi-sided polygon</span>
<a name="ln-11218"></a>         <span class="c">! (Maybe triangulate?  For now, use old &quot;z&quot; average method&quot;)</span>
<a name="ln-11219"></a>         <span class="c">! and X and Y -- straight average</span>
<a name="ln-11220"></a>
<a name="ln-11221"></a><span class="c">!        X1=MINVAL(Surface(thisSurf)%Vertex(1:Surface(thisSurf)%Sides)%X)</span>
<a name="ln-11222"></a><span class="c">!        X2=MAXVAL(Surface(thisSurf)%Vertex(1:Surface(thisSurf)%Sides)%X)</span>
<a name="ln-11223"></a><span class="c">!        Y1=MINVAL(Surface(thisSurf)%Vertex(1:Surface(thisSurf)%Sides)%Y)</span>
<a name="ln-11224"></a><span class="c">!        Y2=MAXVAL(Surface(thisSurf)%Vertex(1:Surface(thisSurf)%Sides)%Y)</span>
<a name="ln-11225"></a><span class="c">!        Z1=MINVAL(Surface(thisSurf)%Vertex(1:Surface(thisSurf)%Sides)%Z)</span>
<a name="ln-11226"></a><span class="c">!        Z2=MAXVAL(Surface(thisSurf)%Vertex(1:Surface(thisSurf)%Sides)%Z)</span>
<a name="ln-11227"></a><span class="c">!        Xcm=(X1+X2)/2.0d0</span>
<a name="ln-11228"></a><span class="c">!        Ycm=(Y1+Y2)/2.0d0</span>
<a name="ln-11229"></a><span class="c">!        Zcm=(Z1+Z2)/2.0d0</span>
<a name="ln-11230"></a>
<a name="ln-11231"></a>        <span class="c">! Calc centroid as average of surfaces</span>
<a name="ln-11232"></a>        <span class="n">VecAvg</span><span class="o">=</span><span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-11233"></a>
<a name="ln-11234"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-11235"></a>          <span class="n">VecAvg</span><span class="o">=</span><span class="n">VecAvg</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span>
<a name="ln-11236"></a>        <span class="n">enddo</span>
<a name="ln-11237"></a>        <span class="n">VecAvg</span><span class="o">=</span><span class="n">VecAvg</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11238"></a>        <span class="n">Xcm</span><span class="o">=</span><span class="n">VecAvg</span><span class="p">%</span><span class="n">x</span>
<a name="ln-11239"></a>        <span class="n">Ycm</span><span class="o">=</span><span class="n">VecAvg</span><span class="p">%</span><span class="n">y</span>
<a name="ln-11240"></a>        <span class="n">Zcm</span><span class="o">=</span><span class="n">VecAvg</span><span class="p">%</span><span class="n">z</span>
<a name="ln-11241"></a>
<a name="ln-11242"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11243"></a>
<a name="ln-11244"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Name</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11245"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcSurfaceCentroid: caught problem with # of sides, for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-11246"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... number of sides must be &gt;= 3, this surface # sides=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11247"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-11248"></a>      <span class="k">ELSE</span>
<a name="ln-11249"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcSurfaceCentroid: caught problem with # of sides, for surface=#&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11250"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)))</span>
<a name="ln-11251"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...surface name is blank. Examine surfaces -- &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11252"></a>             <span class="s1">&#39;this may be a problem with ill-formed interzone surfaces.&#39;</span><span class="p">)</span>
<a name="ln-11253"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... number of sides must be &gt;= 3, this surface # sides=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11254"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)))</span>
<a name="ln-11255"></a>      <span class="n">ENDIF</span>
<a name="ln-11256"></a>
<a name="ln-11257"></a>      <span class="k">END SELECT</span>
<a name="ln-11258"></a>
<a name="ln-11259"></a>      <span class="c">! store result in the surface structure in DataSurfaces</span>
<a name="ln-11260"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">centroid</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">Xcm</span>
<a name="ln-11261"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">centroid</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">Ycm</span>
<a name="ln-11262"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">thissurf</span><span class="p">)%</span><span class="n">centroid</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">Zcm</span>
<a name="ln-11263"></a>
<a name="ln-11264"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">Zcm</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11265"></a><span class="k">        if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">ExtWind</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">thisSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="n">negZcount</span><span class="o">=</span><span class="n">negZcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11266"></a>      <span class="n">endif</span>
<a name="ln-11267"></a>
<a name="ln-11268"></a>    <span class="n">ENDDO</span>  <span class="c">!loop through surfaces</span>
<a name="ln-11269"></a>
<a name="ln-11270"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">negZcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11271"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcSurfaceCentroid: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">negZcount</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11272"></a>              <span class="s1">&#39; Surfaces have the Z coordinate &lt; 0.&#39;</span><span class="p">)</span>
<a name="ln-11273"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...in any calculations, Wind Speed will be 0.0 for these surfaces.&#39;</span><span class="p">)</span>
<a name="ln-11274"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...in any calculations, Outside temperatures will be the &#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-11275"></a>         <span class="s1">&#39;outside temperature + &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WeatherFileTempModCoeff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; for these surfaces.&#39;</span><span class="p">)</span>
<a name="ln-11276"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...that is, these surfaces will have conditions as though at ground level.&#39;</span><span class="p">)</span>
<a name="ln-11277"></a>    <span class="n">endif</span>
<a name="ln-11278"></a>
<a name="ln-11279"></a>    <span class="k">RETURN</span>
<a name="ln-11280"></a>
<a name="ln-11281"></a><span class="k">END SUBROUTINE </span><span class="n">CalcSurfaceCentroid</span>
<a name="ln-11282"></a>
<a name="ln-11283"></a><span class="k">SUBROUTINE </span><span class="n">SetupShadeSurfacesForSolarCalcs</span>
<a name="ln-11284"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11285"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-11286"></a>          <span class="c">!       DATE WRITTEN   Dec. 2008</span>
<a name="ln-11287"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11288"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11289"></a>
<a name="ln-11290"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11291"></a>          <span class="c">! determine if Shading surfaces need full solar calcs because they</span>
<a name="ln-11292"></a>          <span class="c">! are also used to define geometry of an active solar component.</span>
<a name="ln-11293"></a>          <span class="c">! Normally, a shading surface is not included in calculations of incident solar, only shading</span>
<a name="ln-11294"></a>          <span class="c">!</span>
<a name="ln-11295"></a>
<a name="ln-11296"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11297"></a>          <span class="c">! Mine solar renewables input and collect surface names.</span>
<a name="ln-11298"></a>          <span class="c">! find shading surfaces with names that match those in solar objects.</span>
<a name="ln-11299"></a>          <span class="c">! setup flags for shading surfaces so that the solar renewables can resuse incident solar calcs</span>
<a name="ln-11300"></a>          <span class="c">! new solar component models that use shading surfaces will have to extend the code here.</span>
<a name="ln-11301"></a>
<a name="ln-11302"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11303"></a>          <span class="c">! na</span>
<a name="ln-11304"></a>
<a name="ln-11305"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11306"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-11307"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-11308"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span>
<a name="ln-11309"></a>
<a name="ln-11310"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11311"></a>
<a name="ln-11312"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11313"></a>          <span class="c">! na</span>
<a name="ln-11314"></a>
<a name="ln-11315"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11316"></a>          <span class="c">! na</span>
<a name="ln-11317"></a>
<a name="ln-11318"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11319"></a>          <span class="c">! na</span>
<a name="ln-11320"></a>
<a name="ln-11321"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11322"></a>          <span class="c">! na</span>
<a name="ln-11323"></a>
<a name="ln-11324"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11325"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TmpCandidateSurfaceNames</span>
<a name="ln-11326"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TmpCandidateICSSurfaceNames</span>
<a name="ln-11327"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TmpCandidateICSBCTypeNames</span>
<a name="ln-11328"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCandidateNames</span>
<a name="ln-11329"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfCollectors</span>
<a name="ln-11330"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfICSUnits</span>
<a name="ln-11331"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfFlatPlateUnits</span>
<a name="ln-11332"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumPVTs</span>
<a name="ln-11333"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumPVs</span>
<a name="ln-11334"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-11335"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">found</span>
<a name="ln-11336"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CollectorNum</span>
<a name="ln-11337"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PVTNum</span>
<a name="ln-11338"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PVNum</span>
<a name="ln-11339"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span> <span class="c">! Number of alpha names being passed</span>
<a name="ln-11340"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>   <span class="c">! Number of numeric parameters being passed</span>
<a name="ln-11341"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>
<a name="ln-11342"></a>
<a name="ln-11343"></a>  <span class="c">!First collect names of surfaces referenced by active solar components</span>
<a name="ln-11344"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SolarCollector:FlatPlate:Water&#39;</span>
<a name="ln-11345"></a>  <span class="n">NumOfFlatPlateUnits</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-11346"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SolarCollector:FlatPlate:PhotovoltaicThermal&#39;</span>
<a name="ln-11347"></a>  <span class="n">NumPVTs</span>              <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-11348"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:Photovoltaic&#39;</span>
<a name="ln-11349"></a>  <span class="n">NumPVs</span>                 <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span> <span class="p">)</span>
<a name="ln-11350"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SolarCollector:IntegralCollectorStorage&#39;</span>
<a name="ln-11351"></a>  <span class="n">NumOfICSUnits</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-11352"></a>
<a name="ln-11353"></a>  <span class="n">NumCandidateNames</span> <span class="o">=</span> <span class="n">NumOfFlatPlateUnits</span> <span class="o">+</span> <span class="n">NumPVTs</span> <span class="o">+</span> <span class="n">NumPVs</span> <span class="o">+</span> <span class="n">NumOfICSUnits</span>
<a name="ln-11354"></a>  <span class="n">NumOfCollectors</span> <span class="o">=</span> <span class="n">NumOfFlatPlateUnits</span> <span class="o">+</span> <span class="n">NumOfICSUnits</span>
<a name="ln-11355"></a>
<a name="ln-11356"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TmpCandidateSurfaceNames</span><span class="p">(</span><span class="n">NumCandidateNames</span><span class="p">),</span> <span class="n">TmpCandidateICSSurfaceNames</span><span class="p">(</span><span class="n">NumOfCollectors</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-11357"></a>           <span class="n">TmpCandidateICSBCTypeNames</span><span class="p">(</span><span class="n">NumOfCollectors</span><span class="p">))</span>
<a name="ln-11358"></a>
<a name="ln-11359"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfCollectors</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11360"></a><span class="k">    </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SolarCollector:FlatPlate:Water&#39;</span>
<a name="ln-11361"></a>    <span class="k">DO </span><span class="n">CollectorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfFlatPlateUnits</span>
<a name="ln-11362"></a>
<a name="ln-11363"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">CollectorNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-11364"></a>
<a name="ln-11365"></a>      <span class="n">TmpCandidateSurfaceNames</span><span class="p">(</span><span class="n">CollectorNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-11366"></a>      <span class="n">TmpCandidateICSBCTypeNames</span><span class="p">(</span><span class="n">CollectorNum</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-11367"></a>    <span class="n">ENDDO</span>
<a name="ln-11368"></a>  <span class="n">ENDIF</span>
<a name="ln-11369"></a>
<a name="ln-11370"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumPVTs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11371"></a><span class="k">    </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SolarCollector:FlatPlate:PhotovoltaicThermal&#39;</span>
<a name="ln-11372"></a>    <span class="k">DO </span><span class="n">PVTNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPVTs</span>
<a name="ln-11373"></a>
<a name="ln-11374"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">PVTNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-11375"></a>
<a name="ln-11376"></a>      <span class="n">TmpCandidateSurfaceNames</span><span class="p">(</span><span class="n">NumOfFlatPlateUnits</span> <span class="o">+</span> <span class="n">PVTNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-11377"></a>    <span class="n">ENDDO</span>
<a name="ln-11378"></a>  <span class="n">ENDIF</span>
<a name="ln-11379"></a>
<a name="ln-11380"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumPVs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11381"></a><span class="k">    </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:Photovoltaic&#39;</span>
<a name="ln-11382"></a>    <span class="k">DO </span><span class="n">PVNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPVs</span>
<a name="ln-11383"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">PVNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-11384"></a>      <span class="n">TmpCandidateSurfaceNames</span><span class="p">(</span><span class="n">NumOfFlatPlateUnits</span> <span class="o">+</span> <span class="n">NumPVTs</span> <span class="o">+</span> <span class="n">PVNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-11385"></a>    <span class="n">ENDDO</span>
<a name="ln-11386"></a>  <span class="n">ENDIF</span>
<a name="ln-11387"></a>
<a name="ln-11388"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfICSUnits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11389"></a><span class="k">    </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;SolarCollector:IntegralCollectorStorage&#39;</span>
<a name="ln-11390"></a>    <span class="k">DO </span><span class="n">CollectorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfICSUnits</span>
<a name="ln-11391"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">CollectorNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-11392"></a>      <span class="n">TmpCandidateSurfaceNames</span><span class="p">(</span><span class="n">NumOfFlatPlateUnits</span> <span class="o">+</span> <span class="n">NumPVTs</span> <span class="o">+</span> <span class="n">NumPVs</span> <span class="o">+</span> <span class="n">CollectorNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-11393"></a>      <span class="n">TmpCandidateICSSurfaceNames</span><span class="p">(</span><span class="n">NumOfFlatPlateUnits</span> <span class="o">+</span> <span class="n">CollectorNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-11394"></a>      <span class="n">TmpCandidateICSBCTypeNames</span><span class="p">(</span><span class="n">NumOfFlatPlateUnits</span> <span class="o">+</span> <span class="n">CollectorNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-11395"></a>    <span class="n">ENDDO</span>
<a name="ln-11396"></a>  <span class="n">ENDIF</span>
<a name="ln-11397"></a>
<a name="ln-11398"></a>  <span class="c">! loop through all the surfaces</span>
<a name="ln-11399"></a>  <span class="k">Do </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-11400"></a>
<a name="ln-11401"></a>    <span class="n">Found</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span> <span class="n">TmpCandidateSurfaceNames</span><span class="p">,</span> <span class="n">NumCandidateNames</span><span class="p">)</span>
<a name="ln-11402"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-11403"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">)</span> <span class="k">Then</span> <span class="c">! not BIPV, must be a shading surf with solar device</span>
<a name="ln-11404"></a>        <span class="c">! Setup missing values to allow shading surfaces to model incident solar and wind</span>
<a name="ln-11405"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11406"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11407"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-11408"></a>
<a name="ln-11409"></a>      <span class="n">ENDIF</span>
<a name="ln-11410"></a>      <span class="c">! check if this surface is used for ICS collector mounting and has OthersideCondictionsModel as its</span>
<a name="ln-11411"></a>      <span class="c">! boundary condition</span>
<a name="ln-11412"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfICSUnits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-11413"></a><span class="k">        DO </span><span class="n">CollectorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfCollectors</span>
<a name="ln-11414"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span> <span class="n">TmpCandidateICSSurfaceNames</span><span class="p">(</span><span class="n">CollectorNum</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11415"></a>               <span class="n">SameString</span><span class="p">(</span><span class="n">TmpCandidateICSBCTypeNames</span><span class="p">(</span><span class="n">CollectorNum</span><span class="p">),</span> <span class="s1">&#39;OTHERSIDECONDITIONSMODEL&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11416"></a><span class="k">               </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IsICS</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11417"></a>               <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ICSPtr</span> <span class="o">=</span> <span class="n">CollectorNum</span>
<a name="ln-11418"></a>          <span class="n">ENDIF</span>
<a name="ln-11419"></a>
<a name="ln-11420"></a>        <span class="k">END DO</span>
<a name="ln-11421"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-11422"></a>
<a name="ln-11423"></a>    <span class="n">ENDIF</span>   <span class="c">! end of IF (Found &gt; 0) Then</span>
<a name="ln-11424"></a>
<a name="ln-11425"></a>  <span class="n">ENDDO</span>
<a name="ln-11426"></a>
<a name="ln-11427"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TmpCandidateSurfaceNames</span><span class="p">,</span><span class="n">TmpCandidateICSBCTypeNames</span><span class="p">,</span><span class="n">TmpCandidateICSSurfaceNames</span><span class="p">)</span>
<a name="ln-11428"></a>  <span class="k">RETURN</span>
<a name="ln-11429"></a>
<a name="ln-11430"></a><span class="k">END SUBROUTINE </span><span class="n">SetupShadeSurfacesForSolarCalcs</span>
<a name="ln-11431"></a>
<a name="ln-11432"></a><span class="k">SUBROUTINE </span><span class="n">CheckConvexity</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">NSides</span><span class="p">)</span>
<a name="ln-11433"></a>
<a name="ln-11434"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11435"></a>          <span class="c">!       AUTHOR         Tyler Hoyt</span>
<a name="ln-11436"></a>          <span class="c">!       DATE WRITTEN   December 2010</span>
<a name="ln-11437"></a>          <span class="c">!       MODIFIED       CR8752 - incorrect note of non-convex polygons</span>
<a name="ln-11438"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11439"></a>
<a name="ln-11440"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This subroutine verifies the convexity of a</span>
<a name="ln-11441"></a>          <span class="c">! surface that is exposed to the sun in the case that full shading calculations</span>
<a name="ln-11442"></a>          <span class="c">! are required. The calculation conveniently detects collinear points as well,</span>
<a name="ln-11443"></a>          <span class="c">! and returns a list of indices that are collinear within the plane of the surface.</span>
<a name="ln-11444"></a>
<a name="ln-11445"></a>          <span class="c">! METHODOLOGY EMPLOYED: First the surface is determined to have dimension 2 in</span>
<a name="ln-11446"></a>          <span class="c">! either the xy, yz, or xz plane. That plane is selected to do the testing.</span>
<a name="ln-11447"></a>          <span class="c">! Vectors representing the edges of the polygon and the perpendicular dot product</span>
<a name="ln-11448"></a>          <span class="c">! between adjacent edges are computed. This allows the turning angle to be determined.</span>
<a name="ln-11449"></a>          <span class="c">! If the turning angle is greater than pi/2, it turns to the right, and if it is</span>
<a name="ln-11450"></a>          <span class="c">! less than pi/2, it turns left. The direction of the turn is stored, and if it</span>
<a name="ln-11451"></a>          <span class="c">! changes as the edges are iterated the surface is not convex. Meanwhile it stores</span>
<a name="ln-11452"></a>          <span class="c">! the indices of vertices that are collinear and are later removed.</span>
<a name="ln-11453"></a>
<a name="ln-11454"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11455"></a>          <span class="c">! http://mathworld.wolfram.com/ConvexPolygon.html</span>
<a name="ln-11456"></a>
<a name="ln-11457"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11458"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-11459"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span>
<a name="ln-11460"></a>
<a name="ln-11461"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11462"></a>
<a name="ln-11463"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11464"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfNum</span>     <span class="c">! Current surface number</span>
<a name="ln-11465"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NSides</span>      <span class="c">! Number of sides to figure</span>
<a name="ln-11466"></a>
<a name="ln-11467"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11468"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TurnThreshold</span> <span class="o">=</span> <span class="mf">0.000001d0</span> <span class="c">! Sensitivity of convexity test, in radians</span>
<a name="ln-11469"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ErrFmt</span><span class="o">=</span><span class="s2">&quot;(&#39; (&#39;,F8.3,&#39;,&#39;,F8.3,&#39;,&#39;,F8.3,&#39;)&#39;)&quot;</span>
<a name="ln-11470"></a>
<a name="ln-11471"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11472"></a>          <span class="c">! na</span>
<a name="ln-11473"></a>
<a name="ln-11474"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11475"></a>          <span class="c">! na</span>
<a name="ln-11476"></a>
<a name="ln-11477"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11478"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">N</span>             <span class="c">! Loop index</span>
<a name="ln-11479"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Np1</span>             <span class="c">! Loop index</span>
<a name="ln-11480"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Np2</span>             <span class="c">! Loop index</span>
<a name="ln-11481"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Det</span>           <span class="c">! Determinant for picking projection plane</span>
<a name="ln-11482"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DotProd</span>       <span class="c">! Dot product for determining angle</span>
<a name="ln-11483"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span>         <span class="c">! Angle between edge vectors</span>
<a name="ln-11484"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LastTheta</span>     <span class="c">! Angle between edge vectors</span>
<a name="ln-11485"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V1len</span>         <span class="c">! Edge vector length</span>
<a name="ln-11486"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V2len</span>         <span class="c">! Edge vector length</span>
<a name="ln-11487"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">SignFlag</span>      <span class="c">! Direction of edge turn : .true. is right, .false. is left</span>
<a name="ln-11488"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">PrevSignFlag</span>  <span class="c">! Container for the sign of the previous iteration&#39;s edge turn</span>
<a name="ln-11489"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstTimeFlag</span> <span class="c">! Flag indicating first iteration</span>
<a name="ln-11490"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">X</span> <span class="c">! containers for x,y,z vertices of the surface</span>
<a name="ln-11491"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-11492"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-11493"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">A</span>    <span class="c">! containers for convexity test</span>
<a name="ln-11494"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">B</span>
<a name="ln-11495"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SurfCollinearVerts</span> <span class="c">! Array containing indices of collinear vertices</span>
<a name="ln-11496"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">VertSize</span>  <span class="c">! size of X,Y,Z,A,B arrays</span>
<a name="ln-11497"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cosarg</span>
<a name="ln-11498"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">M</span>             <span class="c">! Array index for SurfCollinearVerts container</span>
<a name="ln-11499"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">J</span>             <span class="c">! Loop index</span>
<a name="ln-11500"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">K</span>             <span class="c">! Loop index</span>
<a name="ln-11501"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Ind</span>           <span class="c">! Location of surface vertex to be removed</span>
<a name="ln-11502"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">firstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11503"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ACosZero</span>  <span class="c">! set on firstTime</span>
<a name="ln-11504"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SurfCollinearWarning</span>
<a name="ln-11505"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">132</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrLineOut</span><span class="o">=</span><span class="n">Blank</span> <span class="c">! Character string for producing error messages</span>
<a name="ln-11506"></a>
<a name="ln-11507"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">firstTime</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11508"></a><span class="k">    </span><span class="n">ACosZero</span><span class="o">=</span><span class="nb">ACOS</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-11509"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11510"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11511"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11512"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11513"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11514"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfCollinearVerts</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">))</span>
<a name="ln-11515"></a>    <span class="n">VertSize</span><span class="o">=</span><span class="n">MaxVerticesPerSurface</span>
<a name="ln-11516"></a>    <span class="n">firstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11517"></a>  <span class="n">endif</span>
<a name="ln-11518"></a>
<a name="ln-11519"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">NSides</span> <span class="o">&gt;</span> <span class="n">VertSize</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11520"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-11521"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<a name="ln-11522"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-11523"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<a name="ln-11524"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<a name="ln-11525"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SurfCollinearVerts</span><span class="p">)</span>
<a name="ln-11526"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11527"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11528"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11529"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11530"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-11531"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfCollinearVerts</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">))</span>
<a name="ln-11532"></a>    <span class="n">VertSize</span><span class="o">=</span><span class="n">MaxVerticesPerSurface</span>
<a name="ln-11533"></a>  <span class="n">endif</span>
<a name="ln-11534"></a>
<a name="ln-11535"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NSides</span>
<a name="ln-11536"></a>    <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-11537"></a>    <span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-11538"></a>    <span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-11539"></a>  <span class="k">END DO</span>
<a name="ln-11540"></a><span class="k">  </span><span class="n">X</span><span class="p">(</span><span class="n">Nsides</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-11541"></a>  <span class="n">Y</span><span class="p">(</span><span class="n">Nsides</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-11542"></a>  <span class="n">Z</span><span class="p">(</span><span class="n">Nsides</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-11543"></a>  <span class="n">X</span><span class="p">(</span><span class="n">Nsides</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-11544"></a>  <span class="n">Y</span><span class="p">(</span><span class="n">Nsides</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-11545"></a>  <span class="n">Z</span><span class="p">(</span><span class="n">Nsides</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-11546"></a>
<a name="ln-11547"></a>
<a name="ln-11548"></a>  <span class="c">! Determine a suitable plane in which to do the tests</span>
<a name="ln-11549"></a>  <span class="n">Det</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11550"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NSides</span>
<a name="ln-11551"></a>    <span class="n">Det</span> <span class="o">=</span> <span class="n">Det</span> <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11552"></a>  <span class="k">END DO</span>
<a name="ln-11553"></a><span class="k">  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Det</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11554"></a><span class="k">    </span><span class="n">A</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-11555"></a>    <span class="n">B</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-11556"></a>  <span class="k">ELSE</span>
<a name="ln-11557"></a><span class="k">    </span><span class="n">Det</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11558"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NSides</span>
<a name="ln-11559"></a>      <span class="n">Det</span> <span class="o">=</span> <span class="n">Det</span> <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11560"></a>    <span class="k">END DO</span>
<a name="ln-11561"></a><span class="k">    IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Det</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11562"></a><span class="k">      </span><span class="n">A</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-11563"></a>      <span class="n">B</span> <span class="o">=</span> <span class="n">Z</span>
<a name="ln-11564"></a>    <span class="k">ELSE</span>
<a name="ln-11565"></a><span class="k">      </span><span class="n">Det</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11566"></a>      <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NSides</span>
<a name="ln-11567"></a>        <span class="n">Det</span> <span class="o">=</span> <span class="n">Det</span> <span class="o">+</span> <span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11568"></a>      <span class="k">END DO</span>
<a name="ln-11569"></a><span class="k">      IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Det</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11570"></a><span class="k">        </span><span class="n">A</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-11571"></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">Z</span>
<a name="ln-11572"></a>      <span class="k">ELSE</span>
<a name="ln-11573"></a>        <span class="c">! This condition should not be reached if the surfaces are guaranteed to be planar already</span>
<a name="ln-11574"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CheckConvexity: Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11575"></a>          <span class="s1">&#39;&quot; is non-planar.&#39;</span><span class="p">)</span>
<a name="ln-11576"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coincident Vertices will be removed as possible.&#39;</span><span class="p">)</span>
<a name="ln-11577"></a>        <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-11578"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrLineOut</span><span class="p">,</span><span class="n">ErrFmt</span><span class="p">)</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11579"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">ErrLineOut</span><span class="p">)</span>
<a name="ln-11580"></a>        <span class="n">ENDDO</span>
<a name="ln-11581"></a>      <span class="k">END IF</span>
<a name="ln-11582"></a><span class="k">    END IF</span>
<a name="ln-11583"></a><span class="k">  END IF</span>
<a name="ln-11584"></a>
<a name="ln-11585"></a><span class="k">  </span><span class="n">M</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-11586"></a>  <span class="n">FirstTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11587"></a>  <span class="n">SurfCollinearWarning</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11588"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NSides</span>   <span class="c">! perform convexity test in the plane determined above.</span>
<a name="ln-11589"></a>    <span class="n">DotProd</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-11590"></a>    <span class="n">V1len</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">((</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-11591"></a>    <span class="n">V2len</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">((</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">B</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-11592"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">V1Len</span> <span class="o">&lt;=</span> <span class="mf">1.d-8</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">V2Len</span> <span class="o">&lt;=</span> <span class="mf">1.d-8</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-11593"></a><span class="k">    </span><span class="n">cosarg</span><span class="o">=</span><span class="n">DotProd</span><span class="o">/</span><span class="p">(</span><span class="n">V1len</span> <span class="o">*</span> <span class="n">V2len</span><span class="p">)</span>
<a name="ln-11594"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">cosarg</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11595"></a><span class="k">      </span><span class="n">cosarg</span><span class="o">=-</span><span class="mf">1.0d0</span>
<a name="ln-11596"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">cosarg</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11597"></a><span class="k">      </span><span class="n">cosarg</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-11598"></a>    <span class="n">endif</span>
<a name="ln-11599"></a>    <span class="n">Theta</span>   <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">cosarg</span><span class="p">)</span>
<a name="ln-11600"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">ACosZero</span><span class="o">-</span><span class="n">TurnThreshold</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11601"></a><span class="k">      </span><span class="n">SignFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11602"></a>    <span class="k">ELSE</span>
<a name="ln-11603"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ACosZero</span><span class="o">+</span><span class="n">TurnThreshold</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11604"></a><span class="k">        </span><span class="n">SignFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11605"></a>      <span class="k">ELSE</span>   <span class="c">! Store the index of the collinear vertex for removal</span>
<a name="ln-11606"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfCollinearWarning</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11607"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11608"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CheckConvexity: Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11609"></a>               <span class="s1">&#39;&quot;, Collinear points have been removed.&#39;</span><span class="p">)</span>
<a name="ln-11610"></a>          <span class="n">ENDIF</span>
<a name="ln-11611"></a>          <span class="n">SurfCollinearWarning</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-11612"></a>        <span class="n">ENDIF</span>
<a name="ln-11613"></a>        <span class="n">TotalCoincidentVertices</span><span class="o">=</span><span class="n">TotalCoincidentVertices</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11614"></a>        <span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-11615"></a>        <span class="n">SurfCollinearVerts</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-11616"></a>        <span class="k">CYCLE</span>
<a name="ln-11617"></a><span class="k">      END IF</span>
<a name="ln-11618"></a><span class="k">    END IF</span>
<a name="ln-11619"></a>
<a name="ln-11620"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">FirstTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11621"></a><span class="k">      </span><span class="n">PrevSignFlag</span> <span class="o">=</span> <span class="n">SignFlag</span>
<a name="ln-11622"></a>      <span class="n">FirstTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11623"></a>      <span class="k">CYCLE</span>
<a name="ln-11624"></a><span class="k">    END IF</span>
<a name="ln-11625"></a>
<a name="ln-11626"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SignFlag</span> <span class="p">.</span><span class="n">neqv</span><span class="p">.</span> <span class="n">PrevSignFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11627"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11628"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11629"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CheckConvexity: Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11630"></a>             <span class="s1">&#39;&quot;, Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; is non-convex.&#39;</span><span class="p">)</span>
<a name="ln-11631"></a>          <span class="n">Np1</span><span class="o">=</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11632"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Np1</span> <span class="o">&gt;</span> <span class="n">NSides</span><span class="p">)</span> <span class="n">Np1</span><span class="o">=</span><span class="n">Np1</span><span class="o">-</span><span class="n">NSides</span>
<a name="ln-11633"></a>          <span class="n">Np2</span><span class="o">=</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-11634"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Np2</span> <span class="o">&gt;</span> <span class="n">NSides</span><span class="p">)</span> <span class="n">Np2</span><span class="o">=</span><span class="n">Np2</span><span class="o">-</span><span class="n">NSides</span>
<a name="ln-11635"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...vertex &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">N</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; to vertex &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Np1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11636"></a>             <span class="s1">&#39; to vertex &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Np2</span><span class="p">)))</span>
<a name="ln-11637"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...vertex &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">N</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11638"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11639"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11640"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-11641"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...vertex &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Np1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11642"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11643"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11644"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-11645"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...vertex &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Np2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11646"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11647"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11648"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-11649"></a><span class="c">!          CALL ShowContinueError(&#39;...theta angle=[&#39;//trim(RoundSigDigits(Theta,6))//&#39;]&#39;)</span>
<a name="ln-11650"></a><span class="c">!          CALL ShowContinueError(&#39;...last theta angle=[&#39;//trim(RoundSigDigits(LastTheta,6))//&#39;]&#39;)</span>
<a name="ln-11651"></a>        <span class="n">ENDIF</span>
<a name="ln-11652"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IsConvex</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-11653"></a>        <span class="k">EXIT</span>
<a name="ln-11654"></a><span class="k">      END IF</span>
<a name="ln-11655"></a><span class="k">    END IF</span>
<a name="ln-11656"></a><span class="k">    </span><span class="n">PrevSignFlag</span> <span class="o">=</span> <span class="n">SignFlag</span>
<a name="ln-11657"></a>    <span class="n">LastTheta</span><span class="o">=</span><span class="n">Theta</span>
<a name="ln-11658"></a>  <span class="k">END DO</span>
<a name="ln-11659"></a>
<a name="ln-11660"></a>  <span class="c">! must check to make sure don&#39;t remove NSides below 3</span>
<a name="ln-11661"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">M</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Remove the collinear points determined above</span>
<a name="ln-11662"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NSides</span><span class="o">-</span><span class="n">M</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11663"></a><span class="k">      </span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">=</span> <span class="n">NSides</span> <span class="o">-</span> <span class="n">M</span>
<a name="ln-11664"></a>    <span class="k">ELSE</span>  <span class="c">! too many</span>
<a name="ln-11665"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11666"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CheckConvexity: Surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; has [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11667"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">M</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] collinear points.&#39;</span><span class="p">)</span>
<a name="ln-11668"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...too many to remove all.  Will leave the surface with 3 sides. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11669"></a>           <span class="s1">&#39;But this is now a degenerate surface&#39;</span><span class="p">)</span>
<a name="ln-11670"></a>      <span class="n">ENDIF</span>
<a name="ln-11671"></a>      <span class="n">TotalDegenerateSurfaces</span><span class="o">=</span><span class="n">TotalDegenerateSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11672"></a>      <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NSides</span><span class="o">-</span><span class="n">M</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-11673"></a>      <span class="n">M</span><span class="o">=</span><span class="n">NSides</span><span class="o">-</span><span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-11674"></a>    <span class="n">ENDIF</span>
<a name="ln-11675"></a>    <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">M</span>
<a name="ln-11676"></a>      <span class="n">Ind</span> <span class="o">=</span> <span class="n">SurfCollinearVerts</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-11677"></a>      <span class="k">DO </span><span class="n">K</span> <span class="o">=</span> <span class="n">Ind</span><span class="p">,</span> <span class="n">NSides</span> <span class="o">-</span> <span class="n">J</span>
<a name="ln-11678"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">X</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">J</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-11679"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">J</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-11680"></a>        <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Z</span> <span class="o">=</span> <span class="n">SurfaceTmp</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">J</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-11681"></a>      <span class="k">END DO</span>
<a name="ln-11682"></a><span class="k">    END DO</span>
<a name="ln-11683"></a><span class="k">  END IF</span>
<a name="ln-11684"></a>
<a name="ln-11685"></a>
<a name="ln-11686"></a><span class="k">END SUBROUTINE </span><span class="n">CheckConvexity</span>
<a name="ln-11687"></a>
<a name="ln-11688"></a><span class="c">!     NOTICE</span>
<a name="ln-11689"></a><span class="c">!</span>
<a name="ln-11690"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-11691"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-11692"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-11693"></a><span class="c">!</span>
<a name="ln-11694"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-11695"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-11696"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-11697"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-11698"></a><span class="c">!</span>
<a name="ln-11699"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-11700"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-11701"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-11702"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-11703"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-11704"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-11705"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-11706"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-11707"></a><span class="c">!     permit others to do so.</span>
<a name="ln-11708"></a><span class="c">!</span>
<a name="ln-11709"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-11710"></a><span class="c">!</span>
<a name="ln-11711"></a>
<a name="ln-11712"></a><span class="k">END MODULE </span><span class="n">SurfaceGeometry</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
