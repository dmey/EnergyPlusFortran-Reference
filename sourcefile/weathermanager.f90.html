<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>WeatherManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>WeatherManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.7% of total for source files.">6259 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/WeatherManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">WeatherManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/weathermanager.html">WeatherManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/weathermanager.f90.html#src">WeatherManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~weathermanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileweathermanagerf90EfferentGraph" width="641pt" height="2449pt"
 viewBox="0.00 0.00 641.00 2448.68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~weathermanager.f90~~EfferentGraph" class="graph" transform="scale(.163 .163) rotate(0) translate(4 15016.4492)">
<title>sourcefile~~weathermanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-15016.4492 3927.9575,-15016.4492 3927.9575,4 -4,4"/>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~weathermanager.f90</title>
<polygon fill="none" stroke="#000000" points="3923.8969,-6989.1125 3814.1395,-6989.1125 3814.1395,-6967.1017 3923.8969,-6967.1017 3923.8969,-6989.1125"/>
<text text-anchor="middle" x="3869.0182" y="-6974.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">WeatherManager.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1113.1506,-10715.1125 998.8208,-10715.1125 998.8208,-10693.1017 1113.1506,-10693.1017 1113.1506,-10715.1125"/>
<text text-anchor="middle" x="1055.9857" y="-10700.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge802" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3555.9763,-14353.1071C3629.3415,-14352.0922 3674.0108,-14374.8316 3716.6309,-14315.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-11311.1071C1657.056,-11335.2111 1686.5958,-11301.4893 1710.019,-11330.1071 1790.7091,-11428.6915 1700.7029,-12357.0431 1746.019,-12476.1071 1749.7817,-12485.9932 2715.7105,-13637.0612 2722.5776,-13645.1071 2882.5901,-13832.5871 2901.2547,-13901.1362 3087.0454,-14063.1071 3179.4009,-14143.6219 3433.4639,-14354.8019 3555.9763,-14353.1071"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1486.4762,-8287.1125 1379.0248,-8287.1125 1379.0248,-8265.1017 1486.4762,-8265.1017 1486.4762,-8287.1125"/>
<text text-anchor="middle" x="1432.7505" y="-8272.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1059.8263,-10693.0967C1070.5729,-10661.7104 1100.9524,-10568.9075 1113.0681,-10489.1071 1141.7799,-10299.9958 1102.8449,-9814.7166 1149.0681,-9629.1071 1190.9787,-9460.8148 1275.7474,-9445.4382 1317.5017,-9277.1071 1365.6907,-9082.8346 1284.3708,-8564.9499 1353.5017,-8377.1071 1365.7476,-8343.8325 1393.3763,-8312.9108 1412.5408,-8294.2669"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1415.0601,-8296.7016 1419.9178,-8287.286 1410.2487,-8291.6173 1415.0601,-8296.7016"/>
</g>
<!-- sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~thermalcomfort.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/thermalcomfort.f90.html" xlink:title="ThermalComfort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3769.4933,-13756.1125 3663.7684,-13756.1125 3663.7684,-13734.1017 3769.4933,-13734.1017 3769.4933,-13756.1125"/>
<text text-anchor="middle" x="3716.6309" y="-13741.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ThermalComfort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge749" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1629.0092,-11311.1071C1656.9547,-11335.3285 1686.5443,-11301.5316 1710.019,-11330.1071 1782.5685,-11418.4207 1700.611,-12253.2223 1746.019,-12358.1071 1964.3937,-12862.5156 2429.7122,-12675.1692 2686.5776,-13161.1071 2729.1131,-13241.5756 2662.1967,-13501 2722.5776,-13569.1071 2973.7162,-13852.3806 3184.7064,-13671.1269 3555.9763,-13745.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1233.2849,-11199.1071C1234.1103,-11200.4645 1431.2354,-11310.6296 1432.7505,-11311.1071"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1301.6827,-8287.1125 1164.8872,-8287.1125 1164.8872,-8265.1017 1301.6827,-8265.1017 1301.6827,-8287.1125"/>
<text text-anchor="middle" x="1233.2849" y="-8272.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1058.5912,-10692.8278C1068.1066,-10651.0327 1101.0506,-10500.9121 1113.0681,-10375.1071 1133.432,-10161.9291 1098.7888,-8656.2694 1149.0681,-8448.1071 1163.3585,-8388.9431 1200.2755,-8326.4417 1220.1516,-8295.6295"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.1726,-8297.4051 1225.729,-8287.1233 1217.3188,-8293.5667 1223.1726,-8297.4051"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3619.3901,-12882.1125 3492.5626,-12882.1125 3492.5626,-12860.1017 3619.3901,-12860.1017 3619.3901,-12882.1125"/>
<text text-anchor="middle" x="3555.9763" y="-12867.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge736" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-11311.1071C1656.9081,-11335.382 1686.4869,-11301.5788 1710.019,-11330.1071 1775.2566,-11409.1952 1699.291,-12160.8528 1746.019,-12252.1071 1893.0772,-12539.2945 2054.4217,-12513.0784 2318.0427,-12699.1071 2476.5679,-12810.9731 2582.9482,-12769.0791 2686.5776,-12933.1071 2756.8898,-13044.3994 2678.08,-13103.213 2722.5776,-13227.1071 2776.7469,-13377.9299 2779.7504,-13447.5205 2916.4805,-13531.1071 2940.62,-13545.8642 3150.524,-13575.6457 3169.983,-13555.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3169.983,-13555.1071C3196.8054,-13527.6647 3229.0611,-13561.1611 3252.9207,-13531.1071 3299.9648,-13471.8493 3282.1653,-12926.4663 3288.9207,-12851.1071 3315.4395,-12555.2753 3308.9841,-11898.0356 3372.8452,-12188.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-11311.1071C1515.9421,-11337.3281 1563.0956,-11253.9775 1629.0092,-11311.1071"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1877.7734,-6461.1125 1752.1262,-6461.1125 1752.1262,-6439.1017 1877.7734,-6439.1017 1877.7734,-6461.1125"/>
<text text-anchor="middle" x="1814.9498" y="-6446.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.3373,-10693.0072C1068.7974,-10661.3853 1096.1171,-10568.0219 1113.0681,-10489.1071 1133.6915,-10393.096 1126.3427,-10366.6425 1149.0681,-10271.1071 1207.0509,-10027.353 1262.8911,-9977.6387 1317.5017,-9733.1071 1343.2162,-9617.9647 1290.4351,-9569.8148 1353.5017,-9470.1071 1454.6884,-9310.1318 1618.1417,-9402.6045 1710.019,-9237.1071 1754.8461,-9156.3607 1742.1942,-7667.3829 1746.019,-7575.1071 1764.5093,-7129.0215 1804.7956,-6584.4484 1813.338,-6471.2952"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1816.8384,-6471.4208 1814.1036,-6461.185 1809.8584,-6470.8921 1816.8384,-6471.4208"/>
</g>
<!-- sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~radiantsystemlowtemp.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/radiantsystemlowtemp.f90.html" xlink:title="RadiantSystemLowTemp.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2471.0077,-4177.1125 2325.7081,-4177.1125 2325.7081,-4155.1017 2471.0077,-4155.1017 2471.0077,-4177.1125"/>
<text text-anchor="middle" x="2398.3579" y="-4162.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RadiantSystemLowTemp.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2205.1267,-9681.1071C2216.856,-9625.9161 2263.7815,-9633.4939 2282.0427,-9580.1071 2320.9805,-9466.2727 2313.0912,-5369.3149 2318.0427,-5249.1071 2335.6919,-4820.6414 2385.3796,-4298.6263 2396.2426,-4187.524"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2399.753,-4187.5889 2397.2469,-4177.2948 2392.7865,-4186.9049 2399.753,-4187.5889"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1067.6901,-10692.9228C1113.9309,-10648.5052 1283.0472,-10483.7971 1317.5017,-10418.1071 1350.7538,-10354.7096 1306.0026,-10314.6681 1353.5017,-10261.1071 1403.1714,-10205.0985 1461.2486,-10259.1381 1511.9993,-10204.1071 1553.5151,-10159.0898 1503.9681,-10113.6675 1547.9993,-10071.1071 1601.1795,-10019.7032 1653.7565,-10081.1178 1710.019,-10033.1071 1742.1636,-10005.6771 1718.4709,-9977.1505 1746.019,-9945.1071 1804.4536,-9877.1376 2020.3374,-9791.6672 2092.2107,-9738.1071 2109.6148,-9725.1375 2109.3984,-9715.9334 2128.2107,-9705.1071 2159.2484,-9687.2453 2197.6824,-9716.1352 2205.1267,-9681.1071"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~exteriorenergyusemanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/exteriorenergyusemanager.f90.html" xlink:title="ExteriorEnergyUseManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1512.2488,-11703.1125 1353.2521,-11703.1125 1353.2521,-11681.1017 1512.2488,-11681.1017 1512.2488,-11703.1125"/>
<text text-anchor="middle" x="1432.7505" y="-11688.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ExteriorEnergyUseManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1233.2849,-11199.1071C1321.9333,-11339.6417 1285.3285,-11401.5785 1353.5017,-11553.1071 1373.3971,-11597.3286 1403.0078,-11645.8725 1419.8337,-11672.2826"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1417.0613,-11674.4425 1425.4126,-11680.9622 1422.9498,-11670.6575 1417.0613,-11674.4425"/>
</g>
<!-- sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~electricpowermanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/electricpowermanager.f90.html" xlink:title="ElectricPowerManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3050.8286,-12275.1125 2916.6973,-12275.1125 2916.6973,-12253.1017 3050.8286,-12253.1017 3050.8286,-12275.1125"/>
<text text-anchor="middle" x="2983.7629" y="-12260.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge623" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2600.6254,-12605.1071C2792.3117,-12646.035 2937.62,-12364.4751 2974.5889,-12284.74"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2977.9435,-12285.8191 2978.9076,-12275.2682 2971.5743,-12282.915 2977.9435,-12285.8191"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1629.0092,-11273.1071C1655.7265,-11299.4942 1686.9595,-11267.4701 1710.019,-11297.1071 1771.9536,-11376.7078 1690.7302,-12119.7548 1746.019,-12204.1071 1751.642,-12212.6859 2554.6942,-12604.6372 2600.6254,-12605.1071"/>
</g>
<!-- sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~ventilatedslab.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/ventilatedslab.f90.html" xlink:title="VentilatedSlab.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3421.0021,-7793.1125 3324.6884,-7793.1125 3324.6884,-7771.1017 3421.0021,-7771.1017 3421.0021,-7793.1125"/>
<text text-anchor="middle" x="3372.8452" y="-7778.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VentilatedSlab.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge693" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2983.7629,-11921.1071C3203.8276,-11943.8073 3359.3002,-8125.2733 3372.0042,-7803.6291"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3375.5138,-7803.4504 3372.4096,-7793.3206 3368.5192,-7803.1753 3375.5138,-7803.4504"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1432.7505,-10779.1071C1569.7716,-10792.2502 1631.8823,-10803.7838 1710.019,-10917.1071 1802.551,-11051.308 1665.7229,-11140.246 1746.019,-11282.1071 1902.0323,-11557.7394 2053.4985,-11532.9529 2318.0427,-11707.1071 2402.4173,-11762.6524 2420.4096,-11784.7925 2514.6731,-11821.1071 2527.1055,-11825.8966 2972.7252,-11928.5686 2983.7629,-11921.1071"/>
</g>
<!-- sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~pollutionanalysismodule.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/pollutionanalysismodule.f90.html" xlink:title="PollutionAnalysisModule.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1305.1122,-4633.1125 1161.4576,-4633.1125 1161.4576,-4611.1017 1305.1122,-4611.1017 1305.1122,-4633.1125"/>
<text text-anchor="middle" x="1233.2849" y="-4618.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PollutionAnalysisModule.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge703" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1058.1289,-10692.8925C1067.0793,-10645.4329 1101.5405,-10456.3216 1113.0681,-10299.1071 1118.8128,-10220.7603 1100.5076,-4704.8574 1149.0681,-4643.1071 1150.3605,-4641.4636 1151.7603,-4639.9366 1153.2519,-4638.5183"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1155.5784,-4641.1455 1161.4039,-4632.296 1151.3313,-4635.5812 1155.5784,-4641.1455"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1688.3447,-5623.1125 1569.6736,-5623.1125 1569.6736,-5601.1017 1688.3447,-5601.1017 1688.3447,-5623.1125"/>
<text text-anchor="middle" x="1629.0092" y="-5608.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1059.7901,-10693.0911C1070.4415,-10661.6902 1100.5947,-10568.8524 1113.0681,-10489.1071 1125.2407,-10411.285 1111.7549,-9850.4769 1149.0681,-9781.1071 1193.103,-9699.2408 1274.3303,-9739.432 1317.5017,-9657.1071 1379.9163,-9538.0867 1298.9417,-8570.9267 1353.5017,-8448.1071 1393.1253,-8358.9108 1473.1008,-8385.622 1511.9993,-8296.1071 1570.8786,-8160.6114 1459.476,-5755.3843 1547.9993,-5637.1071 1551.4168,-5632.5409 1555.6558,-5628.7842 1560.3894,-5625.6966"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.2466,-5628.6712 1569.3731,-5620.8313 1558.9131,-5622.5159 1562.2466,-5628.6712"/>
</g>
<!-- sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~poweredinductionunits.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/poweredinductionunits.f90.html" xlink:title="PoweredInductionUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3238.9763,-5321.1125 3100.9897,-5321.1125 3100.9897,-5299.1017 3238.9763,-5299.1017 3238.9763,-5321.1125"/>
<text text-anchor="middle" x="3169.983" y="-5306.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PoweredInductionUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge469" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-10779.1071C1669.9951,-10798.4921 1688.009,-10801.469 1710.019,-10841.1071 1790.8707,-10986.7137 1663.8151,-11069.2597 1746.019,-11214.1071 1793.3798,-11297.5591 1836.2805,-11295.0083 1919.8806,-11342.1071 2217.2955,-11509.6655 2458.5457,-11642.1403 2686.5776,-11388.1071 2749.0867,-11318.4705 2686.3973,-9790.4067 2722.5776,-9704.1071 2761.4517,-9611.3822 2811.7936,-9615.532 2880.4805,-9542.1071 2958.0039,-9459.236 3009.9782,-9457.8946 3051.0454,-9352.1071 3091.0562,-9249.0408 3037.0773,-5470.7312 3087.0454,-5372.1071 3097.2854,-5351.8959 3117.5444,-5336.5582 3135.4757,-5326.194"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3137.4738,-5329.0909 3144.575,-5321.2281 3134.1204,-5322.9464 3137.4738,-5329.0909"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node60"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2665.9148,-8226.1125 2535.336,-8226.1125 2535.336,-8204.1017 2665.9148,-8204.1017 2665.9148,-8226.1125"/>
<text text-anchor="middle" x="2600.6254" y="-8211.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-10779.1071C1519.578,-10787.4356 1550.8537,-10740.3758 1629.0092,-10779.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-10629.1071C1841.4093,-10610.3392 1855.2882,-10620.4307 1883.8806,-10605.1071 2079.6442,-10500.191 2180.9635,-10500.8791 2282.0427,-10303.1071 2360.947,-10148.7227 2236.7014,-8896.2216 2318.0427,-8743.1071 2359.1138,-8665.7961 2432.2734,-8703.3425 2478.6731,-8629.1071 2530.7216,-8545.834 2486.7364,-8505.2506 2514.6731,-8411.1071 2534.4915,-8344.3211 2571.3848,-8270.2283 2589.7115,-8235.3553"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.9639,-8236.6931 2594.5616,-8226.2194 2586.7811,-8233.4107 2592.9639,-8236.6931"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-10779.1071C1724.1461,-10826.2539 1720.747,-10678.0937 1814.9498,-10629.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-10779.1071C1321.439,-10788.4836 1344.5042,-10770.6425 1432.7505,-10779.1071"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~hvacheatingcoils.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node61"><a xlink:href="../sourcefile/hvacheatingcoils.f90.html" xlink:title="HVACHeatingCoils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3042.7047,-6995.1125 2924.8212,-6995.1125 2924.8212,-6973.1017 3042.7047,-6973.1017 3042.7047,-6995.1125"/>
<text text-anchor="middle" x="2983.7629" y="-6980.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHeatingCoils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1629.0092,-10779.1071C1669.8234,-10798.851 1685.6985,-10802.843 1710.019,-10841.1071 1750.2815,-10904.4531 1705.9782,-10942.6208 1746.019,-11006.1071 1798.2083,-11088.855 1830.7293,-11100.8209 1919.8806,-11141.1071 2076.3287,-11211.8038 2564.0501,-11356.3612 2686.5776,-11236.1071 2762.798,-11161.301 2664.9045,-9403.992 2722.5776,-9314.1071 2764.6376,-9248.5556 2838.3321,-9303.6018 2880.4805,-9238.1071 2931.0006,-9159.6034 2910.039,-7651.2394 2916.4805,-7558.1071 2931.4615,-7341.508 2969.1894,-7080.9608 2980.5053,-7005.522"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2984.0016,-7005.8087 2982.0325,-6995.3985 2977.0799,-7004.7645 2984.0016,-7005.8087"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node63" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node63"><a xlink:href="../sourcefile/hvacwatercoilcomponent.f90.html" xlink:title="HVACWaterCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2880.4319,-5822.1125 2722.6262,-5822.1125 2722.6262,-5800.1017 2880.4319,-5800.1017 2880.4319,-5822.1125"/>
<text text-anchor="middle" x="2801.5291" y="-5807.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWaterCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge423" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1629.0092,-10779.1071C1685.0764,-10806.7241 1690.4191,-10828.5609 1746.019,-10857.1071 1804.275,-10887.0169 1838.8616,-10861.5504 1883.8806,-10909.1071 1920.4077,-10947.6932 1879.2764,-10988.8375 1919.8806,-11023.1071 2001.9062,-11092.3359 2297.3559,-11125.4307 2398.3579,-11089.1071"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node64" class="node">
<title>sourcefile~hvacsteamcoilcomponent.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node64"><a xlink:href="../sourcefile/hvacsteamcoilcomponent.f90.html" xlink:title="HVACSteamCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2478.4887,-5480.1125 2318.2271,-5480.1125 2318.2271,-5458.1017 2478.4887,-5458.1017 2478.4887,-5480.1125"/>
<text text-anchor="middle" x="2398.3579" y="-5465.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSteamCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge434" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1233.2849,-10627.1071C1269.758,-10598.2973 1290.3106,-10602.8024 1317.5017,-10565.1071 1347.8426,-10523.0452 1315.7368,-10489.6541 1353.5017,-10454.1071 1406.4846,-10404.236 1455.9178,-10459.4664 1511.9993,-10413.1071 1540.8066,-10389.2938 1524.8723,-10366.4684 1547.9993,-10337.1071 1613.6993,-10253.6963 1834.1873,-10099.8009 1919.8806,-10037.1071 1993.9962,-9982.8836 2021.8798,-9982.1569 2092.2107,-9923.1071 2110.0279,-9908.1478 2110.7986,-9900.5361 2128.2107,-9885.1071 2191.9009,-9828.6704 2243.4163,-9846.9328 2282.0427,-9771.1071 2331.067,-9674.8698 2307.2131,-5990.5674 2318.0427,-5883.1071 2333.4199,-5730.5217 2377.4024,-5550.4689 2392.885,-5490.0492"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2396.3186,-5490.7509 2395.431,-5480.1933 2389.5411,-5489.0001 2396.3186,-5490.7509"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node65" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node65"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2444.992,-8246.1125 2351.7238,-8246.1125 2351.7238,-8224.1017 2444.992,-8224.1017 2444.992,-8246.1125"/>
<text text-anchor="middle" x="2398.3579" y="-8231.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-10703.1071C1269.7485,-10689.4995 1282.3864,-10695.8902 1317.5017,-10679.1071 1435.8106,-10622.5623 2220.3003,-10114.7885 2282.0427,-9999.1071 2321.6061,-9924.9806 2304.1447,-8569.9735 2318.0427,-8487.1071 2332.9179,-8398.4142 2372.0407,-8297.9353 2389.6037,-8255.6155"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2392.8402,-8256.9481 2393.4827,-8246.3728 2386.3855,-8254.2392 2392.8402,-8256.9481"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node72" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node72"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2454.1645,-5280.1125 2342.5513,-5280.1125 2342.5513,-5258.1017 2454.1645,-5258.1017 2454.1645,-5280.1125"/>
<text text-anchor="middle" x="2398.3579" y="-5265.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1233.2849,-10627.1071C1269.7062,-10598.2318 1292.5458,-10604.318 1317.5017,-10565.1071 1361.3067,-10496.2803 1310.7089,-10454.5677 1353.5017,-10385.1071 1400.415,-10308.9583 1455.5841,-10330.5105 1511.9993,-10261.1071 1534.8171,-10233.036 1524.559,-10215.6606 1547.9993,-10188.1071 1552.1088,-10183.2764 1914.368,-9926.2432 1919.8806,-9923.1071 1992.639,-9881.7144 2032.7982,-9906.0758 2092.2107,-9847.1071 2119.8837,-9819.6408 2102.5641,-9796.4746 2128.2107,-9767.1071 2154.7161,-9736.7561 2186.4816,-9754.8293 2205.1267,-9719.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1085.133,-10692.9929C1094.3119,-10689.0613 1104.3294,-10684.3089 1113.0681,-10679.1071 1130.4857,-10668.7393 1130.9901,-10660.2749 1149.0681,-10651.1071 1183.7796,-10633.504 1202.3618,-10650.7402 1233.2849,-10627.1071"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node73" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node73"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2832.7171,-7850.1125 2770.341,-7850.1125 2770.341,-7828.1017 2832.7171,-7828.1017 2832.7171,-7850.1125"/>
<text text-anchor="middle" x="2801.5291" y="-7835.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1629.0092,-10779.1071C1669.6334,-10799.2391 1680.7338,-10806.495 1710.019,-10841.1071 1732.107,-10867.2127 1726.3175,-10881.1565 1746.019,-10909.1071 1811.9647,-11002.6644 1818.5326,-11045.9058 1919.8806,-11099.1071 2109.954,-11198.8836 2185.476,-11137.4565 2398.3579,-11165.1071"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node74" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node74"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1282.2844,-7301.1125 1184.2854,-7301.1125 1184.2854,-7279.1017 1282.2844,-7279.1017 1282.2844,-7301.1125"/>
<text text-anchor="middle" x="1233.2849" y="-7286.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1058.0971,-10692.8901C1066.9198,-10645.4209 1100.9398,-10456.2764 1113.0681,-10299.1071 1157.0127,-9729.633 1091.0402,-8297.3189 1149.0681,-7729.1071 1165.6915,-7566.3306 1212.0582,-7373.8996 1227.8994,-7311.0741"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1231.3393,-7311.7478 1230.4096,-7301.1938 1224.5549,-7310.0241 1231.3393,-7311.7478"/>
</g>
<!-- sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node76" class="node">
<title>sourcefile~setpointmanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node76"><a xlink:href="../sourcefile/setpointmanager.f90.html" xlink:title="SetPointManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2655.6989,-6242.1125 2545.5519,-6242.1125 2545.5519,-6220.1017 2655.6989,-6220.1017 2655.6989,-6242.1125"/>
<text text-anchor="middle" x="2600.6254" y="-6227.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SetPointManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge399" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1072.6718,-10715.1525C1103.0617,-10734.3308 1170.1396,-10772.3906 1233.2849,-10779.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-10779.1071C1372.4164,-10793.9059 2222.4741,-10208.7094 2282.0427,-10082.1071 2352.1221,-9933.1661 2273.2358,-8759.4955 2318.0427,-8601.1071 2356.6772,-8464.5377 2440.4423,-8461.7901 2478.6731,-8325.1071 2537.255,-8115.6644 2452.6184,-6576.5473 2514.6731,-6368.1071 2528.5765,-6321.4061 2563.1277,-6275.0654 2583.944,-6250.057"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.8678,-6252.0214 2590.6778,-6242.1353 2581.5343,-6247.4877 2586.8678,-6252.0214"/>
</g>
<!-- sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node77" class="node">
<title>sourcefile~electricpowergenerators.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node77"><a xlink:href="../sourcefile/electricpowergenerators.f90.html" xlink:title="ElectricPowerGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2471.5817,-7865.1125 2325.1341,-7865.1125 2325.1341,-7843.1017 2471.5817,-7843.1017 2471.5817,-7865.1125"/>
<text text-anchor="middle" x="2398.3579" y="-7850.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge514" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1113.1098,-10713.1115C1148.6807,-10716.4728 1194.8248,-10716.6822 1233.2849,-10703.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-10703.1071C1269.9857,-10690.153 1289.6624,-10706.3051 1317.5017,-10679.1071 1356.1143,-10641.3839 1320.9002,-10606.1317 1353.5017,-10563.1071 1415.706,-10481.0152 1460.9488,-10492.1587 1547.9993,-10437.1071 1619.5178,-10391.878 1638.4426,-10382.2445 1710.019,-10337.1071 1787.7677,-10288.0774 1811.9367,-10282.3158 1883.8806,-10225.1071 1901.3469,-10211.2182 1903.5327,-10205.2966 1919.8806,-10190.1071 1994.9133,-10120.3913 2036.4834,-10123.0412 2092.2107,-10037.1071 2121.1202,-9992.5274 2089.4626,-9959.4622 2128.2107,-9923.1071 2179.5692,-9874.9204 2238.0296,-9940.0844 2282.0427,-9885.1071 2340.0391,-9812.6631 2306.912,-8307.2365 2318.0427,-8215.1071 2333.9263,-8083.6383 2376.3484,-7929.6857 2392.2368,-7874.8138"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.6017,-7875.7767 2395.045,-7865.1965 2388.8823,-7873.8147 2395.6017,-7875.7767"/>
</g>
<!-- sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node78" class="node">
<title>sourcefile~photovoltaics.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node78"><a xlink:href="../sourcefile/photovoltaics.f90.html" xlink:title="Photovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2847.4941,-12275.1125 2755.564,-12275.1125 2755.564,-12253.1017 2847.4941,-12253.1017 2847.4941,-12275.1125"/>
<text text-anchor="middle" x="2801.5291" y="-12260.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Photovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge596" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2600.6254,-12472.1071C2685.3292,-12420.9541 2758.6906,-12325.2759 2787.967,-12283.9527"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2790.9784,-12285.7537 2793.8389,-12275.5523 2785.2411,-12281.7433 2790.9784,-12285.7537"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1629.0092,-11273.1071C1653.013,-11301.9846 1686.9231,-11267.4985 1710.019,-11297.1071 1768.4325,-11371.9922 1695.5005,-12070.6846 1746.019,-12151.1071 1792.6327,-12225.3132 1839.4134,-12209.4026 1919.8806,-12244.1071 1938.1922,-12252.0046 2583.5547,-12482.4161 2600.6254,-12472.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1233.2849,-11199.1071C1281.0151,-11274.7739 1571.7096,-11204.4019 1629.0092,-11273.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1071.0937,-10715.299C1084.6734,-10726.3106 1103.8548,-10744.4417 1113.0681,-10765.1071 1150.7617,-10849.6537 1088.1889,-11110.3743 1149.0681,-11180.1071 1174.3031,-11209.0119 1213.3495,-11166.3219 1233.2849,-11199.1071"/>
</g>
<!-- sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node79" class="node">
<title>sourcefile~windturbine.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node79"><a xlink:href="../sourcefile/windturbine.f90.html" xlink:title="WindTurbine.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1673.1629,-11361.1125 1584.8554,-11361.1125 1584.8554,-11339.1017 1673.1629,-11339.1017 1673.1629,-11361.1125"/>
<text text-anchor="middle" x="1629.0092" y="-11346.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindTurbine.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge612" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1432.7505,-11311.1071C1479.6881,-11325.9013 1534.7785,-11336.2649 1574.6242,-11342.5711"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1574.2499,-11346.0548 1584.6677,-11344.126 1575.3209,-11339.1372 1574.2499,-11346.0548"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node81" class="node">
<title>sourcefile~photovoltaicthermalcollectors.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node81"><a xlink:href="../sourcefile/photovoltaicthermalcollectors.f90.html" xlink:title="PhotovoltaicThermalCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2686.5299,-9311.1125 2514.7208,-9311.1125 2514.7208,-9289.1017 2686.5299,-9289.1017 2686.5299,-9311.1125"/>
<text text-anchor="middle" x="2600.6254" y="-9296.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PhotovoltaicThermalCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge564" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-10555.1071C2528.9423,-10332.458 2589.7627,-9468.8857 2599.2846,-9321.5446"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2602.8022,-9321.3794 2599.9457,-9311.1769 2595.8164,-9320.9339 2602.8022,-9321.3794"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-10629.1071C1840.1108,-10608.2663 2381.8292,-10583.2889 2398.3579,-10555.1071"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node82" class="node">
<title>sourcefile~hvactranspiredcollector.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node82"><a xlink:href="../sourcefile/hvactranspiredcollector.f90.html" xlink:title="HVACTranspiredCollector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2674.6978,-10328.1125 2526.553,-10328.1125 2526.553,-10306.1017 2674.6978,-10306.1017 2674.6978,-10328.1125"/>
<text text-anchor="middle" x="2600.6254" y="-10313.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACTranspiredCollector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge574" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1629.0092,-10779.1071C1889.5544,-10907.1193 2009.342,-10865.6324 2282.0427,-10766.1071 2387.619,-10727.5758 2411.1554,-10696.9535 2478.6731,-10607.1071 2545.1607,-10518.6314 2582.8,-10388.5272 2595.6037,-10338.1267"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2599.014,-10338.916 2598.0226,-10328.3676 2592.2195,-10337.2319 2599.014,-10338.916"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node84" class="node">
<title>sourcefile~heatbalanceconvectioncoeffs.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node84"><a xlink:href="../sourcefile/heatbalanceconvectioncoeffs.f90.html" xlink:title="HeatBalanceConvectionCoeffs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2092.376,-9729.1125 1919.7153,-9729.1125 1919.7153,-9707.1017 2092.376,-9707.1017 2092.376,-9729.1125"/>
<text text-anchor="middle" x="2006.0457" y="-9714.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceConvectionCoeffs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge528" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1061.7723,-10692.9824C1075.949,-10665.8983 1113.8344,-10594.5421 1149.0681,-10537.1071 1234.2074,-10398.3204 1233.0404,-10342.6494 1353.5017,-10233.1071 1412.7963,-10179.1872 1462.7995,-10210.3731 1511.9993,-10147.1071 1551.9679,-10095.7114 1515.0953,-10061.2884 1547.9993,-10005.1071 1568.5364,-9970.0412 1783.7243,-9781.114 1814.9498,-9755.1071"/>
</g>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node87" class="node">
<title>sourcefile~heatrecovery.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node87"><a xlink:href="../sourcefile/heatrecovery.f90.html" xlink:title="HeatRecovery.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3031.5302,-7850.1125 2935.9957,-7850.1125 2935.9957,-7828.1017 3031.5302,-7828.1017 3031.5302,-7850.1125"/>
<text text-anchor="middle" x="2983.7629" y="-7835.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatRecovery.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge642" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-10779.1071C1669.7162,-10799.0712 1687.519,-10801.745 1710.019,-10841.1071 1775.7863,-10956.1616 1677.3412,-11023.7659 1746.019,-11137.1071 1842.7799,-11296.7946 1945.2186,-11259.9721 2092.2107,-11375.1071 2109.0636,-11388.3075 2108.2008,-11399.4994 2128.2107,-11407.1071 2287.3511,-11467.6122 2669.4622,-11333.2497 2686.5776,-11312.1071 2746.784,-11237.7344 2697.0288,-9682.3208 2722.5776,-9590.1071 2760.3113,-9453.9147 2839.4214,-9449.3342 2880.4805,-9314.1071 2968.2474,-9025.0491 2981.9324,-8020.7513 2983.5686,-7860.6881"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2987.0723,-7860.3154 2983.6698,-7850.2819 2980.0727,-7860.2473 2987.0723,-7860.3154"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge803" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.1202,-8265.0297C1443.1277,-8191.6063 1494.062,-7767.3888 1511.9993,-7420.1071 1587.7717,-5953.0866 1492.3462,-5583.0285 1547.9993,-4115.1071 1560.8527,-3776.0809 1601.5912,-1375.0999 1746.019,-1068.1071 1831.5284,-886.3502 2437.8735,-178.7827 2801.5291,-211.1071"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge715" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.1066,-8265.029C1443.0262,-8191.601 1493.4973,-7767.3592 1511.9993,-7420.1071 1572.1868,-6290.4851 1477.4014,-6004.1263 1547.9993,-4875.1071 1548.7284,-4863.4472 1913.149,-1540.6554 1919.8806,-1531.1071 2039.3421,-1361.661 2942.0605,-1176.4843 3169.983,-1066.1071"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1434.0812,-8265.0276C1442.8377,-8191.5907 1492.4481,-7767.3017 1511.9993,-7420.1071 1514.7844,-7370.6476 1518.1845,-5676.6682 1547.9993,-5637.1071 1551.432,-5632.5523 1555.6816,-5628.8035 1560.4221,-5625.7212"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.2806,-5628.6954 1569.4149,-5620.8627 1558.9532,-5622.5368 1562.2806,-5628.6954"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1486.6519,-8271.2564C1599.2332,-8261.0232 1867.5347,-8236.1041 2092.2107,-8211.1071 2142.4697,-8205.5154 2154.7957,-8192.2051 2205.1267,-8197.1071"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node67" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node67"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1710.0289,-9043.1125 1547.9894,-9043.1125 1547.9894,-9021.1017 1710.0289,-9021.1017 1710.0289,-9043.1125"/>
<text text-anchor="middle" x="1629.0092" y="-9028.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1439.4169,-8287.3104C1454.995,-8314.0662 1493.8366,-8384.2248 1511.9993,-8448.1071 1547.8798,-8574.307 1522.3346,-8612.4403 1547.9993,-8741.1071 1568.5084,-8843.9271 1606.392,-8963.6319 1622.0039,-9011.1383"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1618.764,-9012.4889 1625.2279,-9020.8835 1625.4098,-9010.2902 1618.764,-9012.4889"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="781.2037,-10524.1125 714.4662,-10524.1125 714.4662,-10502.1017 781.2037,-10502.1017 781.2037,-10524.1125"/>
<text text-anchor="middle" x="747.835" y="-10509.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge804" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.6351,-10524.1769C756.8569,-10568.6716 784.3422,-10738.8291 805.1968,-10879.1071 822.0924,-10992.7553 778.6008,-11038.7581 841.1968,-11135.1071 875.9397,-11188.5841 924.8975,-11159.8976 962.9033,-11211.1071 999.3992,-11260.2821 967.1162,-11291.765 998.9033,-11344.1071 1034.6867,-11403.0296 1074.7361,-11391.8098 1113.0681,-11449.1071 1138.8693,-11487.6738 1114.5394,-11516.1095 1149.0681,-11547.1071 1206.4791,-11598.6469 1244.3609,-11564.5554 1317.5017,-11589.1071 1406.6012,-11619.0158 1457.4699,-11595.5578 1511.9993,-11672.1071 1577.9177,-11764.6447 1528.1269,-12070.2432 1547.9993,-12182.1071 1593.3922,-12437.6298 1652.5854,-12490.0187 1710.019,-12743.1071 1731.5573,-12838.0181 1713.5996,-12867.3412 1746.019,-12959.1071 1918.2502,-13446.622 1950.2912,-13608.6609 2318.0427,-13972.1071 2727.4863,-14376.7573 2980.3434,-14358.8135 3555.9763,-14353.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-10627.1071C941.5657,-10651.2506 989.6489,-10674.3799 1021.4467,-10688.8757"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1020.2107,-10692.158 1030.7646,-10693.0888 1023.0947,-10685.7797 1020.2107,-10692.158"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M902.05,-9301.1071C918.3957,-9266.127 944.8436,-9273.2339 962.9033,-9239.1071 1001.0634,-9166.9974 966.7095,-9134.0708 998.9033,-9059.1071 1033.6614,-8978.1725 1073.0933,-8975.5963 1113.0681,-8897.1071 1188.2853,-8749.4208 1146.6797,-8685.4167 1233.2849,-8544.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M747.9701,-10501.948C749.1428,-10420.136 759.636,-9904.7131 841.1968,-9496.1071 858.9683,-9407.0747 864.3833,-9383.7134 902.05,-9301.1071"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1482.2994,-8479.1125 1383.2016,-8479.1125 1383.2016,-8457.1017 1482.2994,-8457.1017 1482.2994,-8479.1125"/>
<text text-anchor="middle" x="1432.7505" y="-8464.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M902.05,-9301.1071C919.1615,-9266.4952 935.9698,-9266.7725 962.9033,-9239.1071 1083.5784,-9115.1528 1122.8176,-9092.2391 1233.2849,-8959.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge750" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1432.7505,-11539.1071C1463.0695,-11558.0818 1486.7724,-11527.7519 1511.9993,-11553.1071 1578.7884,-11620.2362 1494.3091,-11685.1041 1547.9993,-11763.1071 1595.4557,-11832.0535 1667.2854,-11787.1381 1710.019,-11859.1071 1767.1245,-11955.2801 1702.9745,-12761.8722 1746.019,-12865.1071 1794.0166,-12980.221 2416.3695,-13606.3518 2514.6731,-13683.1071 2646.1428,-13785.7585 3005.8383,-14019.4747 3169.983,-14049.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3169.983,-14049.1071C3296.8117,-14065.6759 3341.7693,-14081.0973 3456.7698,-14025.1071 3580.2661,-13964.9805 3674.0232,-13818.8771 3705.3301,-13765.2647"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3708.4927,-13766.786 3710.4422,-13756.372 3702.424,-13763.2973 3708.4927,-13766.786"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M902.05,-11121.1071C957.6208,-11214.6213 1049.7568,-11156.6499 1113.0681,-11245.1071 1159.2838,-11309.6787 1098.6615,-11358.7511 1149.0681,-11420.1071 1235.8599,-11525.752 1315.6663,-11468.5028 1432.7505,-11539.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M748.4464,-10524.3381C752.3235,-10587.609 777.4975,-10904.434 902.05,-11121.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="957.1881,-3717.1125 846.912,-3717.1125 846.912,-3695.1017 957.1881,-3695.1017 957.1881,-3717.1125"/>
<text text-anchor="middle" x="902.05" y="-3702.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge778" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M748.6619,-10502.0845C754.6842,-10421.2457 791.9356,-9911.4768 805.1968,-9496.1071 873.3866,-7360.2466 767.0841,-6823.7703 841.1968,-4688.1071 854.5867,-4302.2558 891.77,-3832.2428 900.2935,-3727.4715"/>
<polygon fill="#0000ff" stroke="#0000ff" points="903.8024,-3727.504 901.1284,-3717.2522 896.8256,-3726.9339 903.8024,-3727.504"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1111.8025,-6292.1125 1000.1689,-6292.1125 1000.1689,-6270.1017 1111.8025,-6270.1017 1111.8025,-6292.1125"/>
<text text-anchor="middle" x="1055.9857" y="-6277.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge789" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M748.6079,-10502.0826C754.2453,-10421.2302 789.2602,-9911.3828 805.1968,-9496.1071 820.2577,-9103.6478 799.0931,-8119.5919 841.1968,-7729.1071 871.2074,-7450.778 920.2213,-7387.7765 962.9033,-7111.1071 1012.2962,-6790.9374 1046.3725,-6397.4381 1054.2464,-6302.4603"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1057.7437,-6302.636 1055.076,-6292.3825 1050.7673,-6302.0616 1057.7437,-6302.636"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M902.05,-9225.1071C911.3661,-9187.6371 946.1454,-9197.8916 962.9033,-9163.1071 1020.0392,-9044.51 957.4597,-8994.0559 998.9033,-8869.1071 1015.0144,-8820.5337 1038.4837,-8817.1968 1055.9857,-8769.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M748.4641,-10501.9499C755.218,-10382.6546 814.594,-9345.7255 841.1968,-9287.1071 857.1532,-9251.9477 892.734,-9262.5771 902.05,-9225.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge738" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11121.1071C921.2371,-11154.613 939.9163,-11152.0848 962.9033,-11183.1071 982.796,-11209.9534 981.2505,-11220.7377 998.9033,-11249.1071 1045.4388,-11323.8934 1072.6601,-11332.8401 1113.0681,-11411.1071 1135.1222,-11453.824 1113.3954,-11480.8803 1149.0681,-11513.1071 1210.6486,-11568.739 1456.3005,-11539.5871 1511.9993,-11601.1071 1550.8522,-11644.0206 1536.6394,-11802.3439 1547.9993,-11859.1071 1603.7205,-12137.5352 1660.7327,-12197.4682 1710.019,-12477.1071 1725.0493,-12562.3853 1703.0418,-12789.9325 1746.019,-12865.1071 1878.7959,-13097.3566 2467.9938,-13486.9087 2722.5776,-13569.1071 2761.5796,-13581.6998 3158.1697,-13567.1936 3169.983,-13555.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-9567.1071C1126.4124,-9541.0508 1259.6001,-9400.9218 1317.5017,-9353.1071 1333.5611,-9339.8454 1335.1684,-9332.9898 1353.5017,-9323.1071 1418.2908,-9288.1822 1446.631,-9308.9355 1511.9993,-9275.1071 1530.0013,-9265.791 1529.9692,-9256.3688 1547.9993,-9247.1071 1581.4013,-9229.9491 1604.1569,-9251.2578 1629.0092,-9223.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1055.9857,-9871.1071C1168.2099,-9903.1816 1201.5513,-9860.469 1317.5017,-9847.1071 1368.8747,-9841.187 1383.0248,-9845.305 1432.7505,-9831.1071"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1432.7505,-9831.1071C1486.6919,-9816.6913 1495.7987,-9800.9209 1547.9993,-9781.1071 1691.6452,-9726.5835 2089.3572,-9667.1239 2205.1267,-9566.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M749.7635,-10524.1589C757.4742,-10568.5848 786.5679,-10738.5162 805.1968,-10879.1071 824.6927,-11026.2416 786.6737,-11073.0641 841.1968,-11211.1071 874.279,-11294.8656 914.1679,-11297.3788 962.9033,-11373.1071 980.9857,-11401.2047 974.1103,-11416.7074 998.9033,-11439.1071 1019.3244,-11457.5569 1032.9713,-11448.0158 1055.9857,-11463.1071"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1055.9857,-11463.1071C1113.2676,-11502.6831 1093.2818,-11547.4495 1149.0681,-11589.1071 1213.2947,-11637.0673 1302.0661,-11664.4892 1363.1105,-11678.7925"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1362.5104,-11682.2455 1373.0388,-11681.0606 1364.0694,-11675.4213 1362.5104,-11682.2455"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~zoneplenumcomponent.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/zoneplenumcomponent.f90.html" xlink:title="ZonePlenumComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3444.6776,-3742.1125 3301.0128,-3742.1125 3301.0128,-3720.1017 3444.6776,-3720.1017 3444.6776,-3742.1125"/>
<text text-anchor="middle" x="3372.8452" y="-3727.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZonePlenumComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge483" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M902.05,-10627.1071C982.2403,-10680.1542 975.3684,-10726.7113 1055.9857,-10779.1071"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1055.9857,-10779.1071C1068.406,-10787.1795 1303.2773,-10826.9726 1317.5017,-10831.1071 1497.1426,-10883.3225 1600.0439,-10831.7705 1710.019,-10983.1071 1794.8021,-11099.7769 1655.4827,-11518.8432 1746.019,-11631.1071 1785.9172,-11680.5804 1829.3899,-11636.3927 1883.8806,-11669.1071 1903.8265,-11681.0819 1898.5093,-11697.9146 1919.8806,-11707.1071 2115.3159,-11791.17 2198.7803,-11619.4165 2398.3579,-11693.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge626" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M749.2509,-10524.397C755.2408,-10569.6655 781.011,-10741.7195 841.1968,-10869.1071 892.2811,-10977.2307 917.4826,-10999.5229 998.9033,-11087.1071 1044.0411,-11135.6618 1079.1721,-11126.133 1113.0681,-11183.1071 1153.8907,-11251.7237 1099.3756,-11296.6142 1149.0681,-11359.1071 1259.4638,-11497.9398 1370.2037,-11418.5438 1511.9993,-11525.1071 1619.831,-11606.1456 1660.6696,-11629.57 1710.019,-11755.1071 1748.2584,-11852.3819 1680.2424,-12613.8785 1746.019,-12695.1071 1827.2034,-12795.3629 2782.6327,-13026.1781 2880.4805,-12942.1071 2931.8876,-12897.938 2973.5533,-12395.9919 2982.1393,-12285.524"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2985.6481,-12285.5434 2982.9256,-12275.3044 2978.6687,-12285.0064 2985.6481,-12285.5434"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge695" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1055.9857,-10779.1071C1077.0082,-10794.6121 1090.4835,-10779.9814 1113.0681,-10793.1071 1133.1823,-10804.797 1130.6973,-10816.8331 1149.0681,-10831.1071 1231.2168,-10894.936 1256.6121,-10907.2265 1353.5017,-10945.1071 1391.4535,-10959.945 1683.9166,-10999.8155 1710.019,-11031.1071 1800.9811,-11140.1522 1675.0421,-11546.1144 1746.019,-11669.1071 1792.2037,-11749.1385 1833.4857,-11750.3357 1919.8806,-11783.1071 2365.6839,-11952.2096 2604.0058,-12209.4137 2983.7629,-11921.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M902.05,-9225.1071C918.2236,-9160.0558 943.0118,-9151.1195 962.9033,-9087.1071 988.4078,-9005.0316 958.7059,-8973.0744 998.9033,-8897.1071 1032.4399,-8833.7277 1082.0994,-8847.78 1113.0681,-8783.1071 1177.7418,-8648.0471 1081.0039,-8581.4906 1149.0681,-8448.1071 1194.9007,-8358.2903 1275.791,-8387.9107 1317.5017,-8296.1071 1368.2959,-8184.3112 1311.4657,-6201.4819 1353.5017,-6086.1071 1391.7345,-5981.1708 1467.3121,-5993.4616 1511.9993,-5891.1071 1557.6198,-5786.6147 1474.0143,-5723.8603 1547.9993,-5637.1071 1551.4913,-5633.0124 1555.6383,-5629.5774 1560.182,-5626.6971"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.163,-5629.6074 1569.3407,-5621.8144 1558.8698,-5623.4304 1562.163,-5629.6074"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1506.0051,-7411.1125 1359.4959,-7411.1125 1359.4959,-7389.1017 1506.0051,-7389.1017 1506.0051,-7411.1125"/>
<text text-anchor="middle" x="1432.7505" y="-7396.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M748.2433,-10501.9596C752.3777,-10390.6703 787.6256,-9478.0138 841.1968,-9211.1071 878.4775,-9025.3642 1076.8519,-8589.0605 1113.0681,-8403.1071 1138.5181,-8272.4329 1085.4577,-7922.0565 1149.0681,-7805.1071 1171.2761,-7764.277 1207.781,-7781.9638 1233.2849,-7743.1071"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1482.8778,-6117.1125 1382.6232,-6117.1125 1382.6232,-6095.1017 1482.8778,-6095.1017 1482.8778,-6117.1125"/>
<text text-anchor="middle" x="1432.7505" y="-6102.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M748.4625,-10502.0758C753.0636,-10421.1746 782.0572,-9911.0437 805.1968,-9496.1071 821.3809,-9205.8951 790.1248,-9129.248 841.1968,-8843.1071 873.5491,-8661.8469 909.7121,-8623.3814 962.9033,-8447.1071 1030.7944,-8222.1179 1059.8414,-8169.0094 1113.0681,-7940.1071 1134.6145,-7847.4463 1123.1797,-7820.6498 1149.0681,-7729.1071 1203.6858,-7535.9762 1275.7997,-7506.4323 1317.5017,-7310.1071 1408.8919,-6879.8596 1268.3753,-6752.6376 1353.5017,-6321.1071 1368.1397,-6246.9028 1404.7462,-6164.331 1422.6164,-6126.7491"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1425.9398,-6127.9146 1427.126,-6117.3864 1419.6332,-6124.8769 1425.9398,-6127.9146"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2248.9114,-3911.1125 2161.3421,-3911.1125 2161.3421,-3889.1017 2248.9114,-3889.1017 2248.9114,-3911.1125"/>
<text text-anchor="middle" x="2205.1267" y="-3896.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.1602,-10501.8639C760.0647,-10409.4422 834.7422,-9778.2485 841.1968,-9771.1071 859.8055,-9750.518 879.852,-9773.7637 902.05,-9757.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-9757.1071C987.5994,-9692.9139 1250.8775,-9597.7771 1317.5017,-9514.1071 1350.8632,-9472.2101 1315.4552,-9436.8008 1353.5017,-9399.1071 1405.7886,-9347.305 1442.3742,-9374.9759 1511.9993,-9351.1071 1601.1729,-9320.5367 1654.6777,-9351.4211 1710.019,-9275.1071 1756.5216,-9210.9816 1733.213,-8641.2773 1746.019,-8563.1071 1792.1474,-8281.5314 1751.7107,-8175.61 1919.8806,-7945.1071 1974.0061,-7870.9198 2048.3427,-7911.785 2092.2107,-7831.1071 2141.5215,-7740.4193 2110.0729,-4216.7282 2128.2107,-4115.1071 2141.454,-4040.9083 2177.4507,-3958.3338 2195.0994,-3920.7501"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2198.4186,-3921.9206 2199.5566,-3911.387 2192.0981,-3918.9118 2198.4186,-3921.9206"/>
</g>
<!-- sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~datasurfacelists.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/datasurfacelists.f90.html" xlink:title="DataSurfaceLists.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1288.2544,-7033.1125 1178.3154,-7033.1125 1178.3154,-7011.1017 1288.2544,-7011.1017 1288.2544,-7033.1125"/>
<text text-anchor="middle" x="1233.2849" y="-7018.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaceLists.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M748.5953,-10502.0821C754.1425,-10421.2262 788.6338,-9911.3583 805.1968,-9496.1071 812.0138,-9325.1962 793.101,-8121.2528 841.1968,-7957.1071 870.4551,-7857.2517 931.3826,-7856.2716 962.9033,-7757.1071 1012.8435,-7599.9948 926.6475,-7123.3319 1055.9857,-7021.1071"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2270.6218,-3149.1125 2139.6316,-3149.1125 2139.6316,-3127.1017 2270.6218,-3127.1017 2270.6218,-3149.1125"/>
<text text-anchor="middle" x="2205.1267" y="-3134.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1233.2849,-9643.1071C1269.358,-9614.6321 1290.4227,-9620.2395 1317.5017,-9583.1071 1348.559,-9540.5194 1319.4092,-9510.3063 1353.5017,-9470.1071 1404.6697,-9409.7738 1445.1236,-9431.3671 1511.9993,-9389.1071 1605.7896,-9329.8393 1658.3196,-9335.2726 1710.019,-9237.1071 1744.9656,-9170.7514 1738.6815,-8637.7429 1746.019,-8563.1071 1788.1921,-8134.1314 1850.8522,-8032.8836 1883.8806,-7603.1071 1912.3439,-7232.7332 1869.968,-4628.2045 1919.8806,-4260.1071 1960.0964,-3963.5221 2019.0221,-3899.3198 2092.2107,-3609.1071 2135.8485,-3436.0713 2184.7348,-3226.2406 2200.1784,-3159.5364"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2203.672,-3159.963 2202.5154,-3149.4315 2196.852,-3158.3856 2203.672,-3159.963"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M902.05,-9757.1071C980.5715,-9697.1232 1026.7117,-9735.1306 1113.0681,-9687.1071 1131.2702,-9676.9848 1130.1345,-9665.7844 1149.0681,-9657.1071 1183.5615,-9641.2988 1203.2537,-9666.2982 1233.2849,-9643.1071"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2043.6721,-4291.1125 1968.4192,-4291.1125 1968.4192,-4269.1017 2043.6721,-4269.1017 2043.6721,-4291.1125"/>
<text text-anchor="middle" x="2006.0457" y="-4276.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M749.1075,-10502.0532C759.8936,-10408.4307 835.7387,-9751.4919 841.1968,-9743.1071 917.9314,-9625.2254 994.441,-9656.6843 1113.0681,-9581.1071 1205.7323,-9522.0709 1247.0612,-9526.4283 1317.5017,-9442.1071 1342.7586,-9411.8732 1323.9703,-9387.182 1353.5017,-9361.1071 1408.6754,-9312.3912 1446.631,-9346.9355 1511.9993,-9313.1071 1530.0013,-9303.791 1529.9692,-9294.3688 1547.9993,-9285.1071 1614.8034,-9250.7911 1664.4357,-9296.7941 1710.019,-9237.1071 1738.0464,-9200.408 1742.6562,-7621.162 1746.019,-7575.1071 1782.0611,-7081.5027 1848.2068,-6963.7383 1883.8806,-6470.1071 1912.4783,-6074.3918 1874.396,-5079.2385 1919.8806,-4685.1071 1937.1043,-4535.8611 1983.6323,-4360.3767 2000.139,-4300.9625"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2003.532,-4301.8252 2002.8579,-4291.2518 1996.7912,-4299.9378 2003.532,-4301.8252"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1878.4525,-5203.1125 1751.4471,-5203.1125 1751.4471,-5181.1017 1878.4525,-5181.1017 1878.4525,-5203.1125"/>
<text text-anchor="middle" x="1814.9498" y="-5188.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-9567.1071C920.4675,-9539.5842 939.1518,-9547.1848 962.9033,-9524.1071 1061.7499,-9428.0645 1040.6372,-9361.181 1149.0681,-9276.1071 1171.879,-9258.2099 1615.6378,-9096.8336 1629.0092,-9071.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.2226,-10501.9652C755.8713,-10448.4191 784.9784,-10212.1425 805.1968,-10018.1071 814.194,-9931.7608 804.6776,-9707.8662 841.1968,-9629.1071 857.4388,-9594.0787 879.846,-9598.6946 902.05,-9567.1071"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1482.1404,-9501.1125 1383.3606,-9501.1125 1383.3606,-9479.1017 1482.1404,-9479.1017 1482.1404,-9501.1125"/>
<text text-anchor="middle" x="1432.7505" y="-9486.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-9643.1071C1263.834,-9618.9925 1284.519,-9639.7686 1317.5017,-9619.1071 1363.2332,-9590.4594 1401.546,-9538.4732 1420.324,-9510.0251"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1423.4427,-9511.6474 1425.9258,-9501.3476 1417.5617,-9507.8508 1423.4427,-9511.6474"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge471" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M781.4832,-10519.3636C789.5851,-10521.7009 797.9783,-10524.8616 805.1968,-10529.1071 857.9818,-10560.1519 849.7942,-10595.1796 902.05,-10627.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-10627.1071C984.9485,-10677.7569 1027.9483,-10637.2865 1113.0681,-10684.1071 1132.086,-10694.568 1129.1937,-10708.3826 1149.0681,-10717.1071 1378.1865,-10817.6861 1484.5861,-10656.5191 1710.019,-10765.1071 1730.9787,-10775.2031 1728.9359,-10787.3147 1746.019,-10803.1071 1906.4163,-10951.3859 1943.0423,-10996.2342 2128.2107,-11112.1071 2207.2016,-11161.5373 2227.0904,-11180.8445 2318.0427,-11201.1071 2482.2119,-11237.6812 2591.507,-11253.8542 2686.5776,-11115.1071 2735.9867,-11042.9991 2687.7968,-9622.3013 2722.5776,-9542.1071 2770.586,-9431.4143 2810.0332,-9408.911 2916.4805,-9352.1071 2943.4275,-9337.7272 2964.959,-9362.1765 2983.7629,-9338.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-10133.1071C1483.9981,-10127.1022 1496.5128,-10143.7134 1547.9993,-10147.1071 1789.3538,-10163.016 1854.7038,-10196.8843 2092.2107,-10151.1071 2181.4484,-10133.9074 2230.1715,-10149.73 2282.0427,-10075.1071 2327.9084,-10009.1239 2265.5679,-8689.9662 2318.0427,-8629.1071 2341.7039,-8601.6654 2387.8972,-8649.7981 2398.3579,-8615.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-8615.1071C2414.6181,-8561.5501 2451.4439,-8567.0082 2478.6731,-8518.1071 2503.0826,-8474.2698 2496.5799,-8457.9063 2514.6731,-8411.1071 2539.7943,-8346.1297 2574.2229,-8271.1962 2590.8507,-8235.7439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.1348,-8236.985 2595.2284,-8226.4468 2587.8018,-8234.003 2594.1348,-8236.985"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M902.05,-10437.1071C1076.4323,-10370.4438 1139.0643,-10444.2142 1317.5017,-10499.1071 1410.0333,-10527.5727 1628.2033,-10636.3521 1710.019,-10688.1071 2003.5604,-10873.7954 1990.5447,-11063.3846 2318.0427,-11179.1071 2385.3553,-11202.8922 2410.5314,-11200.401 2478.6731,-11179.1071 2585.9584,-11145.581 2633.4426,-11134.1566 2686.5776,-11035.1071 2782.4543,-10856.3825 2632.1004,-9391.6249 2722.5776,-9210.1071 2742.4809,-9170.1766 2794.9415,-9192.2341 2801.5291,-9148.1071"/>
</g>
<!-- sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~hvacmixercomponent.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node62"><a xlink:href="../sourcefile/hvacmixercomponent.f90.html" xlink:title="HVACMixerComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1883.8115,-5471.1125 1746.0882,-5471.1125 1746.0882,-5449.1017 1883.8115,-5449.1017 1883.8115,-5471.1125"/>
<text text-anchor="middle" x="1814.9498" y="-5456.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACMixerComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M902.05,-9567.1071C940.0988,-9510.2474 993.005,-9593.8308 1055.9857,-9567.1071"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1055.9857,-9567.1071C1090.466,-9552.4766 1095.4952,-9538.1849 1113.0681,-9505.1071 1145.6394,-9443.7975 1103.9667,-9405.886 1149.0681,-9353.1071 1192.8307,-9301.8949 1672.1618,-9178.8268 1710.019,-9123.1071 1757.3227,-9053.4839 1740.9571,-6177.1274 1746.019,-6093.1071 1760.5293,-5852.261 1800.4043,-5561.961 1811.8442,-5481.6134"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1815.3662,-5481.7083 1813.3193,-5471.3131 1808.4369,-5480.7159 1815.3662,-5481.7083"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge424" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1432.7505,-10399.1071C1467.8436,-10406.0178 1478.2349,-10401.3066 1511.9993,-10413.1071 1689.5572,-10475.1627 1721.1767,-10520.74 1883.8806,-10615.1071 1994.307,-10679.1536 2008.5832,-10721.5516 2128.2107,-10766.1071 2178.0326,-10784.6634 2572.8937,-10887.467 2600.6254,-10842.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2600.6254,-10842.1071C2717.9331,-10646.9827 2666.4363,-10563.8866 2686.5776,-10337.1071 2727.834,-9872.5851 2665.8013,-6602.9885 2722.5776,-6140.1071 2737.1323,-6021.4474 2778.4456,-5883.5166 2794.7714,-5831.9546"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2798.1462,-5832.8917 2797.8572,-5822.3008 2791.4786,-5830.7604 2798.1462,-5832.8917"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge438" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1432.7505,-10133.1071C1500.3509,-10127.7073 1486.727,-10062.1704 1547.9993,-10033.1071 1581.0119,-10017.4483 1597.7807,-10038.0759 1629.0092,-10019.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M766.0765,-10501.8879C794.2007,-10485.1154 850.3241,-10453.7047 902.05,-10437.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1629.0092,-10019.1071C1671.9914,-9992.9989 1682.151,-9981.9697 1710.019,-9940.1071 1734.1212,-9903.9016 1713.4566,-9877.9418 1746.019,-9849.1071 1769.7241,-9828.1159 1784.3622,-9839.2898 1814.9498,-9831.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1055.9857,-10285.1071C1106.1505,-10256.912 1098.556,-10222.6752 1149.0681,-10195.1071 1262.3517,-10133.2802 1304.1031,-10143.3833 1432.7505,-10133.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M902.05,-10437.1071C973.3984,-10414.2131 937.046,-10341.3966 998.9033,-10299.1071 1020.4674,-10284.3646 1033.0453,-10297.6006 1055.9857,-10285.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1814.9498,-9831.1071C1860.5223,-9818.9158 1872.8406,-9843.5413 1919.8806,-9847.1071 1996.2527,-9852.8963 2027.4904,-9888.0642 2092.2107,-9847.1071 2123.7935,-9827.1205 2099.2733,-9794.7623 2128.2107,-9771.1071 2182.7358,-9726.5349 2238.3659,-9788.352 2282.0427,-9733.1071 2315.2072,-9691.1589 2312.6784,-5936.3119 2318.0427,-5883.1071 2333.4269,-5730.5224 2377.405,-5550.4691 2392.8857,-5490.0493"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2396.3193,-5490.7509 2395.4314,-5480.1934 2389.5417,-5489.0003 2396.3193,-5490.7509"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-10019.1071C1893.6234,-9876.2598 2133.3902,-10103.5043 2282.0427,-9842.1071 2366.9274,-9692.8421 2240.5299,-8450.3299 2318.0427,-8297.1071 2328.1318,-8277.1635 2347.9497,-8261.7588 2365.3741,-8251.293"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2367.2407,-8254.258 2374.2035,-8246.2724 2363.7805,-8248.1729 2367.2407,-8254.258"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-9301.1071C931.9611,-9235.5097 1421.1897,-9091.2407 1579.7968,-9045.9758"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1581.0984,-9049.2444 1589.7574,-9043.1393 1579.1812,-9042.512 1581.0984,-9049.2444"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-9871.1071C1166.0301,-9909.0309 1201.5975,-9895.7934 1317.5017,-9885.1071 1338.9448,-9883.1301 2126.9019,-9733.3498 2128.2107,-9733.1071 2145.2927,-9729.9391 2196.7876,-9734.3482 2205.1267,-9719.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2205.1267,-9719.1071C2224.5219,-9689.0038 2260.7026,-9723.8644 2282.0427,-9695.1071 2352.3306,-9600.3891 2292.9845,-5564.3632 2318.0427,-5449.1071 2331.4172,-5387.5907 2367.046,-5321.5324 2386.037,-5289.2288"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2389.2295,-5290.7093 2391.3536,-5280.3296 2383.2202,-5287.1192 2389.2295,-5290.7093"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M902.05,-10437.1071C1079.2377,-10380.2519 1141.488,-10324.7154 1317.5017,-10385.1071 1336.6744,-10391.6854 1336.7214,-10401.7367 1353.5017,-10413.1071 1520.8884,-10526.5294 1562.4452,-10558.3511 1746.019,-10643.1071 1804.9234,-10670.3032 1827.7464,-10658.5756 1883.8806,-10691.1071 2086.721,-10808.6594 2135.1089,-10854.4237 2282.0427,-11037.1071 2302.9841,-11063.1436 2296.355,-11077.6888 2318.0427,-11103.1071 2347.3122,-11137.4114 2353.4817,-11160.6784 2398.3579,-11165.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2398.3579,-11165.1071C2572.8296,-11186.9131 2615.8411,-11055.0798 2686.5776,-10894.1071 2720.4405,-10817.0465 2672.4447,-7931.7216 2722.5776,-7864.1071 2731.3978,-7852.2113 2745.9012,-7845.8409 2760.0867,-7842.4754"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.1132,-7845.8423 2770.2741,-7840.5198 2759.7935,-7838.9678 2761.1132,-7845.8423"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M748.5169,-10502.0786C753.5059,-10421.1978 784.7535,-9911.1853 805.1968,-9496.1071 823.9063,-9116.2309 776.7669,-9015.9468 841.1968,-8641.1071 876.0132,-8438.5526 1057.2269,-7954.9006 1113.0681,-7757.1071 1161.3417,-7586.1188 1212.1951,-7377.6898 1228.1758,-7311.4051"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1231.6555,-7311.9044 1230.5919,-7301.3631 1224.8497,-7310.2669 1231.6555,-7311.9044"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node75" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node75"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2258.8575,-9538.1125 2151.3959,-9538.1125 2151.3959,-9516.1017 2258.8575,-9516.1017 2258.8575,-9538.1125"/>
<text text-anchor="middle" x="2205.1267" y="-9523.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-9871.1071C1137.1361,-9894.7112 1663.9931,-9571.461 1746.019,-9551.1071 1883.6395,-9516.958 2051.3504,-9518.6471 2141.1138,-9522.8795"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2140.977,-9526.3769 2151.1386,-9523.3782 2141.3249,-9519.3856 2140.977,-9526.3769"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-9757.1071C904.178,-9755.5103 1053.4704,-9870.2403 1055.9857,-9871.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge400" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-10133.1071C1816.9758,-10070.0177 2055.0514,-10234.4681 2282.0427,-9918.1071 2385.2548,-9774.259 2219.3635,-8472.1017 2318.0427,-8325.1071 2361.4481,-8260.4496 2435.3816,-8319.8409 2478.6731,-8255.1071 2536.9611,-8167.949 2484.7209,-6468.5904 2514.6731,-6368.1071 2528.5924,-6321.4108 2563.138,-6275.0684 2583.9489,-6250.0585"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.8726,-6252.023 2590.6809,-6242.1362 2581.5383,-6247.4902 2586.8726,-6252.023"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge515" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-9831.1071C1866.3358,-9820.6004 1868.9055,-9872.7601 1919.8806,-9885.1071 1994.3193,-9903.1374 2026.3501,-9924.2042 2092.2107,-9885.1071 2120.9427,-9868.0508 2102.3762,-9840.2972 2128.2107,-9819.1071 2183.5866,-9773.6863 2238.9784,-9828.3348 2282.0427,-9771.1071 2337.0398,-9698.0221 2303.9227,-8215.477 2318.0427,-8125.1071 2333.0508,-8029.0538 2372.9314,-7919.3652 2390.1985,-7874.6736"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2393.5133,-7875.8068 2393.8909,-7865.2187 2386.9929,-7873.2604 2393.5133,-7875.8068"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge598" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2398.3579,-12685.1071C2516.2296,-12628.9871 2491.5032,-12543.7698 2600.6254,-12472.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M751.3426,-10524.5464C762.3598,-10559.8606 798.1123,-10669.914 841.1968,-10755.1071 899.9765,-10871.3352 923.1211,-10896.1775 998.9033,-11002.1071 1046.2217,-11068.2495 1077.1282,-11072.1539 1113.0681,-11145.1071 1142.6031,-11205.0592 1107.0917,-11239.1018 1149.0681,-11291.1071 1323.3388,-11507.014 1557.9644,-11333.0178 1710.019,-11565.1071 1810.706,-11718.7911 1655.2073,-12231.389 1746.019,-12391.1071 1847.28,-12569.2031 2334.5892,-12715.4681 2398.3579,-12685.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge613" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M902.05,-10741.1071C923.6686,-10773.0981 942.569,-10770.2848 962.9033,-10803.1071 988.6634,-10844.6873 976.5959,-10863.577 998.9033,-10907.1071 1039.0745,-10985.496 1078.3956,-10988.1358 1113.0681,-11069.1071 1145.5259,-11144.9062 1093.8771,-11189.8456 1149.0681,-11251.1071 1201.5078,-11309.3147 1246.0934,-11270.8752 1317.5017,-11303.1071 1334.5925,-11310.8214 1335.6997,-11319.2171 1353.5017,-11325.1071 1427.3329,-11349.5348 1517.9876,-11353.0627 1574.6465,-11352.3567"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1574.881,-11355.8533 1584.8186,-11352.1797 1574.7592,-11348.8543 1574.881,-11355.8533"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge565" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-10285.1071C1531.3056,-10017.4001 1843.2485,-10551.23 2282.0427,-10227.1071 2440.3264,-10110.1882 2572.6281,-9447.9665 2596.7121,-9321.1144"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2600.1827,-9321.5967 2598.5948,-9311.1215 2593.3038,-9320.3006 2600.1827,-9321.5967"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge576" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1432.7505,-10399.1071C1484.306,-10401.206 1496.4953,-10388.2239 1547.9993,-10385.1071 1619.8766,-10380.7574 1638.7861,-10374.5649 1710.019,-10385.1071 1868.0926,-10408.5013 2241.7721,-10624.9725 2398.3579,-10593.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-10285.1071C1160.8888,-10227.9764 1204.4309,-10308.5902 1317.5017,-10347.1071 1370.6944,-10365.2269 1377.2775,-10390.1335 1432.7505,-10399.1071"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge531" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-9831.1071C1474.8046,-9820.8031 1781.7772,-9782.9334 1814.9498,-9755.1071"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node85" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node85"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="948.6739,-12235.1125 855.4262,-12235.1125 855.4262,-12213.1017 948.6739,-12213.1017 948.6739,-12235.1125"/>
<text text-anchor="middle" x="902.05" y="-12220.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge522" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M750.0918,-10524.1221C759.0522,-10568.408 792.2576,-10737.8789 805.1968,-10879.1071 811.89,-10952.1617 799.5246,-12138.7316 841.1968,-12199.1071 843.3682,-12202.2531 846.012,-12205.0039 848.9675,-12207.4089"/>
<polygon fill="#ff0000" stroke="#ff0000" points="847.1392,-12210.3961 857.4087,-12213.0017 851.0056,-12204.5607 847.1392,-12210.3961"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node86" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node86"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3252.8583,-7850.1125 3087.1077,-7850.1125 3087.1077,-7828.1017 3252.8583,-7828.1017 3252.8583,-7850.1125"/>
<text text-anchor="middle" x="3169.983" y="-7835.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge663" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-11539.1071C1463.7671,-11558.914 1485.472,-11537.5993 1511.9993,-11563.1071 1547.257,-11597.0097 1522.1715,-11625.569 1547.9993,-11667.1071 1602.1017,-11754.1185 1669.36,-11737.0598 1710.019,-11831.1071 1753.1702,-11930.919 1681.7953,-12721.3588 1746.019,-12809.1071 1842.5464,-12940.9916 1941.0589,-12870.9445 2092.2107,-12933.1071 2438.0243,-13075.3263 2593.515,-13466.8241 2880.4805,-13227.1071 3207.3502,-12954.056 3010.1764,-12708.0534 3051.0454,-12284.1071 3108.9016,-11683.9474 3068.6231,-10173.7676 3087.0454,-9571.1071 3108.5161,-8868.7245 3159.7887,-8007.2054 3168.6632,-7860.7454"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3172.1765,-7860.6309 3169.2895,-7850.437 3165.1894,-7860.2064 3172.1765,-7860.6309"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge645" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-10741.1071C918.3091,-10763.598 938.8092,-10741.335 962.9033,-10755.1071 983.1011,-10766.6521 982.6706,-10776.4418 998.9033,-10793.1071 1048.9356,-10844.4727 1081.7746,-10842.5907 1113.0681,-10907.1071 1142.9493,-10968.7116 1099.8066,-11165.554 1149.0681,-11213.1071 1239.0555,-11299.9738 1623.2452,-11169.0302 1710.019,-11259.1071 1772.4438,-11323.9081 1699.0794,-11991.3433 1746.019,-12068.1071 1792.4073,-12143.9692 1833.9213,-12144.3491 1919.8806,-12167.1071 2295.8867,-12266.6558 2514.2705,-12093.8201 2686.5776,-11745.1071 2778.6937,-11558.6837 2966.0954,-8162.505 2982.5964,-7860.5278"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2986.0974,-7860.603 2983.1476,-7850.4271 2979.1078,-7860.2215 2986.0974,-7860.603"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M754.7698,-10524.3463C775.7242,-10558.0813 840.7183,-10661.0728 902.05,-10741.1071"/>
</g>
<!-- sourcefile~datareportingflags.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datareportingflags.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datareportingflags.f90.html" xlink:title="DataReportingFlags.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3778.0269,-183.1125 3655.2348,-183.1125 3655.2348,-161.1017 3778.0269,-161.1017 3778.0269,-183.1125"/>
<text text-anchor="middle" x="3716.6309" y="-168.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataReportingFlags.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datareportingflags.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge805" class="edge">
<title>sourcefile~datareportingflags.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3762.0768,-183.2572C3768.3735,-186.7018 3774.0534,-191.2093 3778.0789,-197.1071 3829.4256,-272.337 3866.5055,-6543.1551 3868.8955,-6956.7109"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3865.3959,-6956.7984 3868.9535,-6966.778 3872.3957,-6956.758 3865.3959,-6956.7984"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge806" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-8843.1071C1837.3923,-8864.8697 1860.7921,-8836.0312 1883.8806,-8857.1071 1925.0051,-8894.6467 1884.8347,-8933.8378 1919.8806,-8977.1071 1986.3118,-9059.1262 2033.0577,-9045.4328 2128.2107,-9091.1071 2169.403,-9110.8798 2275.3019,-9153.952 2318.0427,-9170.1071 2404.4047,-9202.7501 2426.1178,-9210.9936 2514.6731,-9237.1071 2590.2132,-9259.3826 2635.4792,-9220.1783 2686.5776,-9280.1071 2698.585,-9294.1895 2911.0029,-11917.4298 2916.4805,-11935.1071 2952.4465,-12051.177 3018.6343,-12055.9948 3051.0454,-12173.1071 3093.0535,-12324.8967 3008.7539,-13453.4499 3087.0454,-13590.1071 3130.1836,-13665.4044 3188.6209,-13634.8308 3252.9207,-13693.1071 3363.2834,-13793.1313 3367.556,-13839.8356 3456.7698,-13959.1071 3515.436,-14037.5389 3646.6577,-14383.642 3716.6309,-14315.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3716.6309,-14315.1071C3858.9574,-14114.5028 3762.7577,-14010.5948 3778.0789,-13765.1071 3823.4282,-13038.4841 3865.9669,-7390.0922 3868.8614,-6999.3866"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3872.3629,-6999.1841 3868.937,-6989.1584 3865.3631,-6999.1322 3872.3629,-6999.1841"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge756" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1629.0092,-8651.1071C1658.8389,-8672.2073 1681.0372,-8642.8566 1710.019,-8665.1071 1740.3039,-8688.358 1727.1153,-8709.9344 1746.019,-8743.1071 1772.7452,-8790.0068 1777.0319,-8804.6871 1814.9498,-8843.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1814.9498,-8843.1071C1836.9091,-8865.3572 1857.1113,-8840.9616 1883.8806,-8857.1071 1905.5169,-8870.1567 1900.9382,-8884.3857 1919.8806,-8901.1071 2072.2639,-9035.6229 2131.4361,-9045.527 2318.0427,-9126.1071 2403.624,-9163.0627 2426.0082,-9170.3249 2514.6731,-9199.1071 2590.1219,-9223.5991 2635.3728,-9186.5229 2686.5776,-9247.1071 2785.2374,-9363.8387 2634.8979,-9463.9182 2722.5776,-9589.1071 2767.369,-9653.0601 2836.8443,-9601.3603 2880.4805,-9666.1071 2957.3222,-9780.1239 3044.5806,-11997.7656 3051.0454,-12135.1071 3052.9189,-12174.9089 3059.7088,-13540.1174 3087.0454,-13569.1071 3130.7711,-13615.4769 3343.7551,-13536.3985 3372.8452,-13593.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge733" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-8729.1071C1871.4506,-8758.1095 1869.1989,-8787.8339 1919.8806,-8826.1071 2161.9968,-9008.9451 2233.2598,-9047.7204 2514.6731,-9161.1071 2588.2498,-9190.7525 2635.0815,-9148.7703 2686.5776,-9209.1071 2777.4816,-9315.6171 2649.7388,-9402.5145 2722.5776,-9522.1071 2766.5455,-9594.297 2833.8195,-9557.6279 2880.4805,-9628.1071 3520.0839,-10594.1981 3101.4852,-11061.7022 3372.8452,-12188.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1449.1123,-8457.0484C1468.2017,-8443.0765 1498.8263,-8417.0788 1511.9993,-8386.1071 1555.5588,-8283.6915 1537.5513,-7495.9097 1547.9993,-7385.1071 1602.5351,-6806.7451 1604.5861,-6656.5549 1746.019,-6093.1071 1790.7778,-5914.7947 1835.2811,-5880.4113 1883.8806,-5703.1071 1905.678,-5623.5842 1885.4329,-5596.0228 1919.8806,-5521.1071 1971.6235,-5408.5786 2025.4502,-5406.4288 2092.2107,-5302.1071 2192.2621,-5145.7642 2225.1592,-5106.7922 2282.0427,-4930.1071 2373.5208,-4645.9685 2393.8482,-4278.6593 2397.6028,-4187.353"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2401.1071,-4187.3086 2397.9979,-4177.1802 2394.1123,-4187.0368 2401.1071,-4187.3086"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge486" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M2006.0457,-8729.1071C2044.8222,-8738.4014 2056.2191,-8736.9429 2092.2107,-8754.1071 2092.3919,-8754.1935 2281.9162,-8885.9513 2282.0427,-8886.1071 2307.9007,-8917.9587 2286.6967,-8944.6385 2318.0427,-8971.1071 2374.0945,-9018.4373 2421.6456,-8962.9572 2478.6731,-9009.1071 2507.7269,-9032.6191 2485.4467,-9061.8099 2514.6731,-9085.1071 2575.8589,-9133.8801 2633.7718,-9065.3659 2686.5776,-9123.1071 2770.9547,-9215.3703 2646.2155,-9303.108 2722.5776,-9402.1071 2768.8271,-9462.0668 2810.3716,-9437.4902 2880.4805,-9466.1071 2944.8792,-9492.3933 3119.9544,-9633.432 3169.983,-9585.1071"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M3169.983,-9585.1071C3286.1488,-9479.6238 3366.9248,-4133.3107 3372.5334,-3752.4703"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3376.0332,-3752.502 3372.6804,-3742.4517 3369.034,-3752.3992 3376.0332,-3752.502"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge690" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1814.9498,-8729.1071C1843.3748,-8742.1184 1854.7193,-8731.8423 1883.8806,-8743.1071 1984.3933,-8781.9343 2000.2996,-8810.8692 2092.2107,-8867.1071 2142.7773,-8898.0474 2264.0558,-8984.6185 2318.0427,-9009.1071 2385.8987,-9039.8868 2420.7785,-9010.2025 2478.6731,-9057.1071 2504.6351,-9078.1408 2488.5219,-9102.309 2514.6731,-9123.1071 2576.7572,-9172.4827 2634.873,-9110.9489 2686.5776,-9171.1071 2772.6713,-9271.277 2646.0116,-9358.4792 2722.5776,-9466.1071 2772.5557,-9536.3607 3001.3458,-9589.6762 3087.0454,-9599.1071 3160.3254,-9607.1712 3199.1019,-9649.4909 3252.9207,-9599.1071 3321.9702,-9534.4647 3366.736,-8002.3196 3372.2658,-7803.3364"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3375.7662,-7803.3685 3372.5434,-7793.2757 3368.7688,-7803.1754 3375.7662,-7803.3685"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1629.0092,-8651.1071C1659.3748,-8672.5863 1675.4179,-8658.4619 1710.019,-8672.1071 1759.3911,-8691.5773 1767.7344,-8704.8709 1814.9498,-8729.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1455.9106,-8457.0313C1474.8389,-8446.5718 1500.3104,-8428.9346 1511.9993,-8405.1071 1579.7322,-8267.0352 1455.8807,-5760.2565 1547.9993,-5637.1071 1551.4156,-5632.54 1555.6538,-5628.7827 1560.3867,-5625.6947"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.2439,-5628.6692 1569.3698,-5620.8288 1558.9099,-5622.5142 1562.2439,-5628.6692"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge465" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-9338.1071C3160.813,-9060.8011 3041.1874,-8187.966 3051.0454,-7859.1071 3053.1156,-7790.0476 3055.6524,-5433.6537 3087.0454,-5372.1071 3097.3403,-5351.9238 3117.6001,-5336.5865 3135.518,-5326.2155"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3137.5138,-5329.1134 3144.6093,-5321.2455 3134.156,-5322.9713 3137.5138,-5329.1134"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-8577.1071C1864.6982,-8573.0999 1873.3099,-8599.1593 1919.8806,-8617.1071 1998.9273,-8647.5707 2219.703,-8678.7471 2282.0427,-8736.1071 2312.2335,-8763.8862 2292.2051,-8789.2389 2318.0427,-8821.1071 2372.8537,-8888.7111 2422.463,-8866.6619 2478.6731,-8933.1071 2502.8124,-8961.6418 2485.4467,-8985.8099 2514.6731,-9009.1071 2575.8589,-9057.8801 2630.5837,-8992.452 2686.5776,-9047.1071 2734.4036,-9093.7895 2681.9787,-9140.0195 2722.5776,-9193.1071 2762.9051,-9245.8399 2948.0385,-9394.0608 2983.7629,-9338.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1482.5457,-8465.72C1565.7543,-8461.5487 1738.2868,-8452.121 1883.8806,-8439.1071 1938.3145,-8434.2415 1951.3951,-8425.3171 2006.0457,-8425.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-8425.1071C2217.6898,-8434.5853 2293.3658,-8465.7927 2478.6731,-8363.1071 2532.7753,-8333.1271 2572.5791,-8268.716 2590.3444,-8235.6367"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2593.6155,-8236.9338 2595.1417,-8226.4495 2587.4105,-8233.6937 2593.6155,-8236.9338"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1814.9498,-8577.1071C1903.0662,-8570.8895 2121.4113,-8624.9132 2205.1267,-8653.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2205.1267,-8653.1071C2321.2246,-8695.9578 2373.0165,-8640.6745 2478.6731,-8705.1071 2606.7799,-8783.2305 2599.4306,-8848.9596 2686.5776,-8971.1071 2741.0563,-9047.4658 2787.8953,-9240.9118 2801.5291,-9148.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2801.5291,-9148.1071C2906.5295,-8447.4197 2849.6768,-8263.4618 2916.4805,-7558.1071 2936.9518,-7341.9577 2970.8883,-7081.1 2980.8996,-7005.5543"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2984.3989,-7005.7901 2982.2472,-6995.4161 2977.46,-7004.8677 2984.3989,-7005.7901"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1455.901,-8457.0266C1474.8232,-8446.5641 1500.2913,-8428.9252 1511.9993,-8405.1071 1572.3932,-8282.2448 1511.1243,-6072.951 1547.9993,-5941.1071 1586.3118,-5804.1234 1641.581,-5789.8012 1710.019,-5665.1071 1746.5932,-5598.469 1786.7182,-5517.7406 1804.9468,-5480.6064"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1808.2315,-5481.8568 1809.4864,-5471.3366 1801.9449,-5478.7781 1808.2315,-5481.8568"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge421" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2006.0457,-8425.1071C2061.2097,-8428.178 2073.2002,-8442.9738 2128.2107,-8448.1071 2284.3049,-8462.6731 2337.3279,-8475.9238 2478.6731,-8408.1071 2587.0523,-8356.1073 2634.6182,-8343.5057 2686.5776,-8235.1071 2736.8935,-8130.1372 2707.9087,-6255.5852 2722.5776,-6140.1071 2737.6426,-6021.5111 2778.6548,-5883.5427 2794.8357,-5831.9627"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2798.2116,-5832.8954 2797.8934,-5822.3054 2791.5381,-5830.7824 2798.2116,-5832.8954"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge442" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1448.7599,-8456.8914C1467.5022,-8442.7649 1497.7853,-8416.615 1511.9993,-8386.1071 1577.2936,-8245.9634 1490.7255,-8183.7153 1547.9993,-8040.1071 1638.7448,-7812.572 1789.0504,-7828.9703 1883.8806,-7603.1071 1928.3597,-7497.1685 1899.8851,-7460.2511 1919.8806,-7347.1071 1983.7821,-6985.5223 2036.3708,-6902.0243 2092.2107,-6539.1071 2105.0091,-6455.9271 2087.5831,-6235.81 2128.2107,-6162.1071 2169.9389,-6086.4076 2236.4095,-6116.5188 2282.0427,-6043.1071 2289.6257,-6030.9081 2374.4911,-5592.7928 2394.2597,-5490.3686"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2397.7434,-5490.7871 2396.2009,-5480.3052 2390.8701,-5489.4612 2397.7434,-5490.7871"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.3062,-8479.4485C1443.5438,-8545.67 1492.6688,-8882.3947 1547.9993,-8969.1071 1560.5675,-8988.8036 1581.5176,-9004.8527 1598.9639,-9015.8226"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1597.3331,-9018.9261 1607.7049,-9021.0885 1600.9453,-9012.9302 1597.3331,-9018.9261"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node69" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node69"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1877.6891,-5011.1125 1752.2106,-5011.1125 1752.2106,-4989.1017 1877.6891,-4989.1017 1877.6891,-5011.1125"/>
<text text-anchor="middle" x="1814.9498" y="-4996.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1439.8891,-8457.0241C1456.4875,-8430.5284 1497.3744,-8360.891 1511.9993,-8296.1071 1529.9047,-8216.7914 1498.9501,-5433.9591 1547.9993,-5369.1071 1570.651,-5339.1573 1617.8273,-5380.9548 1629.0092,-5345.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1448.967,-8456.9854C1467.9133,-8442.9515 1498.3972,-8416.8927 1511.9993,-8386.1071 1562.7548,-8271.2319 1518.4217,-7944.1629 1547.9993,-7822.1071 1590.3742,-7647.2415 1653.5976,-7621.9586 1710.019,-7451.1071 1714.0949,-7438.765 1914.3832,-6550.885 1919.8806,-6539.1071 1973.6048,-6424.0056 2046.5853,-6429.6523 2092.2107,-6311.1071 2157.9153,-6140.3914 2058.1075,-6070.0641 2128.2107,-5901.1071 2168.9306,-5802.9673 2239.1029,-5815.2961 2282.0427,-5718.1071 2330.7896,-5607.7745 2285.1303,-5565.1515 2318.0427,-5449.1071 2335.2201,-5388.5424 2369.186,-5322.068 2386.9402,-5289.4548"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2390.1333,-5290.9123 2391.8932,-5280.4646 2384.0021,-5287.5344 2390.1333,-5290.9123"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2600.6254,-8425.1071C2618.1867,-8389.5445 2661.5544,-8431.8794 2686.5776,-8401.1071 2762.035,-8308.3136 2648.7261,-7958.1837 2722.5776,-7864.1071 2731.6504,-7852.5496 2746.0613,-7846.2356 2760.1024,-7842.8205"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.0564,-7846.1993 2770.1796,-7840.8126 2759.6884,-7839.3343 2761.0564,-7846.1993"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1629.0092,-8651.1071C1702.4527,-8701.2783 1726.6827,-8588.0621 1814.9498,-8577.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1814.9498,-8577.1071C2110.9959,-8540.3643 2207.0141,-8600.3739 2478.6731,-8477.1071 2497.1315,-8468.7315 2496.5707,-8458.2267 2514.6731,-8449.1071 2550.0944,-8431.2626 2583.0641,-8460.6697 2600.6254,-8425.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1482.6242,-8476.27C1493.3407,-8479.9625 1503.8723,-8485.3238 1511.9993,-8493.1071 1545.8123,-8525.4904 1519.8501,-8554.6956 1547.9993,-8592.1071 1574.7791,-8627.6987 1592.2304,-8625.9826 1629.0092,-8651.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge396" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1453.9013,-8456.8619C1599.4046,-8379.4095 2447.3163,-7926.5251 2478.6731,-7874.1071 2521.6368,-7802.2863 2490.5726,-6448.2525 2514.6731,-6368.1071 2528.705,-6321.4445 2563.2105,-6275.0901 2583.984,-6250.069"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.9065,-6252.0341 2590.703,-6242.1429 2581.5669,-6247.5077 2586.9065,-6252.0341"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge510" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1447.8739,-8456.8611C1466.0282,-8442.5136 1496.0193,-8415.953 1511.9993,-8386.1071 1547.4281,-8319.9363 1501.9011,-8280.3417 1547.9993,-8221.1071 1748.4728,-7963.5055 1879.1927,-7875.3508 2205.1267,-7893.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge615" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1433.8818,-8479.2157C1442.0187,-8559.6258 1491.8671,-9060.9597 1511.9993,-9470.1071 1514.5321,-9521.5823 1516.9971,-11283.937 1547.9993,-11325.1071 1554.6425,-11333.9292 1564.3505,-11339.7275 1574.7562,-11343.5166"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1573.8549,-11346.9007 1584.4405,-11346.4607 1575.8909,-11340.2034 1573.8549,-11346.9007"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge560" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-9109.1071C2039.1097,-9131.1774 2055.9138,-9116.8941 2092.2107,-9133.1071 2109.5465,-9140.8506 2112.167,-9145.9536 2128.2107,-9156.1071 2212.3528,-9209.3575 2223.6501,-9243.3972 2318.0427,-9275.1071 2377.8168,-9295.1874 2448.4824,-9301.4355 2504.1945,-9302.6645"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2504.3592,-9306.1677 2514.4171,-9302.8378 2504.4779,-9299.1687 2504.3592,-9306.1677"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-8651.1071C1666.2349,-8676.989 1685.1242,-8675.2142 1710.019,-8713.1071 1746.2418,-8768.2425 1707.2059,-8803.7635 1746.019,-8857.1071 1788.5073,-8915.5016 1841.2958,-8884.783 1883.8806,-8943.1071 1922.2737,-8995.6902 1874.3834,-9038.5344 1919.8806,-9085.1071 1947.6602,-9113.5434 1971.1143,-9090.13 2006.0457,-9109.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge580" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1482.635,-8475.1768C1493.6092,-8478.9014 1504.2531,-8484.5512 1511.9993,-8493.1071 1564.4173,-8551.0044 1510.8376,-8596.4138 1547.9993,-8665.1071 1596.4514,-8754.6708 1653.4582,-8742.4305 1710.019,-8827.1071 1733.2624,-8861.9045 1724.3929,-8878.2822 1746.019,-8914.1071 1808.4626,-9017.5483 1837.7445,-9034.4903 1919.8806,-9123.1071 2072.2551,-9287.5043 2161.9005,-9284.8711 2282.0427,-9474.1071 2308.4846,-9515.7557 2301.2196,-9532.7308 2318.0427,-9579.1071 2421.7892,-9865.1057 2557.8319,-10209.3739 2592.376,-10296.371"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2589.2135,-10297.8905 2596.159,-10305.8912 2595.7187,-10295.3055 2589.2135,-10297.8905"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge541" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1435.7739,-8479.2752C1447.1759,-8520.5497 1489.8948,-8667.8377 1547.9993,-8779.1071 1606.3833,-8890.9119 1667.1165,-8893.4969 1710.019,-9012.1071 1772.9921,-9186.2052 1672.5803,-9257.1586 1746.019,-9427.1071 1799.9899,-9552.004 1929.2976,-9660.0213 1982.5336,-9700.784"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1980.6051,-9703.7138 1990.6911,-9706.9578 1984.8295,-9698.1321 1980.6051,-9703.7138"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge665" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-8729.1071C2126.747,-8764.282 2191.9377,-8703.4305 2282.0427,-8791.1071 2328.7053,-8836.5121 2272.9835,-8886.1105 2318.0427,-8933.1071 2369.6094,-8986.891 2420.7785,-8934.2025 2478.6731,-8981.1071 2504.6351,-9002.1408 2488.5219,-9026.309 2514.6731,-9047.1071 2576.7572,-9096.4827 2634.3415,-9035.4098 2686.5776,-9095.1071 2762.5287,-9181.9066 2635.5486,-9276.4192 2722.5776,-9352.1071 2832.7327,-9447.9073 2943.8493,-9451.2071 3051.0454,-9352.1071 3108.5201,-9298.9732 3161.7842,-8040.5851 3169.1235,-7860.4877"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3172.624,-7860.5443 3169.532,-7850.4108 3165.6298,-7860.2608 3172.624,-7860.5443"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-8651.1071C1646.6714,-8663.1726 1985.7848,-8722.2494 2006.0457,-8729.1071"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge649" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-8653.1071C2238.6313,-8665.7493 2252.1043,-8657.4583 2282.0427,-8677.1071 2337.9779,-8713.8178 2440.5919,-8850.0958 2478.6731,-8905.1071 2497.6911,-8932.58 2488.5219,-8950.309 2514.6731,-8971.1071 2576.7572,-9020.4827 2631.2112,-8962.301 2686.5776,-9019.1071 2732.3219,-9066.0408 2670.8866,-9121.8163 2722.5776,-9162.1071 2777.9286,-9205.2506 2828.9615,-9209.7609 2880.4805,-9162.1071 2930.4428,-9115.8932 2976.1782,-8027.5198 2982.9121,-7860.5243"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2986.4257,-7860.2521 2983.3291,-7850.1199 2979.4314,-7859.9717 2986.4257,-7860.2521"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-12103.1125 -.2403,-12103.1125 -.2403,-12081.1017 130.719,-12081.1017 130.719,-12103.1125"/>
<text text-anchor="middle" x="65.2394" y="-12088.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge807" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-14999.1071C2289.5783,-14983.5057 2314.9504,-15019.568 2398.3579,-14999.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-11921.1071C464.2601,-11908.1128 459.7754,-11862.9614 516.9653,-11829.1071 636.97,-11758.0687 723.9813,-11818.4721 805.1968,-11705.1071 864.3948,-11622.4752 797.1266,-11340.7055 841.1968,-11249.1071 873.3296,-11182.32 930.1638,-11201.5989 962.9033,-11135.1071 1035.888,-10986.8802 930.8376,-10915.6562 998.9033,-10765.1071 1006.5497,-10748.1948 1020.8152,-10732.9481 1033.1716,-10721.9278"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1035.5844,-10724.4703 1040.9272,-10715.3212 1031.0451,-10719.1416 1035.5844,-10724.4703"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11921.1071C263.2137,-11853.9061 321.6005,-11929.0157 399.0839,-11921.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M399.0839,-10857.1071C421.5801,-10826.8766 453.8755,-10861.3008 480.9653,-10835.1071 520.3831,-10796.9933 486.0814,-10762.4128 516.9653,-10717.1071 560.8918,-10652.6686 619.7576,-10677.9404 654.4731,-10608.1071 694.6702,-10527.2475 641.3303,-9058.8637 690.4731,-8983.1071 747.0153,-8895.9441 1038.7258,-8855.6855 1113.0681,-8783.1071 1198.1484,-8700.0455 1170.6071,-8645.1486 1233.2849,-8544.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1233.2849,-8544.1071C1256.9241,-8505.8759 1291.7324,-8524.9362 1317.5017,-8488.1071 1356.5592,-8432.2869 1316.8469,-8396.5336 1353.5017,-8339.1071 1365.9031,-8319.678 1386.3952,-8303.6224 1403.4344,-8292.5825"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1405.3252,-8295.5283 1411.9689,-8287.2753 1401.6286,-8289.5839 1405.3252,-8295.5283"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M399.0839,-10857.1071C411.9526,-10840.2494 567.0302,-10827.1325 585.7192,-10817.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1233.2849,-8959.1071C1367.0629,-8811.6493 1417.199,-8562.6593 1429.5107,-8489.1415"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1432.9698,-8489.6752 1431.1139,-8479.2442 1426.0598,-8488.5559 1432.9698,-8489.6752"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M399.0839,-10857.1071C421.9489,-10827.1545 447.7981,-10852.9929 480.9653,-10835.1071 499.8075,-10824.9462 500.384,-10816.647 516.9653,-10803.1071 576.1099,-10754.811 619.3101,-10767.8873 654.4731,-10700.1071 717.5374,-10578.5445 627.4314,-9589.6814 690.4731,-9468.1071 719.8075,-9411.5365 773.2404,-9437.2391 805.1968,-9382.1071 870.5494,-9269.359 760.8911,-9193.7429 841.1968,-9091.1071 931.4967,-8975.698 1007.6597,-9011.5389 1149.0681,-8973.1071 1167.3757,-8968.1315 1220.5375,-8973.158 1233.2849,-8959.1071"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-6196.1125 180.0456,-6196.1125 180.0456,-6174.1017 267.6355,-6174.1017 267.6355,-6196.1125"/>
<text text-anchor="middle" x="223.8406" y="-6181.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M65.5409,-12080.876C72.9167,-11806.17 213.2177,-6580.7488 223.2727,-6206.2571"/>
<polygon fill="#00ff66" stroke="#00ff66" points="226.7732,-6206.281 223.543,-6196.1906 219.7758,-6206.093 226.7732,-6206.281"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge757" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M65.3477,-12080.8158C67.7734,-11829.1717 110.6781,-7443.2432 166.4788,-6165.1071 182.336,-5801.8914 187.9597,-5710.8938 223.8406,-5349.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M747.835,-633.1071C873.5993,-422.4531 832.114,-275.4727 1055.9857,-175.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M223.8406,-5349.1071C243.7666,-5148.1928 189.5845,-1872.5592 317.2024,-1716.1071 340.8162,-1687.1579 365.5835,-1713.6417 399.0839,-1697.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M585.7192,-1050.1071C671.3777,-910.6642 610.6373,-839.9635 690.4731,-697.1071 709.1074,-663.7634 726.9258,-665.0734 747.835,-633.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M399.0839,-1697.1071C655.6993,-1570.4506 316.3154,-1268.1486 516.9653,-1064.1071 538.8304,-1041.8724 569.3967,-1076.6785 585.7192,-1050.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1055.9857,-175.1071C1500.3467,85.5681 1689.9489,-23.1071 2205.1267,-23.1071 2205.1267,-23.1071 2205.1267,-23.1071 2398.3579,-23.1071 2879.5539,-23.1071 3084.0205,53.2078 3456.7698,-251.1071 3541.7436,-320.4802 3488.6199,-390.526 3555.9763,-477.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3555.9763,-477.1071C3667.8868,-618.0799 3714.4442,-13139.9125 3716.5554,-13724.0157"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3713.0554,-13724.072 3716.5915,-13734.0593 3720.0554,-13724.0467 3713.0554,-13724.072"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-7678.1125 536.1602,-7678.1125 536.1602,-7656.1017 635.2783,-7656.1017 635.2783,-7678.1125"/>
<text text-anchor="middle" x="585.7192" y="-7663.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge769" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M223.8406,-5349.1071C260.205,-4970.8011 262.2294,-5823.0542 317.2024,-6199.1071 404.0526,-6793.2212 553.706,-7514.694 581.2838,-7646.0711"/>
<polygon fill="#00cbff" stroke="#00cbff" points="577.8965,-7646.971 583.3795,-7656.0367 584.7466,-7645.5305 577.8965,-7646.971"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-13111.1125 344.7839,-13111.1125 344.7839,-13089.1017 453.3838,-13089.1017 453.3838,-13111.1125"/>
<text text-anchor="middle" x="399.0839" y="-13096.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge777" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-12871.1071C260.8205,-12963.7067 242.1712,-13009.4373 317.2024,-13075.1071 322.4626,-13079.711 328.5537,-13083.4671 334.9928,-13086.5315"/>
<polygon fill="#0066ff" stroke="#0066ff" points="334.0428,-13089.9273 344.6196,-13090.5444 336.7361,-13083.4662 334.0428,-13089.9273"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge781" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-1697.1071C431.3883,-1678.343 451.5619,-1693.0614 480.9653,-1716.1071 508.8116,-1737.9323 495.4655,-1759.0088 516.9653,-1787.1071 566.9734,-1852.4632 611.5089,-1840.9195 654.4731,-1911.1071 722.092,-2021.5713 783.2826,-2346.4575 805.1968,-2474.1071 888.5428,-2959.5955 900.294,-3565.2109 901.8315,-3684.9831"/>
<polygon fill="#0000ff" stroke="#0000ff" points="898.3323,-3685.0791 901.9505,-3695.037 905.3318,-3684.9962 898.3323,-3685.0791"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1305.1225,-12613.1125 1161.4474,-12613.1125 1161.4474,-12591.1017 1305.1225,-12591.1017 1305.1225,-12613.1125"/>
<text text-anchor="middle" x="1233.2849" y="-12598.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge783" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M902.05,-12871.1071C950.8157,-12868.109 951.5209,-12911.1918 998.9033,-12923.1071 1048.1112,-12935.4815 1074.389,-12955.9471 1113.0681,-12923.1071 1188.2612,-12859.2653 1108.257,-12793.9082 1149.0681,-12704.1071 1164.2664,-12670.6648 1193.3526,-12639.1908 1213.0371,-12620.2825"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1215.6778,-12622.6043 1220.5771,-12613.2103 1210.8889,-12617.4987 1215.6778,-12622.6043"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge791" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-1697.1071C558.3268,-1607.9253 481.3407,-1806.3049 516.9653,-2243.1071 569.5859,-2888.3006 605.6726,-3047.6134 654.4731,-3693.1071 675.8835,-3976.3055 655.4181,-4049.2722 690.4731,-4331.1071 769.1458,-4963.617 848.4149,-5112.0899 962.9033,-5739.1071 999.8556,-5941.4832 1040.5466,-6187.1591 1052.5041,-6259.873"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1049.097,-6260.7244 1054.1716,-6270.0249 1056.0045,-6259.5898 1049.097,-6260.7244"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-12464.1125 334.3841,-12464.1125 334.3841,-12442.1017 463.7837,-12442.1017 463.7837,-12464.1125"/>
<text text-anchor="middle" x="399.0839" y="-12449.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge800" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M223.8406,-12871.1071C271.5544,-12990.5851 264.4243,-12714.436 317.2024,-12597.1071 337.9931,-12550.8881 368.9602,-12500.0658 386.2417,-12472.8788"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="389.2944,-12474.602 391.7445,-12464.2943 383.4012,-12470.8243 389.2944,-12474.602"/>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M66.0287,-12103.5227C71.3168,-12175.5669 105.087,-12573.7418 223.8406,-12871.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-5284.1125 350.2841,-5284.1125 350.2841,-5262.1017 447.8836,-5262.1017 447.8836,-5284.1125"/>
<text text-anchor="middle" x="399.0839" y="-5269.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge801" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M223.8406,-5349.1071C228.7136,-5298.4117 290.8079,-5281.1898 339.7149,-5275.5242"/>
<polygon fill="#ff0066" stroke="#ff0066" points="340.3324,-5278.9794 349.9256,-5274.4827 339.622,-5272.0156 340.3324,-5278.9794"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-12376.1071C523.9911,-12363.8451 876.2005,-12433.8529 962.9033,-12343.1071 1016.4461,-12287.0676 988.7421,-9629.9446 998.9033,-9553.1071 1025.7848,-9349.833 1081.949,-9308.7758 1113.0681,-9106.1071 1157.5182,-8816.618 1075.1934,-8731.519 1149.0681,-8448.1071 1164.4204,-8389.2097 1200.8806,-8326.5936 1220.4102,-8295.6944"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.4301,-8297.4689 1225.8855,-8287.1625 1217.5389,-8293.6883 1223.4301,-8297.4689"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-11969.1125 539.0902,-11969.1125 539.0902,-11947.1017 632.3482,-11947.1017 632.3482,-11969.1125"/>
<text text-anchor="middle" x="585.7192" y="-11954.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-11921.1071C425.1146,-11915.9173 492.014,-11931.8248 538.2117,-11944.3865"/>
<polygon fill="#ff0000" stroke="#ff0000" points="537.452,-11947.8075 548.0224,-11947.088 539.3104,-11941.0587 537.452,-11947.8075"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1101.9457,-12121.1125 1010.0257,-12121.1125 1010.0257,-12099.1017 1101.9457,-12099.1017 1101.9457,-12121.1125"/>
<text text-anchor="middle" x="1055.9857" y="-12106.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-12871.1071C259.9235,-12961.4608 243.9195,-12737.1022 317.2024,-12673.1071 387.3233,-12611.8733 425.8845,-12629.3634 516.9653,-12610.1071 559.0873,-12601.2017 867.324,-12592.5565 902.05,-12567.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M902.05,-12567.1071C924.4091,-12548.524 945.5043,-12566.3994 962.9033,-12543.1071 1017.374,-12470.1867 945.796,-12209.0263 998.9033,-12135.1071 1001.1502,-12131.9797 1003.8758,-12129.2387 1006.9035,-12126.837"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1009.0307,-12129.6286 1015.5024,-12121.2401 1005.2121,-12123.7619 1009.0307,-12129.6286"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-12189.1125 168.8556,-12189.1125 168.8556,-12167.1017 278.8255,-12167.1017 278.8255,-12189.1125"/>
<text text-anchor="middle" x="223.8406" y="-12174.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M85.649,-12103.174C113.3664,-12118.2035 163.0737,-12145.1568 194.708,-12162.3102"/>
<polygon fill="#ff0000" stroke="#ff0000" points="193.0501,-12165.3926 203.5093,-12167.0826 196.3868,-12159.2391 193.0501,-12165.3926"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-10791.1125 340.6161,-10791.1125 340.6161,-10769.1017 457.5516,-10769.1017 457.5516,-10791.1125"/>
<text text-anchor="middle" x="399.0839" y="-10776.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-11921.1071C350.2804,-11706.7536 160.9174,-10998.7806 317.2024,-10805.1071 321.0891,-10800.2905 325.8779,-10796.3794 331.1723,-10793.2067"/>
<polygon fill="#00ffff" stroke="#00ffff" points="333.1195,-10796.1457 340.4899,-10788.5347 329.9819,-10789.8882 333.1195,-10796.1457"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M79.2377,-12080.7719C109.7734,-12055.342 182.9023,-11990.5097 223.8406,-11921.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-10981.1125 528.0262,-10981.1125 528.0262,-10959.1017 643.4123,-10959.1017 643.4123,-10981.1125"/>
<text text-anchor="middle" x="585.7192" y="-10966.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10857.1071C438.7554,-10805.1384 459.433,-10914.0489 516.9653,-10945.1071 524.1165,-10948.9676 531.988,-10952.4601 539.773,-10955.5273"/>
<polygon fill="#ff0000" stroke="#ff0000" points="538.5797,-10958.8177 549.1719,-10959.0539 541.0388,-10952.2639 538.5797,-10958.8177"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-10599.1125 517.2105,-10599.1125 517.2105,-10577.1017 654.2279,-10577.1017 654.2279,-10599.1125"/>
<text text-anchor="middle" x="585.7192" y="-10584.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-10857.1071C421.9489,-10827.1545 454.5974,-10862.0273 480.9653,-10835.1071 527.7306,-10787.3622 489.7311,-10750.1388 516.9653,-10689.1071 530.8198,-10658.0593 554.2772,-10626.2975 569.8819,-10606.8865"/>
<polygon fill="#00ffff" stroke="#00ffff" points="572.6112,-10609.0779 576.2371,-10599.1228 567.1945,-10604.644 572.6112,-10609.0779"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-11921.1071C341.7318,-11721.246 169.9293,-11060.4209 317.2024,-10881.1071 341.2715,-10851.8015 376.073,-10887.2507 399.0839,-10857.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge741" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-14999.1071C1884.7817,-15011.0716 1950.017,-15021.0572 2205.1267,-14999.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-14999.1071C2358.5376,-14982.0199 2378.8618,-14902.8551 2478.6731,-14785.1071 2500.2786,-14759.6189 2489.1915,-14740.7203 2514.6731,-14719.1071 2617.6393,-14631.7723 2666.5128,-14619.1071 2801.5291,-14619.1071 2801.5291,-14619.1071 2801.5291,-14619.1071 3169.983,-14619.1071 3418.1119,-14619.1071 3381.3719,-14376.5031 3456.7698,-14140.1071 3466.6779,-14109.0421 3542.6825,-13056.0417 3554.4483,-12892.3894"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3557.9569,-12892.3948 3555.1827,-12882.1696 3550.9749,-12891.893 3557.9569,-12892.3948"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1877.6839,-1099.1125 1752.2157,-1099.1125 1752.2157,-1077.1017 1877.6839,-1077.1017 1877.6839,-1099.1125"/>
<text text-anchor="middle" x="1814.9498" y="-1084.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge746" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1055.9857,-557.1071C1191.0741,-502.3931 1600.0241,-510.4849 1710.019,-606.1071 1781.3888,-668.1511 1807.7117,-981.8664 1813.5948,-1066.8491"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1810.1189,-1067.3275 1814.2789,-1077.0715 1817.1033,-1066.86 1810.1189,-1067.3275"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2281.9588,-1515.1125 2128.2946,-1515.1125 2128.2946,-1493.1017 2281.9588,-1493.1017 2281.9588,-1515.1125"/>
<text text-anchor="middle" x="2205.1267" y="-1500.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge747" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M902.05,-633.1071C948.3143,-637.0847 1680.1219,-811.5773 1710.019,-847.1071 1769.1916,-917.428 1689.3284,-1186.7704 1746.019,-1259.1071 1796.1546,-1323.0796 2026.4356,-1329.3609 2092.2107,-1377.1071 2113.7911,-1392.7723 2110.8737,-1404.8454 2128.2107,-1425.1071 2146.9269,-1446.9807 2170.1977,-1470.4184 2186.2125,-1486.0336"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2183.8204,-1488.5892 2193.4397,-1493.0297 2188.6891,-1483.5597 2183.8204,-1488.5892"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1877.0946,-1250.1125 1752.805,-1250.1125 1752.805,-1228.1017 1877.0946,-1228.1017 1877.0946,-1250.1125"/>
<text text-anchor="middle" x="1814.9498" y="-1235.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge748" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M902.05,-633.1071C1048.7762,-645.0999 1086.0694,-633.1071 1233.2849,-633.1071 1233.2849,-633.1071 1233.2849,-633.1071 1432.7505,-633.1071 1556.4417,-633.1071 1622.8492,-569.3521 1710.019,-657.1071 1780.8741,-728.4377 1718.0392,-1011.5378 1746.019,-1108.1071 1758.2587,-1150.3508 1784.9387,-1194.6578 1801.2825,-1219.3909"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1798.5005,-1221.526 1806.9886,-1227.8666 1804.3072,-1217.6167 1798.5005,-1221.526"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-6487.1071C1682.3816,-6504.2157 1747.02,-6482.1934 1784.3223,-6465.5279"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1786.0318,-6468.5935 1793.64,-6461.2202 1783.0943,-6462.2397 1786.0318,-6468.5935"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3935.1071C415.454,-3880.2342 464.1387,-3965.0081 516.9653,-3987.1071 519.019,-3987.9662 1111.7085,-4221.3444 1113.0681,-4223.1071 1194.5484,-4328.7409 1062.443,-4419.6496 1149.0681,-4521.1071 1199.6116,-4580.305 1269.9147,-4507.5075 1317.5017,-4569.1071 1372.2308,-4639.9518 1315.9345,-6098.8485 1353.5017,-6180.1071 1393.0668,-6265.6873 1449.2036,-6250.7787 1511.9993,-6321.1071 1572.1179,-6388.4374 1543.0532,-6459.5538 1629.0092,-6487.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M585.7192,-1431.1071C773.6854,-1288.2418 912.9421,-1369.8419 1113.0681,-1495.1071 1638.2949,-1823.8633 1603.0916,-2099.5768 1919.8806,-2632.1071 1993.2379,-2755.4225 2046.7289,-2769.0211 2092.2107,-2905.1071 2154.124,-3090.3579 2057.7921,-3160.9195 2128.2107,-3343.1071 2168.6403,-3447.7069 2242.7598,-3438.0713 2282.0427,-3543.1071 2328.6778,-3667.8012 2235.9381,-4036.3107 2318.0427,-4141.1071 2320.5547,-4144.3133 2323.4726,-4147.1176 2326.6782,-4149.5695"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2324.8544,-4152.5574 2335.1716,-4154.9668 2328.6087,-4146.6494 2324.8544,-4152.5574"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M223.8406,-12871.1071C245.0596,-12924.6936 267.5834,-12810.4281 317.2024,-12781.1071 325.2851,-12776.3309 956.6506,-12588.1104 962.9033,-12581.1071 1020.1444,-12516.9953 971.3995,-12472.5344 998.9033,-12391.1071 1035.169,-12283.7396 1079.7522,-12271.4262 1113.0681,-12163.1071 1148.658,-12047.3947 1086.4672,-11996.7272 1149.0681,-11893.1071 1207.2852,-11796.7433 1331.2633,-11734.0984 1394.2705,-11707.1927"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1395.9703,-11710.2753 1403.8399,-11703.1817 1393.2642,-11703.8195 1395.9703,-11710.2753"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-2449.1125 358.7923,-2449.1125 358.7923,-2427.1017 439.3754,-2427.1017 439.3754,-2449.1125"/>
<text text-anchor="middle" x="399.0839" y="-2434.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M223.8406,-5349.1071C253.1831,-5043.851 383.9477,-2709.0625 397.8805,-2459.6664"/>
<polygon fill="#9cff00" stroke="#9cff00" points="401.3916,-2459.5627 398.4548,-2449.3831 394.4025,-2459.1724 401.3916,-2459.5627"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1095.2237,-4289.1125 1016.7477,-4289.1125 1016.7477,-4267.1017 1095.2237,-4267.1017 1095.2237,-4289.1125"/>
<text text-anchor="middle" x="1055.9857" y="-4274.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M747.835,-4279.1071C838.5894,-4288.9274 945.26,-4285.2126 1006.3124,-4281.6429"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="1006.6692,-4285.1278 1016.4384,-4281.0275 1006.2444,-4278.1407 1006.6692,-4285.1278"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M585.7192,-4203.1071C663.2607,-4185.2279 668.8699,-4269.2654 747.835,-4279.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge487" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1055.9857,-175.1071C1210.4492,-110.4475 1265.2995,-175.1071 1432.7505,-175.1071 1432.7505,-175.1071 1432.7505,-175.1071 1814.9498,-175.1071 1940.3254,-175.1071 1972.4313,-190.0676 2092.2107,-227.1071 2367.4555,-312.2213 3244.4389,-766.0626 3252.9207,-779.1071 3337.8124,-909.6656 3369.572,-3449.9114 3372.6019,-3709.7079"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3369.106,-3710.0947 3372.7213,-3720.0536 3376.1055,-3710.0138 3369.106,-3710.0947"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge630" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M399.0839,-14581.1071C458.0442,-14631.1563 452.0411,-14667.0822 516.9653,-14709.1071 795.8978,-14889.6579 901.4649,-14940.3526 1233.2849,-14923.1071"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1233.2849,-14923.1071C1431.3221,-14904.4113 1925.4502,-14779.5469 2092.2107,-14671.1071 2344.6266,-14506.9679 2786.4232,-13855.1293 2880.4805,-13569.1071 2963.6,-13316.3457 2981.0735,-12434.2215 2983.4507,-12285.4808"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2986.9519,-12285.426 2983.6067,-12275.3731 2979.9527,-12285.3179 2986.9519,-12285.426"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1490.1536,-4671.1125 1375.3474,-4671.1125 1375.3474,-4649.1017 1490.1536,-4649.1017 1490.1536,-4671.1125"/>
<text text-anchor="middle" x="1432.7505" y="-4656.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge641" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M585.7192,-1621.1071C690.9152,-1600.5097 721.6936,-1653.8935 805.1968,-1721.1071 1101.0706,-1959.2624 1193.6983,-2046.0362 1317.5017,-2405.1071 1379.0128,-2583.5097 1338.1834,-3915.0208 1353.5017,-4103.1071 1370.6211,-4313.3076 1415.2372,-4565.1605 1428.7893,-4638.8764"/>
<polygon fill="#004eff" stroke="#004eff" points="1425.3626,-4639.5941 1430.6229,-4648.7909 1432.2459,-4638.3211 1425.3626,-4639.5941"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge705" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M399.0839,-12376.1071C430.7633,-12373.2037 942.3427,-12300.3821 962.9033,-12276.1071 994.5114,-12238.7888 996.1531,-8803.935 998.9033,-8755.1071 1026.8426,-8259.0733 1084.6885,-8139.1159 1113.0681,-7643.1071 1115.4484,-7601.5055 1123.2176,-4675.7891 1149.0681,-4643.1071 1150.3652,-4641.4673 1151.769,-4639.9435 1153.2643,-4638.5281"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1155.5899,-4641.1566 1161.431,-4632.3174 1151.3526,-4635.5848 1155.5899,-4641.1566"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M71.0224,-12103.4455C99.1785,-12156.8965 227.5596,-12380.9282 399.0839,-12376.1071"/>
</g>
<!-- sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~datacostestimate.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/datacostestimate.f90.html" xlink:title="DataCostEstimate.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.2128,-1747.1125 341.9549,-1747.1125 341.9549,-1725.1017 456.2128,-1725.1017 456.2128,-1747.1125"/>
<text text-anchor="middle" x="399.0839" y="-1732.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataCostEstimate.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge712" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacostestimate.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M223.8406,-5349.1071C242.9199,-5150.6212 196.4895,-1919.8178 317.2024,-1761.1071 321.3738,-1755.6226 326.7196,-1751.3047 332.6777,-1747.9107"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="334.2595,-1751.034 341.7796,-1743.5708 331.2467,-1744.7155 334.2595,-1751.034"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="962.7569,-1479.1125 841.3432,-1479.1125 841.3432,-1457.1017 962.7569,-1457.1017 962.7569,-1479.1125"/>
<text text-anchor="middle" x="902.05" y="-1464.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge714" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M747.835,-1545.1071C775.2641,-1541.735 781.3338,-1535.0457 805.1968,-1521.1071 822.6995,-1510.8836 823.6611,-1503.274 841.1968,-1493.1071 847.5144,-1489.4442 854.4722,-1486.0516 861.3564,-1483.0226"/>
<polygon fill="#ff0075" stroke="#ff0075" points="862.7671,-1486.2263 870.6311,-1479.1264 860.056,-1479.7726 862.7671,-1486.2263"/>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M399.0839,-1697.1071C456.3458,-1664.458 457.82,-1636.2058 516.9653,-1607.1071 612.2968,-1560.2054 642.3845,-1558.0711 747.835,-1545.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1283.4379,-4674.1125 1183.132,-4674.1125 1183.132,-4652.1017 1283.4379,-4652.1017 1283.4379,-4674.1125"/>
<text text-anchor="middle" x="1233.2849" y="-4659.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4203.1071C643.1251,-4189.8707 1071.629,-4216.233 1113.0681,-4258.1071 1173.3552,-4319.0271 1093.2043,-4577.107 1149.0681,-4642.1071 1155.41,-4649.4862 1163.9105,-4654.4789 1173.0772,-4657.8195"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1172.2246,-4661.2177 1182.8084,-4660.7335 1174.2328,-4654.5119 1172.2246,-4661.2177"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-5349.1071C276.7694,-4817.6122 65.2515,-4323.1141 585.7192,-4203.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-1697.1071C432.5542,-1680.5117 454.3886,-1689.8517 480.9653,-1716.1071 528.8165,-1763.3798 482.464,-1805.3654 516.9653,-1863.1071 559.1757,-1933.7506 616.8943,-1913.8947 654.4731,-1987.1071 671.6659,-2020.6026 801.3816,-3296.6507 805.1968,-3334.1071 814.0611,-3421.1345 785.7567,-3658.4407 841.1968,-3726.1071 921.1019,-3823.6339 1031.3849,-3711.0647 1113.0681,-3807.1071 1194.0695,-3902.3478 1089.0087,-3976.4491 1149.0681,-4086.1071 1195.965,-4171.7326 1273.7862,-4139.8146 1317.5017,-4227.1071 1382.9758,-4357.8478 1277.976,-4758.9038 1353.5017,-4884.1071 1395.9227,-4954.4309 1468.4873,-4909.453 1511.9993,-4979.1071 1561.3947,-5058.1795 1527.3688,-5306.1855 1547.9993,-5397.1071 1564.7805,-5471.0644 1601.3181,-5553.7561 1619.0109,-5591.4161"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1616.0164,-5593.2692 1623.4694,-5600.7993 1622.339,-5590.265 1616.0164,-5593.2692"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1697.1071C432.8433,-1681.1081 456.0156,-1688.301 480.9653,-1716.1071 525.6603,-1765.919 495.1991,-1951.8213 516.9653,-2015.1071 555.4526,-2127.0096 620.9262,-2129.6256 654.4731,-2243.1071 725.0037,-2481.6958 648.3026,-3116.9118 690.4731,-3362.1071 727.8709,-3579.5518 724.7175,-3647.7214 841.1968,-3835.1071 892.5889,-3917.784 921.3381,-3928.2832 998.9033,-3987.1071 1045.7801,-4022.6574 1079.4298,-4005.84 1113.0681,-4054.1071 1164.9586,-4128.564 1110.5289,-4172.9416 1149.0681,-4255.1071 1198.4176,-4360.3201 1276.2919,-4346.4475 1317.5017,-4455.1071 1374.0995,-4604.3407 1323.4989,-5734.3467 1353.5017,-5891.1071 1367.7195,-5965.393 1404.5299,-6047.9252 1422.5329,-6085.4814"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1419.5599,-6087.3716 1427.0775,-6094.8372 1425.8564,-6084.313 1419.5599,-6087.3716"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1507.4222,-12691.1125 1358.0788,-12691.1125 1358.0788,-12669.1017 1507.4222,-12669.1017 1507.4222,-12691.1125"/>
<text text-anchor="middle" x="1432.7505" y="-12676.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-13061.1071C528.0639,-13102.773 557.1324,-12995.4411 690.4731,-12971.1071 875.5909,-12937.324 948.3011,-13036.0011 1113.0681,-12945.1071 1137.0448,-12931.8803 1130.9505,-12915.6395 1149.0681,-12895.1071 1169.5857,-12871.8548 1326.702,-12720.7089 1353.5017,-12705.1071 1360.5042,-12701.0305 1368.2486,-12697.5393 1376.0722,-12694.5729"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1377.3426,-12697.8363 1385.6102,-12691.2108 1375.0154,-12691.2344 1377.3426,-12697.8363"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-12871.1071C254.5374,-12949.9907 250.9495,-12984.4243 317.2024,-13037.1071 346.8848,-13060.7099 363.8586,-13047.0601 399.0839,-13061.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1697.1071C479.3969,-1657.4674 497.4049,-1636.0089 585.7192,-1621.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1621.1071C843.3923,-1577.6283 949.3547,-1677.4316 1113.0681,-1881.1071 1554.1706,-2429.8818 1569.109,-2635.3104 1883.8806,-3265.1071 1985.6684,-3468.7646 2017.6688,-3517.9778 2092.2107,-3733.1071 2113.527,-3794.6264 2083.7159,-3827.5758 2128.2107,-3875.1071 2134.6234,-3881.9574 2142.9295,-3886.9348 2151.7035,-3890.5504"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2150.7457,-3893.9241 2161.3405,-3893.9633 2153.0826,-3887.3257 2150.7457,-3893.9241"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-5425.1071C424.627,-5453.1372 457.4518,-5419.3539 480.9653,-5449.1071 576.5796,-5570.0943 441.8108,-6007.4527 516.9653,-6142.1071 553.167,-6206.9696 616.1521,-6173.4738 654.4731,-6237.1071 724.6629,-6353.6593 604.4573,-6435.6922 690.4731,-6541.1071 724.4309,-6582.7233 769.1594,-6539.2781 805.1968,-6579.1071 854.391,-6633.4773 803.68,-6677.1096 841.1968,-6740.1071 859.5481,-6770.9223 881.2522,-6763.8873 902.05,-6793.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M585.7192,-1431.1071C633.4768,-1394.3956 636.7837,-1372.4195 690.4731,-1345.1071 940.8736,-1217.7257 1066.4894,-1138.9359 1317.5017,-1265.1071 2081.5797,-1649.1705 2191.9772,-2934.3114 2203.8765,-3116.5436"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2200.3958,-3116.964 2204.5116,-3126.7267 2207.3822,-3116.5282 2200.3958,-3116.964"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-1697.1071C499.6125,-1647.4896 440.624,-1556.2041 516.9653,-1474.1071 541.5085,-1447.7136 557.0252,-1452.9162 585.7192,-1431.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-3935.1071C427.6247,-3834.3561 436.2929,-3797.8702 516.9653,-3731.1071 541.8996,-3710.472 567.002,-3733.5114 585.7192,-3707.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-3707.1071C844.9393,-3341.4272 975.7032,-2723.1232 1317.5017,-3013.1071 1392.3839,-3076.6376 1315.0053,-3140.7662 1353.5017,-3231.1071 1399.62,-3339.3346 1441.8217,-3348.6867 1511.9993,-3443.1071 1600.3434,-3561.9697 1651.5964,-3575.0196 1710.019,-3711.1071 1746.3385,-3795.7082 1710.4347,-3830.1942 1746.019,-3915.1071 1808.3884,-4063.9355 1940.3742,-4211.1892 1988.2357,-4261.7317"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1985.7351,-4264.1811 1995.1713,-4268.9986 1990.7989,-4259.348 1985.7351,-4264.1811"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1305.8704,-3985.1125 1160.6994,-3985.1125 1160.6994,-3963.1017 1305.8704,-3963.1017 1305.8704,-3985.1125"/>
<text text-anchor="middle" x="1233.2849" y="-3970.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M747.835,-4011.1071C776.1857,-4013.9056 970.5632,-3962.0111 998.9033,-3959.1071 1049.3789,-3953.9349 1062.4259,-3955.9599 1113.0681,-3959.1071 1125.2428,-3959.8637 1138.0712,-3961.0474 1150.6323,-3962.4257"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1150.2983,-3965.9103 1160.631,-3963.5685 1151.0932,-3958.9555 1150.2983,-3965.9103"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-3935.1071C431.7471,-3825.8799 545.5903,-3925.3135 654.4731,-3959.1071 699.8348,-3973.1858 701.0163,-4003.1136 747.835,-4011.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-4011.1071C1045.011,-4065.6738 1190.8964,-4107.7675 1317.5017,-4382.1071 1400.6459,-4562.2712 1279.9258,-4642.8284 1353.5017,-4827.1071 1404.5395,-4954.9366 1439.5436,-4983.3569 1547.9993,-5068.1071 1616.7522,-5121.8325 1712.5487,-5159.0536 1768.7275,-5177.8858"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1767.8106,-5181.2689 1778.4038,-5181.0787 1770.0041,-5174.6214 1767.8106,-5181.2689"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-12567.1071C924.4091,-12548.524 945.4293,-12566.3432 962.9033,-12543.1071 1013.8846,-12475.315 944.7843,-12228.4217 998.9033,-12163.1071 1032.602,-12122.4371 1080.8023,-12171.9229 1113.0681,-12130.1071 1210.9101,-12003.306 1050.9875,-10815.7237 1149.0681,-10689.1071 1196.7362,-10627.5702 1269.2608,-10702.196 1317.5017,-10641.1071 1374.297,-10569.1855 1340.6488,-9907.8442 1353.5017,-9817.1071 1370.1756,-9699.3955 1410.4265,-9562.1694 1426.2276,-9510.8565"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1429.5879,-9511.837 1429.211,-9501.2489 1422.9028,-9509.761 1429.5879,-9511.837"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge473" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-633.1071C782.9694,-574.2572 833.5708,-635.9935 902.05,-633.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-557.1071C1321.3789,-438.2825 1434.0066,-448.6196 1710.019,-540.1071 1757.1226,-555.7201 2438.3795,-966.1427 2478.6731,-995.1071 2751.5256,-1191.243 2906.4162,-1185.7919 3051.0454,-1489.1071 3072.8915,-1534.9225 3161.6636,-4985.0671 3169.4386,-5288.8026"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3165.9434,-5289.0376 3169.6981,-5298.9448 3172.9411,-5288.8585 3165.9434,-5289.0376"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-633.1071C978.2822,-629.8939 984.4059,-583.5268 1055.9857,-557.1071"/>
</g>
<!-- sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~datadefineequip.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/datadefineequip.f90.html" xlink:title="Datadefineequip.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="800.8274,-1023.1125 694.8425,-1023.1125 694.8425,-1001.1017 800.8274,-1001.1017 800.8274,-1023.1125"/>
<text text-anchor="middle" x="747.835" y="-1008.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Datadefineequip.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge480" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-1050.1071C606.3169,-1018.1142 648.5906,-1008.9746 684.8052,-1007.6454"/>
<polygon fill="#00ffff" stroke="#00ffff" points="684.9004,-1011.1443 694.8359,-1007.4651 684.7746,-1004.1455 684.9004,-1011.1443"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-13080.1071C1098.5776,-13091.1148 1322.0001,-13154.6458 1710.019,-12819.1071 1723.1626,-12807.7412 1877.4159,-12575.2361 1883.8806,-12559.1071 1918.4594,-12472.8359 1890.6023,-12441.3182 1919.8806,-12353.1071 1973.3729,-12191.943 2046.6887,-12175.7012 2092.2107,-12012.1071 2149.561,-11806.005 2098.4904,-11743.9651 2128.2107,-11532.1071 2235.0803,-10770.299 2390.7348,-10601.3319 2478.6731,-9837.1071 2514.9096,-9522.1952 2445.726,-8720.5079 2514.6731,-8411.1071 2529.8167,-8343.1501 2568.8419,-8269.6661 2588.6743,-8235.1556"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2591.7118,-8236.8945 2593.7233,-8226.4923 2585.664,-8233.3698 2591.7118,-8236.8945"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-1813.1071C410.6744,-1777.2515 456.1396,-1819.4558 480.9653,-1791.1071 562.1741,-1698.3741 443.4576,-1615.056 516.9653,-1516.1071 540.5265,-1484.3914 804.746,-1385.3503 841.1968,-1370.1071 910.5307,-1341.1126 927.0164,-1331.0192 998.9033,-1309.1071 1064.3593,-1289.1552 1081.2686,-1284.3692 1149.0681,-1275.1071 1239.199,-1262.7943 1262.5609,-1267.33 1353.5017,-1265.1071 1423.924,-1263.3858 1443.1211,-1250.3399 1511.9993,-1265.1071 1606.3446,-1285.3343 1630.212,-1299.8758 1710.019,-1354.1071 1728.4762,-1366.6493 1727.6475,-1376.4397 1746.019,-1389.1071 1816.1996,-1437.4973 1840.0745,-1440.1419 1919.8806,-1470.1071 1994.541,-1498.1402 2030.5089,-1469.5807 2092.2107,-1520.1071 2118.9724,-1542.0218 2101.4074,-1567.2433 2128.2107,-1589.1071 2183.3146,-1634.056 2216.432,-1605.6831 2282.0427,-1633.1071 2472.4614,-1712.6985 2509.4823,-1755.1291 2686.5776,-1861.1071 2774.1501,-1913.5125 2830.8959,-1894.9071 2880.4805,-1984.1071 2906.934,-2031.6956 2914.5371,-5849.6951 2916.4805,-5904.1071 2931.7321,-6331.1316 2972.9947,-6851.8983 2982.0083,-6962.74"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2978.5393,-6963.2634 2982.8415,-6972.9454 2985.516,-6962.6937 2978.5393,-6963.2634"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.8406,-5349.1071C243.087,-5155.0457 200.829,-1996.5918 317.2024,-1840.1071 340.0692,-1809.3586 387.4122,-1849.6055 399.0839,-1813.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-1697.1071C432.5542,-1680.5117 455.4614,-1688.8084 480.9653,-1716.1071 549.5023,-1789.4671 459.2086,-1856.9903 516.9653,-1939.1071 557.1372,-1996.2223 617.6474,-1955.7792 654.4731,-2015.1071 701.2231,-2090.4233 681.5066,-2723.9159 690.4731,-2812.1071 733.6707,-3236.9811 603.2385,-3406.4808 841.1968,-3761.1071 876.4704,-3813.6749 911.3168,-3798.4133 962.9033,-3835.1071 1033.4338,-3885.2759 1069.704,-3884.2005 1113.0681,-3959.1071 1160.7308,-4041.439 1092.5446,-4093.5868 1149.0681,-4170.1071 1198.8888,-4237.5533 1272.1244,-4184.5948 1317.5017,-4255.1071 1371.3608,-4338.7994 1315.3106,-5058.2015 1353.5017,-5150.1071 1393.2664,-5245.7995 1468.6729,-5226.9737 1511.9993,-5321.1071 1541.0879,-5384.3068 1501.7159,-5580.1629 1547.9993,-5632.1071 1572.6012,-5659.7181 1592.1107,-5653.5833 1629.0092,-5651.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge427" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-1050.1071C624.0607,-990.5543 831.2221,-1089.1071 902.05,-1089.1071 902.05,-1089.1071 902.05,-1089.1071 1432.7505,-1089.1071 1544.7212,-1089.1071 2022.3088,-1763.6362 2092.2107,-1851.1071 2143.8617,-1915.74 2143.957,-1943.398 2205.1267,-1999.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2600.6254,-2721.1071C2610.6168,-2763.7052 2664.1388,-2731.5448 2686.5776,-2769.1071 2719.6883,-2824.5337 2718.5448,-5028.6699 2722.5776,-5093.1071 2739.8751,-5369.4847 2786.0751,-5703.2914 2798.446,-5789.8149"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2794.9856,-5790.3411 2799.8725,-5799.7416 2801.9144,-5789.3454 2794.9856,-5790.3411"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2205.1267,-1999.1071C2323.0954,-2105.8994 2394.6215,-2094.9903 2478.6731,-2230.1071 2597.4417,-2421.033 2549.2793,-2502.1956 2600.6254,-2721.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge443" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M747.835,-1545.1071C1044.33,-1474.2698 1114.9112,-1699.3258 1317.5017,-1927.1071 1417.7156,-2039.7819 1429.5571,-2078.8466 1511.9993,-2205.1071 1579.8287,-2308.9882 2053.9947,-3041.0747 2092.2107,-3159.1071 2123.1123,-3254.5486 2065.593,-3530.7297 2128.2107,-3609.1071 2150.5629,-3637.085 2195.9742,-3598.4861 2205.1267,-3633.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2205.1267,-3633.1071C2214.1311,-3666.6667 2259.4905,-3620.6738 2282.0427,-3647.1071 2341.2648,-3716.5206 2298.059,-5200.0782 2318.0427,-5289.1071 2331.8304,-5350.5322 2367.2785,-5416.6304 2386.1352,-5448.9638"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2383.3041,-5451.0519 2391.4122,-5457.8717 2389.3266,-5447.4841 2383.3041,-5451.0519"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-12871.1071C434.1228,-13424.0596 -26.4506,-14481.2521 480.9653,-14177.1071 772.2954,-14002.4839 639.4961,-13776.3895 841.1968,-13503.1071 1092.7333,-13162.3027 1274.5721,-13176.8871 1511.9993,-12826.1071 1534.5377,-12792.8083 1520.7081,-12772.6364 1547.9993,-12743.1071 1603.3321,-12683.2366 1659.4359,-12721.0411 1710.019,-12657.1071 1710.019,-12657.1071 2092.2107,-11196.1071 2092.2107,-11196.1071 2126.8602,-10989.4916 2061.2901,-10924.6322 2128.2107,-10726.1071 2168.4427,-10606.7557 2245.2504,-10608.5633 2282.0427,-10488.1071 2343.3014,-10287.5492 2293.4495,-8809.3648 2318.0427,-8601.1071 2333.7779,-8467.86 2376.2907,-8311.7491 2392.22,-8256.1054"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.6244,-8256.9313 2395.0356,-8246.3528 2388.8991,-8254.9896 2395.6244,-8256.9313"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node66" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node66"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2249.0108,-10757.1125 2161.2426,-10757.1125 2161.2426,-10735.1017 2249.0108,-10735.1017 2249.0108,-10757.1125"/>
<text text-anchor="middle" x="2205.1267" y="-10742.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1055.9857,-13023.1071C1143.7578,-12998.1967 1694.4662,-12786.9558 1710.019,-12771.1071 1796.6134,-12682.8657 2066.5856,-11847.0554 2092.2107,-11726.1071 2141.7895,-11492.0991 2099.7118,-11426.6057 2128.2107,-11189.1071 2147.8194,-11025.6963 2187.3018,-10830.9626 2200.6213,-10767.3444"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2204.0925,-10767.8449 2202.7275,-10757.3383 2197.2427,-10766.4029 2204.0925,-10767.8449"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-12795.1071C414.9995,-12790.9527 951.6891,-12626.1407 962.9033,-12614.1071 1008.7613,-12564.8985 972.2269,-12528.8551 998.9033,-12467.1071 1035.8808,-12381.5155 1079.5787,-12378.1227 1113.0681,-12291.1071 1149.2857,-12197.0029 1110.5803,-12160.3058 1149.0681,-12067.1071 1149.0681,-12067.1071 1353.5017,-11783.1071 1353.5017,-11783.1071 1383.789,-11764.0818 1415.4889,-11800.4331 1432.7505,-11769.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-12871.1071C254.0169,-12950.4579 317.5346,-12818.705 399.0839,-12795.1071"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node68" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node68"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2257.4094,-6193.1125 2152.844,-6193.1125 2152.844,-6171.1017 2257.4094,-6171.1017 2257.4094,-6193.1125"/>
<text text-anchor="middle" x="2205.1267" y="-6178.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-5425.1071C424.7538,-5453.0211 455.3515,-5421.1416 480.9653,-5449.1071 536.0691,-5509.27 463.2411,-5567.7092 516.9653,-5629.1071 654.947,-5786.7973 781.7219,-5676.8531 962.9033,-5782.1071 1162.9266,-5898.307 1145.2551,-6025.3843 1353.5017,-6126.1071 1513.0973,-6203.2988 1569.4451,-6181.266 1746.019,-6197.1071 1807.0458,-6202.582 1825.9253,-6216.992 1883.8806,-6197.1071 1903.0533,-6190.5288 1900.708,-6175.6854 1919.8806,-6169.1071 1998.1751,-6142.2437 2095.6855,-6155.9538 2154.0366,-6168.738"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2153.5846,-6172.2243 2164.1109,-6171.0218 2155.1322,-6165.3975 2153.5846,-6172.2243"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-5349.1071C232.2191,-5264.6266 340.7433,-5363.4343 399.0839,-5425.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1697.1071C426.3868,-1683.4199 583.3865,-1704.2556 654.4731,-1759.1071 680.9268,-1779.5191 670.9787,-1797.9702 690.4731,-1825.1071 734.2777,-1886.0842 764.3773,-1886.0928 805.1968,-1949.1071 994.8561,-2241.8902 1001.4545,-2340.5999 1113.0681,-2671.1071 1133.8995,-2732.7923 1119.3434,-2755.1808 1149.0681,-2813.1071 1202.1242,-2916.5006 1276.4806,-2904.3761 1317.5017,-3013.1071 1350.1998,-3099.7769 1294.2837,-4608.8747 1353.5017,-4680.1071 1399.5003,-4735.438 1455.4596,-4668.6027 1511.9993,-4713.1071 1541.3681,-4736.2244 1522.1802,-4762.0828 1547.9993,-4789.1071 1604.3162,-4848.0529 1646.9638,-4823.4327 1710.019,-4875.1071 1729.5619,-4891.1226 1729.8307,-4899.7072 1746.019,-4919.1071 1763.8509,-4940.4765 1784.5801,-4964.7615 1798.6134,-4981.121"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1796.1203,-4983.5901 1805.2908,-4988.8962 1801.4308,-4979.0295 1796.1203,-4983.5901"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node70" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node70"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="805.0589,-6691.1125 690.611,-6691.1125 690.611,-6669.1017 805.0589,-6669.1017 805.0589,-6691.1125"/>
<text text-anchor="middle" x="747.835" y="-6676.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-5349.1071C250.8171,-5076.6104 209.6147,-5706.2995 317.2024,-5958.1071 364.1195,-6067.916 433.4153,-6061.5707 480.9653,-6171.1071 520.0692,-6261.1868 453.7547,-6313.9548 516.9653,-6389.1071 558.6318,-6438.6451 611.9771,-6388.2789 654.4731,-6437.1071 708.0334,-6498.6481 653.6708,-6544.2951 690.4731,-6617.1071 699.2309,-6634.4341 714.0865,-6650.5541 726.4852,-6662.1503"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="724.4151,-6664.996 734.1893,-6669.0845 729.0981,-6659.7931 724.4151,-6664.996"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node71" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node71"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2052.6695,-5737.1125 1959.4218,-5737.1125 1959.4218,-5715.1017 2052.6695,-5715.1017 2052.6695,-5737.1125"/>
<text text-anchor="middle" x="2006.0457" y="-5722.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3707.1071C620.0877,-3658.3674 1055.7178,-3790.7458 1113.0681,-3807.1071 1204.4496,-3833.1771 1450.8656,-3888.3548 1511.9993,-3961.1071 1565.0455,-4024.2348 1515.1385,-4067.4818 1547.9993,-4143.1071 1649.7438,-4377.2604 1801.3113,-4367.5248 1883.8806,-4609.1071 1921.7784,-4719.9889 1865.0637,-5559.5401 1919.8806,-5663.1071 1930.981,-5684.0793 1952.5339,-5699.8331 1971.306,-5710.342"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1969.7655,-5713.4868 1980.2399,-5715.0795 1973.0449,-5707.3024 1969.7655,-5713.4868"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-5349.1071C239.1175,-5195.0704 220.3074,-4079.8219 317.2024,-3959.1071 340.9408,-3929.533 388.7478,-3971.5941 399.0839,-3935.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-3935.1071C592.2664,-3253.1608 429.9429,-2320.1356 1113.0681,-2509.1071 1312.2735,-2564.2129 1359.8555,-2608.2082 1511.9993,-2748.1071 1623.9763,-2851.072 2232.8857,-3736.148 2282.0427,-3880.1071 2305.1779,-3947.8595 2384.9577,-5077.6173 2396.8662,-5247.7312"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2393.3756,-5247.9892 2397.5646,-5257.7207 2400.3585,-5247.5009 2393.3756,-5247.9892"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-14581.1071C467.3636,-14639.0671 497.8255,-14639.8975 585.7192,-14657.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-14657.1071C748.1201,-14688.9052 1162.5247,-14577.1356 1317.5017,-14519.1071 1411.3372,-14483.972 1434.4137,-14468.5109 1511.9993,-14405.1071 2348.1904,-13721.7624 2472.4164,-13336.5543 2686.5776,-12278.1071 2698.7359,-12218.0172 2686.1548,-7913.4224 2722.5776,-7864.1071 2731.3756,-7852.1949 2745.8747,-7845.8213 2760.063,-7842.4578"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.0911,-7845.8245 2770.2534,-7840.5045 2759.7733,-7838.9497 2761.0911,-7845.8245"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-7249.1071C1095.1331,-7259.6586 1139.5866,-7269.9345 1174.1887,-7277.5595"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1173.6157,-7281.0169 1184.1331,-7279.7378 1175.1136,-7274.179 1173.6157,-7281.0169"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-5349.1071C230.7918,-5279.0372 271.2779,-5423.7306 317.2024,-5477.1071 383.9748,-5554.7144 438.7086,-5545.8558 480.9653,-5639.1071 535.9143,-5760.3675 459.2304,-6117.1482 516.9653,-6237.1071 552.654,-6311.2593 614.9955,-6288.9009 654.4731,-6361.1071 701.582,-6447.271 638.3231,-6495.8975 690.4731,-6579.1071 723.6196,-6631.9949 771.7597,-6607.4026 805.1968,-6660.1071 854.5183,-6737.8492 815.0192,-6775.8394 841.1968,-6864.1071 892.1396,-7035.8803 862.41,-7119.0434 998.9033,-7235.1071 1018.8034,-7252.0286 1030.764,-7242.309 1055.9857,-7249.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-13061.1071C437.8073,-13076.5491 544.1168,-13082.7898 585.7192,-13080.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-13023.1071C1086.3047,-13011.954 1090.9443,-13001.6479 1113.0681,-12978.1071 1132.3182,-12957.624 1128.4265,-12945.1871 1149.0681,-12926.1071 1212.6681,-12867.3189 1261.5063,-12894.1792 1317.5017,-12828.1071 1346.6942,-12793.6613 1319.1696,-12762.4332 1353.5017,-12733.1071 1408.213,-12686.3733 1458.9194,-12748.6859 1511.9993,-12700.1071 1552.7613,-12662.8017 1528.116,-12632.6618 1547.9993,-12581.1071 1608.522,-12424.1795 1668.5557,-12402.1103 1710.019,-12239.1071 1780.7984,-11960.8553 1680.8365,-11873.7229 1746.019,-11594.1071 1781.5474,-11441.6999 1845.6282,-11421.8536 1883.8806,-11270.1071 1926.6457,-11100.4589 1884.9878,-11049.5477 1919.8806,-10878.1071 1969.9553,-10632.0728 2047.7985,-10587.2263 2092.2107,-10340.1071 2107.7142,-10253.8423 2075.0916,-9621.8232 2128.2107,-9552.1071 2131.9723,-9547.1702 2136.728,-9543.1929 2142.0225,-9539.9909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2143.9949,-9542.917 2151.3609,-9535.3017 2140.8537,-9536.6614 2143.9949,-9542.917"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-13080.1071C634.4309,-13076.966 642.4966,-13056.104 690.4731,-13047.1071 850.4838,-13017.1006 905.2443,-13084.5954 1055.9857,-13023.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge402" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1813.1071C410.9659,-1777.347 455.2585,-1818.6593 480.9653,-1791.1071 537.8116,-1730.1801 466.2687,-1673.2392 516.9653,-1607.1071 570.2233,-1537.6339 1145.7467,-1279.1071 1233.2849,-1279.1071 1233.2849,-1279.1071 1233.2849,-1279.1071 1432.7505,-1279.1071 1595.3741,-1279.1071 2232.0506,-2316.3582 2282.0427,-2471.1071 2307.982,-2551.4013 2269.572,-2780.0376 2318.0427,-2849.1071 2363.4107,-2913.7554 2436.0589,-2858.6114 2478.6731,-2925.1071 2527.8515,-3001.8455 2459.5603,-6133.5132 2514.6731,-6206.1071 2520.1351,-6213.3016 2527.5479,-6218.5179 2535.7439,-6222.2834"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.6782,-6225.6234 2545.2681,-6225.9464 2537.191,-6219.0899 2534.6782,-6225.6234"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge517" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14581.1071C463.951,-14628.4844 463.1689,-14503.7586 516.9653,-14444.1071 579.4199,-14374.8551 767.4096,-14224.3629 805.1968,-14139.1071 889.1896,-13949.6016 756.3547,-13863.2339 841.1968,-13674.1071 869.691,-13610.5889 1676.5157,-12832.1318 1710.019,-12771.1071 2056.6739,-12139.6929 1979.4052,-11907.5341 2092.2107,-11196.1071 2125.0197,-10989.1913 2067.0263,-10926.4744 2128.2107,-10726.1071 2168.6584,-10593.6485 2245.6115,-10588.7262 2282.0427,-10455.1071 2347.5209,-10214.9524 2288.8637,-8462.312 2318.0427,-8215.1071 2333.5658,-8083.5953 2376.2083,-7929.669 2392.1959,-7874.8089"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.56,-7875.775 2395.0221,-7865.1938 2388.8441,-7873.8009 2395.56,-7875.775"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-12871.1071C290.5031,-13046.4853 200.6197,-14410.1041 317.2024,-14557.1071 340.7667,-14586.8201 370.1728,-14556.5656 399.0839,-14581.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge603" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-14657.1071C658.3445,-14671.3271 673.8318,-14695.5272 747.835,-14695.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M747.835,-14695.1071C812.4817,-14694.7401 1828.9483,-14477.192 1883.8806,-14443.1071 2123.4944,-14294.4294 2162.4693,-14204.4931 2282.0427,-13949.1071 2316.637,-13875.2204 2285.9178,-13844.1004 2318.0427,-13769.1071 2430.2981,-13507.0548 2586.0554,-13510.8804 2686.5776,-13244.1071 2738.6,-13106.0463 2705.6825,-13060.6734 2722.5776,-12914.1071 2751.1111,-12666.578 2788.6624,-12366.4089 2798.8713,-12285.2055"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2802.3508,-12285.5876 2800.1266,-12275.2289 2795.4055,-12284.7137 2802.3508,-12285.5876"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge616" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-12871.1071C308.2968,-13088.1398 518.5879,-12912.1177 747.835,-12871.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M747.835,-12871.1071C860.3477,-12834.4125 873.7371,-12791.921 962.9033,-12714.1071 1035.4113,-12650.8306 1060.0486,-12638.4206 1113.0681,-12558.1071 1135.6709,-12523.8686 1129.9369,-12509.3997 1149.0681,-12473.1071 1213.7953,-12350.3173 1259.9945,-12336.4394 1317.5017,-12210.1071 1341.1003,-12158.2655 1325.2471,-12136.5654 1353.5017,-12087.1071 1404.5819,-11997.6937 1471.0248,-12012.5795 1511.9993,-11918.1071 1560.9127,-11805.3304 1466.9002,-11458.487 1547.9993,-11366.1071 1554.9515,-11358.1878 1564.5905,-11353.4972 1574.7999,-11350.834"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1575.5708,-11354.2493 1584.6942,-11348.8628 1574.203,-11347.3843 1575.5708,-11354.2493"/>
</g>
<!-- sourcefile~datagenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node80" class="node">
<title>sourcefile~datagenerators.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node80"><a xlink:href="../sourcefile/datagenerators.f90.html" xlink:title="DataGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="800.0537,-12807.1125 695.6162,-12807.1125 695.6162,-12785.1017 800.0537,-12785.1017 800.0537,-12807.1125"/>
<text text-anchor="middle" x="747.835" y="-12792.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge498" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-12795.1071C479.3438,-12774.1573 504.9325,-12776.2909 585.7192,-12795.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge569" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-14581.1071C671.7451,-14567.034 1086.3866,-14095.6836 1149.0681,-14035.1071 1239.8014,-13947.4209 1256.6482,-13918.9823 1353.5017,-13838.1071 1503.4334,-13712.9101 1563.2344,-13709.9794 1710.019,-13581.1071 1794.8102,-13506.6632 1810.0691,-13481.4493 1883.8806,-13396.1071 1981.2001,-13283.5845 2037.9207,-13272.6171 2092.2107,-13134.1071 2169.7951,-12936.166 2085.7526,-12865.4273 2128.2107,-12657.1071 2225.115,-12181.6469 2393.2512,-12100.7638 2478.6731,-11623.1071 2530.5661,-11332.9355 2498.0064,-10591.4108 2514.6731,-10297.1071 2536.9216,-9904.238 2587.0838,-9426.1125 2598.3502,-9321.1265"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2601.8327,-9321.4759 2599.4236,-9311.1587 2594.873,-9320.7264 2601.8327,-9321.4759"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14581.1071C462.3215,-14634.7871 504.963,-14600.0536 585.7192,-14581.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge581" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-14581.1071C855.1365,-14549.9535 1400.6548,-14331.2779 1511.9993,-14251.1071 1842.7124,-14012.9853 1891.1205,-13895.5586 2092.2107,-13541.1071 2214.6441,-13325.2999 2226.5736,-13257.9456 2282.0427,-13016.1071 2316.5079,-12865.8431 2268.4024,-12817.0624 2318.0427,-12671.1071 2361.9009,-12542.1529 2440.0864,-12540.7355 2478.6731,-12410.1071 2528.4823,-12241.4866 2498.0478,-11003.1426 2514.6731,-10828.1071 2532.8839,-10636.3786 2580.7456,-10407.9628 2595.9313,-10338.3008"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2599.4282,-10338.694 2598.1529,-10328.1762 2592.5909,-10337.1937 2599.4282,-10338.694"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node83" class="node">
<title>sourcefile~dataphotovoltaics.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node83"><a xlink:href="../sourcefile/dataphotovoltaics.f90.html" xlink:title="DataPhotovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="959.1944,-14175.1125 844.9057,-14175.1125 844.9057,-14153.1017 959.1944,-14153.1017 959.1944,-14175.1125"/>
<text text-anchor="middle" x="902.05" y="-14160.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPhotovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge594" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-14581.1071C508.7079,-14646.9654 815.4404,-14273.2738 886.9932,-14183.2691"/>
<polygon fill="#0000ff" stroke="#0000ff" points="889.8802,-14185.2611 893.3429,-14175.2481 884.3918,-14180.9163 889.8802,-14185.2611"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge536" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-12871.1071C994.3743,-12863.0717 1084.5542,-12601.6375 1149.0681,-12535.1071 1215.2776,-12466.8282 1260.1554,-12478.9827 1317.5017,-12403.1071 1342.9809,-12369.3952 1327.2646,-12348.2325 1353.5017,-12315.1071 1407.2169,-12247.2896 1463.7759,-12273.9336 1511.9993,-12202.1071 1550.9383,-12144.1092 1507.784,-12106.2274 1547.9993,-12049.1071 1597.3973,-11978.9439 1668.0224,-12018.9357 1710.019,-11944.1071 1782.3174,-11815.2879 1703.1475,-10756.47 1746.019,-10615.1071 1779.3982,-10505.0442 1848.6486,-10505.591 1883.8806,-10396.1071 1924.1865,-10270.8558 1866.1438,-9925.2104 1919.8806,-9805.1071 1932.947,-9775.9033 1960.4302,-9750.9682 1980.8632,-9735.3761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1983.1565,-9738.0336 1989.1259,-9729.2806 1979.0009,-9732.4006 1983.1565,-9738.0336"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-12871.1071C813.3849,-12851.0834 834.7988,-12884.3363 902.05,-12871.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge524" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11921.1071C226.4499,-11916.6836 583.4202,-11992.5147 585.7192,-11997.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge666" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-14999.1071C1868.4141,-14996.8866 1899.0776,-14865.5965 2092.2107,-14724.1071 2630.2067,-14329.9709 2819.0369,-14163.3644 2983.7629,-13517.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-14923.1071C1412.2051,-14915.2734 1451.0789,-14978.7441 1629.0092,-14999.1071"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge650" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-14695.1071C1175.2654,-14725.7047 1305.9823,-14775.8913 1710.019,-14633.1071 1906.1092,-14563.81 1940.3103,-14505.1624 2092.2107,-14363.1071 2101.7758,-14354.1619 2679.943,-13642.3982 2686.5776,-13631.1071 2708.4033,-13593.9636 2695.4135,-13574.5452 2722.5776,-13541.1071 2775.718,-13475.6932 2840.3444,-13510.2149 2880.4805,-13436.1071 2907.6796,-13385.8862 2914.9377,-9381.1996 2916.4805,-9324.1071 2932.6362,-8726.2433 2974.679,-7993.8784 2982.5006,-7860.471"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2986.0025,-7860.5391 2983.0958,-7850.3508 2979.0146,-7860.1281 2986.0025,-7860.5391"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node88" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node88"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-5949.1125 323.0941,-5949.1125 323.0941,-5927.1017 475.0737,-5927.1017 475.0737,-5949.1125"/>
<text text-anchor="middle" x="399.0839" y="-5934.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge785" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-5349.1071C247.3967,-5104.048 172.5013,-5695.9326 317.2024,-5895.1071 326.0205,-5907.2449 339.3097,-5916.2506 352.6313,-5922.7938"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.2505,-5926.0106 361.8047,-5926.9384 354.1328,-5919.6314 351.2505,-5926.0106"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node89" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node89"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-5760.1125 317.3208,-5760.1125 317.3208,-5738.1017 480.847,-5738.1017 480.847,-5760.1125"/>
<text text-anchor="middle" x="399.0839" y="-5745.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge787" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-5349.1071C237.9346,-5202.4843 242.0882,-5540.3998 317.2024,-5667.1071 332.5047,-5692.92 357.7719,-5716.4902 376.1974,-5731.6684"/>
<polygon fill="#00ffff" stroke="#00ffff" points="374.1321,-5734.4987 384.1213,-5738.0295 378.5142,-5729.04 374.1321,-5734.4987"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge808" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14467.1071C420.3876,-14500.8847 453.4087,-14475.2036 480.9653,-14504.1071 510.9783,-14535.5869 483.8041,-14566.9631 516.9653,-14595.1071 577.7679,-14646.7102 1841.8792,-14882.5052 1919.8806,-14899.1071 1946.4421,-14904.7605 2371.9728,-15005.5333 2398.3579,-14999.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10741.1071C409.9191,-10776.86 451.5619,-10737.0614 480.9653,-10760.1071 508.8116,-10781.9323 487.4078,-10811.6621 516.9653,-10831.1071 588.5952,-10878.2302 820.4147,-10881.3194 902.05,-10855.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M399.0839,-10741.1071C484.3053,-10967.6278 473.2014,-8804.1387 516.9653,-8566.1071 535.1063,-8467.4384 519.6041,-8426.5617 585.7192,-8351.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M224.0674,-6196.3798C228.9694,-6438.7656 312.5481,-10511.093 399.0839,-10741.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M585.7192,-8351.1071C778.3081,-8131.3129 945.5786,-8185.8719 1233.2849,-8237.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M585.7192,-10817.1071C614.2402,-10801.8075 632.6108,-10816.9726 654.4731,-10793.1071 698.4523,-10745.0983 669.9236,-10712.8868 690.4731,-10651.1071 704.7055,-10608.3193 726.0512,-10560.0245 738.2922,-10533.4208"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="741.47,-10534.8876 742.5041,-10524.3434 735.1202,-10531.9413 741.47,-10534.8876"/>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M399.0839,-10741.1071C409.9191,-10776.86 446.0433,-10746.8359 480.9653,-10760.1071 530.5116,-10778.9359 539.0118,-10842.1626 585.7192,-10817.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M747.835,-8465.1071C923.912,-8494.3317 970.6223,-8451.8857 1149.0681,-8448.1071 1223.9107,-8446.5223 1242.9184,-8441.6836 1317.5017,-8448.1071 1335.5988,-8449.6657 1355.1191,-8452.5767 1372.8588,-8455.7048"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1372.6087,-8459.2167 1383.0737,-8457.5631 1373.8616,-8452.3297 1372.6087,-8459.2167"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge759" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M585.7192,-3821.1071C615.2047,-3775.9444 637.5344,-3772.3139 654.4731,-3721.1071 723.1225,-3513.5758 645.5244,-2952.0267 690.4731,-2738.1071 727.8337,-2560.3008 743.9124,-2511.5562 841.1968,-2358.1071 883.5754,-2291.2622 915.955,-2291.8256 962.9033,-2228.1071 1062.1042,-2093.4711 1061.9518,-2043.8601 1149.0681,-1901.1071 1187.4987,-1838.1329 1483.5467,-1413.174 1511.9993,-1345.1071 1541.1146,-1275.4547 1514.9301,-1246.9716 1547.9993,-1179.1071 1597.3573,-1077.8146 1661.8482,-1085.9695 1710.019,-984.1071 1746.2022,-907.5941 1691.2271,-861.6153 1746.019,-797.1071 1810.899,-720.7219 2227.247,-477.1071 2801.5291,-477.1071 2801.5291,-477.1071 2801.5291,-477.1071 2983.7629,-477.1071 3156.6884,-477.1071 3200.0985,-484.9676 3372.8452,-477.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M224.7555,-6173.995C230.6463,-6102.0976 263.5429,-5695.2417 281.2024,-5363.1071 292.8202,-5144.6028 273.6824,-4593.5485 317.2024,-4379.1071 357.876,-4178.6911 413.7544,-4142.2485 480.9653,-3949.1071 498.4279,-3898.9257 477.4749,-3870.6544 516.9653,-3835.1071 540.1428,-3814.2439 569.0489,-3847.4617 585.7192,-3821.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge770" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M399.0839,-7249.1071C524.7168,-7363.2838 570.6339,-7577.9474 582.3959,-7645.9099"/>
<polygon fill="#00cbff" stroke="#00cbff" points="578.9566,-7646.5639 584.0506,-7655.8537 585.8616,-7645.4148 578.9566,-7646.5639"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge776" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.9458,-6196.2225C226.8505,-6502.5393 289.1454,-13037.7372 317.2024,-13075.1071 321.9712,-13081.4588 328.3169,-13086.2481 335.3733,-13089.8505"/>
<polygon fill="#0066ff" stroke="#0066ff" points="334.0557,-13093.0935 344.6265,-13093.807 336.8078,-13086.6572 334.0557,-13093.0935"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge779" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-3821.1071C614.6195,-3777.6955 757.0022,-3738.9138 840.5679,-3719.4101"/>
<polygon fill="#0000ff" stroke="#0000ff" points="841.4989,-3722.7873 850.4557,-3717.1282 839.9247,-3715.9666 841.4989,-3722.7873"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge782" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M399.0839,-10741.1071C412.1072,-10776.1223 457.1497,-10731.3236 480.9653,-10760.1071 545.2602,-10837.8138 467.3263,-11579.3111 516.9653,-11667.1071 562.378,-11747.4281 603.7089,-11749.7107 690.4731,-11781.1071 779.3472,-11813.267 1046.3852,-11762.1276 1113.0681,-11829.1071 1165.1144,-11881.3849 1138.171,-12086.148 1149.0681,-12159.1071 1173.451,-12322.3575 1214.7958,-12517.195 1228.6238,-12580.8549"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1225.2569,-12581.843 1230.8073,-12590.8676 1232.0962,-12580.3515 1225.2569,-12581.843"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge792" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-6185.1071C435.3157,-6192.2013 453.139,-6174.8425 480.9653,-6199.1071 521.0114,-6234.0273 488.2286,-6268.4158 516.9653,-6313.1071 539.2194,-6347.7165 550.611,-6353.6485 585.7192,-6375.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M747.835,-6261.1071C836.5757,-6220.7055 954.7603,-6247.8052 1015.7612,-6266.886"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1014.811,-6270.2569 1025.4023,-6269.9851 1016.9532,-6263.5927 1014.811,-6270.2569"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-7678.1125 334.8633,-7678.1125 334.8633,-7656.1017 463.3044,-7656.1017 463.3044,-7678.1125"/>
<text text-anchor="middle" x="399.0839" y="-7663.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9738,-6196.2036C225.421,-6308.9127 239.7185,-7247.7655 317.2024,-7515.1071 332.0457,-7566.3208 365.798,-7619.7548 385.0127,-7647.594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="382.3131,-7649.8401 390.9234,-7656.0138 388.0424,-7645.8181 382.3131,-7649.8401"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-7506.1125 354.6193,-7506.1125 354.6193,-7484.1017 443.5485,-7484.1017 443.5485,-7506.1125"/>
<text text-anchor="middle" x="399.0839" y="-7491.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M224.4099,-6196.1456C229.6148,-6295.9506 269.8326,-7043.9174 317.2024,-7263.1071 334.6324,-7343.7592 372.3842,-7434.8013 389.8615,-7474.6244"/>
<polygon fill="#7fff00" stroke="#7fff00" points="386.6852,-7476.0959 393.938,-7483.8191 393.0845,-7473.2587 386.6852,-7476.0959"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-8351.1071C655.6013,-8265.0168 997.8938,-8266.7769 1154.6376,-8272.3401"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1154.5665,-8275.8397 1164.6889,-8272.7111 1154.8248,-8268.8445 1154.5665,-8275.8397"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1298.1054,-11171.1125 1168.4644,-11171.1125 1168.4644,-11149.1017 1298.1054,-11149.1017 1298.1054,-11171.1125"/>
<text text-anchor="middle" x="1233.2849" y="-11156.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M747.835,-11539.1071C832.9915,-11494.399 883.0532,-11568.7206 962.9033,-11515.1071 990.6437,-11496.4814 981.2505,-11477.4765 998.9033,-11449.1071 1045.4388,-11374.3208 1072.6601,-11365.3741 1113.0681,-11287.1071 1135.1222,-11244.3902 1114.2235,-11218.2276 1149.0681,-11185.1071 1152.8405,-11181.5214 1157.1036,-11178.4474 1161.6595,-11175.8125"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1163.3576,-11178.8765 1170.73,-11171.2673 1160.2216,-11172.6182 1163.3576,-11178.8765"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10741.1071C409.9191,-10776.86 457.2794,-10731.2169 480.9653,-10760.1071 563.6376,-10860.944 440.5278,-11827.4658 516.9653,-11933.1071 520.4472,-11937.9193 524.9514,-11941.8076 529.9881,-11944.9489"/>
<polygon fill="#ff0000" stroke="#ff0000" points="528.3925,-11948.0641 538.881,-11949.5617 531.6157,-11941.8503 528.3925,-11948.0641"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M902.05,-11957.1071C925.2004,-11974.6946 942.786,-11960.1178 962.9033,-11981.1071 996.7489,-12016.4196 965.7193,-12049.1722 998.9033,-12085.1071 1002.0434,-12088.5075 1005.7281,-12091.4695 1009.6878,-12094.0448"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1008.2551,-12097.2539 1018.6905,-12099.0847 1011.6745,-12091.1458 1008.2551,-12097.2539"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8849,-6196.3915C224.8751,-6443.1978 242.8633,-10656.7988 317.2024,-10755.1071 321.0853,-10760.242 325.9982,-10764.3549 331.4813,-10767.6448"/>
<polygon fill="#00ffff" stroke="#00ffff" points="329.9929,-10770.8138 340.5011,-10772.1657 333.1295,-10764.5558 329.9929,-10770.8138"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10741.1071C409.9191,-10776.86 455.026,-10733.2218 480.9653,-10760.1071 539.1257,-10820.3887 462.5481,-10881.4262 516.9653,-10945.1071 519.7965,-10948.4203 523.1039,-10951.2944 526.709,-10953.7877"/>
<polygon fill="#ff0000" stroke="#ff0000" points="525.1725,-10956.9428 535.5771,-10958.9415 528.6898,-10950.8906 525.1725,-10956.9428"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-10741.1071C410.2992,-10778.1142 484.7828,-10634.5453 516.9653,-10613.1071 522.718,-10609.275 529.1319,-10605.9424 535.666,-10603.0701"/>
<polygon fill="#00ffff" stroke="#00ffff" points="537.3055,-10606.1824 545.2622,-10599.1866 534.6795,-10599.6936 537.3055,-10606.1824"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge742" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14467.1071C426.5063,-14512.7754 1300.2942,-14556.5486 1353.5017,-14559.1071 2047.6881,-14592.4874 2285.3231,-14580.9897 2880.4805,-14222.1071 2962.3351,-14172.7484 2986.3403,-14161.4614 3051.0454,-14091.1071 3071.0747,-14069.3291 3065.5483,-14055.4376 3087.0454,-14035.1071 3148.6109,-13976.8829 3187.2343,-13994.639 3252.9207,-13941.1071 3359.5804,-13854.1834 3400.8692,-13833.8336 3456.7698,-13708.1071 3524.735,-13555.246 3550.4328,-13007.7467 3555.1484,-12892.4957"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3558.6583,-12892.3163 3555.5608,-12882.1843 3551.6639,-12892.0364 3558.6583,-12892.3163"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9513,-6196.3575C227.2163,-6527.7374 301.6833,-14069.6536 317.2024,-14177.1071 336.3464,-14309.6598 327.6379,-14353.8279 399.0839,-14467.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6375.1071C590.1317,-6377.8041 1312.4675,-6511.9238 1317.5017,-6513.1071 1457.5511,-6546.0254 1486.1037,-6617.7051 1629.0092,-6601.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M399.0839,-5463.1071C408.8564,-5452.2596 641.2812,-5407.3637 654.4731,-5401.1071 932.6449,-5269.1773 930.279,-5132.7089 1149.0681,-4916.1071 1220.9384,-4844.9553 1271.2617,-4853.0503 1317.5017,-4763.1071 1380.516,-4640.5356 1285.6077,-4575.0444 1353.5017,-4455.1071 1407.279,-4360.1076 1444.8339,-4340.7975 1547.9993,-4305.1071 1562.2861,-4300.1645 2079.9996,-4309.0196 2092.2107,-4300.1071 2133.42,-4270.0296 2088.2862,-4222.8702 2128.2107,-4191.1071 2185.8763,-4145.2295 2273.9541,-4146.0892 2333.7355,-4153.6955"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2333.4329,-4157.1867 2343.8153,-4155.0756 2334.3825,-4150.2514 2333.4329,-4157.1867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M585.7192,-11653.1071C614.6844,-11676.745 1131.1925,-11687.4277 1343.1292,-11690.83"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1343.2391,-11694.3321 1353.2934,-11690.9913 1343.3502,-11687.333 1343.2391,-11694.3321"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M224.8043,-6173.9975C231.0003,-6102.1154 265.471,-5695.3386 281.2024,-5363.1071 311.5243,-4722.736 291.528,-4561.6814 317.2024,-3921.1071 341.134,-3324.0133 388.8381,-2592.6632 397.6626,-2459.4413"/>
<polygon fill="#9cff00" stroke="#9cff00" points="401.1633,-2459.5451 398.3336,-2449.3352 394.1787,-2459.0813 401.1633,-2459.5451"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M399.0839,-4393.1071C420.44,-4361.7694 451.4368,-4392.9021 480.9653,-4369.1071 506.9825,-4348.1417 489.1548,-4321.6279 516.9653,-4303.1071 602.8288,-4245.9251 645.3561,-4267.2572 747.835,-4279.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge489" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M399.0839,-5653.1071C487.8861,-5569.6016 548.7615,-5613.8034 654.4731,-5553.1071 829.0131,-5452.8918 842.2631,-5385.484 998.9033,-5259.1071 1048.5529,-5219.05 1079.6396,-5226.4411 1113.0681,-5172.1071 1159.0207,-5097.4169 1102.6412,-5052.5034 1149.0681,-4978.1071 1198.4216,-4899.0212 1270.9333,-4933.8643 1317.5017,-4853.1071 1387.8929,-4731.0371 1263.1208,-4646.2149 1353.5017,-4538.1071 1463.4447,-4406.6004 1951.677,-4414.2486 2092.2107,-4316.1071 2114.0738,-4300.839 2106.0516,-4282.9423 2128.2107,-4268.1071 2200.6171,-4219.632 2233.155,-4238.7696 2318.0427,-4219.1071 2389.0452,-4202.6609 2431.9827,-4242.0699 2478.6731,-4186.1071 2535.7389,-4117.7084 2482.2541,-2666.0764 2514.6731,-2583.1071 2556.7209,-2475.495 2617.672,-2480.8454 2686.5776,-2388.1071 2704.6723,-2363.754 2698.6648,-2348.7798 2722.5776,-2330.1071 2856.6673,-2225.4012 2918.9657,-2239.4239 3087.0454,-2213.1071 3159.8804,-2201.7031 3198.7772,-2163.0724 3252.9207,-2213.1071 3310.5974,-2266.407 3364.5389,-3528.9619 3371.9744,-3709.6557"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3368.482,-3709.9175 3372.3881,-3719.766 3375.4762,-3709.6312 3368.482,-3709.9175"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M225.1736,-6174.0581C232.7587,-6112.3202 271.7492,-5809.9312 317.2024,-5729.1071 341.5405,-5685.8294 363.0831,-5687.3013 399.0839,-5653.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge631" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M223.9098,-6196.2996C225.7861,-6498.253 265.6145,-12809.3558 317.2024,-12884.1071 371.4313,-12962.6853 426.6454,-12932.1616 516.9653,-12963.1071 580.0797,-12984.7314 750.548,-13008.8378 805.1968,-13047.1071 1142.836,-13283.5482 985.8382,-13608.752 1353.5017,-13795.1071 1477.7299,-13858.0738 2468.7781,-13713.9819 2600.6254,-13669.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge698" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M399.0839,-14163.1071C512.6544,-14361.0427 1126.2123,-14521.7045 1353.5017,-14542.1071 1511.4087,-14556.2816 1552.4865,-14547.9688 1710.019,-14530.1071 2282.2666,-14465.2233 2489.9205,-14397.3566 2880.4805,-13974.1071 2976.4826,-13870.0697 3005.1884,-13839.0374 3051.0454,-13705.1071 3127.9097,-13480.6167 3237.9526,-11815.9193 3252.9207,-11579.1071 3353.1586,-9993.2273 3370.9436,-8029.1832 3372.6896,-7803.5288"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3376.1908,-7803.3723 3372.7665,-7793.3462 3369.191,-7803.3194 3376.1908,-7803.3723"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge706" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M585.7192,-6451.1071C660.3648,-6525.985 905.8761,-6250.1383 962.9033,-6161.1071 1124.9284,-5908.1526 1073.2439,-5799.8522 1113.0681,-5502.1071 1125.7325,-5407.4221 1088.6926,-4717.1371 1149.0681,-4643.1071 1150.3895,-4641.4868 1151.8151,-4639.9805 1153.3296,-4638.5806"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1155.6501,-4641.2162 1161.5736,-4632.4319 1151.4651,-4635.605 1155.6501,-4641.2162"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M399.0839,-6185.1071C435.3157,-6192.2013 455.0259,-6172.8351 480.9653,-6199.1071 553.043,-6272.1089 451.2079,-6348.3644 516.9653,-6427.1071 537.711,-6451.9495 561.3809,-6429.7723 585.7192,-6451.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge711" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacostestimate.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M224.8671,-6174.0002C231.4568,-6102.1353 267.9576,-5695.4471 281.2024,-5363.1071 283.1947,-5313.1165 287.2351,-1801.1694 317.2024,-1761.1071 321.3297,-1755.5894 326.6474,-1751.2503 332.589,-1747.8438"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="334.168,-1750.9683 341.6746,-1743.4916 331.1438,-1744.6553 334.168,-1750.9683"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge713" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M224.8577,-6173.9998C231.3888,-6102.1325 267.5871,-5695.4321 281.2024,-5363.1071 294.5984,-5036.1347 267.2399,-2741.5173 317.2024,-2418.1071 328.884,-2342.4917 471.9345,-1820.9648 516.9653,-1759.1071 608.732,-1633.0497 701.0123,-1675.1122 805.1968,-1559.1071 827.523,-1534.2478 816.312,-1515.405 841.1968,-1493.1071 845.1363,-1489.5771 849.642,-1486.5062 854.3801,-1483.8437"/>
<polygon fill="#ff0075" stroke="#ff0075" points="856.295,-1486.8004 863.6905,-1479.2137 853.1781,-1480.5326 856.295,-1486.8004"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4393.1071C431.3105,-4346.0879 599.3905,-4402.4352 654.4731,-4417.1071 887.8338,-4479.2654 921.0478,-4562.5611 1149.0681,-4642.1071 1156.7556,-4644.7889 1164.9495,-4647.2741 1173.0937,-4649.5263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1172.4019,-4652.964 1182.9658,-4652.1554 1174.2034,-4646.1998 1172.4019,-4652.964"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-5881.1071C445.5431,-5847.6324 460.9336,-5921.2977 516.9653,-5933.1071 576.7661,-5945.7109 604.6899,-5968.5559 654.4731,-5933.1071 694.3172,-5904.7356 655.0563,-5862.8434 690.4731,-5829.1071 718.2627,-5802.6361 1315.77,-5642.128 1353.5017,-5635.1071 1422.8011,-5622.2123 1503.2592,-5616.543 1559.267,-5614.0527"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1559.5886,-5617.5423 1569.4321,-5613.6237 1559.2934,-5610.5486 1559.5886,-5617.5423"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1233.2849,-7743.1071C1254.2138,-7710.2934 1291.9428,-7748.4584 1317.5017,-7719.1071 1392.9555,-7632.4577 1296.4693,-7562.8502 1353.5017,-7463.1071 1364.8687,-7443.2275 1385.1926,-7427.2647 1402.412,-7416.381"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1404.3147,-7419.3208 1411.0697,-7411.1587 1400.6991,-7413.3268 1404.3147,-7419.3208"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-7249.1071C702.8917,-7251.6356 610.0601,-7405.8456 690.4731,-7491.1071 736.0967,-7539.4815 1197.5277,-7799.1696 1233.2849,-7743.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-6147.1071C1068.6441,-6106.0196 1272.7608,-6102.9653 1372.3287,-6104.3877"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1372.4445,-6107.8899 1382.5005,-6104.554 1372.5591,-6100.8909 1372.4445,-6107.8899"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-6185.1071C619.084,-6228.1831 680.9001,-6183.8261 902.05,-6147.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-10741.1071C412.3861,-10776.0173 457.2645,-10731.2291 480.9653,-10760.1071 561.012,-10857.6394 440.6349,-11794.6398 516.9653,-11895.1071 555.7027,-11946.0938 605.5931,-11896.7432 654.4731,-11938.1071 681.4808,-11960.9619 666.3103,-11983.2632 690.4731,-12009.1071 786.6804,-12112.0078 881.65,-12056.032 962.9033,-12171.1071 1010.4637,-12238.4645 974.0959,-12274.4712 998.9033,-12353.1071 1002.0095,-12362.9533 1141.3179,-12686.2858 1149.0681,-12693.1071 1178.377,-12718.903 1194.5673,-12713.0691 1233.2849,-12718.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1233.2849,-12718.1071C1261.4029,-12725.2963 1335.8678,-12707.5172 1385.4278,-12693.9143"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1386.5957,-12697.2225 1395.2929,-12691.1719 1384.7208,-12690.4782 1386.5957,-12697.2225"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1317.7191,-8479.1125 1148.8508,-8479.1125 1148.8508,-8457.1017 1317.7191,-8457.1017 1317.7191,-8479.1125"/>
<text text-anchor="middle" x="1233.2849" y="-8464.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10741.1071C460.211,-10942.5412 606.0769,-9061.9529 690.4731,-8869.1071 767.6402,-8692.7801 830.8434,-8658.9252 998.9033,-8565.1071 1062.7573,-8529.4611 1142.3924,-8499.2451 1190.4671,-8482.4134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1191.6378,-8485.712 1199.9383,-8479.1278 1189.3435,-8479.0986 1191.6378,-8485.712"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5463.1071C424.4669,-5434.9319 451.4368,-5462.9021 480.9653,-5439.1071 506.9825,-5418.1417 494.0525,-5397.4268 516.9653,-5373.1071 566.3955,-5320.6419 595.3895,-5328.3993 654.4731,-5287.1071 671.0876,-5275.4957 674.3974,-5271.4535 690.4731,-5259.1071 741.2242,-5220.1295 758.9642,-5216.3503 805.1968,-5172.1071 884.4845,-5096.231 901.2939,-5072.9256 962.9033,-4982.1071 981.6613,-4954.456 976.8875,-4941.2417 998.9033,-4916.1071 1114.4904,-4784.146 1233.5142,-4837.1208 1317.5017,-4683.1071 1382.3014,-4564.2795 1264.905,-4177.4283 1353.5017,-4075.1071 1380.1837,-4044.2918 1968.3434,-3940.8552 2151.3064,-3909.315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2151.9814,-3912.7503 2161.2424,-3907.6042 2150.7935,-3905.8519 2151.9814,-3912.7503"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.6317,-6174.0781C228.9636,-6116.8064 252.0461,-5847.9606 317.2024,-5639.1071 342.8959,-5556.7486 341.3382,-5527.2048 399.0839,-5463.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-7249.1071C684.8082,-7245.2419 619.7802,-7121.649 690.4731,-7052.1071 811.1418,-6933.4032 902.4221,-6873.9048 1055.9857,-6945.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-7249.1071C460.4697,-7304.8953 502.7895,-7247.3175 585.7192,-7249.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-4393.1071C436.585,-4345.2029 783.3622,-4697.2311 841.1968,-4716.1071 892.619,-4732.8903 916.9916,-4744.7084 962.9033,-4716.1071 1114.6223,-4621.5917 1265.1351,-4165.0151 1317.5017,-3994.1071 1351.5488,-3882.9884 1277.9745,-3823.4372 1353.5017,-3735.1071 1401.3345,-3679.166 1461.9527,-3741.0767 1511.9993,-3687.1071 1562.1502,-3633.0249 1504.6288,-3584.7644 1547.9993,-3525.1071 1707.3708,-3305.8872 2032.0413,-3189.8053 2155.749,-3152.0884"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2156.7847,-3155.4319 2165.3501,-3149.1961 2154.7655,-3148.7294 2156.7847,-3155.4319"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-5881.1071C405.96,-5876.4893 1504.385,-5455.3673 1511.9993,-5452.1071 1528.2652,-5445.1425 1531.2932,-5440.9374 1547.9993,-5435.1071 1617.8316,-5410.7361 1655.7828,-5447.3955 1710.019,-5397.1071 1748.981,-5360.9812 1711.7677,-5323.7267 1746.019,-5283.1071 1790.4474,-5230.4183 1846.6951,-5270.1349 1883.8806,-5212.1071 1932.3079,-5136.5366 1891.3015,-4490.1914 1919.8806,-4405.1071 1934.0824,-4362.8263 1967.1576,-4321.8247 1987.95,-4298.8852"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1990.7661,-4300.9956 1994.9969,-4291.2821 1985.6322,-4296.2372 1990.7661,-4300.9956"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-4393.1071C458.562,-4306.9231 434.8485,-4254.0853 516.9653,-4189.1071 620.5215,-4107.1641 1011.7511,-4019.7023 1168.1243,-3987.2253"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1168.9954,-3990.6193 1178.0792,-3985.1662 1167.5775,-3983.7644 1168.9954,-3990.6193"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M224.6027,-6173.7052C234.5919,-6024.8878 340.3738,-4468.1039 399.0839,-4393.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-5383.1071C1652.8398,-5354.0866 1683.999,-5386.1821 1710.019,-5359.1071 1755.1335,-5312.1636 1702.3307,-5265.3807 1746.019,-5217.1071 1749.1302,-5213.6694 1752.7513,-5210.7039 1756.6744,-5208.1457"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1758.6091,-5211.0753 1765.6642,-5203.171 1755.2198,-5204.9505 1758.6091,-5211.0753"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.6704,-6173.8771C228.1942,-6133.8983 245.241,-5996.6993 317.2024,-5918.1071 344.1706,-5888.6539 366.9847,-5904.8647 399.0839,-5881.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5881.1071C586.035,-5742.7386 628.5655,-5695.3647 841.1968,-5601.1071 846.3863,-5598.8066 1625.4067,-5387.4941 1629.0092,-5383.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10741.1071C420.5454,-10798.1523 619.3978,-10690.9516 654.4731,-10641.1071 734.3713,-10527.5661 611.8891,-9506.5616 690.4731,-9392.1071 706.1156,-9369.3246 736.2562,-9393.2002 747.835,-9368.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-9368.1071C818.3736,-9216.2092 848.3483,-9160.4682 998.9033,-9087.1071 1022.3857,-9075.6648 1036.6028,-9055.5956 1055.9857,-9073.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge474" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6033.1071C680.0261,-5988.9747 1414.4166,-5927.4263 1511.9993,-5891.1071 1712.5848,-5816.4514 1722.4834,-5717.8258 1919.8806,-5635.1071 1979.0665,-5610.3054 2438.9134,-5539.4783 2478.6731,-5489.1071 2518.8156,-5438.2509 2504.7972,-4971.1403 2514.6731,-4907.1071 2547.5228,-4694.1166 2807.2263,-2901.4993 2983.7629,-3025.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge479" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.8667,-6174.0002C231.4536,-6102.1352 267.9398,-5695.4463 281.2024,-5363.1071 283.1763,-5313.6439 286.7711,-1838.1511 317.2024,-1799.1071 363.4622,-1739.7547 432.8609,-1813.9745 480.9653,-1756.1071 551.0441,-1671.8056 475.4469,-1365.5664 516.9653,-1264.1071 552.7327,-1176.7018 600.7747,-1179.7954 654.4731,-1102.1071 673.2503,-1074.9412 666.0418,-1059.326 690.4731,-1037.1071 694.3421,-1033.5885 698.7845,-1030.5092 703.4477,-1027.8283"/>
<polygon fill="#00ffff" stroke="#00ffff" points="705.2832,-1030.8209 712.5949,-1023.1534 702.0976,-1024.5878 705.2832,-1030.8209"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-8465.1071C775.3997,-8469.9378 970.9965,-8447.1961 998.9033,-8445.1071 1485.3264,-8408.6948 1614.1681,-8446.1044 2092.2107,-8349.1071 2265.4494,-8313.9561 2316.7881,-8326.1035 2478.6731,-8255.1071 2496.2836,-8247.3838 2496.8585,-8238.3472 2514.6731,-8231.1071 2518.1094,-8229.7105 2521.6729,-8228.4348 2525.308,-8227.2696"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2526.4331,-8230.5875 2535.0593,-8224.436 2524.4798,-8223.8655 2526.4331,-8230.5875"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-8351.1071C645.6703,-8286.575 663.6432,-8439.2175 747.835,-8465.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-7249.1071C535.9336,-7373.4777 531.9227,-7047.2789 690.4731,-6952.1071 872.6418,-6842.7582 938.7733,-6847.4171 1149.0681,-6817.1071 1500.8391,-6766.406 2624.5465,-6929.5923 2914.8088,-6973.5148"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2914.3685,-6976.988 2924.7801,-6975.0264 2915.4177,-6970.0671 2914.3685,-6976.988"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M224.2815,-6196.1915C228.5249,-6297.9501 264.9292,-7070.0768 399.0839,-7249.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M242.0601,-6174.0625C287.6694,-6146.575 410.7281,-6073.3996 516.9653,-6019.1071 576.8249,-5988.5159 602.7505,-5999.0462 654.4731,-5956.1071 675.8204,-5938.385 668.1096,-5921.5281 690.4731,-5905.1071 864.6318,-5777.2263 1413.3313,-5664.0602 1629.0092,-5651.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge429" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-6375.1071C662.5782,-6418.1328 668.5742,-6299.5291 747.835,-6261.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M747.835,-6261.1071C1004.0492,-6136.9061 738.789,-6241.5447 1710.019,-6204.1071 1787.2961,-6201.1283 1827.3757,-6249.9068 1883.8806,-6197.1071 1938.1029,-6146.4405 1864.65,-5914.6726 1919.8806,-5865.1071 1976.8832,-5813.9514 2026.0965,-5826.4404 2092.2107,-5865.1071 2120.3821,-5881.5831 2100.0393,-5912.6311 2128.2107,-5929.1071 2232.5769,-5990.1454 2280.2565,-5922.9922 2398.3579,-5897.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge444" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-6185.1071C503.9008,-6206.5012 492.3959,-6085.4048 585.7192,-6033.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M585.7192,-6033.1071C700.3855,-5968.849 1588.3805,-5714.922 1710.019,-5665.1071 1806.7186,-5625.5055 1822.4456,-5596.863 1919.8806,-5559.1071 1956.9483,-5544.7434 1967.065,-5542.9071 2006.0457,-5535.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M267.5368,-6180.2991C303.2879,-6177.5092 354.9657,-6176.1022 399.0839,-6185.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-8997.1071C808.8007,-8931.6605 1458.6902,-9080.2109 1547.9993,-9085.1071 1619.9001,-9089.049 1641.5652,-9107.4529 1710.019,-9085.1071 2009.3514,-8987.3943 2127.4949,-8941.4475 2282.0427,-8667.1071 2327.5858,-8586.2628 2256.1474,-8320.237 2318.0427,-8251.1071 2324.3109,-8244.1062 2332.696,-8239.6538 2341.6871,-8236.9006"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2342.6914,-8240.2594 2351.6097,-8234.5398 2341.0711,-8233.4495 2342.6914,-8240.2594"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-10741.1071C412.4023,-10776.0111 456.0581,-10732.2629 480.9653,-10760.1071 514.2681,-10797.3368 546.3154,-11622.4075 585.7192,-11653.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-11653.1071C655.2027,-11707.2418 670.6676,-11581.5773 747.835,-11539.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M747.835,-11539.1071C772.7094,-11525.4171 945.6505,-11423.6569 962.9033,-11401.1071 995.1894,-11358.9085 971.0878,-11332.3775 998.9033,-11287.1071 1047.7965,-11207.5325 1070.5187,-11190.6308 1149.0681,-11140.1071 1345.2319,-11013.9327 1904.4964,-10828.0776 2128.2107,-10762.1071 2135.4878,-10759.9612 2143.2339,-10757.9924 2150.9016,-10756.2251"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2151.8801,-10759.5935 2160.8904,-10754.0199 2150.371,-10752.7581 2151.8801,-10759.5935"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10741.1071C423.562,-10805.3023 455.6964,-10672.1928 516.9653,-10641.1071 573.0139,-10612.6701 614.8568,-10656.899 654.4731,-10608.1071 698.4044,-10554.0009 683.9309,-9423.4947 690.4731,-9354.1071 705.5581,-9194.1149 642.5773,-9118.5398 747.835,-8997.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-8997.1071C767.3283,-8974.6223 1155.3323,-8848.8337 1432.7505,-8921.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-8351.1071C657.536,-8277.1326 1439.708,-8369.618 1511.9993,-8296.1071 1577.8908,-8229.1039 1488.0727,-7523.4944 1547.9993,-7451.1071 1595.1648,-7394.1342 1652.7894,-7459.9607 1710.019,-7413.1071 2123.5128,-7074.582 2194.1725,-6338.6965 2203.7898,-6203.6301"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2207.3004,-6203.5893 2204.4821,-6193.3762 2200.3163,-6203.1176 2207.3004,-6203.5893"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-5653.1071C441.6856,-5615.2328 599.9356,-5645.691 654.4731,-5629.1071 717.849,-5609.8357 1613.6263,-5112.1445 1786.2732,-5016.0734"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1788.0227,-5019.1053 1795.0586,-5011.184 1784.6186,-5012.9887 1788.0227,-5019.1053"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-6451.1071C657.6766,-6523.2885 616.1563,-6585.3573 690.4731,-6655.1071 694.2381,-6658.6407 698.5825,-6661.724 703.1612,-6664.4023"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="701.6753,-6667.5743 712.1647,-6669.0658 704.8949,-6661.3586 701.6753,-6667.5743"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-6147.1071C952.3109,-6140.0343 1781.1999,-6221.0165 1814.9498,-6183.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-6183.1071C1836.348,-6158.7257 1863.8284,-6184.607 1883.8806,-6159.1071 1934.9452,-6094.1694 1878.9601,-5860.8707 1919.8806,-5789.1071 1931.7133,-5768.3557 1953.4769,-5752.5288 1972.17,-5741.9286"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1973.9009,-5744.9718 1981.0429,-5737.1461 1970.5795,-5738.8099 1973.9009,-5744.9718"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M747.835,-7249.1071C790.0187,-7240.3995 799.5084,-7233.9411 841.1968,-7223.1071 1051.9694,-7168.3314 1178.9142,-7276.0921 1317.5017,-7108.1071 1373.208,-7040.5843 1322.3289,-6402.9043 1353.5017,-6321.1071 1393.2741,-6216.7446 1451.7001,-6220.1145 1511.9993,-6126.1071 1531.5305,-6095.6576 1522.6786,-6078.9432 1547.9993,-6053.1071 1604.7729,-5995.1778 1660.1267,-6033.0586 1710.019,-5969.1071 1752.7227,-5914.37 1704.0173,-5872.3847 1746.019,-5817.1071 1788.3481,-5761.3987 1843.5371,-5798.2698 1883.8806,-5741.1071 1941.0111,-5660.159 1847.1347,-5588.3717 1919.8806,-5521.1071 2013.2919,-5434.7342 2095.2401,-5561.2232 2205.1267,-5497.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2205.1267,-5497.1071C2294.5921,-5443.7417 2362.5777,-5333.8484 2387.7489,-5288.914"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2390.8335,-5290.5682 2392.5898,-5280.1199 2384.7012,-5287.1925 2390.8335,-5290.5682"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-7249.1071C657.7293,-7251.5473 676.0539,-7255.3434 747.835,-7249.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2600.6254,-11731.1071C2616.0215,-11625.5913 2666.6343,-11611.8587 2686.5776,-11507.1071 2705.5047,-11407.6934 2662.3849,-7945.4591 2722.5776,-7864.1071 2731.3859,-7852.2025 2745.8869,-7845.8304 2760.074,-7842.4659"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.1014,-7845.8328 2770.263,-7840.5116 2759.7827,-7838.9581 2761.1014,-7845.8328"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-10741.1071C412.4023,-10776.0111 457.2039,-10731.279 480.9653,-10760.1071 551.8231,-10846.0739 476.6942,-11658.2353 516.9653,-11762.1071 534.0347,-11806.1342 555.7351,-11806.6283 585.7192,-11843.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M747.835,-11881.1071C907.9222,-11919.5915 1003.5386,-11820.1751 1113.0681,-11943.1071 1213.5855,-12055.9243 1045.002,-12512.5548 1149.0681,-12622.1071 1260.7677,-12739.6954 1385.9655,-12558.0322 1511.9993,-12660.1071 1552.3021,-12692.7484 1506.0494,-12740.6115 1547.9993,-12771.1071 1606.2442,-12813.4485 1642.7675,-12796.846 1710.019,-12771.1071 2278.3608,-12553.5881 2512.761,-12333.2754 2600.6254,-11731.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-11843.1071C597.4672,-11857.3996 729.8663,-11876.7005 747.835,-11881.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-7249.1071C882.6506,-7224.9896 922.7825,-7217.2665 1055.9857,-7249.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-9368.1071C819.1722,-9249.6929 1216.1749,-9494.2241 1353.5017,-9510.1071 1423.4786,-9518.2005 1442.3997,-9520.9776 1511.9993,-9510.1071 1651.6839,-9488.2902 1673.7294,-9406.4321 1814.9498,-9413.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge403" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6375.1071C611.8531,-6392.1214 632.076,-6367.4084 654.4731,-6389.1071 704.335,-6437.4139 637.9222,-6495.7403 690.4731,-6541.1071 862.4237,-6689.5506 1496.4404,-6692.4805 1710.019,-6615.1071 1804.6208,-6580.8356 1832.7609,-6556.7719 1883.8806,-6470.1071 1926.8811,-6397.2071 1854.6209,-6337.0017 1919.8806,-6283.1071 2084.0392,-6147.5369 2195.2658,-6369.989 2398.3579,-6306.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge518" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-10441.1071C2229.7093,-10342.2117 2263.7987,-10325.3656 2282.0427,-10225.1071 2362.0223,-9785.5865 2265.2673,-8658.7171 2318.0427,-8215.1071 2333.6867,-8083.6096 2376.2553,-7929.6746 2392.2096,-7874.8106"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.574,-7875.7756 2395.0298,-7865.1947 2388.8569,-7873.8055 2395.574,-7875.7756"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-11767.1071C1252.7725,-11816.1148 1331.6603,-11875.8684 1511.9993,-11783.1071 1646.5738,-11713.8857 1657.4977,-11648.0346 1710.019,-11506.1071 1773.0427,-11335.7991 1677.6096,-11267.324 1746.019,-11099.1071 1782.5349,-11009.3156 1843.7695,-11018.3511 1883.8806,-10930.1071 1923.2471,-10843.5014 1873.0163,-10801.896 1919.8806,-10719.1071 1969.6155,-10631.2472 2036.7925,-10655.4975 2092.2107,-10571.1071 2121.8417,-10525.9853 2087.8044,-10490.9024 2128.2107,-10455.1071 2154.2194,-10432.0664 2196.7448,-10474.8275 2205.1267,-10441.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge604" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.9115,-6196.1738C225.8353,-6494.7322 266.6441,-12734.8825 317.2024,-12809.1071 449.1576,-13002.8305 595.8695,-12903.6414 805.1968,-13009.1071 1280.148,-13248.4026 1395.8438,-13738.4388 1883.8806,-13527.1071 2129.0437,-13420.9456 2561.3859,-12868.1203 2686.5776,-12632.1071 2751.7089,-12509.3208 2786.812,-12343.5973 2797.7473,-12285.3847"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2801.2501,-12285.6879 2799.6139,-12275.2202 2794.3652,-12284.4236 2801.2501,-12285.6879"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge618" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-11653.1071C609.4899,-11673.2917 627.2063,-11651.9749 654.4731,-11667.1071 674.815,-11678.3962 669.9486,-11694.1537 690.4731,-11705.1071 835.8384,-11782.6847 893.0752,-11742.4192 1055.9857,-11767.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1055.9857,-11767.1071C1156.2947,-11785.9897 1440.4171,-11784.8699 1511.9993,-11712.1071 1566.2125,-11656.9997 1495.8892,-11423.2074 1547.9993,-11366.1071 1554.9572,-11358.4829 1564.4092,-11353.8817 1574.4022,-11351.2061"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1575.4115,-11354.572 1584.503,-11349.1318 1574.0033,-11347.7151 1575.4115,-11354.572"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge497" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-12795.1071C618.2523,-12801.3472 655.1374,-12802.0609 685.4964,-12801.0108"/>
<polygon fill="#ff0000" stroke="#ff0000" points="685.6807,-12804.5062 695.5262,-12800.5925 685.389,-12797.5123 685.6807,-12804.5062"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9072,-6196.3117C225.6435,-6486.3677 261.2037,-12312.2393 317.2024,-12473.1071 378.4629,-12649.0905 402.7141,-12760.0054 585.7192,-12795.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge570" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11957.1071C933.1924,-11979.9313 943.805,-11985.5505 962.9033,-12019.1071 993.8311,-12073.4486 949.3556,-12116.9685 998.9033,-12155.1071 1131.5028,-12257.1736 1286.8455,-12130.4056 1511.9993,-11987.1071 1612.0846,-11923.4081 1634.127,-11899.2939 1710.019,-11808.1071 1917.0933,-11559.3008 1962.502,-11484.6875 2092.2107,-11188.1071 2116.0621,-11133.5707 2101.6415,-11112.3724 2128.2107,-11059.1071 2178.4235,-10958.4416 2218.4726,-10950.9172 2282.0427,-10858.1071 2299.4015,-10832.7639 2301.2404,-10824.8226 2318.0427,-10799.1071 2386.2426,-10694.7286 2435.6,-10686.1148 2478.6731,-10569.1071 2501.2133,-10507.8768 2585.7241,-9482.4624 2598.8949,-9321.3381"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2602.3926,-9321.5076 2599.7181,-9311.2559 2595.4159,-9320.9379 2602.3926,-9321.5076"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge583" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-11843.1071C604.1076,-11869.7416 626.0456,-11851.6344 654.4731,-11867.1071 672.2766,-11876.7973 674.1399,-11883.1034 690.4731,-11895.1071 809.2187,-11982.3761 873.6899,-11966.8154 962.9033,-12084.1071 992.2608,-12122.7043 959.3591,-12159.0383 998.9033,-12187.1071 1040.2796,-12216.4762 1062.4148,-12190.0702 1113.0681,-12187.1071 1204.3953,-12181.7647 1230.5974,-12191.6875 1317.5017,-12163.1071 1612.9521,-12065.9417 1665.8203,-11973.8767 1883.8806,-11752.1071 2004.9622,-11628.9659 2456.3677,-11057.8218 2478.6731,-11008.1071 2485.8066,-10992.2079 2577.6655,-10452.3966 2597.0492,-10338.1959"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2600.5165,-10338.6828 2598.7387,-10328.2382 2593.6152,-10337.5118 2600.5165,-10338.6828"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge593" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-14163.1071C494.5834,-14319.6874 771.947,-14220.0065 868.4667,-14179.1646"/>
<polygon fill="#0000ff" stroke="#0000ff" points="869.9475,-14182.3379 877.7565,-14175.1776 867.1867,-14175.9053 869.9475,-14182.3379"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8883,-6196.1906C225.0678,-6466.9481 248.3435,-11621.0755 317.2024,-13120.1071 327.8707,-13352.3531 288.7271,-13958.4772 399.0839,-14163.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge538" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11957.1071C925.3325,-11974.795 943.8486,-11959.9293 962.9033,-11982.1071 1007.0195,-12033.4537 945.6781,-12088.2766 998.9033,-12130.1071 1038.7971,-12161.4603 1070.768,-12158.1293 1113.0681,-12130.1071 1147.2703,-12107.4494 1119.3714,-12073.4138 1149.0681,-12045.1071 1206.8091,-11990.0688 1253.5186,-12030.7453 1317.5017,-11983.1071 1338.8909,-11967.1819 1333.0607,-11952.2324 1353.5017,-11935.1071 1413.9876,-11884.4325 1466.7052,-11919.7207 1511.9993,-11855.1071 1589.0832,-11745.1442 1473.8926,-11667.0981 1547.9993,-11555.1071 1593.8177,-11485.8656 1667.3966,-11533.3605 1710.019,-11462.1071 1782.2021,-11341.4362 1709.477,-10332.8883 1746.019,-10197.1071 1798.4022,-10002.4639 1943.6567,-9800.0816 1990.9503,-9737.6164"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1993.9108,-9739.5062 1997.1945,-9729.4331 1988.3458,-9735.2599 1993.9108,-9739.5062"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge525" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11997.1071C630.2145,-12087.9245 607.2923,-12141.5869 690.4731,-12199.1071 735.5849,-12230.3023 799.4235,-12233.7465 845.1585,-12231.1221"/>
<polygon fill="#ff0000" stroke="#ff0000" points="845.4721,-12234.6089 855.2088,-12230.4318 844.9924,-12227.6253 845.4721,-12234.6089"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10741.1071C409.9191,-10776.86 457.2957,-10731.2035 480.9653,-10760.1071 566.7469,-10864.8574 433.3816,-11871.5948 516.9653,-11978.1071 536.5368,-12003.0473 571.5271,-11968.7585 585.7192,-11997.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge667" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14163.1071C426.2648,-14213.5076 463.5223,-14194.5435 516.9653,-14215.1071 582.0691,-14240.1574 1059.9199,-14366.9265 1113.0681,-14412.1071 1139.4222,-14434.5104 1119.4887,-14463.1765 1149.0681,-14481.1071 1213.0842,-14519.9126 1244.1546,-14496.078 1317.5017,-14481.1071 1973.963,-14347.1167 2149.8889,-14251.1807 2686.5776,-13850.1071 2781.4989,-13779.1713 2819.9076,-13768.9544 2880.4805,-13667.1071 2912.4419,-13613.367 2871.0984,-13574.1187 2916.4805,-13531.1071 2938.6494,-13510.0961 2976.6133,-13546.8023 2983.7629,-13517.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge651" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11957.1071C993.8693,-12019.229 1057.3254,-11994.2809 1113.0681,-12090.1071 1157.4737,-12166.4439 1123.9118,-12799.453 1149.0681,-12884.1071 1232.2438,-13164.0036 1313.8957,-13231.5912 1547.9993,-13406.1071 1630.6899,-13467.7501 1646.7348,-13499.1743 1746.019,-13527.1071 1805.001,-13543.7012 1823.1173,-13534.9844 1883.8806,-13527.1071 1998.5625,-13512.2398 2812.294,-13320.5072 2880.4805,-13227.1071 2912.445,-13183.3228 2915.0034,-9378.2976 2916.4805,-9324.1071 2932.7763,-8726.2471 2974.7056,-7993.8791 2982.5044,-7860.4712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2986.0063,-7860.5387 2983.0978,-7850.3509 2979.0183,-7860.1288 2986.0063,-7860.5387"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-11881.1071C822.0471,-11899.3069 840.4014,-11911.9616 902.05,-11957.1071"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge784" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.2423,-6173.9442C233.9109,-6140.6696 260.6908,-6040.7774 317.2024,-5981.1071 328.3425,-5969.3443 343.4208,-5960.1741 357.6025,-5953.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="359.0671,-5956.559 366.742,-5949.2551 356.1875,-5950.1787 359.0671,-5956.559"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge786" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M225.7719,-6173.9366C233.298,-6131.9946 262.9601,-5980.5254 317.2024,-5867.1071 335.2321,-5829.4078 364.747,-5790.4975 382.9827,-5768.1183"/>
<polygon fill="#00ffff" stroke="#00ffff" points="385.6992,-5770.3255 389.372,-5760.3877 380.3035,-5765.8661 385.6992,-5770.3255"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge809" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3716.8884,-13733.6713C3723.6015,-13435.5668 3859.389,-7405.7061 3868.5343,-6999.5949"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3872.0366,-6999.5285 3868.7627,-6989.4522 3865.0384,-6999.3708 3872.0366,-6999.5285"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge810" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-8199.1071C1269.8117,-8225.7258 1293.3076,-8217.9312 1317.5017,-8256.1071 1373.3582,-8344.2431 1314.0863,-8391.4928 1353.5017,-8488.1071 1367.5362,-8522.5083 1520.5667,-8735.0499 1547.9993,-8760.1071 1609.6326,-8816.4038 1650.4782,-8796.6018 1710.019,-8855.1071 1731.9297,-8876.6368 1728.149,-8889.1218 1746.019,-8914.1071 1816.3096,-9012.3849 1824.3026,-9049.1874 1919.8806,-9123.1071 2000.8219,-9185.7068 2035.0249,-9178.8387 2128.2107,-9221.1071 2135.9181,-9224.6031 2681.832,-9458.0996 2686.5776,-9465.1071 2721.9218,-9517.297 2717.4471,-10536.2845 2722.5776,-10599.1071 2776.1814,-11255.4739 2664.8887,-11459.5085 2916.4805,-12068.1071 2954.0982,-12159.1041 3018.2885,-12151.2495 3051.0454,-12244.1071 3103.218,-12392.0033 3032.4506,-13508.0878 3087.0454,-13655.1071 3157.6071,-13845.1239 3598.8903,-14480.0995 3716.6309,-14315.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.2093,-7678.1287C595.7367,-7741.7576 638.5274,-8068.6406 654.4731,-8337.1071 658.0904,-8398.008 662.1536,-10479.07 690.4731,-10533.1071 747.8554,-10642.5993 899.7813,-10682.3928 988.6602,-10696.5512"/>
<polygon fill="#ff0000" stroke="#ff0000" points="988.2325,-10700.0264 998.6463,-10698.0765 989.2895,-10693.1067 988.2325,-10700.0264"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M747.835,-8009.1071C835.68,-8055.7893 869.8511,-8035.9323 962.9033,-8071.1071 1087.2696,-8118.119 1129.0327,-8116.5931 1233.2849,-8199.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1233.2849,-8199.1071C1264.7388,-8222.029 1282.7902,-8205.504 1317.5017,-8223.1071 1335.5797,-8232.2749 1335.5536,-8241.6874 1353.5017,-8251.1071 1361.2981,-8255.1989 1369.8813,-8258.7605 1378.433,-8261.8123"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1377.4372,-8265.17 1388.0313,-8265.0423 1379.6699,-8258.5356 1377.4372,-8265.17"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M588.5301,-7678.3931C599.4982,-7723.0236 639.5452,-7891.6558 654.4731,-8033.1071 722.7356,-8679.9341 664.1562,-8846.2207 690.4731,-9496.1071 706.6971,-9896.7498 739.18,-10385.4908 746.3939,-10491.986"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="742.9099,-10492.3422 747.0798,-10502.0819 749.8938,-10491.8677 742.9099,-10492.3422"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge765" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3555.9763,-13745.1071C3587.6484,-13752.0991 3623.6967,-13752.7389 3653.6099,-13751.3546"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3654.1248,-13754.8317 3663.9175,-13750.7877 3653.7403,-13747.8422 3654.1248,-13754.8317"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M902.05,-7971.1071C1062.7375,-7950.7181 1075.7789,-7856.8962 1233.2849,-7819.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3372.8452,-13593.1071C3421.114,-13687.2265 3452.6884,-13722.3049 3555.9763,-13745.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M747.835,-8009.1071C783.76,-8032.4509 799.5701,-7995.2441 841.1968,-7985.1071 868.1612,-7978.5407 874.4167,-7973.6754 902.05,-7971.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1233.2849,-7819.1071C1270.3461,-7807.2231 1288.7007,-7821.2846 1317.5017,-7795.1071 1349.9939,-7765.5748 1317.2358,-7727.8596 1353.5017,-7703.1071 1373.954,-7689.1478 1328.3883,-7629.889 2478.6731,-7710.1071 2522.0058,-7713.129 3224.6746,-7786.1069 3252.9207,-7819.1071 3298.7292,-7872.6258 3284.4825,-12820.8008 3288.9207,-12891.1071 3308.7166,-13204.7046 3229.4549,-13313.5101 3372.8452,-13593.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge797" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M747.835,-6527.1071C760.5731,-6505.7474 943.7475,-6480.9675 962.9033,-6465.1071 1015.6073,-6421.47 1041.4993,-6340.4258 1051.2369,-6302.1563"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1054.7078,-6302.6935 1053.6585,-6292.1508 1047.9043,-6301.0468 1054.7078,-6302.6935"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M747.835,-8009.1071C930.3138,-8109.4553 958.5489,-8167.0194 1149.0681,-8251.1071 1158.3817,-8255.2178 1168.5641,-8258.8845 1178.5289,-8262.0592"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1177.7947,-8265.4945 1188.3809,-8265.0682 1179.8394,-8258.7998 1177.7947,-8265.4945"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M747.835,-10893.1071C755.4146,-10919.683 780.3883,-10904.9306 805.1968,-10917.1071 961.6303,-10993.8875 1140.457,-11102.5236 1206.7553,-11143.5551"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1205.0065,-11146.589 1215.3494,-11148.8858 1208.6963,-11140.6404 1205.0065,-11146.589"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M587.2113,-7678.1286C595.7496,-7741.7568 638.5907,-8068.6368 654.4731,-8337.1071 684.1492,-8838.7382 638.3137,-10098.3133 690.4731,-10598.1071 704.3371,-10730.9524 713.4902,-10764.0315 747.835,-10893.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge745" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-7819.1071C1353.8784,-7787.9967 1389.182,-7769.4532 1511.9993,-7790.1071 1620.538,-7808.3599 1639.5407,-7843.2467 1746.019,-7871.1071 1978.3947,-7931.9089 2042.0422,-7949.8555 2282.0427,-7940.1071 2369.6506,-7936.5486 2411.4713,-7980.4252 2478.6731,-7924.1071 2526.9253,-7883.6697 2465.5616,-7826.4964 2514.6731,-7787.1071 2543.0939,-7764.3126 3148.9761,-7732.3406 3169.983,-7762.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-6943.1071C1525.1222,-6776.0611 1596.9284,-6768.8842 1710.019,-6615.1071 1747.0198,-6564.7946 1785.03,-6501.5837 1803.4907,-6469.9954"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1806.5706,-6471.6613 1808.5694,-6461.2567 1800.5185,-6468.1439 1806.5706,-6471.6613"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M586.8346,-7655.9992C591.4103,-7616.5488 612.377,-7481.9769 690.4731,-7415.1071 710.4067,-7398.039 726.5747,-7416.4911 747.835,-7401.1071"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M747.835,-7401.1071C774.9352,-7381.4973 1297.6173,-7233.0065 1317.5017,-7206.1071 1391.514,-7105.9842 1286.8125,-6191.2497 1353.5017,-6086.1071 1395.8741,-6019.3025 1466.2314,-6069.6328 1511.9993,-6005.1071 1580.5096,-5908.518 1468.3279,-5828.7175 1547.9993,-5741.1071 1597.7608,-5686.387 1657.6624,-5755.3496 1710.019,-5703.1071 1759.1631,-5654.0702 1697.4931,-5600.7557 1746.019,-5551.1071 1790.2826,-5505.8194 1843.5116,-5563.8983 1883.8806,-5515.1071 1959.982,-5423.1286 1882.2184,-5092.39 1919.8806,-4979.1071 1964.3208,-4845.4367 2039.8226,-4843.8671 2092.2107,-4713.1071 2124.1748,-4633.3251 2086.5302,-4598.2709 2128.2107,-4523.1071 2173.3336,-4441.7354 2224.948,-4454.5757 2282.0427,-4381.1071 2332.4825,-4316.202 2373.1812,-4226.4345 2390.0047,-4186.582"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2393.3203,-4187.7244 2393.9328,-4177.1473 2386.858,-4185.0338 2393.3203,-4187.7244"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M747.835,-10893.1071C754.9411,-10919.8135 789.041,-10894.6857 805.1968,-10917.1071 868.2475,-11004.6103 773.2112,-11317.3804 841.1968,-11401.1071 903.8284,-11478.2403 975.5095,-11404.8333 1055.9857,-11463.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge495" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1432.7505,-7361.1071C1539.3222,-7283.0702 1588.7974,-7306.5723 1710.019,-7254.1071 2057.9704,-7103.5123 2171.033,-7105.707 2478.6731,-6884.1071 2586.2707,-6806.6022 2632.5807,-6791.221 2686.5776,-6670.1071 2782.7168,-6454.4693 2629.1797,-6356.9463 2722.5776,-6140.1071 2763.4998,-6045.0993 2825.7536,-6056.8913 2880.4805,-5969.1071 2903.9285,-5931.4955 2900.2762,-5917.3608 2916.4805,-5876.1071 2991.3453,-5685.5122 2962.4623,-5610.6192 3087.0454,-5448.1071 3115.0455,-5411.5825 3134.7515,-5415.7178 3169.983,-5386.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge639" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M747.835,-8123.1071C757.8015,-8147.3833 787.0034,-8118.195 805.1968,-8137.1071 860.8515,-8194.9603 804.846,-8242.5315 841.1968,-8314.1071 888.3086,-8406.8715 925.0804,-8413.7931 998.9033,-8487.1071 1062.5819,-8550.3467 1074.8689,-8571.6225 1149.0681,-8622.1071 1186.3246,-8647.4561 1477.9416,-8773.5996 1511.9993,-8803.1071 1533.2439,-8821.5134 1524.7651,-8839.2863 1547.9993,-8855.1071 1609.1346,-8896.7361 1659.72,-8838.8806 1710.019,-8893.1071 1780.3825,-8968.9647 1689.9374,-9036.1575 1746.019,-9123.1071 1796.103,-9200.7579 1838.847,-9192.7044 1919.8806,-9237.1071 2268.1717,-9427.9546 2531.6409,-9330.4241 2686.5776,-9696.1071 2734.287,-9808.7112 2707.1749,-11775.7868 2722.5776,-11897.1071 2741.4625,-12045.8545 2696.2714,-12118.3211 2801.5291,-12225.1071"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2801.5291,-12225.1071C2803.6904,-12227.2756 2867.0388,-12240.5208 2918.4425,-12250.9821"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2918.0457,-12254.4729 2928.5423,-12253.0331 2919.4389,-12247.6129 2918.0457,-12254.4729"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge702" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2006.0457,-7817.1071C2070.0448,-7838.37 2064.1418,-7886.0551 2128.2107,-7907.1071 2276.8427,-7955.9452 2361.9166,-7978.2442 2478.6731,-7874.1071 2521.8186,-7835.6249 2491.1661,-7801.926 2514.6731,-7749.1071 2544.0528,-7683.0925 2534.3842,-7639.9723 2600.6254,-7611.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1233.2849,-7819.1071C1270.7654,-7808.6204 1287.1053,-7819.4139 1317.5017,-7795.1071 1343.5974,-7774.2394 1324.7697,-7746.1634 1353.5017,-7729.1071 1414.0759,-7693.1483 1444.9729,-7707.4338 1511.9993,-7729.1071 1530.7785,-7735.1794 1529.6707,-7747.7862 1547.9993,-7755.1071 1738.7763,-7831.3086 1810.7609,-7753.3386 2006.0457,-7817.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge709" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M588.1844,-7655.9361C598.4976,-7608.6575 638.3915,-7420.2334 654.4731,-7263.1071 665.9743,-7150.7344 654.3181,-6354.1245 690.4731,-6247.1071 718.7116,-6163.5224 770.0613,-6166.0349 805.1968,-6085.1071 975.2437,-5693.4368 894.459,-5558.1276 998.9033,-5144.1071 1013.1182,-5087.759 1107.0248,-4683.226 1149.0681,-4643.1071 1150.7511,-4641.5012 1152.5373,-4640.0126 1154.4082,-4638.633"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1156.4346,-4641.495 1163.0963,-4633.2566 1152.751,-4635.5426 1156.4346,-4641.495"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1432.7505,-5877.1071C1450.5643,-5823.269 1486.777,-5827.898 1511.9993,-5777.1071 1540.5741,-5719.5651 1503.6651,-5683.6054 1547.9993,-5637.1071 1551.651,-5633.2771 1555.8748,-5630.0299 1560.438,-5627.2771"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.2854,-5630.2626 1569.5706,-5622.5699 1559.0783,-5624.0405 1562.2854,-5630.2626"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M902.05,-7743.1071C938.6398,-7747.0718 1213.7461,-7774.2962 1233.2849,-7743.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.0838,-7655.9252C597.9926,-7608.6027 636.4906,-7420.0272 654.4731,-7263.1071 692.0138,-6935.5187 592.0881,-6817.7381 747.835,-6527.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-6527.1071C760.8885,-6502.7486 783.1302,-6519.7443 805.1968,-6503.1071 818.9474,-6492.7398 984.8821,-6271.1055 998.9033,-6261.1071 1116.4755,-6177.2669 1283.995,-6134.5902 1372.5355,-6116.7158"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1373.284,-6120.1356 1382.4131,-6114.7588 1371.9235,-6113.2691 1373.284,-6120.1356"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M586.6647,-7655.826C591.3073,-7604.6914 614.6184,-7390.4442 690.4731,-7235.1071 777.0558,-7057.801 861.1686,-6951.7972 1055.9857,-6983.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1055.9857,-6983.1071C1100.3635,-6987.6113 1149.8629,-6999.0552 1185.2573,-7008.389"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1184.7429,-7011.8746 1195.3081,-7011.0827 1186.555,-7005.1132 1184.7429,-7011.8746"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M747.835,-7287.1071C783.3637,-7253.9274 915.5068,-7257.9121 962.9033,-7247.1071 1122.0919,-7210.817 1216.1641,-7279.1253 1317.5017,-7151.1071 1393.2635,-7055.3984 1298.2369,-6161.9455 1353.5017,-6053.1071 1393.9954,-5973.359 1466.3198,-6006.0024 1511.9993,-5929.1071 1561.7054,-5845.4333 1483.5358,-5786.0212 1547.9993,-5713.1071 1597.7439,-5656.8413 1657.979,-5719.257 1710.019,-5665.1071 1755.1335,-5618.1636 1701.2419,-5570.3725 1746.019,-5523.1071 1790.1603,-5476.5129 1844.6887,-5530.9349 1883.8806,-5480.1071 1937.8746,-5410.0826 1908.6424,-4772.8139 1919.8806,-4685.1071 1938.975,-4536.0889 1984.3193,-4360.4603 2000.3282,-4300.9855"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2003.725,-4301.832 2002.963,-4291.2646 1996.9688,-4300.0007 2003.725,-4301.832"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.8889,-7655.8213C597.838,-7606.6354 643.1744,-7408.0581 747.835,-7287.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-5877.1071C1450.5643,-5823.269 1490.7771,-5829.6951 1511.9993,-5777.1071 1542.9147,-5700.4995 1495.4221,-5470.8263 1547.9993,-5407.1071 1571.8986,-5378.1431 1605.1785,-5412.1277 1629.0092,-5383.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-7287.1071C765.9182,-7266.2092 783.7212,-7280.5005 805.1968,-7263.1071 827.0403,-7245.4157 818.5955,-7227.8195 841.1968,-7211.1071 956.6563,-7125.7309 1010.4853,-7150.721 1149.0681,-7113.1071 1223.1295,-7093.0055 1268.674,-7134.3103 1317.5017,-7075.1071 1401.2448,-6973.5692 1267.3939,-5990.6476 1353.5017,-5891.1071 1376.9017,-5864.0567 1421.5151,-5911.0637 1432.7505,-5877.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-9073.1071C1226.1093,-9194.9233 1375.6014,-9405.2782 1419.6434,-9470.3477"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1416.8844,-9472.5172 1425.3662,-9478.8661 1422.6949,-9468.6136 1416.8844,-9472.5172"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5598,-7670.5993C642.8184,-7673.2266 649.5051,-7677.1968 654.4731,-7683.1071 700.5875,-7737.9675 662.4853,-8261.1307 690.4731,-8327.1071 719.7938,-8396.2254 773.6116,-8382.9938 805.1968,-8451.1071 860.5769,-8570.5341 795.9569,-8621.4821 841.1968,-8745.1071 856.1676,-8786.0171 1025.4378,-9042.0494 1055.9857,-9073.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge478" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-7361.1071C1975.1319,-6975.292 2348.8054,-7115.6406 2686.5776,-6542.1071 2742.7713,-6446.6909 2679.7024,-6147.2036 2722.5776,-6045.1071 2763.6531,-5947.2961 2837.8177,-5963.2363 2880.4805,-5866.1071 2941.9456,-5726.1712 2846.7328,-5660.1044 2916.4805,-5524.1071 2966.4213,-5426.73 3081.8796,-5356.013 3138.0871,-5326.0248"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3139.9937,-5328.977 3147.223,-5321.2319 3136.7416,-5322.7782 3139.9937,-5328.977"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-7743.1071C999.0855,-7750.9624 1254.5147,-7678.3379 1317.5017,-7604.1071 1382.7404,-7527.2227 1284.9606,-7454.0627 1353.5017,-7380.1071 1378.1221,-7353.5418 1404.4096,-7383.6609 1432.7505,-7361.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-7819.1071C1264.6927,-7810.5876 1489.0035,-7886.0804 1511.9993,-7909.1071 1548.9462,-7946.1037 1509.5675,-7985.6553 1547.9993,-8021.1071 1602.3641,-8071.2565 1645.8841,-8022.2668 1710.019,-8059.1071 1730.1922,-8070.6949 1725.3282,-8086.4712 1746.019,-8097.1071 1814.8058,-8132.466 2328.9489,-8187.5853 2524.9938,-8207.5586"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2524.9045,-8211.0675 2535.2072,-8208.5966 2525.6124,-8204.1033 2524.9045,-8211.0675"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2801.5291,-7478.1071C2915.3477,-7317.3502 2966.6685,-7077.2378 2980.0651,-7005.2424"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2983.5513,-7005.6332 2981.8933,-6995.1689 2976.6638,-7004.3832 2983.5513,-7005.6332"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M609.4786,-7678.179C624.351,-7686.2237 642.8344,-7698.437 654.4731,-7714.1071 736.4713,-7824.5073 626.8609,-7943.7071 747.835,-8009.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M747.835,-8009.1071C751.3896,-8011.0288 995.2582,-7863.851 998.9033,-7862.1071 1063.2993,-7831.2988 1081.3103,-7827.5764 1149.0681,-7805.1071 1222.9515,-7780.6064 1265.6845,-7815.1934 1317.5017,-7757.1071 1382.8732,-7683.8267 1278.6196,-7602.6376 1353.5017,-7539.1071 1407.2175,-7493.5343 1441.5697,-7537.7128 1511.9993,-7539.1071 1646.7231,-7541.7743 1680.1995,-7551.1071 1814.9498,-7551.1071 1814.9498,-7551.1071 1814.9498,-7551.1071 2006.0457,-7551.1071 2094.8041,-7551.1071 2750.2404,-7550.5469 2801.5291,-7478.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M747.835,-7287.1071C762.8211,-7269.1825 1126.6861,-7167.8093 1149.0681,-7161.1071 1223.6365,-7138.7778 1269.6591,-7174.5084 1317.5017,-7113.1071 1397.7144,-7010.162 1274.1382,-6042.7082 1353.5017,-5939.1071 1398.2613,-5880.678 1463.4147,-5946.3965 1511.9993,-5891.1071 1576.2422,-5817.9986 1483.5358,-5748.0212 1547.9993,-5675.1071 1572.8716,-5646.9742 1591.6595,-5654.9927 1629.0092,-5651.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge432" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1055.9857,-7629.1071C1164.8189,-7580.1214 1236.0126,-7655.3068 1317.5017,-7568.1071 1385.4496,-7495.3975 1306.7471,-7434.957 1353.5017,-7347.1071 1373.7835,-7308.9986 1885.8959,-6841.7275 1919.8806,-6815.1071 2152.8344,-6632.6336 2270.6412,-6663.5513 2478.6731,-6453.1071 2499.7376,-6431.7983 2489.6839,-6412.6394 2514.6731,-6396.1071 2546.9527,-6374.7516 2576.0286,-6411.9907 2600.6254,-6382.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge450" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1432.7505,-6943.1071C1470.1608,-6865.9077 1485.8098,-6848.798 1511.9993,-6767.1071 1536.9059,-6689.4176 1511.5055,-6660.0743 1547.9993,-6587.1071 1596.2937,-6490.5451 1639.4799,-6487.8433 1710.019,-6406.1071 1788.9615,-6314.6338 1836.7232,-6308.3521 1883.8806,-6197.1071 1941.8073,-6060.4574 1843.9251,-5992.6194 1919.8806,-5865.1071 1967.5139,-5785.1415 2019.2488,-5803.8998 2092.2107,-5746.1071 2206.937,-5655.2332 2333.4142,-5533.1015 2379.9108,-5487.3868"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2382.4952,-5489.7538 2387.1597,-5480.241 2377.581,-5484.7688 2382.4952,-5489.7538"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M747.835,-7667.1071C781.2624,-7671.1648 1296.4814,-7486.413 1317.5017,-7460.1071 1357.2142,-7410.4087 1339.1865,-7238.0917 1353.5017,-7176.1071 1378.1153,-7069.5309 1387.2876,-7042.593 1432.7505,-6943.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M635.4179,-7665.8206C667.5159,-7665.3074 710.1678,-7665.2189 747.835,-7667.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-7819.1071C1235.9482,-7818.428 1545.5992,-8057.7678 1547.9993,-8059.1071 1808.5973,-8204.5291 1910.6675,-8148.6033 2205.1267,-8197.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-8197.1071C2252.9254,-8201.7019 2306.4381,-8212.6928 2345.0079,-8221.6786"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2344.4383,-8225.1403 2354.9751,-8224.0335 2346.0479,-8218.3279 2344.4383,-8225.1403"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.4996,-7670.6502C642.7652,-7673.2716 649.4698,-7677.2267 654.4731,-7683.1071 730.9717,-7773.0158 641.4561,-8105.7156 690.4731,-8213.1071 720.3201,-8278.4988 773.7228,-8262.4827 805.1968,-8327.1071 864.7699,-8449.4266 767.7508,-8516.579 841.1968,-8631.1071 884.4708,-8698.5865 1075.9978,-8786.1399 1149.0681,-8819.1071 1184.775,-8835.217 1196.3226,-8832.1342 1233.2849,-8845.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-8845.1071C1288.7223,-8861.0979 1299.4562,-8873.9059 1353.5017,-8894.1071 1388.3562,-8907.1351 1396.7662,-8911.636 1432.7505,-8921.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-8921.1071C1494.5564,-8937.3744 1491.0242,-8978.1512 1547.9993,-9007.1071 1556.0935,-9011.2208 1564.9907,-9014.8035 1573.8339,-9017.8724"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1572.7751,-9021.2086 1583.368,-9021.0016 1574.9581,-9014.5576 1572.7751,-9021.2086"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1055.9857,-6983.1071C1104.7157,-6988.053 1102.0288,-7028.455 1149.0681,-7042.1071 1220.9608,-7062.9724 1263.7664,-7094.2266 1317.5017,-7042.1071 1364.5406,-6996.4826 1335.6501,-5926.1592 1353.5017,-5863.1071 1392.0363,-5727.0025 1464.4965,-5720.347 1511.9993,-5587.1071 1544.9768,-5494.6088 1483.0098,-5442.7265 1547.9993,-5369.1071 1572.8507,-5340.9557 1617.8273,-5380.9548 1629.0092,-5345.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1629.0092,-5345.1071C1650.6384,-5275.911 1765.1011,-5082.8567 1802.8569,-5020.096"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1806.066,-5021.552 1808.2319,-5011.1809 1800.0712,-5017.9377 1806.066,-5021.552"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-7477.1071C902.4666,-7427.3332 953.634,-7522.2382 1113.0681,-7491.1071 1209.3128,-7472.3143 1259.7231,-7487.34 1317.5017,-7408.1071 1380.396,-7321.859 1327.1909,-7032.5584 1353.5017,-6929.1071 1395.7915,-6762.8281 1448.6521,-6736.557 1511.9993,-6577.1071 1530.0587,-6531.65 1522.0442,-6514.5658 1547.9993,-6473.1071 1602.0338,-6386.7964 1655.9845,-6397.4178 1710.019,-6311.1071 1735.9741,-6269.6484 1711.4635,-6241.7251 1746.019,-6207.1071 1768.9367,-6184.1481 1791.9194,-6205.953 1814.9498,-6183.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M591.284,-7656.0917C608.9002,-7622.5097 667.0865,-7521.0411 747.835,-7477.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M747.835,-7477.1071C785.0306,-7456.8695 799.1061,-7462.7379 841.1968,-7458.1071 856.2127,-7456.4551 1099.5133,-7459.776 1113.0681,-7453.1071 1136.0498,-7441.8003 1129.6697,-7424.8314 1149.0681,-7408.1071 1214.6636,-7351.5541 1272.4944,-7384.1027 1317.5017,-7310.1071 1359.8765,-7240.4395 1301.4535,-6639.878 1353.5017,-6577.1071 1399.7395,-6521.3436 1462.8317,-6592.3053 1511.9993,-6539.1071 1581.6302,-6463.768 1494.1464,-6398.4244 1547.9993,-6311.1071 1604.8494,-6218.93 1649.8879,-6218.9806 1746.019,-6169.1071 1803.6093,-6139.2289 1844.3667,-6172.5658 1883.8806,-6121.1071 1949.8366,-6035.2129 1866.9653,-5729.5951 1919.8806,-5635.1071 1942.9331,-5593.9435 1972.1658,-5605.9402 2006.0457,-5573.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1233.2849,-7819.1071C1352.9742,-7785.7213 1402.8313,-7781.7565 1511.9993,-7841.1071 1535.1162,-7853.675 1526.2636,-7873.2778 1547.9993,-7888.1071 1688.9154,-7984.2478 1752.6185,-7949.5843 1919.8806,-7983.1071 2012.1642,-8001.6027 2034.4746,-8012.6282 2128.2107,-8021.1071 2196.3025,-8027.2664 2213.7522,-8024.3988 2282.0427,-8021.1071 2369.7392,-8016.88 2413.4379,-8060.8686 2478.6731,-8002.1071 2538.3201,-7948.3793 2459.9777,-7883.8681 2514.6731,-7825.1071 2541.6962,-7796.0753 2561.3804,-7795.3686 2600.6254,-7801.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-7401.1071C825.4072,-7344.2476 867.5382,-7412.6191 962.9033,-7425.1071 1004.3844,-7430.5391 1020.9634,-7461.9899 1055.9857,-7439.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-7439.1071C1118.1878,-7398.0029 1183.3016,-7338.2706 1214.474,-7308.462"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1217.2164,-7310.6801 1221.9914,-7301.2222 1212.3606,-7305.638 1217.2164,-7310.6801"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge405" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-7743.1071C986.9067,-7749.9765 978.5897,-7664.5712 1055.9857,-7629.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-7629.1071C1172.0756,-7575.9129 1239.9188,-7611.5338 1317.5017,-7510.1071 1377.6972,-7431.4115 1306.9421,-7377.564 1353.5017,-7290.1071 1619.6868,-6790.1088 1870.8044,-6806.64 2282.0427,-6417.1071 2333.9216,-6367.9665 2331.8346,-6332.2006 2398.3579,-6306.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-7667.1071C824.1504,-7670.9327 825.888,-7736.9416 902.05,-7743.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge521" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-7817.1071C2095.9237,-7846.968 2110.5217,-7888.6777 2205.1267,-7893.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge610" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M747.835,-8123.1071C757.6906,-8147.4286 788.0327,-8117.2561 805.1968,-8137.1071 860.6754,-8201.2708 796.6067,-8444.9504 841.1968,-8517.1071 874.7209,-8571.3565 913.5297,-8552.7449 962.9033,-8593.1071 980.9152,-8607.8315 979.2777,-8618.6143 998.9033,-8631.1071 1044.0157,-8659.8238 1071.3467,-8635.6542 1113.0681,-8669.1071 1137.3304,-8688.561 1124.3347,-8710.2559 1149.0681,-8729.1071 1210.8803,-8776.2189 1247.7859,-8741.7564 1317.5017,-8776.1071 1335.4422,-8784.9468 1335.6593,-8794.0711 1353.5017,-8803.1071 1419.1642,-8836.3609 1450.3574,-8810.887 1511.9993,-8851.1071 1532.5894,-8864.5418 1526.9918,-8880.3348 1547.9993,-8893.1071 1611.1981,-8931.5312 1660.7636,-8875.931 1710.019,-8931.1071 1801.2127,-9033.2625 1665.0919,-9126.6408 1746.019,-9237.1071 1795.8865,-9305.1767 2021.7519,-9346.6767 2092.2107,-9393.1071 2110.3345,-9405.0502 2109.0807,-9415.8527 2128.2107,-9426.1071 2190.2804,-9459.3789 2225.6289,-9421.951 2282.0427,-9464.1071 2611.7312,-9710.472 2601.842,-9894.3541 2686.5776,-10297.1071 2708.794,-10402.7028 2658.0203,-12152.6411 2722.5776,-12239.1071 2728.3871,-12246.8881 2736.6265,-12252.3036 2745.6093,-12256.06"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2744.5739,-12259.4058 2755.1687,-12259.4038 2746.8851,-12252.7983 2744.5739,-12259.4058"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge621" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1055.9857,-11235.1071C1103.2255,-11245.0736 1104.8582,-11271.7056 1149.0681,-11291.1071 1235.7777,-11329.1596 1259.7729,-11337.6368 1353.5017,-11351.1071 1423.2287,-11361.128 1441.5566,-11351.4081 1511.9993,-11351.1071 1532.4989,-11351.0195 1555.0182,-11350.8456 1574.7798,-11350.667"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1574.8701,-11354.1664 1584.8371,-11350.5736 1574.805,-11347.1667 1574.8701,-11354.1664"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M747.835,-10893.1071C755.2051,-10919.7419 788.055,-10895.4302 805.1968,-10917.1071 866.1087,-10994.1343 782.3396,-11056.4987 841.1968,-11135.1071 904.3092,-11219.3987 951.1892,-11224.8138 1055.9857,-11235.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge573" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.4072,-7670.7296C642.6835,-7673.3417 649.4156,-7677.2732 654.4731,-7683.1071 715.2544,-7753.2185 635.7744,-8024.1537 690.4731,-8099.1071 706.7641,-8121.4305 737.988,-8097.2853 747.835,-8123.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-8123.1071C761.211,-8158.1833 779.7271,-8157.529 805.1968,-8185.1071 958.1753,-8350.7494 971.4118,-8419.2617 1149.0681,-8558.1071 1372.9983,-8733.1173 1496.1562,-8677.9281 1710.019,-8865.1071 1730.354,-8882.9049 1728.3292,-8893.6782 1746.019,-8914.1071 1816.9676,-8996.0414 1826.0601,-9030.8426 1919.8806,-9085.1071 1954.2926,-9105.0105 1971.4602,-9089.5066 2006.0457,-9109.1071"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge591" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M635.4431,-7670.6986C642.7152,-7673.3144 649.4367,-7677.2551 654.4731,-7683.1071 720.4915,-7759.8153 639.0992,-8049.9103 690.4731,-8137.1071 721.52,-8189.8028 773.747,-8160.6509 805.1968,-8213.1071 848.8131,-8285.8565 787.7747,-8527.2212 841.1968,-8593.1071 876.8862,-8637.1232 914.8176,-8601.1252 962.9033,-8631.1071 982.6447,-8643.4161 981.0165,-8654.2311 998.9033,-8669.1071 1045.393,-8707.7714 1065.2452,-8706.1046 1113.0681,-8743.1071 1130.2346,-8756.3895 1130.3275,-8765.1572 1149.0681,-8776.1071 1217.0619,-8815.8349 1245.3218,-8799.6187 1317.5017,-8831.1071 1334.2781,-8838.4258 1336.8143,-8843.5876 1353.5017,-8851.1071 1421.6166,-8881.8005 1445.1814,-8873.6842 1511.9993,-8907.1071 1529.1973,-8915.7097 1531.3672,-8921.4557 1547.9993,-8931.1071 1617.631,-8971.5137 1664.131,-8945.9592 1710.019,-9012.1071 1753.2,-9074.3527 1695.4852,-9294.6674 1746.019,-9351.1071 1798.5584,-9409.7867 2023.3782,-9388.8217 2092.2107,-9427.1071 2112.2616,-9438.2597 2108.4826,-9452.393 2128.2107,-9464.1071 2189.2515,-9500.3518 2235.7996,-9453.244 2282.0427,-9507.1071 2325.3497,-9557.5502 2297.6313,-9740.8349 2318.0427,-9804.1071 2385.1272,-10012.0585 2538.7041,-10232.3677 2586.2958,-10297.7585"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2583.5553,-10299.9402 2592.2877,-10305.9398 2589.2027,-10295.8041 2583.5553,-10299.9402"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge546" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.6136,-7670.5544C642.866,-7673.1868 649.5367,-7677.1705 654.4731,-7683.1071 711.0793,-7751.1818 671.7383,-8392.5772 690.4731,-8479.1071 728.5709,-8655.0677 756.6041,-8696.1806 841.1968,-8855.1071 1014.8478,-9181.3497 1066.2696,-9277.5418 1353.5017,-9510.1071 1443.734,-9583.1661 1725.7846,-9829.4646 1814.9498,-9755.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-9755.1071C1829.9237,-9742.7232 1870.0093,-9733.9988 1909.6226,-9728.1452"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1910.2597,-9731.5899 1919.6681,-9726.7184 1909.2752,-9724.6595 1910.2597,-9731.5899"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge673" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-7971.1071C908.0454,-7970.3859 2474.0555,-8701.2158 2478.6731,-8705.1071 2602.7218,-8809.6433 2621.0656,-8856.7019 2686.5776,-9005.1071 2715.4882,-9070.5985 2666.585,-9117.5004 2722.5776,-9162.1071 2777.4678,-9205.8355 2825.8091,-9206.1087 2880.4805,-9162.1071 3095.8076,-8988.8035 3159.8076,-8017.881 3168.8165,-7860.6238"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3172.3259,-7860.5519 3169.391,-7850.3717 3165.3369,-7860.1601 3172.3259,-7860.5519"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge658" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-7971.1071C1096.5786,-7943.4243 2404.9201,-8445.5821 2600.6254,-8463.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge811" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.4824,-13111.1583C403.2055,-13211.0566 433.6389,-13959.2659 516.9653,-14165.1071 564.2175,-14281.8341 602.2059,-14299.2914 690.4731,-14389.1071 805.8445,-14506.5023 849.0237,-14526.0757 998.9033,-14594.1071 1149.3991,-14662.4181 1193.7143,-14663.8775 1353.5017,-14706.1071 1765.7075,-14815.0473 1879.6912,-14806.0579 2282.0427,-14947.1071 2335.4808,-14965.8405 2344.8258,-15017.5699 2398.3579,-14999.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-14999.1071C2599.1496,-14923.1647 2587.3108,-14719.1398 2801.5291,-14733.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11881.1071C599.7253,-11836.2726 643.6055,-11891.9891 690.4731,-11895.1071 741.349,-11898.4917 767.9229,-11929.8989 805.1968,-11895.1071 847.6971,-11855.4369 817.36,-11426.1336 841.1968,-11373.1071 872.858,-11302.6747 931.0525,-11319.454 962.9033,-11249.1071 1051.8733,-11052.6049 912.281,-10962.6555 998.9033,-10765.1071 1006.3568,-10748.1089 1020.6223,-10732.8622 1033.0269,-10721.8634"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1035.4439,-10724.4032 1040.8195,-10715.2733 1030.9238,-10719.0582 1035.4439,-10724.4032"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M585.7192,-10931.1071C595.1325,-10896.3167 632.7098,-10916.8358 654.4731,-10888.1071 688.868,-10842.7041 669.7702,-10818.1715 690.4731,-10765.1071 732.2821,-10657.945 767.7418,-10641.8675 805.1968,-10533.1071 917.8079,-10206.1106 899.6702,-10111.1211 962.9033,-9771.1071 980.8581,-9674.5614 979.1149,-9649.2938 998.9033,-9553.1071 1054.9917,-9280.4748 1059.8432,-9208.7606 1149.0681,-8945.1071 1209.1999,-8767.4217 1267.0131,-8738.7693 1317.5017,-8558.1071 1333.5566,-8500.6583 1312.709,-8335.6281 1353.5017,-8292.1071 1357.9112,-8287.4027 1363.2899,-8283.8715 1369.1481,-8281.2439"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1370.4507,-8284.495 1378.6782,-8277.8197 1368.0837,-8277.9073 1370.4507,-8284.495"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M585.7192,-10931.1071C594.1724,-10899.865 633.938,-10932.1238 654.4731,-10907.1071 727.3726,-10818.298 660.1784,-10761.9385 690.4731,-10651.1071 702.3627,-10607.6101 724.5466,-10559.569 737.5675,-10533.2014"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="740.7211,-10534.7204 742.0687,-10524.2116 734.4619,-10531.5863 740.7211,-10534.7204"/>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M453.5185,-13093.7899C464.1896,-13089.9976 474.1678,-13084.1291 480.9653,-13075.1071 552.0166,-12980.8053 444.6609,-11043.4516 516.9653,-10950.1071 536.3792,-10925.044 577.4392,-10961.7093 585.7192,-10931.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge760" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M399.7341,-13111.3525C405.2133,-13204.1121 445.2444,-13843.8428 516.9653,-14021.1071 607.2704,-14244.3038 651.5929,-14306.7086 841.1968,-14455.1071 1035.7842,-14607.406 1117.0838,-14599.2337 1353.5017,-14671.1071 1523.5111,-14722.7916 1569.1388,-14730.1407 1746.019,-14747.1071 1899.179,-14761.7983 1938.4507,-14752.7356 2092.2107,-14747.1071 2250.1542,-14741.3255 2643.4798,-14695.1071 2801.5291,-14695.1071 2801.5291,-14695.1071 2801.5291,-14695.1071 3372.8452,-14695.1071 3522.6461,-14695.1071 3575.7968,-14456.601 3619.1829,-14329.1071 3691.1553,-14117.6096 3711.159,-13844.2898 3715.5592,-13766.5673"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3719.0758,-13766.3525 3716.1184,-13756.1788 3712.0859,-13765.9762 3719.0758,-13766.3525"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge771" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M453.5811,-13093.8369C464.249,-13090.0421 474.21,-13084.1607 480.9653,-13075.1071 520.3197,-13022.3638 513.3524,-8402.8153 516.9653,-8337.1071 531.0672,-8080.6361 571.5914,-7770.9898 582.8099,-7688.2643"/>
<polygon fill="#00cbff" stroke="#00cbff" points="586.309,-7688.5079 584.1926,-7678.1266 579.3733,-7687.5618 586.309,-7688.5079"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge719" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-14467.1071C1418.8857,-14570.5589 1500.2013,-14536.6691 1710.019,-14503.1071 2334.8184,-14403.1654 2565.4538,-14430.7713 3051.0454,-14025.1071 3260.5094,-13850.1205 3347.6801,-13814.2968 3456.7698,-13564.1071 3511.6688,-13438.1999 3546.961,-12994.4006 3554.4726,-12892.2043"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3557.9666,-12892.4131 3555.1998,-12882.186 3550.985,-12891.9063 3557.9666,-12892.4131"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M401.7288,-13111.4573C417.0872,-13176.0444 497.1933,-13495.1282 585.7192,-13517.1071"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M747.835,-13061.1071C796.6589,-12974.1679 795.2703,-12945.6111 841.1968,-12857.1071 951.6398,-12644.2747 1006.868,-12606.0881 1113.0681,-12391.1071 1219.0358,-12176.5967 1241.7042,-12120.0402 1317.5017,-11893.1071 1337.5826,-11832.9861 1318.9155,-11808.2256 1353.5017,-11755.1071 1366.1603,-11735.6657 1386.8328,-11719.5243 1403.8902,-11708.4482"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1405.7874,-11711.3899 1412.419,-11703.1272 1402.0821,-11705.451 1405.7874,-11711.3899"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M585.7192,-13517.1071C794.4749,-13568.9362 651.1675,-13253.2544 747.835,-13061.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge491" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1233.2849,-14467.1071C1574.0444,-14651.7271 2623.4912,-14184.2073 2880.4805,-13894.1071 2998.6815,-13760.6769 3009.7691,-13704.5181 3051.0454,-13531.1071 3116.9879,-13254.0679 3065.8954,-12534.0997 3087.0454,-12250.1071 3132.5639,-11638.9053 3212.4626,-11492.6648 3252.9207,-10881.1071 3298.677,-10189.4617 3277.7064,-8455.1737 3288.9207,-7762.1071 3316.261,-6072.4111 3366.6739,-3984.6499 3372.3259,-3752.3888"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3375.8289,-3752.3054 3372.5736,-3742.2231 3368.831,-3752.1348 3375.8289,-3752.3054"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M399.9443,-13111.3339C406.6658,-13197.5572 452.2131,-13755.4281 516.9653,-13910.1071 566.2741,-14027.8951 596.7915,-14052.3365 690.4731,-14139.1071 748.917,-14193.2395 771.2241,-14198.0306 841.1968,-14236.1071 899.4428,-14267.8024 1057.5428,-14322.8562 1113.0681,-14359.1071 1173.2097,-14398.3718 1170.1711,-14432.8233 1233.2849,-14467.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge632" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M747.835,-14125.1071C843.0582,-14136.9612 867.9357,-14130.3549 962.9033,-14144.1071 1173.7508,-14174.6397 1219.7038,-14239.1071 1432.7505,-14239.1071 1432.7505,-14239.1071 1432.7505,-14239.1071 1629.0092,-14239.1071 1690.9124,-14239.1071 1864.961,-14148.3961 1883.8806,-14139.1071 1978.6247,-14092.5905 2000.168,-14076.7634 2092.2107,-14025.1071 2357.9879,-13875.9475 2492.355,-13917.9767 2686.5776,-13683.1071 2717.7486,-13645.4127 2687.3377,-13613.0282 2722.5776,-13579.1071 2749.0005,-13553.6732 2785.4797,-13588.0839 2801.5291,-13555.1071"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M400.3843,-13111.2404C413.4096,-13220.1974 524.5881,-14092.8606 747.835,-14125.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge707" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M453.5358,-13093.8029C464.206,-13090.0099 474.1794,-13084.1378 480.9653,-13075.1071 522.8037,-13019.4284 513.6189,-10637.6727 516.9653,-10568.1071 562.3258,-9625.1538 406.6204,-9351.466 690.4731,-8451.1071 762.6078,-8222.3015 892.7825,-8214.5379 962.9033,-7985.1071 1035.7995,-7746.5954 958.5697,-7671.2267 998.9033,-7425.1071 1030.7418,-7230.8255 1085.9894,-7192.1091 1113.0681,-6997.1071 1122.063,-6932.3321 1108.4138,-4694.3315 1149.0681,-4643.1071 1150.3679,-4641.4694 1151.7741,-4639.9476 1153.2715,-4638.5338"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1155.5966,-4641.1631 1161.4468,-4632.3299 1151.365,-4635.5869 1155.5966,-4641.1631"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11881.1071C595.2264,-11850.1694 634.7678,-11882.7825 654.4731,-11857.1071 720.1381,-11771.5483 664.342,-11477.7463 690.4731,-11373.1071 763.2,-11081.8805 850.0566,-11033.2577 962.9033,-10755.1071 1065.9095,-10501.2119 1372.9306,-9655.2092 1425.1575,-9511.0739"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1428.597,-9511.855 1428.7124,-9501.2608 1422.0156,-9509.4707 1428.597,-9511.855"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.4204,-13093.7154C464.0966,-13089.927 474.1016,-13084.0788 480.9653,-13075.1071 557.7663,-12974.7193 461.4048,-12051.6374 516.9653,-11938.1071 534.4133,-11902.4547 573.5587,-11918.8913 585.7192,-11881.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge455" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-14125.1071C1030.5293,-14327.2819 1169.4488,-14349.8428 1511.9993,-14291.1071 1850.8899,-14232.9989 2732.5432,-13879.4908 2880.4805,-13569.1071 3128.359,-13049.039 3011.5625,-12858.8728 3051.0454,-12284.1071 3057.6246,-12188.3315 3043.8216,-5457.8273 3087.0454,-5372.1071 3097.2467,-5351.8763 3117.505,-5336.5383 3135.4457,-5326.1788"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3137.4455,-5329.075 3144.5506,-5321.2158 3134.0952,-5322.9288 3137.4455,-5329.075"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1233.2849,-14049.1071C1334.6068,-14086.6898 1608.6922,-13990.6766 1710.019,-13953.1071 1884.8435,-13888.2864 1931.7711,-13875.1043 2092.2107,-13780.1071 2532.1942,-13519.5904 2734.8877,-13432.2675 2880.4805,-12942.1071 2923.0652,-12798.739 2907.2607,-7707.3815 2916.4805,-7558.1071 2929.8649,-7341.4034 2968.6953,-7080.9285 2980.3906,-7005.5145"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2983.8861,-7005.8146 2981.9701,-6995.3944 2976.9698,-7004.735 2983.8861,-7005.8146"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge408" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M902.05,-13688.1071C941.1385,-13711.3483 955.372,-13668.2632 998.9033,-13655.1071 1102.0483,-13623.9344 1125.5324,-13593.1071 1233.2849,-13593.1071 1233.2849,-13593.1071 1233.2849,-13593.1071 1432.7505,-13593.1071 1789.8496,-13593.1071 1913.8063,-13443.4477 2092.2107,-13134.1071 2369.6025,-12653.1293 2360.7779,-12488.6812 2478.6731,-11946.1071 2500.5494,-11845.4287 2493.7004,-11817.9776 2514.6731,-11717.1071 2576.5523,-11419.4917 2646.9623,-11356.4949 2686.5776,-11055.1071 2757.7499,-10513.6389 2656.4286,-6682.2119 2722.5776,-6140.1071 2737.0579,-6021.4383 2778.4151,-5883.5128 2794.762,-5831.9535"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2798.1367,-5832.8912 2797.852,-5822.3002 2791.4699,-5830.7572 2798.1367,-5832.8912"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M747.835,-13517.1071C849.942,-13510.1869 817.4241,-13630.5556 902.05,-13688.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge500" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-13517.1071C829.9491,-13496.5598 788.2657,-13417.1618 841.1968,-13351.1071 1019.1645,-13129.0145 1108.2538,-13116.0137 1317.5017,-12923.1071 1421.1724,-12827.5326 1440.645,-12796.5246 1547.9993,-12705.1071 1617.0376,-12646.3176 1666.6216,-12660.7259 1710.019,-12581.1071 1757.6068,-12493.8006 1728.7016,-12233.0209 1746.019,-12135.1071 1846.6414,-11566.1834 1976.1302,-11448.0792 2092.2107,-10882.1071 2116.0916,-10765.6713 2096.1045,-10731.5483 2128.2107,-10617.1071 2151.2696,-10534.9146 2186.915,-10524.5077 2205.1267,-10441.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-13517.1071C655.6477,-13534.4687 675.9484,-13521.9791 747.835,-13517.1071"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge605" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M902.05,-13688.1071C1001.5296,-13732.351 1131.0959,-14011.5423 1233.2849,-14049.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1233.2849,-14049.1071C1286.3815,-14063.9977 1658.1595,-13929.8573 1710.019,-13911.1071 1789.3264,-13882.4329 1809.8941,-13875.5777 1883.8806,-13835.1071 2070.5916,-13732.9764 2122.8321,-13710.3291 2282.0427,-13569.1071 2488.7316,-13385.7712 2573.2002,-13349.0553 2686.5776,-13097.1071 2703.8784,-13058.6613 2783.5714,-12411.197 2798.9548,-12285.2433"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2802.4316,-12285.6455 2800.1684,-12275.2952 2795.4831,-12284.7978 2802.4316,-12285.6455"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge549" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-13517.1071C816.2181,-13512.4725 834.744,-13530.0545 902.05,-13517.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-13517.1071C1440.2223,-13413.5807 1576.8264,-13225.0507 1883.8806,-12771.1071 2000.1791,-12599.1735 2036.017,-12552.929 2092.2107,-12353.1071 2142.6902,-12173.6045 2085.5712,-12116.6319 2128.2107,-11935.1071 2225.3289,-11521.6553 2389.4037,-11461.3243 2478.6731,-11046.1071 2513.6987,-10883.1931 2503.5147,-10463.3697 2514.6731,-10297.1071 2541.0228,-9904.4917 2588.029,-9426.1709 2598.5136,-9321.1366"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2601.9984,-9321.4629 2599.5115,-9311.1641 2595.0332,-9320.7659 2601.9984,-9321.4629"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge585" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M902.05,-13517.1071C1046.9573,-13491.1401 1086.0694,-13517.1071 1233.2849,-13517.1071 1233.2849,-13517.1071 1233.2849,-13517.1071 1629.0092,-13517.1071 1682.3045,-13517.1071 1859.0536,-13421.0147 2092.2107,-12980.1071 2165.4979,-12841.5186 2453.4875,-11777.8439 2478.6731,-11623.1071 2535.4943,-11274.0057 2477.2698,-11179.8193 2514.6731,-10828.1071 2535.0396,-10636.5956 2581.4516,-10408.0338 2596.1047,-10338.3182"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2599.6027,-10338.6933 2598.2467,-10328.1857 2592.754,-10337.2455 2599.6027,-10338.6933"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge540" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-13061.1071C769.9931,-13017.0631 1086.7928,-12850.826 1113.0681,-12809.1071 1167.5066,-12722.672 1080.2606,-12657.6061 1149.0681,-12582.1071 1201.1102,-12525.0039 1251.7514,-12579.6787 1317.5017,-12539.1071 1373.6043,-12504.4887 1479.791,-12372.6272 1511.9993,-12315.1071 1537.9584,-12268.7472 1519.7044,-12246.0794 1547.9993,-12201.1071 1600.5798,-12117.5349 1669.1406,-12138.9846 1710.019,-12049.1071 1755.4986,-11949.1133 1726.6228,-11169.2318 1746.019,-11061.1071 1780.5597,-10868.5595 1848.7132,-10835.5412 1883.8806,-10643.1071 1917.3892,-10459.7498 1845.2824,-9975.9223 1919.8806,-9805.1071 1932.6851,-9775.7874 1960.2142,-9750.8728 1980.7297,-9735.3171"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1983.0301,-9737.9706 1989.0292,-9729.2378 1978.8937,-9732.3235 1983.0301,-9737.9706"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge653" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-13517.1071C754.921,-13559.1159 998.126,-13975.8692 1149.0681,-14063.1071 1369.334,-14190.4111 1476.3136,-14277.6313 1710.019,-14177.1071 1731.3904,-14167.9146 1726.0732,-14151.0819 1746.019,-14139.1071 1800.5097,-14106.3927 1835.2161,-14141.9879 1883.8806,-14101.1071 1912.4986,-14077.0665 1895.0773,-14053.0666 1919.8806,-14025.1071 2046.1032,-13882.8232 2126.3026,-13906.2944 2282.0427,-13797.1071 2298.6399,-13785.471 2301.2362,-13780.4387 2318.0427,-13769.1071 2401.7997,-13712.6349 2424.6484,-13700.9318 2514.6731,-13655.1071 2589.119,-13617.2124 2626.7431,-13637.3997 2686.5776,-13579.1071 2713.3489,-13553.0257 2701.2435,-13533.7958 2722.5776,-13503.1071 2779.9684,-13420.5517 2842.1826,-13434.0715 2880.4805,-13341.1071 2922.985,-13237.9315 2913.4546,-9435.6539 2916.4805,-9324.1071 2932.6981,-8726.2449 2974.6907,-7993.8787 2982.5022,-7860.4711"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2986.0042,-7860.5389 2983.0967,-7850.3509 2979.0163,-7860.1284 2986.0042,-7860.5389"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge812" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.3424,-3694.6968C906.1974,-3545.674 947.7028,-1983.831 998.9033,-1787.1071 1036.8598,-1641.2698 1079.162,-1616.6075 1149.0681,-1483.1071 1220.722,-1346.269 1265.6957,-1324.6237 1317.5017,-1179.1071 1347.7936,-1094.0211 1309.614,-1058.0444 1353.5017,-979.1071 1399.6049,-896.185 1447.9066,-906.0621 1511.9993,-836.1071 1628.6161,-708.8238 1609.9829,-632.3837 1746.019,-526.1071 2038.5772,-297.5497 2150.9028,-273.2685 2514.6731,-199.1071 2639.7043,-173.6172 2674.3361,-200.8856 2801.5291,-211.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2801.5291,-211.1071C3136.6062,-198.6156 3220.7675,-202.8751 3555.9763,-211.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.9762,-3717.252C909.5449,-3796.8842 949.2259,-4287.7839 962.9033,-4688.1071 984.1919,-5311.2008 953.2953,-9677.3203 998.9033,-10299.1071 1009.7368,-10446.8025 1040.8046,-10622.6496 1051.9474,-10682.7526"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1048.5648,-10683.7059 1053.8427,-10692.8925 1055.4457,-10682.4196 1048.5648,-10683.7059"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1055.9857,-3973.1071C1066.6796,-3996.9397 1096.2126,-3967.1511 1113.0681,-3987.1071 1184.3776,-4071.5339 1107.4422,-4380.7341 1149.0681,-4483.1071 1170.9545,-4536.9335 1223.5846,-4525.8167 1233.2849,-4583.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1233.2849,-4583.1071C1239.6906,-4620.9391 1293.3849,-4572.263 1317.5017,-4602.1071 1377.8957,-4676.8438 1336.131,-7966.6017 1353.5017,-8061.1071 1367.1747,-8135.4952 1404.2495,-8217.9778 1422.4247,-8255.5017"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1419.4652,-8257.4156 1427.0147,-8264.849 1425.7485,-8254.3301 1419.4652,-8257.4156"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1233.2849,-4583.1071C1239.6906,-4620.9391 1293.3948,-4572.255 1317.5017,-4602.1071 1381.972,-4681.9421 1331.0327,-8195.9813 1353.5017,-8296.1071 1366.6806,-8354.8343 1401.5353,-8417.5236 1420.3265,-8448.4783"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1417.3712,-8450.354 1425.6008,-8457.0266 1423.3285,-8446.6783 1417.3712,-8450.354"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge762" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M902.3397,-3694.9406C906.0079,-3555.2039 944.1955,-2148.0012 998.9033,-1973.1071 1027.8607,-1880.534 1076.0542,-1876.7636 1113.0681,-1787.1071 1139.5605,-1722.9362 1113.6967,-1694.845 1149.0681,-1635.1071 1200.443,-1548.3413 1266.3768,-1570.0204 1317.5017,-1483.1071 1353.5787,-1421.7755 1330.6403,-1394.4901 1353.5017,-1327.1071 1408.1055,-1166.1647 1455.6692,-1139.4535 1511.9993,-979.1071 1533.5789,-917.6796 1501.5506,-882.731 1547.9993,-837.1071 1600.7652,-785.278 1658.6451,-852.3163 1710.019,-799.1071 1767.2923,-739.7878 1687.7853,-675.4838 1746.019,-617.1071 1991.7911,-370.7319 2941.8489,-374.5215 3288.9207,-349.1071 3363.3211,-343.6591 3389.7837,-316.2747 3456.7698,-349.1071 3521.3993,-380.7845 3513.1749,-419.2411 3555.9763,-477.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge796" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M902.7563,-3717.2624C907.7993,-3796.9666 938.8333,-4288.2741 962.9033,-4688.1071 1001.6431,-5331.6229 1046.8676,-6121.5178 1054.7764,-6259.9268"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1051.2892,-6260.2534 1055.3539,-6270.0375 1058.2778,-6259.8542 1051.2892,-6260.2534"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M902.9384,-3717.2534C909.245,-3796.8951 947.4402,-4287.8489 962.9033,-4688.1071 983.0398,-5209.3352 944.3148,-6516.3545 998.9033,-7035.1071 1026.398,-7296.3885 1080.1965,-7354.4476 1113.0681,-7615.1071 1121.924,-7685.3307 1105.1489,-8195.6014 1149.0681,-8251.1071 1151.6041,-8254.3121 1154.5319,-8257.12 1157.7418,-8259.579"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1155.9259,-8262.5721 1166.2389,-8264.9995 1159.6906,-8256.6706 1155.9259,-8262.5721"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge727" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.5373,-3694.8917C907.4519,-3582.9237 948.9306,-2664.6687 998.9033,-2395.1071 1041.0421,-2167.8034 1052.2545,-2107.0352 1149.0681,-1897.1071 1207.0412,-1771.3997 1242.7695,-1751.6332 1317.5017,-1635.1071 1404.0925,-1500.0904 1455.0116,-1481.04 1511.9993,-1331.1071 1548.292,-1235.622 1512.843,-1200.0165 1547.9993,-1104.1071 1595.7712,-973.781 1653.7622,-964.0016 1710.019,-837.1071 1732.759,-785.8144 1712.2476,-760.9127 1746.019,-716.1071 1853.7576,-573.1672 1949.3466,-595.9655 2128.2107,-589.1071 2283.9486,-583.1355 2324.023,-581.786 2478.6731,-601.1071 2826.2284,-644.5288 2939.4882,-591.7734 3252.9207,-748.1071 3269.034,-756.1441 3358.7801,-845.864 3372.8452,-857.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1233.2849,-3483.1071C1353.1017,-3490.6854 2211.64,-3645.8603 2282.0427,-3743.1071 2334.1196,-3815.0405 2262.2288,-4072.033 2318.0427,-4141.1071 2320.6528,-4144.3373 2323.674,-4147.1583 2326.9829,-4149.6212"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2325.3848,-4152.7482 2335.73,-4155.0347 2329.0687,-4146.7959 2325.3848,-4152.7482"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M902.9089,-3717.2546C909.0104,-3796.9046 946.044,-4287.9052 962.9033,-4688.1071 966.676,-4777.6611 965.72,-6217.8424 998.9033,-6301.1071 1026.8795,-6371.3059 1082.8742,-6357.8332 1113.0681,-6427.1071 1187.572,-6598.0414 1057.869,-6682.4661 1149.0681,-6845.1071 1194.5332,-6926.1878 1275.235,-6886.3141 1317.5017,-6969.1071 1375.4003,-7082.5202 1320.3953,-11430.1488 1353.5017,-11553.1071 1366.0995,-11599.8959 1398.3232,-11647.4576 1417.5784,-11673.0159"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1414.9249,-11675.3069 1423.7949,-11681.1012 1420.4742,-11671.0401 1414.9249,-11675.3069"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge496" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M902.637,-3694.8796C907.8488,-3596.4961 947.2244,-2879.7913 998.9033,-2671.1071 1030.813,-2542.2528 1080.2118,-2523.7233 1113.0681,-2395.1071 1149.8039,-2251.3047 1083.6512,-2196.3335 1149.0681,-2063.1071 1194.847,-1969.875 1261.5355,-1988.604 1317.5017,-1901.1071 1343.8579,-1859.9022 1329.9788,-1839.9926 1353.5017,-1797.1071 1408.0454,-1697.6662 1466.0732,-1700.81 1511.9993,-1597.1071 1551.7638,-1507.3171 1507.7538,-1468.6825 1547.9993,-1379.1071 1594.882,-1274.7591 1666.0914,-1284.7332 1710.019,-1179.1071 1738.6851,-1110.1782 1699.57,-903.5487 1746.019,-845.1071 1786.3875,-794.316 1826.8828,-828.1006 1883.8806,-797.1071 1901.688,-787.424 1900.708,-775.6854 1919.8806,-769.1071 2234.2948,-661.2292 3109.0305,-818.579 3169.983,-895.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge640" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M902.2511,-3694.8338C904.0342,-3603.2057 919.011,-2979.738 998.9033,-2813.1071 1029.9039,-2748.4494 1080.5068,-2762.993 1113.0681,-2699.1071 1159.6536,-2607.7056 1078.9333,-2545.9774 1149.0681,-2471.1071 1201.532,-2415.1009 1254.4505,-2476.853 1317.5017,-2433.1071 1341.5053,-2416.453 1328.7417,-2393.6143 1353.5017,-2378.1071 1782.2408,-2109.5876 2100.7357,-2213.8285 2478.6731,-2550.1071 2517.0546,-2584.258 2670.085,-2914.451 2686.5776,-2963.1071 2714.1685,-3044.5049 2683.0123,-3076.8087 2722.5776,-3153.1071 2769.0094,-3242.647 2842.428,-3222.6978 2880.4805,-3316.1071 2925.6432,-3426.9704 2904.1781,-11816.0316 2916.4805,-11935.1071 2928.6745,-12053.1335 2964.0053,-12191.438 2977.9776,-12243.1797"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2974.6119,-12244.1412 2980.619,-12252.8685 2981.3655,-12242.3 2974.6119,-12244.1412"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge688" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1055.9857,-2685.1071C1073.7391,-2621.1522 1097.3046,-2611.5813 1113.0681,-2547.1071 1134.8426,-2458.0473 1106.5401,-2217.3299 1149.0681,-2136.1071 1194.2213,-2049.8707 1252.0026,-2068.1168 1317.5017,-1996.1071 1420.6884,-1882.6637 1455.6313,-1853.7239 1511.9993,-1711.1071 1550.3536,-1614.0667 1504.0013,-1573.7225 1547.9993,-1479.1071 1594.2263,-1379.6983 1665.7058,-1393.3836 1710.019,-1293.1071 1738.0512,-1229.6731 1700.0455,-1035.0312 1746.019,-983.1071 1848.763,-867.0643 1937.3927,-933.7836 2092.2107,-941.1071 2176.8643,-945.1116 2198.4065,-945.4234 2282.0427,-959.1071 2384.0686,-975.7996 3111.0005,-1152.2013 3169.983,-1237.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M3169.983,-1237.1071C3246.3232,-1330.8167 3233.314,-1376.8389 3252.9207,-1496.1071 3293.5695,-1743.3757 3284.3126,-3500.562 3288.9207,-3751.1071 3319.9964,-5440.7386 3367.0993,-7528.557 3372.3622,-7760.8248"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3368.8669,-7761.0728 3372.5927,-7770.9908 3375.8651,-7760.914 3368.8669,-7761.0728"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M903.1385,-3694.9563C909.156,-3633.2943 938.9466,-3327.8035 962.9033,-3078.1071 970.9832,-2993.8925 943.5975,-2763.1278 998.9033,-2699.1071 1015.9798,-2679.3398 1049.0364,-2710.2876 1055.9857,-2685.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge708" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M905.384,-3717.2568C916.9075,-3755.4363 956.668,-3884.2394 998.9033,-3987.1071 1043.462,-4095.6336 1081.5646,-4112.0982 1113.0681,-4225.1071 1135.3704,-4305.1095 1096.2434,-4533.0186 1149.0681,-4597.1071 1151.7206,-4600.3252 1154.7673,-4603.141 1158.0937,-4605.6039"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1156.5258,-4608.7493 1166.873,-4611.0266 1160.2044,-4602.7937 1156.5258,-4608.7493"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1131.7261,-3399.1073 1092.693,-3619.8532 1113.0681,-3731.1071 1134.3214,-3847.1558 1094.7683,-3889.3667 1149.0681,-3994.1071 1196.1687,-4084.9608 1274.0567,-4058.4497 1317.5017,-4151.1071 1377.7863,-4279.6789 1296.193,-4659.1815 1353.5017,-4789.1071 1394.1531,-4881.2686 1470.2368,-4859.4438 1511.9993,-4951.1071 1553.2247,-5041.5918 1526.2571,-5300.0798 1547.9993,-5397.1071 1564.5818,-5471.1092 1601.2159,-5553.7791 1618.9715,-5591.425"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1615.9815,-5593.2862 1623.4465,-5600.8045 1622.2993,-5590.2719 1615.9815,-5593.2862"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge464" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-2685.1071C1091.6472,-2558.9082 1090.1593,-2522.2721 1149.0681,-2405.1071 1220.232,-2263.5677 1223.4894,-2203.6305 1353.5017,-2113.1071 1633.4089,-1918.2166 2634.1443,-1722.2071 2880.4805,-1958.1071 2938.3882,-2013.5615 2867.0658,-2253.9669 2916.4805,-2317.1071 2936.0477,-2342.1093 2970.9802,-2312.0453 2983.7629,-2341.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-2341.1071C3112.5174,-2626.7219 3164.4944,-5038.2274 3169.5668,-5289.0438"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3166.0678,-5289.1339 3169.7675,-5299.0617 3173.0664,-5288.9936 3166.0678,-5289.1339"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-3027.1071C1306.8181,-2965.9075 2015.5309,-3029.8994 2092.2107,-3087.1071 2120.5683,-3108.2636 2107.5893,-3129.358 2128.2107,-3158.1071 2185.1498,-3237.4879 2223.1787,-3237.143 2282.0427,-3315.1071 2344.9311,-3398.4014 2370.8248,-3418.4353 2398.3579,-3519.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1233.2849,-2419.1071C1257.6055,-2388.7217 1289.2265,-2421.8517 1317.5017,-2395.1071 1353.037,-2361.4955 1327.3058,-2332.4141 1353.5017,-2291.1071 1418.2209,-2189.0544 1436.0852,-2146.6984 1547.9993,-2101.1071 1704.3914,-2037.3964 1992.1718,-2051.3892 2282.0427,-2173.1071 2594.8782,-2304.4679 2731.073,-2342.4776 2880.4805,-2647.1071 2920.3219,-2728.3406 2913.1665,-5813.6901 2916.4805,-5904.1071 2932.1312,-6331.1172 2973.0837,-6851.8951 2982.0232,-6962.7395"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2978.5538,-6963.2602 2982.8494,-6972.9451 2985.5309,-6962.6952 2978.5538,-6963.2602"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1055.9857,-2685.1071C1069.902,-2635.86 1093.9203,-2632.5655 1113.0681,-2585.1071 1137.4288,-2524.7285 1103.7101,-2489.8154 1149.0681,-2443.1071 1176.1821,-2415.186 1207.1989,-2447.991 1233.2849,-2419.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M923.6421,-3717.1768C956.4164,-3734.9708 1018.8271,-3772.8819 1055.9857,-3821.1071"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1055.9857,-3821.1071C1078.8471,-3850.777 1096.4457,-3849.5417 1113.0681,-3883.1071 1153.7323,-3965.2197 1103.1682,-4006.8023 1149.0681,-4086.1071 1197.9722,-4170.6023 1274.0878,-4139.6642 1317.5017,-4227.1071 1391.8998,-4376.9572 1310.8722,-4817.3268 1353.5017,-4979.1071 1393.3345,-5130.2738 1467.8028,-5143.1581 1511.9993,-5293.1071 1533.4171,-5365.7734 1497.8695,-5575.3082 1547.9993,-5632.1071 1572.4706,-5659.834 1592.2968,-5655.5604 1629.0092,-5651.1071"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1629.0092,-5651.1071C1665.7921,-5647.2805 1683.7415,-5658.1285 1710.019,-5632.1071 1757.8143,-5584.7778 1701.0866,-5535.1623 1746.019,-5485.1071 1749.1162,-5481.6568 1752.7274,-5478.6823 1756.6436,-5476.1179"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1758.5781,-5479.0472 1765.6229,-5471.1339 1755.1809,-5472.9268 1758.5781,-5479.0472"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge419" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M905.0393,-3695.0928C925.2677,-3620.2622 1043.4061,-3178.5017 1113.0681,-2813.1071 1133.844,-2704.1322 1084.0323,-2655.9821 1149.0681,-2566.1071 1163.5876,-2546.0422 1523.8919,-2372.7862 1547.9993,-2367.1071 1618.0895,-2350.5956 1638.3852,-2359.7686 1710.019,-2367.1071 1788.5191,-2375.149 1807.9775,-2381.528 1883.8806,-2403.1071 1978.6837,-2430.0594 2003.7425,-2435.6624 2092.2107,-2479.1071 2095.0596,-2480.5061 2476.3616,-2720.9321 2478.6731,-2723.1071 2498.6159,-2741.8717 2497.4606,-2751.8102 2514.6731,-2773.1071 2586.2548,-2861.6746 2644.7435,-2857.1919 2686.5776,-2963.1071 2730.0548,-3073.1821 2715.1017,-4974.9932 2722.5776,-5093.1071 2740.07,-5369.4724 2786.1287,-5703.288 2798.457,-5789.8142"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2794.9963,-5790.3383 2799.8785,-5799.7412 2801.9256,-5789.346 2794.9963,-5790.3383"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge451" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1061.7956,-3476.4962 1506.0477,-3916.6234 1511.9993,-3923.1071 1689.3114,-4116.2727 1782.9803,-4139.0913 1883.8806,-4381.1071 1940.9946,-4518.0985 1875.3145,-4571.5356 1919.8806,-4713.1071 1967.681,-4864.9527 2042.0099,-4876.0381 2092.2107,-5027.1071 2128.4433,-5136.1419 2053.8387,-5195.5275 2128.2107,-5283.1071 2151.3904,-5310.4033 2182.9466,-5278.9926 2205.1267,-5307.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2205.1267,-5307.1071C2227.3568,-5333.8119 2252.2828,-5303.1719 2282.0427,-5321.1071 2334.0429,-5352.4456 2371.8268,-5416.2434 2388.6422,-5448.8841"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2385.572,-5450.5698 2393.1801,-5457.9432 2391.8307,-5447.4347 2385.572,-5450.5698"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-3821.1071C1165.2954,-3965.1171 1075.4645,-4051.9709 1149.0681,-4217.1071 1196.3787,-4323.2526 1277.0032,-4308.1804 1317.5017,-4417.1071 1375.6455,-4573.4934 1324.2278,-7255.85 1353.5017,-7420.1071 1390.4853,-7627.6232 1471.5871,-7660.2314 1511.9993,-7867.1071 1580.0657,-8215.5485 1501.5648,-8313.1294 1547.9993,-8665.1071 1565.6006,-8798.5273 1607.4235,-8955.1815 1623.0141,-9011.0298"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1619.6905,-9012.1399 1625.7675,-9020.8186 1626.429,-9010.2444 1619.6905,-9012.1399"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1629.0092,-4889.1071C1660.2475,-4908.0596 1677.2569,-4886.9308 1710.019,-4903.1071 1747.8906,-4921.8062 1781.7985,-4958.5349 1800.265,-4981.0423"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1797.5792,-4983.2877 1806.5625,-4988.9049 1803.0428,-4978.9117 1797.5792,-4983.2877"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1096.2615,-3438.8243 1301.1248,-3896.5319 1317.5017,-3954.1071 1340.6005,-4035.314 1299.6663,-4648.0697 1353.5017,-4713.1071 1399.6927,-4768.9094 1459.0016,-4701.7234 1511.9993,-4751.1071 1550.8719,-4787.329 1510.0947,-4827.8734 1547.9993,-4865.1071 1574.788,-4891.4217 1596.9046,-4869.6291 1629.0092,-4889.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1233.2849,-3483.1071C1368.8239,-3494.9084 2209.2612,-4000.1596 2282.0427,-4115.1071 2345.1647,-4214.7989 2390.2074,-5099.3599 2397.361,-5247.964"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2393.8697,-5248.2312 2397.8426,-5258.0529 2400.8617,-5247.8974 2393.8697,-5248.2312"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1180.9859,-3354.7884 1089.6747,-3261.712 1113.0681,-3084.1071 1121.8076,-3017.7559 1111.5426,-2840.521 1149.0681,-2785.1071 1262.36,-2617.809 1352.2347,-2617.1067 1547.9993,-2567.1071 1751.6845,-2515.0845 2164.3704,-2534.7877 2282.0427,-2629.1071 2320.8648,-2660.2247 2295.4843,-2690.761 2318.0427,-2735.1071 2374.2445,-2845.5902 2420.556,-2853.6194 2478.6731,-2963.1071 2499.8427,-3002.989 2496.9519,-3016.5779 2514.6731,-3058.1071 2584.4189,-3221.555 2646.6481,-3245.9444 2686.5776,-3419.1071 2737.4228,-3639.6074 2696.3248,-7267.3485 2722.5776,-7492.1071 2737.2633,-7617.8357 2779.0129,-7764.5791 2795.0996,-7818.1668"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.7927,-7819.3229 2798.0418,-7827.8786 2798.492,-7817.2933 2791.7927,-7819.3229"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M908.9502,-3694.9041C933.7984,-3654.764 1019.1782,-3518.6393 1055.9857,-3483.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.9157,-3717.2543C909.0648,-3796.9023 946.3674,-4287.8918 962.9033,-4688.1071 978.8601,-5074.3048 948.7611,-6043.846 998.9033,-6427.1071 1044.0375,-6772.0894 1189.7592,-7174.4048 1225.3759,-7269.3151"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1222.1019,-7270.5525 1228.9061,-7278.6737 1228.6514,-7268.0819 1222.1019,-7270.5525"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-3027.1071C1336.8832,-2924.2099 1740.0931,-2909.6988 1883.8806,-2935.1071 1980.9369,-2952.2576 2002.6863,-2969.8828 2092.2107,-3011.1071 2180.1813,-3051.6159 2215.0539,-3048.1622 2282.0427,-3118.1071 2415.4873,-3257.4404 2432.4927,-3317.7876 2478.6731,-3505.1071 2496.6338,-3577.9603 2469.2312,-6146.3978 2514.6731,-6206.1071 2520.1436,-6213.2952 2527.561,-6218.508 2535.7591,-6222.2719"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.6947,-6225.6123 2545.2846,-6225.9338 2537.2066,-6219.0785 2534.6947,-6225.6123"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1191.2149,-3334.7327 1004.107,-3179.9889 1149.0681,-3041.1071 1176.4665,-3014.8578 1204.1208,-3051.3796 1233.2849,-3027.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge508" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.287,-3717.5234C903.9565,-3784.8327 916.4435,-4136.192 998.9033,-4407.1071 1043.2485,-4552.7996 1052.7452,-4597.1466 1149.0681,-4715.1071 1221.5271,-4803.843 1256.4778,-4811.1914 1353.5017,-4872.1071 1409.3786,-4907.189 1848.4127,-5083.4744 1883.8806,-5139.1071 1953.9185,-5248.9639 1887.8082,-6184.8328 1919.8806,-6311.1071 1961.781,-6476.0755 2037.5392,-6491.9202 2092.2107,-6653.1071 2119.8174,-6734.4996 2105.4494,-6760.2289 2128.2107,-6843.1071 2181.1888,-7036.0106 2240.6088,-7070.399 2282.0427,-7266.1071 2306.2637,-7380.5119 2263.3121,-7687.7646 2318.0427,-7791.1071 2328.7077,-7811.2447 2348.9219,-7827.0471 2366.4017,-7837.7887"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2364.8274,-7840.9223 2375.2282,-7842.9407 2368.3562,-7834.8768 2364.8274,-7840.9223"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge611" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1132.5889,-3409.1581 1080.7492,-3094.7712 1149.0681,-3013.1071 1211.6735,-2938.2727 1258.2821,-2954.3873 1353.5017,-2933.1071 1673.92,-2861.4982 1774.2082,-2856.4361 2092.2107,-2938.1071 2188.4624,-2962.827 2431.8078,-3075.4766 2478.6731,-3163.1071 2506.8276,-3215.7515 2510.7546,-4177.5357 2514.6731,-4237.1071 2565.9989,-5017.3845 2646.082,-5207.1928 2686.5776,-5988.1071 2688.8257,-6031.4593 2696.8294,-12204.1572 2722.5776,-12239.1071 2728.4006,-12247.011 2736.734,-12252.4771 2745.8244,-12256.2435"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2744.9034,-12259.6283 2755.4982,-12259.5843 2747.1885,-12253.0117 2744.9034,-12259.6283"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge622" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1055.9857,-3973.1071C1066.6796,-3996.9397 1095.8973,-3967.4217 1113.0681,-3987.1071 1163.5922,-4045.0301 1110.8616,-4264.4137 1149.0681,-4331.1071 1195.2756,-4411.7671 1275.0947,-4372.3858 1317.5017,-4455.1071 1358.0804,-4534.2619 1340.9009,-7569.0541 1353.5017,-7657.1071 1390.5084,-7915.7052 1474.9457,-7964.5157 1511.9993,-8223.1071 1524.2221,-8308.4083 1496.4314,-11256.0676 1547.9993,-11325.1071 1554.6755,-11334.0453 1564.5,-11339.8822 1575.0232,-11343.6708"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1574.2296,-11347.0867 1584.8135,-11346.6044 1576.2389,-11340.3813 1574.2296,-11347.0867"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M909.4552,-3717.144C933.201,-3752.8806 1008.6471,-3869.141 1055.9857,-3973.1071"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge557" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1178.2991,-3348.9041 1184.7102,-3270.0433 1353.5017,-3203.1071 1500.7948,-3144.6963 1555.2556,-3169.1166 1710.019,-3203.1071 1983.5032,-3263.172 2108.6264,-3247.2704 2282.0427,-3467.1071 2332.571,-3531.1609 2283.5123,-3573.1906 2318.0427,-3647.1071 2366.2967,-3750.4004 2440.4145,-3739.7096 2478.6731,-3847.1071 2521.8333,-3968.2641 2507.485,-8348.6931 2514.6731,-8477.1071 2532.6112,-8797.5656 2584.7048,-9185.518 2597.6746,-9279.0792"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.211,-9279.584 2599.0574,-9289.0054 2601.1441,-9278.6181 2594.211,-9279.584"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge592" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1233.2849,-3483.1071C1349.9543,-3486.5162 2195.4329,-3464.8632 2282.0427,-3543.1071 2354.9114,-3608.9373 2277.9858,-3671.4472 2318.0427,-3761.1071 2341.2952,-3813.1533 2376.6875,-3808.3825 2398.3579,-3861.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-3483.1071C1110.9708,-3426.6622 1154.8106,-3475.9543 1233.2849,-3483.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2398.3579,-3861.1071C2451.6852,-3981.4185 2460.2022,-4015.8096 2478.6731,-4146.1071 2519.0186,-4430.7131 2501.3177,-9032.9661 2514.6731,-9320.1071 2532.9555,-9713.1808 2586.1696,-10191.1489 2598.1922,-10296.0959"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2594.7185,-10296.5256 2599.3387,-10306.0599 2601.6726,-10295.7254 2594.7185,-10296.5256"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge547" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.6924,-3717.3619C908.2997,-3814.4841 949.8972,-4512.2956 998.9033,-4716.1071 1041.3582,-4892.6723 1037.9207,-4952.4968 1149.0681,-5096.1071 1217.8821,-5185.0196 1246.5993,-5210.2835 1353.5017,-5245.1071 1428.8318,-5269.646 1642.74,-5286.9437 1710.019,-5245.1071 1740.7391,-5226.0042 1715.299,-5191.21 1746.019,-5172.1071 1798.0513,-5139.7515 1840.358,-5128.9792 1883.8806,-5172.1071 1922.8611,-5210.734 1915.6886,-9068.3902 1919.8806,-9123.1071 1937.2073,-9349.2668 1987.2074,-9620.2153 2001.924,-9696.9433"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1998.4997,-9697.6705 2003.8312,-9706.8261 2005.3729,-9696.3441 1998.4997,-9697.6705"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge659" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-2419.1071C1259.3709,-2390.2232 1287.1053,-2419.4139 1317.5017,-2395.1071 1343.5974,-2374.2394 1330.2417,-2353.095 1353.5017,-2329.1071 1423.2524,-2257.1737 1451.3013,-2241.3573 1547.9993,-2215.1071 1958.7859,-2103.5925 2129.3694,-2197.8621 2478.6731,-2441.1071 2601.8074,-2526.8543 2630.8929,-2567.7735 2686.5776,-2707.1071 2747.8929,-2860.5294 2643.2158,-2932.1945 2722.5776,-3077.1071 2765.4391,-3155.3709 2841.1506,-3121.0103 2880.4805,-3201.1071 2936.9607,-3316.1312 2842.9225,-7709.1795 2916.4805,-7814.1071 2919.3686,-7818.2268 2923.0192,-7821.669 2927.1201,-7824.5447"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2925.6557,-7827.7399 2936.07,-7829.6877 2929.1435,-7821.6706 2925.6557,-7827.7399"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge813" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1234.8424,-12613.376C1242.8273,-12669.6026 1281.6157,-12924.9299 1353.5017,-13122.1071 1525.6807,-13594.3793 1542.3146,-13769.2479 1919.8806,-14101.1071 2184.3479,-14333.5589 3022.2499,-14700.5536 3372.8452,-14733.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3372.8452,-14733.1071C3482.7007,-14738.778 3535.9575,-14781.0372 3619.1829,-14709.1071 3755.6608,-14591.1518 3612.2505,-14462.2275 3716.6309,-14315.1071"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1234.1618,-12590.9938C1241.7376,-12494.448 1296.354,-11787.6991 1317.5017,-11213.1071 1323.152,-11059.5869 1319.6185,-8597.948 1353.5017,-8448.1071 1366.7767,-8389.4015 1401.59,-8326.7029 1420.3499,-8295.7412"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1423.3519,-8297.5411 1425.615,-8287.1908 1417.3913,-8293.8708 1423.3519,-8297.5411"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge763" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1235.7799,-12613.2989C1246.355,-12659.7595 1289.8773,-12841.4766 1353.5017,-12980.1071 1409.4779,-13102.0729 1459.5794,-13113.5711 1511.9993,-13237.1071 1537.2632,-13296.6457 1515.1916,-13322.3687 1547.9993,-13378.1071 1943.7245,-14050.4228 2398.4384,-13933.6696 3169.983,-14049.1071"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge728" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1238.0629,-12613.117C1253.3792,-12648.1096 1303.1967,-12759.6209 1353.5017,-12847.1071 1416.8515,-12957.2798 1463.2671,-12967.7343 1511.9993,-13085.1071 1542.9489,-13159.6503 1503.709,-13195.6316 1547.9993,-13263.1071 1860.1037,-13738.5929 2157.4669,-13706.719 2722.5776,-13771.1071 2961.9358,-13798.3793 3093.4641,-13839.6886 3252.9207,-13659.1071 3266.9286,-13643.2434 3502.446,-13014.3085 3548.2811,-12891.7035"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3551.5726,-12892.8939 3551.7952,-12882.3014 3545.0156,-12890.4431 3551.5726,-12892.8939"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M1234.7392,-12591.0435C1247.6549,-12492.891 1342.5,-11774.3192 1353.5017,-11755.1071 1364.8815,-11735.2348 1385.2051,-11719.2718 1402.4212,-11708.3863"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1404.3235,-11711.3263 1411.077,-11703.1629 1400.7068,-11705.333 1404.3235,-11711.3263"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge637" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1239.6263,-12613.2021C1256.0961,-12641.4713 1302.5113,-12717.7376 1353.5017,-12771.1071 1415.2875,-12835.7756 1467.4637,-12817.5437 1511.9993,-12895.1071 1570.9648,-12997.8017 1471.6044,-13068.6254 1547.9993,-13159.1071 1877.054,-13548.8381 2190.3658,-13421.1795 2686.5776,-13303.1071 2776.6257,-13281.6804 2824.3124,-13300.6796 2880.4805,-13227.1071 2939.719,-13149.5127 2976.4747,-12420.2183 2982.7892,-12285.4632"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2986.2969,-12285.3779 2983.2636,-12275.2265 2979.3044,-12285.0538 2986.2969,-12285.3779"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1240.5648,-12590.9744C1275.3392,-12537.3759 1426.3782,-12299.7694 1511.9993,-12087.1071 1635.4708,-11780.4334 1662.7336,-11697.3044 1710.019,-11370.1071 1775.0922,-10919.8257 1676.8567,-9772.7786 1746.019,-9323.1071 1778.8527,-9109.633 1851.4945,-9070.6496 1883.8806,-8857.1071 1906.2746,-8709.4489 1877.7797,-6312.3969 1919.8806,-6169.1071 1960.6475,-6030.3578 2051.3103,-6031.8171 2092.2107,-5893.1071 2129.1393,-5767.8672 2114.9806,-3673.006 2128.2107,-3543.1071 2143.3663,-3394.3027 2185.0387,-3218.5388 2199.8319,-3159.0072"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2203.2345,-3159.8274 2202.2688,-3149.2766 2196.4442,-3158.1267 2203.2345,-3159.8274"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-12529.1071C1467.5575,-12517.1566 1484.1203,-12529.1302 1511.9993,-12505.1071 1540.3132,-12480.7092 1527.6973,-12460.4881 1547.9993,-12429.1071 1608.281,-12335.9286 1664.4185,-12340.2838 1710.019,-12239.1071 1756.8683,-12135.1598 1720.8634,-12096.3145 1746.019,-11985.1071 1859.3791,-11483.9673 1988.54,-11385.3407 2092.2107,-10882.1071 2108.0315,-10805.3106 2076.7797,-10590.292 2128.2107,-10531.1071 2174.4045,-10477.9489 2238.031,-10548.0856 2282.0427,-10493.1071 2340.1761,-10420.4882 2267.4399,-8897.1606 2318.0427,-8819.1071 2361.0065,-8752.8367 2432.8839,-8807.4577 2478.6731,-8743.1071 2521.6976,-8682.6418 2495.5489,-8482.8108 2514.6731,-8411.1071 2532.6258,-8343.7956 2570.3863,-8269.947 2589.3106,-8235.2424"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.5592,-8236.5996 2594.327,-8226.1533 2586.4307,-8233.2171 2592.5592,-8236.5996"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1244.7764,-12613.2426C1265.3016,-12632.7097 1310.1827,-12673.396 1353.5017,-12700.1071 1419.2037,-12740.6197 1464.9886,-12709.886 1511.9993,-12771.1071 1573.1433,-12850.7338 1489.371,-12912.6102 1547.9993,-12994.1071 1606.0518,-13074.8037 1652.8045,-13063.5659 1746.019,-13098.1071 2139.0219,-13243.7365 2309.6891,-13213.4488 2686.5776,-13030.1071 2747.9984,-13000.2283 2765.8692,-12986.3619 2801.5291,-12928.1071"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge420" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1432.7505,-12529.1071C1557.1139,-12480.0094 1495.4372,-12763.0539 1629.0092,-12757.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1629.0092,-12757.1071C1666.5232,-12755.4369 1683.7046,-12759.896 1710.019,-12733.1071 1752.0312,-12690.3374 1725.3021,-12659.3661 1746.019,-12603.1071 1872.0479,-12260.8631 1960.0888,-12199.0454 2092.2107,-11859.1071 2111.4589,-11809.5832 2102.9322,-11791.8416 2128.2107,-11745.1071 2179.5749,-11650.1457 2223.8484,-11648.0432 2282.0427,-11557.1071 2301.7571,-11526.3009 2292.0408,-11508.8283 2318.0427,-11483.1071 2374.1914,-11427.5645 2433.8292,-11472.12 2478.6731,-11407.1071 2536.3889,-11323.4331 2459.6185,-11036.5555 2514.6731,-10951.1071 2561.9522,-10877.7268 2641.9384,-10931.1226 2686.5776,-10856.1071 2720.0737,-10799.8175 2714.6337,-6205.1255 2722.5776,-6140.1071 2737.0763,-6021.4405 2778.4226,-5883.5137 2794.7643,-5831.9538"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2798.1391,-5832.8913 2797.8533,-5822.3004 2791.4721,-5830.758 2798.1391,-5832.8913"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1629.0092,-12757.1071C1666.3481,-12753.1203 1678.801,-12753.9765 1710.019,-12733.1071 2161.5383,-12431.2645 2202.2251,-12250.6059 2478.6731,-11783.1071 2540.8642,-11677.9362 2662.4035,-11393.8747 2686.5776,-11274.1071 2705.3197,-11181.2522 2666.2087,-7940.2375 2722.5776,-7864.1071 2731.3899,-7852.2055 2745.8917,-7845.8339 2760.0783,-7842.4691"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.1054,-7845.836 2770.2667,-7840.5143 2759.7863,-7838.9614 2761.1054,-7845.836"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1273.8326,-12591.0149C1287.7765,-12586.9513 1303.4188,-12582.1142 1317.5017,-12577.1071 1369.7823,-12558.5191 1379.647,-12545.1941 1432.7505,-12529.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-12529.1071C1467.9713,-12518.4374 1488.0606,-12533.0585 1511.9993,-12505.1071 1586.738,-12417.8403 1472.9972,-12336.1478 1547.9993,-12249.1071 1597.0242,-12192.2131 1663.6546,-12260.1894 1710.019,-12201.1071 1761.524,-12135.4742 1729.9455,-11532.9734 1746.019,-11451.1071 1781.4385,-11270.7072 1838.0903,-11239.1575 1883.8806,-11061.1071 1908.3397,-10966.0008 1903.8087,-10939.9841 1919.8806,-10843.1071 1996.1305,-10383.4948 2021.5939,-10269.6185 2092.2107,-9809.1071 2100.9517,-9752.1047 2091.1542,-9596.2942 2128.2107,-9552.1071 2132.0833,-9547.4893 2136.8195,-9543.7172 2142.0209,-9540.637"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2143.7618,-9543.6798 2151.1432,-9536.0794 2140.6332,-9537.4178 2143.7618,-9543.6798"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge558" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-12529.1071C1558.1241,-12491.1268 1618.9392,-12523.264 1710.019,-12429.1071 1744.0266,-12393.9506 1728.6186,-12370.8206 1746.019,-12325.1071 1817.5966,-12137.062 1836.9699,-12090.4378 1919.8806,-11907.1071 1991.6571,-11748.396 2021.0976,-11714.1165 2092.2107,-11555.1071 2201.0999,-11311.6299 2182.9235,-11229.0654 2318.0427,-10999.1071 2375.7996,-10900.8112 2437.0077,-10905.2294 2478.6731,-10799.1071 2519.5467,-10695.0014 2505.8697,-10408.6021 2514.6731,-10297.1071 2545.6465,-9904.8294 2589.0948,-9426.2488 2598.6979,-9321.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2602.1851,-9321.4486 2599.6106,-9311.1713 2595.2142,-9320.8109 2602.1851,-9321.4486"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge814" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-2799.1071C1285.4159,-2619.1702 1285.7714,-2569.7712 1353.5017,-2395.1071 1425.2609,-2210.0534 1449.8921,-2165.6447 1547.9993,-1993.1071 1773.001,-1597.4047 1800.6479,-1465.1906 2128.2107,-1149.1071 2261.9291,-1020.0748 2323.2136,-1022.9024 2478.6731,-921.1071 2718.5412,-764.0408 3269.2638,-209.5415 3555.9763,-211.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1056.7935,-6270.0794C1062.6042,-6190.2563 1098.2214,-5692.6096 1113.0681,-5287.1071 1122.314,-5034.578 1100.0105,-3260.9978 1149.0681,-3013.1071 1168.9109,-2912.8406 1208.8185,-2898.3467 1233.2849,-2799.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1233.2849,-6831.1071C1245.7595,-6867.9737 1293.6553,-6824.3483 1317.5017,-6855.1071 1412.5708,-6977.7339 1260.1563,-8127.1632 1353.5017,-8251.1071 1357.7586,-8256.7593 1363.2932,-8261.1634 1369.4598,-8264.5901"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1368.3259,-8267.9219 1378.8715,-8268.9429 1371.2644,-8261.5685 1368.3259,-8267.9219"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1062.9039,-6292.3433C1075.1398,-6312.7767 1100.4913,-6357.7379 1113.0681,-6399.1071 1146.4883,-6509.0365 1115.8821,-6545.1068 1149.0681,-6655.1071 1174.1145,-6738.1274 1205.4906,-6748.9659 1233.2849,-6831.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge764" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1233.2849,-2799.1071C1262.7032,-2709.0626 1299.7512,-2701.1092 1353.5017,-2623.1071 1423.5283,-2521.4853 1453.484,-2503.7656 1511.9993,-2395.1071 1532.426,-2357.1762 1527.9092,-2343.2173 1547.9993,-2305.1071 1764.2169,-1894.9491 1758.4716,-1717.8795 2128.2107,-1438.1071 2258.8266,-1339.2733 2332.7831,-1398.5701 2478.6731,-1324.1071 2776.5881,-1172.0498 2795.4538,-1044.964 3087.0454,-881.1071 3206.9969,-813.7016 3259.8944,-840.6817 3372.8452,-762.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1057.16,-6292.4383C1063.8898,-6357.8517 1097.7968,-6693.8643 1113.0681,-6969.1071 1117.0152,-7040.248 1105.6568,-8194.6088 1149.0681,-8251.1071 1151.4377,-8254.191 1154.1708,-8256.9086 1157.1715,-8259.3023"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1155.3991,-8262.326 1165.6737,-8264.9109 1159.2536,-8256.4828 1155.3991,-8262.326"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge730" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1056.7768,-6270.0787C1062.4706,-6190.2513 1097.4166,-5692.5793 1113.0681,-5287.1071 1120.8612,-5085.2179 1109.4518,-3667.2246 1149.0681,-3469.1071 1189.1516,-3268.6533 1264.8099,-3238.6216 1317.5017,-3041.1071 1345.7569,-2935.1928 1306.5486,-2896.1607 1353.5017,-2797.1071 1398.3084,-2702.5816 1447.4937,-2705.4584 1511.9993,-2623.1071 1712.8807,-2366.6509 1697.4698,-2252.1335 1919.8806,-2014.1071 2070.9872,-1852.3912 2461.5987,-1649.3679 2880.4805,-1356.1071 2964.8681,-1297.027 3185.5214,-1158.0114 3252.9207,-1080.1071 3326.5491,-995.0028 3283.7342,-788.3822 3372.8452,-857.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-6601.1071C1666.3096,-6596.7748 1680.7381,-6600.6171 1710.019,-6577.1071 1735.7696,-6556.4317 1725.4591,-6537.95 1746.019,-6512.1071 1759.422,-6495.2602 1777.6357,-6479.0931 1791.9747,-6467.4941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1794.2322,-6470.171 1799.9038,-6461.2221 1789.8895,-6464.6809 1794.2322,-6470.171"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-6411.1071C1464.9203,-6428.9803 1485.472,-6409.5993 1511.9993,-6435.1071 1547.257,-6469.0097 1519.3646,-6499.4517 1547.9993,-6539.1071 1574.5416,-6575.8648 1583.9729,-6606.3379 1629.0092,-6601.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1058.6609,-6269.9052C1080.8035,-6176.822 1234.9852,-5521.6165 1317.5017,-4982.1071 1329.0556,-4906.5657 1307.809,-4701.3621 1353.5017,-4640.1071 1459.7931,-4497.6146 1960.0574,-4452.0083 2092.2107,-4333.1071 2117.05,-4310.7586 2102.3762,-4288.2972 2128.2107,-4267.1071 2155.8987,-4244.3967 2175.9006,-4263.8005 2205.1267,-4243.1071"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2205.1267,-4243.1071C2248.363,-4213.2479 2304.8733,-4192.4564 2345.6011,-4180.0709"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2346.7482,-4183.3813 2355.3373,-4177.1783 2344.7546,-4176.6712 2346.7482,-4183.3813"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge494" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1056.7467,-6270.0775C1062.2282,-6190.2415 1095.9568,-5692.5204 1113.0681,-5287.1071 1119.3162,-5139.0738 1117.7797,-4098.9309 1149.0681,-3954.1071 1189.8025,-3765.5612 1269.7079,-3740.9884 1317.5017,-3554.1071 1356.3566,-3402.1785 1314.8864,-3355.0968 1353.5017,-3203.1071 1408.7651,-2985.5906 1435.2658,-2931.1655 1547.9993,-2737.1071 1760.0473,-2372.0894 1815.0773,-2268.2146 2128.2107,-1985.1071 2420.2939,-1721.0313 2610.1212,-1803.3841 2880.4805,-1517.1071 2903.4222,-1492.8147 2887.7485,-1468.1634 2916.4805,-1451.1071 3346.6561,-1195.7406 3182.6062,-1752.1129 3252.9207,-2137.1071 3311.777,-2459.3645 3364.0692,-3542.8792 3371.8493,-3709.517"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3368.3716,-3710.0806 3372.3321,-3719.9074 3375.3641,-3709.7557 3368.3716,-3710.0806"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge638" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1432.7505,-6411.1071C1487.3903,-6439.7534 1653.3456,-6449.4841 1710.019,-6425.1071 1731.3904,-6415.9146 1727.0105,-6400.5202 1746.019,-6387.1071 1800.7638,-6348.4773 1841.2412,-6377.7901 1883.8806,-6326.1071 1929.439,-6270.886 1864.6449,-6214.6478 1919.8806,-6169.1071 2012.6695,-6092.6045 2655.3057,-6146.4532 2686.5776,-6178.1071 2737.9014,-6230.0578 2705.3163,-7421.149 2722.5776,-7492.1071 2760.7251,-7648.9243 2843.7965,-7661.9411 2880.4805,-7819.1071 2932.4582,-8041.7969 2892.4601,-11707.6968 2916.4805,-11935.1071 2928.9441,-12053.1053 2964.1159,-12191.4265 2978.0116,-12243.1762"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2974.6439,-12244.1304 2980.6381,-12252.8665 2981.4001,-12242.2991 2974.6439,-12244.1304"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge689" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2983.7629,-2303.1071C3061.8238,-2259.5479 3132.0829,-2146.1474 3169.983,-2227.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1058.622,-6269.895C1068.3738,-6229.0677 1104.1713,-6084.7825 1149.0681,-5971.1071 1224.1583,-5780.9846 1260.7015,-5741.2423 1353.5017,-5559.1071 1600.0963,-5075.1259 1533.9296,-4858.3224 1919.8806,-4476.1071 1980.9863,-4415.5929 2016.6933,-4429.2532 2092.2107,-4388.1071 2194.1022,-4332.5909 2210.2416,-4300.0355 2318.0427,-4257.1071 2386.1992,-4229.9659 2432.478,-4276.098 2478.6731,-4219.1071 2531.5819,-4153.8334 2475.5116,-2781.4467 2514.6731,-2707.1071 2558.5797,-2623.7601 2636.0137,-2662.5916 2686.5776,-2583.1071 2732.7093,-2510.59 2666.3525,-2458.1117 2722.5776,-2393.1071 2762.7383,-2346.6754 2930.1542,-2333.0217 2983.7629,-2303.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1057.6148,-6292.1305C1068.5822,-6366.174 1131.736,-6789.8285 1149.0681,-6845.1071 1167.7983,-6904.8445 1203.1002,-6970.1314 1221.4832,-7002.1418"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1218.5588,-7004.0756 1226.608,-7010.9647 1224.6118,-7000.5597 1218.5588,-7004.0756"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1233.2849,-6261.1071C1272.0311,-6257.4337 1289.1458,-6258.4482 1317.5017,-6285.1071 1352.5271,-6318.0363 1318.7483,-6353.891 1353.5017,-6387.1071 1380.106,-6412.5345 1400.059,-6394.207 1432.7505,-6411.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1432.7505,-6411.1071C1453.1446,-6421.65 1794.0494,-6378.3569 1883.8806,-6273.1071 1958.4713,-6185.7137 1833.1634,-6092.4829 1919.8806,-6017.1071 1977.6868,-5966.8612 2015.6792,-6014.0859 2092.2107,-6017.1071 2356.9922,-6027.5597 2439.6742,-5967.8929 2686.5776,-6064.1071 2716.8063,-6075.8867 2779.698,-6130.1084 2801.5291,-6154.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2801.5291,-6154.1071C2858.6778,-6217.0727 2960.6956,-6839.8154 2980.413,-6962.9999"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2976.9835,-6963.7202 2982.0151,-6973.044 2983.8961,-6962.6175 2976.9835,-6963.7202"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-6337.1071C1264.3508,-6371.6788 1295.8517,-6357.9784 1317.5017,-6399.1071 1374.1533,-6506.7284 1306.7244,-7380.8412 1353.5017,-7493.1071 1401.9309,-7609.3374 1448.1196,-7622.4329 1547.9993,-7699.1071 1766.0647,-7866.5084 1853.3738,-7856.9724 2092.2107,-7993.1071 2177.7112,-8041.8415 2205.9535,-8044.6908 2282.0427,-8107.1071 2323.132,-8140.8128 2363.0037,-8189.0959 2383.7008,-8215.6882"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2381.0871,-8218.0308 2389.9588,-8223.8225 2386.6352,-8213.7625 2381.0871,-8218.0308"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1061.9461,-6292.2966C1072.8622,-6313.0224 1096.4662,-6358.9362 1113.0681,-6399.1071 1131.7504,-6444.3118 1126.7174,-6459.5992 1149.0681,-6503.1071 1208.2828,-6618.3741 1276.263,-6618.2566 1317.5017,-6741.1071 1397.4536,-6979.2845 1276.936,-7631.8196 1353.5017,-7871.1071 1392.232,-7992.1491 1471.2886,-7988.7167 1511.9993,-8109.1071 1551.6614,-8226.3969 1530.6048,-8542.5208 1547.9993,-8665.1071 1566.9057,-8798.3486 1607.9307,-8955.112 1623.162,-9011.0095"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1619.8289,-9012.0897 1625.8501,-9020.8073 1626.5795,-9010.2376 1619.8289,-9012.0897"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1233.2849,-6261.1071C1319.614,-6252.9225 1291.5828,-6167.8592 1317.5017,-6085.1071 1347.3778,-5989.7209 1287.6867,-5938.3367 1353.5017,-5863.1071 1401.965,-5807.7113 1446.4165,-5848.5178 1511.9993,-5815.1071 1710.2134,-5714.1282 1738.1109,-5648.1451 1883.8806,-5480.1071 1900.664,-5460.7598 1899.0788,-5450.0499 1919.8806,-5435.1071 1999.9283,-5377.6056 2035.1522,-5391.5753 2128.2107,-5359.1071 2207.7431,-5331.3582 2301.0842,-5300.6763 2354.6167,-5283.2594"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2355.7083,-5286.5849 2364.1368,-5280.1653 2353.5447,-5279.9276 2355.7083,-5286.5849"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1111.8298,-6274.2921C1146.7124,-6270.1631 1192.5787,-6264.9664 1233.2849,-6261.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1233.2849,-6261.1071C1272.0311,-6257.4337 1291.076,-6256.5336 1317.5017,-6285.1071 1372.3038,-6344.3633 1299.1887,-6403.4023 1353.5017,-6463.1071 1378.266,-6490.3298 1410.0974,-6458.104 1432.7505,-6487.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1432.7505,-6487.1071C1479.8712,-6547.4366 1485.9204,-6570.3163 1547.9993,-6615.1071 1762.0827,-6769.5712 1881.1578,-6694.5273 2092.2107,-6853.1071 2197.628,-6932.315 2202.5,-6975.9422 2282.0427,-7081.1071 2497.0036,-7365.3106 2732.3224,-7730.6152 2788.8321,-7819.1443"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2785.9606,-7821.151 2794.2875,-7827.7019 2791.8632,-7817.3881 2785.9606,-7821.151"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1057.8835,-6292.3864C1065.5954,-6338.4999 1095.0317,-6517.2509 1113.0681,-6665.1071 1133.4495,-6832.1863 1113.7693,-6877.5323 1149.0681,-7042.1071 1167.7047,-7128.9971 1206.9693,-7227.7585 1224.5041,-7269.6239"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1221.3503,-7271.1523 1228.4682,-7279 1227.7977,-7268.4264 1221.3503,-7271.1523"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-6306.1071C2455.3509,-6285.6626 2521.0277,-6261.1289 2561.6902,-6245.8245"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2563.0953,-6249.0353 2571.2193,-6242.2345 2560.6275,-6242.4848 2563.0953,-6249.0353"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-6183.1071C2091.4781,-6150.7212 2312.3588,-6336.9567 2398.3579,-6306.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-6411.1071C1464.9203,-6428.9803 1479.3151,-6418.1929 1511.9993,-6435.1071 1530.0013,-6444.4233 1528.8266,-6456.5288 1547.9993,-6463.1071 1616.1105,-6486.4766 1642.9087,-6489.2119 1710.019,-6463.1071 1730.2476,-6455.2385 1727.2061,-6440.9323 1746.019,-6430.1071 1801.6498,-6398.0963 1839.7394,-6433.7013 1883.8806,-6387.1071 1928.6578,-6339.8417 1883.2428,-6298.9279 1919.8806,-6245.1071 1946.4295,-6206.1069 1961.1196,-6197.5123 2006.0457,-6183.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge509" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-6337.1071C1264.3105,-6371.715 1295.8034,-6358.0039 1317.5017,-6399.1071 1423.4889,-6599.8788 1248.4599,-7218.8392 1353.5017,-7420.1071 1394.2581,-7498.1994 1460.3099,-7467.7789 1511.9993,-7539.1071 1541.1945,-7579.3947 1512.1247,-7610.6329 1547.9993,-7645.1071 1672.2773,-7764.5339 1754.2156,-7707.5373 1919.8806,-7755.1071 1996.2993,-7777.0503 2027.8372,-7756.4448 2092.2107,-7803.1071 2115.5649,-7820.0358 2106.3414,-7838.2993 2128.2107,-7857.1071 2156.8275,-7881.7178 2167.424,-7891.3419 2205.1267,-7893.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-7893.1071C2256.2861,-7895.5024 2267.836,-7880.2214 2318.0427,-7870.1071 2322.7597,-7869.1569 2327.6332,-7868.1782 2332.5394,-7867.1953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2333.4972,-7870.5731 2342.6163,-7865.1795 2332.124,-7863.7091 2333.4972,-7870.5731"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge602" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1432.7505,-6487.1071C1492.7841,-6562.6533 1485.5408,-6597.553 1547.9993,-6671.1071 1676.7911,-6822.7786 1740.8443,-6828.788 1883.8806,-6967.1071 1980.9155,-7060.9418 1999.6953,-7089.8135 2092.2107,-7188.1071 2176.6497,-7277.8198 2207.2217,-7292.229 2282.0427,-7390.1071 2383.4191,-7522.724 2413.8523,-7556.2804 2478.6731,-7710.1071 2504.123,-7770.5026 2491.8193,-7791.6823 2514.6731,-7853.1071 2573.9958,-8012.5502 2646.5804,-8029.7545 2686.5776,-8195.1071 2712.9894,-8304.2959 2655.8042,-12148.7684 2722.5776,-12239.1071 2728.413,-12247.0018 2736.7522,-12252.4636 2745.8445,-12256.2288"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2744.924,-12259.6137 2755.5188,-12259.5691 2747.2087,-12252.997 2744.924,-12259.6137"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge559" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1097.9812,-6292.1266C1103.0988,-6293.69 1108.2266,-6295.3631 1113.0681,-6297.1071 1129.541,-6303.041 1132.6081,-6307.1375 1149.0681,-6313.1071 1185.6561,-6326.3766 1207.2262,-6308.1986 1233.2849,-6337.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-6337.1071C1271.511,-6379.5137 1285.4757,-6386.8431 1317.5017,-6434.1071 1333.175,-6457.2377 1530.6622,-6859.1959 1547.9993,-6881.1071 1745.584,-7130.8214 1877.3358,-7112.1055 2092.2107,-7347.1071 2111.9991,-7368.7491 2392.5846,-7748.356 2398.3579,-7777.1071"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge590" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1104.7767,-6292.1157C1107.6929,-6293.5772 1110.4864,-6295.2325 1113.0681,-6297.1071 1136.4085,-6314.0549 1127.0687,-6332.4517 1149.0681,-6351.1071 1211.7059,-6404.2237 1271.8873,-6358.8122 1317.5017,-6427.1071 1389.6778,-6535.1707 1294.5548,-7480.2952 1353.5017,-7596.1071 1393.9487,-7675.5725 1467.4869,-7641.8455 1511.9993,-7719.1071 1571.5543,-7822.4787 1509.2882,-7872.2623 1547.9993,-7985.1071 1644.4083,-8266.1443 1778.6857,-8285.2391 1883.8806,-8563.1071 1912.766,-8639.4067 1888.9997,-8667.5931 1919.8806,-8743.1071 2031.227,-9015.386 2123.9852,-9049.0111 2282.0427,-9297.1071 2298.3444,-9322.6952 2301.1931,-9329.8765 2318.0427,-9355.1071 2386.079,-9456.9849 2431.7645,-9465.9364 2478.6731,-9579.1071 2535.0459,-9715.1109 2587.2268,-10189.1286 2598.4192,-10295.7156"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2594.9596,-10296.286 2599.4776,-10305.8692 2601.9218,-10295.5602 2594.9596,-10296.286"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge545" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1107.1041,-6292.228C1109.2454,-6293.6659 1111.2516,-6295.2849 1113.0681,-6297.1071 1155.3943,-6339.566 1118.3727,-6375.6089 1149.0681,-6427.1071 1202.2468,-6516.3257 1275.3056,-6494.1997 1317.5017,-6589.1071 1419.5697,-6818.6782 1251.2666,-7489.6103 1353.5017,-7719.1071 1393.2181,-7808.2622 1470.4811,-7782.7767 1511.9993,-7871.1071 1606.0197,-8071.1369 1462.2982,-8163.3742 1547.9993,-8367.1071 1599.5225,-8489.5906 1652.4642,-8496.7443 1746.019,-8591.1071 1804.0409,-8649.63 1847.0626,-8641.3785 1883.8806,-8715.1071 1924.5446,-8796.5373 1909.3541,-9032.6989 1919.8806,-9123.1071 1946.1131,-9348.4075 1989.8991,-9619.9556 2002.5342,-9696.8844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1999.0876,-9697.4957 2004.1665,-9706.7938 2005.9945,-9696.3578 1999.0876,-9697.4957"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge672" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1069.0777,-6269.9726C1112.1167,-6232.6013 1250.3096,-6106.3719 1317.5017,-5971.1071 1349.9285,-5905.8285 1320.247,-5875.9679 1353.5017,-5811.1071 1412.8937,-5695.2674 1458.3676,-5686.5126 1547.9993,-5592.1071 1584.076,-5554.1089 1861.5708,-5308.5167 1883.8806,-5261.1071 1923.1067,-5177.7496 1858.6441,-4916.9348 1919.8806,-4848.1071 2061.8783,-4688.5067 2732.3059,-4657.2244 2880.4805,-4811.1071 2911.2024,-4843.0125 2910.2451,-5164.2561 2916.4805,-5208.1071 2960.5885,-5518.3034 3018.0131,-5588.5367 3051.0454,-5900.1071 3062.0354,-6003.7676 3039.8191,-7683.1773 3087.0454,-7776.1071 3097.5094,-7796.6976 3118.1796,-7812.4251 3136.2657,-7823.0161"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3134.9765,-7826.3029 3145.4204,-7828.0849 3138.3672,-7820.1789 3134.9765,-7826.3029"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge815" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2801.5291,-14733.1071C3054.339,-14756.8059 3119.1367,-14722.7866 3372.8452,-14733.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M464.1654,-12462.2543C469.9968,-12464.13 475.6856,-12466.3883 480.9653,-12469.1071 657.3972,-12559.9615 704.5993,-12605.0431 805.1968,-12776.1071 827.2022,-12813.5269 987.6048,-13491.1926 998.9033,-13533.1071 1062.6249,-13769.497 989.7991,-13877.1662 1149.0681,-14063.1071 1406.8424,-14364.0492 2407.7918,-14688.558 2801.5291,-14733.1071"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-12453.1071C816.3175,-12455.9148 848.7643,-12496.2159 902.05,-12453.1071"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M902.05,-12415.1071C920.8517,-12392.9316 946.2932,-12414.9684 962.9033,-12391.1071 1017.0953,-12313.2573 980.2388,-10777.1071 998.9033,-10684.1071 1026.1593,-10548.2984 1085.0567,-10529.762 1113.0681,-10394.1071 1163.2907,-10150.8871 1093.727,-9519.2138 1149.0681,-9277.1071 1190.2336,-9097.0161 1273.8894,-9076.6213 1317.5017,-8897.1071 1333.3995,-8831.6694 1309.326,-8342.9336 1353.5017,-8292.1071 1357.7919,-8287.171 1363.1456,-8283.5017 1369.0337,-8280.8016"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1370.4428,-8284.0136 1378.65,-8277.3135 1368.0558,-8277.4332 1370.4428,-8284.0136"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge774" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M464.1745,-12442.161C470.6835,-12438.6425 476.5174,-12434.0608 480.9653,-12428.1071 514.9733,-12382.5862 513.8117,-8393.8412 516.9653,-8337.1071 531.2213,-8080.6446 571.6351,-7770.9922 582.8192,-7688.2649"/>
<polygon fill="#00cbff" stroke="#00cbff" points="586.3184,-7688.5073 584.1976,-7678.1269 579.3822,-7687.5642 586.3184,-7688.5073"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M747.835,-12453.1071C765.4677,-12453.83 890.6399,-12428.5698 902.05,-12415.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M464.0354,-12451.5188C534.0999,-12450.1765 648.9236,-12449.0518 747.835,-12453.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M902.05,-12415.1071C920.8477,-12392.9281 946.3223,-12414.9886 962.9033,-12391.1071 1024.0647,-12303.0169 965.549,-10563.0291 998.9033,-10461.1071 1026.299,-10377.3932 1085.6391,-10382.8101 1113.0681,-10299.1071 1177.125,-10103.6295 1100.6945,-8648.044 1149.0681,-8448.1071 1163.3812,-8388.9485 1200.2884,-8326.4448 1220.1571,-8295.6308"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.1781,-8297.4064 1225.7324,-8287.1241 1217.3235,-8293.5693 1223.1781,-8297.4064"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-12529.1071C928.1743,-12516.3485 946.0027,-12528.7636 962.9033,-12505.1071 1013.9823,-12433.6097 990.9634,-11802.6165 998.9033,-11715.1071 1004.4866,-11653.5719 1117.523,-10666.2358 1149.0681,-10613.1071 1196.5266,-10533.1768 1273.3557,-10570.9135 1317.5017,-10489.1071 1353.012,-10423.3034 1342.6499,-9891.0892 1353.5017,-9817.1071 1370.7556,-9699.4791 1410.6643,-9562.2036 1426.3007,-9510.867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1429.6627,-9511.8416 1429.2521,-9501.2548 1422.971,-9509.787 1429.6627,-9511.8416"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-12453.1071C824.1498,-12456.9435 833.9883,-12563.8385 902.05,-12529.1071"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-12529.1071C927.9465,-12515.8923 945.5215,-12528.4122 962.9033,-12505.1071 1018.2466,-12430.9043 962.7964,-12175.3434 998.9033,-12090.1071 1080.2135,-11898.1611 1159.7242,-11859.9505 1353.5017,-11783.1071 1370.1258,-11776.5147 1423.6457,-11784.4995 1432.7505,-11769.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-11769.1071C1453.6891,-11731.1082 1491.9487,-11750.582 1511.9993,-11712.1071 1580.1718,-11581.2914 1459.608,-9175.2055 1547.9993,-9057.1071 1550.342,-9053.9771 1553.0707,-9051.2274 1556.08,-9048.8129"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1558.2091,-9051.6014 1564.6293,-9043.1733 1554.3546,-9045.7582 1558.2091,-9051.6014"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge816" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.4886,-5261.9008C409.7277,-5187.623 461.9972,-4758.4669 480.9653,-4407.1071 484.9308,-4333.6517 486.6139,-1826.1161 516.9653,-1759.1071 550.9192,-1684.1447 610.0931,-1704.4082 654.4731,-1635.1071 673.2712,-1605.7532 820.2999,-1064.0058 841.1968,-1036.1071 880.1502,-984.1018 921.6459,-1005.3042 962.9033,-955.1071 989.4741,-922.779 973.9657,-901.7111 998.9033,-868.1071 1050.3151,-798.8287 1080.7227,-797.7528 1149.0681,-745.1071 1408.5173,-545.2563 1463.6536,-479.0106 1746.019,-313.1071 1819.5178,-269.923 1837.4432,-253.8098 1919.8806,-232.1071 2176.3192,-164.5965 2249.7029,-195.5597 2514.6731,-185.1071 2591.0157,-182.0955 2610.1797,-184.3136 2686.5776,-185.1071 3028.9406,-188.6628 3115.0171,-180.3661 3456.7698,-201.1071 3501.0036,-203.7917 3511.6787,-209.8583 3555.9763,-211.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3555.9763,-211.1071C3671.3803,-207.2254 3602.8368,-348.8007 3619.1829,-463.1071 3816.533,-1843.1547 3865.408,-6599.2898 3868.8203,-6956.8084"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3865.3211,-6956.9227 3868.9155,-6966.8892 3872.3208,-6956.8565 3865.3211,-6956.9227"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.618,-5284.3071C426.9292,-5306.6354 466.4863,-5359.0377 480.9653,-5411.1071 519.6415,-5550.1944 449.3266,-10480.5683 516.9653,-10608.1071 564.5981,-10697.9229 802.637,-10876.3862 902.05,-10855.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-10855.1071C919.6868,-10849.4441 1002.065,-10762.2798 1038.5351,-10723.0218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1041.3512,-10725.1322 1045.5808,-10715.4183 1036.2167,-10720.3744 1041.3512,-10725.1322"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M407.6462,-5284.1857C424.5894,-5306.7146 462.359,-5360.0693 480.9653,-5411.1071 514.6001,-5503.3685 480.2683,-5538.0204 516.9653,-5629.1071 557.2761,-5729.1634 598.0138,-5737.191 654.4731,-5829.1071 671.9615,-5857.5782 672.7877,-5866.758 690.4731,-5895.1071 737.1705,-5969.9614 774.3988,-5974.4313 805.1968,-6057.1071 862.8723,-6211.9345 771.342,-6277.3797 841.1968,-6427.1071 873.8457,-6497.0871 922.2347,-6485.4625 962.9033,-6551.1071 988.6634,-6592.6873 973.0755,-6613.569 998.9033,-6655.1071 1049.0471,-6735.7518 1067.3524,-6758.7282 1149.0681,-6807.1071 1182.5587,-6826.9349 1220.8103,-6794.2405 1233.2849,-6831.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M408.5773,-5284.3185C426.8172,-5306.6668 466.2551,-5359.1025 480.9653,-5411.1071 549.8066,-5654.4786 488.6606,-7435.7754 516.9653,-7687.1071 550.0108,-7980.5347 619.1934,-8043.9397 654.4731,-8337.1071 716.0472,-8848.7751 667.9605,-8981.2395 690.4731,-9496.1071 707.9889,-9896.6954 739.4753,-10385.4784 746.4445,-10491.9839"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="742.9597,-10492.3314 747.1068,-10502.0808 749.9447,-10491.8731 742.9597,-10492.3314"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M747.835,-6071.1071C776.7329,-6130.9121 788.2567,-6144.8828 805.1968,-6209.1071 838.771,-6336.3963 784.0609,-6384.51 841.1968,-6503.1071 874.7127,-6572.6761 922.4267,-6561.3439 962.9033,-6627.1071 988.9825,-6669.4785 969.6442,-6692.8659 998.9033,-6733.1071 1047.866,-6800.4473 1078.3705,-6801.1311 1149.0681,-6845.1071 1220.4399,-6889.5024 1272.6732,-6860.0067 1317.5017,-6931.1071 1357.9605,-6995.277 1336.2767,-8222.2289 1353.5017,-8296.1071 1367.1682,-8354.7228 1401.8131,-8417.4601 1420.4453,-8448.4512"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1417.4734,-8450.3002 1425.6726,-8457.0102 1423.4473,-8446.6516 1417.4734,-8450.3002"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M408.1583,-5284.4475C425.664,-5307.0219 463.8742,-5359.8357 480.9653,-5411.1071 527.9015,-5551.9106 458.361,-5606.7466 516.9653,-5743.1071 554.2555,-5829.8737 604.9322,-5824.7038 654.4731,-5905.1071 675.9945,-5940.0355 670.5021,-5954.2697 690.4731,-5990.1071 711.9467,-6028.6407 728.6426,-6031.388 747.835,-6071.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge766" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M400.4842,-5261.9006C409.6952,-5187.6212 461.8168,-4758.4571 480.9653,-4407.1071 488.4095,-4270.5174 468.0873,-2072.869 516.9653,-1945.1071 550.2286,-1858.1605 601.3151,-1863.5294 654.4731,-1787.1071 673.553,-1759.6771 672.7877,-1749.4562 690.4731,-1721.1071 737.1705,-1646.2528 765.6418,-1637.9691 805.1968,-1559.1071 828.4489,-1512.7486 819.5228,-1495.2241 841.1968,-1448.1071 897.3604,-1326.0131 925.9519,-1302.976 998.9033,-1190.1071 1063.1649,-1090.6829 1072.4918,-1060.3887 1149.0681,-970.1071 1216.054,-891.1323 1255.2909,-891.8956 1317.5017,-809.1071 1338.281,-781.4545 1333.4721,-768.3075 1353.5017,-740.1071 1426.6023,-637.186 1452.1956,-615.3149 1547.9993,-533.1071 1629.0246,-463.5804 1652.8479,-449.2437 1746.019,-397.1071 1908.2547,-306.3234 1946.3576,-265.7274 2128.2107,-227.1071 2195.089,-212.9041 2213.6813,-226.0357 2282.0427,-227.1071 2594.0333,-231.9966 2671.7341,-249.1071 2983.7629,-249.1071 2983.7629,-249.1071 2983.7629,-249.1071 3169.983,-249.1071 3302.3101,-249.1071 3349.5469,-251.559 3456.7698,-329.1071 3520.9351,-375.5142 3508.4641,-413.7557 3555.9763,-477.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge775" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M408.5607,-5284.3232C426.7716,-5306.6797 466.161,-5359.1293 480.9653,-5411.1071 537.344,-5609.0514 497.6466,-7058.1991 516.9653,-7263.1071 530.8932,-7410.8359 567.7599,-7585.9982 580.9457,-7645.8463"/>
<polygon fill="#00cbff" stroke="#00cbff" points="577.6031,-7646.9391 583.1876,-7655.9426 584.4366,-7645.4217 577.6031,-7646.9391"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge780" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-4317.1071C635.7046,-4265.2142 686.4719,-4354.8694 747.835,-4317.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M747.835,-4317.1071C779.8062,-4297.4323 788.5111,-4288.7352 805.1968,-4255.1071 852.9483,-4158.8697 890.7172,-3816.6738 899.9061,-3727.4881"/>
<polygon fill="#0000ff" stroke="#0000ff" points="903.3948,-3727.7756 900.9268,-3717.4722 896.4309,-3727.0658 903.3948,-3727.7756"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge795" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M585.7192,-5387.1071C696.6412,-5418.3039 741.4179,-5429.1427 805.1968,-5525.1071 859.5524,-5606.8929 779.4946,-5666.7114 841.1968,-5743.1071 877.7317,-5788.3424 926.3684,-5745.8718 962.9033,-5791.1071 1024.6055,-5867.5028 980.8145,-5912.5864 998.9033,-6009.1071 1016.5157,-6103.0855 1041.0644,-6214.5496 1051.258,-6260.1193"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1047.8706,-6261.0093 1053.4748,-6270.0006 1054.7009,-6259.4769 1047.8706,-6261.0093"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M747.835,-6489.1071C758.585,-6514.5662 788.7291,-6490.9138 805.1968,-6513.1071 851.9198,-6576.075 829.4037,-6786.5899 841.1968,-6864.1071 894.3265,-7213.3347 921.49,-7298.4481 998.9033,-7643.1071 1014.1529,-7711.0011 1101.0192,-8200.7738 1149.0681,-8251.1071 1152.295,-8254.4874 1155.9558,-8257.4166 1159.9006,-8259.9543"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1158.4807,-8263.1674 1168.9316,-8264.9077 1161.847,-8257.03 1158.4807,-8263.1674"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M408.5939,-5284.3138C426.8629,-5306.6539 466.3495,-5359.0759 480.9653,-5411.1071 525.3506,-5569.1147 513.4284,-8201.0219 516.9653,-8365.1071 536.63,-9277.3791 578.5781,-10399.7207 584.9114,-10566.8888"/>
<polygon fill="#00ffff" stroke="#00ffff" points="581.4139,-10567.0249 585.2908,-10576.8849 588.4089,-10566.7593 581.4139,-10567.0249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge722" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.4803,-5261.9003C409.6661,-5187.6196 461.6549,-4758.4482 480.9653,-4407.1071 488.0273,-4278.6188 464.4332,-2208.5783 516.9653,-2091.1071 588.1275,-1931.9758 704.2856,-1967.2471 805.1968,-1825.1071 828.4736,-1792.3202 822.9661,-1777.9461 841.1968,-1742.1071 949.2172,-1529.7544 1012.2045,-1495.9511 1113.0681,-1280.1071 1133.2432,-1236.9333 1119.1817,-1216.226 1149.0681,-1179.1071 1204.3906,-1110.3967 1262.1792,-1142.8176 1317.5017,-1074.1071 1347.3881,-1036.9882 1326.5854,-1012.433 1353.5017,-973.1071 1406.0924,-896.27 1445.904,-901.6902 1511.9993,-836.1071 1529.213,-819.0268 1531.4164,-812.8006 1547.9993,-795.1071 1617.634,-720.8086 1656.2369,-719.5753 1710.019,-633.1071 1736.297,-590.8587 1711.6457,-563.0784 1746.019,-527.1071 1803.3414,-467.1199 1838.3463,-474.4846 1919.8806,-459.1071 1995.1449,-444.9121 2015.6198,-458.9128 2092.2107,-459.1071 2611.063,-460.4235 2827.3641,-287.2721 3252.9207,-584.1071 3373.0684,-667.9127 3408.2597,-704.884 3456.7698,-843.1071 3510.7219,-996.8367 3553.7948,-12290.0929 3555.896,-12849.6056"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3552.3971,-12849.9426 3555.9347,-12859.9293 3559.3971,-12849.9163 3552.3971,-12849.9426"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-5273.1071C892.053,-5316.6632 884.5344,-5406.4436 962.9033,-5535.1071 965.7991,-5539.8613 1350.4067,-6230.4801 1353.5017,-6235.1071 1385.0312,-6282.2428 1403.0953,-6286.7703 1432.7505,-6335.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M399.8548,-5261.9742C406.9963,-5159.9161 462.574,-4388.6385 516.9653,-4303.1071 555.6457,-4242.2815 598.6809,-4262.7488 654.4731,-4217.1071 672.4799,-4202.3764 673.7647,-4195.2954 690.4731,-4179.1071 739.4736,-4131.6321 775.3222,-4138.4457 805.1968,-4077.1071 861.3536,-3961.8057 811.4279,-3625.8541 841.1968,-3501.1071 881.3986,-3332.6408 1004.4195,-2880.3638 1149.0681,-2785.1071 1285.0558,-2695.554 1372.6433,-2750.8912 1511.9993,-2835.1071 1743.3033,-2974.8893 1731.1384,-3092.6723 1919.8806,-3286.1071 1980.9423,-3348.6869 2173.0316,-3475.7765 2205.1267,-3557.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M408.2664,-5284.4122C425.9613,-5306.9247 464.4882,-5359.6351 480.9653,-5411.1071 539.0297,-5592.491 443.8615,-5662.2451 516.9653,-5838.1071 535.0906,-5881.7101 569.8719,-5874.6255 585.7192,-5919.1071"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M585.7192,-5919.1071C603.8203,-5969.9147 626.2435,-5973.149 654.4731,-6019.1071 671.9615,-6047.5782 672.7877,-6056.758 690.4731,-6085.1071 737.1705,-6159.9614 774.9319,-6164.2346 805.1968,-6247.1071 870.5288,-6426.0019 754.6838,-6504.4395 841.1968,-6674.1071 873.6487,-6737.7512 918.8705,-6722.8505 962.9033,-6779.1071 984.7102,-6806.9677 975.3464,-6823.7097 998.9033,-6850.1071 1025.5159,-6879.9287 1112.9717,-6931.943 1149.0681,-6949.1071 1219.9416,-6982.8079 1270.8288,-6939.0165 1317.5017,-7002.1071 1392.6874,-7103.7402 1320.6301,-11431.0349 1353.5017,-11553.1071 1366.1009,-11599.8955 1398.324,-11647.4574 1417.5788,-11673.0158"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="1414.9252,-11675.3067 1423.7952,-11681.1011 1420.4746,-11671.04 1414.9252,-11675.3067"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge493" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M3169.983,-895.1071C3195.6931,-933.2784 3231.4225,-916.4145 3252.9207,-957.1071 3321.1495,-1086.2537 3367.6918,-3457.9661 3372.4436,-3709.5528"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3368.9509,-3709.9807 3372.6382,-3719.9131 3375.9497,-3709.8491 3368.9509,-3709.9807"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M400.4759,-5261.9001C409.6334,-5187.6178 461.4725,-4758.4382 480.9653,-4407.1071 487.6478,-4286.6646 466.9345,-2345.8703 516.9653,-2236.1071 588.3957,-2079.3952 698.376,-2112.2005 805.1968,-1977.1071 825.9212,-1950.8975 822.9763,-1939.1153 841.1968,-1911.1071 886.2446,-1841.8605 1676.2878,-775.4009 1746.019,-731.1071 1958.9519,-595.8506 2631.8736,-728.3365 2880.4805,-771.1071 3018.4276,-794.8397 3091.7876,-779.0118 3169.983,-895.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge636" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M902.05,-4702.1071C1022.3979,-4745.4257 1300.919,-4730.4141 1317.5017,-4716.1071 1400.1663,-4644.7869 1270.8371,-4544.4273 1353.5017,-4473.1071 1602.7002,-4258.107 1771.1726,-4452.5848 2092.2107,-4525.1071 2482.391,-4613.2485 2755.3002,-4681.7754 2801.5291,-5079.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge682" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M400.458,-5261.8991C409.5008,-5187.6103 460.7345,-4758.3965 480.9653,-4407.1071 492.0323,-4214.9395 468.0647,-2861.278 516.9653,-2675.1071 558.3641,-2517.4968 601.4664,-2488.6086 690.4731,-2352.1071 735.7393,-2282.6865 762.2231,-2275.9698 805.1968,-2205.1071 825.2044,-2172.1149 818.6888,-2157.4469 841.1968,-2126.1071 884.4308,-2065.9087 916.5533,-2069.9405 962.9033,-2012.1071 982.5905,-1987.5424 981.7969,-1977.534 998.9033,-1951.1071 1228.4889,-1596.4303 1299.1963,-1516.5778 1547.9993,-1175.1071 1634.3721,-1056.5643 1614.8301,-976.6976 1746.019,-911.1071 1884.1557,-842.0429 1941.0215,-909.5888 2092.2107,-941.1071 2122.604,-947.4432 3150.3741,-1213.0366 3169.983,-1237.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge710" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1055.9857,-4702.1071C1104.665,-4696.6841 1104.0435,-4662.3907 1149.0681,-4643.1071 1155.2105,-4640.4764 1161.7518,-4638.127 1168.3695,-4636.0403"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1169.4849,-4639.3604 1178.0824,-4633.1689 1167.5004,-4632.6475 1169.4849,-4639.3604"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M902.05,-4702.1071C965.4261,-4727.8793 987.9905,-4709.682 1055.9857,-4702.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-4393.1071C1106.2987,-4360.9241 1278.8747,-4409.5539 1317.5017,-4455.1071 1355.2452,-4499.6184 1339.6548,-4922.4142 1353.5017,-4979.1071 1415.6895,-5233.7207 1572.6705,-5515.2401 1617.1167,-5591.9064"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1614.343,-5594.0978 1622.4041,-5600.973 1620.3899,-5590.5714 1614.343,-5594.0978"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-5539.1071C669.6851,-5595.889 736.3685,-5526.6953 805.1968,-5601.1071 860.5948,-5660.9991 816.5921,-5703.3214 841.1968,-5781.1071 881.6285,-5908.9285 925.7382,-5928.298 962.9033,-6057.1071 993.2918,-6162.4292 947.2037,-6204.4461 998.9033,-6301.1071 1088.9275,-6469.4223 1236.064,-6416.4738 1317.5017,-6589.1071 1354.8014,-6668.1757 1300.2119,-7305.8012 1353.5017,-7375.1071 1355.8843,-7378.2058 1358.6502,-7380.9286 1361.6917,-7383.3204"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1360.0171,-7386.4059 1370.312,-7388.9092 1363.8252,-7380.5323 1360.0171,-7386.4059"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M405.6402,-5284.2234C432.6472,-5329.7083 536.1848,-5501.0297 585.7192,-5539.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1233.2849,-4469.1071C1268.1276,-4486.4492 1293.6558,-4462.3478 1317.5017,-4493.1071 1365.1032,-4554.5092 1338.8711,-5814.8047 1353.5017,-5891.1071 1367.7448,-5965.3882 1404.5429,-6047.9227 1422.5379,-6085.4804"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1419.5643,-6087.3695 1427.0804,-6094.8367 1425.8614,-6084.3122 1419.5643,-6087.3695"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.9162,-5261.8431C406.5965,-5172.8672 452.887,-4582.5205 516.9653,-4417.1071 536.4483,-4366.8133 548.3016,-4355.9527 585.7192,-4317.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4317.1071C665.6564,-4234.1194 745.8373,-4277.8663 805.1968,-4179.1071 861.7856,-4084.9576 803.4606,-3789.2691 841.1968,-3686.1071 882.1542,-3574.1389 915.2395,-3554.0468 998.9033,-3469.1071 1137.1543,-3328.7479 1166.6019,-3265.4166 1353.5017,-3203.1071 1420.3291,-3180.8279 1447.585,-3174.5928 1511.9993,-3203.1071 1549.3306,-3219.6326 1980.34,-3715.3905 2006.0457,-3747.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1055.9857,-6945.1071C1080.9535,-6956.6838 1089.3161,-6955.2055 1113.0681,-6969.1071 1130.5619,-6979.3458 1131.0405,-6987.8405 1149.0681,-6997.1071 1157.2365,-7001.3058 1166.2219,-7004.9126 1175.1881,-7007.9735"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1174.2789,-7011.3575 1184.8701,-7011.0829 1176.4193,-7004.6927 1174.2789,-7011.3575"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-5919.1071C604.8178,-5969.5482 634.9183,-5968.8412 654.4731,-6019.1071 696.1301,-6126.1869 653.2141,-6166.4188 690.4731,-6275.1071 723.7037,-6372.044 772.8334,-6377.8772 805.1968,-6475.1071 846.7719,-6600.0122 760.6418,-6664.9886 841.1968,-6769.1071 858.9874,-6792.1017 885.6887,-6769.0745 902.05,-6793.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M902.05,-6793.1071C918.9091,-6816.7932 942.786,-6796.1178 962.9033,-6817.1071 996.7489,-6852.4196 965.4544,-6885.4187 998.9033,-6921.1071 1017.7235,-6941.1873 1031.0179,-6933.5304 1055.9857,-6945.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M400.0133,-5261.8424C409.3037,-5149.6752 485.7669,-4236.632 516.9653,-4189.1071 597.8491,-4065.8961 728.1945,-4150.7804 805.1968,-4025.1071 850.6977,-3950.8463 824.9103,-3327.6626 841.1968,-3242.1071 872.3876,-3078.2569 922.0078,-3048.8084 962.9033,-2887.1071 986.766,-2792.7537 929.1412,-2738.969 998.9033,-2671.1071 1112.8215,-2560.2919 1558.2975,-2547.8004 1710.019,-2595.1071 1907.1082,-2656.5594 1963.1322,-2697.9883 2092.2107,-2859.1071 2158.2741,-2941.569 2190.4222,-3067.8295 2201.0158,-3117.2504"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2197.5989,-3118.0107 2203.0548,-3127.0928 2204.4534,-3116.5906 2197.5989,-3118.0107"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1055.9857,-4702.1071C1171.8049,-4689.2044 1235.3031,-4765.7144 1317.5017,-4683.1071 1401.0806,-4599.1127 1270.224,-4235.4001 1353.5017,-4151.1071 1396.6674,-4107.4152 1569.1226,-4115.4738 1629.0092,-4129.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-5273.1071C1309.654,-5245.8827 1384.4215,-5379.6718 1629.0092,-5307.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-6071.1071C775.6133,-6131.4403 789.056,-6144.6773 805.1968,-6209.1071 845.3467,-6369.3755 781.3495,-6425.1062 841.1968,-6579.1071 873.817,-6663.0466 909.885,-6668.313 962.9033,-6741.1071 979.2376,-6763.5341 979.4578,-6772.317 998.9033,-6792.1071 1056.8867,-6851.1178 1076.6809,-6862.0518 1149.0681,-6902.1071 1219.5602,-6941.1137 1271.6627,-6902.8543 1317.5017,-6969.1071 1348.5791,-7014.0244 1349.1329,-8880.6618 1353.5017,-8935.1071 1370.3109,-9144.5881 1415.1401,-9395.5125 1428.7665,-9468.9552"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1425.3347,-9469.645 1430.6103,-9478.8329 1432.2159,-9468.3605 1425.3347,-9469.645"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge458" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.4699,-5261.8998C409.5892,-5187.6153 461.2267,-4758.4245 480.9653,-4407.1071 487.2055,-4296.0421 475.8053,-2508.4523 516.9653,-2405.1071 559.2786,-2298.8663 596.9706,-2280.9462 690.4731,-2215.1071 735.665,-2183.2856 766.1106,-2206.1864 805.1968,-2167.1071 834.499,-2137.81 818.0874,-2115.5003 841.1968,-2081.1071 948.9668,-1920.715 982.265,-1871.6607 1149.0681,-1774.1071 1334.7131,-1665.534 1910.4799,-1442.1022 2092.2107,-1557.1071 2123.7935,-1577.0937 2100.1221,-1608.45 2128.2107,-1633.1071 2260.2351,-1749.0024 2769.4706,-1739.9492 2880.4805,-1876.1071 2926.676,-1932.7677 2883.5061,-2137.8604 2916.4805,-2203.1071 2953.1631,-2275.6912 3016.9178,-2253.2872 3051.0454,-2327.1071 3117.1126,-2470.0139 3164.9246,-5029.6115 3169.6059,-5288.9562"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3166.1068,-5289.0466 3169.786,-5298.9821 3173.1057,-5288.9208 3166.1068,-5289.0466"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4431.1071C755.6306,-4308.2274 871.5097,-4492.7961 1055.9857,-4393.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-4393.1071C1079.9863,-4379.6392 1096.8617,-4391.3504 1113.0681,-4369.1071 1167.579,-4294.2906 1102.9825,-4034.3882 1149.0681,-3954.1071 1194.7003,-3874.6158 1267.3678,-3911.8388 1317.5017,-3835.1071 1361.1727,-3768.2673 1300.5548,-3718.8678 1353.5017,-3659.1071 1631.1065,-3345.7773 1897.3512,-3336.0241 2282.0427,-3501.1071 2301.7151,-3509.5491 2300.4853,-3520.8594 2318.0427,-3533.1071 2384.459,-3579.4378 2436.7702,-3549.8121 2478.6731,-3619.1071 2539.5334,-3719.752 2500.4984,-7736.349 2514.6731,-7853.1071 2530.7292,-7985.3622 2576.7048,-8139.4832 2593.9678,-8194.3909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.6604,-8195.54 2597.0202,-8204.0137 2597.3328,-8193.4234 2590.6604,-8195.54"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M400.2916,-5261.8879C408.2661,-5187.5271 453.863,-4757.9332 480.9653,-4407.1071 486.1095,-4340.5189 482.8624,-3864.5304 516.9653,-3807.1071 553.7726,-3745.1301 617.7569,-3783.1381 654.4731,-3721.1071 690.2431,-3660.6747 680.4579,-3159.6144 690.4731,-3090.1071 732.5196,-2798.2984 717.9049,-2711.9118 841.1968,-2444.1071 889.5161,-2339.1517 1067.4038,-2106.8466 1149.0681,-2025.1071 1214.769,-1959.3457 1265.6107,-1978.2335 1317.5017,-1901.1071 1353.8462,-1847.0877 1302.1172,-1799.0902 1353.5017,-1759.1071 1478.5558,-1661.8006 1554.3347,-1729.6204 1710.019,-1759.1071 2070.6534,-1827.4113 2164.624,-1871.1182 2478.6731,-2061.1071 2680.8096,-2183.3928 2781.2086,-2194.7288 2880.4805,-2409.1071 2921.2773,-2497.2081 2912.9609,-5807.0824 2916.4805,-5904.1071 2931.9705,-6331.1231 2973.0479,-6851.8964 2982.0172,-6962.7397"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2978.5479,-6963.2614 2982.8462,-6972.9452 2985.5249,-6962.6946 2978.5479,-6963.2614"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1233.2849,-4469.1071C1268.1276,-4486.4492 1293.2668,-4462.6534 1317.5017,-4493.1071 1366.2041,-4554.3069 1335.2611,-5120.0504 1353.5017,-5196.1071 1356.5945,-5209.0029 1537.778,-5623.6576 1547.9993,-5632.1071 1576.5026,-5655.6695 1592.2262,-5654.9337 1629.0092,-5651.1071"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M902.05,-4702.1071C1068.7806,-4769.909 1071.7914,-4389.6338 1233.2849,-4469.1071"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M585.7192,-4431.1071C610.9602,-4410.8483 627.052,-4437.9139 654.4731,-4455.1071 786.1593,-4537.6749 759.9585,-4639.1096 902.05,-4702.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge412" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M400.3322,-5261.8909C408.5671,-5187.5496 455.5387,-4758.0586 480.9653,-4407.1071 540.2813,-3588.3991 408.4416,-3342.9893 690.4731,-2572.1071 770.5725,-2353.1699 1140.4039,-1853.652 1353.5017,-1759.1071 1582.7934,-1657.3775 1671.3241,-1818.903 1883.8806,-1952.1071 2279.7781,-2200.2067 2489.0187,-2267.4198 2600.6254,-2721.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge448" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1055.9857,-4393.1071C1079.2761,-4378.4452 1091.0207,-4385.579 1113.0681,-4369.1071 1248.2936,-4268.0785 1200.9725,-4147.4088 1353.5017,-4075.1071 1417.1558,-4044.9339 1451.6501,-4038.772 1511.9993,-4075.1071 1541.2954,-4092.7457 1526.5531,-4116.4717 1547.9993,-4143.1071 1607.1402,-4216.5582 1646.0884,-4210.7847 1710.019,-4280.1071 1800.0473,-4377.728 1837.0728,-4398.8334 1883.8806,-4523.1071 1940.7142,-4673.999 1850.5705,-4738.5237 1919.8806,-4884.1071 1966.2617,-4981.5289 2043.0624,-4959.0517 2092.2107,-5055.1071 2138.9402,-5146.4351 2061.1478,-5205.4732 2128.2107,-5283.1071 2151.6202,-5310.2066 2182.216,-5279.5847 2205.1267,-5307.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-5158.1071C1094.4679,-5148.4919 1299.3216,-4950.3606 1317.5017,-4915.1071 1345.7503,-4860.3295 1307.1788,-4680.7612 1353.5017,-4640.1071 1406.4469,-4593.6412 1443.4588,-4623.8445 1511.9993,-4640.1071 1557,-4650.7844 1859.1774,-4788.007 1883.8806,-4827.1071 1932.2899,-4903.729 1906.8768,-6368.4116 1919.8806,-6458.1071 1970.4394,-6806.8433 2030.4689,-6884.5518 2128.2107,-7223.1071 2193.1722,-7448.1192 2221.6838,-7500.817 2282.0427,-7727.1071 2307.7618,-7823.5299 2375.5241,-8130.9826 2393.7749,-8214.1787"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2390.3653,-8214.9705 2395.9255,-8223.9891 2397.203,-8213.4715 2390.3653,-8214.9705"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-5158.1071C862.0506,-5082.5313 923.3347,-5192.175 1055.9857,-5158.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5615.1071C605.3324,-5639.3515 628.7986,-5611.4074 654.4731,-5629.1071 680.244,-5646.8732 795.0311,-5837.5025 805.1968,-5867.1071 858.8552,-6023.3721 781.3495,-6083.1062 841.1968,-6237.1071 873.817,-6321.0466 924.0325,-6317.873 962.9033,-6399.1071 991.006,-6457.8374 962.8565,-6486.8886 998.9033,-6541.1071 1034.0741,-6594.0079 1071.551,-6579.0259 1113.0681,-6627.1071 1134.9054,-6652.397 1125.1215,-6669.8047 1149.0681,-6693.1071 1209.3071,-6751.7256 1272.6413,-6708.0268 1317.5017,-6779.1071 1395.8094,-6903.1838 1287.4347,-7968.1023 1353.5017,-8099.1071 1393.7756,-8178.9665 1470.0526,-8144.1136 1511.9993,-8223.1071 1566.1157,-8325.0187 1528.4265,-8627.3905 1547.9993,-8741.1071 1565.7836,-8844.4332 1605.1984,-8963.8536 1621.6117,-9011.2112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1618.4033,-9012.6397 1625.0074,-9020.9244 1625.0112,-9010.3296 1618.4033,-9012.6397"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1055.9857,-5158.1071C1314.6386,-5105.0072 1622.5916,-5040.5006 1752.3748,-5013.2561"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1753.4549,-5016.6057 1762.5224,-5011.1256 1752.0165,-5009.755 1753.4549,-5016.6057"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.9857,-5273.1071C1376.4749,-5243.095 1427.9529,-5102.5839 1746.019,-5053.1071 1806.5627,-5043.6892 1839.2969,-5011.077 1883.8806,-5053.1071 1933.2841,-5099.6809 1887.377,-5603.4972 1919.8806,-5663.1071 1931.2402,-5683.94 1952.7931,-5699.6939 1971.5003,-5710.2376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1969.9291,-5713.3664 1980.3981,-5714.9945 1973.2294,-5707.1932 1969.9291,-5713.3664"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5273.1071C656.7269,-5260.8874 677.7494,-5256.3912 747.835,-5273.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-5273.1071C881.0541,-5304.8809 919.1361,-5278.5017 1055.9857,-5273.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M902.05,-4968.1071C1062.4022,-4866.341 1192.2001,-5010.8259 1317.5017,-4868.1071 1367.1918,-4811.5099 1297.4889,-4581.455 1353.5017,-4531.1071 1405.8914,-4484.0158 1444.9618,-4509.4683 1511.9993,-4531.1071 1946.6901,-4671.4195 2310.4785,-5147.6571 2384.5723,-5249.7406"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2381.7968,-5251.8757 2390.4833,-5257.9416 2387.4754,-5247.7827 2381.7968,-5251.8757"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M747.835,-4317.1071C817.0513,-4274.512 1054.9933,-4354.9628 1113.0681,-4298.1071 1152.1564,-4259.8394 1131.328,-3858.8526 1149.0681,-3807.1071 1192.8765,-3679.3241 1266.9993,-3679.3955 1317.5017,-3554.1071 1351.1042,-3470.7447 1307.0444,-3432.0496 1353.5017,-3355.1071 1353.9447,-3354.3734 1547.2811,-3203.575 1547.9993,-3203.1071 1824.8573,-3022.7364 1957.4858,-3023.0848 2282.0427,-3085.1071 2374.3877,-3102.7541 2424.5581,-3086.2268 2478.6731,-3163.1071 2513.0361,-3211.9261 2507.5071,-4177.8386 2514.6731,-4237.1071 2559.2648,-4605.918 2645.4429,-4685.8946 2686.5776,-5055.1071 2746.549,-5593.3913 2658.1462,-6954.3386 2722.5776,-7492.1071 2737.6362,-7617.7916 2779.1618,-7764.5615 2795.1442,-7818.1616"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.8341,-7819.308 2798.0668,-7827.8757 2798.5373,-7817.2913 2791.8341,-7819.308"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.3915,-5284.3731C426.3057,-5306.8171 465.1992,-5359.4129 480.9653,-5411.1071 522.2614,-5546.5093 464.4351,-5915.6549 516.9653,-6047.1071 552.0105,-6134.8045 613.3438,-6124.0932 654.4731,-6209.1071 690.0036,-6282.5481 661.8022,-6312.7266 690.4731,-6389.1071 708.4793,-6437.0762 727.2195,-6442.2002 747.835,-6489.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-6489.1071C758.6935,-6514.5201 788.512,-6491.0765 805.1968,-6513.1071 884.675,-6618.0499 773.6566,-6694.1111 841.1968,-6807.1071 875.1783,-6863.9588 925.3977,-6838.516 962.9033,-6893.1071 999.7715,-6946.7704 967.9298,-6977.8388 998.9033,-7035.1071 1055.3209,-7139.42 1163.9217,-7234.3558 1210.8154,-7272.4501"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1208.8402,-7275.353 1218.8269,-7278.8911 1213.2263,-7269.8975 1208.8402,-7275.353"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5539.1071C627.7417,-5571.41 641.515,-5575.7979 690.4731,-5596.1071 739.5947,-5616.4841 770.918,-5589.4486 805.1968,-5630.1071 848.9035,-5681.9482 819.0664,-5869.0132 841.1968,-5933.1071 875.1571,-6031.4629 927.4106,-6035.2939 962.9033,-6133.1071 999.5444,-6234.0853 950.472,-6276.224 998.9033,-6372.1071 1041.4339,-6456.3081 1073.9255,-6465.0786 1149.0681,-6522.1071 1217.5298,-6574.0652 1272.8947,-6543.6438 1317.5017,-6617.1071 1378.3195,-6717.268 1321.3762,-7558.4174 1353.5017,-7671.1071 1392.2824,-7807.1418 1463.1785,-7814.3445 1511.9993,-7947.1071 1542.2655,-8029.4128 1522.1667,-8057.3041 1547.9993,-8141.1071 1612.3664,-8349.919 1617.9205,-8414.0864 1746.019,-8591.1071 1794.3316,-8657.8706 1847.0626,-8641.3785 1883.8806,-8715.1071 1965.2086,-8877.9676 1857.2221,-8952.1928 1919.8806,-9123.1071 1981.8504,-9292.1428 2133.6771,-9455.3152 2186.5824,-9508.8215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2184.1087,-9511.2975 2193.6479,-9515.9077 2189.0657,-9506.355 2184.1087,-9511.2975"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3973.1071C653.7569,-3890.274 745.5688,-3962.1855 805.1968,-3873.1071 866.1792,-3782.0052 793.5031,-2985.8175 841.1968,-2887.1071 872.1507,-2823.0425 926.7328,-2844.3779 962.9033,-2783.1071 1003.2708,-2714.7269 966.5325,-2680.6158 998.9033,-2608.1071 1021.7779,-2556.8692 1098.9631,-2430.3668 1149.0681,-2405.1071 1539.0657,-2208.4953 1738.4303,-2424.9943 2092.2107,-2681.1071 2314.6247,-2842.1196 2386.114,-2904.6001 2478.6731,-3163.1071 2507.169,-3242.6931 2463.5287,-6138.8004 2514.6731,-6206.1071 2520.1382,-6213.2993 2527.5527,-6218.5143 2535.7494,-6222.2792"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.6842,-6225.6194 2545.2741,-6225.9418 2537.1967,-6219.0858 2534.6842,-6225.6194"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge503" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5387.1071C680.2157,-5414.7355 731.9932,-5351.2729 805.1968,-5417.1071 854.8894,-5461.7972 814.0584,-5502.0327 841.1968,-5563.1071 880.4109,-5651.3577 927.4809,-5653.2674 962.9033,-5743.1071 1000.5331,-5838.5453 967.8321,-5873.3368 998.9033,-5971.1071 1044.5448,-6114.7249 1033.3068,-6178.6263 1149.0681,-6275.1071 1208.863,-6324.9429 1264.6504,-6265.9601 1317.5017,-6323.1071 1372.3038,-6382.3633 1323.0193,-6426.3716 1353.5017,-6501.1071 1528.3134,-6929.7035 1641.4556,-7005.3321 1919.8806,-7375.1071 2036.0881,-7529.4417 2078.4963,-7557.2028 2205.1267,-7703.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge608" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-4431.1071C626.0182,-4399.5051 641.3485,-4397.58 690.4731,-4383.1071 781.4886,-4356.2924 1048.3494,-4391.4924 1113.0681,-4322.1071 1187.0866,-4242.7515 1099.5541,-3931.6701 1149.0681,-3835.1071 1193.613,-3748.2348 1267.8948,-3778.1915 1317.5017,-3694.1071 1360.0647,-3621.9622 1303.0702,-3575.9888 1353.5017,-3509.1071 1411.9001,-3431.6598 1454.935,-3437.4476 1547.9993,-3410.1071 1861.2568,-3318.0779 1968.1087,-3349.4126 2282.0427,-3439.1071 2370.6788,-3464.4315 2424.2075,-3430.7352 2478.6731,-3505.1071 2512.9306,-3551.8853 2506.3488,-5534.7269 2514.6731,-5592.1071 2555.6655,-5874.6722 2647.1789,-5928.3154 2686.5776,-6211.1071 2698.1305,-6294.0299 2672.911,-12171.7062 2722.5776,-12239.1071 2728.4014,-12247.0103 2736.7352,-12252.4762 2745.8258,-12256.2425"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2744.9048,-12259.6273 2755.4996,-12259.5833 2747.1898,-12253.0107 2744.9048,-12259.6273"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.6523,-5261.9309C404.5913,-5169.8731 443.5158,-4537.5282 585.7192,-4431.1071"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge620" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-5615.1071C604.7633,-5639.801 632.1232,-5607.3598 654.4731,-5629.1071 705.1603,-5678.4274 655.6366,-5722.5596 690.4731,-5784.1071 725.4206,-5845.8506 774.8462,-5830.9789 805.1968,-5895.1071 888.5641,-6071.2552 748.6043,-6160.6285 841.1968,-6332.1071 873.7996,-6392.4867 926.5841,-6368.8873 962.9033,-6427.1071 1004.0107,-6493.0023 951.4317,-6536.638 998.9033,-6598.1071 1033.5676,-6642.9925 1075.0384,-6613.0351 1113.0681,-6655.1071 1143.3458,-6688.6031 1117.4031,-6717.9195 1149.0681,-6750.1071 1205.5677,-6807.5391 1271.3916,-6751.0427 1317.5017,-6817.1071 1403.8914,-6940.8822 1273.0134,-8047.4157 1353.5017,-8175.1071 1395.6859,-8242.0306 1470.3106,-8188.8738 1511.9993,-8256.1071 1556.9271,-8328.5643 1496.9757,-11256.8051 1547.9993,-11325.1071 1554.6761,-11334.0449 1564.5008,-11339.8816 1575.024,-11343.6702"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1574.2305,-11347.0861 1584.8143,-11346.6038 1576.2398,-11340.3807 1574.2305,-11347.0861"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge553" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-5158.1071C820.9384,-5108.1434 770.9536,-5036.018 841.1968,-4982.1071 863.2125,-4965.2102 879.4922,-4984.2731 902.05,-4968.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.1978,-5277.6262C486.0613,-5280.0242 539.5767,-5281.0478 585.7192,-5273.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5273.1071C649.4553,-5262.1387 633.819,-5203.2984 690.4731,-5172.1071 713.4618,-5159.4505 726.1693,-5172.9148 747.835,-5158.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-4968.1071C998.3219,-4899.1146 1035.5533,-4901.9098 1149.0681,-4868.1071 1222.6173,-4846.2055 1266.3952,-4887.3547 1317.5017,-4830.1071 1366.6286,-4775.0769 1298.5839,-4549.3597 1353.5017,-4500.1071 1405.9441,-4453.0746 1441.7379,-4495.0474 1511.9993,-4500.1071 1771.8865,-4518.8221 1849.8231,-4488.5044 2092.2107,-4584.1071 2187.8057,-4621.8118 2219.1749,-4634.8195 2282.0427,-4716.1071 2436.5142,-4915.8373 2432.9009,-5000.7958 2478.6731,-5249.1071 2543.6961,-5601.8532 2494.0218,-8119.0131 2514.6731,-8477.1071 2533.1522,-8797.5348 2584.8426,-9185.5102 2597.7009,-9279.0777"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.2366,-9279.5774 2599.0716,-9289.0046 2601.1708,-9278.6198 2594.2366,-9279.5774"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge588" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M411.9819,-5284.2371C440.7869,-5308.3158 513.5105,-5364.8636 585.7192,-5387.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-5387.1071C678.9768,-5415.8347 720.6281,-5332.4204 805.1968,-5381.1071 832.8114,-5397.005 821.679,-5417.9205 841.1968,-5443.1071 887.7267,-5503.1516 925.4536,-5497.0171 962.9033,-5563.1071 996.2773,-5622.0044 976.5259,-5647.2168 998.9033,-5711.1071 1025.0688,-5785.813 1107.5506,-5966.7135 1149.0681,-6034.1071 1212.3698,-6136.8621 1266.7167,-6137.6238 1317.5017,-6247.1071 1351.4652,-6320.3263 1299.1887,-6365.4023 1353.5017,-6425.1071 1403.0302,-6479.5525 1461.1589,-6419.8846 1511.9993,-6473.1071 1556.9717,-6520.1867 1520.0439,-6556.3065 1547.9993,-6615.1071 1569.7573,-6660.8724 2064.7369,-7304.527 2092.2107,-7347.1071 2186.4637,-7493.1846 2210.6783,-7530.5846 2282.0427,-7689.1071 2301.7774,-7732.9438 2282.7541,-7758.4601 2318.0427,-7791.1071 2372.2925,-7841.2958 2432.9689,-7776.0289 2478.6731,-7834.1071 2504.2075,-7866.5547 2512.3988,-9278.8799 2514.6731,-9320.1071 2536.3478,-9713.0083 2586.9515,-10191.1091 2598.3274,-10296.089"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2594.8506,-10296.4933 2599.4113,-10306.0562 2601.8096,-10295.7364 2594.8506,-10296.4933"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge544" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M407.2813,-5284.3275C423.5684,-5307.1115 460.2167,-5360.902 480.9653,-5411.1071 505.8329,-5471.2787 483.3434,-5497.3525 516.9653,-5553.1071 538.2137,-5588.3429 559.8214,-5583.1327 585.7192,-5615.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5615.1071C605.3467,-5639.3399 624.1332,-5621.8995 654.4731,-5629.1071 722.0159,-5645.1526 761.0499,-5616.5298 805.1968,-5670.1071 874.7686,-5754.5405 784.6773,-6067.4333 841.1968,-6161.1071 874.1422,-6215.7099 928.2992,-6183.5401 962.9033,-6237.1071 1027.6382,-6337.3164 922.7806,-6411.2495 998.9033,-6503.1071 1033.0257,-6544.2827 1073.0361,-6505.6499 1113.0681,-6541.1071 1141.047,-6565.8886 1122.3961,-6590.9242 1149.0681,-6617.1071 1207.6757,-6674.6398 1271.9585,-6624.7647 1317.5017,-6693.1071 1394.8001,-6809.1016 1296.9807,-7819.6899 1353.5017,-7947.1071 1393.0777,-8036.3246 1470.8761,-8010.5921 1511.9993,-8099.1071 1565.1013,-8213.4059 1485.493,-8555.6676 1547.9993,-8665.1071 1591.1656,-8740.6852 1657.9862,-8705.3362 1710.019,-8775.1071 1739.8587,-8815.1192 1960.0585,-9561.5979 1999.881,-9697.1024"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1996.6272,-9698.4443 2002.8036,-9707.0526 2003.3435,-9696.4716 1996.6272,-9698.4443"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge527" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.6233,-5284.3056C426.944,-5306.6313 466.5169,-5359.0292 480.9653,-5411.1071 527.4241,-5578.5625 456.5968,-11504.149 516.9653,-11667.1071 549.7724,-11755.6661 602.2771,-11750.4016 654.4731,-11829.1071 705.3753,-11905.8615 773.5968,-12136.5572 841.1968,-12199.1071 845.0282,-12202.6523 849.4312,-12205.7285 854.0794,-12208.3902"/>
<polygon fill="#ff0000" stroke="#ff0000" points="852.7306,-12211.6299 863.2349,-12213.012 855.8852,-12205.381 852.7306,-12211.6299"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge670" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.2056,-5261.8808C407.6278,-5187.4745 450.3112,-4757.6407 480.9653,-4407.1071 489.6663,-4307.6104 472.7511,-4048.6639 516.9653,-3959.1071 553.3958,-3885.3165 619.1543,-3909.4361 654.4731,-3835.1071 722.9422,-3691.013 663.2179,-3275.2957 690.4731,-3118.1071 720.6129,-2944.2829 767.6679,-2910.487 805.1968,-2738.1071 830.3878,-2622.3983 786.3854,-2579.0777 841.1968,-2474.1071 875.2216,-2408.9453 912.5983,-2415.7089 962.9033,-2362.1071 1052.9002,-2266.2122 1046.364,-2214.2481 1149.0681,-2132.1071 1228.2122,-2068.809 1260.2444,-2070.7746 1353.5017,-2031.1071 1438.043,-1995.147 1458.404,-1981.4307 1547.9993,-1961.1071 1953.0238,-1869.232 2125.6545,-1826.3292 2478.6731,-2045.1071 2699.6253,-2182.0389 2776.8006,-2231.7362 2880.4805,-2470.1071 2931.0145,-2586.2902 2907.9093,-2912.7001 2916.4805,-3039.1071 2972.5515,-3866.0355 3015.9413,-4071.0236 3051.0454,-4899.1071 3054.4305,-4978.9583 3051.0745,-7704.7365 3087.0454,-7776.1071 3097.3713,-7796.5949 3117.8355,-7812.25 3135.8515,-7822.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3134.541,-7826.1055 3144.9829,-7827.8987 3137.9383,-7819.9852 3134.541,-7826.1055"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge656" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3973.1071C608.7471,-3939.0076 634.2995,-3946.9691 654.4731,-3911.1071 830.3649,-3598.4306 752.4937,-3472.9689 805.1968,-3118.1071 827.1954,-2969.9857 801.9482,-2927.6182 841.1968,-2783.1071 885.9158,-2618.4541 888.545,-2563.228 998.9033,-2433.1071 1038.3298,-2386.6202 1066.0589,-2395.9093 1113.0681,-2357.1071 1230.4833,-2260.1906 1221.7283,-2189.3626 1353.5017,-2113.1071 1883.6859,-1806.2966 2413.8647,-1914.6041 2686.5776,-2463.1071 2743.6748,-2577.9457 2640.1016,-2940.8946 2722.5776,-3039.1071 2768.9975,-3094.3839 2835.5929,-3020.5789 2880.4805,-3077.1071 2962.3093,-3180.1567 2840.9563,-7706.3515 2916.4805,-7814.1071 2919.3681,-7818.2271 2923.0185,-7821.6695 2927.1192,-7824.5453"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2925.6546,-7827.7404 2936.0688,-7829.6885 2929.1426,-7821.6712 2925.6546,-7827.7404"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.102,-5261.7922C410.6177,-5145.097 499.4039,-4163.8726 516.9653,-4105.1071 535.9053,-4041.7288 564.2443,-4035.6719 585.7192,-3973.1071"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-12445.1125 166.6166,-12445.1125 166.6166,-12423.1017 281.0645,-12423.1017 281.0645,-12445.1125"/>
<text text-anchor="middle" x="223.8406" y="-12430.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-12453.1071C924.6528,-12434.8212 946.2867,-12452.9639 962.9033,-12429.1071 1015.7515,-12353.2319 964.0113,-10850.7373 998.9033,-10765.1071 1005.9071,-10747.9187 1020.1725,-10732.672 1032.6895,-10721.7207"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1035.1186,-10724.2528 1040.5686,-10715.1672 1030.6422,-10718.871 1035.1186,-10724.2528"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-12414.1071C577.7613,-12386.2481 625.3099,-12420.6006 805.1968,-12439.1071 848.4617,-12443.5581 868.2366,-12480.4625 902.05,-12453.1071"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M243.8618,-12445.215C262.2806,-12454.7567 290.6785,-12467.7898 317.2024,-12473.1071 476.7091,-12505.0835 874.6289,-12552.3118 962.9033,-12467.1071 992.9971,-12438.0598 995.3309,-11756.7799 998.9033,-11715.1071 1034.1704,-11303.7088 1063.4192,-11203.0185 1113.0681,-10793.1071 1129.4277,-10658.0391 1127.5521,-10623.4502 1149.0681,-10489.1071 1208.7317,-10116.5755 1274.3015,-10031.9047 1317.5017,-9657.1071 1348.2789,-9390.0892 1292.0251,-8709.768 1353.5017,-8448.1071 1367.2678,-8389.5147 1401.8699,-8326.7674 1420.4695,-8295.7687"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1423.4717,-8297.5681 1425.6873,-8287.2075 1417.4943,-8293.9251 1423.4717,-8297.5681"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M227.0521,-12422.907C236.6113,-12389.1989 265.2079,-12285.626 281.2024,-12198.1071 304.6309,-12069.9111 296.2991,-12035.739 317.2024,-11907.1071 389.2011,-11464.051 261.4811,-11286.1739 516.9653,-10917.1071 557.993,-10857.8394 613.4962,-10890.4099 654.4731,-10831.1071 700.8514,-10763.9874 666.7013,-10729.1513 690.4731,-10651.1071 703.6122,-10607.971 725.3491,-10559.8008 737.954,-10533.313"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="741.119,-10534.8074 742.3009,-10524.2787 734.8112,-10531.7723 741.119,-10534.8074"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge773" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M227.4452,-12422.9691C238.1022,-12389.4343 269.4487,-12286.2957 281.2024,-12198.1071 291.1509,-12123.4628 270.4223,-10902.1187 317.2024,-10843.1071 363.9492,-10784.1375 434.5716,-10859.3549 480.9653,-10800.1071 523.1502,-10746.2343 512.9691,-8405.4143 516.9653,-8337.1071 531.967,-8080.6872 571.8468,-7771.0043 582.8643,-7688.2674"/>
<polygon fill="#00cbff" stroke="#00cbff" points="586.3637,-7688.5043 584.2218,-7678.1283 579.4256,-7687.5753 586.3637,-7688.5043"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge799" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M281.2218,-12440.3284C294.877,-12441.8089 309.649,-12443.4105 323.9664,-12444.9628"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="323.9697,-12448.4836 334.2888,-12446.082 324.7243,-12441.5244 323.9697,-12448.4836"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-12414.1071C430.4746,-12409.0058 942.3023,-12339.3351 962.9033,-12315.1071 1015.3415,-12253.4367 991.0221,-9481.6732 998.9033,-9401.1071 1026.097,-9123.12 1072.7473,-9059.4955 1113.0681,-8783.1071 1134.6849,-8634.9295 1107.5143,-8591.9723 1149.0681,-8448.1071 1165.958,-8389.632 1201.7567,-8326.8343 1220.7846,-8295.7973"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.8064,-8297.5657 1226.1119,-8287.2247 1217.8609,-8293.8709 1223.8064,-8297.5657"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M281.4107,-12427.0851C315.5815,-12423.03 359.7724,-12417.9818 399.0839,-12414.1071"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge744" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.81,-12445.1684C234.3435,-12493.6561 268.2765,-12692.3488 281.2024,-12857.1071 288.378,-12948.5701 263.6424,-14433.6202 317.2024,-14508.1071 362.3668,-14570.9181 426.6059,-14512.0608 480.9653,-14567.1071 515.3343,-14601.9104 481.2959,-14637.6379 516.9653,-14671.1071 563.203,-14714.4926 593.5891,-14691.4051 654.4731,-14709.1071 806.955,-14753.4412 842.7144,-14775.4495 998.9033,-14804.1071 1387.9912,-14875.497 1492.7855,-14958.5249 1883.8806,-14899.1071 2157.5838,-14857.5242 2281.2145,-14908.1501 2478.6731,-14714.1071 2515.0618,-14678.3478 2481.3032,-14643.6988 2514.6731,-14605.1071 2570.5506,-14540.4858 2612.3169,-14561.3392 2686.5776,-14519.1071 3040.0793,-14318.0705 3246.5982,-14373.2552 3456.7698,-14025.1071 3472.0412,-13999.8101 3542.9421,-13047.5805 3554.4083,-12892.3882"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3557.9101,-12892.4921 3555.1557,-12882.2616 3550.9291,-12891.9768 3557.9101,-12892.4921"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M401.2834,-7678.183C412.3308,-7732.7606 463.354,-7972.4882 516.9653,-8023.1071 594.2165,-8096.0463 642.2939,-8072.9031 747.835,-8085.1071"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge767" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M463.3132,-7667.1071C483.6061,-7667.1071 505.9381,-7667.1071 525.9091,-7667.1071"/>
<polygon fill="#00cbff" stroke="#00cbff" points="526.1141,-7670.6072 536.1141,-7667.1071 526.114,-7663.6072 526.1141,-7670.6072"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M405.2851,-7506.5285C445.883,-7581.2779 672.621,-7998.3853 690.4731,-8023.1071 712.4505,-8053.5415 710.7957,-8078.9952 747.835,-8085.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M747.835,-8085.1071C841.0092,-8119.9575 868.1874,-8116.6954 962.9033,-8147.1071 1046.4863,-8173.9442 1065.4443,-8186.3976 1149.0681,-8213.1071 1186.1428,-8224.9488 1195.1572,-8229.2945 1233.2849,-8237.1071"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1233.2849,-8237.1071C1278.5672,-8245.1711 1329.4508,-8255.1344 1368.4911,-8262.9722"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1368.167,-8266.4771 1378.6611,-8265.0196 1369.5485,-8259.6148 1368.167,-8266.4771"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge768" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M411.0427,-7506.1281C442.4392,-7535.0626 527.4513,-7613.4084 566.1089,-7649.0346"/>
<polygon fill="#00cbff" stroke="#00cbff" points="563.893,-7651.7521 573.6185,-7655.9553 568.6369,-7646.6046 563.893,-7651.7521"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge723" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3169.983,-7762.1071C3191.6789,-7793.7585 3229.4486,-7755.7495 3252.9207,-7786.1071 3402.5647,-7979.649 3320.3006,-11949.1701 3372.8452,-12188.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M423.0427,-7484.0386C472.095,-7461.8729 587.9855,-7412.0318 690.4731,-7387.1071 963.2939,-7320.758 1041.6983,-7362.6985 1317.5017,-7310.1071 1421.4854,-7290.279 1442.999,-7263.5493 1547.9993,-7250.1071 1619.4251,-7240.9632 1638.0106,-7249.9 1710.019,-7250.1071 1787.2918,-7250.3293 1806.7264,-7246.8221 1883.8806,-7251.1071 2063.7592,-7261.0973 2112.774,-7265.4287 2282.0427,-7327.1071 2370.0329,-7359.1691 2982.3053,-7608.5064 3051.0454,-7672.1071 3075.5712,-7694.7992 3060.9922,-7717.1865 3087.0454,-7738.1071 3116.9663,-7762.1334 3148.2871,-7730.4557 3169.983,-7762.1071"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1301.9296,-8276.1071C1323.526,-8276.1071 1347.2833,-8276.1071 1368.5582,-8276.1071"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1368.7825,-8279.6072 1378.7825,-8276.1071 1368.7825,-8272.6072 1368.7825,-8279.6072"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge725" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-743.1071C3163.0463,-761.2128 3229.3232,-748.1496 3372.8452,-857.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1258.6934,-8265.0159C1278.7159,-8254.7478 1305.2323,-8237.3897 1317.5017,-8213.1071 1348.8829,-8150.9999 1348.9719,-3272.5446 1353.5017,-3203.1071 1399.3296,-2500.6063 1395.4007,-2318.3634 1547.9993,-1631.1071 1609.7845,-1352.8458 1634.8493,-1283.5725 1746.019,-1021.1071 1810.3684,-869.182 1782.7156,-784.8014 1919.8806,-693.1071 2203.1668,-503.7313 2350.8701,-632.672 2686.5776,-691.1071 2752.629,-702.6044 2916.8676,-738.6368 2983.7629,-743.1071"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1258.675,-8265.0066C1278.6866,-8254.7329 1305.1972,-8237.372 1317.5017,-8213.1071 1407.2809,-8036.0593 1290.8999,-4828.4878 1353.5017,-4640.1071 1479.4054,-4261.2388 1662.4015,-4247.2817 1883.8806,-3915.1071 1983.0371,-3766.3922 2022.6364,-3735.7508 2092.2107,-3571.1071 2156.111,-3419.8905 2191.455,-3223.2895 2201.8472,-3159.2598"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2205.3331,-3159.6248 2203.45,-3149.1987 2198.4203,-3158.5235 2205.3331,-3159.6248"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1236.7875,-11148.8459C1250.4448,-11104.3013 1300.2195,-10935.8818 1317.5017,-10793.1071 1348.8159,-10534.4092 1295.7307,-8702.2089 1353.5017,-8448.1071 1366.8451,-8389.417 1401.629,-8326.7118 1420.3666,-8295.7449"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1423.3685,-8297.5448 1425.625,-8287.1931 1417.4056,-8293.8783 1423.3685,-8297.5448"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge734" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3169.983,-12264.1071C3208.0472,-12259.2445 3216.8136,-12253.0996 3252.9207,-12240.1071 3307.5841,-12220.4373 3360.3544,-12131.3711 3372.8452,-12188.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-11197.1071C1655.704,-11223.517 1686.8727,-11191.5379 1710.019,-11221.1071 1764.181,-11290.2983 1701.6519,-11935.2619 1746.019,-12011.1071 1782.4827,-12073.4415 1824.6638,-12055.7727 1883.8806,-12097.1071 1900.5017,-12108.7089 1901.5203,-12116.5186 1919.8806,-12125.1071 2037.3955,-12180.0774 2075.3905,-12187.1071 2205.1267,-12187.1071 2205.1267,-12187.1071 2205.1267,-12187.1071 2600.6254,-12187.1071 2725.462,-12187.1071 2756.7515,-12194.5146 2880.4805,-12211.1071 2888.5833,-12212.1937 3161.8735,-12265.1431 3169.983,-12264.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1298.1776,-11161.7558C1404.4084,-11165.0978 1605.9921,-11174.383 1629.0092,-11197.1071"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge633" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2600.6254,-12264.1071C2690.7074,-12251.5189 2737.6777,-12160.3286 2801.5291,-12225.1071"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1629.0092,-11197.1071C1661.1561,-11229.079 1689.0623,-11218.9021 1710.019,-11259.1071 1795.1485,-11422.4258 1654.9963,-11926.9982 1746.019,-12087.1071 1791.6859,-12167.4351 1834.2253,-12166.4487 1919.8806,-12201.1071 2201.5431,-12315.0751 2299.7032,-12306.1583 2600.6254,-12264.1071"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge512" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1258.0266,-11149.0332C1338.0998,-11111.8156 1591.8278,-10982.8275 1710.019,-10793.1071 1752.697,-10724.6005 1712.423,-10688.4956 1746.019,-10615.1071 1826.9845,-10438.243 2217.1619,-10106.4832 2282.0427,-9923.1071 2345.3573,-9744.1577 2295.32,-8403.5621 2318.0427,-8215.1071 2333.8948,-8083.6345 2376.3361,-7929.6843 2392.2332,-7874.8134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.5981,-7875.7766 2395.043,-7865.1963 2388.879,-7873.8135 2395.5981,-7875.7766"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge606" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2600.6254,-12264.1071C2649.0857,-12257.3352 2704.7658,-12257.9853 2745.1998,-12259.9565"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2745.2263,-12263.4628 2755.3977,-12260.4973 2745.5971,-12256.4726 2745.2263,-12263.4628"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge619" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1277.6834,-11171.1794C1290.7351,-11174.9946 1304.8885,-11179.6921 1317.5017,-11185.1071 1409.1628,-11224.4583 1429.2096,-11241.4641 1511.9993,-11297.1071 1528.8224,-11308.414 1530.0218,-11315.7436 1547.9993,-11325.1071 1556.4284,-11329.4974 1565.7591,-11333.2634 1575.0004,-11336.4409"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1573.9649,-11339.7844 1584.5569,-11339.5405 1576.1246,-11333.1259 1573.9649,-11339.7844"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M604.4718,-11947.0665C620.974,-11936.1822 643.9613,-11917.8934 654.4731,-11895.1071 701.7916,-11792.5358 679.7086,-10991.5528 690.4731,-10879.1071 703.1168,-10747.0319 732.6306,-10590.1561 743.6162,-10534.21"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="747.104,-10534.6144 745.6114,-10524.1252 740.2371,-10533.2558 747.104,-10534.6144"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge754" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M902.05,-12185.1071C923.7299,-12203.3492 945.7612,-12181.5475 962.9033,-12204.1071 1001.4415,-12254.8245 984.8429,-13287.9802 998.9033,-13350.1071 1093.6916,-13768.9345 1213.684,-13875.5991 1547.9993,-14145.1071 1698.0366,-14266.0596 1737.9048,-14304.6604 1919.8806,-14368.1071 2394.5964,-14533.6188 2551.1707,-14424.721 3051.0454,-14371.1071 3140.7843,-14361.4822 3164.3326,-14366.3655 3252.9207,-14349.1071 3307.2988,-14338.5134 3317.8181,-14321.5285 3372.8452,-14315.1071"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge790" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M604.9396,-11946.9218C621.5171,-11936.058 644.3391,-11917.8868 654.4731,-11895.1071 704.5152,-11782.6209 621.8409,-7565.3175 690.4731,-7463.1071 721.2849,-7417.2208 771.9147,-7459.2344 805.1968,-7415.1071 846.1602,-7360.7955 828.6466,-7177.967 841.1968,-7111.1071 902.6091,-6783.9388 1020.6471,-6394.9515 1049.503,-6301.8519"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1052.8749,-6302.7954 1052.5021,-6292.2071 1046.1906,-6300.7169 1052.8749,-6302.7954"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1055.9857,-8769.1071C1085.2685,-8688.6474 1093.0401,-8668.3544 1113.0681,-8585.1071 1135.0133,-8493.891 1109.6847,-8462.2594 1149.0681,-8377.1071 1164.3144,-8344.1426 1193.1329,-8313.1456 1212.7683,-8294.4003"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1215.3742,-8296.756 1220.3018,-8287.3768 1210.6008,-8291.636 1215.3742,-8296.756"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M604.5237,-11947.0903C621.0617,-11936.2224 644.0725,-11917.9443 654.4731,-11895.1071 686.7662,-11824.1998 684.9185,-10570.8234 690.4731,-10493.1071 691.7513,-10475.2245 836.3362,-9228.3638 841.1968,-9211.1071 886.5767,-9049.9937 922.2963,-9017.9299 998.9033,-8869.1071 1022.3252,-8823.6059 1038.4837,-8817.1968 1055.9857,-8769.1071"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge740" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-12185.1071C923.7002,-12203.3845 945.6979,-12181.5957 962.9033,-12204.1071 1028.5309,-12289.9734 970.5571,-13071.8167 998.9033,-13176.1071 1148.2007,-13725.3976 1365.5556,-13936.7492 1919.8806,-14066.1071 2514.6758,-14204.9091 2804.8044,-14147.1241 3252.9207,-13732.1071 3516.8198,-13487.7003 3550.9932,-12999.8383 3555.3497,-12892.3697"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3558.8549,-12892.2868 3555.7168,-12882.1674 3551.8594,-12892.035 3558.8549,-12892.2868"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M628.1212,-11969.166C716.4622,-11992.9936 915.9292,-12051.1505 962.9033,-12102.1071 1001.2213,-12143.6737 953.6232,-12190.2581 998.9033,-12224.1071 1200.0955,-12374.5075 1344.0179,-12173.8712 1511.9993,-11987.1071 1629.4554,-11856.5177 1658.9365,-11813.1551 1710.019,-11645.1071 1781.2643,-11410.7288 1691.0504,-11333.8277 1746.019,-11095.1071 1782.4238,-10937.007 1826.4594,-10908.8429 1883.8806,-10757.1071 1983.1962,-10494.6654 2034.3945,-10435.6914 2092.2107,-10161.1071 2113.1545,-10061.6395 2064.8049,-9784.5561 2128.2107,-9705.1071 2150.5483,-9677.1175 2197.8511,-9716.1706 2205.1267,-9681.1071"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge696" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M902.05,-12185.1071C923.7288,-12203.3505 945.6285,-12181.6489 962.9033,-12204.1071 1019.3866,-12277.5385 970.8618,-12948.811 998.9033,-13037.1071 1087.0513,-13314.6644 1172.2849,-13360.1409 1353.5017,-13588.1071 1735.4632,-14068.605 2127.8354,-14203.233 2686.5776,-13949.1071 2910.9424,-13847.062 2961.4115,-13760.7122 3051.0454,-13531.1071 3104.3609,-13394.5348 3019.5942,-12342.2796 3087.0454,-12212.1071 3108.219,-12171.2447 3162.8695,-12195.5763 3169.983,-12150.1071"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M902.05,-12185.1071C923.6847,-12203.4027 945.1459,-12182.0285 962.9033,-12204.1071 1020.9185,-12276.2401 946.6557,-12542.6929 998.9033,-12619.1071 1062.7285,-12712.454 1120.3996,-12711.4572 1233.2849,-12718.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M631.853,-11969.1441C640.0521,-11972.6267 648.021,-11977.1765 654.4731,-11983.1071 727.2892,-12050.0371 662.9137,-12134.41 747.835,-12185.1071"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M747.835,-12185.1071C806.6856,-12220.2403 849.6762,-12140.895 902.05,-12185.1071"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1055.9857,-7021.1071C1093.9744,-6991.0821 1152.222,-6998.3341 1191.4872,-7008.3883"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1190.7156,-7011.8055 1201.2838,-7011.0548 1192.5541,-7005.0513 1190.7156,-7011.8055"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M604.9336,-11946.9191C621.507,-11936.0535 644.3264,-11917.8812 654.4731,-11895.1071 698.5636,-11796.1468 670.6386,-8101.6139 690.4731,-7995.1071 691.7958,-7988.0047 1050.3178,-7025.5868 1055.9857,-7021.1071"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M630.4097,-11969.1179C639.0107,-11972.625 647.5,-11977.1909 654.4731,-11983.1071 679.3589,-12004.2208 666.4338,-12025.0345 690.4731,-12047.1071 788.4643,-12137.0813 877.781,-12068.873 962.9033,-12171.1071 1005.1148,-12221.8042 946.9057,-12274.5085 998.9033,-12315.1071 1281.3537,-12535.6377 1582.4529,-12269.9785 1710.019,-11935.1071 1774.8219,-11764.9943 1709.8876,-11705.5232 1746.019,-11527.1071 1785.6852,-11331.2364 1834.5475,-11292.7691 1883.8806,-11099.1071 1905.097,-11015.8201 1869.4459,-10978.7002 1919.8806,-10909.1071 1971.2022,-10838.2903 2043.601,-10886.8121 2092.2107,-10814.1071 2172.0027,-10694.763 2033.5323,-10601.0227 2128.2107,-10493.1071 2174.6558,-10440.1684 2238.0884,-10510.1315 2282.0427,-10455.1071 2314.1915,-10414.8615 2311.9932,-8652.2603 2318.0427,-8601.1071 2333.8005,-8467.8626 2376.2995,-8311.7501 2392.2225,-8256.1057"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.627,-8256.9314 2395.037,-8246.353 2388.9015,-8254.9905 2395.627,-8256.9314"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M604.9032,-11946.9055C621.4562,-11936.0308 644.2627,-11917.8527 654.4731,-11895.1071 709.6973,-11772.0855 629.2601,-9588.2611 690.4731,-9468.1071 719.4,-9411.327 775.8111,-9438.6511 805.1968,-9382.1071 864.6612,-9267.6854 808.9543,-8346.9621 841.1968,-8222.1071 870.8038,-8107.4578 926.1607,-8097.6727 962.9033,-7985.1071 994.7365,-7887.5823 952.3178,-7848.5086 998.9033,-7757.1071 1031.4647,-7693.2212 1082.1198,-7707.7898 1113.0681,-7643.1071 1145.5744,-7575.1683 1098.0214,-7361.4838 1149.0681,-7306.1071 1155.7311,-7298.879 1164.5625,-7294.3157 1173.9998,-7291.5233"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1175.0322,-7294.8771 1183.9883,-7289.2169 1173.4572,-7288.0566 1175.0322,-7294.8771"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge600" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-12909.1071C1237.2778,-13256.6381 1501.6775,-13300.0866 1883.8806,-13213.1071 2401.7427,-13095.2552 2733.9866,-12413.14 2792.3169,-12284.8919"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2795.6702,-12285.9691 2796.5849,-12275.4138 2789.2875,-12283.0949 2795.6702,-12285.9691"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge566" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-12185.1071C923.7007,-12203.3838 945.2593,-12181.9378 962.9033,-12204.1071 1028.2722,-12286.2413 936.0337,-12591.0445 998.9033,-12675.1071 1189.9093,-12930.5003 1451.5561,-12957.9382 1710.019,-12771.1071 1751.3661,-12741.2192 1723.2587,-12707.767 1746.019,-12662.1071 1794.0194,-12565.8127 1836.5128,-12559.7143 1883.8806,-12463.1071 1907.272,-12415.4001 1903.3625,-12399.6072 1919.8806,-12349.1071 2075.9619,-11871.9277 2133.5468,-11758.7012 2282.0427,-11279.1071 2299.5219,-11222.6551 2293.1964,-11204.7262 2318.0427,-11151.1071 2371.6973,-11035.3192 2437.7994,-11033.9996 2478.6731,-10913.1071 2522.5919,-10783.2083 2504.7833,-10433.8724 2514.6731,-10297.1071 2543.0538,-9904.6333 2588.4972,-9426.2036 2598.5946,-9321.1422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2602.0804,-9321.4566 2599.555,-9311.1671 2595.1126,-9320.7856 2602.0804,-9321.4566"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge578" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M902.05,-12185.1071C923.7007,-12203.3838 945.4858,-12181.7594 962.9033,-12204.1071 1006.8912,-12260.5462 971.0362,-12781.2001 998.9033,-12847.1071 1013.4903,-12881.6059 1034.6996,-12878.2875 1055.9857,-12909.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-12909.1071C1221.2904,-13148.4476 1451.7437,-13018.9105 1710.019,-12885.1071 1764.5226,-12856.8707 2086.4633,-12364.5058 2092.2107,-12353.1071 2114.2326,-12309.4318 2110.8047,-12294.8184 2128.2107,-12249.1071 2272.4548,-11870.2966 2386.9522,-11801.9375 2478.6731,-11407.1071 2537.0147,-11155.9643 2485.2492,-11084.2529 2514.6731,-10828.1071 2536.6518,-10636.7739 2581.9796,-10408.0922 2596.2344,-10338.3326"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2599.7333,-10338.6931 2598.3168,-10328.1934 2592.8764,-10337.2848 2599.7333,-10338.6931"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge532" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-10211.1071C1828.0246,-10158.7342 1865.0626,-10161.7011 1883.8806,-10111.1071 1935.3134,-9972.8256 1846.0529,-9908.8434 1919.8806,-9781.1071 1931.8342,-9760.4251 1953.5969,-9744.5977 1972.2593,-9733.9799"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1973.9862,-9737.0251 1981.1153,-9729.1876 1970.6547,-9730.8687 1973.9862,-9737.0251"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M632.4813,-11956.1902C711.9538,-11955.6245 873.4319,-11966.5824 962.9033,-12057.1071 1009.2772,-12104.0269 946.9057,-12160.5085 998.9033,-12201.1071 1038.8968,-12232.3331 1064.9992,-12217.3526 1113.0681,-12201.1071 1221.3432,-12164.5142 1230.4063,-12119.1134 1317.5017,-12045.1071 1334.2727,-12030.8565 1335.3624,-12023.5695 1353.5017,-12011.1071 1417.8922,-11966.8683 1465.3357,-11997.7626 1511.9993,-11935.1071 1573.2764,-11852.8298 1499.9948,-11797.7714 1547.9993,-11707.1071 1594.2015,-11619.8467 1669.3462,-11645.0779 1710.019,-11555.1071 1761.7654,-11440.6409 1724.5523,-10548.8786 1746.019,-10425.1071 1763.0947,-10326.6535 1790.7471,-10308.0551 1814.9498,-10211.1071"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge523" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-12185.1071C777.341,-12202.7219 814.5984,-12212.4269 845.1006,-12217.7499"/>
<polygon fill="#ff0000" stroke="#ff0000" points="844.7317,-12221.2359 855.1649,-12219.3921 845.8591,-12214.3272 844.7317,-12221.2359"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge753" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3372.8452,-14315.1071C3453.8882,-14307.5821 3486.4073,-14357.3533 3555.9763,-14315.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1056.7944,-12121.2763C1065.0037,-12234.453 1133.2749,-13170.7789 1149.0681,-13227.1071 1287.572,-13721.0964 1312.823,-13940.2435 1746.019,-14215.1071 1930.5377,-14332.1845 1986.5993,-14391.1071 2205.1267,-14391.1071 2205.1267,-14391.1071 2205.1267,-14391.1071 2398.3579,-14391.1071 2832.7785,-14391.1071 2940.2852,-14355.2712 3372.8452,-14315.1071"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1058.6239,-12098.8308C1068.2538,-12057.0464 1101.5463,-11906.9584 1113.0681,-11781.1071 1129.9507,-11596.7008 1106.3003,-8628.2782 1149.0681,-8448.1071 1163.1253,-8388.8872 1200.1426,-8326.4099 1220.0948,-8295.6159"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.1164,-8297.3914 1225.6947,-8287.115 1217.2707,-8293.5406 1223.1164,-8297.3914"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge535" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1065.6407,-12099.0334C1081.8453,-12080.7906 1115.9979,-12043.785 1149.0681,-12017.1071 1223.7567,-11956.8555 1460.303,-11863.9535 1511.9993,-11783.1071 1573.8965,-11686.3077 1495.9208,-11629.524 1547.9993,-11527.1071 1593.448,-11437.7281 1669.8522,-11461.9811 1710.019,-11370.1071 1779.1606,-11211.9589 1673.9518,-9973.9437 1746.019,-9817.1071 1763.2236,-9779.6656 1783.3324,-9781.5306 1814.9498,-9755.1071"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge793" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M747.835,-12263.1071C843.7113,-12259.1439 897.8655,-12314.6625 962.9033,-12244.1071 987.9109,-12216.978 997.163,-6967.9627 998.9033,-6931.1071 1010.6151,-6683.0812 1044.1184,-6383.2661 1053.511,-6302.1747"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1056.9909,-6302.55 1054.6716,-6292.2121 1050.0379,-6301.74 1056.9909,-6302.55"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M237.7356,-12167.0887C278.5478,-12135.1287 402.4048,-12040.9955 516.9653,-11983.1071 524.5427,-11979.2782 532.8506,-11975.7443 540.9908,-11972.6125"/>
<polygon fill="#ff0000" stroke="#ff0000" points="542.2506,-11975.8784 550.4159,-11969.1272 539.8227,-11969.3129 542.2506,-11975.8784"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.4203,-12166.6261C238.0077,-12132.0615 269.1798,-12025.7756 281.2024,-11935.1071 289.4587,-11872.8425 279.0332,-10854.9886 317.2024,-10805.1071 321.1146,-10799.9945 326.0468,-10795.8962 331.5419,-10792.6155"/>
<polygon fill="#00ffff" stroke="#00ffff" points="333.1921,-10795.7037 340.5748,-10788.1046 330.0646,-10789.4411 333.1921,-10795.7037"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge584" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.4826,-12189.2402C238.2441,-12222.7613 269.8521,-12325.8657 281.2024,-12414.1071 288.5285,-12471.0632 276.2445,-14440.8563 317.2024,-14481.1071 369.1143,-14532.1228 410.1267,-14497.8202 480.9653,-14481.1071 885.4842,-14385.6679 958.7902,-14273.036 1317.5017,-14063.1071 1408.4416,-14009.8863 1626.5852,-13861.4601 1710.019,-13797.1071 1899.6896,-13650.813 1977.7914,-13627.5474 2092.2107,-13417.1071 2281.7994,-13068.415 2176.6448,-12923.9666 2318.0427,-12553.1071 2373.8879,-12406.636 2440.0154,-12391.0217 2478.6731,-12239.1071 2517.3487,-12087.122 2499.6287,-10984.2126 2514.6731,-10828.1071 2533.1481,-10636.4038 2580.8321,-10407.9711 2595.9526,-10338.3028"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2599.4496,-10338.6939 2598.1644,-10328.1773 2592.6109,-10337.2 2599.4496,-10338.6939"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge539" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.1638,-12189.2717C236.3728,-12237.4813 278.4679,-12427.4207 317.2024,-12473.1071 454.6553,-12635.2295 535.2862,-12681.1071 747.835,-12681.1071 747.835,-12681.1071 747.835,-12681.1071 902.05,-12681.1071 948.5814,-12681.1071 1485.492,-12145.3502 1511.9993,-12107.1071 1535.6038,-12073.0518 1525.874,-12056.1415 1547.9993,-12021.1071 1605.649,-11929.8214 1670.0834,-11940.4152 1710.019,-11840.1071 1763.5095,-11705.7528 1714.3637,-10680.2108 1746.019,-10539.1071 1779.3825,-10390.3897 1846.2307,-10372.7976 1883.8806,-10225.1071 1930.1608,-10043.5621 1841.2619,-9975.1646 1919.8806,-9805.1071 1933.3062,-9776.0666 1960.7262,-9751.1029 1981.0462,-9735.4593"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1983.3305,-9738.1221 1989.2585,-9729.3409 1979.1483,-9732.5087 1983.3305,-9738.1221"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge526" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-12263.1071C787.7516,-12260.5934 831.8605,-12248.442 862.6431,-12238.362"/>
<polygon fill="#ff0000" stroke="#ff0000" points="863.7775,-12241.6733 872.147,-12235.1769 861.5531,-12235.0361 863.7775,-12241.6733"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.218,-12189.1346C341.5776,-12214.6762 561.3492,-12274.8506 747.835,-12263.1071"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge788" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M457.32,-10772.3863C466.5477,-10768.5931 474.9995,-10763.0808 480.9653,-10755.1071 539.5447,-10676.8131 505.5178,-7332.2176 516.9653,-7235.1071 557.5267,-6891.021 479.7902,-6750.1584 690.4731,-6475.1071 769.3385,-6372.1466 918.7408,-6317.9247 999.9768,-6294.9029"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1001.3143,-6298.1642 1010.0152,-6292.1189 999.4435,-6291.4188 1001.3143,-6298.1642"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M423.2571,-10791.2535C442.6837,-10801.654 468.6848,-10819.1689 480.9653,-10843.1071 536.2769,-10950.9242 445.8166,-11835.0166 516.9653,-11933.1071 520.4528,-11937.9152 524.9605,-11941.8009 529.9994,-11944.9408"/>
<polygon fill="#ff0000" stroke="#ff0000" points="528.4056,-11948.0569 538.8944,-11949.552 531.6273,-11941.8423 528.4056,-11948.0569"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M635.4879,-10959.0869C642.6633,-10955.6267 649.3419,-10951.0804 654.4731,-10945.1071 707.6352,-10883.2218 673.4179,-10844.8888 690.4731,-10765.1071 708.8525,-10679.1316 732.7016,-10577.1356 742.8799,-10534.0116"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="746.3196,-10534.6746 745.2146,-10524.1376 739.5074,-10533.0639 746.3196,-10534.6746"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge752" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M747.835,-11691.1071C761.564,-11713.4718 785.764,-11687.4709 805.1968,-11705.1071 841.1065,-11737.6969 807.7134,-11773.0291 841.1968,-11808.1071 881.4591,-11850.287 920.4604,-11817.1222 962.9033,-11857.1071 990.1079,-11882.7362 977.3621,-11902.5635 998.9033,-11933.1071 1040.2302,-11991.7052 1084.1866,-11981.4755 1113.0681,-12047.1071 1188.0545,-12217.5097 1087.2321,-12708.5044 1149.0681,-12884.1071 1191.0323,-13003.2778 1268.2972,-12996.7389 1317.5017,-13113.1071 1355.234,-13202.3435 1307.3904,-13242.8979 1353.5017,-13328.1071 1373.8675,-13365.741 1883.527,-13827.5352 1919.8806,-13850.1071 2004.1428,-13902.4253 2033.9081,-13899.3771 2128.2107,-13930.1071 2167.2661,-13942.8339 3520.8662,-14336.4279 3555.9763,-14315.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3555.9763,-14315.1071C3651.3055,-14250.399 3702.8543,-13862.0965 3714.213,-13766.4062"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3717.6916,-13766.7924 3715.3734,-13756.4543 3710.7387,-13765.9816 3717.6916,-13766.7924"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge716" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-11387.1071C777.4509,-11404.3503 870.1672,-11399.6737 902.05,-11387.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11387.1071C937.9712,-11372.9488 942.569,-11357.9294 962.9033,-11325.1071 988.6634,-11283.5269 967.2178,-11258.3699 998.9033,-11221.1071 1048.0255,-11163.3384 1075.5456,-11158.6721 1149.0681,-11140.1071 1391.5017,-11078.8908 1538.5993,-11001.0721 1710.019,-11183.1071 1759.3795,-11235.5242 1715.6722,-11764.8148 1746.019,-11830.1071 1790.7911,-11926.4356 1830.6067,-11936.5407 1919.8806,-11994.1071 2035.0407,-12068.3656 2068.1006,-12111.1071 2205.1267,-12111.1071 2205.1267,-12111.1071 2205.1267,-12111.1071 2801.5291,-12111.1071 2930.593,-12111.1071 2959.1326,-12146.9079 3087.0454,-12164.1071 3118.6285,-12168.3538 3365.9935,-12156.9851 3372.8452,-12188.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-9223.1071C1656.8576,-9191.5626 1688.9924,-9210.5553 1710.019,-9174.1071 1760.7486,-9086.171 1741.1278,-7448.5089 1746.019,-7347.1071 1762.921,-6996.7047 1803.2259,-6570.6757 1812.8568,-6471.4579"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1816.3666,-6471.527 1813.8532,-6461.2346 1809.3996,-6470.8479 1816.3666,-6471.527"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-9510.1071C1030.1951,-9537.5292 1032.2943,-9408.5797 1149.0681,-9349.1071 1235.7249,-9304.9731 1259.7378,-9296.905 1353.5017,-9271.1071 1383.4615,-9262.8641 1608.4443,-9246.4014 1629.0092,-9223.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-9482.1071C786.4151,-9424.1056 832.8688,-9501.9488 902.05,-9510.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2205.1267,-9566.1071C2230.1269,-9541.3098 2260.2178,-9574.7402 2282.0427,-9547.1071 2319.0432,-9500.2601 2315.5839,-5308.753 2318.0427,-5249.1071 2335.7055,-4820.642 2385.3827,-4298.6264 2396.2431,-4187.524"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2399.7535,-4187.5889 2397.2471,-4177.2948 2392.7869,-4186.905 2399.7535,-4187.5889"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M902.05,-9510.1071C934.9388,-9513.9856 936.303,-9533.3805 962.9033,-9553.1071 979.1846,-9565.1812 979.7307,-9574.5288 998.9033,-9581.1071 1046.8968,-9597.5741 1062.3416,-9582.2728 1113.0681,-9581.1071 1306.524,-9576.6615 1354.5433,-9565.5527 1547.9993,-9561.1071 1619.9891,-9559.4528 1638.0112,-9560.7435 1710.019,-9561.1071 1737.5261,-9561.246 2185.597,-9585.4784 2205.1267,-9566.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge482" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M747.835,-10931.1071C894.5394,-10877.5168 1674.3343,-10945.9955 1710.019,-10980.1071 1758.8745,-11026.8088 1711.1164,-11224.2304 1746.019,-11282.1071 1804.5294,-11379.1308 2114.0989,-11588.1493 2398.3579,-11693.1071"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M2398.3579,-11693.1071C2432.1746,-11706.1196 2446.7455,-11689.9747 2478.6731,-11707.1071 2499.1727,-11718.1072 2493.3018,-11735.9146 2514.6731,-11745.1071 2584.8579,-11775.2958 2626.945,-11792.8692 2686.5776,-11745.1071 3454.4039,-11130.1258 2441.6884,-10246.4286 3169.983,-9585.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge625" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2801.5291,-13555.1071C2817.5784,-13522.1303 2857.462,-13559.6588 2880.4805,-13531.1071 2921.315,-13480.4568 2974.5678,-12447.8262 2982.702,-12285.4997"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2986.206,-12285.5037 2983.2089,-12275.3417 2979.2147,-12285.1548 2986.206,-12285.5037"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2600.6254,-13669.1071C2640.988,-13662.3773 2654.9412,-13662.0602 2686.5776,-13636.1071 2709.743,-13617.1033 2698.7481,-13597.2711 2722.5776,-13579.1071 2751.7452,-13556.8742 2785.4797,-13588.0839 2801.5291,-13555.1071"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M586.5953,-10981.17C592.7732,-11057.5504 631.2618,-11507.1846 690.4731,-11629.1071 706.8727,-11662.8756 726.0251,-11660.5524 747.835,-11691.1071"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M747.835,-11691.1071C813.8169,-11783.5454 885.503,-11745.9949 962.9033,-11829.1071 985.6749,-11853.5591 974.1103,-11872.7074 998.9033,-11895.1071 1039.7454,-11932.0066 1081.6199,-11897.9335 1113.0681,-11943.1071 1165.6183,-12018.5925 1115.7663,-12684.3717 1149.0681,-12770.1071 1191.2682,-12878.7511 1265.1582,-12866.97 1317.5017,-12971.1071 1348.486,-13032.7502 1321.6349,-13060.9155 1353.5017,-13122.1071 1383.5657,-13179.8368 1493.318,-13305.801 1547.9993,-13341.1071 1959.6659,-13606.9082 2117.2777,-13749.6969 2600.6254,-13669.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge674" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M747.835,-11387.1071C819.0445,-11430.8525 929.989,-11154.3858 998.9033,-11107.1071 1057.7684,-11066.7227 1078.8531,-11062.985 1149.0681,-11050.1071 1273.4246,-11027.2992 1628.8422,-11048.179 1710.019,-11145.1071 1794.2152,-11245.6403 1673.4659,-11624.8737 1746.019,-11734.1071 1972.0978,-12074.4832 2192.0088,-12073.1071 2600.6254,-12073.1071 2600.6254,-12073.1071 2600.6254,-12073.1071 2801.5291,-12073.1071 2912.937,-12073.1071 2943.3119,-12068.7307 3051.0454,-12097.1071 3107.0087,-12111.8475 3160.9747,-12207.2737 3169.983,-12150.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M3169.983,-12150.1071C3313.2056,-11234.6378 3367.7453,-8093.2346 3372.5002,-7803.5529"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3376.006,-7803.2197 3372.6694,-7793.1641 3369.007,-7803.1057 3376.006,-7803.2197"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge704" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M638.193,-10958.9922C644.5703,-10955.5392 650.2959,-10951.02 654.4731,-10945.1071 726.1194,-10843.6913 658.0207,-6594.962 690.4731,-6475.1071 717.2553,-6376.1942 766.755,-6370.098 805.1968,-6275.1071 829.621,-6214.7542 823.2281,-6195.6862 841.1968,-6133.1071 950.1935,-5753.5073 1041.0458,-5675.4228 1113.0681,-5287.1071 1126.1376,-5216.6416 1103.3866,-4698.3285 1149.0681,-4643.1071 1150.3648,-4641.5396 1151.7589,-4640.0791 1153.2366,-4638.7186"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="1155.3472,-4641.5107 1161.2569,-4632.7172 1151.1534,-4635.906 1155.3472,-4641.5107"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-9071.1071C1645.8401,-9038.1777 1686.9052,-9080.9753 1710.019,-9052.1071 1773.3047,-8973.0661 1729.8807,-5507.0677 1746.019,-5407.1071 1757.897,-5333.5348 1790.152,-5250.6563 1805.9655,-5212.8746"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1809.2763,-5214.0321 1809.9591,-5203.4593 1802.832,-5211.2987 1809.2763,-5214.0321"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-9482.1071C765.5912,-9455.6514 788.7589,-9466.4015 805.1968,-9439.1071 858.1232,-9351.2251 769.3778,-9284.3633 841.1968,-9211.1071 952.8879,-9097.1808 1390.8586,-9112.6919 1547.9993,-9085.1071 1565.9932,-9081.9484 1620.6946,-9087.3744 1629.0092,-9071.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge452" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.22,-10981.4908C602.1274,-11043.6097 672.0549,-11340.5539 747.835,-11387.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-11387.1071C803.7218,-11421.4395 797.2792,-11155.8235 841.1968,-11107.1071 880.1305,-11063.9191 922.6686,-11101.0857 962.9033,-11059.1071 996.7489,-11023.7946 959.0592,-10983.4786 998.9033,-10955.1071 1040.2355,-10925.676 1062.5528,-10950.3382 1113.0681,-10955.1071 1146.6819,-10958.2804 1687.7417,-11043.7363 1710.019,-11069.1071 1798.1518,-11169.4784 1679.0498,-11553.535 1746.019,-11669.1071 1792.3462,-11749.0561 1831.3423,-11756.6684 1919.8806,-11783.1071 2273.8506,-11888.8071 2478.1355,-11767.0974 2686.5776,-11462.1071 3154.8316,-10776.9629 2591.5451,-10372.7178 2916.4805,-9609.1071 2953.6674,-9521.7164 3018.9242,-9532.4839 3051.0454,-9443.1071 3089.2931,-9336.6836 3035.9451,-5472.9912 3087.0454,-5372.1071 3097.2834,-5351.8949 3117.5424,-5336.5571 3135.4741,-5326.1932"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3137.4723,-5329.09 3144.5737,-5321.2274 3134.119,-5322.9454 3137.4723,-5329.09"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M643.6512,-10959.4296C674.9883,-10952.8455 714.0787,-10943.3139 747.835,-10931.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-10931.1071C773.8236,-10921.7092 787.6918,-10928.4918 805.1968,-10907.1071 856.8738,-10843.9764 796.7244,-10795.5045 841.1968,-10727.1071 877.3012,-10671.5793 909.5174,-10680.3092 962.9033,-10641.1071 1046.7802,-10579.515 1055.0131,-10543.633 1149.0681,-10499.1071 1298.8965,-10428.1779 1351.618,-10455.0281 1511.9993,-10413.1071 1771.4992,-10345.2781 1848.0522,-10358.1369 2092.2107,-10247.1071 2183.7249,-10205.4915 2232.9676,-10211.8473 2282.0427,-10124.1071 2322.5983,-10051.5987 2263.8164,-8692.0494 2318.0427,-8629.1071 2341.6927,-8601.6558 2387.8315,-8649.7783 2398.3579,-8615.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M747.835,-10931.1071C842.2132,-10899.6631 874.25,-10914.2355 962.9033,-10869.1071 980.9673,-10859.9117 979.7307,-10847.6854 998.9033,-10841.1071 1149.2268,-10789.5299 1587.247,-10816.1893 1710.019,-10917.1071 1742.9814,-10944.2019 1720.2824,-10972.0738 1746.019,-11006.1071 1805.0278,-11084.1385 1829.9599,-11102.5687 1919.8806,-11141.1071 2084.3692,-11211.6039 2139.584,-11187.7364 2318.0427,-11201.1071 2485.7665,-11213.6735 2591.7642,-11254.03 2686.5776,-11115.1071 2745.3714,-11028.961 2666.2346,-9325.8757 2722.5776,-9238.1071 2764.6523,-9172.5651 2838.2989,-9227.5804 2880.4805,-9162.1071 2928.7543,-9087.1776 2910.2851,-7647.0251 2916.4805,-7558.1071 2931.5714,-7341.5156 2969.2234,-7080.9632 2980.5132,-7005.5225"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2984.0095,-7005.8083 2982.0368,-6995.3988 2977.0875,-7004.7665 2984.0095,-7005.8083"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M747.835,-9482.1071C765.4811,-9455.5779 787.7344,-9465.7577 805.1968,-9439.1071 843.2457,-9381.0379 792.0053,-9336.0964 841.1968,-9287.1071 842.2941,-9286.0143 1709.0487,-9086.314 1710.019,-9085.1071 1736.06,-9052.7191 1743.5167,-6134.5903 1746.019,-6093.1071 1760.5475,-5852.2621 1800.4097,-5561.9613 1811.8454,-5481.6135"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1815.3674,-5481.7083 1813.32,-5471.3132 1808.4381,-5480.7162 1815.3674,-5481.7083"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge406" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M747.835,-10931.1071C773.9394,-10922.0359 784.6746,-10925.6158 805.1968,-10907.1071 830.0093,-10884.729 818.977,-10866.0615 841.1968,-10841.1071 885.242,-10791.6412 919.607,-10805.2299 962.9033,-10755.1071 986.0311,-10728.3328 973.5429,-10708.777 998.9033,-10684.1071 1102.8912,-10582.9506 1173.8753,-10592.6724 1317.5017,-10613.1071 1497.3514,-10638.6956 1541.5475,-10659.1512 1710.019,-10727.1071 1870.2986,-10791.7587 2236.3964,-11149.4215 2398.3579,-11089.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2398.3579,-11089.1071C2445.1589,-11069.6175 2454.0633,-11052.4302 2478.6731,-11008.1071 2512.3738,-10947.411 2463.869,-10903.4219 2514.6731,-10856.1071 2542.9966,-10829.7289 2580.683,-10875.2784 2600.6254,-10842.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge437" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M747.835,-9482.1071C788.7446,-9420.824 789.822,-9566.288 841.1968,-9619.1071 901.4987,-9681.1043 916.6173,-9706.4805 998.9033,-9733.1071 1225.3783,-9806.3913 2247.1029,-9656.343 2282.0427,-9618.1071 2317.0378,-9579.8108 2312.8312,-5934.7221 2318.0427,-5883.1071 2333.4488,-5730.5246 2377.4129,-5550.4699 2392.8879,-5490.0495"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2396.3215,-5490.7509 2395.4326,-5480.1935 2389.5438,-5489.001 2396.3215,-5490.7509"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-9482.1071C765.2305,-9455.4129 789.0613,-9466.5813 805.1968,-9439.1071 865.6126,-9336.2362 768.6294,-9267.7985 841.1968,-9173.1071 911.0257,-9081.989 1212.2499,-9018.9399 1317.5017,-8973.1071 1369.0229,-8950.6717 1378.4071,-8906.8039 1432.7505,-8921.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M638.1019,-10958.9273C644.4922,-10955.4835 650.2457,-10950.9842 654.4731,-10945.1071 747.5433,-10815.7198 605.2843,-9645.8141 690.4731,-9511.1071 705.7419,-9486.963 732.0137,-9505.8929 747.835,-9482.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M747.835,-9482.1071C781.164,-9431.6399 788.9646,-9550.6184 841.1968,-9581.1071 871.6268,-9598.8696 1114.091,-9652.8538 1149.0681,-9657.1071 1246.8397,-9668.9964 2243.7178,-9621.2523 2282.0427,-9580.1071 2321.1501,-9538.1219 2305.8463,-5505.173 2318.0427,-5449.1071 2331.4245,-5387.5923 2367.0501,-5321.5333 2386.0388,-5289.2291"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2389.2312,-5290.7097 2391.3546,-5280.3298 2383.2217,-5287.12 2389.2312,-5290.7097"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1055.9857,-11729.1071C1071.3752,-11751.9233 1093.5409,-11733.7138 1113.0681,-11753.1071 1141.8877,-11781.7289 1118.6846,-11810.1512 1149.0681,-11837.1071 1265.7293,-11940.6074 1697.0578,-11958.224 1919.8806,-11973.1071 1996.3015,-11978.2115 2023.685,-12007.3187 2092.2107,-11973.1071 2220.0681,-11909.274 2420.6045,-11589.6836 2478.6731,-11459.1071 2512.71,-11382.5696 2481.4478,-11351.0004 2514.6731,-11274.1071 2566.573,-11153.9954 2645.7355,-11159.4146 2686.5776,-11035.1071 2714.0738,-10951.4194 2670.1308,-7934.8814 2722.5776,-7864.1071 2731.3946,-7852.209 2745.8974,-7845.8381 2760.0834,-7842.4729"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.1101,-7845.8398 2770.2711,-7840.5176 2759.7906,-7838.9653 2761.1101,-7845.8398"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M902.05,-11615.1071C923.1995,-11635.056 940.6537,-11620.3932 962.9033,-11639.1071 986.4118,-11658.8798 976.6424,-11676.9398 998.9033,-11698.1071 1019.8247,-11718.0007 1039.1378,-11705.6633 1055.9857,-11729.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M638.1588,-10958.968C644.541,-10955.5185 650.2771,-10951.0067 654.4731,-10945.1071 694.6308,-10888.6467 677.908,-8519.2432 690.4731,-8451.1071 717.4186,-8304.9924 772.8957,-8282.1319 805.1968,-8137.1071 844.7719,-7959.4232 776.6014,-7899.2988 841.1968,-7729.1071 898.1109,-7579.1535 922.1721,-7527.5334 1055.9857,-7439.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11387.1071C1069.6262,-11322.5297 1580.0716,-11494.0654 1710.019,-11370.1071 1752.4877,-11329.5958 1726.6753,-10898.5198 1746.019,-10843.1071 1781.6008,-10741.1786 1840.3633,-10741.9085 1883.8806,-10643.1071 2050.2508,-10265.3813 2006.687,-10141.8911 2092.2107,-9738.1071 2109.6578,-9655.7337 2072.446,-9615.1949 2128.2107,-9552.1071 2132.1425,-9547.659 2136.8737,-9543.9982 2142.0329,-9540.986"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2143.6554,-9544.0881 2151.0541,-9536.5046 2140.5411,-9537.8191 2143.6554,-9544.0881"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M630.8278,-10959.0196C639.3014,-10955.5267 647.635,-10950.9859 654.4731,-10945.1071 679.8103,-10923.3247 674.2364,-10908.3101 690.4731,-10879.1071 723.4881,-10819.727 795.4095,-10663.3018 841.1968,-10613.1071 1158.9766,-10264.7387 1318.7595,-10258.591 1746.019,-10059.1071 1897.7996,-9988.242 1967.2805,-10021.694 2092.2107,-9910.1071 2116.2624,-9888.6242 2102.4776,-9866.5444 2128.2107,-9847.1071 2184.4061,-9804.6602 2238.0014,-9864.0618 2282.0427,-9809.1071 2337.4365,-9739.9868 2284.2601,-8296.9901 2318.0427,-8215.1071 2357.5645,-8119.3134 2439.2055,-8141.9231 2478.6731,-8046.1071 2549.6996,-7873.6752 2461.1888,-6546.7603 2514.6731,-6368.1071 2528.6478,-6321.4274 2563.1737,-6275.0791 2583.9662,-6250.0637"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.8893,-6252.0285 2590.6918,-6242.1395 2581.5524,-6247.4988 2586.8893,-6252.0285"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge499" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11501.1071C1220.118,-11673.0558 1530.4775,-11719.9517 1710.019,-11406.1071 1784.3769,-11276.1271 1706.3549,-11215.5047 1746.019,-11071.1071 1795.2136,-10892.0141 1835.5429,-10856.5808 1919.8806,-10691.1071 2068.6437,-10399.2285 2195.7281,-10365.1345 2282.0427,-10049.1071 2335.7431,-9852.4916 2293.791,-8417.4762 2318.0427,-8215.1071 2333.7997,-8083.6231 2376.2992,-7929.6798 2392.2224,-7874.8121"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.587,-7875.7761 2395.0369,-7865.1956 2388.8689,-7873.8098 2395.587,-7875.7761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-11387.1071C820.4598,-11431.722 831.2264,-11453.6849 902.05,-11501.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge597" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1055.9857,-11729.1071C1071.3812,-11751.9192 1097.3677,-11730.5038 1113.0681,-11753.1071 1168.1989,-11832.4769 1103.0272,-12537.1412 1149.0681,-12622.1071 1192.8587,-12702.9202 1242.8553,-12688.4762 1317.5017,-12742.1071 1420.2397,-12815.9209 1432.0154,-12858.5966 1547.9993,-12909.1071 1630.2385,-12944.922 1656.7433,-12939.3993 1746.019,-12948.1071 2057.1469,-12978.4539 2124.9925,-12836.7409 2398.3579,-12685.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge614" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M902.05,-11387.1071C938.0782,-11373.2232 939.9163,-11356.1294 962.9033,-11325.1071 982.796,-11298.2608 974.1103,-11281.5068 998.9033,-11259.1071 1019.3244,-11240.6573 1029.0574,-11229.4258 1055.9857,-11235.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge548" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-11501.1071C949.8837,-11533.1356 951.779,-11554.0438 998.9033,-11587.1071 1046.1694,-11620.2699 1062.4797,-11621.2744 1113.0681,-11649.1071 1220.2517,-11708.0772 1235.099,-11752.3404 1353.5017,-11783.1071 1421.6809,-11800.8233 1448.4749,-11813.5525 1511.9993,-11783.1071 1558.4031,-11760.8671 2069.0869,-11107.0769 2092.2107,-11061.1071 2120.6946,-11004.4816 2096.9802,-10978.2654 2128.2107,-10923.1071 2176.343,-10838.0974 2236.6979,-10852.6358 2282.0427,-10766.1071 2321.3287,-10691.14 2261.2671,-10641.8764 2318.0427,-10579.1071 2343.034,-10551.4776 2379.3731,-10587.1622 2398.3579,-10555.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge577" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M902.05,-11615.1071C923.9582,-11634.2197 936.3817,-11627.1966 962.9033,-11639.1071 1031.1391,-11669.7508 1059.0287,-11663.3877 1113.0681,-11715.1071 1136.6456,-11737.6724 1123.5485,-11758.7642 1149.0681,-11779.1071 1293.649,-11894.3592 1365.0111,-11870.6114 1547.9993,-11897.1071 1619.2649,-11907.426 1648.0988,-11933.865 1710.019,-11897.1071 1738.751,-11880.0508 1727.8886,-11859.1737 1746.019,-11831.1071 1774.5973,-11786.8669 2283.5347,-11114.8954 2318.0427,-11075.1071 2384.4759,-10998.5085 2430.8211,-11002.4989 2478.6731,-10913.1071 2534.3541,-10809.0901 2585.7317,-10432.6856 2597.9077,-10338.5579"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2601.395,-10338.8796 2599.1959,-10328.5155 2594.4519,-10337.9889 2601.395,-10338.8796"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M747.835,-11387.1071C852.0732,-11451.1428 813.0563,-11531.1649 902.05,-11615.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge662" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-13517.1071C3170.1399,-12691.2304 3026.2092,-11626.9787 3087.0454,-9571.1071 3107.8305,-8868.7039 3159.6678,-8007.2018 3168.6472,-7860.7449"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3172.1606,-7860.6327 3169.281,-7850.4368 3165.1738,-7860.2031 3172.1606,-7860.6327"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.342,-10981.1351C591.0712,-11062.4209 622.9789,-11569.3483 690.4731,-11705.1071 732.8266,-11790.2973 768.5778,-11795.6444 841.1968,-11857.1071 891.753,-11899.8965 923.1134,-11890.1579 962.9033,-11943.1071 992.2881,-11982.2099 964.7861,-12012.057 998.9033,-12047.1071 1036.7219,-12085.9597 1081.4377,-12046.0697 1113.0681,-12090.1071 1179.4195,-12182.4846 1112.6941,-13005.3433 1149.0681,-13113.1071 1190.5112,-13235.8888 1263.2352,-13233.4295 1317.5017,-13351.1071 1344.7665,-13410.2311 1321.6392,-13436.3286 1353.5017,-13493.1071 1402.7964,-13580.9496 1452.0946,-13574.1275 1511.9993,-13655.1071 1531.8706,-13681.9693 1521.7382,-13700.4479 1547.9993,-13721.1071 1785.6307,-13908.0485 1902.7763,-13897.1071 2205.1267,-13897.1071 2205.1267,-13897.1071 2205.1267,-13897.1071 2398.3579,-13897.1071 2437.1315,-13897.1071 2975.2275,-13554.9296 2983.7629,-13517.1071"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge644" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.6152,-10981.3734C592.5201,-11053.5654 627.5704,-11451.4471 690.4731,-11553.1071 769.9246,-11681.5123 846.7931,-11659.5729 962.9033,-11756.1071 1032.8344,-11814.2479 1074.8684,-11812.5753 1113.0681,-11895.1071 1152.1677,-11979.5832 1089.3898,-12660.6684 1149.0681,-12732.1071 1198.2674,-12791.0018 1257.3484,-12722.4548 1317.5017,-12770.1071 1346.1704,-12792.818 1335.8719,-12812.0623 1353.5017,-12844.1071 1432.8129,-12988.2674 1416.2151,-13060.5911 1547.9993,-13159.1071 1881.6419,-13408.5234 2062.1196,-13273.1123 2478.6731,-13270.1071 2624.38,-13269.0559 2711.982,-13328.0546 2801.5291,-13213.1071"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M618.974,-10577.0958C630.37,-10573.0387 643.109,-10568.185 654.4731,-10563.1071 677.1633,-10552.9684 701.9196,-10539.5975 720.235,-10529.2338"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="721.979,-10532.2684 728.9256,-10524.2686 718.5065,-10526.1904 721.979,-10532.2684"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.546,-10576.9421C592.5169,-10496.1259 629.5188,-9992.3026 654.4731,-9582.1071 659.0338,-9507.1391 647.2068,-8968.4995 690.4731,-8907.1071 706.3931,-8884.5176 734.7269,-8907.4363 747.835,-8883.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-8883.1071C886.0939,-8626.4918 1130.3979,-8781.6225 1317.5017,-8558.1071 1350.5206,-8518.6625 1314.3811,-8481.5093 1353.5017,-8448.1071 1535.0578,-8293.0899 1649.973,-8410.8583 1883.8806,-8363.1071 2056.2062,-8327.9276 2257.9198,-8273.9497 2349.1359,-8248.8375"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2350.2123,-8252.1714 2358.9211,-8246.1376 2348.3503,-8245.4236 2350.2123,-8252.1714"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-8883.1071C805.0141,-8791.2405 1129.3159,-8815.1175 1233.2849,-8845.1071"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge751" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3558.0076,-12882.1577C3574.7562,-12973.274 3689.9923,-13600.187 3712.7368,-13723.9224"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3709.3404,-13724.8056 3714.5907,-13734.0081 3716.2251,-13723.5401 3709.3404,-13724.8056"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge755" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1825.2432,-1076.8284C1842.9507,-1058.0064 1881.0345,-1020.0044 1919.8806,-997.1071 2215.314,-822.9683 3031.3778,-508.8131 3372.8452,-477.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3372.8452,-477.1071C3454.1527,-473.4074 3507.5753,-411.6706 3555.9763,-477.1071"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1826.7573,-1099.1789C1872.0381,-1142.5396 2034.9155,-1307.0102 2092.2107,-1481.1071 2121.3418,-1569.6249 2077.1473,-3080.1549 2128.2107,-3158.1071 2169.4725,-3221.0964 2240.216,-3166.4915 2282.0427,-3229.1071 2338.3734,-3313.4356 2256.3276,-4060.6355 2318.0427,-4141.1071 2320.5214,-4144.3391 2323.4133,-4147.1636 2326.5989,-4149.631"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2324.7482,-4152.602 2335.0546,-4155.0575 2328.529,-4146.7108 2324.7482,-4152.602"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge677" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1852.0174,-1077.0623C1862.6091,-1073.2735 1873.9624,-1068.5834 1883.8806,-1063.1071 1901.6253,-1053.3096 1901.7753,-1044.2209 1919.8806,-1035.1071 1955.389,-1017.233 1966.7254,-1005.2554 2006.0457,-1011.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2006.0457,-1011.1071C2064.4124,-1019.7934 2073.6685,-1040.5841 2128.2107,-1063.1071 2212.2106,-1097.7946 2232.2323,-1109.1775 2318.0427,-1139.1071 2353.2197,-1151.3764 2362.4768,-1153.0819 2398.3579,-1163.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2398.3579,-1163.1071C2452.6823,-1177.7742 2463.0097,-1190.8101 2514.6731,-1213.1071 2754.1262,-1316.4505 2882.7939,-1251.8358 3051.0454,-1451.1071 3277.0673,-1718.7997 3203.9433,-1866.1973 3252.9207,-2213.1071 3258.1317,-2250.0175 3364.6638,-7387.2749 3372.402,-7760.7122"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3368.904,-7760.8486 3372.6105,-7770.7739 3375.9025,-7760.7035 3368.904,-7760.8486"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge601" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2006.0457,-1011.1071C2059.432,-1019.9042 2061.4547,-1052.5924 2092.2107,-1097.1071 2114.3739,-1129.185 2106.2778,-1144.8713 2128.2107,-1177.1071 2183.3433,-1258.1379 2237.8007,-1247.6529 2282.0427,-1335.1071 2566.7722,-1897.9387 2397.3192,-2115.3666 2514.6731,-2735.1071 2548.8277,-2915.4761 2577.6281,-2956.979 2600.6254,-3139.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2600.6254,-3139.1071C2758.9754,-4327.8823 2664.1039,-4637.0425 2686.5776,-5836.1071 2687.4109,-5880.5653 2696.2058,-12203.3056 2722.5776,-12239.1071 2728.4,-12247.0114 2736.7332,-12252.4777 2745.8236,-12256.2442"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2744.9025,-12259.6289 2755.4973,-12259.5849 2747.1876,-12253.0123 2744.9025,-12259.6289"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge579" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1877.8549,-1093.7521C1943.3281,-1103.3118 2043.0347,-1129.0235 2092.2107,-1198.1071 2144.7764,-1271.9526 2119.9523,-1922.8402 2128.2107,-2013.1071 2173.3862,-2506.8922 2230.9932,-2624.8947 2282.0427,-3118.1071 2294.1735,-3235.3084 2275.1815,-3537.3518 2318.0427,-3647.1071 2359.5148,-3753.3051 2440.4788,-3739.6867 2478.6731,-3847.1071 2529.6054,-3990.3528 2507.6384,-9168.2389 2514.6731,-9320.1071 2532.8808,-9713.1842 2586.1524,-10191.1497 2598.1892,-10296.096"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2594.7155,-10296.5263 2599.3371,-10306.06 2601.6696,-10295.7251 2594.7155,-10296.5263"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge543" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1823.2378,-1099.2595C1838.7933,-1120.9635 1871.8755,-1170.982 1883.8806,-1219.1071 1937.0222,-1432.1367 1903.6076,-8904.1532 1919.8806,-9123.1071 1936.692,-9349.3057 1987.0516,-9620.227 2001.8887,-9696.946"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1998.4659,-9697.6804 2003.8118,-9706.8276 2005.337,-9696.3431 1998.4659,-9697.6804"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge758" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M2219.2805,-1492.8688C2332.2739,-1403.1529 3083.731,-806.5468 3087.0454,-805.1071 3204.8629,-753.9321 3260.1079,-823.6713 3372.8452,-762.1071"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3372.8452,-762.1071C3496.4426,-676.1261 3465.1386,-357.034 3555.9763,-477.1071"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2205.7147,-1515.3193C2211.2278,-1620.6523 2254.2661,-2447.5229 2282.0427,-3118.1071 2284.3963,-3174.9269 2283.5316,-4095.9075 2318.0427,-4141.1071 2320.5145,-4144.3444 2323.4009,-4147.173 2326.5824,-4149.6436"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2324.7262,-4152.6111 2335.0302,-4155.0762 2328.5124,-4146.7234 2324.7262,-4152.6111"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge691" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2282.3962,-1506.4536C2396.1653,-1509.347 2615.4044,-1512.7837 2801.5291,-1503.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2801.5291,-1503.1071C2842.8108,-1500.4455 2949.942,-1441.2867 2983.7629,-1465.1071"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge466" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2801.5291,-1503.1071C2841.9709,-1501.0045 2956.4336,-1473.2228 2983.7629,-1503.1071"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2205.7211,-1515.3191C2211.2928,-1620.6496 2254.7627,-2447.5025 2282.0427,-3118.1071 2301.347,-3592.6509 2292.4751,-3711.8595 2318.0427,-4186.1071 2341.1282,-4614.3143 2386.5922,-5136.5303 2396.4454,-5247.6805"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2392.9834,-5248.2635 2397.3552,-5257.9143 2399.9559,-5247.6436 2392.9834,-5248.2635"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge397" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2206.5351,-1515.3145C2214.8073,-1581.4541 2257.5504,-1927.5709 2282.0427,-2211.1071 2287.4278,-2273.4474 2288.6675,-2717.8586 2318.0427,-2773.1071 2360.3826,-2852.7393 2438.4618,-2816.3792 2478.6731,-2897.1071 2519.6574,-2979.3869 2459.0934,-6132.8912 2514.6731,-6206.1071 2520.1348,-6213.3019 2527.5474,-6218.5183 2535.7433,-6222.2838"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.6775,-6225.6238 2545.2675,-6225.9469 2537.1904,-6219.0904 2534.6775,-6225.6238"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge761" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1821.352,-1227.8849C1835.8528,-1203.391 1873.5716,-1144.6525 1919.8806,-1111.1071 1959.3526,-1082.5143 3526.5703,-438.2371 3555.9763,-477.1071"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1819.3984,-1250.3701C1833.2383,-1285.1768 1877.1702,-1393.925 1919.8806,-1481.1071 1989.9157,-1624.0653 2050.7446,-1641.4109 2092.2107,-1795.1071 2133.7268,-1948.9886 2075.002,-3078.8675 2128.2107,-3229.1071 2165.648,-3334.8148 2243.2649,-3323.8838 2282.0427,-3429.1071 2309.4338,-3503.4327 2269.4906,-4078.5191 2318.0427,-4141.1071 2320.5392,-4144.3253 2323.4451,-4147.139 2326.6414,-4149.5982"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2324.8051,-4152.5783 2335.1173,-4155.0091 2328.5718,-4146.6781 2324.8051,-4152.5783"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge687" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2205.1267,-1163.1071C2290.6531,-1170.8983 2315.6452,-1139.9972 2398.3579,-1163.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1832.3203,-1227.9299C1852.4869,-1215.5788 1887.1756,-1196.2295 1919.8806,-1187.1071 2042.4267,-1152.9253 2078.4273,-1151.5652 2205.1267,-1163.1071"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge462" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-1163.1071C2240.7685,-1166.5784 2248.6157,-1174.2611 2282.0427,-1187.1071 2571.7874,-1298.4564 2629.0311,-1361.9597 2916.4805,-1479.1071 2945.8814,-1491.0892 2962.337,-1479.6781 2983.7629,-1503.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-1503.1071C3130.4655,-1642.2983 3166.8045,-4987.8163 3169.777,-5288.5329"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3166.2811,-5288.9747 3169.8785,-5298.9401 3173.2807,-5288.9064 3166.2811,-5288.9747"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1817.1954,-1250.398C1838.906,-1360.0192 2012.4506,-2246.5564 2092.2107,-2973.1071 2099.4745,-3039.2743 2087.1764,-3518.6948 2128.2107,-3571.1071 2172.3618,-3627.5005 2237.7992,-3562.7861 2282.0427,-3619.1071 2321.0391,-3668.7486 2313.7083,-4123.1292 2318.0427,-4186.1071 2347.4868,-4613.9241 2388.0104,-5136.4432 2396.6827,-5247.666"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2393.2143,-5248.2092 2397.4818,-5257.9065 2400.1931,-5247.6645 2393.2143,-5248.2092"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge507" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1815.6294,-1250.3815C1821.0301,-1338.852 1858.404,-1930.6483 1919.8806,-2408.1071 1991.1899,-2961.9319 1923.6557,-3127.5264 2128.2107,-3647.1071 2173.6678,-3762.5707 2245.8028,-3761.4275 2282.0427,-3880.1071 2313.7717,-3984.0142 2270.062,-7693.6327 2318.0427,-7791.1071 2328.0398,-7811.4165 2348.0561,-7827.1433 2365.6043,-7837.8044"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2364.0762,-7840.9631 2374.4897,-7842.9151 2367.5664,-7834.8952 2364.0762,-7840.9631"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge607" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1877.4902,-1248.9595C1985.4388,-1269.8501 2202.7753,-1330.0008 2282.0427,-1484.1071 2339.8573,-1596.5063 2266.2351,-2505.8158 2318.0427,-2621.1071 2358.329,-2710.7591 2425.8563,-2690.2165 2478.6731,-2773.1071 2570.81,-2917.7065 2578.4496,-2969.0882 2600.6254,-3139.1071"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge542" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1815.3228,-1250.255C1819.9059,-1387.735 1865.4981,-2769.7549 1883.8806,-3887.1071 1893.4509,-4468.8199 1876.0868,-8542.9662 1919.8806,-9123.1071 1936.9545,-9349.286 1987.131,-9620.2211 2001.9067,-9696.9446"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1998.4831,-9697.6754 2003.8217,-9706.8269 2005.3552,-9696.3436 1998.4831,-9697.6754"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge717" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3372.8452,-12188.1071C3435.6211,-12450.9407 3525.8345,-12766.7388 3549.8911,-12850.104"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3546.5838,-12851.2664 3552.7229,-12859.9013 3553.3085,-12849.3227 3546.5838,-12851.2664"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-6297.1071C2044.8401,-6296.5984 2061.2603,-6287.7118 2092.2107,-6311.1071 2122.3474,-6333.8874 2103.157,-6359.8322 2128.2107,-6388.1071 2448.8516,-6749.9737 2765.2623,-6574.125 3051.0454,-6964.1071 3263.7256,-7254.3324 3202.8857,-7391.7925 3252.9207,-7748.1071 3390.1758,-8725.5437 3143.5507,-11228.0835 3372.8452,-12188.1071"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1820.5925,-6438.8618C1834.1049,-6411.3669 1868.3466,-6338.2235 1883.8806,-6273.1071 1903.0501,-6192.7515 1866.7836,-5966.3937 1919.8806,-5903.1071 1945.4317,-5872.6527 1987.29,-5914.1579 2006.0457,-5879.1071"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2006.0457,-5879.1071C2039.2755,-5817.0068 2067.6993,-5812.1364 2092.2107,-5746.1071 2133.269,-5635.5032 2082.7196,-5591.9628 2128.2107,-5483.1071 2171.4509,-5379.6376 2240.478,-5387.261 2282.0427,-5283.1071 2365.9545,-5072.8388 2393.3435,-4324.8508 2397.7061,-4187.7682"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2401.2169,-4187.4714 2398.0297,-4177.3673 2394.2203,-4187.2536 2401.2169,-4187.4714"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge488" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M3169.983,-5386.1071C3204.6722,-5358.2707 3230.5943,-5368.5744 3252.9207,-5330.1071 3335.946,-5187.0583 3368.1722,-3931.5822 3372.3649,-3752.364"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3375.8645,-3752.4181 3372.5962,-3742.34 3368.8664,-3752.2565 3375.8645,-3752.4181"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M2006.0457,-5879.1071C2035.1105,-5824.7903 2225.4187,-5877.3724 2282.0427,-5853.1071 2388.4954,-5807.4885 2411.7834,-5776.6534 2478.6731,-5682.1071 2648.9768,-5441.3885 2478.7402,-5230.9146 2722.5776,-5065.1071 2780.6108,-5025.6451 2817.4211,-5034.3075 2880.4805,-5065.1071 3053.1076,-5149.4222 3020.1438,-5506.346 3169.983,-5386.1071"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge678" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2006.0457,-6297.1071C2044.8097,-6298.7247 2057.4278,-6293.9193 2092.2107,-6311.1071 2111.9411,-6320.8568 2108.8423,-6334.6566 2128.2107,-6345.1071 2282.343,-6428.2712 2340.1054,-6407.9952 2514.6731,-6422.1071 2590.8267,-6428.2633 2629.2346,-6472.5951 2686.5776,-6422.1071 2733.9934,-6380.3596 2694.1285,-6196.5142 2722.5776,-6140.1071 2794.939,-5996.6337 2848.7699,-5977.2718 2983.7629,-5890.1071"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge454" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-6297.1071C2235.7018,-6314.3015 2285.5081,-6373.2817 2514.6731,-6396.1071 2590.6989,-6403.6795 2630.7257,-6448.2399 2686.5776,-6396.1071 2771.5782,-6316.7667 2648.8432,-5964.0139 2722.5776,-5874.1071 2768.7013,-5817.8671 2834.0926,-5887.1294 2880.4805,-5831.1071 2945.7326,-5752.3026 2850.2091,-5450.0565 2916.4805,-5372.1071 2958.7003,-5322.4475 3033.5247,-5309.0219 3090.9755,-5306.7885"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3091.2279,-5310.2829 3101.1251,-5306.5018 3091.0302,-5303.2857 3091.2279,-5310.2829"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1863.2424,-6439.0979C1870.8916,-6435.6311 1878.154,-6431.0797 1883.8806,-6425.1071 1920.6531,-6386.7549 1879.6905,-6345.8615 1919.8806,-6311.1071 1949.2275,-6285.7294 1967.2816,-6295.4895 2006.0457,-6297.1071"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1832.132,-6461.2244C1909.021,-6511.3004 2220.4278,-6717.6926 2282.0427,-6815.1071 2534.7663,-7214.6681 2408.3661,-7392.4369 2514.6731,-7853.1071 2544.6298,-7982.9216 2582.1076,-8138.5346 2595.5428,-8194.1143"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.1469,-8194.9624 2597.8999,-8203.8592 2598.9507,-8193.3166 2592.1469,-8194.9624"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2006.0457,-5879.1071C2104.9572,-5700.1833 2174.861,-5685.2028 2282.0427,-5511.1071 2330.1314,-5432.9965 2373.0153,-5331.9854 2390.2836,-5289.4289"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2393.5353,-5290.7237 2394.0212,-5280.14 2387.0413,-5288.1106 2393.5353,-5290.7237"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1865.1926,-6438.9383C1872.2546,-6435.4969 1878.8182,-6430.9953 1883.8806,-6425.1071 1937.0682,-6363.2437 1875.7019,-6313.6945 1919.8806,-6245.1071 1945.4285,-6205.444 1961.9301,-6199.8305 2006.0457,-6183.1071"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge537" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1815.7893,-6461.1853C1822.2537,-6546.9297 1864.3875,-7113.7168 1883.8806,-7575.1071 1912.9296,-8262.6798 1862.4608,-8437.3207 1919.8806,-9123.1071 1938.8059,-9349.1386 1987.6905,-9620.1765 2002.0335,-9696.9345"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1998.6047,-9697.6397 2003.8914,-9706.8213 2005.4843,-9696.3469 1998.6047,-9697.6397"/>
</g>
<!-- sourcefile~radiantsystemlowtemp.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge718" class="edge">
<title>sourcefile~radiantsystemlowtemp.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.5002,-4155.0992C2400.2089,-4030.3101 2418.4613,-2880.4833 2514.6731,-2555.1071 2611.187,-2228.7092 3116.0218,-1524.7306 3252.9207,-1213.1071 3320.0727,-1060.2485 3235.4686,-762.224 3372.8452,-857.1071"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge720" class="edge">
<title>sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.4805,-11703.4637C1438.0172,-11770.4265 1464.9272,-12120.0535 1547.9993,-12391.1071 1598.4644,-12555.7686 1664.1333,-12577.1112 1710.019,-12743.1071 1749.5634,-12886.1626 1674.2392,-12945.1983 1746.019,-13075.1071 1956.6748,-13456.3566 2103.2545,-13540.0624 2514.6731,-13683.1071 2828.2586,-13792.1366 3057.2133,-13837.2897 3252.9207,-13569.1071 3300.0073,-13504.5831 3281.9,-12930.676 3288.9207,-12851.1071 3315.0261,-12555.2385 3303.3435,-11899.3352 3372.8452,-12188.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge772" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M399.8953,-2449.333C407.1248,-2549.896 460.6962,-3306.4513 480.9653,-3921.1071 505.4439,-4663.4134 450.4559,-6523.3813 516.9653,-7263.1071 530.2531,-7410.8948 567.5227,-7586.0201 580.8798,-7645.8524"/>
<polygon fill="#00cbff" stroke="#00cbff" points="577.5411,-7646.9585 583.1516,-7655.9459 584.3703,-7645.4214 577.5411,-7646.9585"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge721" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.7827,-2426.8845C409.9421,-2366.1087 454.0218,-2070.1697 480.9653,-1827.1071 491.0421,-1736.2022 483.1304,-1502.0802 516.9653,-1417.1071 602.7783,-1201.5962 690.7516,-1184.6717 841.1968,-1008.1071 893.1629,-947.1189 926.6699,-946.5717 962.9033,-875.1071 999.7966,-802.3411 952.8132,-762.425 998.9033,-695.1071 1080.6509,-575.7089 1411.9675,-394.442 1547.9993,-345.1071 2176.8398,-117.0441 2398.3956,-276.4736 3051.0454,-423.1071 3142.2476,-443.5979 3167.3277,-444.5364 3252.9207,-482.1071 3349.812,-524.6372 3404.3774,-513.1736 3456.7698,-605.1071 3539.0748,-749.5286 3555.2137,-12289.3856 3555.9492,-12849.9966"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3552.4492,-12850.0095 3555.9623,-12860.0049 3559.4491,-12850.0003 3552.4492,-12850.0095"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.3526,-2449.4923C402.4245,-2575.906 432.3719,-3714.761 516.9653,-3835.1071 555.6231,-3890.1032 595.3495,-3866.1166 654.4731,-3898.1071 866.3609,-4012.7549 984.1283,-3983.6001 1113.0681,-4187.1071 1183.9963,-4299.0538 1062.9755,-4382.3553 1149.0681,-4483.1071 1199.6355,-4542.2846 1269.9078,-4469.5128 1317.5017,-4531.1071 1371.6954,-4601.2425 1306.3864,-6051.0333 1353.5017,-6126.1071 1395.5541,-6193.1135 1445.5786,-6164.1354 1511.9993,-6207.1071 1626.2833,-6281.0446 1748.7178,-6389.4847 1795.3779,-6432.0308"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1793.2061,-6434.7878 1802.9448,-6438.96 1797.9335,-6429.6253 1793.2061,-6434.7878"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M400.0267,-2427.0279C404.2536,-2385.1857 425.4872,-2236.1665 516.9653,-2177.1071 550.5898,-2155.3987 1138.4032,-2123.8038 1317.5017,-2215.1071 1438.6938,-2276.8901 2038.8001,-3037.9993 2092.2107,-3163.1071 2143.8979,-3284.1782 2078.3143,-3335.287 2128.2107,-3457.1071 2149.4631,-3508.994 2185.0897,-3504.7388 2205.1267,-3557.1071"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2205.1267,-3557.1071C2218.8557,-3589.0264 2258.9514,-3545.1434 2282.0427,-3571.1071 2366.3888,-3665.9448 2239.6212,-4041.3148 2318.0427,-4141.1071 2320.5594,-4144.3096 2323.481,-4147.111 2326.6894,-4149.5607"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2324.8694,-4152.551 2335.1882,-4154.9538 2328.62,-4146.6406 2324.8694,-4152.551"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge680" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M585.7192,-1773.1071C601.6935,-1744.9584 633.6399,-1773.8761 654.4731,-1749.1071 717.6838,-1673.9548 657.9107,-1623.7524 690.4731,-1531.1071 735.7868,-1402.1825 773.5229,-1381.83 841.1968,-1263.1071 875.8923,-1202.2394 951.8897,-1042.053 998.9033,-990.1071 1129.1628,-846.182 1173.3666,-807.4489 1353.5017,-735.1071 1659.9479,-612.0391 1763.5858,-622.5386 2092.2107,-655.1071 2177.8348,-663.5929 2199.4265,-669.0644 2282.0427,-693.1071 2754.0701,-830.4751 3005.5218,-798.2853 3252.9207,-1223.1071 3288.2631,-1283.7954 3287.6897,-3680.8885 3288.9207,-3751.1071 3318.5403,-5440.7647 3366.9334,-7528.56 3372.3481,-7760.8251"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3368.8529,-7761.0753 3372.5853,-7770.9909 3375.851,-7760.912 3368.8529,-7761.0753"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M402.8341,-2427.0794C415.7513,-2388.6711 458.8167,-2257.0213 480.9653,-2145.1071 507.2936,-2012.0735 457.8639,-1964.165 516.9653,-1842.1071 535.8323,-1803.1426 565.4684,-1811.3706 585.7192,-1773.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-3747.1071C2037.1387,-3782.9369 2060.8359,-3774.5238 2092.2107,-3810.1071 2114.0512,-3834.8772 2102.7335,-3854.0956 2128.2107,-3875.1071 2135.058,-3880.7542 2143.2133,-3885.1367 2151.6132,-3888.535"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2150.5498,-3891.872 2161.1442,-3891.9683 2152.9222,-3885.2863 2150.5498,-3891.872"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.2776,-2437.4752C606.6934,-2437.298 1251.9859,-2461.5325 1511.9993,-2835.1071 1593.7584,-2952.5746 1464.5963,-3038.801 1547.9993,-3155.1071 1594.3498,-3219.7433 1647.4151,-3182.0465 1710.019,-3231.1071 1734.2006,-3250.0574 1871.1121,-3418.1638 1883.8806,-3446.1071 1921.5991,-3528.6526 1880.8782,-3565.1604 1919.8806,-3647.1071 1945.0932,-3700.0805 1967.5939,-3702.7977 2006.0457,-3747.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M423.341,-2449.2322C520.3181,-2493.6201 880.6063,-2657.6554 998.9033,-2699.1071 1016.2053,-2705.1698 1303.2444,-2773.5814 1317.5017,-2785.1071 1371.0324,-2828.3818 1857.8336,-3823.3906 1883.8806,-3887.1071 1940.3848,-4025.3279 1986.0509,-4199.7909 2000.9166,-4259.2017"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1997.5232,-4260.0594 2003.3295,-4268.9214 2004.3169,-4258.3727 1997.5232,-4260.0594"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.409,-2449.3173C402.9766,-2569.236 436.2611,-3613.001 516.9653,-3721.1071 602.2923,-3835.4055 1002.2343,-3869.3258 1113.0681,-3959.1071 1176.6142,-4010.5828 1291.0954,-4187.7084 1317.5017,-4265.1071 1355.1899,-4375.5739 1280.7775,-4697.8137 1353.5017,-4789.1071 1399.3615,-4846.6767 1461.1589,-4783.8846 1511.9993,-4837.1071 1556.9717,-4884.1867 1512.711,-4924.3919 1547.9993,-4979.1071 1609.2109,-5074.017 1727.1241,-5145.6123 1783.4709,-5176.043"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1782.1372,-5179.298 1792.609,-5180.9076 1785.4265,-5173.119 1782.1372,-5179.298"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge457" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-1735.1071C772.9398,-1723.5539 786.3105,-1731.2823 805.1968,-1711.1071 838.9114,-1675.0918 814.6286,-1647.6752 841.1968,-1606.1071 847.7293,-1595.8864 989.9357,-1463.2753 998.9033,-1455.1071 1137.4047,-1328.9531 1178.6139,-1304.8355 1317.5017,-1179.1071 1422.0357,-1084.4776 1416.9897,-1013.2472 1547.9993,-961.1071 1614.9041,-934.4798 1656.766,-912.6367 1710.019,-961.1071 1773.0755,-1018.5005 1695.7592,-1274.2299 1746.019,-1343.1071 1770.6779,-1376.9002 2060.1505,-1464.2337 2092.2107,-1491.1071 2114.6006,-1509.8747 2104.4924,-1529.0491 2128.2107,-1546.1071 2232.3323,-1620.9907 2566.5369,-1646.9509 2686.5776,-1692.1071 2776.7682,-1726.0344 2823.4651,-1711.4242 2880.4805,-1789.1071 2940.1421,-1870.3955 2878.3509,-1919.7613 2916.4805,-2013.1071 2955.6102,-2108.9015 3017.7837,-2105.1206 3051.0454,-2203.1071 3156.3546,-2513.34 3168.892,-5029.3084 3169.9067,-5288.5522"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3166.4079,-5288.9033 3169.9456,-5298.89 3173.4078,-5288.8769 3166.4079,-5288.9033"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1773.1071C594.8506,-1757.0165 731.3869,-1743.5777 747.835,-1735.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-1963.1071C1090.9087,-1901.7338 1204.3026,-1975.4335 1511.9993,-2139.1071 1779.7913,-2281.5541 2326.3841,-2882.4488 2398.3579,-3177.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M747.835,-1735.1071C851.3265,-1693.7153 889.7882,-1690.2378 962.9033,-1606.1071 987.1572,-1578.1991 975.4718,-1559.7091 998.9033,-1531.1071 1039.1607,-1481.9663 1062.6247,-1483.7198 1113.0681,-1445.1071 1129.1637,-1432.7865 1129.8955,-1423.6854 1149.0681,-1417.1071 1384.8852,-1336.1964 1472.0088,-1342.8956 1710.019,-1417.1071 1722.3371,-1420.9479 2081.8058,-1673.4766 2092.2107,-1681.1071 2108.5561,-1693.0942 2110.2479,-1699.7155 2128.2107,-1709.1071 2191.68,-1742.2912 2218.2354,-1724.5777 2282.0427,-1757.1071 2577.5673,-1907.7676 2730.2444,-1907.3666 2880.4805,-2203.1071 2927.0444,-2294.7684 2912.7829,-5801.3632 2916.4805,-5904.1071 2931.8481,-6331.1275 2973.0206,-6851.8974 2982.0126,-6962.7399"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2978.5435,-6963.2624 2982.8438,-6972.9453 2985.5204,-6962.6941 2978.5435,-6963.2624"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge410" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M747.835,-1811.1071C844.5579,-1787.8552 874.25,-1794.2355 962.9033,-1749.1071 980.9673,-1739.9117 981.7813,-1731.9562 998.9033,-1721.1071 1062.0879,-1681.0713 1076.3105,-1662.4702 1149.0681,-1645.1071 1221.8828,-1627.7303 1243.0772,-1637.0495 1317.5017,-1645.1071 1739.7507,-1690.822 1884.2304,-1720.8813 2205.1267,-1999.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge447" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M434.9749,-2427.08C489.5299,-2410.9263 596.8805,-2381.5126 690.4731,-2370.1071 967.5366,-2336.3433 1052.3007,-2318.0864 1317.5017,-2405.1071 1412.7051,-2436.3463 1439.4161,-2450.0329 1511.9993,-2519.1071 1621.2888,-2623.1132 1810.3969,-2955.3436 1883.8806,-3087.1071 2008.6464,-3310.8246 1935.2494,-3440.6376 2128.2107,-3609.1071 2155.1865,-3632.659 2197.1097,-3598.2056 2205.1267,-3633.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M747.835,-1963.1071C790.0306,-1954.4572 798.5202,-1942.9386 841.1968,-1937.1071 855.4595,-1935.1582 1102.4032,-1937.396 1113.0681,-1938.1071 1477.2025,-1962.3872 1579.95,-2019.0934 1883.8806,-2221.1071 2102.3881,-2366.3426 2114.1681,-2455.9587 2318.0427,-2621.1071 2386.0678,-2676.2107 2420.8381,-2669.3885 2478.6731,-2735.1071 2608.4399,-2882.5627 2638.1708,-2934.7407 2686.5776,-3125.1071 2746.3687,-3360.2436 2694.5016,-7251.1177 2722.5776,-7492.1071 2737.2259,-7617.8401 2778.998,-7764.5809 2795.0952,-7818.1674"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.7886,-7819.3244 2798.0393,-7827.8789 2798.4875,-7817.2936 2791.7886,-7819.3244"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M402.1012,-2426.9237C417.9455,-2368.4784 491.7552,-2099.7341 516.9653,-2071.1071 591.8327,-1986.0928 634.8512,-1971.3059 747.835,-1963.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge502" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M411.3269,-2449.1222C505.8221,-2534.5866 1125.682,-3103.2714 1511.9993,-3659.1071 1615,-3807.3052 1837.5544,-4206.6774 1883.8806,-4381.1071 1978.2031,-4736.2547 1842.1418,-4847.9647 1919.8806,-5207.1071 1963.2632,-5407.5283 2047.5629,-5434.964 2092.2107,-5635.1071 2154.24,-5913.1665 2080.8945,-5994.1697 2128.2107,-6275.1071 2169.6566,-6521.1897 2242.9762,-6568.6355 2282.0427,-6815.1071 2299.0311,-6922.2873 2268.7753,-7694.4173 2318.0427,-7791.1071 2328.3882,-7811.4107 2348.6039,-7827.2123 2366.1643,-7837.912"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2364.6292,-7841.0672 2375.0389,-7843.039 2368.1309,-7835.006 2364.6292,-7841.0672"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge551" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.7094,-2426.8447C402.8263,-2382.8496 420.679,-2221.7376 516.9653,-2155.1071 881.9147,-1902.5609 1140.7308,-1995.946 1511.9993,-2239.1071 1618.2374,-2308.6874 1625.3804,-2350.4273 1710.019,-2445.1071 1887.1677,-2643.272 1984.4808,-2662.1149 2092.2107,-2905.1071 2138.2436,-3008.9374 2078.4463,-3056.0127 2128.2107,-3158.1071 2171.4334,-3246.7808 2237.7345,-3229.9709 2282.0427,-3318.1071 2325.56,-3404.6699 2278.4232,-3444.6924 2318.0427,-3533.1071 2341.3535,-3585.1272 2385.5959,-3577.5498 2398.3579,-3633.1071"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge655" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M747.835,-1811.1071C795.4732,-1796.5582 799.2913,-1776.033 841.1968,-1749.1071 875.9098,-1726.8026 960.0624,-1665.0308 998.9033,-1651.1071 1296.5221,-1544.4166 1402.0396,-1598.6333 1710.019,-1670.1071 2192.7235,-1782.1299 2427.4172,-1785.7463 2686.5776,-2208.1071 2884.0199,-2529.8841 2835.6915,-2660.25 2880.4805,-3035.1071 2888.3554,-3101.0152 2878.3854,-7759.7503 2916.4805,-7814.1071 2919.368,-7818.2272 2923.0183,-7821.6696 2927.1189,-7824.5455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2925.6543,-7827.7406 2936.0685,-7829.6888 2929.1422,-7821.6714 2925.6543,-7827.7406"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.4796,-2427.0012C414.2386,-2388.3374 453.9761,-2255.9535 480.9653,-2145.1071 499.5447,-2068.8004 473.6959,-2037.6483 516.9653,-1972.1071 585.8865,-1867.7107 629.5789,-1851.9024 747.835,-1811.1071"/>
</g>
<!-- sourcefile~datashadowingcombinations.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~datashadowingcombinations.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/datashadowingcombinations.f90.html" xlink:title="DataShadowingCombinations.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3456.6944,-12882.1125 3288.996,-12882.1125 3288.996,-12860.1017 3456.6944,-12860.1017 3456.6944,-12882.1125"/>
<text text-anchor="middle" x="3372.8452" y="-12867.9571" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataShadowingCombinations.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge724" class="edge">
<title>sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3456.907,-12871.1071C3465.4635,-12871.1071 3474.108,-12871.1071 3482.5389,-12871.1071"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3482.6966,-12874.6072 3492.6965,-12871.1071 3482.6965,-12867.6072 3482.6966,-12874.6072"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge726" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1058.9199,-4266.8436C1068.8265,-4228.2151 1101.0842,-4097.4052 1113.0681,-3987.1071 1132.0596,-3812.3125 1105.4922,-2575.4449 1149.0681,-2405.1071 1189.3891,-2247.4926 1253.0707,-2229.4951 1317.5017,-2080.1071 1336.7068,-2035.5788 1332.9868,-2021.0473 1353.5017,-1977.1071 1411.7205,-1852.4102 1465.2004,-1840.5236 1511.9993,-1711.1071 1546.8859,-1614.6324 1505.108,-1576.2993 1547.9993,-1483.1071 1594.398,-1382.294 1666.4083,-1395.1573 1710.019,-1293.1071 1741.005,-1220.5992 1691.8514,-997.4081 1746.019,-940.1071 1937.3482,-737.7103 2705.701,-727.2058 2983.7629,-743.1071"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge418" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1058.6627,-4267.0883C1067.8722,-4228.7253 1098.482,-4097.351 1113.0681,-3987.1071 1143.3379,-3758.3233 1096.2582,-3693.761 1149.0681,-3469.1071 1203.4423,-3237.7988 1243.6144,-3185.7842 1353.5017,-2975.1071 1427.6797,-2832.8922 1407.6903,-2748.8301 1547.9993,-2671.1071 1833.687,-2512.8528 1997.3695,-2545.0351 2282.0427,-2705.1071 2416.6222,-2780.7812 2406.7064,-2852.7377 2514.6731,-2963.1071 2588.0854,-3038.1531 2644.0893,-3029.107 2686.5776,-3125.1071 2730.8343,-3225.1027 2715.5942,-4983.9787 2722.5776,-5093.1071 2740.2622,-5369.4602 2786.1815,-5703.2846 2798.4679,-5789.8135"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2795.0069,-5790.3355 2799.8845,-5799.7408 2801.9367,-5789.3466 2795.0069,-5790.3355"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1064.2575,-4289.2222C1077.098,-4307.1171 1101.5459,-4343.8835 1113.0681,-4379.1071 1134.2182,-4443.7633 1098.2155,-4637.9212 1149.0681,-4683.1071 1205.0277,-4732.8309 1259.8512,-4730.8601 1317.5017,-4683.1071 1383.6909,-4628.2814 1287.3125,-4547.9328 1353.5017,-4493.1071 1441.5192,-4420.2006 1920.7287,-4543.0507 2092.2107,-4685.1071 2286.679,-4846.2055 2373.3235,-5163.304 2393.5695,-5247.9309"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2390.213,-5248.9487 2395.8987,-5257.8886 2397.029,-5247.3543 2390.213,-5248.9487"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1058.5841,-4267.0775C1067.5367,-4228.6793 1097.4086,-4097.2037 1113.0681,-3987.1071 1125.7605,-3897.8717 1098.6375,-3657.8119 1149.0681,-3583.1071 1196.0965,-3513.4422 1269.3314,-3565.9873 1317.5017,-3497.1071 1392.9456,-3389.2275 1310.174,-3327.4151 1353.5017,-3203.1071 1408.03,-3046.6647 1414.2232,-2982.8391 1547.9993,-2885.1071 1816.3134,-2689.0864 2028.816,-2527.9496 2282.0427,-2743.1071 2357.5468,-2807.2602 2260.4169,-2882.5109 2318.0427,-2963.1071 2365.1419,-3028.9806 2433.7462,-2981.7333 2478.6731,-3049.1071 2524.5049,-3117.838 2506.2822,-3336.9238 2514.6731,-3419.1071 2587.6763,-4134.129 2643.0829,-4309.6854 2686.5776,-5027.1071 2719.7301,-5573.9393 2657.4517,-6948.1557 2722.5776,-7492.1071 2737.6257,-7617.7928 2779.1576,-7764.562 2795.143,-7818.1617"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.8329,-7819.3084 2798.0661,-7827.8757 2798.536,-7817.2913 2791.8329,-7819.3084"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1064.9174,-4289.3815C1078.4143,-4307.203 1103.4512,-4343.525 1113.0681,-4379.1071 1190.2763,-4664.7732 1098.8756,-6750.479 1149.0681,-7042.1071 1164.1414,-7129.6856 1205.2833,-7228.0842 1223.9058,-7269.7395"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1220.8146,-7271.3981 1228.1256,-7279.0662 1227.1922,-7268.5125 1220.8146,-7271.3981"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge729" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3373.0827,-3742.2237C3376.753,-3914.056 3422.2036,-6044.0087 3456.7698,-7762.1071 3500.1348,-9917.546 3550.5656,-12584.5703 3555.571,-12849.6353"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3552.0757,-12849.9226 3555.764,-12859.8548 3559.0745,-12849.7904 3552.0757,-12849.9226"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge731" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3051.2562,-12268.2153C3086.7318,-12269.3395 3130.8585,-12269.1052 3169.983,-12264.1071"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge732" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.628,-4648.7668C1444.1389,-4590.9862 1487.5055,-4323.4728 1511.9993,-4103.1071 1633.5625,-3009.4284 1631.1483,-2732.6909 1710.019,-1635.1071 1714.5436,-1572.1426 1707.0199,-1117.7465 1746.019,-1068.1071 1785.6707,-1017.6372 1827.0008,-1054.8419 1883.8806,-1025.1071 1901.8439,-1015.7165 1900.708,-1003.6854 1919.8806,-997.1071 1992.3261,-972.2505 2015.6587,-994.6591 2092.2107,-997.1071 2152.1789,-999.0247 3115.0426,-1090.2196 3169.983,-1066.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3169.983,-1066.1071C3284.3322,-1005.4309 3269.7406,-778.8333 3372.8452,-857.1071"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1438.2362,-4671.4149C1453.1839,-4702.8322 1494.6692,-4794.1971 1511.9993,-4875.1071 1560.7047,-5102.5006 1498.4765,-5169.8903 1547.9993,-5397.1071 1564.1492,-5471.2048 1600.9932,-5553.8284 1618.8855,-5591.444"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1615.9056,-5593.3231 1623.3966,-5600.8155 1622.213,-5590.287 1615.9056,-5593.3231"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1441.6609,-4671.4501C1460.2059,-4694.7338 1504.8278,-4749.0945 1547.9993,-4789.1071 1614.5052,-4850.7468 1657.2544,-4839.3616 1710.019,-4913.1071 1739.2154,-4953.9128 1728.6796,-4973.0234 1746.019,-5020.1071 1766.3832,-5075.4039 1792.8964,-5139.6288 1806.3329,-5171.6941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1803.1104,-5173.06 1810.2116,-5180.9228 1809.5636,-5170.3478 1803.1104,-5173.06"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge534" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1487.1741,-4671.1402C1496.085,-4674.6044 1504.7581,-4679.1488 1511.9993,-4685.1071 1537.8006,-4706.3376 1522.0125,-4730.104 1547.9993,-4751.1071 1606.4093,-4798.3156 1645.8658,-4760.0592 1710.019,-4799.1071 1733.8397,-4813.6059 1873.3564,-4954.2831 1883.8806,-4980.1071 1927.3147,-5086.6841 1911.1134,-9008.3538 1919.8806,-9123.1071 1937.1596,-9349.2704 1987.193,-9620.2164 2001.9207,-9696.9436"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1998.4965,-9697.6714 2003.8294,-9706.8263 2005.3695,-9696.344 1998.4965,-9697.6714"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge735" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3373.2485,-7793.3139C3382.3538,-8046.3396 3542.7132,-12502.5402 3555.2059,-12849.699"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3551.7097,-12849.8679 3555.5671,-12859.7356 3558.7051,-12849.6161 3551.7097,-12849.8679"/>
</g>
<!-- sourcefile~pollutionanalysismodule.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge737" class="edge">
<title>sourcefile~pollutionanalysismodule.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1300.9751,-4610.9712C1307.3577,-4607.4687 1313.0812,-4602.9426 1317.5017,-4597.1071 1401.5769,-4486.1198 1289.1046,-2214.5568 1353.5017,-2091.1071 1393.6339,-2014.1735 1469.1411,-2052.5561 1511.9993,-1977.1071 1558.0485,-1896.0404 1494.6618,-1635.5758 1547.9993,-1559.1071 1593.5018,-1493.8712 1664.9565,-1548.6477 1710.019,-1483.1071 1772.6305,-1392.0426 1675.4782,-1072.1772 1746.019,-987.1071 1797.0395,-925.5781 1840.9481,-953.6995 1919.8806,-941.1071 1999.726,-928.3691 3308.6561,-807.9411 3372.8452,-857.1071"/>
</g>
<!-- sourcefile~datacostestimate.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge739" class="edge">
<title>sourcefile~datacostestimate.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M456.1737,-1728.4775C465.7508,-1724.6974 474.6228,-1719.1664 480.9653,-1711.1071 564.8069,-1604.5721 431.7084,-1207.5128 516.9653,-1102.1071 556.8396,-1052.8093 606.8701,-1105.99 654.4731,-1064.1071 674.6017,-1046.3973 823.9956,-639.6721 841.1968,-619.1071 1081.355,-331.9846 1194.9076,-285.3713 1547.9993,-161.1071 1704.7184,-105.9526 1753.9547,-131.5625 1919.8806,-123.1071 2080.633,-114.9153 2122.9195,-98.8537 2282.0427,-123.1071 2417.2938,-143.722 3375.8527,-381.7882 3456.7698,-492.1071 3506.3797,-559.7432 3553.6251,-12280.231 3555.8913,-12849.6638"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3552.3919,-12849.8437 3555.9317,-12859.8297 3559.3919,-12849.8159 3552.3919,-12849.8437"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge743" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3372.8452,-857.1071C3503.9332,-953.5547 3553.5099,-12287.9396 3555.886,-12849.5255"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3552.3875,-12849.9024 3555.9297,-12859.8875 3559.3874,-12849.8729 3552.3875,-12849.9024"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M910.2417,-1456.8793C940.6549,-1415.3522 1050.4208,-1266.8791 1149.0681,-1151.1071 1220.3375,-1067.4656 1253.2605,-1059.2603 1317.5017,-970.1071 1337.0354,-942.9985 1333.6939,-931.0161 1353.5017,-904.1071 1354.6626,-902.53 1744.4995,-500.3424 1746.019,-499.1071 1816.9709,-441.4279 1832.0549,-414.5572 1919.8806,-389.1071 2409.3788,-247.2605 2570.8954,-406.2712 3051.0454,-577.1071 3144.6479,-610.4106 3186.5503,-599.178 3252.9207,-673.1071 3285.3162,-709.1921 3262.7649,-735.2723 3288.9207,-776.1071 3316.8809,-819.7591 3331.0901,-826.3859 3372.8452,-857.1071"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-3177.1071C2425.6635,-3324.6867 2460.0792,-3356.1789 2478.6731,-3505.1071 2538.5277,-3984.5127 2456.5011,-7373.4944 2514.6731,-7853.1071 2530.7145,-7985.364 2576.6991,-8139.4839 2593.9662,-8194.3911"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.6589,-8195.5406 2597.0193,-8204.0138 2597.3311,-8193.4235 2590.6589,-8195.5406"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M938.0733,-1479.1814C1012.4889,-1502.9532 1187.1216,-1563.4123 1317.5017,-1645.1071 1725.7013,-1900.8807 1832.4443,-1997.4367 2092.2107,-2403.1071 2142.0827,-2480.991 2381.532,-3086.1675 2398.3579,-3177.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-6335.1071C1433.2815,-6335.9727 1547.1959,-6424.486 1547.9993,-6425.1071 1583.8689,-6452.8379 1585.8341,-6473.2673 1629.0092,-6487.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1234.0369,-4674.1284C1243.45,-4811.934 1338.3284,-6196.359 1353.5017,-6235.1071 1374.1793,-6287.9116 1403.0953,-6286.7703 1432.7505,-6335.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1432.7505,-3975.1071C1521.0996,-3909.4356 1811.2025,-4047.5749 1919.8806,-4065.1071 2080.2944,-4090.9854 2131.227,-4054.6351 2282.0427,-4115.1071 2300.3615,-4122.4523 2300.3896,-4132.281 2318.0427,-4141.1071 2326.1962,-4145.1836 2335.1487,-4148.7585 2344.0257,-4151.8341"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2342.9944,-4155.1793 2353.5873,-4154.9755 2345.1794,-4148.529 2342.9944,-4155.1793"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge481" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M3169.983,-1161.1071C3205.8654,-1189.9256 3231.3295,-1182.4638 3252.9207,-1223.1071 3314.7304,-1339.458 3366.7631,-3473.327 3372.3491,-3709.8586"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3368.8518,-3710.0209 3372.586,-3719.9359 3375.8499,-3709.8564 3368.8518,-3710.0209"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1283.7735,-4661.2131C1296.6646,-4658.1684 1309.2079,-4652.4537 1317.5017,-4642.1071 1367.5192,-4579.7103 1346.8483,-3282.7993 1353.5017,-3203.1071 1395.0365,-2705.6207 1454.818,-2587.0387 1511.9993,-2091.1071 1522.4247,-2000.6872 1504.1407,-1762.8621 1547.9993,-1683.1071 1591.6936,-1603.6508 1667.098,-1638.9838 1710.019,-1559.1071 1765.2662,-1456.2914 1675.1808,-1127.8716 1746.019,-1035.1071 1785.3953,-983.543 1826.8828,-1018.1006 1883.8806,-987.1071 1901.688,-977.424 1900.708,-965.6854 1919.8806,-959.1071 1992.3261,-934.2505 2016.1563,-950.0558 2092.2107,-959.1071 2284.0134,-981.9337 2325.1466,-1023.8373 2514.6731,-1061.1071 2803.7571,-1117.9546 2940.2751,-976.6201 3169.983,-1161.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge624" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1283.6287,-4661.0957C1296.5175,-4658.0491 1309.0958,-4652.3628 1317.5017,-4642.1071 1371.7253,-4575.9516 1327.5927,-3954.6269 1353.5017,-3873.1071 1373.3125,-3810.7747 1396.3332,-3803.4355 1432.7505,-3749.1071"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1432.7505,-3749.1071C1453.2414,-3718.5381 1487.5286,-3752.594 1511.9993,-3725.1071 1572.0549,-3657.6493 1503.4477,-3603.6717 1547.9993,-3525.1071 1716.7786,-3227.4724 1820.8383,-3169.4237 2128.2107,-3019.1071 2355.125,-2908.1375 2558.0209,-2907.6731 2686.5776,-3125.1071 2741.7037,-3218.3445 2874.8042,-4956.9411 2880.4805,-5065.1071 2920.4839,-5827.402 2837.6288,-11175.8468 2916.4805,-11935.1071 2928.7372,-12053.127 2964.031,-12191.4353 2977.9855,-12243.1789"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2974.6194,-12244.1387 2980.6234,-12252.8681 2981.3735,-12242.2998 2974.6194,-12244.1387"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge685" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2983.7629,-1465.1071C3009.7199,-1483.3888 3031.55,-1464.0489 3051.0454,-1489.1071 3103.2667,-1556.2292 3073.3924,-1786.1664 3087.0454,-1870.1071 3113.1963,-2030.8864 3100.9203,-2079.5801 3169.983,-2227.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1432.7505,-3217.1071C1444.425,-3161.6131 1491.7174,-3170.0648 1511.9993,-3117.1071 1558.661,-2995.2691 1518.3857,-2658.1695 1547.9993,-2531.1071 1645.119,-2114.3971 1680.0425,-1997.4475 1919.8806,-1643.1071 2188.6034,-1246.0919 2591.8109,-1189.0516 2983.7629,-1465.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M3169.983,-2227.1071C3296.0607,-2496.4256 3367.431,-7397.8442 3372.5493,-7760.8808"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3369.0497,-7760.9423 3372.6898,-7770.8921 3376.049,-7760.8439 3369.0497,-7760.9423"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1283.7702,-4661.2105C1296.6613,-4658.1657 1309.2053,-4652.4516 1317.5017,-4642.1071 1415.6218,-4519.7645 1251.1892,-3349.9659 1353.5017,-3231.1071 1376.8355,-3203.9996 1424.9323,-3252.0092 1432.7505,-3217.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1432.7505,-5573.1071C1441.5645,-5582.5979 1506.7169,-5594.2667 1559.5742,-5602.3548"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1559.2118,-5605.8397 1569.6224,-5603.8724 1560.2573,-5598.9182 1559.2118,-5605.8397"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1234.0736,-4674.2798C1241.0612,-4771.9527 1293.5295,-5478.7376 1353.5017,-5549.1071 1377.3726,-5577.1165 1407.7072,-5546.1409 1432.7505,-5573.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1233.9797,-4674.4353C1240.3837,-4779.1617 1289.5306,-5589.5234 1317.5017,-6247.1071 1320.1663,-6309.749 1315.6293,-7325.1392 1353.5017,-7375.1071 1355.8628,-7378.2222 1358.6117,-7380.958 1361.64,-7383.3598"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1359.9468,-7386.4342 1370.234,-7388.9688 1363.7727,-7380.5722 1359.9468,-7386.4342"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-3901.1071C1934.8434,-3906.4295 2075.6635,-3903.9061 2151.0229,-3901.8473"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2151.3154,-3905.3406 2161.213,-3901.5608 2151.1186,-3898.3433 2151.3154,-3905.3406"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1629.0092,-4129.1071C1762.6429,-4162.8459 1912.0165,-4233.0946 1975.1867,-4264.4303"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1973.7093,-4267.6046 1984.2199,-4268.9383 1976.8351,-4261.3413 1973.7093,-4267.6046"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1432.7505,-4089.1071C1450.9523,-4076.3019 1607.3095,-4124.1671 1629.0092,-4129.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1234.4394,-4674.1962C1244.2663,-4762.6344 1321.1825,-5349.1121 1629.0092,-5307.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-5307.1071C1665.0094,-5296.4265 1680.814,-5306.7113 1710.019,-5283.1071 1736.0058,-5262.104 1720.6729,-5238.8791 1746.019,-5217.1071 1750.3041,-5213.4263 1755.1748,-5210.2704 1760.2992,-5207.568"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1762.1382,-5210.5726 1769.7258,-5203.1781 1759.183,-5204.2269 1762.1382,-5210.5726"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1234.0602,-4674.4322C1241.1922,-4779.131 1295.6183,-5589.2927 1317.5017,-6247.1071 1337.3639,-6844.1637 1307.1839,-8339.5185 1353.5017,-8935.1071 1369.7958,-9144.6288 1414.9788,-9395.5252 1428.7286,-9468.9582"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1425.2983,-9469.6556 1430.5895,-9478.8346 1432.1773,-9468.3594 1425.2983,-9469.6556"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge461" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-3217.1071C1445.0589,-3161.7503 1489.6588,-3169.2298 1511.9993,-3117.1071 1557.2632,-3011.5014 1513.0611,-2970.5635 1547.9993,-2861.1071 1606.1498,-2678.9298 1643.088,-2640.2755 1746.019,-2479.1071 1783.3727,-2420.6192 2067.3234,-2018.4067 2128.2107,-1985.1071 2233.9662,-1927.2689 2277.8196,-1961.1071 2398.3579,-1961.1071 2398.3579,-1961.1071 2398.3579,-1961.1071 2600.6254,-1961.1071 2730.7458,-1961.1071 2796.3958,-1947.804 2880.4805,-2047.1071 2958.7115,-2139.4971 2840.324,-2222.9997 2916.4805,-2317.1071 2936.4527,-2341.787 2971.303,-2311.9055 2983.7629,-2341.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-3749.1071C1459.855,-3710.476 2236.4705,-3720.8518 2282.0427,-3733.1071 2379.5935,-3759.3405 2427.8513,-3759.8059 2478.6731,-3847.1071 2534.6596,-3943.2801 2501.2349,-7742.6392 2514.6731,-7853.1071 2530.7612,-7985.3583 2576.7172,-8139.4817 2593.9715,-8194.3904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.6638,-8195.5388 2597.0223,-8204.0134 2597.3365,-8193.4233 2590.6638,-8195.5388"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1283.7137,-4661.1649C1296.6039,-4658.1195 1309.1616,-4652.4164 1317.5017,-4642.1071 1354.5263,-4596.341 1340.1654,-3640.4439 1353.5017,-3583.1071 1392.3712,-3415.9955 1464.354,-3395.9314 1511.9993,-3231.1071 1543.906,-3120.7289 1482.0596,-3069.1993 1547.9993,-2975.1071 1594.7861,-2908.3449 1640.6695,-2931.9656 1710.019,-2889.1071 1979.5066,-2722.5619 2006.7003,-2575.6454 2318.0427,-2517.1071 2388.2046,-2503.9153 2408.9149,-2501.9244 2478.6731,-2517.1071 2577.9407,-2538.7124 2614.6982,-2540.3143 2686.5776,-2612.1071 2832.9033,-2758.2564 2835.1096,-2833.3342 2880.4805,-3035.1071 2915.4504,-3190.6253 2910.523,-5744.817 2916.4805,-5904.1071 2932.4503,-6331.1054 2973.1549,-6851.8924 2982.0351,-6962.739"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2978.5654,-6963.2576 2982.8558,-6972.9448 2985.5429,-6962.6964 2978.5654,-6963.2576"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1432.7505,-5573.1071C1464.6871,-5607.4959 1582.4194,-5656.7585 1629.0092,-5651.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge415" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1432.7505,-3749.1071C1452.4524,-3718.0237 1486.5791,-3751.7183 1511.9993,-3725.1071 1556.9717,-3678.0275 1502.1445,-3629.3278 1547.9993,-3583.1071 1656.6848,-3473.5543 1754.9095,-3579.8469 1883.8806,-3495.1071 2009.3802,-3412.6482 2029.6322,-3365.6119 2092.2107,-3229.1071 2126.5727,-3154.152 2064.4992,-3099.4507 2128.2107,-3047.1071 2181.0381,-3003.7055 2216.0864,-3029.1018 2282.0427,-3047.1071 2379.9263,-3073.8281 2408.1432,-3090.1636 2478.6731,-3163.1071 2501.8991,-3187.1279 2495.5753,-3201.6896 2514.6731,-3229.1071 2581.0909,-3324.4587 2644.6072,-3317.7479 2686.5776,-3426.1071 2720.0348,-3512.4867 2716.5093,-5000.6734 2722.5776,-5093.1071 2740.7184,-5369.4306 2786.3069,-5703.2765 2798.4938,-5789.8118"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2795.032,-5790.329 2799.8987,-5799.7399 2801.963,-5789.3481 2795.032,-5790.329"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge435" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1283.7502,-4660.7239C1296.482,-4657.6498 1308.9483,-4652.0421 1317.5017,-4642.1071 1372.4112,-4578.3288 1291.2282,-4321.7174 1353.5017,-4265.1071 1405.6264,-4217.7227 1447.5937,-4236.573 1511.9993,-4265.1071 1653.5406,-4327.8153 1636.3227,-4413.8689 1746.019,-4523.1071 1804.4138,-4581.258 1847.0626,-4573.3785 1883.8806,-4647.1071 1965.2086,-4809.9676 1829.8187,-4896.909 1919.8806,-5055.1071 1966.5636,-5137.108 2039.113,-5101.1067 2092.2107,-5179.1071 2128.8485,-5232.9279 2088.3462,-5269.6306 2128.2107,-5321.1071 2184.1962,-5393.4006 2285.9054,-5435.1456 2347.2866,-5454.8995"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2346.5589,-5458.3394 2357.1481,-5457.9956 2348.6557,-5451.6608 2346.5589,-5458.3394"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1283.6465,-4659.5938C1296.0736,-4656.4773 1308.4117,-4651.1308 1317.5017,-4642.1071 1363.0967,-4596.8445 1302.7299,-4541.475 1353.5017,-4502.1071 1409.1707,-4458.942 1445.5173,-4478.8174 1511.9993,-4502.1071 1711.6267,-4572.0397 1789.9104,-4609.6044 1883.8806,-4799.1071 1958.5369,-4949.6609 1870.3257,-6150.5322 1919.8806,-6311.1071 1961.4195,-6445.7073 2043.2881,-6445.0114 2092.2107,-6577.1071 2133.644,-6688.981 2107.9297,-6725.5436 2128.2107,-6843.1071 2184.7255,-7170.7079 2227.9367,-7247.0999 2282.0427,-7575.1071 2303.8272,-7707.1711 2295.4811,-7742.1737 2318.0427,-7874.1071 2340.3179,-8004.3651 2378.6904,-8158.5198 2392.8777,-8213.9482"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2389.5716,-8215.1454 2395.4524,-8223.9583 2396.3509,-8213.4016 2389.5716,-8215.1454"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1247.3841,-4674.1554C1269.5057,-4691.3221 1313.9357,-4725.1269 1353.5017,-4751.1071 1437.2571,-4806.1034 1456.0696,-4825.2511 1547.9993,-4865.1071 1582.4519,-4880.044 1594.5764,-4874.1243 1629.0092,-4889.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1283.489,-4660.98C1296.3756,-4657.9316 1308.9877,-4652.2732 1317.5017,-4642.1071 1393.1543,-4551.7744 1280.1166,-4205.2913 1353.5017,-4113.1071 1376.4223,-4084.3149 1402.6513,-4110.2822 1432.7505,-4089.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1432.7505,-4089.1071C1556.572,-4001.9971 1975.5621,-4163.603 2092.2107,-4260.1071 2204.6766,-4353.1508 2227.0895,-4392.8819 2282.0427,-4528.1071 2337.6822,-4665.021 2386.0961,-5141.6695 2396.3576,-5247.9771"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2392.8885,-5248.4675 2397.3259,-5258.0883 2399.8566,-5247.8002 2392.8885,-5248.4675"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1432.7505,-3749.1071C1452.8054,-3718.2503 1481.5235,-3745.7364 1511.9993,-3725.1071 1533.2094,-3710.7498 1527.793,-3695.8458 1547.9993,-3680.1071 1677.4129,-3579.3063 1743.791,-3612.4511 1883.8806,-3527.1071 1984.5151,-3465.7996 2033.1589,-3465.0816 2092.2107,-3363.1071 2147.3636,-3267.8656 2044.9229,-3190.051 2128.2107,-3118.1071 2179.9504,-3073.4144 2220.914,-3087.4851 2282.0427,-3118.1071 2412.5315,-3183.4747 2431.1392,-3243.1188 2478.6731,-3381.1071 2539.2664,-3557.0061 2424.9306,-4892.14 2514.6731,-5055.1071 2558.895,-5135.4115 2642.5971,-5088.6702 2686.5776,-5169.1071 2748.4985,-5282.3553 2707.1767,-7363.9582 2722.5776,-7492.1071 2737.6818,-7617.7861 2779.18,-7764.5593 2795.1497,-7818.1609"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.8392,-7819.3062 2798.0698,-7827.8753 2798.5428,-7817.291 2791.8392,-7819.3062"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-3749.1071C1440.1681,-3738.617 1871.5551,-3650.7327 1883.8806,-3647.1071 1978.4348,-3619.2939 2005.9738,-3618.8276 2092.2107,-3571.1071 2109.9461,-3561.2929 2109.038,-3549.6854 2128.2107,-3543.1071 2192.8798,-3520.9186 2220.9974,-3512.3192 2282.0427,-3543.1071 2413.309,-3609.3106 2431.6196,-3669.8243 2478.6731,-3809.1071 2521.2988,-3935.2832 2433.9269,-6100.1948 2514.6731,-6206.1071 2520.1497,-6213.2906 2527.5704,-6218.5008 2535.77,-6222.2636"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.7065,-6225.6044 2545.2965,-6225.9248 2537.2177,-6219.0703 2534.7065,-6225.6044"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge504" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-6829.1071C2214.3378,-6872.0381 2262.3074,-6851.8842 2282.0427,-6891.1071 2372.0084,-7069.9092 2226.8926,-7612.906 2318.0427,-7791.1071 2328.4198,-7811.3946 2348.6354,-7827.1963 2366.1878,-7837.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2364.6487,-7841.0531 2375.0576,-7843.0295 2368.1531,-7834.9934 2364.6487,-7841.0531"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1283.717,-4659.1004C1295.9983,-4655.9716 1308.2469,-4650.7422 1317.5017,-4642.1071 1355.422,-4606.7259 1311.5518,-4561.6027 1353.5017,-4531.1071 1410.4804,-4489.6862 1444.9618,-4509.4683 1511.9993,-4531.1071 1705.8774,-4593.6884 1787.6115,-4619.5594 1883.8806,-4799.1071 1983.3953,-4984.708 1818.5046,-5561.5163 1919.8806,-5746.1071 1964.6859,-5827.6909 2046.0357,-5784.2906 2092.2107,-5865.1071 2147.5847,-5962.0237 2115.0504,-6255.2652 2128.2107,-6366.1071 2152.8049,-6573.2501 2161.3669,-6625.1508 2205.1267,-6829.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge555" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1283.5451,-4661.0267C1296.4325,-4657.9791 1309.031,-4652.3094 1317.5017,-4642.1071 1403.5358,-4538.4855 1290.9295,-4156.3716 1353.5017,-4037.1071 1374.2782,-3997.5065 1398.0821,-4003.3556 1432.7505,-3975.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-4127.1071C2418.48,-4157.7761 2455.797,-4117.4336 2478.6731,-4146.1071 2516.1888,-4193.1303 2511.295,-8417.0472 2514.6731,-8477.1071 2532.6972,-8797.5608 2584.7267,-9185.5168 2597.6788,-9279.079"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.2151,-9279.583 2599.0596,-9289.0053 2601.1483,-9278.6184 2594.2151,-9279.583"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-3975.1071C1462.0847,-3951.205 1703.5502,-3962.4853 1710.019,-3963.1071 1866.5433,-3978.1534 2312.0973,-3995.6333 2398.3579,-4127.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge575" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1283.5887,-4661.0629C1296.4769,-4658.0158 1309.0648,-4652.3374 1317.5017,-4642.1071 1413.921,-4525.1921 1250.5189,-4072.284 1353.5017,-3961.1071 1494.0434,-3809.3828 1608.3892,-3911.3507 1814.9498,-3901.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1814.9498,-3901.1071C1944.8911,-3899.551 2354.0923,-3738.9281 2398.3579,-3861.1071"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge529" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1240.3288,-4674.3592C1257.3301,-4700.8939 1302.96,-4768.4961 1353.5017,-4813.1071 1457.2232,-4904.6576 1815.8182,-5018.6615 1883.8806,-5139.1071 1938.3277,-5235.4587 1911.4307,-9012.759 1919.8806,-9123.1071 1937.1988,-9349.2674 1987.2048,-9620.2155 2001.9234,-9696.9434"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1998.4991,-9697.6707 2003.8309,-9706.8262 2005.3723,-9696.3441 1998.4991,-9697.6707"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge660" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-3217.1071C1444.6619,-3161.6635 1489.2194,-3169.0393 1511.9993,-3117.1071 1553.2092,-3023.1593 1496.4258,-2977.7898 1547.9993,-2889.1071 1601.1676,-2797.682 1827.6598,-2643.8829 1919.8806,-2592.1071 2084.0994,-2499.9092 2132.5766,-2479.8269 2318.0427,-2447.1071 2579.3142,-2401.0137 2752.4842,-2414.7187 2880.4805,-2647.1071 2940.9549,-2756.9037 2901.3005,-4778.6804 2916.4805,-4903.1071 2948.6841,-5167.0736 3018.873,-5222.1368 3051.0454,-5486.1071 3066.4391,-5612.4104 3029.5973,-7662.5764 3087.0454,-7776.1071 3097.4737,-7796.7158 3118.1438,-7812.4432 3136.2388,-7823.0298"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3134.954,-7826.3188 3145.3988,-7828.0958 3138.3419,-7820.1932 3134.954,-7826.3188"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge643" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1283.6962,-4661.1508C1296.5861,-4658.1051 1309.148,-4652.4054 1317.5017,-4642.1071 1386.3546,-4557.2262 1316.0437,-3761.7832 1353.5017,-3659.1071 1377.4669,-3593.4162 2072.1125,-2708.8517 2128.2107,-2667.1071 2255.9257,-2572.0699 2341.7811,-2511.8435 2478.6731,-2593.1071 2507.4051,-2610.1634 2494.2609,-2632.6536 2514.6731,-2659.1071 2578.807,-2742.2222 2639.8269,-2727.109 2686.5776,-2821.1071 2752.6723,-2953.9986 2666.2346,-3015.7968 2722.5776,-3153.1071 2765.4383,-3257.5603 2842.8909,-3245.6433 2880.4805,-3352.1071 2921.7468,-3468.9844 2845.3167,-7712.6234 2916.4805,-7814.1071 2919.3691,-7818.2265 2923.0202,-7821.6683 2927.1213,-7824.5439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2925.6572,-7827.7392 2936.0715,-7829.6867 2929.1447,-7821.6698 2925.6572,-7827.7392"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1632.2285,-5623.3792C1644.0629,-5665.1489 1685.7289,-5815.1921 1710.019,-5941.1071 1731.7825,-6053.9244 1722.8713,-6084.5657 1746.019,-6197.1071 1763.9438,-6284.2551 1794.6744,-6385.7946 1808.2113,-6428.9602"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1804.9164,-6430.1497 1811.2641,-6438.6325 1811.5918,-6428.0427 1804.9164,-6430.1497"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2006.0457,-4699.1071C2058.5187,-4590.6507 2059.4,-4556.0075 2128.2107,-4457.1071 2207.8555,-4342.635 2330.3199,-4227.3644 2378.1955,-4184.0395"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2380.6407,-4186.5477 2385.7329,-4177.2568 2375.9583,-4181.3443 2380.6407,-4186.5477"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1850.4828,-5400.2438 1865.8254,-5396.146 1883.8806,-5359.1071 1934.8299,-5254.5884 1884.0217,-4947.7151 1919.8806,-4837.1071 1942.1799,-4768.3243 1975.3514,-4764.5761 2006.0457,-4699.1071"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge490" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1639.8194,-5600.8148C1656.7694,-5582.598 1689.7527,-5545.0215 1710.019,-5508.1071 1732.9532,-5466.3334 1724.0595,-5449.4012 1746.019,-5407.1071 1794.9276,-5312.9089 1850.5065,-5312.8618 1883.8806,-5212.1071 1935.5688,-5056.063 1910.294,-3897.2093 1919.8806,-3733.1071 1949.1521,-3232.0439 1793.9806,-1858.5552 2128.2107,-1484.1071 2156.6404,-1452.2564 2841.2241,-1343.8896 2880.4805,-1327.1071 2948.67,-1297.9553 3115.5202,-1110.7738 3169.983,-1161.1071"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge699" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2006.0457,-4699.1071C2119.0565,-4458.062 2358.4512,-4568.638 2478.6731,-4331.1071 2543.5258,-4202.9731 2464.966,-3173.8416 2514.6731,-3039.1071 2519.6892,-3025.5106 3164.092,-2213.8662 3169.983,-2227.1071"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1688.5341,-5602.7994C1696.7739,-5599.1258 1704.344,-5594.0645 1710.019,-5587.1071 1814.4511,-5459.0762 1644.7284,-5347.6375 1746.019,-5217.1071 1748.5371,-5213.8621 1751.5155,-5211.038 1754.798,-5208.5802"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1756.8363,-5211.4347 1763.4954,-5203.1941 1753.1508,-5205.4835 1756.8363,-5211.4347"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge475" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C2040.4367,-5289.9889 1800.976,-5615.6349 1919.8806,-4227.1071 1968.2557,-3662.1997 2036.0715,-3527.2958 2092.2107,-2963.1071 2098.5161,-2899.7387 2091.4746,-2443.1241 2128.2107,-2391.1071 2331.7817,-2102.8583 2607.5788,-1913.3813 2880.4805,-2137.1071 2943.5731,-2188.8307 2863.1294,-2255.3846 2916.4805,-2317.1071 2937.2422,-2341.1266 2971.7103,-2311.735 2983.7629,-2341.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1638.6802,-5601.0484C1654.6069,-5582.5529 1686.8921,-5543.8465 1710.019,-5508.1071 1728.597,-5479.3975 1719.3524,-5461.5144 1746.019,-5440.1071 1770.8003,-5420.2134 1789.3948,-5439.9964 1814.9498,-5421.1071"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1842.9203,-5404.6758 1853.6214,-5408.7996 1883.8806,-5397.1071 2027.2423,-5341.7107 2055.5742,-5304.5385 2205.1267,-5269.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-5269.1071C2264.5269,-5255.4482 2435.2778,-5206.3076 2478.6731,-5249.1071 2530.1777,-5299.9046 2505.7638,-7781.3176 2514.6731,-7853.1071 2531.0811,-7985.319 2576.8416,-8139.4664 2594.0077,-8194.386"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.6973,-8195.5263 2597.0425,-8204.0109 2597.3733,-8193.4213 2590.6973,-8195.5263"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1843.0801,-5404.9508 1862.9897,-5421.9246 1883.8806,-5397.1071 1947.1213,-5321.98 1880.3736,-5269.0107 1919.8806,-5179.1071 1980.2932,-5041.6301 1993.204,-4978.8552 2128.2107,-4913.1071 2434.8768,-4763.7609 2724.9415,-4761.535 2880.4805,-5065.1071 2924.952,-5151.904 2911.338,-5844.7163 2916.4805,-5942.1071 2938.1767,-6353.002 2974.2921,-6854.4118 2982.2015,-6962.8124"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2978.7317,-6963.355 2982.9517,-6973.0731 2985.7131,-6962.8445 2978.7317,-6963.355"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1688.381,-5600.99C1696.3384,-5597.5396 1703.8632,-5593.0218 1710.019,-5587.1071 1744.6849,-5553.7996 1712.1727,-5519.247 1746.019,-5485.1071 1749.6236,-5481.4713 1753.797,-5478.3608 1758.2714,-5475.7003"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1759.8855,-5478.806 1767.1766,-5471.119 1756.6832,-5472.5814 1759.8855,-5478.806"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge430" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2006.0457,-5193.1071C2153.966,-5040.6632 2305.1133,-4999.6467 2478.6731,-5122.1071 2720.5863,-5292.7963 2786.378,-5692.7206 2799.011,-5789.6619"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2795.5548,-5790.2307 2800.2692,-5799.7188 2802.5006,-5789.3617 2795.5548,-5790.2307"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge445" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2006.0457,-5535.1071C2092.392,-5515.7914 2123.2302,-5568.5996 2205.1267,-5535.1071"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2205.1267,-5535.1071C2238.2724,-5521.5518 2248.1011,-5522.5243 2282.0427,-5511.1071 2307.923,-5502.4016 2336.7961,-5491.98 2359.301,-5483.6959"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2360.6756,-5486.9194 2368.8433,-5480.1711 2358.25,-5480.353 2360.6756,-5486.9194"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1842.3537,-5405.0168 1855.4758,-5425.8581 1883.8806,-5440.1071 1945.3592,-5470.9471 1938.9243,-5550.1221 2006.0457,-5535.1071"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1633.2218,-5600.6503C1646.1468,-5565.1773 1685.8258,-5453.8418 1710.019,-5359.1071 1730.9614,-5277.1018 1722.1679,-5253.3141 1746.019,-5172.1071 1762.625,-5115.568 1790.7583,-5051.8786 1805.4206,-5020.2185"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1808.6123,-5021.6556 1809.676,-5011.1143 1802.2708,-5018.6915 1808.6123,-5021.6556"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2205.1267,-5269.1071C2246.4526,-5259.3163 2294.1604,-5259.2091 2331.8319,-5261.6023"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2331.9544,-5265.1197 2342.1774,-5262.3376 2332.4507,-5258.1373 2331.9544,-5265.1197"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2600.6254,-6192.1071C2610.0622,-6230.0751 2661.7133,-6180.9013 2686.5776,-6211.1071 2739.1663,-6274.993 2700.4776,-7620.3666 2722.5776,-7700.1071 2735.5072,-7746.7591 2767.4724,-7794.3705 2786.5293,-7819.9742"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2783.8449,-7822.2266 2792.6792,-7828.0751 2789.4203,-7817.9939 2783.8449,-7822.2266"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2006.0457,-5193.1071C2081.6798,-5120.226 2402.548,-5115.7389 2478.6731,-5188.1071 2536.0029,-5242.6075 2501.449,-5821.1191 2514.6731,-5899.1071 2537.361,-6032.907 2567.8912,-6060.4043 2600.6254,-6192.1071"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge404" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1842.8656,-5404.583 1859.1374,-5418.0859 1883.8806,-5397.1071 1909.3664,-5375.4988 1894.5549,-5352.9028 1919.8806,-5331.1071 2059.4913,-5210.9556 2134.793,-5234.7364 2318.0427,-5216.1071 2389.0679,-5208.8866 2427.2828,-5166.5516 2478.6731,-5216.1071 2557.9078,-5292.513 2447.0078,-6119.2889 2514.6731,-6206.1071 2520.226,-6213.2318 2527.6883,-6218.4099 2535.9067,-6222.1581"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.855,-6225.5032 2545.4454,-6225.81 2537.3578,-6218.9659 2534.855,-6225.5032"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge519" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1842.3537,-5405.0168 1864.2526,-5415.1149 1883.8806,-5440.1071 1925.5218,-5493.1286 1907.6039,-6586.8157 1919.8806,-6653.1071 1920.2618,-6655.1652 2316.8247,-7789.4049 2318.0427,-7791.1071 2331.7425,-7810.2523 2352.8513,-7826.4924 2369.9906,-7837.687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2368.2051,-7840.6988 2378.5313,-7843.0698 2371.9375,-7834.7769 2368.2051,-7840.6988"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge571" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1842.3394,-5404.9925 1863.6385,-5415.6097 1883.8806,-5440.1071 1948.2051,-5517.954 1876.1567,-5802.0797 1919.8806,-5893.1071 1965.3953,-5987.8627 2045.0007,-5961.1847 2092.2107,-6055.1071 2154.7016,-6179.4303 2073.1125,-6238.3355 2128.2107,-6366.1071 2170.2841,-6463.6744 2237.2614,-6452.7527 2282.0427,-6549.1071 2295.563,-6578.1983 2475.2051,-7655.2156 2478.6731,-7687.1071 2516.6696,-8036.5227 2488.4075,-8126.6144 2514.6731,-8477.1071 2538.6583,-8797.1698 2586.2441,-9185.4173 2597.9684,-9279.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.4973,-9279.5093 2599.2165,-9288.995 2601.4427,-9278.6367 2594.4973,-9279.5093"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge586" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1842.2715,-5404.8776 1863.8068,-5415.4715 1883.8806,-5440.1071 1960.9709,-5534.7163 1884.1478,-5871.4152 1919.8806,-5988.1071 1964.3395,-6133.2957 2038.8697,-6140.9415 2092.2107,-6283.1071 2122.0962,-6362.7588 2102.6754,-6389.9561 2128.2107,-6471.1071 2178.4806,-6630.8644 2240.0027,-6652.9896 2282.0427,-6815.1071 2328.2928,-6993.4595 2285.0323,-7046.8367 2318.0427,-7228.1071 2365.4276,-7488.3118 2439.5398,-7539.5341 2478.6731,-7801.1071 2528.6321,-8135.041 2496.1633,-8982.9645 2514.6731,-9320.1071 2536.2444,-9713.014 2586.9277,-10191.1104 2598.3232,-10296.0892"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2594.8466,-10296.4943 2599.4091,-10306.0564 2601.8054,-10295.7361 2594.8466,-10296.4943"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge668" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1841.0367,-5401.8247 1864.1237,-5422.8365 1883.8806,-5397.1071 1949.8366,-5311.2129 1852.5327,-4995.9143 1919.8806,-4911.1071 1980.1995,-4835.1511 2034.1122,-4869.6263 2128.2107,-4846.1071 2369.44,-4785.8136 2441.1754,-4771.0492 2686.5776,-4811.1071 2776.1441,-4825.7274 2826.0307,-4802.5045 2880.4805,-4875.1071 2949.1207,-4966.631 2863.7952,-5802.5572 2916.4805,-5904.1071 2951.041,-5970.7218 3016.9733,-5939.2413 3051.0454,-6006.1071 3140.3534,-6181.3722 2997.8269,-7600.7964 3087.0454,-7776.1071 3097.5212,-7796.6916 3118.1914,-7812.419 3136.2746,-7823.0116"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3134.9839,-7826.2976 3145.4275,-7828.0813 3138.3756,-7820.1742 3134.9839,-7826.2976"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge652" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-5193.1071C2067.9337,-5134.9149 2051.3054,-5082.1908 2128.2107,-5046.1071 2356.9615,-4938.7781 2523.6028,-4960.0122 2686.5776,-5153.1071 2877.7279,-5379.5848 2834.3115,-5498.3632 2880.4805,-5791.1071 2897.9918,-5902.1414 2851.4966,-7722.3882 2916.4805,-7814.1071 2919.3891,-7818.2124 2923.0538,-7821.6446 2927.1639,-7824.5139"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2925.7092,-7827.7141 2936.126,-7829.6483 2929.1889,-7821.6403 2925.7092,-7827.7141"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-5421.1071C1842.9931,-5404.8003 1862.6984,-5421.6764 1883.8806,-5397.1071 1940.0015,-5332.0124 1858.3166,-5267.0799 1919.8806,-5207.1071 1947.6716,-5180.0344 1976.3973,-5218.1319 2006.0457,-5193.1071"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1489.9468,-7389.0704C1498.0388,-7385.612 1505.7252,-7381.0706 1511.9993,-7375.1071 1534.8576,-7353.3803 1700.44,-6873.1537 1710.019,-6843.1071 1754.7554,-6702.7831 1796.2432,-6530.2612 1810.0837,-6471.1375"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1813.5483,-6471.6915 1812.4087,-6461.1581 1806.7309,-6470.1031 1813.5483,-6471.6915"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1495.222,-7388.9345C1501.6987,-7385.462 1507.5316,-7380.953 1511.9993,-7375.1071 1572.9043,-7295.4135 1530.4902,-6571.8691 1547.9993,-6473.1071 1589.0722,-6241.43 1654.6965,-6197.8005 1710.019,-5969.1071 1733.1086,-5873.6591 1698.8552,-5837.2409 1746.019,-5751.1071 1785.599,-5678.8236 1845.2081,-5699.8801 1883.8806,-5627.1071 1938.2113,-5524.8691 1866.6777,-5471.9365 1919.8806,-5369.1071 1968.1861,-5275.7434 2034.1327,-5294.7264 2092.2107,-5207.1071 2159.3688,-5105.789 2247.7939,-4810.7372 2282.0427,-4694.1071 2338.9031,-4500.4761 2382.2967,-4259.6703 2394.7382,-4187.5006"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2398.2299,-4187.8458 2396.4666,-4177.3988 2391.3302,-4186.6653 2398.2299,-4187.8458"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge692" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2600.6254,-7611.1071C2768.3158,-7576.8025 2847.1518,-7468.9845 2983.7629,-7572.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1629.0092,-7399.1071C1813.607,-7347.1414 2299.0112,-7483.037 2478.6731,-7550.1071 2535.4492,-7571.3023 2541.9907,-7626.4283 2600.6254,-7611.1071"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1495.3302,-7389.0164C1501.7888,-7385.5301 1507.5878,-7380.9956 1511.9993,-7375.1071 1569.9034,-7297.8149 1489.8539,-5714.218 1547.9993,-5637.1071 1551.4332,-5632.5532 1555.6836,-5628.8051 1560.4247,-5625.7232"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.2832,-5628.6973 1569.4182,-5620.8652 1558.9563,-5622.5384 1562.2832,-5628.6973"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1495.3332,-7389.0187C1501.7913,-7385.532 1507.5894,-7380.9968 1511.9993,-7375.1071 1571.3813,-7295.799 1513.4003,-5684.9452 1547.9993,-5592.1071 1587.3484,-5486.5229 1661.4813,-5498.7952 1710.019,-5397.1071 1745.1626,-5323.4802 1692.8315,-5278.9705 1746.019,-5217.1071 1748.8667,-5213.795 1752.1893,-5210.9216 1755.8084,-5208.4289"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1757.8071,-5211.316 1764.707,-5203.2759 1754.2993,-5205.2583 1757.8071,-5211.316"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge468" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-7361.1071C2045.5645,-7356.7952 2062.5098,-7363.5303 2092.2107,-7337.1071 2123.7824,-7309.0196 2097.1633,-7277.7731 2128.2107,-7249.1071 2319.5821,-7072.4139 2509.6361,-7262.2489 2686.5776,-7071.1071 3213.5984,-6501.791 2661.7734,-6020.9641 3087.0454,-5372.1071 3099.8011,-5352.6452 3120.8606,-5337.0136 3138.5658,-5326.3145"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3140.551,-5329.2097 3147.4571,-5321.1749 3137.0478,-5323.1493 3140.551,-5329.2097"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-7399.1071C1666.1806,-7387.2531 1886.2063,-7369.9421 2006.0457,-7361.1071"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-7589.1071C1866.0688,-7598.8993 1870.769,-7623.8712 1919.8806,-7641.1071 1979.8455,-7662.152 2432.658,-7719.2746 2478.6731,-7763.1071 2480.721,-7765.0579 2571.5039,-8105.7054 2595.0792,-8194.2649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2591.7126,-8195.2243 2597.667,-8203.9876 2598.4771,-8193.4238 2591.7126,-8195.2243"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2006.0457,-7361.1071C2045.4277,-7355.6865 2056.7023,-7354.9812 2092.2107,-7337.1071 2110.316,-7327.9933 2109.8697,-7317.7369 2128.2107,-7309.1071 2358.2297,-7200.8786 2443.4269,-7259.2682 2686.5776,-7185.1071 2775.1134,-7158.1036 2805.5188,-7163.4073 2880.4805,-7109.1071 2920.8597,-7079.8575 2954.8039,-7031.2469 2971.8888,-7004.0668"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2974.9534,-7005.7648 2977.2118,-6995.4134 2968.9911,-7002.0972 2974.9534,-7005.7648"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge422" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1629.0092,-7399.1071C1702.5012,-7375.875 1691.7561,-7325.8459 1746.019,-7271.1071 2147.9729,-6865.6279 2440.7193,-6911.407 2686.5776,-6396.1071 2736.6476,-6291.1643 2668.5667,-5977.0771 2722.5776,-5874.1071 2733.121,-5854.0065 2753.1863,-5838.1265 2770.4492,-5827.3377"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2772.3467,-5830.2816 2779.1559,-5822.1646 2768.7711,-5824.2636 2772.3467,-5830.2816"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge449" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1629.0092,-7399.1071C1672.2396,-7385.4412 1686.0327,-7375.5815 1710.019,-7337.1071 1753.1807,-7267.8751 1719.5574,-7234.2808 1746.019,-7157.1071 1790.4928,-7027.4019 1847.4728,-7013.3032 1883.8806,-6881.1071 1912.5178,-6777.1258 1859.7789,-6486.6615 1919.8806,-6397.1071 1967.5812,-6326.0311 2040.2987,-6379.168 2092.2107,-6311.1071 2142.2169,-6245.545 2094.1773,-6204.212 2128.2107,-6129.1071 2174.4965,-6026.9636 2233.0976,-6030.0033 2282.0427,-5929.1071 2358.5134,-5771.4692 2388.2061,-5558.2388 2396.0635,-5490.6099"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2399.5751,-5490.7016 2397.2128,-5480.3735 2392.6188,-5489.9206 2399.5751,-5490.7016"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1506.1253,-7409.9336C1543.7033,-7412.437 1589.6981,-7411.534 1629.0092,-7399.1071"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1485.4814,-7388.9637C1494.8662,-7385.4969 1504.1412,-7380.98 1511.9993,-7375.1071 1638.1915,-7280.7946 1650.7918,-7227.0916 1710.019,-7081.1071 1743.9736,-6997.4153 1723.5985,-6968.5974 1746.019,-6881.1071 1793.8475,-6694.469 1841.5834,-6658.076 1883.8806,-6470.1071 1913.4586,-6338.6627 1875.1279,-6296.1885 1919.8806,-6169.1071 1967.9162,-6032.7037 2030.2504,-6023.7755 2092.2107,-5893.1071 2113.5279,-5848.1512 2102.742,-5829.8482 2128.2107,-5787.1071 2179.7,-5700.6985 2235.8756,-5710.4725 2282.0427,-5621.1071 2317.8896,-5551.7186 2293.994,-5523.4133 2318.0427,-5449.1071 2337.5228,-5388.9173 2370.7536,-5321.787 2387.7151,-5289.1312"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2390.8805,-5290.6312 2392.4234,-5280.1493 2384.6807,-5287.3812 2390.8805,-5290.6312"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1814.9498,-7589.1071C1852.0887,-7594.1619 2444.5918,-7694.5088 2478.6731,-7710.1071 2497.355,-7718.6574 2498.3358,-7726.6485 2514.6731,-7739.1071 2552.1274,-7767.6693 2556.8875,-7783.6249 2600.6254,-7801.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1439.5112,-7411.3507C1455.1928,-7436.3989 1496.6524,-7496.9505 1547.9993,-7527.1071 1653.0274,-7588.7914 1694.124,-7573.7123 1814.9498,-7589.1071"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge513" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1443.6173,-7411.3407C1460.3039,-7429.1077 1492.3625,-7465.3579 1511.9993,-7501.1071 1535.1441,-7543.2429 1512.5332,-7570.653 1547.9993,-7603.1071 1661.6821,-7707.1352 1745.5197,-7621.2699 1883.8806,-7689.1071 1902.0806,-7698.0304 1901.7753,-7707.9933 1919.8806,-7717.1071 1990.8973,-7752.8554 2021.194,-7729.3588 2092.2107,-7765.1071 2110.316,-7774.2209 2109.8851,-7784.4448 2128.2107,-7793.1071 2187.3439,-7821.0587 2259.9127,-7836.5287 2314.9411,-7844.8895"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2314.602,-7848.3772 2325.0048,-7846.3693 2315.6204,-7841.4517 2314.602,-7848.3772"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge561" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1506.0119,-7410.9033C1508.1475,-7412.4526 1510.1548,-7414.181 1511.9993,-7416.1071 1583.2571,-7490.5184 1508.2577,-7550.0528 1547.9993,-7645.1071 1759.8391,-8151.7875 1998.4636,-8168.805 2282.0427,-8639.1071 2427.1314,-8879.7296 2558.7013,-9196.3996 2592.3435,-9279.4519"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2589.1286,-9280.838 2596.1162,-9288.802 2595.6201,-9278.2188 2589.1286,-9280.838"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge589" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1506.1736,-7410.7533C1508.264,-7412.3446 1510.2177,-7414.1226 1511.9993,-7416.1071 1570.4383,-7481.201 1521.1413,-7724.8545 1547.9993,-7808.1071 1647.9441,-8117.9099 1751.0236,-8160.8014 1919.8806,-8439.1071 1994.8952,-8562.7442 2023.4397,-8587.8913 2092.2107,-8715.1071 2286.8689,-9075.1954 2359.4874,-9159.5076 2478.6731,-9551.1071 2565.9072,-9837.7255 2593.625,-10204.7148 2599.3875,-10295.8949"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2595.9047,-10296.2853 2600.0093,-10306.0527 2602.8916,-10295.8575 2595.9047,-10296.2853"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge671" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-7800.1071C3027.7714,-7806.9299 3077.0765,-7817.3835 3113.8928,-7825.7511"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3113.4018,-7829.2292 3123.9309,-7828.0511 3114.9652,-7822.406 3113.4018,-7829.2292"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-7399.1071C1675.4483,-7385.1413 2434.5604,-7578.9651 2478.6731,-7599.1071 2496.6266,-7607.3048 2497.2708,-7615.7963 2514.6731,-7625.1071 2563.7238,-7651.3507 2928.7897,-7791.5844 2983.7629,-7800.1071"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge657" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1470.2558,-7411.1827C1528.9252,-7428.4131 1646.0508,-7462.429 1746.019,-7489.1071 2070.2984,-7575.6461 2178.1483,-7522.6716 2478.6731,-7672.1071 2497.0699,-7681.2549 2496.4693,-7691.581 2514.6731,-7701.1071 2587.7188,-7739.3323 2819.961,-7798.9946 2927.7759,-7825.5592"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2927.2653,-7829.0378 2937.8116,-7828.0248 2928.9355,-7822.2399 2927.2653,-7829.0378"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1483.1858,-6098.5029C1493.8792,-6094.7873 1504.2595,-6089.2756 1511.9993,-6081.1071 1556.1879,-6034.4705 1519.1163,-5998.4951 1547.9993,-5941.1071 1599.4279,-5838.923 1646.3632,-5836.1567 1710.019,-5741.1071 1728.6119,-5713.3447 1725.3009,-5701.3217 1746.019,-5675.1071 1797.1182,-5610.4515 1846.7508,-5624.6792 1883.8806,-5551.1071 1958.7192,-5402.8158 1854.608,-5331.8507 1919.8806,-5179.1071 1965.9883,-5071.2112 2038.0535,-5083.1957 2092.2107,-4979.1071 2122.2619,-4921.3495 2105.7682,-4898.2246 2128.2107,-4837.1071 2181.7779,-4691.2279 2223.6428,-4667.1197 2282.0427,-4523.1071 2332.6817,-4398.2326 2377.3824,-4242.2479 2392.716,-4186.8199"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2396.1082,-4187.6842 2395.3842,-4177.1141 2389.3586,-4185.8286 2396.1082,-4187.6842"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge701" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2006.0457,-5649.1071C2061.0406,-5621.6932 2221.0094,-5639.2417 2282.0427,-5632.1071 2370.131,-5621.8099 2408.4164,-5652.2326 2478.6731,-5598.1071 2685.0462,-5439.1181 2503.3659,-5205.8678 2722.5776,-5065.1071 2781.6305,-5027.188 2824.0789,-5023.3463 2880.4805,-5065.1071 2924.547,-5097.7347 2891.1056,-5134.5012 2916.4805,-5183.1071 2994.0161,-5331.6274 3004.7902,-5434.1544 3169.983,-5462.1071"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1445.3043,-6094.821C1463.5847,-6077.5354 1496.9829,-6042.5497 1511.9993,-6005.1071 1542.5847,-5928.8435 1496.0461,-5700.7662 1547.9993,-5637.1071 1551.5473,-5632.7596 1555.8353,-5629.1526 1560.5641,-5626.1619"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.301,-5629.2024 1569.4874,-5621.4174 1559.0147,-5623.0217 1562.301,-5629.2024"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1438.0193,-6094.7499C1452.4129,-6063.2065 1492.6131,-5971.5493 1511.9993,-5891.1071 1543.3584,-5760.9838 1493.1968,-5714.2224 1547.9993,-5592.1071 1640.2889,-5386.4599 1800.1006,-5421.3655 1883.8806,-5212.1071 1962.5686,-5015.5672 1841.2011,-4456.6505 1919.8806,-4260.1071 1962.8651,-4152.7309 2033.5882,-4164.8103 2092.2107,-4065.1071 2116.577,-4023.6657 2100.5954,-4002.4581 2128.2107,-3963.1071 2141.3454,-3944.3905 2161.4819,-3928.175 2177.8571,-3916.8838"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2180.1129,-3919.5868 2186.499,-3911.1329 2176.2348,-3913.7592 2180.1129,-3919.5868"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge477" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-5955.1071C1723.7148,-5887.1244 1804.4976,-5978.4836 1883.8806,-5893.1071 1949.8535,-5822.1533 1857.0199,-5751.8323 1919.8806,-5678.1071 1946.0967,-5647.3599 1970.7081,-5668.7012 2006.0457,-5649.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.0457,-5649.1071C2101.3091,-5600.5702 2407.5589,-5638.9427 2478.6731,-5559.1071 2551.8846,-5476.9169 2461.3129,-5161.3768 2514.6731,-5065.1071 2622.6238,-4870.3481 2761.1318,-4893.561 2983.7629,-4889.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-4889.1071C3072.176,-4887.2405 3146.8895,-5203.2051 3165.5195,-5288.8959"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3162.1225,-5289.7474 3167.6425,-5298.7906 3168.9667,-5288.2789 3162.1225,-5289.7474"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge431" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1472.2844,-6094.9819C1485.1064,-6091.0179 1499.2951,-6086.2494 1511.9993,-6081.1071 1528.5809,-6074.3953 1531.3101,-6069.5469 1547.9993,-6063.1071 1692.6224,-6007.3018 1782.018,-6085.9578 1883.8806,-5969.1071 1961.4056,-5880.1751 1830.9799,-5783.6679 1919.8806,-5706.1071 1977.5944,-5655.7551 2015.8262,-5700.4842 2092.2107,-5706.1071 2331.0072,-5723.6858 2611.3869,-5774.1229 2736.0606,-5798.1195"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2735.7193,-5801.6182 2746.2017,-5800.0793 2737.0475,-5794.7454 2735.7193,-5801.6182"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge436" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1629.0092,-5955.1071C1750.8428,-5871.2371 1808.6204,-5868.4395 1883.8806,-5741.1071 1925.836,-5670.1229 1863.8436,-5619.5957 1919.8806,-5559.1071 1946.8969,-5529.9446 1967.2511,-5543.7854 2006.0457,-5535.1071"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1483.0898,-6097.857C1493.6614,-6094.1669 1504.013,-6088.8286 1511.9993,-6081.1071 1546.5609,-6047.6914 1513.1456,-6012.2181 1547.9993,-5979.1071 1575.2239,-5953.2437 1598.5037,-5977.0049 1629.0092,-5955.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1629.0092,-5955.1071C1702.3369,-5902.4701 1686.0848,-5856.6016 1746.019,-5789.1071 1800.7385,-5727.4852 1843.1629,-5736.7558 1883.8806,-5665.1071 1924.621,-5593.4186 1863.8436,-5543.5957 1919.8806,-5483.1071 1973.9132,-5424.7822 2016.8974,-5460.587 2092.2107,-5435.1071 2178.2975,-5405.9823 2203.1604,-5404.2379 2282.0427,-5359.1071 2318.5944,-5338.1949 2356.3273,-5306.8723 2378.548,-5287.2333"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2381.1511,-5289.6007 2386.27,-5280.3245 2376.4837,-5284.3839 2381.1511,-5289.6007"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1436.8017,-6117.2759C1450.4835,-6155.6 1495.0644,-6285.5477 1511.9993,-6397.1071 1579.8123,-6843.8283 1461.9673,-6969.5342 1547.9993,-7413.1071 1640.3509,-7889.2634 1707.6251,-8002.9864 1919.8806,-8439.1071 1983.1658,-8569.139 2042.8721,-8579.1695 2092.2107,-8715.1071 2147.6075,-8867.7364 2193.9531,-9393.3153 2203.3769,-9505.8074"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2199.8997,-9506.2283 2204.216,-9515.904 2206.8756,-9505.6485 2199.8997,-9506.2283"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge520" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-6107.1071C1939.9447,-6184.0684 1862.9456,-6284.8195 1883.8806,-6430.1071 1913.9494,-6638.7821 1873.234,-6697.502 1919.8806,-6903.1071 1966.7143,-7109.5369 2038.8224,-7142.2746 2092.2107,-7347.1071 2121.1898,-7458.2898 2083.7132,-7497.1762 2128.2107,-7603.1071 2149.9258,-7654.8021 2167.7385,-7661.3214 2205.1267,-7703.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-7703.1071C2205.5118,-7703.5508 2317.5484,-7828.7896 2318.0427,-7829.1071 2324.2939,-7833.1222 2331.2324,-7836.5288 2338.3382,-7839.4101"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2337.4897,-7842.8283 2348.0828,-7843.0216 2339.9223,-7836.2645 2337.4897,-7842.8283"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge572" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-7777.1071C2406.0445,-7813.5608 2455.6313,-7771.832 2478.6731,-7801.1071 2525.1939,-7860.2128 2508.7647,-8402.122 2514.6731,-8477.1071 2539.8849,-8797.0755 2586.5564,-9185.3933 2598.0281,-9279.0554"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.5555,-9279.4939 2599.2487,-9288.9925 2601.5033,-9278.6404 2594.5555,-9279.4939"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-6107.1071C1901.9975,-6160.1924 1866.6687,-6224.1367 1919.8806,-6311.1071 2063.839,-6546.395 2190.897,-6554.7672 2282.0427,-6815.1071 2334.4653,-6964.8419 2289.4481,-7372.0591 2318.0427,-7528.1071 2339.0014,-7642.4838 2374.3665,-7663.3279 2398.3579,-7777.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1467.8314,-6095.0709C1539.1787,-6074.8639 1703.8309,-6039.8493 1814.9498,-6107.1071"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge485" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M1437.9528,-12691.4806C1452.1763,-12723.0657 1491.9821,-12814.8196 1511.9993,-12895.1071 1540.6465,-13010.009 1487.1107,-13057.5409 1547.9993,-13159.1071 1652.8856,-13334.0644 1726.8941,-13362.0207 1919.8806,-13428.1071 2038.8209,-13468.8371 2960.9428,-13542.784 3051.0454,-13455.1071 3077.3138,-13429.5458 3085.3494,-12172.7204 3087.0454,-12136.1071 3139.3305,-11007.3543 3204.9771,-10728.0526 3252.9207,-9599.1071 3287.5685,-8783.2413 3272.4218,-8578.5416 3288.9207,-7762.1071 3323.0643,-6072.5348 3367.4486,-3984.664 3372.3921,-3752.39"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3375.8948,-3752.296 3372.6085,-3742.2237 3368.8963,-3752.1469 3375.8948,-3752.296"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1441.9888,-12668.9453C1459.7302,-12646.7035 1498.0471,-12594.555 1511.9993,-12543.1071 1537.1045,-12450.5329 1490.8454,-5714.1376 1547.9993,-5637.1071 1551.3978,-5632.5267 1555.6235,-5628.7601 1560.3482,-5625.666"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1562.204,-5628.641 1569.3207,-5620.7922 1558.8627,-5622.4899 1562.204,-5628.641"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1485.1089,-12669.0573C1548.5697,-12652.814 1653.9528,-12616.1534 1710.019,-12543.1071 1759.6933,-12478.3887 1723.4078,-12441.4954 1746.019,-12363.1071 1806.1326,-12154.7059 1837.3849,-12107.7041 1919.8806,-11907.1071 1991.9561,-11731.8479 2048.8653,-11701.5843 2092.2107,-11517.1071 2132.4587,-11345.8123 2066.7679,-10890.9907 2128.2107,-10726.1071 2166.7567,-10622.6675 2244.4919,-10634.9121 2282.0427,-10531.1071 2333.8421,-10387.9134 2282.9296,-9309.2782 2318.0427,-9161.1071 2356.766,-8997.702 2434.9251,-8981.2392 2478.6731,-8819.1071 2526.0962,-8643.3549 2469.523,-8587.4569 2514.6731,-8411.1071 2531.9517,-8343.6194 2570.0254,-8269.8527 2589.1658,-8235.2046"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.414,-8236.5671 2594.2423,-8226.1311 2586.3051,-8233.1492 2592.414,-8236.5671"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2801.5291,-12928.1071C2988.894,-12708.9067 2861.8069,-12571.867 2880.4805,-12284.1071 2948.4913,-11236.0588 2851.2484,-8606.332 2916.4805,-7558.1071 2929.9658,-7341.4097 2968.7265,-7080.9304 2980.3979,-7005.5149"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2983.8934,-7005.8142 2981.9741,-6995.3947 2976.9768,-7004.7369 2983.8934,-7005.8142"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1453.6603,-12691.1945C1471.9304,-12701.9923 1497.7053,-12720.1217 1511.9993,-12743.1071 1551.8661,-12807.2148 1502.8361,-12848.6137 1547.9993,-12909.1071 1660.7778,-13060.1671 1737.2661,-13066.3088 1919.8806,-13113.1071 1994.0742,-13132.1206 2026.3501,-13152.2042 2092.2107,-13113.1071 2120.9427,-13096.0508 2101.0784,-13066.608 2128.2107,-13047.1071 2374.976,-12869.7481 2604.0766,-13159.109 2801.5291,-12928.1071"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1441.4654,-12668.7868C1458.2893,-12646.2673 1495.0723,-12593.6544 1511.9993,-12543.1071 1553.8013,-12418.2777 1519.7287,-12377.6783 1547.9993,-12249.1071 1598.5283,-12019.307 1672.8347,-11977.44 1710.019,-11745.1071 1759.6434,-11435.0468 1727.9991,-6406.596 1746.019,-6093.1071 1759.8656,-5852.2219 1800.2086,-5561.9495 1811.8009,-5481.6108"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1815.323,-5481.7109 1813.2961,-5471.3117 1808.3956,-5480.7051 1815.323,-5481.7109"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge425" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1446.6662,-12691.1905C1476.9985,-12715.3365 1546.4941,-12770.5845 1547.9993,-12771.1071 1616.0244,-12794.7258 1647.9293,-12807.578 1710.019,-12771.1071 1935.1026,-12638.8953 2155.9831,-11973.6931 2282.0427,-11745.1071 2298.1783,-11715.8481 2299.3712,-11706.8166 2318.0427,-11679.1071 2380.9799,-11585.7049 2435.3979,-11587.0894 2478.6731,-11483.1071 2538.9277,-11338.3266 2449.1692,-11274.5895 2514.6731,-11132.1071 2561.015,-11031.3053 2645.06,-11053.9899 2686.5776,-10951.1071 2736.5895,-10827.175 2706.3798,-6272.7645 2722.5776,-6140.1071 2737.0673,-6021.4394 2778.419,-5883.5133 2794.7632,-5831.9536"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2798.1379,-5832.8913 2797.8526,-5822.3003 2791.471,-5830.7576 2798.1379,-5832.8913"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge441" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1442.565,-12668.8474C1483.646,-12620.9947 1642.7693,-12428.281 1710.019,-12239.1071 1754.1135,-12115.069 1721.9016,-12074.5217 1746.019,-11945.1071 1873.478,-11261.1607 1948.2797,-11099.1587 2128.2107,-10427.1071 2192.9713,-10185.2229 2246.4133,-10132.9628 2282.0427,-9885.1071 2345.3161,-9444.947 2273.5127,-6325.5566 2318.0427,-5883.1071 2333.3998,-5730.5196 2377.3951,-5550.4681 2392.883,-5490.049"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2396.3166,-5490.7509 2395.4299,-5480.1932 2389.5392,-5488.9995 2396.3166,-5490.7509"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1441.8089,-12668.8945C1459.2348,-12646.5638 1497.0243,-12594.2667 1511.9993,-12543.1071 1561.867,-12372.7418 1508.143,-11918.0886 1547.9993,-11745.1071 1588.7634,-11568.1853 1672.7367,-11547.7952 1710.019,-11370.1071 1780.7282,-11033.1061 1679.8095,-5510.0209 1746.019,-5172.1071 1757.2938,-5114.5642 1787.4578,-5051.7673 1803.8967,-5020.3696"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1807.1017,-5021.7973 1808.7105,-5011.3254 1800.9224,-5018.5085 1807.1017,-5021.7973"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1452.3267,-12691.193C1470.1913,-12702.2314 1496.1531,-12720.7309 1511.9993,-12743.1071 1540.2676,-12783.0245 1513.9917,-12811.9506 1547.9993,-12847.1071 1654.4126,-12957.1154 1736.9684,-12966.0306 1883.8806,-12923.1071 1921.5191,-12912.1102 2457.7689,-12576.2824 2478.6731,-12543.1071 2513.6452,-12487.6057 2505.3119,-12315.0365 2514.6731,-12250.1071 2548.0374,-12018.6913 2567.5507,-11962.5644 2600.6254,-11731.1071"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge648" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1441.2024,-12691.2642C1457.8974,-12713.9532 1494.9595,-12767.6889 1511.9993,-12819.1071 1532.7049,-12881.5869 1503.3489,-13064.7461 1547.9993,-13113.1071 1662.6069,-13237.2393 2717.6452,-13310.9216 2801.5291,-13213.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2801.5291,-13213.1071C2878.6259,-13114.1414 2862.1403,-13066.211 2880.4805,-12942.1071 2939.2529,-12544.4065 2905.3807,-9725.9737 2916.4805,-9324.1071 2932.9935,-8726.253 2974.7467,-7993.8802 2982.5102,-7860.4713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2986.0122,-7860.538 2983.1009,-7850.351 2979.0241,-7860.13 2986.0122,-7860.538"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1257.2355,-8457.0722C1276.9367,-8446.6383 1303.7696,-8429.0156 1317.5017,-8405.1071 1368.389,-8316.5091 1421.9928,-7558.544 1431.3257,-7421.3515"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1434.8239,-7421.495 1432.0068,-7411.2816 1427.8399,-7421.0225 1434.8239,-7421.495"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1246.3569,-8479.1576C1301.9158,-8525.1931 1525.7089,-8701.2809 1746.019,-8743.1071 2069.7783,-8804.5732 2256.3033,-8872.3144 2478.6731,-8629.1071 2533.7249,-8568.8966 2459.1845,-8508.9153 2514.6731,-8449.1071 2541.6489,-8420.0313 2582.031,-8460.1406 2600.6254,-8425.1071"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2216.0319,-3911.2072C2232.7067,-3928.7957 2264.4527,-3964.8107 2282.0427,-4001.1071 2310.0611,-4058.9221 2273.7652,-4094.5549 2318.0427,-4141.1071 2321.3892,-4144.6255 2325.2212,-4147.6516 2329.3562,-4150.2541"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2327.747,-4153.3627 2338.211,-4155.0228 2331.0661,-4147.1996 2327.747,-4153.3627"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge679" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2206.4705,-3888.7898C2214.5448,-3820.4892 2257.1028,-3456.2332 2282.0427,-3158.1071 2287.2868,-3095.421 2284.5966,-2646.3838 2318.0427,-2593.1071 2537.1546,-2244.0816 2986.7636,-1857.9737 3169.983,-2227.1071"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge456" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2206.1209,-3888.81C2216.2898,-3776.1869 2305.3709,-2856.3109 2514.6731,-2707.1071 2719.7699,-2560.9012 2817.0627,-2836.2901 2983.7629,-3025.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.7629,-3025.1071C3009.7703,-3043.317 3032.0761,-3023.6483 3051.0454,-3049.1071 3121.8133,-3144.0847 3164.7654,-5064.9718 3169.5381,-5288.8711"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3166.0414,-5289.0687 3169.7523,-5298.9924 3173.0398,-5288.9205 3166.0414,-5289.0687"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge409" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2205.5122,-3888.8419C2207.6987,-3844.8495 2222.2111,-3683.8778 2318.0427,-3619.1071 2377.1911,-3579.1299 2424.5371,-3572.5667 2478.6731,-3619.1071 2566.4761,-3694.5908 2774.7766,-5567.7 2799.1822,-5789.676"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2795.7164,-5790.1806 2800.2868,-5799.7389 2802.6746,-5789.4167 2795.7164,-5790.1806"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge446" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2210.6072,-3911.4035C2225.5142,-3942.7916 2266.7041,-4034.0887 2282.0427,-4115.1071 2330.5956,-4371.563 2259.7661,-5034.6845 2318.0427,-5289.1071 2332.0985,-5350.4714 2367.4294,-5416.5962 2386.1988,-5448.9493"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2383.3586,-5451.0237 2391.4503,-5457.8631 2389.3898,-5447.4705 2383.3586,-5451.0237"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2217.0448,-3911.1753C2234.7557,-3928.4469 2267.4936,-3963.7249 2282.0427,-4001.1071 2329.1714,-4122.1979 2387.8439,-5090.422 2397.1029,-5247.5863"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2393.6245,-5248.0579 2397.7043,-5257.8357 2400.6125,-5247.6478 2393.6245,-5248.0579"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge501" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2210.6964,-3911.3871C2225.8314,-3942.7332 2267.55,-4033.9331 2282.0427,-4115.1071 2299.9906,-4215.6335 2272.9178,-7699.5024 2318.0427,-7791.1071 2328.0458,-7811.4135 2348.0621,-7827.1404 2365.6088,-7837.8021"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2364.08,-7840.9605 2374.4933,-7842.9133 2367.5706,-7834.8929 2364.08,-7840.9605"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge550" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2248.9222,-3910.6054C2260.1564,-3914.2858 2271.918,-3919.0572 2282.0427,-3925.1071 2385.8329,-3987.1262 2430.6953,-4002.1256 2478.6731,-4113.1071 2526.7771,-4224.3808 2507.8692,-8356.0718 2514.6731,-8477.1071 2532.6871,-8797.5613 2584.7242,-9185.5169 2597.6783,-9279.079"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.2146,-9279.5831 2599.0594,-9289.0053 2601.1478,-9278.6184 2594.2146,-9279.5831"/>
</g>
<!-- sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1234.8866,-7011.0641C1244.0879,-6947.3127 1290.7455,-6619.8144 1317.5017,-6351.1071 1328.276,-6242.9031 1316.4122,-5965.3253 1353.5017,-5863.1071 1444.7113,-5611.7346 1548.9011,-5587.8053 1746.019,-5407.1071 1806.7672,-5351.4193 1848.0939,-5357.3417 1883.8806,-5283.1071 1941.6921,-5163.1851 1879.3771,-4811.9256 1919.8806,-4685.1071 1963.8783,-4547.3482 2034.7699,-4541.8244 2092.2107,-4409.1071 2117.0461,-4351.7248 2086.5679,-4319.7484 2128.2107,-4273.1071 2152.6485,-4245.736 2174.2473,-4262.9274 2205.1267,-4243.1071"/>
</g>
<!-- sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge681" class="edge">
<title>sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M3169.983,-7724.1071C3184.7447,-7728.7504 3268.4086,-7752.5353 3323.5798,-7768.1683"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3322.9515,-7771.628 3333.5269,-7770.986 3324.8594,-7764.893 3322.9515,-7771.628"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2983.7629,-7572.1071C3008.703,-7591.7534 3024.5298,-7578.6454 3051.0454,-7596.1071 3115.9023,-7638.8182 3095.9042,-7700.8052 3169.983,-7724.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1242.7874,-7010.9739C1261.4539,-6990.0698 1305.3094,-6945.5721 1353.5017,-6929.1071 1420.1619,-6906.3325 1445.3688,-6906.2457 1511.9993,-6929.1071 1531.1719,-6935.6854 1528.9266,-6950.2442 1547.9993,-6957.1071 1583.1308,-6969.7484 1846.7499,-6963.1906 1883.8806,-6967.1071 1977.4802,-6976.98 2006.2999,-6966.6663 2092.2107,-7005.1071 2110.7128,-7013.3859 2110.8987,-7022.5639 2128.2107,-7033.1071 2274.7682,-7122.3619 2331.237,-7107.3112 2478.6731,-7195.1071 2719.3535,-7338.4286 2763.7151,-7398.7663 2983.7629,-7572.1071"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2227.1118,-3149.2197C2245.4362,-3159.8089 2270.3619,-3177.6139 2282.0427,-3201.1071 2328.5762,-3294.6981 2254.4844,-4058.1313 2318.0427,-4141.1071 2320.5195,-4144.3405 2323.4099,-4147.1661 2326.5944,-4149.6344"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2324.7422,-4152.6045 2335.0479,-4155.0627 2328.5244,-4146.7143 2324.7422,-4152.6045"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge684" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2208.388,-3126.8609C2220.3386,-3085.1815 2262.0754,-2935.4135 2282.0427,-2809.1071 2296.9465,-2714.8309 2278.0004,-2467.7485 2318.0427,-2381.1071 2370.0726,-2268.5277 2409.0651,-2248.1316 2514.6731,-2183.1071 2583.0969,-2140.9775 2620.2586,-2172.4778 2686.5776,-2127.1071 2707.4315,-2112.8404 2701.6971,-2097.3346 2722.5776,-2083.1071 2823.3471,-2014.4455 2889.1958,-1922.1269 2983.7629,-1999.1071"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge460" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2210.3484,-3127.072C2223.3225,-3099.4549 2257.7282,-3024.9867 2282.0427,-2961.1071 2340.9551,-2806.3313 2284.6514,-2727.5108 2398.3579,-2607.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-2607.1071C2423.9373,-2580.0211 2444.023,-2596.7938 2478.6731,-2583.1071 2680.842,-2503.2511 2716.467,-2450.2179 2916.4805,-2365.1071 2945.6943,-2352.6759 2971.5629,-2311.7959 2983.7629,-2341.1071"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-3519.1071C2410.254,-3562.6039 2458.6169,-3540.7185 2478.6731,-3581.1071 2531.4533,-3687.3946 2500.3756,-7735.3007 2514.6731,-7853.1071 2530.7242,-7985.3628 2576.7029,-8139.4834 2593.9673,-8194.3909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.6599,-8195.5402 2597.0199,-8204.0137 2597.3322,-8193.4235 2590.6599,-8195.5402"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2263.8351,-3149.1186C2270.7808,-3152.5941 2277.1318,-3157.1471 2282.0427,-3163.1071 2365.7559,-3264.7038 2252.9047,-3342.7095 2318.0427,-3457.1071 2340.3558,-3496.294 2386.4618,-3475.6103 2398.3579,-3519.1071"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2398.3579,-2607.1071C2416.5197,-2585.6878 2624.7778,-2628.1612 2686.5776,-2707.1071 2732.3214,-2765.5422 2701.572,-2967.9318 2722.5776,-3039.1071 2766.7931,-3188.9265 2843.3452,-3201.3777 2880.4805,-3353.1071 2914.1754,-3490.78 2911.0725,-5762.474 2916.4805,-5904.1071 2932.7842,-6331.0928 2973.2293,-6851.8896 2982.0475,-6962.7386"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2978.5775,-6963.2549 2982.8624,-6972.9446 2985.5553,-6962.6977 2978.5775,-6963.2549"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge413" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2260.773,-3149.255C2268.6095,-3152.6989 2276.0293,-3157.2068 2282.0427,-3163.1071 2316.9563,-3197.364 2289.4906,-3227.3922 2318.0427,-3267.1071 2370.6885,-3340.3353 2417.7306,-3324.6243 2478.6731,-3391.1071 2594.2874,-3517.2319 2636.2911,-3551.5669 2686.5776,-3715.1071 2731.5934,-3861.5058 2712.1981,-4940.2959 2722.5776,-5093.1071 2741.3437,-5369.3889 2786.4788,-5703.265 2798.5292,-5789.8094"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2795.0664,-5790.3199 2799.9181,-5799.7386 2801.999,-5789.3501 2795.0664,-5790.3199"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge439" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2207.4843,-3149.222C2218.4823,-3201.6499 2264.9295,-3429.6005 2282.0427,-3619.1071 2298.7351,-3803.9536 2277.4274,-5108.007 2318.0427,-5289.1071 2331.8191,-5350.5348 2367.2722,-5416.6319 2386.1325,-5448.9644"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2383.3018,-5451.0531 2391.4106,-5457.872 2389.324,-5447.4847 2383.3018,-5451.0531"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2263.2254,-3149.1239C2270.3528,-3152.5944 2276.9167,-3157.1446 2282.0427,-3163.1071 2346.0609,-3237.5727 2260.8686,-3301.2661 2318.0427,-3381.1071 2365.1901,-3446.9462 2436.3329,-3398.0784 2478.6731,-3467.1071 2528.1227,-3547.7265 2503.9128,-5075.1445 2514.6731,-5169.1071 2556.9891,-5538.6239 2643.7475,-5618.6496 2686.5776,-5988.1071 2763.575,-6652.2949 2639.9956,-6828.5906 2722.5776,-7492.1071 2738.2117,-7617.7213 2779.3917,-7764.5335 2795.2131,-7818.1532"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.8981,-7819.2849 2798.1053,-7827.871 2798.6072,-7817.288 2791.8981,-7819.2849"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge554" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-3633.1071C2406.6985,-3669.4167 2456.3067,-3627.3128 2478.6731,-3657.1071 2518.8646,-3710.6463 2510.9418,-8410.2649 2514.6731,-8477.1071 2532.562,-8797.5683 2584.6923,-9185.5187 2597.6722,-9279.0794"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.2087,-9279.5846 2599.0561,-9289.0055 2601.1416,-9278.618 2594.2087,-9279.5846"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2226.3541,-3149.2176C2244.45,-3159.9163 2269.4679,-3177.8836 2282.0427,-3201.1071 2352.7132,-3331.6227 2261.2945,-3395.9638 2318.0427,-3533.1071 2339.8382,-3585.7801 2385.5959,-3577.5498 2398.3579,-3633.1071"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge647" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2230.1369,-3127.0146C2308.9199,-3093.9587 2554.5268,-3005.5968 2686.5776,-3125.1071 2726.7319,-3161.448 2877.4299,-5011.0357 2880.4805,-5065.1071 2884.782,-5141.3535 2872.4777,-7751.6909 2916.4805,-7814.1071 2919.3794,-7818.2192 2923.0376,-7821.6561 2927.1433,-7824.5284"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2925.6841,-7827.7263 2936.0997,-7829.6669 2929.1676,-7821.6546 2925.6841,-7827.7263"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M2205.1267,-4129.1071C2231.9118,-4119.9694 2304.9874,-4138.1653 2353.2009,-4152.1368"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2352.505,-4155.5802 2363.0862,-4155.0426 2354.4792,-4148.8644 2352.505,-4155.5802"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge628" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2801.5291,-5079.1071C2830.7939,-5396.1433 2861.9777,-5473.2612 2880.4805,-5791.1071 2920.1541,-6472.6317 2845.7511,-11256.1026 2916.4805,-11935.1071 2928.7738,-12053.1232 2964.046,-12191.4338 2977.9902,-12243.1784"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2974.6237,-12244.1372 2980.626,-12252.8678 2981.3782,-12242.2997 2974.6237,-12244.1372"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2043.6985,-4278.2758C2060.9576,-4275.4208 2080.2027,-4269.0221 2092.2107,-4255.1071 2169.577,-4165.4546 2057.7807,-4086.3054 2128.2107,-3991.1071 2172.9958,-3930.5722 2238.7539,-3981.7209 2282.0427,-3920.1071 2335.2586,-3844.364 2249.817,-3567.6706 2318.0427,-3505.1071 2370.6601,-3456.8565 2422.1989,-3461.4335 2478.6731,-3505.1071 2769.2787,-3729.8431 2630.2959,-3942.0778 2686.5776,-4305.1071 2709.5568,-4453.3277 2669.622,-4838.7751 2722.5776,-4979.1071 2742.5702,-5032.0871 2796.3241,-5022.7201 2801.5291,-5079.1071"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge697" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2015.9791,-4268.8821C2035.0739,-4246.4905 2076.4089,-4193.8731 2092.2107,-4141.1071 2177.1584,-3857.4455 2072.3379,-3099.8961 2128.2107,-2809.1071 2165.5637,-2614.704 2229.0657,-2581.8458 2282.0427,-2391.1071 2304.8098,-2309.1364 2268.6365,-2272.3643 2318.0427,-2203.1071 2497.758,-1951.184 2737.3717,-1811.8795 2983.7629,-1999.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2983.7629,-1999.1071C3098.3074,-2062.3366 3116.7988,-2107.567 3169.983,-2227.1071"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2043.7767,-4278.3429C2061.0544,-4275.5037 2080.2924,-4269.099 2092.2107,-4255.1071 2177.0015,-4155.5642 2065.1081,-4077.6337 2128.2107,-3963.1071 2138.964,-3943.5906 2158.4312,-3927.737 2175.0894,-3916.815"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2177.3532,-3919.5278 2183.9818,-3911.2627 2173.6458,-3913.5902 2177.3532,-3919.5278"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge472" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2015.9412,-4268.8707C2034.9697,-4246.4591 2076.1939,-4193.8082 2092.2107,-4141.1071 2158.3567,-3923.4626 2072.2531,-3338.5911 2128.2107,-3118.1071 2165.949,-2969.4105 2234.7276,-2955.0391 2282.0427,-2809.1071 2312.0596,-2716.5275 2262.5145,-2673.0359 2318.0427,-2593.1071 2434.2115,-2425.8908 2527.9678,-2437.9695 2722.5776,-2378.1071 2778.6075,-2360.8722 2961.662,-2286.8122 2983.7629,-2341.1071"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge426" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2043.8831,-4277.4921C2060.7612,-4274.427 2079.6321,-4268.0779 2092.2107,-4255.1071 2136.9372,-4208.9861 2093.4317,-4169.1259 2128.2107,-4115.1071 2175.7488,-4041.2708 2234.7527,-4065.1025 2282.0427,-3991.1071 2317.5682,-3935.5199 2266.0451,-3887.7057 2318.0427,-3847.1071 2374.3137,-3803.172 2426.0902,-3798.8189 2478.6731,-3847.1071 2513.3343,-3878.9374 2507.9112,-4222.5362 2514.6731,-4269.1071 2569.0534,-4643.6386 2618.035,-4730.907 2686.5776,-5103.1071 2736.3285,-5373.2639 2785.6934,-5703.5428 2798.396,-5789.7296"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2794.9643,-5790.4504 2799.882,-5799.8347 2801.8898,-5789.4319 2794.9643,-5790.4504"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge440" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2008.8536,-4291.2526C2029.5656,-4372.9493 2162.2021,-4887.3872 2318.0427,-5289.1071 2340.9234,-5348.0881 2372.6432,-5415.7555 2388.5026,-5448.8031"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2385.3926,-5450.4118 2392.8879,-5457.8998 2391.6981,-5447.372 2385.3926,-5450.4118"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2009.1967,-4291.2561C2022.3691,-4338.4522 2073.2203,-4526.6537 2092.2107,-4685.1071 2158.0301,-5234.2973 2038.9781,-5383.232 2128.2107,-5929.1071 2142.7159,-6017.8421 2180.0453,-6118.8839 2196.786,-6161.466"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2193.5367,-6162.7668 2200.4827,-6170.767 2200.0417,-6160.1813 2193.5367,-6162.7668"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2011.9402,-4291.1858C2043.0748,-4350.0068 2190.4154,-4632.1878 2282.0427,-4875.1071 2334.5386,-5014.2823 2378.6987,-5188.1909 2393.2632,-5247.868"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2389.948,-5249.0487 2395.7048,-5257.9431 2396.7511,-5247.4001 2389.948,-5249.0487"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2009.2801,-4291.2466C2022.7879,-4338.4041 2074.7971,-4526.4726 2092.2107,-4685.1071 2140.4906,-5124.9277 2106.4856,-8225.1783 2128.2107,-8667.1071 2144.7069,-9002.6701 2191.2736,-9409.8459 2202.6137,-9506.0371"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2199.139,-9506.4577 2203.791,-9515.9766 2206.0904,-9505.6343 2199.139,-9506.4577"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge401" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2043.8185,-4276.9039C2060.479,-4273.7019 2079.1894,-4267.4077 2092.2107,-4255.1071 2127.1575,-4222.0945 2093.5969,-4186.4687 2128.2107,-4153.1071 2153.9945,-4128.256 2171.2343,-4140.6694 2205.1267,-4129.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-4129.1071C2320.3881,-4089.7859 2391.8215,-4027.7365 2478.6731,-4113.1071 2561.6102,-4194.6299 2444.0643,-6113.7009 2514.6731,-6206.1071 2520.1575,-6213.2846 2527.5825,-6218.4916 2535.784,-6222.2529"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.7217,-6225.5941 2545.3118,-6225.9131 2537.2321,-6219.0597 2534.7217,-6225.5941"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge516" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2009.2185,-4291.2536C2022.4786,-4338.4392 2073.6327,-4526.6048 2092.2107,-4685.1071 2102.0244,-4768.8354 2090.1781,-6126.8724 2128.2107,-6202.1071 2167.2075,-6279.2492 2243.0167,-6243.9797 2282.0427,-6321.1071 2355.8079,-6466.8894 2244.7697,-7645.0768 2318.0427,-7791.1071 2328.2623,-7811.4744 2348.4786,-7827.2757 2366.0708,-7837.9593"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2364.5511,-7841.123 2374.9643,-7843.0768 2368.0424,-7835.0557 2364.5511,-7841.123"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge567" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.1267,-4129.1071C2245.7932,-4115.3121 2374.8008,-4091.2027 2398.3579,-4127.1071"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1271.3034,-3962.9826C1288.0269,-3956.1594 1306.3627,-3945.6665 1317.5017,-3930.1071 1378.4974,-3844.9057 1284.8022,-3776.2281 1353.5017,-3697.1071 1377.6297,-3669.3189 1400.0439,-3689.9779 1432.7505,-3673.1071"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M1432.7505,-3673.1071C1694.3076,-3538.1895 1818.3396,-3625.3596 2092.2107,-3733.1071 2191.5106,-3772.1741 2228.6077,-3787.7415 2282.0427,-3880.1071 2340.6805,-3981.4659 2242.3334,-4051.7757 2318.0427,-4141.1071 2320.8576,-4144.4284 2324.106,-4147.3152 2327.6489,-4149.8236"/>
<polygon fill="#ff7500" stroke="#ff7500" points="2326.0002,-4152.9152 2336.3846,-4155.0164 2329.577,-4146.898 2326.0002,-4152.9152"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.7505,-3673.1071C1450.6142,-3666.5569 1997.2226,-3835.4841 2159.8913,-3886.0249"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2159.0073,-3889.4152 2169.5955,-3889.041 2161.085,-3882.7306 2159.0073,-3889.4152"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1258.0211,-3985.1327C1277.9246,-3995.4594 1304.6249,-4012.9339 1317.5017,-4037.1071 1354.8472,-4107.2148 1304.5765,-4688.5283 1353.5017,-4751.1071 1398.8353,-4809.092 1458.9447,-4748.0915 1511.9993,-4799.1071 1547.257,-4833.0097 1519.3646,-4863.4517 1547.9993,-4903.1071 1601.0839,-4976.6225 1648.7428,-4960.2661 1710.019,-5027.1071 1752.4301,-5073.3697 1788.3095,-5138.8654 1804.9727,-5171.688"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1801.9101,-5173.3892 1809.5131,-5180.7679 1808.171,-5170.2584 1801.9101,-5173.3892"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1235.9307,-3985.2018C1248.2627,-4037.5389 1300.2278,-4265.142 1317.5017,-4455.1071 1407.6607,-5446.6041 1278.9684,-7942.3132 1353.5017,-8935.1071 1369.2346,-9144.6717 1414.803,-9395.5386 1428.6873,-9468.9613"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1425.2587,-9469.6671 1430.5668,-9478.8363 1432.1353,-9468.3582 1425.2587,-9469.6671"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge428" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1241.9338,-3962.9184C1259.0767,-3940.1724 1297.439,-3886.3394 1317.5017,-3835.1071 1346.6152,-3760.7625 1321.1964,-3732.1214 1353.5017,-3659.1071 1534.2079,-3250.6872 1699.7764,-3145.2246 2128.2107,-3019.1071 2278.3339,-2974.9156 2350.2232,-2963.7176 2478.6731,-3053.1071 2504.8272,-3071.308 2492.8221,-3091.9156 2514.6731,-3115.1071 2577.5403,-3181.8311 2642.4437,-3148.7543 2686.5776,-3229.1071 2736.4401,-3319.8897 2715.9104,-4989.747 2722.5776,-5093.1071 2740.4032,-5369.4512 2786.2203,-5703.2821 2798.4759,-5789.813"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2795.0146,-5790.3335 2799.8889,-5799.7405 2801.9448,-5789.3471 2795.0146,-5790.3335"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1306.0938,-3982.3696C1310.1969,-3984.4942 1314.0486,-3987.0475 1317.5017,-3990.1071 1356.9524,-4025.063 1329.6147,-4056.1211 1353.5017,-4103.1071 1356.3262,-4108.6629 1881.8822,-4821.2037 1883.8806,-4827.1071 1946.2413,-5011.3238 1896.5263,-6384.0288 1919.8806,-6577.1071 1961.9921,-6925.2578 2048.9336,-6999.0994 2092.2107,-7347.1071 2164.6359,-7929.5059 2094.054,-8081.2171 2128.2107,-8667.1071 2147.7641,-9002.5059 2192.0349,-9409.805 2202.7559,-9506.0295"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2199.278,-9506.4235 2203.8679,-9515.9725 2206.2347,-9505.6454 2199.278,-9506.4235"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1820.9429,-5180.8369C1834.9131,-5153.9366 1869.5403,-5083.4881 1883.8806,-5020.1071 1939.2118,-4775.5552 1855.7983,-4699.513 1919.8806,-4457.1071 1935.871,-4396.62 1973.0529,-4332.131 1992.942,-4300.2937"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1996.1175,-4301.8216 1998.5167,-4291.5019 1990.2057,-4298.073 1996.1175,-4301.8216"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge627" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1440.7249,-9501.4187C1478.0078,-9554.8988 1636.407,-9788.8156 1710.019,-10005.1071 1741.9409,-10098.902 1715.3046,-10130.9099 1746.019,-10225.1071 1901.8081,-10702.8915 2446.5713,-11869.3639 2801.5291,-12225.1071"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1436.7034,-9478.8785C1450.3694,-9440.4455 1497.5514,-9310.9243 1547.9993,-9209.1071 1579.5743,-9145.3803 1596.2101,-9134.2127 1629.0092,-9071.1071"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-9337.1071C2084.2758,-9284.1907 2154.6008,-9176.2022 2282.0427,-8933.1071 2350.956,-8801.6552 2260.0996,-8737.7498 2318.0427,-8601.1071 2361.6112,-8498.3631 2413.0307,-8498.3602 2478.6731,-8408.1071 2522.7846,-8347.4572 2568.3097,-8271.0293 2589.0617,-8235.2781"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.265,-8236.7299 2594.2361,-8226.3201 2586.2036,-8233.2286 2592.265,-8236.7299"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-9413.1071C1660.288,-9392.329 1675.0644,-9402.8281 1710.019,-9389.1071 1758.4684,-9370.0889 1764.3892,-9349.4623 1814.9498,-9337.1071"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1814.9498,-9337.1071C2191.3388,-9245.1313 2375.1031,-9550.5671 2686.5776,-9320.1071 2727.9296,-9289.5108 2693.0801,-9252.2499 2722.5776,-9210.1071 2748.1618,-9173.5553 2794.917,-9192.2304 2801.5291,-9148.1071"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.2658,-9478.816C1442.7564,-9417.1309 1486.2634,-9121.3117 1547.9993,-9057.1071 1551.3913,-9053.5794 1555.2689,-9050.5463 1559.4485,-9047.9389"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1561.2208,-9050.9603 1568.3934,-9043.1626 1557.9236,-9044.7855 1561.2208,-9050.9603"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1454.4472,-9478.9945C1477.3226,-9467.5492 1514.6034,-9449.6594 1547.9993,-9437.1071 1583.1496,-9423.8953 1597.2778,-9433.1874 1629.0092,-9413.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1629.0092,-9413.1071C1660.7405,-9393.0268 1686.0057,-9417.9767 1710.019,-9389.1071 1758.8883,-9330.3551 1718.6493,-9118.4576 1746.019,-9047.1071 1783.3854,-8949.6963 1847.7022,-8954.9653 1883.8806,-8857.1071 1952.8403,-8670.5793 1876.9913,-8605.294 1919.8806,-8411.1071 1967.5044,-8195.4843 2051.1145,-8162.0687 2092.2107,-7945.1071 2129.0882,-7750.4174 2069.3013,-6351.2993 2128.2107,-6162.1071 2165.1018,-6043.6283 2241.927,-6046.5333 2282.0427,-5929.1071 2351.2029,-5726.6621 2265.6805,-5656.5325 2318.0427,-5449.1071 2333.4513,-5388.0684 2368.1906,-5321.8012 2386.5201,-5289.3422"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2389.7102,-5290.8146 2391.6422,-5280.3973 2383.6356,-5287.3361 2389.7102,-5290.8146"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1482.3969,-9487.464C1610.5957,-9483.7303 1952.4346,-9494.0951 2092.2107,-9698.1071 2159.3197,-9796.0569 2052.8297,-10674.3712 2128.2107,-10766.1071 2287.7962,-10960.3167 2507.7689,-11032.7773 2686.5776,-10856.1071 2745.7028,-10797.689 2673.0684,-7930.87 2722.5776,-7864.1071 2731.3987,-7852.212 2745.9022,-7845.8417 2760.0877,-7842.4761"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.1141,-7845.843 2770.2749,-7840.5204 2759.7943,-7838.9686 2761.1141,-7845.843"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-9413.1071C1699.3264,-9369.6916 1732.4017,-9409.2053 1814.9498,-9413.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.9498,-9413.1071C1878.0146,-9416.088 2034.8691,-9448.6875 2092.2107,-9475.1071 2110.3754,-9483.4763 2110.4605,-9492.8914 2128.2107,-9502.1071 2135.9973,-9506.1498 2144.565,-9509.7084 2153.0687,-9512.7784"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2152.0029,-9516.1128 2162.5974,-9516.0366 2154.2677,-9509.4893 2152.0029,-9516.1128"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-9413.1071C1660.288,-9392.329 1680.814,-9412.7113 1710.019,-9389.1071 1736.0058,-9368.104 1727.0916,-9350.6425 1746.019,-9323.1071 1799.5739,-9245.1962 1830.3258,-9239.018 1883.8806,-9161.1071 1902.808,-9133.5717 1900.9918,-9122.669 1919.8806,-9095.1071 2060.7468,-8889.5599 2188.6219,-8898.1168 2282.0427,-8667.1071 2372.5525,-8443.2959 2226.4071,-8348.4597 2318.0427,-8125.1071 2359.5019,-8024.0545 2439.4169,-8041.0357 2478.6731,-7939.1071 2541.4249,-7776.172 2464.4756,-6535.337 2514.6731,-6368.1071 2528.6819,-6321.4376 2563.1957,-6275.0857 2583.9768,-6250.0668"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.8995,-6252.0318 2590.6985,-6242.1415 2581.561,-6247.5041 2586.8995,-6252.0318"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge506" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.0092,-9413.1071C1660.9609,-9393.3794 1683.999,-9416.1821 1710.019,-9389.1071 1755.1335,-9342.1636 1719.1203,-9306.3985 1746.019,-9247.1071 1790.6221,-9148.7911 1822.73,-9136.0794 1883.8806,-9047.1071 1976.6557,-8912.1222 2020.382,-8890.3103 2092.2107,-8743.1071 2110.4088,-8705.8126 2303.1698,-8069.8478 2318.0427,-8031.1071 2340.2924,-7973.1516 2372.0405,-7907.0855 2388.145,-7874.4956"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2391.2981,-7876.0152 2392.6129,-7865.5023 2385.0291,-7872.9008 2391.2981,-7876.0152"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge533" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1459.9335,-9501.2836C1514.2117,-9523.5658 1639.9248,-9574.9996 1746.019,-9617.1071 1824.5116,-9648.2598 1916.7176,-9683.8339 1967.537,-9703.3522"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1966.5426,-9706.7194 1977.1327,-9707.0357 1969.0513,-9700.1844 1966.5426,-9706.7194"/>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge484" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M3171.4425,-5298.7471C3188.3708,-5166.9836 3347.2807,-3930.0912 3370.117,-3752.3421"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3373.6186,-3752.5532 3371.4215,-3742.1887 3366.6757,-3751.6612 3373.6186,-3752.5532"/>
</g>
<!-- sourcefile~datadefineequip.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge492" class="edge">
<title>sourcefile~datadefineequip.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M759.4265,-1000.7255C785.0903,-975.5336 848.6645,-913.1666 902.05,-861.1071"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M902.05,-861.1071C953.1249,-811.3009 946.5065,-781.5206 998.9033,-733.1071 1211.6382,-536.5449 1277.493,-485.6404 1547.9993,-382.1071 1689.2739,-328.0358 1737.9559,-366.9593 1883.8806,-327.1071 1900.4414,-322.5843 1903.0077,-316.2725 1919.8806,-313.1071 1995.1585,-298.9849 2017.6098,-295.7603 2092.2107,-313.1071 2278.6339,-356.4558 2314.6297,-404.5044 2478.6731,-503.1071 2495.589,-513.2749 2497.5606,-519.2738 2514.6731,-529.1071 2740.8005,-659.0457 2818.0336,-649.9614 3051.0454,-767.1071 3143.1057,-813.39 3199.1163,-793.2305 3252.9207,-881.1071 3331.3541,-1009.2095 3368.8428,-3454.8855 3372.5405,-3709.6956"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="3369.0434,-3709.927 3372.6871,-3719.8755 3376.0427,-3709.8261 3369.0434,-3709.927"/>
</g>
<!-- sourcefile~datadefineequip.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge463" class="edge">
<title>sourcefile~datadefineequip.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.05,-861.1071C1010.3946,-761.4383 1086.0694,-861.1071 1233.2849,-861.1071 1233.2849,-861.1071 1233.2849,-861.1071 1432.7505,-861.1071 1556.4417,-861.1071 1622.566,-797.6343 1710.019,-885.1071 1775.7806,-950.8835 1689.3871,-1228.3241 1746.019,-1302.1071 1796.0612,-1367.3046 1841.7365,-1339.6427 1919.8806,-1365.1071 1995.7061,-1389.816 2034.7964,-1359.7571 2092.2107,-1415.1071 2128.9403,-1450.5161 2086.8636,-1494.2192 2128.2107,-1524.1071 2183.62,-1564.16 2213.6731,-1524.2761 2282.0427,-1524.1071 2548.0324,-1523.4496 2615.3461,-1538.4312 2880.4805,-1517.1071 2926.6545,-1513.3934 2950.1586,-1471.2233 2983.7629,-1503.1071"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge675" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2801.5291,-7878.1071C2819.2512,-7846.6666 2852.2903,-7881.6437 2880.4805,-7859.1071 2908.7361,-7836.5182 2888.2666,-7808.7483 2916.4805,-7786.1071 3006.9426,-7713.5127 3060.3655,-7686.1947 3169.983,-7724.1071"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge453" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2801.5291,-7878.1071C2823.3264,-7849.3415 2855.4659,-7885.1235 2880.4805,-7859.1071 2897.2658,-7841.6496 3048.3993,-7028.1801 3051.0454,-7004.1071 3060.9543,-6913.9613 3045.5329,-5452.7368 3087.0454,-5372.1071 3097.4167,-5351.963 3117.6777,-5336.6263 3135.5771,-5326.2458"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3137.5696,-5329.1451 3144.6573,-5321.2701 3134.2056,-5323.0064 3137.5696,-5329.1451"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2607.5907,-8203.878C2633.7624,-8161.5919 2728.4477,-8007.7593 2801.5291,-7878.1071"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2601.0579,-8203.7897C2603.5251,-8155.4468 2619.6844,-7964.1857 2722.5776,-7864.1071 2732.7617,-7854.2016 2746.8466,-7848.2182 2760.3037,-7844.605"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.4388,-7847.9352 2770.397,-7842.2782 2759.8663,-7841.1141 2761.4388,-7847.9352"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge683" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M3033.7627,-6973.0729C3040.4467,-6969.6142 3046.5375,-6965.0721 3051.0454,-6959.1071 3151.6478,-6825.9884 3004.9768,-5437.3208 3169.983,-5462.1071"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge459" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3034.725,-6972.9406C3041.1061,-6969.497 3046.8527,-6964.9942 3051.0454,-6959.1071 3102.2046,-6887.2733 3046.6524,-5450.5021 3087.0454,-5372.1071 3097.423,-5351.9662 3117.6841,-5336.6296 3135.582,-5326.2483"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3137.5742,-5329.1477 3144.6612,-5321.2721 3134.2097,-5323.0093 3137.5742,-5329.1477"/>
</g>
<!-- sourcefile~hvacmixercomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge467" class="edge">
<title>sourcefile~hvacmixercomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1865.8369,-5449.0165C1872.7283,-5445.5651 1879.0703,-5441.04 1883.8806,-5435.1071 1956.2423,-5345.8593 1876.2299,-5285.3897 1919.8806,-5179.1071 2077.9375,-4794.2637 2342.4211,-4821.1997 2478.6731,-4428.1071 2502.3895,-4359.6843 2471.922,-3183.5579 2514.6731,-3125.1071 2594.38,-3016.129 2671.6739,-3062.0808 2801.5291,-3025.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2801.5291,-3025.1071C2878.2301,-2999.0919 2917.4167,-2978.6526 2983.7629,-3025.1071"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge694" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2811.9915,-5822.501C2840.8645,-5852.5447 2923.5081,-5929.0135 2983.7629,-5890.1071"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2983.7629,-5890.1071C3158.0378,-5777.5783 2964.8371,-5431.2913 3169.983,-5462.1071"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge470" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2802.5143,-5799.8073C2811.8274,-5694.6573 2886.1887,-4891.0592 2983.7629,-4889.1071"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge661" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2813.439,-5822.2422C2831.1961,-5839.6012 2864.2559,-5874.9919 2880.4805,-5912.1071 3070.2015,-6346.1126 3002.5704,-6492.933 3051.0454,-6964.1071 3060.2879,-7053.9438 3045.1224,-7696.1164 3087.0454,-7776.1071 3097.7672,-7796.5646 3118.4379,-7812.2918 3136.4599,-7822.9159"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3135.1383,-7826.1866 3145.5761,-7828.0045 3138.5502,-7820.0743 3135.1383,-7826.1866"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge700" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M3169.983,-5462.1071C3290.705,-5480.2413 3364.2172,-7529.5929 3372.1328,-7760.9319"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3368.6398,-7761.1999 3372.4775,-7771.0753 3375.6358,-7760.9621 3368.6398,-7761.1999"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M2404.7098,-5457.7168C2419.9593,-5429.8572 2458.8412,-5355.682 2478.6731,-5289.1071 2507.46,-5192.4706 2462.0184,-5151.1001 2514.6731,-5065.1071 2606.6099,-4914.9606 2733.6814,-4815.9146 2880.4805,-4913.1071 3110.4847,-5065.388 2897.1968,-5421.1307 3169.983,-5462.1071"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge476" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2405.313,-5457.8738C2421.9018,-5430.3627 2463.5325,-5356.903 2478.6731,-5289.1071 2522.8059,-5091.4912 2455.2777,-3660.6838 2514.6731,-3467.1071 2583.3687,-3243.22 2577.2792,-3092.6091 2801.5291,-3025.1071"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2445.0161,-8230.4936C2468.8102,-8228.1409 2498.3386,-8225.2211 2525.2576,-8222.5594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2525.8224,-8226.0207 2535.4294,-8221.5536 2525.1335,-8219.0547 2525.8224,-8226.0207"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2412.3195,-8223.9741C2429.8803,-8209.3419 2459.9905,-8182.0798 2478.6731,-8153.1071 2559.8066,-8027.2864 2509.3635,-7957.7864 2600.6254,-7839.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2600.6254,-7839.1071C2712.5556,-7693.5501 2695.4267,-7627.9654 2801.5291,-7478.1071"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge411" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2414.7848,-8224.0357C2433.9783,-8210.0513 2464.8647,-8184.0413 2478.6731,-8153.1071 2529.1414,-8040.0455 2497.462,-7719.7193 2514.6731,-7597.1071 2564.6224,-7241.2682 2638.5394,-7163.2091 2686.5776,-6807.1071 2726.2667,-6512.8962 2679.7634,-6433.8796 2722.5776,-6140.1071 2739.8185,-6021.8078 2779.5469,-5883.6643 2795.11,-5832.0001"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2798.4909,-5832.9119 2798.0474,-5822.3264 2791.7928,-5830.878 2798.4909,-5832.9119"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2600.6254,-7839.1071C2619.3125,-7814.8059 2707.0592,-7823.8773 2760.216,-7831.9486"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2759.9338,-7835.4471 2770.3554,-7833.5394 2761.0188,-7828.5317 2759.9338,-7835.4471"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2415.3629,-8223.8908C2434.8083,-8209.9475 2465.6334,-8184.157 2478.6731,-8153.1071 2555.4832,-7970.2074 2457.902,-6558.1838 2514.6731,-6368.1071 2528.6178,-6321.4184 2563.1544,-6275.0733 2583.9568,-6250.0609"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.8802,-6252.0255 2590.6859,-6242.1377 2581.5448,-6247.4941 2586.8802,-6252.0255"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge552" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2400.2028,-8246.4332C2410.6551,-8310.4073 2463.7759,-8632.9815 2514.6731,-8895.1071 2543.3068,-9042.5734 2582.4733,-9219.184 2595.8917,-9279.0717"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.4841,-9279.8716 2598.0892,-9288.8624 2599.3142,-9278.3386 2592.4841,-9279.8716"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge587" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2399.4462,-8246.3088C2414.3769,-8399.9957 2578.2425,-10086.7133 2598.562,-10295.8683"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2595.0853,-10296.2789 2599.536,-10305.8936 2602.0525,-10295.602 2595.0853,-10296.2789"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge654" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2404.9172,-8246.1376C2418.7536,-8269.4578 2451.8612,-8325.5329 2478.6731,-8373.1071 2495.0782,-8402.2158 2488.5219,-8418.309 2514.6731,-8439.1071 2545.7151,-8463.7949 2563.0044,-8450.547 2600.6254,-8463.1071"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2600.6254,-8463.1071C2877.7656,-8555.633 2966.0984,-7979.0518 2981.2594,-7860.2283"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2984.7461,-7860.5505 2982.502,-7850.196 2977.7992,-7859.6899 2984.7461,-7860.5505"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2249.2458,-10740.7292C2261.5614,-10737.0906 2273.8105,-10731.062 2282.0427,-10721.1071 2309.8766,-10687.4487 2474.8923,-9204.6194 2478.6731,-9161.1071 2493.1172,-8994.8749 2476.5324,-8573.5481 2514.6731,-8411.1071 2530.5878,-8343.3266 2569.2553,-8269.7607 2588.8405,-8235.1936"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2591.8793,-8236.9302 2593.8237,-8226.5153 2585.8088,-8233.4444 2591.8793,-8236.9302"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2211.2554,-10757.3112C2225.8816,-10782.8123 2265.5586,-10845.0652 2318.0427,-10872.1071 2463.9048,-10947.261 2569.3188,-11008.886 2686.5776,-10894.1071 2753.4499,-10828.6491 2680.7636,-9293.8223 2722.5776,-9210.1071 2742.5139,-9170.1931 2795.1869,-9192.27 2801.5291,-9148.1071"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2227.2342,-10735.0546C2245.637,-10724.5038 2270.6091,-10706.7216 2282.0427,-10683.1071 2332.4561,-10578.9857 2304.5784,-8716.0048 2318.0427,-8601.1071 2333.6589,-8467.846 2376.2445,-8311.7436 2392.2065,-8256.1038"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.6107,-8256.9307 2395.028,-8246.3519 2388.8865,-8254.9851 2395.6107,-8256.9307"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2219.4101,-10757.1611C2283.8122,-10805.6345 2549.9593,-10991.0915 2686.5776,-10856.1071 2745.7028,-10797.689 2673.0684,-7930.87 2722.5776,-7864.1071 2731.3987,-7852.212 2745.9022,-7845.8417 2760.0877,-7842.4761"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.1141,-7845.843 2770.2749,-7840.5204 2759.7943,-7838.9686 2761.1141,-7845.843"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge398" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2227.1974,-10735.0367C2245.5766,-10724.4745 2270.5348,-10706.6854 2282.0427,-10683.1071 2319.2381,-10606.8983 2306.6815,-9241.144 2318.0427,-9157.1071 2357.4484,-8865.6298 2440.2617,-8806.7171 2478.6731,-8515.1071 2509.8314,-8278.5613 2446.7817,-6596.833 2514.6731,-6368.1071 2528.5384,-6321.3948 2563.1032,-6275.0581 2583.9321,-6250.0535"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.8564,-6252.0177 2590.6703,-6242.1331 2581.5247,-6247.4818 2586.8564,-6252.0177"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge563" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2249.3136,-10739.8415C2261.3362,-10736.1614 2273.4066,-10730.3326 2282.0427,-10721.1071 2326.5375,-10673.5758 2272.9835,-10626.1037 2318.0427,-10579.1071 2343.826,-10552.2152 2379.5101,-10587.243 2398.3579,-10555.1071"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1633.2373,-9020.7515C1645.9554,-8987.7913 1686.6765,-8890.5551 1746.019,-8829.1071 1796.1859,-8777.1604 1827.65,-8788.4204 1883.8806,-8743.1071 2099.2791,-8569.5287 2111.5575,-8481.199 2318.0427,-8297.1071 2336.1256,-8280.9853 2357.9594,-8264.2915 2374.295,-8252.2933"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2376.7191,-8254.8579 2382.7459,-8246.1442 2372.6006,-8249.1977 2376.7191,-8254.8579"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2257.5871,-6185.5331C2296.4366,-6187.8971 2350.6743,-6190.8348 2398.3579,-6192.1071"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2398.3579,-6192.1071C2578.2752,-6196.9078 2678.1589,-6023.061 2801.5291,-6154.1071"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge416" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2247.2056,-6171.0679C2258.7941,-6167.3274 2271.1625,-6162.661 2282.0427,-6157.1071 2497.8143,-6046.9643 2506.3893,-5945.4295 2722.5776,-5836.1071 2730.6809,-5832.0095 2739.5911,-5828.412 2748.417,-5825.3175"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2749.5345,-5828.6343 2757.9187,-5822.157 2747.3252,-5821.9921 2749.5345,-5828.6343"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2205.7738,-6193.3841C2213.7189,-6331.608 2292.594,-7697.0769 2318.0427,-7874.1071 2336.8463,-8004.9114 2377.3294,-8158.734 2392.4775,-8214.0111"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2389.198,-8215.2844 2395.2322,-8223.9929 2395.9457,-8213.4221 2389.198,-8215.2844"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2398.3579,-6192.1071C2443.2902,-6193.306 2589.7835,-6148.4859 2600.6254,-6192.1071"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2398.3579,-6192.1071C2452.0778,-6193.5405 2512.4224,-6206.7282 2553.106,-6217.3774"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2552.4452,-6220.8235 2563.0097,-6220.0214 2554.2509,-6214.0604 2552.4452,-6220.8235"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge556" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2225.0357,-6193.1562C2242.759,-6204.0463 2267.992,-6222.3389 2282.0427,-6245.1071 2334.3171,-6329.8141 2466.372,-7020.3317 2478.6731,-7119.1071 2553.2876,-7718.2465 2475.286,-7874.6256 2514.6731,-8477.1071 2535.6111,-8797.3836 2585.4685,-9185.4717 2597.8204,-9279.0704"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2594.3528,-9279.5471 2599.1363,-9289.0006 2601.2922,-9278.6275 2594.3528,-9279.5471"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge686" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M1822.1579,-4989.0886C1836.4213,-4966.7244 1868.2171,-4913.9742 1883.8806,-4865.1071 1916.9375,-4761.976 1865.9112,-4718.0011 1919.8806,-4624.1071 1979.0169,-4521.2239 2030.0794,-4523.8327 2128.2107,-4457.1071 2276.5141,-4356.2664 2386.5694,-4410.989 2478.6731,-4257.1071 2556.3066,-4127.4012 2460.2593,-3038.138 2514.6731,-2897.1071 2556.8651,-2787.7529 2628.1729,-2798.7309 2686.5776,-2697.1071 2710.9503,-2654.6988 2699.094,-2636.0141 2722.5776,-2593.1071 2776.9516,-2493.7602 2818.0525,-2487.6009 2880.4805,-2393.1071 2898.8986,-2365.2285 2891.0768,-2348.8119 2916.4805,-2327.1071 2940.6186,-2306.4835 2956.0385,-2318.5778 2983.7629,-2303.1071"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1834.1779,-5011.2985C1850.77,-5022.1663 1873.6329,-5040.34 1883.8806,-5063.1071 1936.6068,-5180.2477 1884.2138,-7251.6978 1919.8806,-7375.1071 2004.2593,-7667.0627 2140.6924,-7686.0757 2282.0427,-7955.1071 2331.0938,-8048.4658 2374.6095,-8167.1911 2391.2113,-8214.3988"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2387.907,-8215.5528 2394.5071,-8223.8407 2394.5159,-8213.2459 2387.907,-8215.5528"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1847.4566,-5011.1811C1859.045,-5015.3167 1872.1329,-5020.204 1883.8806,-5025.1071 2071.0444,-5103.2235 2288.6441,-5212.8436 2367.6901,-5253.3023"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2366.1362,-5256.4388 2376.6316,-5257.8867 2369.3299,-5250.2098 2366.1362,-5256.4388"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1821.9543,-4989.0206C1835.8517,-4966.5341 1867.0219,-4913.5749 1883.8806,-4865.1071 1910.6832,-4788.0511 1856.788,-4736.8307 1919.8806,-4685.1071 2182.4697,-4469.8355 2420.2599,-4926.8736 2478.6731,-5051.1071 2529.9409,-5160.1438 2493.5888,-5473.4781 2514.6731,-5592.1071 2562.169,-5859.3387 2644.3089,-5909.9991 2686.5776,-6178.1071 2777.5594,-6755.1984 2649.4193,-6912.4867 2722.5776,-7492.1071 2738.4289,-7617.6941 2779.4784,-7764.5226 2795.239,-7818.1499"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.9223,-7819.2761 2798.1199,-7827.8691 2798.6337,-7817.2868 2791.9223,-7819.2761"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1877.7174,-4994.1358C2014.5857,-4985.0652 2338.7969,-4985.9094 2478.6731,-5178.1071 2545.9268,-5270.5174 2444.4744,-6115.9136 2514.6731,-6206.1071 2520.2212,-6213.2355 2527.6809,-6218.4157 2535.8982,-6222.1648"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2534.8457,-6225.5096 2545.4361,-6225.8173 2537.3491,-6218.9725 2534.8457,-6225.5096"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge505" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1833.7692,-5011.1269C1850.3267,-5021.9969 1873.3815,-5040.2763 1883.8806,-5063.1071 1936.5506,-5177.6404 1851.8713,-6090.9623 1919.8806,-6197.1071 1966.0598,-6269.1808 2040.2267,-6215.1011 2092.2107,-6283.1071 2141.7567,-6347.9237 2111.8212,-6383.186 2128.2107,-6463.1071 2161.6027,-6625.9384 2170.4674,-6666.5409 2205.1267,-6829.1071"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M748.5504,-6691.5094C753.8191,-6766.7954 792.4163,-7197.2708 998.9033,-7453.1071 1061.3301,-7530.4536 1658.7958,-7897.4448 1746.019,-7945.1071 1974.7567,-8070.0985 2043.9448,-8077.0262 2282.0427,-8183.1071 2309.6227,-8195.3949 2340.8602,-8209.3628 2364.0138,-8219.7257"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2362.8503,-8223.0395 2373.4076,-8223.9308 2365.7104,-8216.6504 2362.8503,-8223.0395"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M805.4902,-6689.2131C817.2754,-6690.7706 829.6145,-6692.1823 841.1968,-6693.1071 1052.2628,-6709.959 1106.2342,-6689.0035 1317.5017,-6703.1071 1420.3658,-6709.974 1445.0688,-6723.3202 1547.9993,-6729.1071 1619.8945,-6733.1492 1640.8974,-6749.2928 1710.019,-6729.1071 1816.246,-6698.0855 1825.8744,-6653.4966 1919.8806,-6595.1071 2130.9213,-6464.0246 2165.5863,-6392.9299 2398.3579,-6306.1071"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2205.1267,-5915.1071C2498.6639,-6033.1336 2709.9267,-5873.638 2880.4805,-6140.1071 2923.9415,-6208.0096 2906.9171,-6421.0562 2916.4805,-6501.1071 2937.8415,-6679.9117 2970.1522,-6895.0133 2980.4722,-6962.6695"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2977.0645,-6963.5396 2982.0361,-6972.8956 2983.984,-6962.4814 2977.0645,-6963.5396"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge414" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2205.1267,-5915.1071C2245.1395,-5931.1956 2357.0761,-5909.5841 2398.3579,-5897.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2052.9637,-5733.5389C2066.5066,-5737.256 2080.7167,-5742.8126 2092.2107,-5751.1071 2163.9712,-5802.8926 2123.0206,-5882.0936 2205.1267,-5915.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2398.3579,-5897.1071C2509.1735,-5863.6143 2640.911,-5838.1123 2722.8902,-5823.8745"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2723.6231,-5827.2998 2732.8832,-5822.152 2722.4339,-5820.4016 2723.6231,-5827.2998"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge433" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2023.3961,-5715.0471C2041.4197,-5703.1951 2070.0339,-5683.3414 2092.2107,-5663.1071 2148.2505,-5611.9758 2134.9107,-5563.8227 2205.1267,-5535.1071"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2052.9739,-5729.4017C2067.6768,-5732.8401 2082.5646,-5739.2765 2092.2107,-5751.1071 2155.7448,-5829.0296 2100.0201,-6105.5992 2128.2107,-6202.1071 2165.2605,-6328.9435 2649.4942,-7125.2805 2686.5776,-7252.1071 2742.6371,-7443.8323 2663.8578,-7509.1798 2722.5776,-7700.1071 2736.8085,-7746.3787 2768.3017,-7794.1281 2786.9256,-7819.8584"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2784.1771,-7822.0286 2792.927,-7828.0027 2789.8124,-7817.876 2784.1771,-7822.0286"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2414.7842,-5280.3486C2485.9805,-5330.136 2769.3017,-5539.4699 2880.4805,-5791.1071 2929.7128,-5902.5375 2975.375,-6810.036 2982.7321,-6962.4283"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2979.2531,-6962.953 2983.2285,-6972.7738 2986.2451,-6962.6175 2979.2531,-6962.953"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2804.1449,-7828.0416C2814.295,-7785.0158 2851.9258,-7624.6798 2880.4805,-7492.1071 2921.0493,-7303.7554 2965.9944,-7075.1666 2979.6255,-7005.3574"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2983.1256,-7005.6942 2981.6047,-6995.2091 2976.2551,-7004.3542 2983.1256,-7005.6942"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge664" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2826.1228,-7827.9945C2860.9803,-7813.5855 2926.8523,-7791.2841 2983.7629,-7800.1071"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge646" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2832.8562,-7839.1071C2858.3648,-7839.1071 2895.0669,-7839.1071 2925.8882,-7839.1071"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2926.0905,-7842.6072 2936.0905,-7839.1071 2926.0905,-7835.6072 2926.0905,-7842.6072"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge417" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1282.5126,-7285.5086C1295.7001,-7281.8754 1308.717,-7275.6543 1317.5017,-7265.1071 1413.6202,-7149.7049 1260.0717,-7046.6966 1353.5017,-6929.1071 1457.8646,-6797.7576 1555.6626,-6870.8217 1710.019,-6805.1071 2079.1316,-6647.9639 2133.3485,-6520.725 2514.6731,-6396.1071 2533.0679,-6390.0956 2588.4632,-6397.16 2600.6254,-6382.1071"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2600.6254,-6382.1071C2644.8791,-6328.3414 2663.8358,-6316.9247 2686.5776,-6251.1071 2716.4645,-6164.6111 2663.3069,-5914.5473 2721.5184,-5830.1328"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2724.2776,-5832.286 2727.7113,-5822.263 2718.7767,-5827.9571 2724.2776,-5832.286"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2006.0457,-5573.1071C2047.3876,-5531.0004 2072.8282,-5541.4765 2128.2107,-5521.1071 2161.8199,-5508.7458 2174.1963,-5515.1542 2205.1267,-5497.1071"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1282.4528,-7285.9361C1295.8032,-7282.331 1308.9241,-7276.0181 1317.5017,-7265.1071 1415.9612,-7139.8631 1255.3868,-6674.6213 1353.5017,-6549.1071 1398.8312,-6491.119 1463.4558,-6556.4326 1511.9993,-6501.1071 1576.7661,-6427.2917 1510.2925,-6373.7805 1547.9993,-6283.1071 1646.0292,-6047.3745 1782.1361,-6051.2604 1883.8806,-5817.1071 1916.7414,-5741.4818 1875.3031,-5704.4746 1919.8806,-5635.1071 1945.3866,-5595.417 1972.9922,-5606.772 2006.0457,-5573.1071"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1282.338,-7281.944C1391.4616,-7265.2467 1662.1655,-7231.9284 1883.8806,-7271.1071 2070.4081,-7304.0679 2128.5044,-7312.1796 2282.0427,-7423.1071 2326.5659,-7455.274 2548.8182,-7782.8576 2600.6254,-7801.1071"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2600.6254,-7801.1071C2656.2009,-7809.2336 2719.825,-7821.8311 2760.3178,-7830.2683"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2759.8405,-7833.7443 2770.346,-7832.3714 2761.2773,-7826.8933 2759.8405,-7833.7443"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2259.1649,-9522.2413C2362.7689,-9509.6871 2587.8103,-9466.1202 2686.5776,-9320.1071 2777.247,-9186.0657 2625.3614,-7993.4789 2722.5776,-7864.1071 2731.474,-7852.2682 2745.9922,-7845.9089 2760.1684,-7842.5363"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.1893,-7845.904 2770.3451,-7840.5728 2759.8631,-7839.0307 2761.1893,-7845.904"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge407" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M2604.8952,-6219.6116C2618.0336,-6184.027 2658.6541,-6072.4047 2686.5776,-5978.1071 2705.0639,-5915.679 2677.9026,-5883.4691 2722.5776,-5836.1071 2725.9165,-5832.5674 2729.7524,-5829.5267 2733.8956,-5826.9149"/>
<polygon fill="#0066ff" stroke="#0066ff" points="2735.6269,-5829.9579 2742.7708,-5822.1338 2732.307,-5823.7952 2735.6269,-5829.9579"/>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge629" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2401.1944,-7865.268C2412.3346,-7909.3978 2453.6999,-8076.0791 2478.6731,-8215.1071 2499.4536,-8330.7941 2494.3566,-8361.3377 2514.6731,-8477.1071 2577.7589,-8836.5888 2632.5288,-8919.156 2686.5776,-9280.1071 2861.9767,-10451.4635 2746.454,-10762.9588 2916.4805,-11935.1071 2933.5137,-12052.5328 2965.9893,-12191.1917 2978.5877,-12243.104"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2975.1893,-12243.9417 2980.9616,-12252.826 2981.9895,-12242.2811 2975.1893,-12243.9417"/>
</g>
<!-- sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge634" class="edge">
<title>sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M2847.5144,-12264.1071C2865.3741,-12264.1071 2886.3287,-12264.1071 2906.3758,-12264.1071"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="2906.4397,-12267.6072 2916.4397,-12264.1071 2906.4397,-12260.6072 2906.4397,-12267.6072"/>
</g>
<!-- sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge635" class="edge">
<title>sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1638.002,-11361.1209C1655.7026,-11383.5523 1694.6733,-11436.8478 1710.019,-11489.1071 1735.902,-11577.2503 1700.6132,-12235.248 1746.019,-12315.1071 1879.8714,-12550.5244 2382.6084,-12565.5 2600.6254,-12605.1071"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge511" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M800.0028,-12797.3569C879.3493,-12796.2626 1029.901,-12781.9291 1113.0681,-12695.1071 1162.2895,-12643.7226 1103.9472,-12594.1273 1149.0681,-12539.1071 1201.1463,-12475.6033 1246.9411,-12505.1317 1317.5017,-12463.1071 1410.8275,-12407.5241 1444.4097,-12400.1413 1511.9993,-12315.1071 1536.26,-12284.5847 1526.9681,-12267.9383 1547.9993,-12235.1071 1607.1348,-12142.7922 1668.0078,-12150.3696 1710.019,-12049.1071 1753.8968,-11943.3458 1724.6095,-11647.5898 1746.019,-11535.1071 1784.0197,-11335.4574 1836.568,-11296.7572 1883.8806,-11099.1071 1906.7417,-11003.6041 1873.6669,-10967.7544 1919.8806,-10881.1071 1969.3503,-10788.355 2043.8046,-10812.4187 2092.2107,-10719.1071 2144.7137,-10617.8978 2054.3613,-10551.9758 2128.2107,-10465.1071 2151.4053,-10437.8235 2197.5537,-10476.1076 2205.1267,-10441.1071"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge617" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M777.1275,-12785.0092C786.3515,-12781.0784 796.4174,-12776.3224 805.1968,-12771.1071 822.6236,-12760.7549 824.9155,-12755.1812 841.1968,-12743.1071 894.3974,-12703.6539 914.8295,-12702.6677 962.9033,-12657.1071 1041.0268,-12583.0679 1065.7392,-12563.7769 1113.0681,-12467.1071 1142.4557,-12407.0826 1121.9623,-12382.1959 1149.0681,-12321.1071 1266.0497,-12057.4634 1400.8933,-12049.2803 1511.9993,-11783.1071 1543.4262,-11707.8187 1527.5275,-11682.0812 1547.9993,-11603.1071 1570.617,-11515.8545 1605.9151,-11414.3701 1621.3503,-11371.2365"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1624.7354,-11372.1661 1624.8268,-11361.5717 1618.1486,-11369.7968 1624.7354,-11372.1661"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge595" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2605.1215,-9311.1448C2620.2892,-9349.0311 2669.5717,-9477.5915 2686.5776,-9589.1071 2697.676,-9661.8836 2678.6807,-12180.0084 2722.5776,-12239.1071 2728.4314,-12246.9881 2736.7793,-12252.4436 2745.8743,-12256.2067"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2744.9547,-12259.5919 2755.5494,-12259.5464 2747.2388,-12252.975 2744.9547,-12259.5919"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge599" class="edge">
<title>sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2600.9751,-10328.3743C2605.7902,-10482.1104 2659.6876,-12158.6986 2722.5776,-12239.1071 2728.56,-12246.7559 2736.8811,-12252.109 2745.8905,-12255.8452"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2744.8643,-12259.194 2755.4591,-12259.1819 2747.1692,-12252.5843 2744.8643,-12259.194"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge609" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M958.5365,-14153.0759C1039.1336,-14136.7293 1191.3447,-14103.6015 1317.5017,-14063.1071 1546.798,-13989.5065 2151.5336,-13771.4959 2282.0427,-13569.1071 2335.2617,-13486.5771 2272.1736,-13437.9373 2318.0427,-13351.1071 2423.8404,-13150.8324 2581.6342,-13199.8307 2686.5776,-12999.1071 2754.4906,-12869.2112 2792.3416,-12391.8526 2800.0505,-12285.2938"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2803.5531,-12285.381 2800.7731,-12275.1574 2796.5708,-12284.8831 2803.5531,-12285.381"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge562" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902.7387,-14152.7769C907.059,-14085.1419 932.4253,-13734.9515 998.9033,-13655.1071 1215.8261,-13394.5689 1453.4795,-13600.7444 1710.019,-13379.1071 1853.0777,-13255.5116 1782.6994,-13139.1952 1919.8806,-13009.1071 1981.9926,-12950.2068 2045.2548,-12994.6773 2092.2107,-12923.1071 2133.3501,-12860.4023 2109.3331,-12321.688 2128.2107,-12249.1071 2167.3282,-12098.7076 2222.2492,-12078.5467 2282.0427,-11935.1071 2384.5066,-11689.3052 2429.9586,-11630.9168 2478.6731,-11369.1071 2522.2754,-11134.7726 2500.4317,-10535.0378 2514.6731,-10297.1071 2538.184,-9904.3115 2587.3747,-9426.1294 2598.4005,-9321.1294"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2601.8837,-9321.4719 2599.4507,-9311.1602 2594.9222,-9320.7385 2601.8837,-9321.4719"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge568" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2036.6558,-9729.2002C2089.8361,-9746.5025 2201.3236,-9773.9308 2282.0427,-9733.1071 2462.6305,-9641.7749 2565.8594,-9394.5129 2593.2177,-9320.9959"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2596.5614,-9322.0429 2596.7038,-9311.449 2589.986,-9319.6418 2596.5614,-9322.0429"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge582" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2398.3579,-10593.1071C2435.0901,-10586.8862 2450.3046,-10593.2563 2478.6731,-10569.1071 2553.0093,-10505.8272 2585.7701,-10386.7189 2596.4349,-10338.3405"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2599.896,-10338.8894 2598.534,-10328.3825 2593.0465,-10337.4455 2599.896,-10338.8894"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2006.5623,-9729.2319C2010.9445,-9810.4269 2048.7021,-10315.7226 2318.0427,-10569.1071 2345.1777,-10594.6345 2361.6257,-10599.328 2398.3579,-10593.1071"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge530" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M948.6208,-12232.7091C1029.064,-12245.1458 1196.9917,-12260.2828 1317.5017,-12197.1071 1423.4363,-12141.5724 1439.2774,-12106.069 1511.9993,-12011.1071 1532.3145,-11984.5791 1530.5768,-11973.6185 1547.9993,-11945.1071 1614.7217,-11835.9177 1670.632,-11828.8563 1710.019,-11707.1071 1753.8812,-11571.5249 1721.9325,-10565.5573 1746.019,-10425.1071 1762.9089,-10326.6215 1790.7116,-10308.0462 1814.9498,-10211.1071"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge676" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M3209.5785,-7827.9816C3242.1118,-7818.8404 3288.3696,-7805.843 3323.3457,-7796.0154"/>
<polygon fill="#2700ff" stroke="#2700ff" points="3324.6692,-7799.2792 3333.3496,-7793.2045 3322.7757,-7792.5401 3324.6692,-7799.2792"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge669" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3031.7192,-7839.1071C3045.5098,-7839.1071 3061.044,-7839.1071 3076.5888,-7839.1071"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3076.7873,-7842.6072 3086.7873,-7839.1071 3076.7872,-7835.6072 3076.7873,-7842.6072"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge794" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M410.537,-5949.347C437.6487,-5975.8583 504.4241,-6040.563 516.9653,-6047.1071 586.9525,-6083.6268 613.027,-6069.8104 690.4731,-6085.1071 811.088,-6108.9302 860.8725,-6064.5126 962.9033,-6133.1071 1009.5005,-6164.434 1037.3576,-6227.7626 1049.2277,-6260.4888"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1045.9312,-6261.6653 1052.5234,-6269.9595 1052.5423,-6259.3647 1045.9312,-6261.6653"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~weathermanager.f90~~EfferentGraph_edge798" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M429.8414,-5760.2194C522.1291,-5794.9398 800.3137,-5909.8333 962.9033,-6088.1071 1010.5878,-6140.3915 1038.8017,-6221.5372 1050.1522,-6259.785"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1046.9003,-6261.142 1053.0231,-6269.7885 1053.6287,-6259.211 1046.9003,-6261.142"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileweathermanagerf90EfferentGraph = svgPanZoom('#sourcefileweathermanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~weathermanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileweathermanagerf90AfferentGraph" width="541pt" height="72pt"
 viewBox="0.00 0.00 540.88 71.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~weathermanager.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 67.5)">
<title>sourcefile~~weathermanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-67.5 536.8823,-67.5 536.8823,4 -4,4"/>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~weathermanager.f90</title>
<polygon fill="none" stroke="#000000" points="109.8181,-42.2554 .0606,-42.2554 .0606,-20.2446 109.8181,-20.2446 109.8181,-42.2554"/>
<text text-anchor="middle" x="54.9393" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">WeatherManager.f90</text>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="244.8468,-62.2554 145.8893,-62.2554 145.8893,-40.2446 244.8468,-40.2446 244.8468,-62.2554"/>
<text text-anchor="middle" x="195.368" y="-48.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M110.0374,-39.0971C118.3409,-40.2797 126.9405,-41.5045 135.3413,-42.7009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.0629,-46.1965 145.4565,-44.1416 136.05,-39.2665 135.0629,-46.1965"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="400.4649,-42.2554 280.6545,-42.2554 280.6545,-20.2446 400.4649,-20.2446 400.4649,-42.2554"/>
<text text-anchor="middle" x="340.5597" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M110.0098,-31.25C155.7147,-31.25 220.995,-31.25 270.4318,-31.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="270.7278,-34.7501 280.7278,-31.25 270.7278,-27.7501 270.7278,-34.7501"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.9287,-44.4231C253.195,-43.2844 261.906,-42.0845 270.5674,-40.8914"/>
<polygon fill="#ff0000" stroke="#ff0000" points="271.254,-44.3299 280.6828,-39.498 270.2987,-37.3954 271.254,-44.3299"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="526.2807,-63.2554 442.8636,-63.2554 442.8636,-41.2446 526.2807,-41.2446 526.2807,-63.2554"/>
<text text-anchor="middle" x="484.5721" y="-49.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M400.3828,-39.9735C411.0474,-41.5286 422.0793,-43.1372 432.5056,-44.6576"/>
<polygon fill="#00ffff" stroke="#00ffff" points="432.2937,-48.1637 442.6941,-46.1433 433.3038,-41.2369 432.2937,-48.1637"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~weathermanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="532.6932,-22.2554 436.451,-22.2554 436.451,-.2446 532.6932,-.2446 532.6932,-22.2554"/>
<text text-anchor="middle" x="484.5721" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~weathermanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M400.3828,-22.942C408.8437,-21.7669 417.5358,-20.5598 425.9733,-19.388"/>
<polygon fill="#00ffff" stroke="#00ffff" points="426.6828,-22.8232 436.1062,-17.9808 425.7198,-15.8897 426.6828,-22.8232"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/weathermanager.html">WeatherManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/weathermanager.f90.html#src">WeatherManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">WeatherManager</span>          <span class="c">! EnergyPlus Simulation Module</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   May 1997</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       December 1998, FW; December 1999, LKL.</span>
<a name="ln-7"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8"></a>
<a name="ln-9"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-10"></a>          <span class="c">! This module contains all of the weather handling routines for</span>
<a name="ln-11"></a>          <span class="c">! EnergyPlus.  That includes getting user input, defining design day</span>
<a name="ln-12"></a>          <span class="c">! weather, retrieving data from weather files, and supplying the</span>
<a name="ln-13"></a>          <span class="c">! outdoor environment for each time step.</span>
<a name="ln-14"></a>
<a name="ln-15"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-16"></a>          <span class="c">! Setting up the design days is similar to BLAST/IBLAST.  Reading the</span>
<a name="ln-17"></a>          <span class="c">! BLAST weather files is similar to that code in BLAST/IBLAST.  The EnergyPlus</span>
<a name="ln-18"></a>          <span class="c">! Weather file (EPW) is new code.</span>
<a name="ln-19"></a>
<a name="ln-20"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-21"></a>          <span class="c">! (I)BLAST legacy code, internal Reverse Engineering documentation,</span>
<a name="ln-22"></a>          <span class="c">! and internal Evolutionary Engineering documentation.</span>
<a name="ln-23"></a>
<a name="ln-24"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-25"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-26"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-27"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-28"></a><span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataReportingFlags</span>
<a name="ln-30"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">iASCII_CR</span><span class="p">,</span> <span class="n">iUnicode_end</span>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ProcessDateString</span><span class="p">,</span> <span class="n">RoundSigDigits</span> <span class="c">!, ValidateMonthDay</span>
<a name="ln-34"></a><span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-35"></a>
<a name="ln-36"></a>
<a name="ln-37"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-38"></a>
<a name="ln-39"></a><span class="k">PRIVATE</span>
<a name="ln-40"></a>
<a name="ln-41"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-42"></a>    <span class="c">! Following are Date Types read in from EPW file or IDF</span>
<a name="ln-43"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InvalidDate</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-44"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MonthDay</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-45"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NthDayInMonth</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-46"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">LastDayInMonth</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-47"></a>
<a name="ln-48"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ScheduleMethod</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c">! Constant for water mains temperatures calculation methods</span>
<a name="ln-49"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CorrelationMethod</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! Constant for water mains temperatures calculation methods</span>
<a name="ln-50"></a>
<a name="ln-51"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InvalidWeatherFile</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-52"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EPlusWeatherFile</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-53"></a>
<a name="ln-54"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ASHRAE_ClearSky</span>       <span class="o">=</span><span class="mi">0</span>  <span class="c">! Design Day solar model ASHRAE ClearSky (default)</span>
<a name="ln-55"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Zhang_Huang</span>           <span class="o">=</span><span class="mi">1</span>  <span class="c">! Design Day solar model Zhang Huang</span>
<a name="ln-56"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SolarModel_Schedule</span>   <span class="o">=</span><span class="mi">2</span>  <span class="c">! Design Day solar model (beam and diffuse) from user entered schedule</span>
<a name="ln-57"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ASHRAE_Tau</span>            <span class="o">=</span><span class="mi">3</span>  <span class="c">! Design Day solar model ASHRAE tau (per 2009 HOF)</span>
<a name="ln-58"></a>
<a name="ln-59"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_Wetbulb</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! Design Day Humidity Indicating Type = Wetbulb (default)</span>
<a name="ln-60"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_Dewpoint</span>  <span class="o">=</span><span class="mi">1</span> <span class="c">! Design Day Humidity Indicating Type = Dewpoint</span>
<a name="ln-61"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_Enthalpy</span>  <span class="o">=</span><span class="mi">2</span> <span class="c">! Design Day Humidity Indicating Type = Enthalpy</span>
<a name="ln-62"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_HumRatio</span>  <span class="o">=</span><span class="mi">3</span> <span class="c">! Design Day Humidity Indicating Type = Humidity Ratio</span>
<a name="ln-63"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_RelHumSch</span> <span class="o">=</span><span class="mi">4</span> <span class="c">! Design Day Humidity Indicating Type = relhum schedule</span>
<a name="ln-64"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_WBProfDef</span> <span class="o">=</span><span class="mi">5</span> <span class="c">! Design Day Humidity Indicating Type = Wetbulb default profile</span>
<a name="ln-65"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_WBProfDif</span> <span class="o">=</span><span class="mi">6</span> <span class="c">! Design Day Humidity Indicating Type = Wetbulb difference profile</span>
<a name="ln-66"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_WBProfMul</span> <span class="o">=</span><span class="mi">7</span> <span class="c">! Design Day Humidity Indicating Type = Wetbulb multiplier profile</span>
<a name="ln-67"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDHumIndType_Count</span> <span class="o">=</span> <span class="mi">8</span>    <span class="c">! # of DDHumIndTypes</span>
<a name="ln-68"></a>
<a name="ln-69"></a>
<a name="ln-70"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDDBRangeType_Default</span>    <span class="o">=</span> <span class="mi">0</span> <span class="c">! Design Day DryBulb Range Type = Default Multipliers</span>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDDBRangeType_Multiplier</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Design Day DryBulb Range Type = Multiplier Schedule</span>
<a name="ln-72"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDDBRangeType_Difference</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! Design Day DryBulb Range Type = Difference Schedule</span>
<a name="ln-73"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDDBRangeType_Profile</span>    <span class="o">=</span> <span class="mi">3</span> <span class="c">! Design Day DryBulb Range Type = Temperature Profile</span>
<a name="ln-74"></a>
<a name="ln-75"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WP_ScheduleValue</span>         <span class="o">=</span> <span class="mi">1</span> <span class="c">! User entered Schedule value for Weather Property</span>
<a name="ln-76"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WP_DryBulbDelta</span>          <span class="o">=</span> <span class="mi">2</span> <span class="c">! User entered DryBulb difference Schedule value for Weather Property</span>
<a name="ln-77"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WP_DewPointDelta</span>         <span class="o">=</span> <span class="mi">3</span> <span class="c">! User entered Dewpoint difference Schedule value for Weather Property</span>
<a name="ln-78"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WP_SkyTAlgorithmA</span>        <span class="o">=</span> <span class="mi">4</span> <span class="c">! place holder</span>
<a name="ln-79"></a>
<a name="ln-80"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">GregorianToJulian</span>        <span class="o">=</span> <span class="mi">1</span> <span class="c">! JGDate argument for Gregorian to Julian Date conversion</span>
<a name="ln-81"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">JulianToGregorian</span>        <span class="o">=</span> <span class="mi">2</span> <span class="c">! JGDate argument for Julian to Gregorian Date conversion</span>
<a name="ln-82"></a>
<a name="ln-83"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>  <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Sigma</span><span class="o">=</span><span class="mf">5.6697d-8</span> <span class="c">! Stefan-Boltzmann constant</span>
<a name="ln-84"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>  <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TKelvin</span><span class="o">=</span><span class="n">KelvinConv</span>  <span class="c">! conversion from Kelvin to Celsius</span>
<a name="ln-85"></a>
<a name="ln-86"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>  <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-87"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>  <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DaysOfWeek</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s2">&quot;SUNDAY   &quot;</span><span class="p">,</span><span class="s2">&quot;MONDAY   &quot;</span><span class="p">,</span><span class="s2">&quot;TUESDAY  &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-88"></a>                                                           <span class="s2">&quot;WEDNESDAY&quot;</span><span class="p">,</span><span class="s2">&quot;THURSDAY &quot;</span><span class="p">,</span><span class="s2">&quot;FRIDAY   &quot;</span><span class="p">,</span><span class="s2">&quot;SATURDAY &quot;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">Debugout</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-91"></a>
<a name="ln-92"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-93"></a>
<a name="ln-94"></a><span class="k">TYPE </span><span class="n">EnvironmentData</span>
<a name="ln-95"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Title</span>           <span class="o">=</span> <span class="n">Blank</span>   <span class="c">! Environment name</span>
<a name="ln-96"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cKindOfEnvrn</span>    <span class="o">=</span> <span class="n">Blank</span>   <span class="c">! kind of environment</span>
<a name="ln-97"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">KindOfEnvrn</span>                <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Type of environment (see Parameters for KindOfSim in DataGlobals)</span>
<a name="ln-98"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotalDays</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Number of days in environment</span>
<a name="ln-99"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartJDay</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day of year of first day of environment</span>
<a name="ln-100"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartMonth</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-101"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartDay</span>                   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-102"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartYear</span>                  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-103"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartDate</span>                  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-104"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndMonth</span>                   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-105"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndDay</span>                     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-106"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndJDay</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-107"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndYear</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-108"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndDate</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-109"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayOfWeek</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Starting Day of Week for the (Weather) RunPeriod (User Input)</span>
<a name="ln-110"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseDST</span>                     <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if DaylightSavingTime is used for this RunPeriod</span>
<a name="ln-111"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseHolidays</span>                <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if Holidays are used for this RunPeriod (from WeatherFile)</span>
<a name="ln-112"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ApplyWeekendRule</span>           <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if &quot;Weekend Rule&quot; is to be applied to RunPeriod</span>
<a name="ln-113"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseRain</span>                    <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! True if Rain from weather file should be used (set rain to true)</span>
<a name="ln-114"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseSnow</span>                    <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! True if Snow from weather file should be used (set Snow to true)</span>
<a name="ln-115"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MonWeekDay</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-116"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SetWeekDays</span>                <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! true when weekdays will be reset (after first year or on repeat)</span>
<a name="ln-117"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSimYears</span>                <span class="o">=</span> <span class="mi">1</span> <span class="c">! Total Number of times this period to be performed</span>
<a name="ln-118"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurrentCycle</span>               <span class="o">=</span> <span class="mi">0</span> <span class="c">! Current cycle through weather file in NumSimYears repeats</span>
<a name="ln-119"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WP_Type1</span>                   <span class="o">=</span> <span class="mi">0</span> <span class="c">! WeatherProperties SkyTemperature Pointer</span>
<a name="ln-120"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurrentYear</span>                <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Current year</span>
<a name="ln-121"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsLeapYear</span>                 <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! True if current year is leap year.</span>
<a name="ln-122"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RollDayTypeOnRepeat</span>        <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! If repeating run period, increment day type on repeat.</span>
<a name="ln-123"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">TreatYearsAsConsecutive</span>    <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! When year rolls over, increment year and recalculate Leap Year</span>
<a name="ln-124"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">MatchYear</span>                  <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! for actual weather will be true</span>
<a name="ln-125"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ActualWeather</span>              <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! true when using actual weather data</span>
<a name="ln-126"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RawSimDays</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! number of basic sim days.</span>
<a name="ln-127"></a><span class="k">END TYPE </span><span class="n">EnvironmentData</span>
<a name="ln-128"></a>
<a name="ln-129"></a><span class="k">TYPE </span><span class="n">DesignDayData</span>
<a name="ln-130"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Title</span> <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! Environment name</span>
<a name="ln-131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxDryBulb</span>               <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Maximum Dry-Bulb Temperature (C)</span>
<a name="ln-132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DailyDBRange</span>             <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Daily Temperature Range (deltaC)</span>
<a name="ln-133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HumIndValue</span>              <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Humidity Indicating Value at Max Dry-bulb Temperature</span>
<a name="ln-134"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HumIndType</span>               <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Humidity Indicating type  (see Parameters)</span>
<a name="ln-135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PressBarom</span>               <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Atmospheric/Barometric Pressure (Pascals)</span>
<a name="ln-136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindSpeed</span>                <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Wind Speed (m/s)</span>
<a name="ln-137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDir</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Wind Direction (degrees clockwise from North, N=0, E=90, S=180, W=270)</span>
<a name="ln-138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyClear</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Sky Clearness (0 to 1)</span>
<a name="ln-139"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RainInd</span>                    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Rain Indicator (1 = raining and surfaces are wet, else 0)</span>
<a name="ln-140"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SnowInd</span>                    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Snow Indicator (1 = snow on ground, else  0)</span>
<a name="ln-141"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayOfMonth</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day of Month ( 1 - 31 )</span>
<a name="ln-142"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Month</span>                      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Month of Year ( 1 - 12 )</span>
<a name="ln-143"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayType</span>                    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day Type Sunday = 1 - Saturday = 7</span>
<a name="ln-144"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DSTIndicator</span>               <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Daylight Saving Time Period Indicator (1=yes, 0=no) for this DesignDay</span>
<a name="ln-145"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SolarModel</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Solar Model for creating solar values for design day.</span>
<a name="ln-146"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DBTempRangeType</span>            <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Drybulb Range Type (see Parameters)</span>
<a name="ln-147"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TempRangeSchPtr</span>            <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Schedule pointer to a day schedule for dry-bulb temperature range multipliers</span>
<a name="ln-148"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HumIndSchPtr</span>               <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Schedule pointer to a day schedule that specifies</span>
<a name="ln-149"></a>                                                  <span class="c">!    relative humidity (%) or wet-bulb range multipliers per HumIndType</span>
<a name="ln-150"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BeamSolarSchPtr</span>            <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Schedule pointer to a day schedule for beam solar</span>
<a name="ln-151"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DiffuseSolarSchPtr</span>         <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Schedule pointer to a day schedule for diffuse solar</span>
<a name="ln-152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TauB</span>                     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! beam pseudo optical depth for ASHRAE tau model</span>
<a name="ln-153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TauD</span>                     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! diffuse pseudo optical depth for ASHRAE tau model</span>
<a name="ln-154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DailyWBRange</span>             <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! daily range of wetbulb (deltaC)</span>
<a name="ln-155"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">PressureEntered</span>          <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! true if a pressure was entered in design day data</span>
<a name="ln-156"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">DewPointNeedsSet</span>         <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! true if the Dewpoint humidicating value needs to be set (after location determined)</span>
<a name="ln-157"></a><span class="k">END TYPE </span><span class="n">DesignDayData</span>
<a name="ln-158"></a>
<a name="ln-159"></a><span class="k">TYPE </span><span class="n">RunPeriodData</span>
<a name="ln-160"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Title</span> <span class="o">=</span> <span class="n">Blank</span>
<a name="ln-161"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PeriodType</span> <span class="o">=</span> <span class="n">Blank</span>
<a name="ln-162"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotalDays</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! total number of days in requested period</span>
<a name="ln-163"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartMonth</span>                 <span class="o">=</span> <span class="mi">1</span>
<a name="ln-164"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartDay</span>                   <span class="o">=</span> <span class="mi">1</span>
<a name="ln-165"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartDate</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Calculated start date (Julian) for a weather file run period</span>
<a name="ln-166"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartYear</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! entered in &quot;consecutive&quot;/real runperiod object</span>
<a name="ln-167"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndMonth</span>                   <span class="o">=</span> <span class="mi">12</span>
<a name="ln-168"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndDay</span>                     <span class="o">=</span> <span class="mi">31</span>
<a name="ln-169"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndDate</span>                    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Calculated end date (Julian) for a weather file run period</span>
<a name="ln-170"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndYear</span>                    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! entered in &quot;consecutive&quot;/real runperiod object</span>
<a name="ln-171"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayOfWeek</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day of Week that the RunPeriod will start on (User Input)</span>
<a name="ln-172"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseDST</span>                     <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if DaylightSavingTime is used for this RunPeriod</span>
<a name="ln-173"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseHolidays</span>                <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if Holidays are used for this RunPeriod (from WeatherFile)</span>
<a name="ln-174"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ApplyWeekendRule</span>           <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if &quot;Weekend Rule&quot; is to be applied to RunPeriod</span>
<a name="ln-175"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseRain</span>                    <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! True if Rain from weather file should be used (set rain to true)</span>
<a name="ln-176"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseSnow</span>                    <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! True if Snow from weather file should be used (set Snow to true)</span>
<a name="ln-177"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MonWeekDay</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-178"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSimYears</span>                <span class="o">=</span> <span class="mi">1</span>       <span class="c">! Total Number of years of simulation to be performed</span>
<a name="ln-179"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BeginYear</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Start year entered in regular RunPeriod object</span>
<a name="ln-180"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsLeapYear</span>                 <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! True if Begin Year is leap year.</span>
<a name="ln-181"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RollDayTypeOnRepeat</span>        <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! If repeating run period, increment day type on repeat.</span>
<a name="ln-182"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">TreatYearsAsConsecutive</span>    <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! When year rolls over, increment year and recalculate Leap Year</span>
<a name="ln-183"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ActualWeather</span>              <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! true when using actual weather data</span>
<a name="ln-184"></a><span class="k">END TYPE </span><span class="n">RunPeriodData</span>
<a name="ln-185"></a>
<a name="ln-186"></a><span class="k">TYPE </span><span class="n">DayWeatherVariables</span>                <span class="c">! Derived Type for Storing Weather &quot;Header&quot; Data</span>
<a name="ln-187"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayOfYear</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day of year for weather data</span>
<a name="ln-188"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Year</span>                       <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Year of weather data</span>
<a name="ln-189"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Month</span>                      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Month of weather data</span>
<a name="ln-190"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayOfMonth</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day of month for weather data</span>
<a name="ln-191"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayOfWeek</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day of week for weather data</span>
<a name="ln-192"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DaylightSavingIndex</span>        <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Daylight Saving Time Period indicator (0=no,1=yes)</span>
<a name="ln-193"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HolidayIndex</span>               <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Holiday indicator (0=no holiday, non-zero=holiday type)</span>
<a name="ln-194"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SinSolarDeclinAngle</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Sine of the solar declination angle</span>
<a name="ln-195"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CosSolarDeclinAngle</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Cosine of the solar declination angle</span>
<a name="ln-196"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EquationOfTime</span>             <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Value of the equation of time formula</span>
<a name="ln-197"></a><span class="k">END TYPE </span><span class="n">DayWeatherVariables</span>
<a name="ln-198"></a>
<a name="ln-199"></a><span class="k">TYPE </span><span class="n">SpecialDayData</span>
<a name="ln-200"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>  <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! Name</span>
<a name="ln-201"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DateType</span>                   <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Date type as read in from IDF</span>
<a name="ln-202"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Month</span>                      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Start Month</span>
<a name="ln-203"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Day</span>                        <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Start Day of month or Count for DateTypes=NthDayOfMonth</span>
<a name="ln-204"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WeekDay</span>                    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! For Date types=NthDayOfMonth and LastDayOfMonth</span>
<a name="ln-205"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompDate</span>                   <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Start Date in &quot;compressed date&quot; format, only if Month/Day</span>
<a name="ln-206"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WthrFile</span>                   <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if this Special Day came from weather file (EPW)</span>
<a name="ln-207"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Duration</span>                   <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Number of days this special Day is used for</span>
<a name="ln-208"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DayType</span>                    <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day Type desigation for this Special Day period</span>
<a name="ln-209"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ActStMon</span>                   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-210"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ActStDay</span>                   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-211"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">Used</span>                       <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! Set to true in a run period after use (NthDayOfMonth and LastDayOfMonth only)</span>
<a name="ln-212"></a><span class="k">END TYPE</span>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="k">TYPE </span><span class="n">DataPeriodData</span>
<a name="ln-215"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>  <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! DataPeriod Title</span>
<a name="ln-216"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DayOfWeek</span>        <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! Start Day of Week for DataPeriod</span>
<a name="ln-217"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumYearsData</span>               <span class="o">=</span> <span class="mi">1</span>       <span class="c">! Number of years for which data is present in EPW.</span>
<a name="ln-218"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WeekDay</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-219"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StMon</span>                      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-220"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StDay</span>                      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-221"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StYear</span>                     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-222"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EnMon</span>                      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-223"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EnDay</span>                      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-224"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EnYear</span>                     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-225"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDays</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-226"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MonWeekDay</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-227"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DataStJDay</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-228"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DataEnJDay</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-229"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">HasYearData</span>                <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-230"></a><span class="k">END TYPE</span>
<a name="ln-231"></a>
<a name="ln-232"></a><span class="k">TYPE </span><span class="n">DaylightSavingPeriodData</span>
<a name="ln-233"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StDateType</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Start Date type as from EPW or IDF</span>
<a name="ln-234"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StWeekDay</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! For DateTypes=NthDayOfMonth or LastDayOfMonth</span>
<a name="ln-235"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StMon</span>                      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! DaylightSavingTime (DST) Start Month</span>
<a name="ln-236"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StDay</span>                      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! DaylightSavingTime (DST) Start Day</span>
<a name="ln-237"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EnDateType</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! End Date type as from EPW or IDF</span>
<a name="ln-238"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EnMon</span>                      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! DaylightSavingTime (DST) End Month</span>
<a name="ln-239"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EnDay</span>                      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! DaylightSavingTime (DST) End Day</span>
<a name="ln-240"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EnWeekDay</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! For DateTypes=NthDayOfMonth or LastDayOfMonth</span>
<a name="ln-241"></a><span class="k">END TYPE</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="k">TYPE </span><span class="n">MissingData</span>          <span class="c">! This Derived type carries the default missing data</span>
<a name="ln-244"></a>                          <span class="c">! for those data elements that would be best replaced</span>
<a name="ln-245"></a>                          <span class="c">! with the previous hour&#39;s data for missing data.</span>
<a name="ln-246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryBulb</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Dry Bulb Temperature (C)</span>
<a name="ln-247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DewPoint</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Dew Point Temperature (C)</span>
<a name="ln-248"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RelHumid</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! Relative Humidity (%)</span>
<a name="ln-249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StnPres</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Atmospheric Pressure (Pa)</span>
<a name="ln-250"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WindDir</span>      <span class="o">=</span><span class="mi">0</span>   <span class="c">! Wind Direction (deg)</span>
<a name="ln-251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindSpd</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Wind Speed/Velocity (m/s)</span>
<a name="ln-252"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TotSkyCvr</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Total Sky Cover (tenths)</span>
<a name="ln-253"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">OpaqSkyCvr</span>   <span class="o">=</span><span class="mi">0</span>   <span class="c">! Opaque Sky Cover (tenths)</span>
<a name="ln-254"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Visibility</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Visibility (km)</span>
<a name="ln-255"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="nb">Ceiling</span>      <span class="o">=</span><span class="mi">0</span>   <span class="c">! Ceiling Height (m)</span>
<a name="ln-256"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PrecipWater</span>  <span class="o">=</span><span class="mi">0</span>   <span class="c">! Precipitable Water (mm)</span>
<a name="ln-257"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AerOptDepth</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Aerosol Optical Depth</span>
<a name="ln-258"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SnowDepth</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Snow Depth (cm)</span>
<a name="ln-259"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DaysLastSnow</span> <span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of Days since last snow</span>
<a name="ln-260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Albedo</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Albedo</span>
<a name="ln-261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LiquidPrecip</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Rain/Liquid Precipitation (mm)</span>
<a name="ln-262"></a><span class="k">END TYPE</span>
<a name="ln-263"></a>
<a name="ln-264"></a><span class="k">TYPE </span><span class="n">MissingDataCounts</span>    <span class="c">! This Derived type carries the counts of missing data</span>
<a name="ln-265"></a>                          <span class="c">! items in the weather reading process.  It will count</span>
<a name="ln-266"></a>                          <span class="c">! only items that are on the source file -- not those that</span>
<a name="ln-267"></a>                          <span class="c">! are derived from data on the source file.</span>
<a name="ln-268"></a>                          <span class="c">! Comments below illustrate the data that is being counted:</span>
<a name="ln-269"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DryBulb</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Dry Bulb Temperature (C)</span>
<a name="ln-270"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DewPoint</span>     <span class="o">=</span><span class="mi">0</span> <span class="c">! Dew Point Temperature (C)</span>
<a name="ln-271"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RelHumid</span>     <span class="o">=</span><span class="mi">0</span> <span class="c">! Relative Humidity (%)</span>
<a name="ln-272"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StnPres</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Atmospheric Pressure (Pa)</span>
<a name="ln-273"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WindDir</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Wind Direction (deg)</span>
<a name="ln-274"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WindSpd</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Wind Speed/Velocity (m/s)</span>
<a name="ln-275"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirectRad</span>    <span class="o">=</span><span class="mi">0</span> <span class="c">! Direct Radiation (wh/m2)</span>
<a name="ln-276"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DiffuseRad</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! Diffuse Radiation (wh/m2)</span>
<a name="ln-277"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotSkyCvr</span>    <span class="o">=</span><span class="mi">0</span> <span class="c">! Total Sky Cover (tenths)</span>
<a name="ln-278"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpaqSkyCvr</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! Opaque Sky Cover (tenths)</span>
<a name="ln-279"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Visibility</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! Visibility (km)</span>
<a name="ln-280"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Ceiling</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Ceiling Height (m)</span>
<a name="ln-281"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PrecipWater</span>  <span class="o">=</span><span class="mi">0</span> <span class="c">! Precipitable Water (mm)</span>
<a name="ln-282"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AerOptDepth</span>  <span class="o">=</span><span class="mi">0</span> <span class="c">! Aerosol Optical Depth</span>
<a name="ln-283"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SnowDepth</span>    <span class="o">=</span><span class="mi">0</span> <span class="c">! Snow Depth (cm)</span>
<a name="ln-284"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DaysLastSnow</span> <span class="o">=</span><span class="mi">0</span> <span class="c">! Number of Days since last snow</span>
<a name="ln-285"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WeathCodes</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! Weather codes invalid</span>
<a name="ln-286"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Albedo</span>       <span class="o">=</span><span class="mi">0</span> <span class="c">! Albedo</span>
<a name="ln-287"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LiquidPrecip</span> <span class="o">=</span><span class="mi">0</span> <span class="c">! Liquid Precip Depth</span>
<a name="ln-288"></a><span class="k">END TYPE</span>
<a name="ln-289"></a>
<a name="ln-290"></a><span class="k">TYPE </span><span class="n">RangeDataCounts</span>      <span class="c">! This Derived type carries the counts of out of range</span>
<a name="ln-291"></a>                          <span class="c">! items in the weather reading process.  It will count</span>
<a name="ln-292"></a>                          <span class="c">! only items that are on the source file -- not those that</span>
<a name="ln-293"></a>                          <span class="c">! are derived from data on the source file.</span>
<a name="ln-294"></a>                          <span class="c">! Comments below illustrate the data that is being counted:</span>
<a name="ln-295"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DryBulb</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Dry Bulb Temperature (C)</span>
<a name="ln-296"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DewPoint</span>     <span class="o">=</span><span class="mi">0</span> <span class="c">! Dew Point Temperature (C)</span>
<a name="ln-297"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RelHumid</span>     <span class="o">=</span><span class="mi">0</span> <span class="c">! Relative Humidity (%)</span>
<a name="ln-298"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StnPres</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Atmospheric Pressure (Pa)</span>
<a name="ln-299"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WindDir</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Wind Direction (deg)</span>
<a name="ln-300"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WindSpd</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Wind Speed/Velocity (m/s)</span>
<a name="ln-301"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirectRad</span>    <span class="o">=</span><span class="mi">0</span> <span class="c">! Direct Radiation (wh/m2)</span>
<a name="ln-302"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DiffuseRad</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! Diffuse Radiation (wh/m2)</span>
<a name="ln-303"></a><span class="k">END TYPE</span>
<a name="ln-304"></a>
<a name="ln-305"></a><span class="k">TYPE </span><span class="n">TypicalExtremeData</span>
<a name="ln-306"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Title</span>           <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! Environment name</span>
<a name="ln-307"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ShortTitle</span>      <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! Environment name</span>
<a name="ln-308"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MatchValue</span>      <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! String to be matched for input/running these periods for design.</span>
<a name="ln-309"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MatchValue1</span>     <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! String to be also matched (synonym)</span>
<a name="ln-310"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MatchValue2</span>     <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! String to be also matched (synonym)</span>
<a name="ln-311"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TEType</span>          <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! Typical or Extreme</span>
<a name="ln-312"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotalDays</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Number of days in environment</span>
<a name="ln-313"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartJDay</span>                  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Day of year of first day of environment</span>
<a name="ln-314"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartMonth</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-315"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartDay</span>                   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-316"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndMonth</span>                   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-317"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndDay</span>                     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-318"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndJDay</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-319"></a><span class="k">END TYPE </span><span class="n">TypicalExtremeData</span>
<a name="ln-320"></a>
<a name="ln-321"></a><span class="k">TYPE </span><span class="n">WeatherProperties</span>
<a name="ln-322"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>  <span class="o">=</span> <span class="n">Blank</span>     <span class="c">! Reference Name</span>
<a name="ln-323"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ScheduleName</span>        <span class="o">=</span> <span class="n">Blank</span>    <span class="c">! Schedule Name or Algorithm Name</span>
<a name="ln-324"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">IsSchedule</span>          <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! Default is using Schedule</span>
<a name="ln-325"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CalculationType</span>     <span class="o">=</span> <span class="mi">0</span>        <span class="c">!</span>
<a name="ln-326"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SchedulePtr</span>         <span class="o">=</span> <span class="mi">0</span>        <span class="c">! pointer to schedule when used</span>
<a name="ln-327"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">UsedForEnvrn</span>        <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-328"></a><span class="k">END TYPE </span><span class="n">WeatherProperties</span>
<a name="ln-329"></a>
<a name="ln-330"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-331"></a>          <span class="c">! na</span>
<a name="ln-332"></a>
<a name="ln-333"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-334"></a>
<a name="ln-335"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">YearofSim</span> <span class="o">=</span> <span class="mi">1</span>                   <span class="c">! The Present year of Simulation.</span>
<a name="ln-336"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumDaysInYear</span> <span class="o">=</span> <span class="mi">365</span>
<a name="ln-337"></a><span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">EnvironmentReportNbr</span>   <span class="o">=</span><span class="mi">0</span>   <span class="c">! Report number for the environment stamp</span>
<a name="ln-338"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnvironmentReportChr</span>   <span class="o">=</span><span class="n">Blank</span> <span class="c">! Report number for the environment stamp (character -- for printing)</span>
<a name="ln-339"></a><span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">TimeStampReportNbr</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! Report number for the time stamp</span>
<a name="ln-340"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TimeStampReportChr</span>     <span class="o">=</span><span class="n">Blank</span> <span class="c">! Report number for the time stamp (character -- for printing)</span>
<a name="ln-341"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WeatherDataReport</span>               <span class="o">=</span><span class="mi">0</span>   <span class="c">! Report number for the weather data</span>
<a name="ln-342"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WeatherFileExists</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! Set to true if a weather file exists</span>
<a name="ln-343"></a><span class="kt">Character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LocationTitle</span><span class="o">=</span><span class="n">Blank</span>   <span class="c">! Location Title from input File</span>
<a name="ln-344"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">LocationGathered</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>        <span class="c">! flag to show if Location exists on Input File (we assume one is there and</span>
<a name="ln-345"></a>                                           <span class="c">! correct on weather file)</span>
<a name="ln-346"></a>
<a name="ln-347"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WeatherFileLatitude</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-348"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WeatherFileLongitude</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-349"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WeatherFileTimeZone</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-350"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WeatherFileElevation</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-351"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WeatherFileUnitNumber</span>           <span class="c">! File unit number for the weather file</span>
<a name="ln-352"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundTemps</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">8.d0</span><span class="o">/</span><span class="p">)</span> <span class="c">! Bldg Surface</span>
<a name="ln-353"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundTempsFC</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">)</span> <span class="c">! F or C factor method</span>
<a name="ln-354"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceGroundTemps</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">3.d0</span><span class="o">/</span><span class="p">)</span> <span class="c">! Surface</span>
<a name="ln-355"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeepGroundTemps</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.d0</span><span class="o">/</span><span class="p">)</span>   <span class="c">! Deep</span>
<a name="ln-356"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundReflectances</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="p">,.</span><span class="mi">2</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>   <span class="c">!User Specified Ground Reflectances</span>
<a name="ln-357"></a><span class="c">!EPTeam above line replaces (big diffs) REAL(r64), DIMENSION(12) :: GroundReflectances=(/.2,.2,.2,.2,.2,.2,.2,.2,.2,.2,.2,.2/)   !User Specified Ground Reflectances</span>
<a name="ln-358"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SnowGndRefModifier</span><span class="o">=</span><span class="mf">1.0d0</span>           <span class="c">! Modifier to ground reflectance during snow</span>
<a name="ln-359"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SnowGndRefModifierForDayltg</span><span class="o">=</span><span class="mf">1.0d0</span>  <span class="c">! Modifier to ground reflectance during snow for daylighting</span>
<a name="ln-360"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterMainsTempsMethod</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Water mains temperature calculation method</span>
<a name="ln-361"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterMainsTempsSchedule</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Water mains temperature schedule</span>
<a name="ln-362"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMainsTempsAnnualAvgAirTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Annual average outdoor air temperature (C)</span>
<a name="ln-363"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMainsTempsMaxDiffAirTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Maximum difference in monthly average outdoor air temperatures (deltaC)</span>
<a name="ln-364"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">wthFCGroundTemps</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-365"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RainAmount</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-366"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SnowAmount</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-367"></a>
<a name="ln-368"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DayWeatherVariables</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">TodayVariables</span><span class="o">=</span>       <span class="p">&amp;</span>  <span class="c">! Today&#39;s daily weather variables</span>
<a name="ln-369"></a>    <span class="n">DayWeatherVariables</span><span class="p">(</span>               <span class="p">&amp;</span> <span class="c">! Derived Type for Storing Weather &quot;Header&quot; Data</span>
<a name="ln-370"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Day of year for weather data</span>
<a name="ln-371"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Year of weather data</span>
<a name="ln-372"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Month of weather data</span>
<a name="ln-373"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Day of month for weather data</span>
<a name="ln-374"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Day of week for weather data</span>
<a name="ln-375"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Daylight Saving Time Period indicator (0=no,1=yes)</span>
<a name="ln-376"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Holiday indicator (0=no holiday, non-zero=holiday type)</span>
<a name="ln-377"></a>   <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Sine of the solar declination angle</span>
<a name="ln-378"></a>   <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Cosine of the solar declination angle</span>
<a name="ln-379"></a>   <span class="mf">0.0d0</span><span class="p">)</span>       <span class="c">! Value of the equation of time formula</span>
<a name="ln-380"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DayWeatherVariables</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">TomorrowVariables</span><span class="o">=</span> <span class="p">&amp;</span>     <span class="c">! Tomorrow&#39;s daily weather variables</span>
<a name="ln-381"></a>    <span class="n">DayWeatherVariables</span><span class="p">(</span>               <span class="p">&amp;</span> <span class="c">! Derived Type for Storing Weather &quot;Header&quot; Data</span>
<a name="ln-382"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Day of year for weather data</span>
<a name="ln-383"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Year of weather data</span>
<a name="ln-384"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Month of weather data</span>
<a name="ln-385"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Day of month for weather data</span>
<a name="ln-386"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Day of week for weather data</span>
<a name="ln-387"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Daylight Saving Time Period indicator (0=no,1=yes)</span>
<a name="ln-388"></a>     <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Holiday indicator (0=no holiday, non-zero=holiday type)</span>
<a name="ln-389"></a>   <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Sine of the solar declination angle</span>
<a name="ln-390"></a>   <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>     <span class="c">! Cosine of the solar declination angle</span>
<a name="ln-391"></a>   <span class="mf">0.0d0</span><span class="p">)</span>       <span class="c">! Value of the equation of time formula</span>
<a name="ln-392"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DayWeatherVariables</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DesignDay</span>  <span class="c">! Design day environments</span>
<a name="ln-393"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">MissingData</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">Missing</span>  <span class="o">=</span> <span class="n">MissingData</span>  <span class="p">&amp;</span>
<a name="ln-394"></a>      <span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Dry Bulb Temperature (C)</span>
<a name="ln-395"></a>       <span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Dew Point Temperature (C)</span>
<a name="ln-396"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Relative Humidity (%)</span>
<a name="ln-397"></a>       <span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Atmospheric Pressure (Pa)</span>
<a name="ln-398"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Wind Direction (deg)</span>
<a name="ln-399"></a>       <span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Wind Speed/Velocity (m/s)</span>
<a name="ln-400"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Total Sky Cover (tenths)</span>
<a name="ln-401"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Opaque Sky Cover (tenths)</span>
<a name="ln-402"></a>       <span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Visibility (km)</span>
<a name="ln-403"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Ceiling Height (m)</span>
<a name="ln-404"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Precipitable Water (mm)</span>
<a name="ln-405"></a>       <span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Aerosol Optical Depth</span>
<a name="ln-406"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Snow Depth (cm)</span>
<a name="ln-407"></a>       <span class="mi">0</span><span class="p">,</span>      <span class="p">&amp;</span> <span class="c">! Number of Days since last snow</span>
<a name="ln-408"></a>       <span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Albedo</span>
<a name="ln-409"></a>       <span class="mf">0.0d0</span><span class="p">)</span>    <span class="c">! Rain/Liquid Precipitation (mm)</span>
<a name="ln-410"></a>
<a name="ln-411"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">MissingDataCounts</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">Missed</span> <span class="o">=</span> <span class="n">MissingDataCounts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-412"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">RangeDataCounts</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OutOfRange</span> <span class="o">=</span> <span class="n">RangeDataCounts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-413"></a>
<a name="ln-414"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DesignDayData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DesDayInput</span> <span class="c">! Design day Input Data</span>
<a name="ln-415"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">EnvironmentData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Environment</span> <span class="c">! Environment data</span>
<a name="ln-416"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">RunPeriodData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">RunPeriodInput</span>
<a name="ln-417"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">RunPeriodData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">RunPeriodDesignInput</span>
<a name="ln-418"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">TypicalExtremeData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TypicalExtremePeriods</span>
<a name="ln-419"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DaylightSavingPeriodData</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">EPWDST</span> <span class="o">=</span> <span class="n">DaylightSavingPeriodData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c">! Daylight Saving Period Data from EPW file</span>
<a name="ln-420"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DaylightSavingPeriodData</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">IDFDST</span> <span class="o">=</span> <span class="n">DaylightSavingPeriodData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c">! Daylight Saving Period Data from IDF file</span>
<a name="ln-421"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DaylightSavingPeriodData</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">DST</span>    <span class="o">=</span> <span class="n">DaylightSavingPeriodData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c">! Daylight Saving Period Data, if active</span>
<a name="ln-422"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">WeatherProperties</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WPSkyTemperature</span>
<a name="ln-423"></a><span class="kt">Integer</span> <span class="kd">::</span> <span class="n">TotRunPers</span>  <span class="o">=</span><span class="mi">0</span>  <span class="c">! Total number of Run Periods (Weather data) to Setup</span>
<a name="ln-424"></a><span class="kt">Integer</span> <span class="kd">::</span> <span class="n">TotRunDesPers</span>  <span class="o">=</span><span class="mi">0</span>   <span class="c">! Total number of Run Design Periods (Weather data) to Setup</span>
<a name="ln-425"></a>
<a name="ln-426"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSpecialDays</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-427"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SpecialDayData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SpecialDays</span>
<a name="ln-428"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">366</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecialDayTypes</span>  <span class="o">=</span><span class="mi">0</span>  <span class="c">! To hold holiday types given in input file</span>
<a name="ln-429"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">366</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WeekDayTypes</span>     <span class="o">=</span><span class="mi">0</span>  <span class="c">! To hold Week day types using specified first day</span>
<a name="ln-430"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">366</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DSTIndex</span>         <span class="o">=</span><span class="mi">0</span>  <span class="c">! To hold DST Index based on weather file or input</span>
<a name="ln-431"></a>
<a name="ln-432"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDataPeriods</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-433"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DataPeriodData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DataPeriods</span>
<a name="ln-434"></a>
<a name="ln-435"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumIntervalsPerHour</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-436"></a>
<a name="ln-437"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>   <span class="c">! True if user says to use Weather File specified DaylightSaving Period</span>
<a name="ln-438"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseSpecialDays</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>      <span class="c">! True if user says to use Weather File specified Special Days for current RunPeriod</span>
<a name="ln-439"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseRainValues</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>       <span class="c">! True if rain values from weather file are to be used</span>
<a name="ln-440"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UseSnowValues</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>       <span class="c">! True if snow values from weather file are to be used</span>
<a name="ln-441"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">EPWDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! True if a DaylightSaving Time Period is input (EPW files)</span>
<a name="ln-442"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IDFDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! True if a DaylightSaving Time Period is input (IDF files)</span>
<a name="ln-443"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DaylightSavingIsActive</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>     <span class="c">! True if a DaylightSavingPeriod should be used for Environment</span>
<a name="ln-444"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WFAllowsLeapYears</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! True if the Weather File (WF) header has &quot;Yes&quot; for Leap Years</span>
<a name="ln-445"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WFLeapYearInd</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Indicator for current Weather file &quot;Leap Year&quot;, used in DayOfYear calculations and others.</span>
<a name="ln-446"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">curSimDayforEndofRunPeriod</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! normal=number days in sim, but different when repeating runperiods or multi-year files</span>
<a name="ln-447"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Envrn</span><span class="o">=</span><span class="mi">0</span>                <span class="c">! Counter for environments</span>
<a name="ln-448"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfEnvrn</span><span class="o">=</span><span class="mi">0</span>           <span class="c">! Number of environments to be simulated</span>
<a name="ln-449"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumEPWTypExtSets</span><span class="o">=</span><span class="mi">0</span>       <span class="c">! Number of Typical/Extreme on weather file.</span>
<a name="ln-450"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWPSkyTemperatures</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of WeatherProperty:SkyTemperature items in input file</span>
<a name="ln-451"></a>
<a name="ln-452"></a><span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayIsRain</span>         <span class="c">! Rain indicator, true=rain</span>
<a name="ln-453"></a><span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayIsSnow</span>         <span class="c">! Snow indicator, true=snow</span>
<a name="ln-454"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayRainAmount</span>     <span class="c">! ficitious indicator of Rain</span>
<a name="ln-455"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodaySnowAmount</span>     <span class="c">! ficitious indicator of Snow</span>
<a name="ln-456"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayOutDryBulbTemp</span>   <span class="c">! Dry bulb temperature of outside air</span>
<a name="ln-457"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayOutWetBulbTemp</span>   <span class="c">! Wet bulb temperature of outside air</span>
<a name="ln-458"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayOutDewPointTemp</span>  <span class="c">! Dew Point Temperature of outside air</span>
<a name="ln-459"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayOutBaroPress</span>     <span class="c">! Barometric pressure of outside air</span>
<a name="ln-460"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayOutHumRat</span>        <span class="c">! Humidity ratio of outside air</span>
<a name="ln-461"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayOutRelHum</span>        <span class="c">! Relative Humidity of outside air</span>
<a name="ln-462"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayWindSpeed</span>        <span class="c">! Wind speed of outside air</span>
<a name="ln-463"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayWindDir</span>          <span class="c">! Wind direction of outside air</span>
<a name="ln-464"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodaySkyTemp</span>          <span class="c">! Sky temperature</span>
<a name="ln-465"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayHorizIRSky</span>       <span class="c">! Horizontal IR from Sky</span>
<a name="ln-466"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayBeamSolarRad</span>     <span class="c">! Direct normal solar irradiance</span>
<a name="ln-467"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayDifSolarRad</span>      <span class="c">! Sky diffuse horizontal solar irradiance</span>
<a name="ln-468"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayAlbedo</span>           <span class="c">! Albedo</span>
<a name="ln-469"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TodayLiquidPrecip</span>     <span class="c">! Liquid Precipitation Depth (mm)</span>
<a name="ln-470"></a>
<a name="ln-471"></a><span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowIsRain</span>         <span class="c">! Rain indicator, true=rain</span>
<a name="ln-472"></a><span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowIsSnow</span>         <span class="c">! Snow indicator, true=snow</span>
<a name="ln-473"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowRainAmount</span>     <span class="c">! ficitious indicator of Rain</span>
<a name="ln-474"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowSnowAmount</span>     <span class="c">! ficitious indicator of Snow</span>
<a name="ln-475"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowOutDryBulbTemp</span>   <span class="c">! Dry bulb temperature of outside air</span>
<a name="ln-476"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowOutDewPointTemp</span>  <span class="c">! Dew Point Temperature of outside air</span>
<a name="ln-477"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowOutBaroPress</span>     <span class="c">! Barometric pressure of outside air</span>
<a name="ln-478"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowOutRelHum</span>        <span class="c">! Relative Humidity of outside air</span>
<a name="ln-479"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowWindSpeed</span>        <span class="c">! Wind speed of outside air</span>
<a name="ln-480"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowWindDir</span>          <span class="c">! Wind direction of outside air</span>
<a name="ln-481"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowSkyTemp</span>          <span class="c">! Sky temperature</span>
<a name="ln-482"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowHorizIRSky</span>       <span class="c">! Horizontal IR from Sky</span>
<a name="ln-483"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowBeamSolarRad</span>     <span class="c">! Direct normal solar irradiance</span>
<a name="ln-484"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowDifSolarRad</span>      <span class="c">! Sky diffuse horizontal solar irradiance</span>
<a name="ln-485"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowAlbedo</span>           <span class="c">! Albedo</span>
<a name="ln-486"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">TomorrowLiquidPrecip</span>     <span class="c">! Liquid Precipitation Depth</span>
<a name="ln-487"></a>
<a name="ln-488"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">DDDBRngModifier</span>        <span class="c">! Design Day Dry-bulb Temperature Range Modifier</span>
<a name="ln-489"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">DDHumIndModifier</span>       <span class="c">! Design Day relative humidity values</span>
<a name="ln-490"></a>                                                                    <span class="c">!   or wet-bulb modifiers (per HumIndType)</span>
<a name="ln-491"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">DDBeamSolarValues</span>       <span class="c">! Design Day Beam Solar Values</span>
<a name="ln-492"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">DDDiffuseSolarValues</span>    <span class="c">! Design Day Relative Humidity Values</span>
<a name="ln-493"></a>
<a name="ln-494"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span> <span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">DDSkyTempScheduleValues</span> <span class="c">! Sky temperature - DesignDay input</span>
<a name="ln-495"></a>
<a name="ln-496"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RptIsRain</span><span class="o">=</span><span class="mi">0</span>            <span class="c">! Rain Report Value</span>
<a name="ln-497"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RptIsSnow</span><span class="o">=</span><span class="mi">0</span>            <span class="c">! Snow Report Value</span>
<a name="ln-498"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RptDayType</span><span class="o">=</span><span class="mi">0</span>           <span class="c">! DayType Report Value</span>
<a name="ln-499"></a>
<a name="ln-500"></a>
<a name="ln-501"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HrAngle</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Current Hour Angle</span>
<a name="ln-502"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SolarAltitudeAngle</span> <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Angle of Solar Altitude (degrees)</span>
<a name="ln-503"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SolarAzimuthAngle</span>  <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Angle of Solar Azimuth (degrees)</span>
<a name="ln-504"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorizIRSky</span>         <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Horizontal Infrared Radiation Intensity (W/m2)</span>
<a name="ln-505"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TimeStepFraction</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fraction of hour each time step represents</span>
<a name="ln-506"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SPSiteDryBulbRangeModScheduleValue</span>    <span class="c">! reporting Drybulb Temperature Range Modifier Schedule Value</span>
<a name="ln-507"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SPSiteHumidityConditionScheduleValue</span>  <span class="c">! reporting Humidity Condition Schedule Value</span>
<a name="ln-508"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SPSiteBeamSolarScheduleValue</span>          <span class="c">! reporting Beam Solar Schedule Value</span>
<a name="ln-509"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SPSiteDiffuseSolarScheduleValue</span>       <span class="c">! reporting Diffuse Solar Schedule Value</span>
<a name="ln-510"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SPSiteSkyTemperatureScheduleValue</span>     <span class="c">! reporting SkyTemperature Modifier Schedule Value</span>
<a name="ln-511"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">SPSiteScheduleNamePtr</span> <span class="c">! SP Site Schedule Name Ptrs</span>
<a name="ln-512"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SPSiteScheduleUnits</span> <span class="c">! SP Site Schedule Units</span>
<a name="ln-513"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Number of SP Site Schedules (DesignDay only)</span>
<a name="ln-514"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumMissing</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! Number of hours of missing data</span>
<a name="ln-515"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">StripCR</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! If true, strip last character (&lt;cr&gt; off each EPW line)</span>
<a name="ln-516"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Interpolation</span>       <span class="c">! Interpolation values based on Number of Time Steps in Hour</span>
<a name="ln-517"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SolarInterpolation</span>  <span class="c">! Solar Interpolation values based on</span>
<a name="ln-518"></a>                                                                   <span class="c">!      Number of Time Steps in Hour</span>
<a name="ln-519"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EndDayOfMonth</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">31</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="o">/</span><span class="p">)</span>
<a name="ln-520"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorInWeatherFile</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>   <span class="c">! Set to TRUE when there is a problem with dates</span>
<a name="ln-521"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">0</span>                  <span class="c">! Set during environment if leap year is active (adds 1 to number days in Feb)</span>
<a name="ln-522"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DatesShouldBeReset</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>   <span class="c">! True when weekdays should be reset</span>
<a name="ln-523"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">StartDatesCycleShouldBeReset</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! True when start dates on repeat should be reset</span>
<a name="ln-524"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">Jan1DatesShouldBeReset</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>    <span class="c">! True if Jan 1 should signal reset of dates</span>
<a name="ln-525"></a>
<a name="ln-526"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE WeatherManager</span>
<a name="ln-527"></a><span class="k">PUBLIC  </span><span class="n">ManageWeather</span>
<a name="ln-528"></a><span class="k">PUBLIC  </span><span class="n">GetNextEnvironment</span>
<a name="ln-529"></a><span class="k">PUBLIC  </span><span class="n">ResetEnvironmentCounter</span>
<a name="ln-530"></a><span class="k">PRIVATE </span><span class="n">InitializeWeather</span>
<a name="ln-531"></a><span class="k">PRIVATE </span><span class="n">UpdateWeatherData</span>
<a name="ln-532"></a><span class="k">PRIVATE </span><span class="n">SetCurrentWeather</span>
<a name="ln-533"></a><span class="k">PRIVATE </span><span class="n">ReadWeatherForDay</span>
<a name="ln-534"></a><span class="k">PRIVATE </span><span class="n">ReadEPlusWeatherForDay</span>
<a name="ln-535"></a><span class="k">PRIVATE </span><span class="n">InterpretWeatherDataLine</span>
<a name="ln-536"></a><span class="k">Private </span><span class="n">SetUpDesignDay</span>
<a name="ln-537"></a><span class="k">PRIVATE </span><span class="n">CalculateDailySolarCoeffs</span>
<a name="ln-538"></a><span class="k">PRIVATE </span><span class="n">CalculateSunDirectionCosines</span>
<a name="ln-539"></a><span class="k">PRIVATE </span><span class="n">OpenWeatherFile</span>
<a name="ln-540"></a><span class="k">PRIVATE </span><span class="n">CloseWeatherFile</span>
<a name="ln-541"></a><span class="k">PRIVATE </span><span class="n">OpenEPlusWeatherFile</span>
<a name="ln-542"></a><span class="k">PRIVATE </span><span class="n">ResolveLocationInformation</span>
<a name="ln-543"></a><span class="k">PRIVATE </span><span class="n">CheckLocationValidity</span>
<a name="ln-544"></a><span class="k">PRIVATE </span><span class="n">CheckWeatherFileValidity</span>
<a name="ln-545"></a><span class="k">PRIVATE </span><span class="n">ReportOutputFileHeaders</span>
<a name="ln-546"></a><span class="k">PRIVATE </span><span class="n">ReportWeatherAndTimeInformation</span>
<a name="ln-547"></a><span class="c">!PUBLIC  ProcessDateString</span>
<a name="ln-548"></a><span class="c">! Get Input from Input File</span>
<a name="ln-549"></a><span class="k">PRIVATE </span><span class="n">ReadUserWeatherInput</span>
<a name="ln-550"></a><span class="k">PRIVATE </span><span class="n">GetRunPeriodData</span>
<a name="ln-551"></a><span class="k">PRIVATE </span><span class="n">GetRunPeriodDesignData</span>
<a name="ln-552"></a><span class="k">PRIVATE </span><span class="n">GetDesignDayData</span>
<a name="ln-553"></a><span class="k">PRIVATE </span><span class="n">GetLocationInfo</span>
<a name="ln-554"></a><span class="k">PRIVATE </span><span class="n">GetWeatherProperties</span>
<a name="ln-555"></a><span class="k">PRIVATE </span><span class="n">GetSTM</span>
<a name="ln-556"></a><span class="k">PRIVATE </span><span class="n">GetWaterMainsTemperatures</span>
<a name="ln-557"></a><span class="k">PRIVATE </span><span class="n">CalcWaterMainsTemp</span>
<a name="ln-558"></a><span class="k">PRIVATE </span><span class="n">GetWeatherStation</span>
<a name="ln-559"></a><span class="k">PRIVATE </span><span class="n">SetupEnvironmentTypes</span>
<a name="ln-560"></a>
<a name="ln-561"></a><span class="k">CONTAINS</span>
<a name="ln-562"></a>
<a name="ln-563"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-564"></a>
<a name="ln-565"></a><span class="k">SUBROUTINE </span><span class="n">ManageWeather</span>        <span class="c">! Main driver routine for this module</span>
<a name="ln-566"></a>
<a name="ln-567"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-568"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-569"></a>          <span class="c">!       DATE WRITTEN   May 1997</span>
<a name="ln-570"></a>          <span class="c">!       MODIFIED       June 1997 (general clean-up)</span>
<a name="ln-571"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-572"></a>
<a name="ln-573"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-574"></a>          <span class="c">! This subroutine is the main driver of the weather manager module.</span>
<a name="ln-575"></a>          <span class="c">! It controls the assignment of weather related global variables as</span>
<a name="ln-576"></a>          <span class="c">! well as the reads and writes for weather information.</span>
<a name="ln-577"></a>
<a name="ln-578"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-579"></a>          <span class="c">! Standard EnergyPlus &quot;manager&quot; methodology.</span>
<a name="ln-580"></a>
<a name="ln-581"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-582"></a>          <span class="c">! na</span>
<a name="ln-583"></a>
<a name="ln-584"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-585"></a>          <span class="c">! na</span>
<a name="ln-586"></a>
<a name="ln-587"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-588"></a>
<a name="ln-589"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-590"></a>          <span class="c">! na</span>
<a name="ln-591"></a>
<a name="ln-592"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-593"></a>          <span class="c">! na</span>
<a name="ln-594"></a>
<a name="ln-595"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-596"></a>          <span class="c">! na</span>
<a name="ln-597"></a>
<a name="ln-598"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-599"></a>          <span class="c">! na</span>
<a name="ln-600"></a>
<a name="ln-601"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-602"></a>
<a name="ln-603"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>   <span class="kd">::</span> <span class="n">PrintEnvrnStamp</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>    <span class="c">! Set to true when the environment header should be printed</span>
<a name="ln-604"></a>
<a name="ln-605"></a>          <span class="c">! FLOW:</span>
<a name="ln-606"></a>
<a name="ln-607"></a>  <span class="k">CALL </span><span class="n">InitializeWeather</span><span class="p">(</span><span class="n">PrintEnvrnStamp</span><span class="p">)</span>
<a name="ln-608"></a>
<a name="ln-609"></a>  <span class="k">CALL </span><span class="n">SetCurrentWeather</span>
<a name="ln-610"></a>
<a name="ln-611"></a>  <span class="k">CALL </span><span class="n">ReportWeatherAndTimeInformation</span><span class="p">(</span><span class="n">PrintEnvrnStamp</span><span class="p">)</span>
<a name="ln-612"></a>
<a name="ln-613"></a>  <span class="k">RETURN</span>
<a name="ln-614"></a>
<a name="ln-615"></a><span class="k">END SUBROUTINE </span><span class="n">ManageWeather</span>
<a name="ln-616"></a>
<a name="ln-617"></a><span class="k">SUBROUTINE </span><span class="n">ResetEnvironmentCounter</span>
<a name="ln-618"></a>
<a name="ln-619"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-620"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-621"></a>          <span class="c">!       DATE WRITTEN   August 2010</span>
<a name="ln-622"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-623"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-624"></a>
<a name="ln-625"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-626"></a>          <span class="c">! This routine provides an easy method to assure that the environment</span>
<a name="ln-627"></a>          <span class="c">! counter (used by GetNextEnvironment) is reset before SetupSimulation or</span>
<a name="ln-628"></a>          <span class="c">! Simulating.  May not be necessary, but just in case.</span>
<a name="ln-629"></a>
<a name="ln-630"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-631"></a>          <span class="c">! na</span>
<a name="ln-632"></a>
<a name="ln-633"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-634"></a>          <span class="c">! na</span>
<a name="ln-635"></a>
<a name="ln-636"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-637"></a>          <span class="c">! na</span>
<a name="ln-638"></a>
<a name="ln-639"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-640"></a>
<a name="ln-641"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-642"></a>          <span class="c">! na</span>
<a name="ln-643"></a>
<a name="ln-644"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-645"></a>          <span class="c">! na</span>
<a name="ln-646"></a>
<a name="ln-647"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-648"></a>          <span class="c">! na</span>
<a name="ln-649"></a>
<a name="ln-650"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-651"></a>          <span class="c">! na</span>
<a name="ln-652"></a>
<a name="ln-653"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-654"></a>          <span class="c">! na</span>
<a name="ln-655"></a>
<a name="ln-656"></a>  <span class="n">Envrn</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-657"></a>
<a name="ln-658"></a>  <span class="k">RETURN</span>
<a name="ln-659"></a>
<a name="ln-660"></a><span class="k">END SUBROUTINE </span><span class="n">ResetEnvironmentCounter</span>
<a name="ln-661"></a>
<a name="ln-662"></a><span class="k">SUBROUTINE </span><span class="n">GetNextEnvironment</span><span class="p">(</span><span class="n">Available</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-663"></a>
<a name="ln-664"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-665"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-666"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-667"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-668"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-669"></a>
<a name="ln-670"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-671"></a>          <span class="c">! This subroutine is called from the outer simulation manager and determines</span>
<a name="ln-672"></a>          <span class="c">! if another environment is available in the &quot;run list&quot; or if the end has been</span>
<a name="ln-673"></a>          <span class="c">! reached.</span>
<a name="ln-674"></a>
<a name="ln-675"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-676"></a>          <span class="c">! na</span>
<a name="ln-677"></a>
<a name="ln-678"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-679"></a>          <span class="c">! na</span>
<a name="ln-680"></a>
<a name="ln-681"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-682"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InvJulianDay</span><span class="p">,</span> <span class="n">JulianDay</span><span class="p">,</span> <span class="n">BetweenDates</span>
<a name="ln-683"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span>
<a name="ln-684"></a>
<a name="ln-685"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupEMSActuator</span>
<a name="ln-686"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AdaptiveComfortRequested_ASH55</span><span class="p">,</span> <span class="n">AdaptiveComfortRequested_CEN15251</span>
<a name="ln-687"></a>  <span class="k">USE </span><span class="n">ThermalComfort</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcThermalComfortAdaptiveASH55</span><span class="p">,</span><span class="n">CalcThermalComfortAdaptiveCEN15251</span>
<a name="ln-688"></a>
<a name="ln-689"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-690"></a>
<a name="ln-691"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-692"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Available</span>    <span class="c">! true if there is another environment, false if the end</span>
<a name="ln-693"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! will be set to true if severe errors are found in inputs</span>
<a name="ln-694"></a>
<a name="ln-695"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-696"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetNextEnvironment: &#39;</span>
<a name="ln-697"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvironFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;! &lt;Environment&gt;,Environment Name,Environment Type, Start Date, End Date,&#39;,   &amp;</span>
<a name="ln-698"></a><span class="s2">                                                       &amp; &#39; Start DayOfWeek, Duration {#days}, Source:Start DayOfWeek, &#39;,       &amp;</span>
<a name="ln-699"></a><span class="s2">                                                       &amp; &#39; Use Daylight Saving, Use Holidays, Apply Weekend Holiday Rule, &#39;,   &amp;</span>
<a name="ln-700"></a><span class="s2">                                                       &amp; &#39; Use Rain Values, Use Snow Values&#39;,/,                                &amp;</span>
<a name="ln-701"></a><span class="s2">                                               &amp; &#39;! &lt;Environment:Special Days&gt;, Special Day Name, Special Day Type, Source, &#39;, &amp;</span>
<a name="ln-702"></a><span class="s2">                                                       &amp; &#39;Start Date, Duration {#days}&#39;,/,                                     &amp;</span>
<a name="ln-703"></a><span class="s2">                                               &amp; &#39;! &lt;Environment:Daylight Saving&gt;, Daylight Saving Indicator, Source,&#39;,        &amp;</span>
<a name="ln-704"></a><span class="s2">                                                       &amp;   &#39; Start Date, End Date&#39;,/,                                          &amp;</span>
<a name="ln-705"></a><span class="s2">                                               &amp; &#39;! &lt;Environment:WarmupDays&gt;, NumberofWarmupDays&#39;)&quot;</span>
<a name="ln-706"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvNameFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;Environment&#39;,12(&#39;,&#39;,A))&quot;</span>
<a name="ln-707"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvDSTNFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;Environment:Daylight Saving,No,&#39;,A)&quot;</span>
<a name="ln-708"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvDSTYFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;Environment:Daylight Saving,Yes&#39;,3(&#39;,&#39;,A))&quot;</span>
<a name="ln-709"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvSpDyFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;Environment:Special Days&#39;,4(&#39;,&#39;,A),&#39;,&#39;,I3)&quot;</span>
<a name="ln-710"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DateFormat</span><span class="o">=</span><span class="s2">&quot;(I2.2,&#39;/&#39;,I2.2)&quot;</span>
<a name="ln-711"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DateFormatwithYear</span><span class="o">=</span><span class="s2">&quot;(I2.2,&#39;/&#39;,I2.2,&#39;/&#39;,I4.4)&quot;</span>
<a name="ln-712"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecialDayNames</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s2">&quot;Holiday        &quot;</span><span class="p">,</span><span class="s2">&quot;SummerDesignDay&quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-713"></a>                                                                 <span class="s2">&quot;WinterDesignDay&quot;</span><span class="p">,</span><span class="s2">&quot;CustomDay1     &quot;</span><span class="p">,</span><span class="s2">&quot;CustomDay2     &quot;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-714"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ValidDayNames</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s2">&quot;Sunday         &quot;</span><span class="p">,</span><span class="s2">&quot;Monday         &quot;</span><span class="p">,</span><span class="s2">&quot;Tuesday        &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-715"></a>                                                                <span class="s2">&quot;Wednesday      &quot;</span><span class="p">,</span><span class="s2">&quot;Thursday       &quot;</span><span class="p">,</span><span class="s2">&quot;Friday         &quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-716"></a>                                                                <span class="s2">&quot;Saturday       &quot;</span><span class="p">,</span><span class="s2">&quot;Holiday        &quot;</span><span class="p">,</span><span class="s2">&quot;SummerDesignDay&quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-717"></a>                                                                <span class="s2">&quot;WinterDesignDay&quot;</span><span class="p">,</span><span class="s2">&quot;CustomDay1     &quot;</span><span class="p">,</span><span class="s2">&quot;CustomDay2     &quot;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-718"></a>
<a name="ln-719"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-720"></a>          <span class="c">! na</span>
<a name="ln-721"></a>
<a name="ln-722"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-723"></a>          <span class="c">! na</span>
<a name="ln-724"></a>
<a name="ln-725"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-726"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>   <span class="kd">::</span> <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! Set to true before execution starts</span>
<a name="ln-727"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>   <span class="kd">::</span> <span class="n">FirstCall</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-728"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>   <span class="kd">::</span> <span class="n">PrntEnvHeaders</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-729"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-730"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop1</span>
<a name="ln-731"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StDate</span>
<a name="ln-732"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnDate</span>
<a name="ln-733"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-734"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cTotalEnvDays</span>
<a name="ln-735"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDays</span>
<a name="ln-736"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DSTActStMon</span>
<a name="ln-737"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DSTActStDay</span>
<a name="ln-738"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DSTActEnMon</span>
<a name="ln-739"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DSTActEnDay</span>
<a name="ln-740"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RunStJDay</span>
<a name="ln-741"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RunEnJDay</span>
<a name="ln-742"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">OkRun</span>
<a name="ln-743"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisWeekDay</span>
<a name="ln-744"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TWeekDay</span>
<a name="ln-745"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MonWeekDay</span>
<a name="ln-746"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ActEndDayOfMonth</span>
<a name="ln-747"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisDay</span>
<a name="ln-748"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay</span>
<a name="ln-749"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay1</span>
<a name="ln-750"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay5Start</span>
<a name="ln-751"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay5End</span>
<a name="ln-752"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Source</span>
<a name="ln-753"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ApWkRule</span>
<a name="ln-754"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlpUseDST</span>
<a name="ln-755"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlpUseSpec</span>
<a name="ln-756"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlpUseRain</span>
<a name="ln-757"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlpUseSnow</span>
<a name="ln-758"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kindOfRunPeriod</span>
<a name="ln-759"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GrossApproxAvgDryBulb</span>
<a name="ln-760"></a>
<a name="ln-761"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginSimFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">FirstCall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-762"></a>
<a name="ln-763"></a><span class="k">    </span><span class="n">PrintEndDataDictionary</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-764"></a>
<a name="ln-765"></a>    <span class="k">CALL </span><span class="n">ReportOutputFileHeaders</span>    <span class="c">! Write the output file header information</span>
<a name="ln-766"></a>
<a name="ln-767"></a>    <span class="c">! SetupOutputVariables, CurrentModuleObject=&#39;All Simulations&#39;</span>
<a name="ln-768"></a>
<a name="ln-769"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Drybulb Temperature [C]&#39;</span><span class="p">,</span><span class="n">OutDryBulbTemp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-770"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Dewpoint Temperature [C]&#39;</span><span class="p">,</span><span class="n">OutDewPointTemp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-771"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Wetbulb Temperature [C]&#39;</span><span class="p">,</span><span class="n">OutWetBulbTemp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-772"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Humidity Ratio [kgWater/kgDryAir]&#39;</span><span class="p">,</span><span class="n">OutHumRat</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-773"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Relative Humidity [%]&#39;</span><span class="p">,</span><span class="n">OutRelHum</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-774"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Barometric Pressure [Pa]&#39;</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-775"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Wind Speed [m/s]&#39;</span><span class="p">,</span><span class="n">WindSpeed</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-776"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Wind Direction [deg]&#39;</span><span class="p">,</span><span class="n">WindDir</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-777"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Sky Temperature [C]&#39;</span><span class="p">,</span><span class="n">SkyTemp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-778"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Horizontal Infrared Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span><span class="n">HorizIRSky</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-779"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Diffuse Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span><span class="n">DifSolarRad</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-780"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Direct Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span><span class="n">BeamSolarRad</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-781"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Precipitation Depth [m]&#39;</span><span class="p">,</span><span class="n">LiquidPrecipitation</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-782"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Ground Reflected Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-783"></a>                                 <span class="n">GndSolarRad</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-784"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Ground Temperature [C]&#39;</span><span class="p">,</span><span class="n">GroundTemp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-785"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Surface Ground Temperature [C]&#39;</span><span class="p">,</span><span class="n">GroundTemp_Surface</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-786"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Deep Ground Temperature [C]&#39;</span><span class="p">,</span><span class="n">GroundTemp_Deep</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-787"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Simple Factor Model Ground Temperature [C]&#39;</span><span class="p">,</span><span class="n">GroundTempFC</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-788"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Enthalpy [J/kg]&#39;</span><span class="p">,</span><span class="n">OutEnthalpy</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-789"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Outdoor Air Density [kg/m3]&#39;</span><span class="p">,</span><span class="n">OutAirDensity</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-790"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Solar Azimuth Angle [deg]&#39;</span><span class="p">,</span><span class="n">SolarAzimuthAngle</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-791"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Solar Altitude Angle [deg]&#39;</span><span class="p">,</span><span class="n">SolarAltitudeAngle</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-792"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Solar Hour Angle [deg]&#39;</span><span class="p">,</span><span class="n">HrAngle</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-793"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Rain Status []&#39;</span><span class="p">,</span><span class="n">RptIsRain</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-794"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Snow on Ground Status []&#39;</span><span class="p">,</span><span class="n">RptIsSnow</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-795"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Exterior Horizontal Sky Illuminance [lux]&#39;</span><span class="p">,</span><span class="n">HISKF</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-796"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Exterior Horizontal Beam Illuminance [lux]&#39;</span><span class="p">,</span><span class="n">HISUNF</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-797"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Exterior Beam Normal Illuminance [lux]&#39;</span><span class="p">,</span><span class="n">HISUNFnorm</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-798"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Sky Diffuse Solar Radiation Luminous Efficacy [lum/W]&#39;</span><span class="p">,</span><span class="n">PDIFLW</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-799"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Beam Solar Radiation Luminous Efficacy [lum/W]&#39;</span><span class="p">,</span><span class="n">PDIRLW</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-800"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Daylighting Model Sky Clearness []&#39;</span><span class="p">,</span><span class="n">SkyClearness</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-801"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Daylighting Model Sky Brightness []&#39;</span><span class="p">,</span><span class="n">SkyBrightness</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-802"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Daylight Saving Time Status []&#39;</span><span class="p">,</span><span class="n">DSTIndicator</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-803"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Day Type Index []&#39;</span><span class="p">,</span><span class="n">RptDayType</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-804"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Site Mains Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">WaterMainsTemp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="s1">&#39;Environment&#39;</span><span class="p">)</span>
<a name="ln-805"></a>
<a name="ln-806"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-807"></a><span class="k">      CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Weather Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;Outdoor Dry Bulb&#39;</span><span class="p">,</span> <span class="s1">&#39;[C]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-808"></a>                               <span class="n">EMSOutDryBulbOverrideOn</span>  <span class="p">,</span> <span class="n">EMSOutDryBulbOverrideValue</span> <span class="p">)</span>
<a name="ln-809"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Weather Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;Outdoor Dew Point&#39;</span><span class="p">,</span> <span class="s1">&#39;[C]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-810"></a>                               <span class="n">EMSOutDewPointTempOverrideOn</span>  <span class="p">,</span> <span class="n">EMSOutDewPointTempOverrideValue</span> <span class="p">)</span>
<a name="ln-811"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Weather Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;Outdoor Relative Humidity&#39;</span><span class="p">,</span> <span class="s1">&#39;[%]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-812"></a>                               <span class="n">EMSOutRelHumOverrideOn</span>  <span class="p">,</span> <span class="n">EMSOutRelHumOverrideValue</span> <span class="p">)</span>
<a name="ln-813"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Weather Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;Diffuse Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;[W/m2]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-814"></a>                               <span class="n">EMSDifSolarRadOverrideOn</span>  <span class="p">,</span> <span class="n">EMSDifSolarRadOverrideValue</span> <span class="p">)</span>
<a name="ln-815"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Weather Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;Direct Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;[W/m2]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-816"></a>                               <span class="n">EMSBeamSolarRadOverrideOn</span>  <span class="p">,</span> <span class="n">EMSBeamSolarRadOverrideValue</span> <span class="p">)</span>
<a name="ln-817"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Weather Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;Wind Speed&#39;</span><span class="p">,</span> <span class="s1">&#39;[m/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-818"></a>                               <span class="n">EMSWindSpeedOverrideOn</span>  <span class="p">,</span> <span class="n">EMSWindSpeedOverrideValue</span> <span class="p">)</span>
<a name="ln-819"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Weather Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;Wind Direction&#39;</span><span class="p">,</span> <span class="s1">&#39;[deg]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-820"></a>                               <span class="n">EMSWindDirOverrideOn</span>  <span class="p">,</span> <span class="n">EMSWindDirOverrideValue</span> <span class="p">)</span>
<a name="ln-821"></a>    <span class="n">ENDIF</span>
<a name="ln-822"></a>
<a name="ln-823"></a>    <span class="n">FirstCall</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-824"></a>
<a name="ln-825"></a>  <span class="k">END IF</span>    <span class="c">! ... end of BeginSimFlag IF-THEN block.</span>
<a name="ln-826"></a>
<a name="ln-827"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-828"></a>
<a name="ln-829"></a><span class="k">    CALL </span><span class="n">SetUpInterpolationValues</span>
<a name="ln-830"></a>    <span class="n">TimeStepFraction</span><span class="o">=</span><span class="mf">1.d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-831"></a>
<a name="ln-832"></a>    <span class="k">CALL </span><span class="n">OpenWeatherFile</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>   <span class="c">! moved here because of possibility of special days on EPW file</span>
<a name="ln-833"></a>    <span class="k">CALL </span><span class="n">CloseWeatherFile</span>
<a name="ln-834"></a>    <span class="k">CALL </span><span class="n">ReadUserWeatherInput</span>
<a name="ln-835"></a>    <span class="k">CALL </span><span class="n">AllocateWeatherData</span>
<a name="ln-836"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumIntervalsPerHour</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-837"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">NumIntervalsPerHour</span> <span class="o">/=</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-838"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-839"></a>           <span class="s1">&#39;Number of intervals per hour on Weather file does not match specified number of Time Steps Per Hour&#39;</span><span class="p">)</span>
<a name="ln-840"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-841"></a>      <span class="n">ENDIF</span>
<a name="ln-842"></a>    <span class="n">ENDIF</span>
<a name="ln-843"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-844"></a>    <span class="n">Envrn</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-845"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfEnvrn</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-846"></a><span class="k">      CALL </span><span class="n">ResolveLocationInformation</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="c">! Obtain weather related info from input file</span>
<a name="ln-847"></a>      <span class="k">CALL </span><span class="n">CheckLocationValidity</span>
<a name="ln-848"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">NumOfEnvrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">/=</span> <span class="n">ksDesignDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-849"></a><span class="k">        CALL </span><span class="n">CheckWeatherFileValidity</span>
<a name="ln-850"></a>      <span class="n">ENDIF</span>
<a name="ln-851"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-852"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;No location specified, program will terminate.&#39;</span><span class="p">)</span>
<a name="ln-853"></a>      <span class="n">ENDIF</span>
<a name="ln-854"></a>    <span class="k">ELSE</span>
<a name="ln-855"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-856"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;No Design Days or Run Period(s) specified, program will terminate.&#39;</span><span class="p">)</span>
<a name="ln-857"></a>    <span class="n">ENDIF</span>
<a name="ln-858"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DDOnly</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TotDesDays</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-859"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-860"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-861"></a>         <span class="s1">&#39;Requested Design Days only (DDOnly) but no Design Days specified, program will terminate.&#39;</span><span class="p">)</span>
<a name="ln-862"></a>    <span class="n">ENDIF</span>
<a name="ln-863"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ReverseDD</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TotDesDays</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-864"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-865"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-866"></a>         <span class="s1">&#39;Requested Reverse Design Days (ReverseDD) but only 1 Design Day specified, program will terminate.&#39;</span><span class="p">)</span>
<a name="ln-867"></a>    <span class="n">ENDIF</span>
<a name="ln-868"></a>    <span class="n">CurrentOverallSimDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-869"></a>    <span class="n">TotalOverallSimDays</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-870"></a>    <span class="n">MaxNumberSimYears</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-871"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfEnvrn</span>
<a name="ln-872"></a>      <span class="n">TotalOverallSimDays</span><span class="o">=</span><span class="n">TotalOverallSimDays</span><span class="o">+</span><span class="n">Environment</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">TotalDays</span>
<a name="ln-873"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-874"></a><span class="k">        </span><span class="n">MaxNumberSimYears</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumberSimYears</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">NumSimYears</span><span class="p">)</span>
<a name="ln-875"></a>      <span class="n">ENDIF</span>
<a name="ln-876"></a>    <span class="n">ENDDO</span>
<a name="ln-877"></a>    <span class="k">CALL </span><span class="n">DisplaySimDaysProgress</span><span class="p">(</span><span class="n">CurrentOverallSimDay</span><span class="p">,</span><span class="n">TotalOverallSimDays</span><span class="p">)</span>
<a name="ln-878"></a>  <span class="n">ENDIF</span>
<a name="ln-879"></a>
<a name="ln-880"></a>  <span class="k">CALL </span><span class="n">CloseWeatherFile</span>  <span class="c">! will only close if opened.</span>
<a name="ln-881"></a>  <span class="n">Envrn</span><span class="o">=</span><span class="n">Envrn</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-882"></a>  <span class="n">DatesShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-883"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Envrn</span> <span class="o">&gt;</span> <span class="n">NumOfEnvrn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-884"></a><span class="k">    </span><span class="n">Available</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-885"></a>    <span class="n">Envrn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-886"></a>    <span class="n">CurEnvirNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-887"></a>  <span class="k">ELSE</span>
<a name="ln-888"></a><span class="k">    </span><span class="n">KindOfSim</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span>
<a name="ln-889"></a>    <span class="n">DayOfYear</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span>
<a name="ln-890"></a>    <span class="n">DayOfMonth</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-891"></a>    <span class="n">Month</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span>
<a name="ln-892"></a>    <span class="n">NumOfDayInEnvrn</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span>  <span class="c">! Set day loop maximum from DataGlobals</span>
<a name="ln-893"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-894"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">AdaptiveComfortRequested_ASH55</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">AdaptiveComfortRequested_CEN15251</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-895"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksDesignDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-896"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DoDesDaySim</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-897"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Adaptive Comfort being reported during design day.&#39;</span><span class="p">)</span>
<a name="ln-898"></a>            <span class="n">GrossApproxAvgDryBulb</span><span class="o">=</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-899"></a>               <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="o">-</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DailyDBRange</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-900"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">AdaptiveComfortRequested_ASH55</span><span class="p">)</span> <span class="k">CALL </span><span class="n">CalcThermalComfortAdaptiveASH55</span><span class="p">(.</span><span class="n">true</span><span class="p">.,.</span><span class="n">false</span><span class="p">.,</span><span class="n">GrossApproxAvgDryBulb</span><span class="p">)</span>
<a name="ln-901"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">AdaptiveComfortRequested_CEN15251</span><span class="p">)</span> <span class="k">CALL </span><span class="n">CalcThermalComfortAdaptiveCEN15251</span><span class="p">(.</span><span class="n">true</span><span class="p">.,.</span><span class="n">false</span><span class="p">.,</span><span class="n">GrossApproxAvgDryBulb</span><span class="p">)</span>
<a name="ln-902"></a>          <span class="n">ENDIF</span>
<a name="ln-903"></a>        <span class="k">ELSE</span>
<a name="ln-904"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DoWeathSim</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DoDesDaySim</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-905"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">AdaptiveComfortRequested_ASH55</span><span class="p">)</span> <span class="k">CALL </span><span class="n">CalcThermalComfortAdaptiveASH55</span><span class="p">(.</span><span class="n">true</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-906"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">AdaptiveComfortRequested_CEN15251</span><span class="p">)</span> <span class="k">CALL </span><span class="n">CalcThermalComfortAdaptiveCEN15251</span><span class="p">(.</span><span class="n">true</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-907"></a>          <span class="n">ENDIF</span>
<a name="ln-908"></a>        <span class="n">ENDIF</span>
<a name="ln-909"></a>      <span class="n">ENDIF</span>
<a name="ln-910"></a>    <span class="n">ENDIF</span>
<a name="ln-911"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Envrn</span> <span class="o">&gt;</span> <span class="n">TotDesDays</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WeatherFileExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-912"></a><span class="k">      CALL </span><span class="n">OpenEPlusWeatherFile</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-913"></a>    <span class="n">ENDIF</span>
<a name="ln-914"></a>    <span class="n">Available</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-915"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WeatherFileExists</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeathSim</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-916"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-917"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Weather Simulation requested, but no weather file attached.&#39;</span><span class="p">)</span>
<a name="ln-918"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-919"></a>      <span class="n">ENDIF</span>
<a name="ln-920"></a>      <span class="n">Envrn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-921"></a>      <span class="n">Available</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-922"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WeatherFileExists</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoWeathSim</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-923"></a><span class="k">      </span><span class="n">Available</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-924"></a>      <span class="n">Envrn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-925"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoingSizing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-926"></a><span class="k">      </span><span class="n">Available</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-927"></a>      <span class="n">Envrn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-928"></a>    <span class="n">ENDIF</span>
<a name="ln-929"></a>
<a name="ln-930"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Available</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Envrn</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-931"></a><span class="k">      </span><span class="n">EnvironmentName</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-932"></a>      <span class="n">CurEnvirNum</span> <span class="o">=</span> <span class="n">Envrn</span>
<a name="ln-933"></a>      <span class="n">RunPeriodStartDayOfWeek</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-934"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DoDesDaySim</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">/=</span> <span class="n">ksRunPeriodWeather</span><span class="p">))</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">((</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeathSim</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-935"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PrntEnvHeaders</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-936"></a><span class="k">          WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvironFormat</span><span class="p">)</span>
<a name="ln-937"></a>          <span class="n">PrntEnvHeaders</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-938"></a>        <span class="n">ENDIF</span>
<a name="ln-939"></a>
<a name="ln-940"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">KindOfSim</span><span class="p">)</span>
<a name="ln-941"></a>
<a name="ln-942"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">ksRunPeriodWeather</span><span class="p">,</span><span class="n">ksRunPeriodDesign</span><span class="p">)</span>
<a name="ln-943"></a>          <span class="n">kindOfRunPeriod</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">cKindOfEnvrn</span>
<a name="ln-944"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-945"></a><span class="k">            </span><span class="n">RunPeriodEnvironment</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-946"></a>          <span class="k">ELSE</span>
<a name="ln-947"></a><span class="k">            </span><span class="n">RunPeriodEnvironment</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-948"></a>          <span class="n">ENDIF</span>
<a name="ln-949"></a>          <span class="n">ActEndDayOfMonth</span><span class="o">=</span><span class="n">EndDayOfMonth</span>
<a name="ln-950"></a>          <span class="n">CurrentYearIsLeapYear</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span>
<a name="ln-951"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurrentYearIsLeapYear</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-952"></a><span class="k">            </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-953"></a>          <span class="k">ELSE</span>
<a name="ln-954"></a><span class="k">            </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-955"></a>          <span class="n">ENDIF</span>
<a name="ln-956"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurrentYearIsLeapYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-957"></a><span class="k">            </span><span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-958"></a>          <span class="n">ENDIF</span>
<a name="ln-959"></a>          <span class="n">UseDaylightSaving</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseDST</span>
<a name="ln-960"></a>          <span class="n">UseSpecialDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseHolidays</span>
<a name="ln-961"></a>          <span class="n">UseRainValues</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseRain</span>
<a name="ln-962"></a>          <span class="n">UseSnowValues</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseSnow</span>
<a name="ln-963"></a>
<a name="ln-964"></a>          <span class="n">OkRun</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-965"></a>          <span class="n">ThisWeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-966"></a>          <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumDataPeriods</span>
<a name="ln-967"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-968"></a><span class="k">              </span><span class="n">RunStJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-969"></a>              <span class="n">RunEnJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EnMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EnDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-970"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BetweenDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="p">,</span><span class="n">RunStJDay</span><span class="p">,</span><span class="n">RunEnJDay</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-971"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BetweenDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">,</span><span class="n">RunStJDay</span><span class="p">,</span><span class="n">RunEnJDay</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-972"></a><span class="k">              </span><span class="n">OkRun</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-973"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RunStJDay</span> <span class="o">&gt;</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-974"></a><span class="k">                </span><span class="n">NumDays</span><span class="o">=</span><span class="n">RunStJDay</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span>
<a name="ln-975"></a>              <span class="k">ELSE</span>
<a name="ln-976"></a><span class="k">                </span><span class="n">NumDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">-</span><span class="n">RunStJDay</span>
<a name="ln-977"></a>              <span class="n">ENDIF</span>
<a name="ln-978"></a>              <span class="n">ThisWeekDay</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">+</span><span class="n">NumDays</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-979"></a>              <span class="k">EXIT</span>
<a name="ln-980"></a><span class="k">            ELSE</span>  <span class="c">! Actual Weather</span>
<a name="ln-981"></a>              <span class="n">RunStJDay</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DataStJDay</span>
<a name="ln-982"></a>              <span class="n">RunEnJDay</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DataEnJDay</span>
<a name="ln-983"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">HasYearData</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-984"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetNextEnvironment: Runperiod:CustomRange has been entered but weatherfile &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-985"></a>                   <span class="s1">&#39; DATA PERIOD does not have year included in start/end date.&#39;</span><span class="p">)</span>
<a name="ln-986"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...to match the RunPeriod, the DATA PERIOD should be mm/dd/yyyy for both.&#39;</span><span class="p">)</span>
<a name="ln-987"></a>              <span class="n">ENDIF</span>
<a name="ln-988"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BetweenDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span><span class="p">,</span><span class="n">RunStJDay</span><span class="p">,</span><span class="n">RunEnJDay</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-989"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BetweenDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDate</span><span class="p">,</span><span class="n">RunStJDay</span><span class="p">,</span><span class="n">RunEnJDay</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-990"></a><span class="k">              </span><span class="n">OkRun</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-991"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RunStJDay</span> <span class="o">&gt;</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-992"></a><span class="k">                </span><span class="n">NumDays</span><span class="o">=</span><span class="n">RunStJDay</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span>
<a name="ln-993"></a>              <span class="k">ELSE</span>
<a name="ln-994"></a><span class="k">                </span><span class="n">NumDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span><span class="o">-</span><span class="n">RunStJDay</span>
<a name="ln-995"></a>              <span class="n">ENDIF</span>
<a name="ln-996"></a>              <span class="n">ThisWeekDay</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">+</span><span class="n">NumDays</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-997"></a>              <span class="k">EXIT</span>
<a name="ln-998"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-999"></a>          <span class="n">ENDDO</span>
<a name="ln-1000"></a>
<a name="ln-1001"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OkRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1002"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1003"></a><span class="k">              WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-1004"></a>              <span class="k">WRITE</span><span class="p">(</span><span class="n">EnDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span>
<a name="ln-1005"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Runperiod [mm/dd] (Start=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,End=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1006"></a>                                      <span class="s1">&#39;) requested not within Data Period(s) from Weather File&#39;</span><span class="p">)</span>
<a name="ln-1007"></a>            <span class="k">ELSE</span>
<a name="ln-1008"></a><span class="k">              WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormatwithYear</span><span class="p">)</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1009"></a>                 <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartYear</span>
<a name="ln-1010"></a>              <span class="k">WRITE</span><span class="p">(</span><span class="n">EnDate</span><span class="p">,</span><span class="n">DateFormatwithYear</span><span class="p">)</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1011"></a>                 <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndYear</span>
<a name="ln-1012"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Runperiod [mm/dd/yyyy] (Start=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,End=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1013"></a>                                      <span class="s1">&#39;) requested not within Data Period(s) from Weather File&#39;</span><span class="p">)</span>
<a name="ln-1014"></a>            <span class="n">ENDIF</span>
<a name="ln-1015"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StDay</span>
<a name="ln-1016"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">EnDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EnMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EnDay</span>
<a name="ln-1017"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StYear</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1018"></a><span class="k">              </span><span class="n">string</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StYear</span><span class="p">)</span>
<a name="ln-1019"></a>              <span class="n">StDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="n">string</span>
<a name="ln-1020"></a>            <span class="k">ELSE</span>
<a name="ln-1021"></a><span class="k">              </span><span class="n">StDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&lt;noyear&gt;&#39;</span>
<a name="ln-1022"></a>            <span class="n">ENDIF</span>
<a name="ln-1023"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EnYear</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1024"></a><span class="k">              </span><span class="n">string</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EnYear</span><span class="p">)</span>
<a name="ln-1025"></a>              <span class="n">EnDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="n">string</span>
<a name="ln-1026"></a>            <span class="k">ELSE</span>
<a name="ln-1027"></a><span class="k">              </span><span class="n">EnDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&lt;noyear&gt;&#39;</span>
<a name="ln-1028"></a>            <span class="n">ENDIF</span>
<a name="ln-1029"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">NumDataPeriods</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1030"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Weather Data Period (Start=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,End=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">))</span>
<a name="ln-1031"></a>            <span class="k">ELSE</span>
<a name="ln-1032"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Multiple Weather Data Periods 1st (Start=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,End=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-1033"></a>            <span class="n">ENDIF</span>
<a name="ln-1034"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Program terminates due to preceding condition.&#39;</span><span class="p">)</span>
<a name="ln-1035"></a>          <span class="n">ENDIF</span>
<a name="ln-1036"></a>
<a name="ln-1037"></a>          <span class="c">! Following builds Environment start/end for ASHRAE 55 warnings</span>
<a name="ln-1038"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-1039"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">EnDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span>
<a name="ln-1040"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1041"></a><span class="k">            </span><span class="n">string</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartYear</span><span class="p">)</span>
<a name="ln-1042"></a>            <span class="n">StDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="n">string</span>
<a name="ln-1043"></a>            <span class="n">string</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndYear</span><span class="p">)</span>
<a name="ln-1044"></a>            <span class="n">EnDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="n">string</span>
<a name="ln-1045"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1046"></a><span class="k">            </span><span class="n">string</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="p">)</span>
<a name="ln-1047"></a>            <span class="n">StDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="n">string</span>
<a name="ln-1048"></a>            <span class="n">string</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="o">+</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span><span class="p">)</span>
<a name="ln-1049"></a>            <span class="n">EnDate</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="n">string</span>
<a name="ln-1050"></a>          <span class="n">ENDIF</span>
<a name="ln-1051"></a>          <span class="n">EnvironmentStartEnd</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1054"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseDST</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1055"></a><span class="k">              </span><span class="n">AlpUseDST</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-1056"></a>            <span class="k">ELSE</span>
<a name="ln-1057"></a><span class="k">              </span><span class="n">AlpUseDST</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-1058"></a>            <span class="n">ENDIF</span>
<a name="ln-1059"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1060"></a><span class="k">              </span><span class="n">AlpUseSpec</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-1061"></a>            <span class="k">ELSE</span>
<a name="ln-1062"></a><span class="k">              </span><span class="n">AlpUseSpec</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-1063"></a>            <span class="n">ENDIF</span>
<a name="ln-1064"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1065"></a><span class="k">              </span><span class="n">ApWkRule</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-1066"></a>            <span class="k">ELSE</span>
<a name="ln-1067"></a><span class="k">              </span><span class="n">ApWkRule</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-1068"></a>            <span class="n">ENDIF</span>
<a name="ln-1069"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseRain</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1070"></a><span class="k">              </span><span class="n">AlpUseRain</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-1071"></a>            <span class="k">ELSE</span>
<a name="ln-1072"></a><span class="k">              </span><span class="n">AlpUseRain</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-1073"></a>            <span class="n">ENDIF</span>
<a name="ln-1074"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseSnow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1075"></a><span class="k">              </span><span class="n">AlpUseSnow</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-1076"></a>            <span class="k">ELSE</span>
<a name="ln-1077"></a><span class="k">              </span><span class="n">AlpUseSnow</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-1078"></a>            <span class="n">ENDIF</span>
<a name="ln-1079"></a>            <span class="n">cTotalEnvDays</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="p">)</span>
<a name="ln-1080"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Uses Weather file start</span>
<a name="ln-1081"></a>              <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvNameFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">kindOfRunPeriod</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1082"></a>                                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ValidDayNames</span><span class="p">(</span><span class="n">ThisWeekDay</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1083"></a>                                         <span class="nb">trim</span><span class="p">(</span><span class="n">cTotalEnvDays</span><span class="p">),</span><span class="s1">&#39;UseWeatherFile&#39;</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1084"></a>                                         <span class="n">AlpUseDST</span><span class="p">,</span><span class="n">AlpUseSpec</span><span class="p">,</span><span class="n">ApWkRule</span><span class="p">,</span><span class="n">AlpUseRain</span><span class="p">,</span><span class="n">AlpUseSnow</span>
<a name="ln-1085"></a>              <span class="n">TWeekDay</span><span class="o">=</span><span class="n">ThisWeekDay</span>
<a name="ln-1086"></a>              <span class="n">MonWeekDay</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span>
<a name="ln-1087"></a>            <span class="k">ELSE</span>
<a name="ln-1088"></a><span class="k">              WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvNameFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">kindOfRunPeriod</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1089"></a>                                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ValidDayNames</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1090"></a>                                         <span class="nb">trim</span><span class="p">(</span><span class="n">cTotalEnvDays</span><span class="p">),</span><span class="s1">&#39;Use RunPeriod Specified Day&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1091"></a>                                         <span class="n">AlpUseDST</span><span class="p">,</span><span class="n">AlpUseSpec</span><span class="p">,</span><span class="n">ApWkRule</span><span class="p">,</span><span class="n">AlpUseRain</span><span class="p">,</span><span class="n">AlpUseSnow</span>
<a name="ln-1092"></a>              <span class="n">TWeekDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfWeek</span>
<a name="ln-1093"></a>              <span class="n">MonWeekDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span>
<a name="ln-1094"></a>            <span class="n">ENDIF</span>
<a name="ln-1095"></a>          <span class="k">ELSE</span>  <span class="c">! just in case</span>
<a name="ln-1096"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Uses Weather file start</span>
<a name="ln-1097"></a>              <span class="n">TWeekDay</span><span class="o">=</span><span class="n">ThisWeekDay</span>
<a name="ln-1098"></a>              <span class="n">MonWeekDay</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span>
<a name="ln-1099"></a>            <span class="k">ELSE</span>
<a name="ln-1100"></a><span class="k">              </span><span class="n">TWeekDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfWeek</span>
<a name="ln-1101"></a>              <span class="n">MonWeekDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span>
<a name="ln-1102"></a>            <span class="n">ENDIF</span>
<a name="ln-1103"></a>          <span class="n">ENDIF</span>
<a name="ln-1104"></a>
<a name="ln-1105"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1106"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeathSim</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1107"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">AdaptiveComfortRequested_ASH55</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">AdaptiveComfortRequested_CEN15251</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1108"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1109"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1110"></a>                     <span class="s1">&#39;AdaptiveComfort Reporting does not work correctly with leap years in weather files.&#39;</span><span class="p">)</span>
<a name="ln-1111"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1112"></a>                <span class="n">ENDIF</span>
<a name="ln-1113"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">NumDataPeriods</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1114"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1115"></a>                     <span class="s1">&#39;AdaptiveComfort Reporting does not work correctly with multiple dataperiods in weather files.&#39;</span><span class="p">)</span>
<a name="ln-1116"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1117"></a>                <span class="n">ENDIF</span>
<a name="ln-1118"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StMon</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StDay</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1119"></a><span class="k">                  </span><span class="n">RunStJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1120"></a>                  <span class="n">RunEnJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EnMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EnDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1121"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">RunEnJDay</span><span class="o">-</span><span class="n">RunStJDay</span><span class="o">+</span><span class="mi">1</span> <span class="o">/=</span> <span class="mi">365</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1122"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1123"></a>                       <span class="s1">&#39;AdaptiveComfort Reporting does not work correctly with weather files that do not contain 365 days.&#39;</span><span class="p">)</span>
<a name="ln-1124"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1125"></a>                  <span class="n">ENDIF</span>
<a name="ln-1126"></a>                <span class="k">ELSE</span>
<a name="ln-1127"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1128"></a>                         <span class="s1">&#39;AdaptiveComfort Reporting does not work correctly with weather files that do not start on 1 January.&#39;</span><span class="p">)</span>
<a name="ln-1129"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1130"></a>                <span class="n">ENDIF</span>
<a name="ln-1131"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">NumIntervalsPerHour</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1132"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1133"></a>                     <span class="s1">&#39;AdaptiveComfort Reporting does not work correctly with weather files &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1134"></a>                     <span class="s1">&#39;that have multiple interval records per hour.&#39;</span><span class="p">)</span>
<a name="ln-1135"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1136"></a>                <span class="n">ENDIF</span>
<a name="ln-1137"></a>              <span class="n">ENDIF</span>
<a name="ln-1138"></a>            <span class="n">ENDIF</span>
<a name="ln-1139"></a>          <span class="n">ENDIF</span>
<a name="ln-1140"></a>
<a name="ln-1141"></a>          <span class="c">! Only need to set Week days for Run Days</span>
<a name="ln-1142"></a>          <span class="n">RunPeriodStartDayOfWeek</span><span class="o">=</span><span class="n">TWeekDay</span>
<a name="ln-1143"></a>          <span class="n">WeekDayTypes</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1144"></a>          <span class="n">JDay5Start</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1145"></a>          <span class="n">JDay5End</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1146"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">JDay5End</span> <span class="o">&gt;=</span> <span class="n">JDay5Start</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1147"></a><span class="k">            </span><span class="n">curSimDayforEndofRunPeriod</span><span class="o">=</span><span class="n">DayOfSim</span><span class="o">+</span><span class="p">(</span><span class="n">JDay5End</span><span class="o">-</span><span class="n">JDay5Start</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1148"></a>          <span class="k">ELSE</span>
<a name="ln-1149"></a><span class="k">            </span><span class="n">curSimDayforEndofRunPeriod</span><span class="o">=</span><span class="n">DayOfSim</span><span class="o">+</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span><span class="o">-</span><span class="n">JDay5Start</span><span class="o">+</span><span class="n">JDay5End</span>
<a name="ln-1150"></a>          <span class="n">ENDIF</span>
<a name="ln-1151"></a>          <span class="n">Loop</span><span class="o">=</span><span class="n">JDay5Start</span>
<a name="ln-1152"></a>          <span class="k">DO</span>
<a name="ln-1153"></a><span class="k">            </span><span class="n">WeekDayTypes</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">TWeekDay</span>
<a name="ln-1154"></a>            <span class="n">TWeekDay</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="n">TWeekDay</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1155"></a>            <span class="n">Loop</span><span class="o">=</span><span class="n">Loop</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1156"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Loop</span> <span class="o">&gt;</span> <span class="mi">366</span><span class="p">)</span> <span class="n">Loop</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1157"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Loop</span> <span class="o">==</span> <span class="n">JDay5End</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-1158"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">UseDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1161"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">EPWDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1162"></a><span class="k">              </span><span class="n">DaylightSavingIsActive</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1163"></a>            <span class="n">ENDIF</span>
<a name="ln-1164"></a>          <span class="k">ELSE</span>
<a name="ln-1165"></a><span class="k">            </span><span class="n">DaylightSavingIsActive</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1166"></a>          <span class="n">ENDIF</span>
<a name="ln-1167"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IDFDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1168"></a><span class="k">            </span><span class="n">DaylightSavingIsActive</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1169"></a>          <span class="n">ENDIF</span>
<a name="ln-1170"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">SetWeekDays</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1171"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1172"></a><span class="k">            </span><span class="n">curSimDayforEndofRunPeriod</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span>
<a name="ln-1173"></a>          <span class="n">ENDIF</span>
<a name="ln-1174"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DaylightSavingIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1175"></a><span class="k">            CALL </span><span class="n">SetDSTDateRanges</span><span class="p">(</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">DSTIndex</span><span class="p">,</span><span class="n">DSTActStMon</span><span class="p">,</span><span class="n">DSTActStDay</span><span class="p">,</span><span class="n">DSTActEnMon</span><span class="p">,</span><span class="n">DSTActEnDay</span><span class="p">)</span>
<a name="ln-1176"></a>          <span class="n">ENDIF</span>
<a name="ln-1177"></a>
<a name="ln-1178"></a>          <span class="k">CALL </span><span class="n">SetSpecialDayDates</span><span class="p">(</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-1179"></a>
<a name="ln-1180"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="o">/=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1181"></a><span class="k">            </span><span class="n">StartDatesCycleShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1182"></a>            <span class="n">Jan1DatesShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1183"></a>          <span class="n">ENDIF</span>
<a name="ln-1184"></a>
<a name="ln-1185"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1186"></a><span class="k">            </span><span class="n">StartDatesCycleShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1187"></a>            <span class="n">Jan1DatesShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1188"></a>          <span class="n">ENDIF</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1191"></a><span class="k">            </span><span class="n">StartDatesCycleShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1192"></a>            <span class="n">Jan1DatesShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1193"></a>          <span class="n">ENDIF</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>          <span class="c">! Report Actual Dates for Daylight Saving and Special Days</span>
<a name="ln-1196"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickoffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1197"></a><span class="k">            </span><span class="n">Source</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-1198"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UseDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1199"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">EPWDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1200"></a><span class="k">                </span><span class="n">Source</span><span class="o">=</span><span class="s1">&#39;WeatherFile&#39;</span>
<a name="ln-1201"></a>              <span class="n">ENDIF</span>
<a name="ln-1202"></a>            <span class="k">ELSE</span>
<a name="ln-1203"></a><span class="k">              </span><span class="n">Source</span><span class="o">=</span><span class="s1">&#39;RunPeriod Object&#39;</span>
<a name="ln-1204"></a>            <span class="n">ENDIF</span>
<a name="ln-1205"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IDFDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1206"></a><span class="k">              </span><span class="n">Source</span><span class="o">=</span><span class="s1">&#39;InputFile&#39;</span>
<a name="ln-1207"></a>            <span class="n">ENDIF</span>
<a name="ln-1208"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DaylightSavingIsActive</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1209"></a><span class="k">              WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">DSTActStMon</span><span class="p">,</span><span class="n">DSTActStDay</span>
<a name="ln-1210"></a>              <span class="k">WRITE</span><span class="p">(</span><span class="n">EnDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">DSTActEnMon</span><span class="p">,</span><span class="n">DSTActEnDay</span>
<a name="ln-1211"></a>              <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvDSTYFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Source</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span>
<a name="ln-1212"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DoOutputReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1213"></a><span class="k">              WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvDSTNFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Source</span><span class="p">)</span>
<a name="ln-1214"></a>            <span class="n">ENDIF</span>
<a name="ln-1215"></a>            <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumSpecialDays</span>
<a name="ln-1216"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WthrFile</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">UseSpecialDays</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1217"></a><span class="k">                WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStMon</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStDay</span>
<a name="ln-1218"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvSpDyFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>    <span class="p">&amp;</span>
<a name="ln-1219"></a>                                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDayNames</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayType</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1220"></a>                                                     <span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Duration</span>
<a name="ln-1221"></a>              <span class="n">ENDIF</span>
<a name="ln-1222"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WthrFile</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1223"></a><span class="k">                WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStMon</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStDay</span>
<a name="ln-1224"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvSpDyFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>    <span class="p">&amp;</span>
<a name="ln-1225"></a>                                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDayNames</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayType</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1226"></a>                                                     <span class="s1">&#39;InputFile&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Duration</span>
<a name="ln-1227"></a>              <span class="n">ENDIF</span>
<a name="ln-1228"></a>            <span class="n">ENDDO</span>
<a name="ln-1229"></a>          <span class="n">ENDIF</span>
<a name="ln-1230"></a>
<a name="ln-1231"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">ksDesignDay</span><span class="p">)</span> <span class="c">! Design Day</span>
<a name="ln-1232"></a>          <span class="n">RunPeriodEnvironment</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1233"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">StDate</span><span class="p">,</span><span class="n">DateFormat</span><span class="p">)</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Month</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfMonth</span>
<a name="ln-1234"></a>          <span class="n">EnDate</span><span class="o">=</span><span class="n">StDate</span>
<a name="ln-1235"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayType</span> <span class="o">&lt;=</span> <span class="mi">7</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1236"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvNameFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="p">),</span><span class="s1">&#39;SizingPeriod:DesignDay&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1237"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DaysOfWeek</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayType</span><span class="p">)),</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-1238"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1239"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvNameFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="p">),</span><span class="s1">&#39;SizingPeriod:DesignDay&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1240"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDayNames</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayType</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)),</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-1241"></a>          <span class="n">ENDIF</span>
<a name="ln-1242"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DSTIndicator</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1243"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvDSTNFormat</span><span class="p">)</span> <span class="s1">&#39;SizingPeriod:DesignDay&#39;</span>
<a name="ln-1244"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1245"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvDSTYFormat</span><span class="p">)</span> <span class="s1">&#39;SizingPeriod:DesignDay&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">StDate</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnDate</span><span class="p">)</span>
<a name="ln-1246"></a>          <span class="n">ENDIF</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a>        <span class="k">END SELECT</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1251"></a>    <span class="n">ENDIF</span>  <span class="c">! ErrorsFound</span>
<a name="ln-1252"></a>  <span class="n">ENDIF</span>
<a name="ln-1253"></a>
<a name="ln-1254"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1255"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting a new environment&#39;</span><span class="p">)</span>
<a name="ln-1256"></a>    <span class="n">Available</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1257"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1258"></a><span class="k">    </span><span class="n">Available</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1259"></a>  <span class="n">ENDIF</span>
<a name="ln-1260"></a>
<a name="ln-1261"></a>  <span class="k">RETURN</span>
<a name="ln-1262"></a>
<a name="ln-1263"></a><span class="k">END SUBROUTINE </span><span class="n">GetNextEnvironment</span>
<a name="ln-1264"></a>
<a name="ln-1265"></a><span class="k">SUBROUTINE </span><span class="n">SetupWeekDaysByMonth</span><span class="p">(</span><span class="n">StMon</span><span class="p">,</span><span class="n">StDay</span><span class="p">,</span><span class="n">StWeekDay</span><span class="p">,</span><span class="n">WeekDays</span><span class="p">)</span>
<a name="ln-1266"></a>
<a name="ln-1267"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1268"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-1269"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-1270"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1271"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1274"></a>          <span class="c">! This subroutine calculates the weekday for each month based on the start date and</span>
<a name="ln-1275"></a>          <span class="c">! weekday specified for that date.</span>
<a name="ln-1276"></a>
<a name="ln-1277"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1278"></a>          <span class="c">! na</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1281"></a>          <span class="c">! na</span>
<a name="ln-1282"></a>
<a name="ln-1283"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1284"></a>          <span class="c">! na</span>
<a name="ln-1285"></a>
<a name="ln-1286"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1287"></a>
<a name="ln-1288"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1289"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StMon</span>
<a name="ln-1290"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StDay</span>
<a name="ln-1291"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StWeekDay</span>
<a name="ln-1292"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Weekdays</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1295"></a>          <span class="c">! na</span>
<a name="ln-1296"></a>
<a name="ln-1297"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1298"></a>          <span class="c">! na</span>
<a name="ln-1299"></a>
<a name="ln-1300"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1301"></a>          <span class="c">! na</span>
<a name="ln-1302"></a>
<a name="ln-1303"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1304"></a>  <span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-1305"></a>  <span class="kt">INTEGER </span><span class="n">CurWeekDay</span>
<a name="ln-1306"></a>
<a name="ln-1307"></a>  <span class="c">! Set 1st day of Start Month</span>
<a name="ln-1308"></a>  <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">StWeekDay</span>
<a name="ln-1309"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">StDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1310"></a>    <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1311"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">CurWeekDay</span><span class="o">=</span><span class="mi">7</span>
<a name="ln-1312"></a>  <span class="n">ENDDO</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a>  <span class="n">WeekDays</span><span class="p">(</span><span class="n">StMon</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1315"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="n">StMon</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-1316"></a>
<a name="ln-1317"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1318"></a>    <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1319"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1320"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1321"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1322"></a>      <span class="n">ENDDO</span>
<a name="ln-1323"></a>      <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1324"></a>
<a name="ln-1325"></a>    <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1326"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1327"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1328"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1329"></a>      <span class="n">ENDDO</span>
<a name="ln-1330"></a>      <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a>    <span class="k">CASE</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1333"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1334"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1335"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1336"></a>      <span class="n">ENDDO</span>
<a name="ln-1337"></a>      <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1338"></a>
<a name="ln-1339"></a>    <span class="k">END SELECT</span>
<a name="ln-1340"></a><span class="k">  </span><span class="n">ENDDO</span>
<a name="ln-1341"></a>
<a name="ln-1342"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">WeekDays</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1343"></a>    <span class="c">! need to start at StMon and go backwards.</span>
<a name="ln-1344"></a>    <span class="c">! EndDayOfMonth is also &quot;days&quot; in month.  (without leapyear day in February)</span>
<a name="ln-1345"></a>    <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">StWeekDay</span>
<a name="ln-1346"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">StDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1347"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1348"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">CurWeekDay</span><span class="o">=</span><span class="mi">7</span>
<a name="ln-1349"></a>    <span class="n">ENDDO</span>
<a name="ln-1350"></a>
<a name="ln-1351"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="n">StMon</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1352"></a>
<a name="ln-1353"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1354"></a>
<a name="ln-1355"></a>      <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1356"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1357"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1358"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1359"></a>        <span class="n">ENDDO</span>
<a name="ln-1360"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1361"></a>
<a name="ln-1362"></a>      <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1363"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1364"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1365"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1366"></a>        <span class="n">ENDDO</span>
<a name="ln-1367"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a>      <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1370"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1371"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1372"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1373"></a>        <span class="n">ENDDO</span>
<a name="ln-1374"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1375"></a>      <span class="k">END SELECT</span>
<a name="ln-1376"></a>
<a name="ln-1377"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-1378"></a>
<a name="ln-1379"></a>  <span class="n">ENDIF</span>
<a name="ln-1380"></a>
<a name="ln-1381"></a>  <span class="k">RETURN</span>
<a name="ln-1382"></a>
<a name="ln-1383"></a><span class="k">END SUBROUTINE </span><span class="n">SetupWeekDaysByMonth</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a><span class="k">SUBROUTINE </span><span class="n">ResetWeekDaysByMonth</span><span class="p">(</span><span class="n">WeekDays</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">,</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">StartMonthDay</span><span class="p">,</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">EndMonthDay</span><span class="p">,</span><span class="n">Rollover</span><span class="p">,</span><span class="n">MidSimReset</span><span class="p">)</span>
<a name="ln-1386"></a>
<a name="ln-1387"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1388"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-1389"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-1390"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1391"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1392"></a>
<a name="ln-1393"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1394"></a>          <span class="c">! This subroutine resets the weekday for each month based on the current weekday</span>
<a name="ln-1395"></a>          <span class="c">! and previous weekdays per month.</span>
<a name="ln-1396"></a>
<a name="ln-1397"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1398"></a>          <span class="c">! NA</span>
<a name="ln-1399"></a>
<a name="ln-1400"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1401"></a>          <span class="c">! na</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1404"></a>          <span class="c">! na</span>
<a name="ln-1405"></a>
<a name="ln-1406"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1407"></a>
<a name="ln-1408"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1409"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Weekdays</span>
<a name="ln-1410"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LeapYearAdd</span>
<a name="ln-1411"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StartMonth</span>
<a name="ln-1412"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StartMonthDay</span>
<a name="ln-1413"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EndMonth</span>
<a name="ln-1414"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EndMonthDay</span>
<a name="ln-1415"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rollover</span>
<a name="ln-1416"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MidSimReset</span>
<a name="ln-1417"></a>
<a name="ln-1418"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1419"></a>          <span class="c">! na</span>
<a name="ln-1420"></a>
<a name="ln-1421"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1422"></a>          <span class="c">! na</span>
<a name="ln-1423"></a>
<a name="ln-1424"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1425"></a>          <span class="c">! na</span>
<a name="ln-1426"></a>
<a name="ln-1427"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1428"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WeekdaysCopy</span>
<a name="ln-1429"></a>  <span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-1430"></a>  <span class="kt">INTEGER </span><span class="n">CurWeekDay</span>
<a name="ln-1431"></a>  <span class="kt">LOGICAL </span><span class="n">ResetMidSimulation</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>  <span class="n">ResetMidSimulation</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1434"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MidSimReset</span><span class="p">))</span> <span class="n">ResetMidSimulation</span><span class="o">=</span><span class="n">MidSimReset</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a>
<a name="ln-1437"></a>  <span class="n">WeekdaysCopy</span><span class="o">=</span><span class="n">WeekDays</span>
<a name="ln-1438"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ResetMidSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1439"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Rollover</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1440"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">StartMonth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1441"></a><span class="k">        </span><span class="n">CurWeekDay</span><span class="o">=</span><span class="n">Weekdays</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">StartMonthDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1442"></a>      <span class="k">ELSE</span>
<a name="ln-1443"></a><span class="k">        </span><span class="n">CurWeekDay</span><span class="o">=</span><span class="n">WeekDays</span><span class="p">(</span><span class="n">EndMonth</span><span class="p">)</span><span class="o">+</span><span class="n">EndMonthDay</span>
<a name="ln-1444"></a>      <span class="n">ENDIF</span>
<a name="ln-1445"></a>    <span class="k">ELSE</span>  <span class="c">! restart at same as before</span>
<a name="ln-1446"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">Weekdays</span><span class="p">(</span><span class="n">StartMonth</span><span class="p">)</span>
<a name="ln-1447"></a>    <span class="n">ENDIF</span>
<a name="ln-1448"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1449"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1450"></a>    <span class="n">ENDDO</span>
<a name="ln-1451"></a>
<a name="ln-1452"></a>    <span class="n">Weekdays</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1453"></a>    <span class="n">Weekdays</span><span class="p">(</span><span class="n">StartMonth</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1454"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="n">StartMonth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-1455"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1456"></a>      <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1457"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1458"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1459"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1460"></a>        <span class="n">ENDDO</span>
<a name="ln-1461"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1462"></a>
<a name="ln-1463"></a>      <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1464"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1465"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1466"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1467"></a>        <span class="n">ENDDO</span>
<a name="ln-1468"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1469"></a>
<a name="ln-1470"></a>      <span class="k">CASE</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1471"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1472"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1473"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1474"></a>        <span class="n">ENDDO</span>
<a name="ln-1475"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1476"></a>      <span class="k">END SELECT</span>
<a name="ln-1477"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-1478"></a>
<a name="ln-1479"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">WeekDays</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1480"></a>      <span class="c">! need to start at StMon and go backwards.</span>
<a name="ln-1481"></a>      <span class="c">! EndDayOfMonth is also &quot;days&quot; in month.  (without leapyear day in February)</span>
<a name="ln-1482"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">WeekDays</span><span class="p">(</span><span class="n">StartMonth</span><span class="p">)</span>
<a name="ln-1483"></a>      <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">StartMonthDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1484"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1485"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">CurWeekDay</span><span class="o">=</span><span class="mi">7</span>
<a name="ln-1486"></a>      <span class="n">ENDDO</span>
<a name="ln-1487"></a>
<a name="ln-1488"></a>      <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="n">StartMonth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1489"></a>
<a name="ln-1490"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1491"></a>
<a name="ln-1492"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1493"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1494"></a>          <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1495"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1496"></a>          <span class="n">ENDDO</span>
<a name="ln-1497"></a>          <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1498"></a>
<a name="ln-1499"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1500"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1501"></a>          <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1502"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1503"></a>          <span class="n">ENDDO</span>
<a name="ln-1504"></a>          <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1507"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1508"></a>          <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1509"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1510"></a>          <span class="n">ENDDO</span>
<a name="ln-1511"></a>          <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1512"></a>        <span class="k">END SELECT</span>
<a name="ln-1513"></a>
<a name="ln-1514"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-1515"></a>
<a name="ln-1516"></a>    <span class="n">ENDIF</span>
<a name="ln-1517"></a>
<a name="ln-1518"></a>  <span class="k">ELSE</span>
<a name="ln-1519"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Rollover</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1520"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">StartMonth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1521"></a><span class="k">        </span><span class="n">CurWeekDay</span><span class="o">=</span><span class="n">Weekdays</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">StartMonthDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1522"></a>      <span class="k">ELSE</span>
<a name="ln-1523"></a><span class="k">        </span><span class="n">CurWeekDay</span><span class="o">=</span><span class="n">WeekDays</span><span class="p">(</span><span class="n">EndMonth</span><span class="p">)</span><span class="o">+</span><span class="n">EndMonthDay</span>
<a name="ln-1524"></a>      <span class="n">ENDIF</span>
<a name="ln-1525"></a>    <span class="k">ELSE</span>  <span class="c">! restart at same as before</span>
<a name="ln-1526"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">Weekdays</span><span class="p">(</span><span class="n">StartMonth</span><span class="p">)</span>
<a name="ln-1527"></a>    <span class="n">ENDIF</span>
<a name="ln-1528"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1529"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1530"></a>    <span class="n">ENDDO</span>
<a name="ln-1531"></a>    <span class="n">WeekDays</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1532"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">StartMonth</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1533"></a><span class="k">      </span><span class="n">CurWeekDay</span><span class="o">=</span><span class="n">WeekDaysCopy</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1534"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1535"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1536"></a>        <span class="n">ENDDO</span>
<a name="ln-1537"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1538"></a>      <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1539"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1540"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1541"></a>        <span class="n">ENDDO</span>
<a name="ln-1542"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1543"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1544"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1545"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1546"></a>        <span class="n">ENDDO</span>
<a name="ln-1547"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1548"></a>      <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-1549"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1550"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1551"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1552"></a>        <span class="n">ENDDO</span>
<a name="ln-1553"></a>        <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1554"></a>      <span class="n">ENDDO</span>
<a name="ln-1555"></a>    <span class="k">ELSE</span>
<a name="ln-1556"></a><span class="k">      </span><span class="n">Weekdays</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1557"></a>      <span class="n">Weekdays</span><span class="p">(</span><span class="n">StartMonth</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1558"></a>      <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="n">StartMonth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-1559"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1560"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1561"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1562"></a>          <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1563"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1564"></a>          <span class="n">ENDDO</span>
<a name="ln-1565"></a>          <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1566"></a>
<a name="ln-1567"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1568"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1569"></a>          <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1570"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1571"></a>          <span class="n">ENDDO</span>
<a name="ln-1572"></a>          <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1573"></a>
<a name="ln-1574"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1575"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1576"></a>          <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-1577"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-1578"></a>          <span class="n">ENDDO</span>
<a name="ln-1579"></a>          <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1580"></a>        <span class="k">END SELECT</span>
<a name="ln-1581"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-1582"></a>
<a name="ln-1583"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">WeekDays</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1584"></a>        <span class="c">! need to start at StMon and go backwards.</span>
<a name="ln-1585"></a>        <span class="c">! EndDayOfMonth is also &quot;days&quot; in month.  (without leapyear day in February)</span>
<a name="ln-1586"></a>        <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">WeekDays</span><span class="p">(</span><span class="n">StartMonth</span><span class="p">)</span>
<a name="ln-1587"></a>        <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">StartMonthDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1588"></a>          <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1589"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">CurWeekDay</span><span class="o">=</span><span class="mi">7</span>
<a name="ln-1590"></a>        <span class="n">ENDDO</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a>        <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="n">StartMonth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1595"></a>
<a name="ln-1596"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1597"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1598"></a>            <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1599"></a>              <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1600"></a>            <span class="n">ENDDO</span>
<a name="ln-1601"></a>            <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1604"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1605"></a>            <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1606"></a>              <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1607"></a>            <span class="n">ENDDO</span>
<a name="ln-1608"></a>            <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1609"></a>
<a name="ln-1610"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1611"></a>            <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">-</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-1612"></a>            <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">CurWeekDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1613"></a>              <span class="n">CurWeekDay</span><span class="o">=</span><span class="n">CurWeekDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1614"></a>            <span class="n">ENDDO</span>
<a name="ln-1615"></a>            <span class="n">WeekDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">CurWeekDay</span>
<a name="ln-1616"></a>          <span class="k">END SELECT</span>
<a name="ln-1617"></a>
<a name="ln-1618"></a><span class="k">        </span><span class="n">ENDDO</span>
<a name="ln-1619"></a>
<a name="ln-1620"></a>      <span class="n">ENDIF</span>
<a name="ln-1621"></a>    <span class="n">ENDIF</span>
<a name="ln-1622"></a>  <span class="n">ENDIF</span>
<a name="ln-1623"></a>
<a name="ln-1624"></a>  <span class="k">RETURN</span>
<a name="ln-1625"></a>
<a name="ln-1626"></a><span class="k">END SUBROUTINE </span><span class="n">ResetWeekDaysByMonth</span>
<a name="ln-1627"></a>
<a name="ln-1628"></a><span class="k">SUBROUTINE </span><span class="n">SetDSTDateRanges</span><span class="p">(</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">DSTIndex</span><span class="p">,</span><span class="n">DSTActStMon</span><span class="p">,</span><span class="n">DSTActStDay</span><span class="p">,</span><span class="n">DSTActEnMon</span><span class="p">,</span><span class="n">DSTActEnDay</span><span class="p">)</span>
<a name="ln-1629"></a>
<a name="ln-1630"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1631"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-1632"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-1633"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1634"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1635"></a>
<a name="ln-1636"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1637"></a>          <span class="c">! With multiple year weather files (or repeating weather files that rollover day),</span>
<a name="ln-1638"></a>          <span class="c">! need to set DST (Daylight Saving Time) dates at start of environment or year.</span>
<a name="ln-1639"></a>          <span class="c">! DST is only projected for one year.</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1642"></a>          <span class="c">! na</span>
<a name="ln-1643"></a>
<a name="ln-1644"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1645"></a>          <span class="c">! na</span>
<a name="ln-1646"></a>
<a name="ln-1647"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1648"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span>
<a name="ln-1649"></a>
<a name="ln-1650"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1651"></a>
<a name="ln-1652"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1653"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MonWeekDay</span>  <span class="c">! Weekday of each day 1 of month</span>
<a name="ln-1654"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DSTIndex</span>    <span class="c">! DST Index for each julian day (1:366)</span>
<a name="ln-1655"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">DSTActStMon</span>
<a name="ln-1656"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">DSTActStDay</span>
<a name="ln-1657"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">DSTActEnMon</span>
<a name="ln-1658"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">DSTActEnDay</span>
<a name="ln-1659"></a>
<a name="ln-1660"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1661"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SetDSTDateRanges: &#39;</span>
<a name="ln-1662"></a>
<a name="ln-1663"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1664"></a>          <span class="c">! na</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1667"></a>          <span class="c">! na</span>
<a name="ln-1668"></a>
<a name="ln-1669"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1670"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ActStartMonth</span>  <span class="c">! Actual Start Month</span>
<a name="ln-1671"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ActStartDay</span>    <span class="c">! Actual Start Day of Month</span>
<a name="ln-1672"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ActEndMonth</span>    <span class="c">! Actual End Month</span>
<a name="ln-1673"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ActEndDay</span>      <span class="c">! Actual End Day of Month</span>
<a name="ln-1674"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisDay</span>        <span class="c">! Day of Month</span>
<a name="ln-1675"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay</span>
<a name="ln-1676"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay1</span>
<a name="ln-1677"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-1678"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ActEndDayOfMonth</span>
<a name="ln-1679"></a>
<a name="ln-1680"></a>  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1681"></a>  <span class="n">ActEndDayOfMonth</span><span class="o">=</span><span class="n">EndDayOfMonth</span>
<a name="ln-1682"></a>  <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1683"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">StDateType</span> <span class="o">==</span> <span class="n">MonthDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1684"></a><span class="k">    </span><span class="n">ActStartMonth</span> <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">StMon</span>
<a name="ln-1685"></a>    <span class="n">ActStartDay</span>   <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">StDay</span>
<a name="ln-1686"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">StDateType</span> <span class="o">==</span> <span class="n">NthDayInMonth</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1687"></a><span class="k">    </span><span class="n">ThisDay</span><span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">StWeekday</span><span class="o">-</span><span class="n">MonWeekDay</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">StMon</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1688"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">ThisDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1689"></a>      <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1690"></a>    <span class="n">ENDDO</span>
<a name="ln-1691"></a>    <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">StDay</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1692"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisDay</span> <span class="o">&gt;</span> <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">StMon</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1693"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Determining DST: DST Start Date, Nth Day of Month, not enough Nths&#39;</span><span class="p">)</span>
<a name="ln-1694"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1695"></a>    <span class="k">ELSE</span>
<a name="ln-1696"></a><span class="k">      </span><span class="n">ActStartMonth</span> <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">StMon</span>
<a name="ln-1697"></a>      <span class="n">ActStartDay</span>   <span class="o">=</span><span class="n">ThisDay</span>
<a name="ln-1698"></a>    <span class="n">ENDIF</span>
<a name="ln-1699"></a>  <span class="k">ELSE</span> <span class="c">! LastWeekDayInMonth</span>
<a name="ln-1700"></a>    <span class="n">ThisDay</span><span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">StWeekday</span><span class="o">-</span><span class="n">MonWeekDay</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">StMon</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1701"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span> <span class="o">&lt;=</span> <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">StMon</span><span class="p">))</span>
<a name="ln-1702"></a>      <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1703"></a>    <span class="n">ENDDO</span>
<a name="ln-1704"></a>    <span class="n">ActStartMonth</span> <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">StMon</span>
<a name="ln-1705"></a>    <span class="n">ActStartDay</span>   <span class="o">=</span><span class="n">ThisDay</span>
<a name="ln-1706"></a>  <span class="n">ENDIF</span>
<a name="ln-1707"></a>
<a name="ln-1708"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">EnDateType</span> <span class="o">==</span> <span class="n">MonthDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1709"></a><span class="k">    </span><span class="n">ActEndMonth</span> <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">EnMon</span>
<a name="ln-1710"></a>    <span class="n">ActEndDay</span>   <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">EnDay</span>
<a name="ln-1711"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">EnDateType</span> <span class="o">==</span> <span class="n">NthDayInMonth</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1712"></a><span class="k">    </span><span class="n">ThisDay</span><span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">EnWeekday</span><span class="o">-</span><span class="n">MonWeekDay</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">EnMon</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1713"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">ThisDay</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1714"></a>      <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1715"></a>    <span class="n">ENDDO</span>
<a name="ln-1716"></a>    <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">EnDay</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1717"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisDay</span> <span class="o">&gt;</span> <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">EnMon</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1718"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Determining DST: DST End Date, Nth Day of Month, not enough Nths&#39;</span><span class="p">)</span>
<a name="ln-1719"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1720"></a>    <span class="k">ELSE</span>
<a name="ln-1721"></a><span class="k">      </span><span class="n">ActEndMonth</span> <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">EnMon</span>
<a name="ln-1722"></a>      <span class="n">ActEndDay</span>   <span class="o">=</span><span class="n">ThisDay</span>
<a name="ln-1723"></a>    <span class="n">ENDIF</span>
<a name="ln-1724"></a>  <span class="k">ELSE</span> <span class="c">! LastWeekDayInMonth</span>
<a name="ln-1725"></a>    <span class="n">ThisDay</span><span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">EnWeekday</span><span class="o">-</span><span class="n">MonWeekDay</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">EnMon</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1726"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span> <span class="o">&lt;=</span> <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="n">DST</span><span class="p">%</span><span class="n">EnMon</span><span class="p">))</span>
<a name="ln-1727"></a>      <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1728"></a>    <span class="n">ENDDO</span>
<a name="ln-1729"></a>    <span class="n">ActEndMonth</span> <span class="o">=</span><span class="n">DST</span><span class="p">%</span><span class="n">EnMon</span>
<a name="ln-1730"></a>    <span class="n">ActEndDay</span>   <span class="o">=</span><span class="n">ThisDay</span>
<a name="ln-1731"></a>  <span class="n">ENDIF</span>
<a name="ln-1732"></a>
<a name="ln-1733"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1734"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Program terminates due to preceding condition(s).&#39;</span><span class="p">)</span>
<a name="ln-1735"></a>  <span class="n">ENDIF</span>
<a name="ln-1736"></a>
<a name="ln-1737"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">DSTActStMon</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1738"></a><span class="k">    </span><span class="n">DSTActStMon</span><span class="o">=</span><span class="n">ActStartMonth</span>
<a name="ln-1739"></a>    <span class="n">DSTActStDay</span><span class="o">=</span><span class="n">ActStartDay</span>
<a name="ln-1740"></a>    <span class="n">DSTActEnMon</span><span class="o">=</span><span class="n">ActEndMonth</span>
<a name="ln-1741"></a>    <span class="n">DSTActEnDay</span><span class="o">=</span><span class="n">ActEndDay</span>
<a name="ln-1742"></a>  <span class="n">ENDIF</span>
<a name="ln-1743"></a>
<a name="ln-1744"></a>  <span class="n">DSTIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1745"></a>  <span class="n">JDay</span> <span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">ActStartMonth</span><span class="p">,</span><span class="n">ActStartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1746"></a>  <span class="n">JDay1</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">ActEndMonth</span><span class="p">,</span><span class="n">ActEndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1747"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">JDay1</span> <span class="o">&gt;=</span> <span class="n">JDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1748"></a><span class="k">    </span><span class="n">DSTIndex</span><span class="p">(</span><span class="n">JDay</span><span class="p">:</span><span class="n">JDay1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1749"></a>  <span class="k">ELSE</span>
<a name="ln-1750"></a><span class="k">    </span><span class="n">DSTIndex</span><span class="p">(</span><span class="n">JDay</span><span class="p">:</span><span class="mi">366</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1751"></a>    <span class="n">DSTIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">JDay1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1752"></a>  <span class="n">ENDIF</span>
<a name="ln-1753"></a>
<a name="ln-1754"></a>  <span class="k">RETURN</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a><span class="k">END SUBROUTINE </span><span class="n">SetDSTDateRanges</span>
<a name="ln-1757"></a>
<a name="ln-1758"></a><span class="k">SUBROUTINE </span><span class="n">SetSpecialDayDates</span><span class="p">(</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-1759"></a>
<a name="ln-1760"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1761"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-1762"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-1763"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1764"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1765"></a>
<a name="ln-1766"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1767"></a>          <span class="c">! With multiple year weather files (or repeating weather files that rollover day),</span>
<a name="ln-1768"></a>          <span class="c">! need to set Special Day dates at start of environment or year.</span>
<a name="ln-1769"></a>          <span class="c">! Special Days are only projected for one year.</span>
<a name="ln-1770"></a>
<a name="ln-1771"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1772"></a>          <span class="c">! na</span>
<a name="ln-1773"></a>
<a name="ln-1774"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1775"></a>          <span class="c">! na</span>
<a name="ln-1776"></a>
<a name="ln-1777"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1778"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InvJulianDay</span><span class="p">,</span><span class="n">JulianDay</span>
<a name="ln-1779"></a>
<a name="ln-1780"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1781"></a>
<a name="ln-1782"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1783"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MonWeekDay</span>  <span class="c">! Weekday of each day 1 of month</span>
<a name="ln-1784"></a>
<a name="ln-1785"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1786"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SetSpecialDayDates: &#39;</span>
<a name="ln-1787"></a>
<a name="ln-1788"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1789"></a>          <span class="c">! na</span>
<a name="ln-1790"></a>
<a name="ln-1791"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1792"></a>          <span class="c">! na</span>
<a name="ln-1793"></a>
<a name="ln-1794"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1795"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-1796"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisDay</span>
<a name="ln-1797"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay</span>
<a name="ln-1798"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay1</span>
<a name="ln-1799"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop1</span>
<a name="ln-1800"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-1801"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ActEndDayOfMonth</span>
<a name="ln-1802"></a>
<a name="ln-1803"></a>  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1804"></a>  <span class="n">ActEndDayOfMonth</span><span class="o">=</span><span class="n">EndDayOfMonth</span>
<a name="ln-1805"></a>  <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">LeapYearAdd</span>
<a name="ln-1806"></a>  <span class="n">SpecialDayTypes</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1807"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumSpecialDays</span>
<a name="ln-1808"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WthrFile</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">UseSpecialDays</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1809"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DateType</span> <span class="o">&lt;=</span> <span class="n">MonthDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1810"></a><span class="k">      </span><span class="n">JDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Day</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1811"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Duration</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1812"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WeekDayTypes</span><span class="p">(</span><span class="n">JDay</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1813"></a>          <span class="c">! Sunday, must go to Monday</span>
<a name="ln-1814"></a>          <span class="n">JDay</span><span class="o">=</span><span class="n">JDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1815"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">JDay</span> <span class="o">==</span> <span class="mi">366</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">LeapYearAdd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">JDay</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1816"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WeekDayTypes</span><span class="p">(</span><span class="n">JDay</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1817"></a><span class="k">          </span><span class="n">JDay</span><span class="o">=</span><span class="n">JDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1818"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">JDay</span> <span class="o">==</span> <span class="mi">366</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">LeapYearAdd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">JDay</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1819"></a>          <span class="n">JDay</span><span class="o">=</span><span class="n">JDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1820"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">JDay</span> <span class="o">==</span> <span class="mi">366</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">LeapYearAdd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">JDay</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1821"></a>        <span class="n">ENDIF</span>
<a name="ln-1822"></a>      <span class="n">ENDIF</span>
<a name="ln-1823"></a>      <span class="k">CALL </span><span class="n">InvJulianDay</span><span class="p">(</span><span class="n">JDay</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStMon</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1824"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DateType</span> <span class="o">==</span> <span class="n">NthDayInMonth</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1825"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WeekDay</span> <span class="o">&gt;=</span> <span class="n">MonWeekDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1826"></a><span class="k">        </span><span class="n">ThisDay</span><span class="o">=</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Weekday</span><span class="o">-</span><span class="n">MonWeekDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1827"></a>      <span class="k">ELSE</span>
<a name="ln-1828"></a><span class="k">        </span><span class="n">ThisDay</span><span class="o">=</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Weekday</span><span class="o">-</span><span class="n">MonWeekDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1829"></a>      <span class="n">ENDIF</span>
<a name="ln-1830"></a>      <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Day</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1831"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ThisDay</span> <span class="o">&gt;</span> <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1832"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Special Day Date, Nth Day of Month, not enough Nths, for SpecialDay=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1833"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1834"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1835"></a>        <span class="k">CYCLE</span>
<a name="ln-1836"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1837"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStMon</span><span class="o">=</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span>
<a name="ln-1838"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStDay</span><span class="o">=</span><span class="n">ThisDay</span>
<a name="ln-1839"></a>      <span class="n">JDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">,</span><span class="n">ThisDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1840"></a>    <span class="k">ELSE</span> <span class="c">! LastWeekDayInMonth</span>
<a name="ln-1841"></a>      <span class="n">ThisDay</span><span class="o">=</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Weekday</span><span class="o">-</span><span class="n">MonWeekDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1842"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span> <span class="o">&lt;=</span> <span class="n">ActEndDayOfMonth</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">))</span>
<a name="ln-1843"></a>        <span class="n">ThisDay</span><span class="o">=</span><span class="n">ThisDay</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-1844"></a>      <span class="n">ENDDO</span>
<a name="ln-1845"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStMon</span><span class="o">=</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span>
<a name="ln-1846"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActStDay</span><span class="o">=</span><span class="n">ThisDay</span>
<a name="ln-1847"></a>      <span class="n">JDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">,</span><span class="n">ThisDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-1848"></a>    <span class="n">ENDIF</span>
<a name="ln-1849"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SpecialDayTypes</span><span class="p">(</span><span class="n">JDay</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1850"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Special Day definition (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1851"></a>                                  <span class="s1">&#39;) is overwriting previously entered special day period&#39;</span><span class="p">)</span>
<a name="ln-1852"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">UseSpecialDays</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1853"></a><span class="k">         CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...This could be caused by definitions on the Weather File.&#39;</span><span class="p">)</span>
<a name="ln-1854"></a>       <span class="n">ENDIF</span>
<a name="ln-1855"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...This could be caused by duplicate definitions in the Input File.&#39;</span><span class="p">)</span>
<a name="ln-1856"></a>    <span class="n">ENDIF</span>
<a name="ln-1857"></a>    <span class="n">JDay1</span><span class="o">=</span><span class="n">JDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1858"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Duration</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1859"></a>      <span class="n">JDay1</span><span class="o">=</span><span class="n">JDay1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1860"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">JDay1</span> <span class="o">==</span> <span class="mi">366</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">LeapYearAdd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">JDay1</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1861"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">JDay1</span> <span class="o">==</span> <span class="mi">367</span><span class="p">)</span> <span class="n">JDay1</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1862"></a>      <span class="n">SpecialDayTypes</span><span class="p">(</span><span class="n">JDay1</span><span class="p">)</span><span class="o">=</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayType</span>
<a name="ln-1863"></a>    <span class="n">ENDDO</span>
<a name="ln-1864"></a>  <span class="n">ENDDO</span>
<a name="ln-1865"></a>
<a name="ln-1866"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1867"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Program terminates due to preceding condition(s).&#39;</span><span class="p">)</span>
<a name="ln-1868"></a>  <span class="n">ENDIF</span>
<a name="ln-1869"></a>
<a name="ln-1870"></a>  <span class="k">RETURN</span>
<a name="ln-1871"></a>
<a name="ln-1872"></a><span class="k">END SUBROUTINE </span><span class="n">SetSpecialDayDates</span>
<a name="ln-1873"></a>
<a name="ln-1874"></a><span class="k">SUBROUTINE </span><span class="n">InitializeWeather</span><span class="p">(</span><span class="n">PrintEnvrnStamp</span><span class="p">)</span>
<a name="ln-1875"></a>
<a name="ln-1876"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1877"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-1878"></a>          <span class="c">!       DATE WRITTEN   June 1997</span>
<a name="ln-1879"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1880"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1881"></a>
<a name="ln-1882"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1883"></a>          <span class="c">! This subroutine is the main driver of the weather initializations.</span>
<a name="ln-1884"></a>          <span class="c">! Most of the weather handling can be described as &quot;initializations&quot;</span>
<a name="ln-1885"></a>          <span class="c">! so most of the work is done via this subroutine.</span>
<a name="ln-1886"></a>
<a name="ln-1887"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1888"></a>          <span class="c">! na</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1891"></a>          <span class="c">! na</span>
<a name="ln-1892"></a>
<a name="ln-1893"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1894"></a>          <span class="c">! na</span>
<a name="ln-1895"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InvJulianDay</span><span class="p">,</span> <span class="n">JulianDay</span>
<a name="ln-1896"></a>
<a name="ln-1897"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1898"></a>
<a name="ln-1899"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1900"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PrintEnvrnStamp</span>   <span class="c">! Set to true when the environment header should be printed</span>
<a name="ln-1901"></a>
<a name="ln-1902"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1903"></a>          <span class="c">! na</span>
<a name="ln-1904"></a>
<a name="ln-1905"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1906"></a>          <span class="c">! na</span>
<a name="ln-1907"></a>
<a name="ln-1908"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1909"></a>          <span class="c">! na</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1912"></a>  <span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-1913"></a>  <span class="kt">INTEGER </span><span class="n">FirstSimDayofYear</span>          <span class="c">! Variable which tells when to skip the day in a multi year simulation.</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">FirstCall</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! Some things should only be done once</span>
<a name="ln-1916"></a><span class="c">!  LOGICAL, SAVE :: SetYear=.true.</span>
<a name="ln-1917"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay5Start</span>
<a name="ln-1918"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay5End</span>
<a name="ln-1919"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TWeekDay</span>
<a name="ln-1920"></a>
<a name="ln-1921"></a>          <span class="c">! FLOW:</span>
<a name="ln-1922"></a>
<a name="ln-1923"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginSimFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">FirstCall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1924"></a>
<a name="ln-1925"></a><span class="k">    </span><span class="n">FirstCall</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1926"></a>    <span class="n">EndMonthFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1927"></a>
<a name="ln-1928"></a>  <span class="k">END IF</span>    <span class="c">! ... end of BeginSimFlag IF-THEN block.</span>
<a name="ln-1929"></a>
<a name="ln-1930"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1931"></a>
<a name="ln-1932"></a>    <span class="c">!Call and setup the Design Day environment</span>
<a name="ln-1933"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">/=</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1934"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Envrn</span> <span class="o">&lt;=</span> <span class="n">TotDesDays</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1935"></a><span class="k">        Call </span><span class="n">SetupDesignDay</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span>
<a name="ln-1936"></a>      <span class="n">ENDIF</span>
<a name="ln-1937"></a>    <span class="n">ENDIF</span>
<a name="ln-1938"></a>
<a name="ln-1939"></a>    <span class="n">NumMissing</span><span class="o">=</span><span class="mi">0</span>   <span class="c">! Only used in Weather file environments</span>
<a name="ln-1940"></a>                   <span class="c">! Start over missing values with each environment</span>
<a name="ln-1941"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">StnPres</span>      <span class="o">=</span> <span class="n">StdBaroPress</span>  <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1942"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">DryBulb</span>      <span class="o">=</span> <span class="mf">6.d0</span>       <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1943"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">DewPoint</span>     <span class="o">=</span> <span class="mf">3.d0</span>       <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1944"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">RelHumid</span>     <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0d0</span>       <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1945"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">WindSpd</span>      <span class="o">=</span> <span class="mf">2.5d0</span>      <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1946"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">WindDir</span>      <span class="o">=</span> <span class="mi">180</span>        <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1947"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">TotSkyCvr</span>    <span class="o">=</span> <span class="mi">5</span>          <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1948"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">OpaqSkyCvr</span>   <span class="o">=</span> <span class="mi">5</span>          <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1949"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">Visibility</span>   <span class="o">=</span> <span class="mi">77</span><span class="mf">7.7d0</span>    <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1950"></a>    <span class="n">Missing</span><span class="p">%</span><span class="nb">Ceiling</span>      <span class="o">=</span> <span class="mi">77777</span>      <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1951"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">PrecipWater</span>  <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1952"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">AerOptDepth</span>  <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1953"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">SnowDepth</span>    <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1954"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">DaysLastSnow</span> <span class="o">=</span> <span class="mi">88</span>         <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1955"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">Albedo</span>       <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1956"></a>    <span class="n">Missing</span><span class="p">%</span><span class="n">LiquidPrecip</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Initial &quot;missing&quot; value</span>
<a name="ln-1957"></a>                                    <span class="c">! Counts set to 0 for each environment</span>
<a name="ln-1958"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">StnPres</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1959"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">DryBulb</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1960"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">DewPoint</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1961"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">RelHumid</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1962"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">WindSpd</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1963"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">WindDir</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1964"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">TotSkyCvr</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1965"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">OpaqSkyCvr</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1966"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">Visibility</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1967"></a>    <span class="n">Missed</span><span class="p">%</span><span class="nb">Ceiling</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1968"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">PrecipWater</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1969"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">AerOptDepth</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1970"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">SnowDepth</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1971"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">DaysLastSnow</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1972"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">Albedo</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1973"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">LiquidPrecip</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1974"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">WeathCodes</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1975"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">DirectRad</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1976"></a>    <span class="n">Missed</span><span class="p">%</span><span class="n">DiffuseRad</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1977"></a>                                    <span class="c">! Counts set to 0 for each environment</span>
<a name="ln-1978"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">StnPres</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1979"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">DryBulb</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1980"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">DewPoint</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1981"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">RelHumid</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1982"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindSpd</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1983"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindDir</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1984"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">DirectRad</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1985"></a>    <span class="n">OutOfRange</span><span class="p">%</span><span class="n">DiffuseRad</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1986"></a>
<a name="ln-1987"></a>
<a name="ln-1988"></a>    <span class="n">PrintEnvrnStamp</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Set this to true so that on first non-warmup day (only) the environment header will print out</span>
<a name="ln-1989"></a>
<a name="ln-1990"></a><span class="c">!    WeekDayCount=0  ! Reset weekday count (weather periods only)</span>
<a name="ln-1991"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumSpecialDays</span>
<a name="ln-1992"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Used</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1993"></a>    <span class="n">ENDDO</span>
<a name="ln-1994"></a>
<a name="ln-1995"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">/=</span> <span class="n">ksDesignDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1996"></a><span class="k">      CALL </span><span class="n">ReadWeatherForDay</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Envrn</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>     <span class="c">! Read first day&#39;s weather</span>
<a name="ln-1997"></a>    <span class="k">ELSE</span>
<a name="ln-1998"></a><span class="k">      </span><span class="n">TomorrowVariables</span> <span class="o">=</span> <span class="n">DesignDay</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span>
<a name="ln-1999"></a>    <span class="k">END IF</span>
<a name="ln-2000"></a>
<a name="ln-2001"></a><span class="k">  END IF</span>    <span class="c">! ... end of BeginEnvrnFlag IF-THEN block.</span>
<a name="ln-2002"></a>
<a name="ln-2003"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginDayFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2004"></a>
<a name="ln-2005"></a>    <span class="c">! Check Holidays, Daylight Saving Time, Ground Temperatures, etc.</span>
<a name="ln-2006"></a>
<a name="ln-2007"></a>    <span class="k">CALL </span><span class="n">UpdateWeatherData</span>  <span class="c">! Update daily weather info</span>
<a name="ln-2008"></a>
<a name="ln-2009"></a>          <span class="c">! Read tomorrow&#39;s weather only if necessary.  This means that the</span>
<a name="ln-2010"></a>          <span class="c">! simulation is out of warmup, is using a weather tape for this</span>
<a name="ln-2011"></a>          <span class="c">! environment, and is not on the last day (day after last day is</span>
<a name="ln-2012"></a>          <span class="c">! assumed to be equal to last day).</span>
<a name="ln-2013"></a>
<a name="ln-2014"></a><span class="c">! Following code checks whether the present day of simulation matches the start month and start day.</span>
<a name="ln-2015"></a><span class="c">! In a multi year simulation with run period less than 365, we need to position the weather line</span>
<a name="ln-2016"></a><span class="c">! appropriately.</span>
<a name="ln-2017"></a>
<a name="ln-2018"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">WarmupFlag</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">/=</span> <span class="n">ksDesignDay</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2019"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DayOfSim</span> <span class="o">&lt;</span> <span class="n">NumOfDayInEnvrn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2020"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DayOfSim</span> <span class="o">==</span> <span class="n">curSimDayforEndofRunPeriod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2021"></a><span class="k">          </span><span class="n">curSimDayforEndofRunPeriod</span><span class="o">=</span><span class="n">curSimDayforEndofRunPeriod</span><span class="o">+</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RawSimDays</span>
<a name="ln-2022"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">StartDatesCycleShouldBeReset</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2023"></a><span class="k">            CALL </span><span class="n">ResetWeekDaysByMonth</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2024"></a>                 <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2025"></a>                 <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="p">)</span>
<a name="ln-2026"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DaylightSavingIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2027"></a><span class="k">              CALL </span><span class="n">SetDSTDateRanges</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">DSTIndex</span><span class="p">)</span>
<a name="ln-2028"></a>            <span class="n">ENDIF</span>
<a name="ln-2029"></a>            <span class="k">CALL </span><span class="n">SetSpecialDayDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-2030"></a>          <span class="n">ENDIF</span>
<a name="ln-2031"></a>          <span class="n">YearofSim</span> <span class="o">=</span> <span class="n">YearofSim</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2032"></a>          <span class="n">FirstSimDayofYear</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2033"></a>          <span class="k">CALL </span><span class="n">ReadWeatherForDay</span><span class="p">(</span><span class="n">FirstSimDayofYear</span><span class="p">,</span><span class="n">Envrn</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>  <span class="c">! Read tomorrow&#39;s weather</span>
<a name="ln-2034"></a>        <span class="k">ELSE</span>
<a name="ln-2035"></a><span class="k">          CALL </span><span class="n">ReadWeatherForDay</span><span class="p">(</span><span class="n">DayOfSim</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">Envrn</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>  <span class="c">! Read tomorrow&#39;s weather</span>
<a name="ln-2036"></a>        <span class="n">ENDIF</span>
<a name="ln-2037"></a>      <span class="k">END IF</span>
<a name="ln-2038"></a><span class="k">    END IF</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>
<a name="ln-2041"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DayOfMonth</span> <span class="o">==</span> <span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">Month</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2042"></a><span class="k">      </span><span class="n">EndMonthFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2043"></a>    <span class="n">ENDIF</span>
<a name="ln-2044"></a>
<a name="ln-2045"></a>    <span class="c">! Set Tomorrow&#39;s date data</span>
<a name="ln-2046"></a>    <span class="n">MonthTomorrow</span><span class="o">=</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">Month</span>
<a name="ln-2047"></a>    <span class="n">DayOfMonthTomorrow</span><span class="o">=</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfMonth</span>
<a name="ln-2048"></a>    <span class="n">DayOfWeekTomorrow</span><span class="o">=</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfWeek</span>
<a name="ln-2049"></a>    <span class="n">HolidayIndexTomorrow</span><span class="o">=</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">HolidayIndex</span>
<a name="ln-2050"></a>    <span class="n">YearTomorrow</span><span class="o">=</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">Year</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2053"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Month</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DayOfMonth</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2054"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DatesShouldBeReset</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2055"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2056"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2057"></a>            <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span><span class="o">=</span><span class="n">IsLeapYear</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="p">)</span>
<a name="ln-2058"></a>            <span class="n">CurrentYearIsLeapYear</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span>
<a name="ln-2059"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CurrentYearIsLeapYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2060"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2061"></a><span class="k">                </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2062"></a>              <span class="k">ELSE</span>
<a name="ln-2063"></a><span class="k">                </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2064"></a>              <span class="n">ENDIF</span>
<a name="ln-2065"></a>            <span class="k">ELSE</span>
<a name="ln-2066"></a><span class="k">              </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2067"></a>            <span class="n">ENDIF</span>
<a name="ln-2068"></a><span class="c">! need to reset MonWeekDay and WeekDayTypes</span>
<a name="ln-2069"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CurrentYearIsLeapYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2070"></a><span class="k">              </span><span class="n">JDay5Start</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2071"></a>              <span class="n">JDay5End</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-2072"></a>            <span class="k">ELSE</span>
<a name="ln-2073"></a><span class="k">              </span><span class="n">JDay5Start</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-2074"></a>              <span class="n">JDay5End</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-2075"></a>            <span class="n">ENDIF</span>
<a name="ln-2076"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2077"></a>               <span class="n">curSimDayforEndofRunPeriod</span><span class="o">=</span><span class="n">DayOfSim</span><span class="o">+</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RawSimDays</span><span class="o">+</span><span class="n">LeapYearAdd</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2078"></a>
<a name="ln-2079"></a>            <span class="n">Loop</span><span class="o">=</span><span class="n">JDay5Start</span>
<a name="ln-2080"></a>            <span class="n">TWeekDay</span><span class="o">=</span><span class="n">DayOfWeek</span>
<a name="ln-2081"></a>            <span class="k">DO</span>
<a name="ln-2082"></a><span class="k">              </span><span class="n">WeekDayTypes</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span><span class="o">=</span><span class="n">TWeekDay</span>
<a name="ln-2083"></a>              <span class="n">TWeekDay</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="n">TWeekDay</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2084"></a>              <span class="n">Loop</span><span class="o">=</span><span class="n">Loop</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2085"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Loop</span> <span class="o">&gt;</span> <span class="mi">366</span><span class="p">)</span> <span class="n">Loop</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2086"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Loop</span> <span class="o">==</span> <span class="n">JDay5End</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-2087"></a><span class="k">            </span><span class="n">ENDDO</span>
<a name="ln-2088"></a>            <span class="k">CALL </span><span class="n">ResetWeekDaysByMonth</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2089"></a>                 <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2090"></a>                 <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="p">)</span>
<a name="ln-2091"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DaylightSavingIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2092"></a><span class="k">              CALL </span><span class="n">SetDSTDateRanges</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">DSTIndex</span><span class="p">)</span>
<a name="ln-2093"></a>            <span class="n">ENDIF</span>
<a name="ln-2094"></a>            <span class="k">CALL </span><span class="n">SetSpecialDayDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-2095"></a>          <span class="n">ENDIF</span>
<a name="ln-2096"></a>        <span class="n">ENDIF</span>
<a name="ln-2097"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Month</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DayOfMonth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="n">DatesShouldBeReset</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2098"></a>              <span class="p">(</span><span class="n">Jan1DatesShouldBeReset</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2099"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2100"></a><span class="k">          </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2101"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span><span class="o">=</span><span class="n">IsLeapYear</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="p">)</span>
<a name="ln-2102"></a>          <span class="n">CurrentYearIsLeapYear</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span>
<a name="ln-2103"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurrentYearIsLeapYear</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="n">CurrentYearIsLeapYear</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2104"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DayOfSim</span> <span class="o">&lt;</span> <span class="n">curSimDayForEndOfRunPeriod</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">CurrentYearIsLeapYear</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-2105"></a>             <span class="n">curSimDayforEndofRunPeriod</span><span class="o">=</span><span class="n">curSimDayforEndofRunPeriod</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2106"></a>        <span class="n">ENDIF</span>
<a name="ln-2107"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurrentYearIsLeapYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2108"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2109"></a><span class="k">            </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2110"></a>          <span class="k">ELSE</span>
<a name="ln-2111"></a><span class="k">            </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2112"></a>          <span class="n">ENDIF</span>
<a name="ln-2113"></a>        <span class="k">ELSE</span>
<a name="ln-2114"></a><span class="k">          </span><span class="n">LeapYearAdd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2115"></a>        <span class="n">ENDIF</span>
<a name="ln-2116"></a>
<a name="ln-2117"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DayOfSim</span> <span class="o">&lt;</span> <span class="n">curSimDayForEndOfRunPeriod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2118"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CurrentYearIsLeapYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2119"></a><span class="k">            CALL </span><span class="n">ResetWeekDaysByMonth</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2120"></a>               <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2121"></a>               <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-2122"></a>          <span class="k">ELSE</span>
<a name="ln-2123"></a><span class="k">            CALL </span><span class="n">ResetWeekDaysByMonth</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2124"></a>               <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2125"></a>               <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="p">,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-2126"></a>          <span class="n">ENDIF</span>
<a name="ln-2127"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DaylightSavingIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2128"></a><span class="k">            CALL </span><span class="n">SetDSTDateRanges</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">DSTIndex</span><span class="p">)</span>
<a name="ln-2129"></a>          <span class="n">ENDIF</span>
<a name="ln-2130"></a>          <span class="k">CALL </span><span class="n">SetSpecialDayDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-2131"></a>        <span class="n">ENDIF</span>
<a name="ln-2132"></a>      <span class="n">ENDIF</span>
<a name="ln-2133"></a><span class="c">!      SetYear=.false.</span>
<a name="ln-2134"></a>    <span class="n">ENDIF</span>
<a name="ln-2135"></a>  <span class="k">END IF</span>    <span class="c">! ... end of BeginDayFlag IF-THEN block.</span>
<a name="ln-2136"></a>
<a name="ln-2137"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginDayFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2138"></a>      <span class="p">(</span><span class="n">Month</span> <span class="o">/=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DayOfMonth</span> <span class="o">/=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-2139"></a>       <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DatesShouldBeReset</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2140"></a>       <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2141"></a><span class="c">!    SetYear=.true.</span>
<a name="ln-2142"></a>    <span class="n">DatesShouldBeReset</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2143"></a>  <span class="n">ENDIF</span>
<a name="ln-2144"></a>
<a name="ln-2145"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EndEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">/=</span> <span class="n">ksDesignDay</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2146"></a><span class="k">    REWIND</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">)</span>
<a name="ln-2147"></a>    <span class="k">CALL </span><span class="n">SkipEPlusWFHeader</span>
<a name="ln-2148"></a>    <span class="k">CALL </span><span class="n">ReportMissing_RangeData</span>
<a name="ln-2149"></a>  <span class="n">ENDIF</span>
<a name="ln-2150"></a>
<a name="ln-2151"></a>  <span class="c">! set the EndDesignDayEnvrnsFlag (dataGlobals)</span>
<a name="ln-2152"></a>  <span class="c">! True at the end of the last design day environment (last time step of last hour of last day of environ which is a design day)</span>
<a name="ln-2153"></a>  <span class="c">! added to address CR7562</span>
<a name="ln-2154"></a>  <span class="n">EndDesignDayEnvrnsFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2155"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EndEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2156"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Envrn</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">NumOfEnvrn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2157"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">environment</span><span class="p">(</span><span class="n">Envrn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)%</span><span class="n">KindOfEnvrn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2158"></a><span class="k">        </span><span class="n">EndDesignDayEnvrnsFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2159"></a>      <span class="k">END IF</span>
<a name="ln-2160"></a><span class="k">    ELSE</span>
<a name="ln-2161"></a>      <span class="c">! if the last environment set the flag to true.</span>
<a name="ln-2162"></a>      <span class="n">EndDesignDayEnvrnsFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2163"></a>    <span class="k">END IF</span>
<a name="ln-2164"></a><span class="k">  END IF</span>
<a name="ln-2165"></a>
<a name="ln-2166"></a><span class="k">  RETURN</span>
<a name="ln-2167"></a>
<a name="ln-2168"></a><span class="k">END SUBROUTINE </span><span class="n">InitializeWeather</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a><span class="k">SUBROUTINE </span><span class="n">UpdateWeatherData</span>
<a name="ln-2171"></a>
<a name="ln-2172"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2173"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-2174"></a>          <span class="c">!       DATE WRITTEN   June 1997</span>
<a name="ln-2175"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2176"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2177"></a>
<a name="ln-2178"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2179"></a>          <span class="c">! This subroutine updates all of the daily weather data in the local</span>
<a name="ln-2180"></a>          <span class="c">! module level variables and the global variables.</span>
<a name="ln-2181"></a>          <span class="c">! This subroutine will temporarily transfer the weather data for the</span>
<a name="ln-2182"></a>          <span class="c">! current day to the old data structure contained in envdat.inc until</span>
<a name="ln-2183"></a>          <span class="c">! enough reengineering has taken place to eliminate the need for this</span>
<a name="ln-2184"></a>          <span class="c">! include.</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2187"></a>          <span class="c">! na</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2190"></a>          <span class="c">! na</span>
<a name="ln-2191"></a>
<a name="ln-2192"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2193"></a>          <span class="c">! na</span>
<a name="ln-2194"></a>
<a name="ln-2195"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2196"></a>
<a name="ln-2197"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2198"></a>          <span class="c">! na</span>
<a name="ln-2199"></a>
<a name="ln-2200"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2201"></a>          <span class="c">! na</span>
<a name="ln-2202"></a>
<a name="ln-2203"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2204"></a>          <span class="c">! na</span>
<a name="ln-2205"></a>
<a name="ln-2206"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2207"></a>          <span class="c">! na</span>
<a name="ln-2208"></a>
<a name="ln-2209"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2210"></a>          <span class="c">! na</span>
<a name="ln-2211"></a>
<a name="ln-2212"></a>          <span class="c">! FLOW:</span>
<a name="ln-2213"></a><span class="c">!unused          integer :: myhr</span>
<a name="ln-2214"></a>
<a name="ln-2215"></a>  <span class="n">TodayVariables</span><span class="o">=</span><span class="n">TomorrowVariables</span>          <span class="c">! Transfer Tomorrow&#39;s Daily Weather Variables to Today</span>
<a name="ln-2216"></a>
<a name="ln-2217"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2218"></a><span class="k">    </span><span class="n">PreviousHour</span><span class="o">=</span><span class="mi">24</span>
<a name="ln-2219"></a>  <span class="n">ENDIF</span>
<a name="ln-2220"></a>
<a name="ln-2221"></a>  <span class="n">TodayIsRain</span> <span class="o">=</span> <span class="n">TomorrowIsRain</span>
<a name="ln-2222"></a>  <span class="n">TodayIsSnow</span> <span class="o">=</span> <span class="n">TomorrowIsSnow</span>
<a name="ln-2223"></a>  <span class="n">TodayOutDryBulbTemp</span> <span class="o">=</span> <span class="n">TomorrowOutDryBulbTemp</span>
<a name="ln-2224"></a>  <span class="n">TodayOutDewPointTemp</span> <span class="o">=</span> <span class="n">TomorrowOutDewPointTemp</span>
<a name="ln-2225"></a>  <span class="n">TodayOutBaroPress</span> <span class="o">=</span> <span class="n">TomorrowOutBaroPress</span>
<a name="ln-2226"></a>  <span class="n">TodayOutRelHum</span> <span class="o">=</span> <span class="n">TomorrowOutRelHum</span>
<a name="ln-2227"></a>  <span class="n">TodayWindSpeed</span> <span class="o">=</span> <span class="n">TomorrowWindSpeed</span>
<a name="ln-2228"></a>  <span class="n">TodayWindDir</span> <span class="o">=</span> <span class="n">TomorrowWindDir</span>
<a name="ln-2229"></a>  <span class="n">TodaySkyTemp</span> <span class="o">=</span> <span class="n">TomorrowSkyTemp</span>
<a name="ln-2230"></a>  <span class="n">TodayHorizIRSky</span> <span class="o">=</span> <span class="n">TomorrowHorizIRSky</span>
<a name="ln-2231"></a>  <span class="n">TodayBeamSolarRad</span> <span class="o">=</span> <span class="n">TomorrowBeamSolarRad</span>
<a name="ln-2232"></a>  <span class="n">TodayDifSolarRad</span> <span class="o">=</span> <span class="n">TomorrowDifSolarRad</span>
<a name="ln-2233"></a>  <span class="n">TodayLiquidPrecip</span> <span class="o">=</span> <span class="n">TomorrowLiquidPrecip</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>          <span class="c">! Update Global Data</span>
<a name="ln-2236"></a>
<a name="ln-2237"></a>  <span class="n">DayOfYear</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">DayOfYear</span>
<a name="ln-2238"></a>  <span class="n">Year</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">Year</span>
<a name="ln-2239"></a>  <span class="n">Month</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">Month</span>
<a name="ln-2240"></a>  <span class="n">DayOfMonth</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">DayOfMonth</span>
<a name="ln-2241"></a>  <span class="n">DayOfWeek</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">DayOfWeek</span>
<a name="ln-2242"></a><span class="c">!  WeekDayCount(DayOfWeek)=WeekDayCount(DayOfWeek)+1</span>
<a name="ln-2243"></a>  <span class="n">HolidayIndex</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">HolidayIndex</span>
<a name="ln-2244"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HolidayIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2245"></a><span class="k">    </span><span class="n">RptDayType</span><span class="o">=</span><span class="mi">7</span><span class="o">+</span><span class="n">HolidayIndex</span>
<a name="ln-2246"></a>  <span class="k">ELSE</span>
<a name="ln-2247"></a><span class="k">    </span><span class="n">RptDayType</span><span class="o">=</span><span class="n">DayOfWeek</span>
<a name="ln-2248"></a>  <span class="n">ENDIF</span>
<a name="ln-2249"></a>  <span class="n">DSTIndicator</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">DaylightSavingIndex</span>
<a name="ln-2250"></a>  <span class="n">EquationOfTime</span><span class="o">=</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">EquationOfTime</span>
<a name="ln-2251"></a>  <span class="n">CosSolarDeclinAngle</span><span class="o">=</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">CosSolarDeclinAngle</span>
<a name="ln-2252"></a>  <span class="n">SinSolarDeclinAngle</span><span class="o">=</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">SinSolarDeclinAngle</span>
<a name="ln-2253"></a>
<a name="ln-2254"></a>  <span class="k">RETURN</span>
<a name="ln-2255"></a>
<a name="ln-2256"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateWeatherData</span>
<a name="ln-2257"></a>
<a name="ln-2258"></a><span class="k">SUBROUTINE </span><span class="n">SetCurrentWeather</span>
<a name="ln-2259"></a>
<a name="ln-2260"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2261"></a>          <span class="c">!       AUTHOR         Russ Taylor</span>
<a name="ln-2262"></a>          <span class="c">!       DATE WRITTEN   March 1990</span>
<a name="ln-2263"></a>          <span class="c">!       MODIFIED       Aug94 (LKL) Fixed improper weighting</span>
<a name="ln-2264"></a>          <span class="c">!                      Nov98 (FCW) Added call to get exterior illuminances</span>
<a name="ln-2265"></a>          <span class="c">!                      Jan02 (FCW) Changed how ground reflectance for daylighting is set</span>
<a name="ln-2266"></a>          <span class="c">!                      Mar12 (LKL) Changed settings for leap years/ current years.</span>
<a name="ln-2267"></a>          <span class="c">!       RE-ENGINEERED  Apr97,May97 (RKS)</span>
<a name="ln-2268"></a>
<a name="ln-2269"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2270"></a>          <span class="c">! The purpose of this subroutine is to interpolate the hourly</span>
<a name="ln-2271"></a>          <span class="c">! environment data for the sub-hourly time steps in EnergyPlus.  In</span>
<a name="ln-2272"></a>          <span class="c">! other words, this subroutine puts the current weather conditions</span>
<a name="ln-2273"></a>          <span class="c">! into the proper variables.  Rather than using the same data for</span>
<a name="ln-2274"></a>          <span class="c">! each time step, environment data is interpolated as a continuum</span>
<a name="ln-2275"></a>          <span class="c">! throughout the day.</span>
<a name="ln-2276"></a>
<a name="ln-2277"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2278"></a>          <span class="c">! The current hour (HourOfDay) as well as the next hour are used</span>
<a name="ln-2279"></a>          <span class="c">! to come up with environment data per time step interval.  Method</span>
<a name="ln-2280"></a>          <span class="c">! used is to assign a weighting for the current hour&#39;s data and</span>
<a name="ln-2281"></a>          <span class="c">! (1-that weighting) to the next hour&#39;s data.  Actual method is:  if</span>
<a name="ln-2282"></a>          <span class="c">! the current time step is 15 minutes into hour, the interpolated dry</span>
<a name="ln-2283"></a>          <span class="c">! bulb temperature should be 3/4*dry bulb temperature of current hour</span>
<a name="ln-2284"></a>          <span class="c">! and 1/4*dry bulb temperature of next environment hourly data.  At</span>
<a name="ln-2285"></a>          <span class="c">! day boundary (current hour = 24), the next hour is hour 1 of next</span>
<a name="ln-2286"></a>          <span class="c">! weather data day (Tomorrow%).</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2289"></a>          <span class="c">! INTERPOL(IBLAST) legacy code.</span>
<a name="ln-2290"></a>
<a name="ln-2291"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2292"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span>
<a name="ln-2293"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">UpdateScheduleValues</span>
<a name="ln-2294"></a>  <span class="k">use </span><span class="n">inputprocessor</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">samestring</span>
<a name="ln-2295"></a>
<a name="ln-2296"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2297"></a>
<a name="ln-2298"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2299"></a>          <span class="c">! na</span>
<a name="ln-2300"></a>
<a name="ln-2301"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2302"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TimeStmpFmt</span><span class="o">=</span><span class="s2">&quot;(I2.2,&#39;/&#39;,I2.2,&#39; &#39;,I2.2,&#39;:&#39;)&quot;</span>
<a name="ln-2303"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MnDyFmt</span><span class="o">=</span><span class="s2">&quot;(I2.2,&#39;/&#39;,I2.2)&quot;</span>
<a name="ln-2304"></a>
<a name="ln-2305"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2306"></a>          <span class="c">! na</span>
<a name="ln-2307"></a>
<a name="ln-2308"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2309"></a>          <span class="c">! na</span>
<a name="ln-2310"></a>
<a name="ln-2311"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2312"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">NextHour</span>
<a name="ln-2313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempVal</span>
<a name="ln-2314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempDPVal</span>
<a name="ln-2315"></a>
<a name="ln-2316"></a>          <span class="c">! FLOW:</span>
<a name="ln-2317"></a>
<a name="ln-2318"></a>
<a name="ln-2319"></a>  <span class="n">NextHour</span> <span class="o">=</span> <span class="n">HourOfDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2320"></a>
<a name="ln-2321"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">24</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2322"></a><span class="k">    </span><span class="n">NextHour</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2323"></a>  <span class="k">END IF</span>
<a name="ln-2324"></a>
<a name="ln-2325"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">HourOfDay</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2326"></a><span class="k">    </span><span class="n">DayOfYear_Schedule</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">Month</span><span class="p">,</span><span class="n">DayOfMonth</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2327"></a>  <span class="n">ENDIF</span>
<a name="ln-2328"></a>
<a name="ln-2329"></a>  <span class="k">CALL </span><span class="n">UpdateScheduleValues</span>
<a name="ln-2330"></a>
<a name="ln-2331"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">CurMnDyHr</span><span class="p">,</span><span class="n">TimeStmpFmt</span><span class="p">)</span> <span class="n">Month</span><span class="p">,</span><span class="n">DayOfMonth</span><span class="p">,</span><span class="n">HourOfDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2332"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">,</span><span class="n">MnDyFmt</span><span class="p">)</span> <span class="n">Month</span><span class="p">,</span><span class="n">DayOfMonth</span>
<a name="ln-2333"></a>
<a name="ln-2334"></a>  <span class="n">WeightNow</span><span class="o">=</span><span class="n">Interpolation</span><span class="p">(</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2335"></a>  <span class="n">WeightPreviousHour</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span><span class="n">WeightNow</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a>  <span class="n">CurrentTime</span><span class="o">=</span><span class="p">(</span><span class="n">HourOfDay</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">TimeStep</span><span class="o">*</span><span class="p">(</span><span class="n">TimeStepFraction</span><span class="p">)</span>
<a name="ln-2338"></a>  <span class="n">SimTimeSteps</span> <span class="o">=</span> <span class="p">(</span><span class="n">DayOfSim</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="n">NumOfTimeStepInHour</span> <span class="o">+</span> <span class="p">(</span><span class="n">HourOfDay</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">NumOfTimeStepInHour</span> <span class="o">+</span> <span class="n">TimeStep</span>
<a name="ln-2339"></a>
<a name="ln-2340"></a>  <span class="n">GroundTemp</span><span class="o">=</span><span class="n">GroundTemps</span><span class="p">(</span><span class="n">Month</span><span class="p">)</span>
<a name="ln-2341"></a>  <span class="n">GroundTempKelvin</span><span class="o">=</span><span class="n">GroundTemp</span><span class="o">+</span><span class="n">KelvinConv</span>
<a name="ln-2342"></a>  <span class="n">GroundTempFC</span><span class="o">=</span><span class="n">GroundTempsFC</span><span class="p">(</span><span class="n">Month</span><span class="p">)</span>
<a name="ln-2343"></a>  <span class="n">GroundTemp_Surface</span><span class="o">=</span><span class="n">SurfaceGroundTemps</span><span class="p">(</span><span class="n">Month</span><span class="p">)</span>
<a name="ln-2344"></a>  <span class="n">GroundTemp_Deep</span><span class="o">=</span><span class="n">DeepGroundTemps</span><span class="p">(</span><span class="n">Month</span><span class="p">)</span>
<a name="ln-2345"></a>  <span class="n">GndReflectance</span><span class="o">=</span><span class="n">GroundReflectances</span><span class="p">(</span><span class="n">Month</span><span class="p">)</span>
<a name="ln-2346"></a>  <span class="n">GndReflectanceForDayltg</span><span class="o">=</span><span class="n">GndReflectance</span>
<a name="ln-2347"></a>
<a name="ln-2348"></a>  <span class="k">CALL </span><span class="n">CalcWaterMainsTemp</span>
<a name="ln-2349"></a>
<a name="ln-2350"></a>  <span class="c">! Determine if Sun is up or down, set Solar Cosine values for time step.</span>
<a name="ln-2351"></a>  <span class="k">CALL </span><span class="n">DetermineSunUpDown</span><span class="p">(</span><span class="n">SOLCOS</span><span class="p">)</span>
<a name="ln-2352"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SolarAltitudeAngle</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2353"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SetCurrentWeather: At &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurMnDyHr</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Sun is Up but Solar Altitude Angle is &lt; 0.0&#39;</span><span class="p">)</span>
<a name="ln-2354"></a>  <span class="n">ENDIF</span>
<a name="ln-2355"></a>
<a name="ln-2356"></a>  <span class="n">OutDryBulbTemp</span> <span class="o">=</span> <span class="n">TodayOutDryBulbTemp</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2357"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EMSOutDryBulbOverrideOn</span><span class="p">)</span> <span class="n">OutDryBulbTemp</span> <span class="o">=</span> <span class="n">EMSOutDryBulbOverrideValue</span>
<a name="ln-2358"></a>  <span class="n">OutBaroPress</span>   <span class="o">=</span> <span class="n">TodayOutBaroPress</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2359"></a>  <span class="n">OutDewPointTemp</span><span class="o">=</span> <span class="n">TodayOutDewPointTemp</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2360"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EMSOutDewPointTempOverrideOn</span><span class="p">)</span> <span class="n">OutDewPointTemp</span> <span class="o">=</span> <span class="n">EMSOutDewPointTempOverrideValue</span>
<a name="ln-2361"></a>  <span class="n">OutRelHum</span>      <span class="o">=</span> <span class="n">TodayOutRelHum</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2362"></a>  <span class="n">OutRelHumValue</span> <span class="o">=</span> <span class="n">OutRelHum</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-2363"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EMSOutRelHumOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2364"></a><span class="k">    </span><span class="n">OutRelHumValue</span> <span class="o">=</span> <span class="n">EMSOutRelHumOverrideValue</span><span class="o">/</span> <span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-2365"></a>    <span class="n">OutRelHum</span> <span class="o">=</span> <span class="n">EMSOutRelHumOverrideValue</span>
<a name="ln-2366"></a>  <span class="n">ENDIF</span>
<a name="ln-2367"></a>
<a name="ln-2368"></a>  <span class="c">! Humidity Ratio and Wet Bulb are derived</span>
<a name="ln-2369"></a>  <span class="n">OutHumRat</span>      <span class="o">=</span> <span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="n">OutDryBulbTemp</span><span class="p">,</span><span class="n">OutRelHumValue</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;SetCurrentWeather&#39;</span><span class="p">)</span>
<a name="ln-2370"></a>  <span class="n">OutWetBulbTemp</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">OutDryBulbTemp</span><span class="p">,</span><span class="n">OutHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2371"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutWetBulbTemp</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2372"></a><span class="k">    </span><span class="n">OutWetBulbTemp</span><span class="o">=</span><span class="n">OutDryBulbTemp</span>
<a name="ln-2373"></a>    <span class="n">TempVal</span><span class="o">=</span><span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">OutDryBulbTemp</span><span class="p">,</span><span class="n">OutWetBulbTemp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2374"></a>    <span class="n">TempDPVal</span><span class="o">=</span><span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">TempVal</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-2375"></a>    <span class="n">OutDewPointTemp</span><span class="o">=</span><span class="n">TempDPVal</span>
<a name="ln-2376"></a>  <span class="n">ENDIF</span>
<a name="ln-2377"></a>
<a name="ln-2378"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutDewPointTemp</span> <span class="o">&gt;</span> <span class="n">OutWetBulbTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2379"></a><span class="k">    </span><span class="n">OutDewPointTemp</span><span class="o">=</span><span class="n">OutWetBulbTemp</span>
<a name="ln-2380"></a>  <span class="n">ENDIF</span>
<a name="ln-2381"></a>
<a name="ln-2382"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksDesignDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2383"></a><span class="k">    </span><span class="n">SPSiteDryBulbRangeModScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>    <span class="c">! N/A Drybulb Temperature Range Modifier Schedule Value</span>
<a name="ln-2384"></a>    <span class="n">SPSiteHumidityConditionScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>  <span class="c">! N/A Humidity Condition Schedule Value</span>
<a name="ln-2385"></a>    <span class="n">SPSiteBeamSolarScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>          <span class="c">! N/A Beam Solar Schedule Value</span>
<a name="ln-2386"></a>    <span class="n">SPSiteDiffuseSolarScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>       <span class="c">! N/A Diffuse Solar Schedule Value</span>
<a name="ln-2387"></a>    <span class="n">SPSiteSkyTemperatureScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>     <span class="c">! N/A SkyTemperature Modifier Schedule Value</span>
<a name="ln-2388"></a>
<a name="ln-2389"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">/=</span> <span class="n">DDDBRangeType_Default</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2390"></a><span class="k">      </span><span class="n">SPSiteDryBulbRangeModScheduleValue</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span> <span class="o">=</span> <span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">Envrn</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2391"></a>    <span class="n">ENDIF</span>
<a name="ln-2392"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDef</span>         <span class="p">&amp;</span>
<a name="ln-2393"></a>        <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDif</span>       <span class="p">&amp;</span>
<a name="ln-2394"></a>        <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfMul</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2395"></a><span class="k">      </span><span class="n">SPSiteHumidityConditionScheduleValue</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span> <span class="o">=</span> <span class="n">DDHumIndModifier</span><span class="p">(</span><span class="n">Envrn</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2396"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span>  <span class="n">DDHumIndType_RelHumSch</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2397"></a><span class="k">      </span><span class="n">SPSiteHumidityConditionScheduleValue</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span> <span class="o">=</span> <span class="n">DDHumIndModifier</span><span class="p">(</span><span class="n">Envrn</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2398"></a>    <span class="n">ENDIF</span>
<a name="ln-2399"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">SolarModel_Schedule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2400"></a><span class="k">      </span><span class="n">SPSiteBeamSolarScheduleValue</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span> <span class="o">=</span> <span class="n">DDBeamSolarValues</span><span class="p">(</span><span class="n">Envrn</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2401"></a>      <span class="n">SPSiteDiffuseSolarScheduleValue</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span> <span class="o">=</span> <span class="n">DDDiffuseSolarValues</span><span class="p">(</span><span class="n">Envrn</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2402"></a>    <span class="n">ENDIF</span>
<a name="ln-2403"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2404"></a><span class="k">      </span><span class="n">SPSiteSkyTemperatureScheduleValue</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)</span> <span class="o">=</span> <span class="n">DDSkyTempScheduleValues</span><span class="p">(</span><span class="n">Envrn</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2405"></a>    <span class="n">ENDIF</span>
<a name="ln-2406"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TotDesDays</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2407"></a><span class="k">    </span><span class="n">SPSiteDryBulbRangeModScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>    <span class="c">! N/A Drybulb Temperature Range Modifier Schedule Value</span>
<a name="ln-2408"></a>    <span class="n">SPSiteHumidityConditionScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>  <span class="c">! N/A Humidity Condition Schedule Value</span>
<a name="ln-2409"></a>    <span class="n">SPSiteBeamSolarScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>          <span class="c">! N/A Beam Solar Schedule Value</span>
<a name="ln-2410"></a>    <span class="n">SPSiteDiffuseSolarScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>       <span class="c">! N/A Diffuse Solar Schedule Value</span>
<a name="ln-2411"></a>    <span class="n">SPSiteSkyTemperatureScheduleValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.0d0</span>     <span class="c">! N/A SkyTemperature Modifier Schedule Value</span>
<a name="ln-2412"></a>  <span class="n">ENDIF</span>
<a name="ln-2413"></a>
<a name="ln-2414"></a>  <span class="n">WindSpeed</span>      <span class="o">=</span> <span class="n">TodayWindSpeed</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2415"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EMSWindSpeedOverrideOn</span><span class="p">)</span> <span class="n">WindSpeed</span>   <span class="o">=</span> <span class="n">EMSWindSpeedOverrideValue</span>
<a name="ln-2416"></a>  <span class="n">WindDir</span>        <span class="o">=</span> <span class="n">TodayWindDir</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2417"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EMSWindDirOverrideOn</span><span class="p">)</span> <span class="n">WindDir</span> <span class="o">=</span> <span class="n">EMSWindDirOverrideValue</span>
<a name="ln-2418"></a>  <span class="n">HorizIRSky</span>     <span class="o">=</span> <span class="n">TodayHorizIRSky</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2419"></a>  <span class="n">SkyTemp</span>        <span class="o">=</span> <span class="n">TodaySkyTemp</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2420"></a>  <span class="n">SkyTempKelvin</span>  <span class="o">=</span> <span class="n">SkyTemp</span> <span class="o">+</span> <span class="n">KelvinConv</span>
<a name="ln-2421"></a>  <span class="n">DifSolarRad</span>    <span class="o">=</span> <span class="n">TodayDifSolarRad</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2422"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EMSDifSolarRadOverrideOn</span><span class="p">)</span> <span class="n">DifSolarRad</span> <span class="o">=</span> <span class="n">EMSDifSolarRadOverrideValue</span>
<a name="ln-2423"></a>  <span class="n">BeamSolarRad</span>   <span class="o">=</span> <span class="n">TodayBeamSolarRad</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2424"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EMSBeamSolarRadOverrideOn</span><span class="p">)</span>  <span class="n">BeamSolarRad</span> <span class="o">=</span> <span class="n">EMSBeamSolarRadOverrideValue</span>
<a name="ln-2425"></a>  <span class="n">LiquidPrecipitation</span> <span class="o">=</span> <span class="n">TodayLiquidPrecip</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.d0</span> <span class="c">! convert from mm to m</span>
<a name="ln-2426"></a>
<a name="ln-2427"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UseRainValues</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2428"></a><span class="k">    </span><span class="n">IsRain</span><span class="o">=</span><span class="n">TodayIsRain</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="c">!.or. LiquidPrecipitation &gt;= .8d0)  ! &gt; .8 mm</span>
<a name="ln-2429"></a>  <span class="k">ELSE</span>
<a name="ln-2430"></a><span class="k">    </span><span class="n">IsRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2431"></a>  <span class="n">ENDIF</span>
<a name="ln-2432"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UseSnowValues</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2433"></a><span class="k">    </span><span class="n">IsSnow</span><span class="o">=</span><span class="n">TodayIsSnow</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-2434"></a>  <span class="k">ELSE</span>
<a name="ln-2435"></a><span class="k">    </span><span class="n">IsSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2436"></a>  <span class="n">ENDIF</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsSnow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2439"></a><span class="k">    </span><span class="n">GndReflectance</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="n">GndReflectance</span><span class="o">*</span><span class="n">SnowGndRefModifier</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2440"></a>    <span class="n">GndReflectanceForDayltg</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="n">GndReflectanceForDayltg</span><span class="o">*</span><span class="n">SnowGndRefModifierForDayltg</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2441"></a>  <span class="n">ENDIF</span>
<a name="ln-2442"></a>
<a name="ln-2443"></a>  <span class="n">GndSolarRad</span><span class="o">=</span><span class="nb">MAX</span><span class="p">((</span><span class="n">BeamSolarRad</span><span class="o">*</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">DifSolarRad</span><span class="p">)</span><span class="o">*</span><span class="n">GndReflectance</span><span class="p">,</span><span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-2444"></a>
<a name="ln-2445"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2446"></a><span class="k">    </span><span class="n">DifSolarRad</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2447"></a>    <span class="n">BeamSolarRad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2448"></a>    <span class="n">GndSolarRad</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2449"></a>  <span class="n">ENDIF</span>
<a name="ln-2450"></a>
<a name="ln-2451"></a>  <span class="c">! Calc some values</span>
<a name="ln-2452"></a>  <span class="n">OutEnthalpy</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">OutDryBulbTemp</span><span class="p">,</span><span class="n">OutHumRat</span><span class="p">)</span>
<a name="ln-2453"></a>  <span class="n">OutAirDensity</span><span class="o">=</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">OutDryBulbTemp</span><span class="p">,</span><span class="n">OutHumRat</span><span class="p">)</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a>  <span class="c">! Make sure outwetbulbtemp is valid.  And that no error occurs here.</span>
<a name="ln-2456"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">OutWetBulbTemp</span><span class="p">)</span> <span class="n">OutWetBulbTemp</span><span class="o">=</span><span class="n">OutDryBulbTemp</span>
<a name="ln-2457"></a>
<a name="ln-2458"></a><span class="c">!                                      VALIDITY TEST.</span>
<a name="ln-2459"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutDewPointTemp</span> <span class="o">&gt;</span> <span class="n">OutWetBulbTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2460"></a><span class="k">    </span><span class="n">OutDewPointTemp</span><span class="o">=</span><span class="n">OutWetBulbTemp</span>
<a name="ln-2461"></a>  <span class="n">ENDIF</span>
<a name="ln-2462"></a>          <span class="c">! Get exterior daylight illuminance for daylighting calculation</span>
<a name="ln-2463"></a>
<a name="ln-2464"></a>  <span class="k">CALL </span><span class="n">DayltgCurrentExtHorizIllum</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsRain</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2467"></a><span class="k">    </span><span class="n">RptIsRain</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2468"></a>  <span class="k">ELSE</span>
<a name="ln-2469"></a><span class="k">    </span><span class="n">RptIsRain</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2470"></a>  <span class="n">ENDIF</span>
<a name="ln-2471"></a>
<a name="ln-2472"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsSnow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2473"></a><span class="k">    </span><span class="n">RptIsSnow</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2474"></a>  <span class="k">ELSE</span>
<a name="ln-2475"></a><span class="k">    </span><span class="n">RptIsSnow</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2476"></a>  <span class="n">ENDIF</span>
<a name="ln-2477"></a>
<a name="ln-2478"></a>  <span class="k">RETURN</span>
<a name="ln-2479"></a>
<a name="ln-2480"></a><span class="k">END SUBROUTINE </span><span class="n">SetCurrentWeather</span>
<a name="ln-2481"></a>
<a name="ln-2482"></a><span class="k">SUBROUTINE </span><span class="n">ReadWeatherForDay</span><span class="p">(</span><span class="n">DayToRead</span><span class="p">,</span><span class="n">Environ</span><span class="p">,</span><span class="n">BackSpaceAfterRead</span><span class="p">)</span>
<a name="ln-2483"></a>
<a name="ln-2484"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2485"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-2486"></a>          <span class="c">!       DATE WRITTEN   April 1999</span>
<a name="ln-2487"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2488"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2489"></a>
<a name="ln-2490"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2491"></a>          <span class="c">! This subroutine is the driving routine behind reading the weather data.</span>
<a name="ln-2492"></a>          <span class="c">! Theoretically, several kinds of weather files could be read here.  As</span>
<a name="ln-2493"></a>          <span class="c">! distributed only EPW files are allowed.</span>
<a name="ln-2494"></a>
<a name="ln-2495"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2496"></a>          <span class="c">! na</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2499"></a>          <span class="c">! na</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2502"></a>          <span class="c">! na</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2505"></a>
<a name="ln-2506"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2507"></a>  <span class="kt">INTEGER </span><span class="n">DayToRead</span>   <span class="c">! =1 when starting out, otherwise signifies next day</span>
<a name="ln-2508"></a>  <span class="kt">INTEGER </span><span class="n">Environ</span>     <span class="c">! Environment being simulated</span>
<a name="ln-2509"></a>  <span class="kt">LOGICAL </span><span class="n">BackSpaceAfterRead</span> <span class="c">! True if weather file is to be backspaced after read</span>
<a name="ln-2510"></a>
<a name="ln-2511"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2512"></a>          <span class="c">! na</span>
<a name="ln-2513"></a>
<a name="ln-2514"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2515"></a>          <span class="c">! na</span>
<a name="ln-2516"></a>
<a name="ln-2517"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2518"></a>          <span class="c">! na</span>
<a name="ln-2519"></a>
<a name="ln-2520"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2521"></a>          <span class="c">! na</span>
<a name="ln-2522"></a>
<a name="ln-2523"></a>  <span class="k">CALL </span><span class="n">ReadEPlusWeatherForDay</span><span class="p">(</span><span class="n">DayToRead</span><span class="p">,</span><span class="n">Environ</span><span class="p">,</span><span class="n">BackSpaceAfterRead</span><span class="p">)</span>
<a name="ln-2524"></a>
<a name="ln-2525"></a>  <span class="k">RETURN</span>
<a name="ln-2526"></a>
<a name="ln-2527"></a><span class="k">END SUBROUTINE </span><span class="n">ReadWeatherForDay</span>
<a name="ln-2528"></a>
<a name="ln-2529"></a><span class="k">SUBROUTINE </span><span class="n">ReadEPlusWeatherForDay</span><span class="p">(</span><span class="n">DayToRead</span><span class="p">,</span><span class="n">Environ</span><span class="p">,</span><span class="n">BackSpaceAfterRead</span><span class="p">)</span>
<a name="ln-2530"></a>
<a name="ln-2531"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2532"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-2533"></a>          <span class="c">!       DATE WRITTEN   April 1999</span>
<a name="ln-2534"></a>          <span class="c">!       MODIFIED       March 2012; add actual weather read.</span>
<a name="ln-2535"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2536"></a>
<a name="ln-2537"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2538"></a>          <span class="c">! This subroutine reads the appropriate day of EPW weather data.</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2541"></a>          <span class="c">! na</span>
<a name="ln-2542"></a>
<a name="ln-2543"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2544"></a>          <span class="c">! na</span>
<a name="ln-2545"></a>
<a name="ln-2546"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2547"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RangeCheck</span>
<a name="ln-2548"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-2549"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleValuesForDay</span>
<a name="ln-2550"></a>
<a name="ln-2551"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2552"></a>
<a name="ln-2553"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2554"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DayToRead</span>   <span class="c">! =1 when starting out, otherwise signifies next day</span>
<a name="ln-2555"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Environ</span>     <span class="c">! Environment being simulated</span>
<a name="ln-2556"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BackSpaceAfterRead</span> <span class="c">! True if weather file is to be backspaced after read</span>
<a name="ln-2557"></a>
<a name="ln-2558"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2559"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">YMDHFmt</span><span class="o">=</span><span class="s2">&quot;(I4.4,2(&#39;/&#39;,I2.2),1X,I2.2,&#39;:&#39;,I2.2)&quot;</span>
<a name="ln-2560"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">YMDHFmt1</span><span class="o">=</span><span class="s2">&quot;(I4.4,2(&#39;/&#39;,I2.2),1X,&#39;hour=&#39;,I2.2,&#39; - expected hour=&#39;,I2.2)&quot;</span>
<a name="ln-2561"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DataFmt</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-2562"></a>
<a name="ln-2563"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2564"></a>          <span class="c">! na</span>
<a name="ln-2565"></a>
<a name="ln-2566"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2567"></a>  <span class="k">TYPE </span><span class="n">HourlyWeatherData</span>
<a name="ln-2568"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IsRain</span>      <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! Rain indicator, true=rain</span>
<a name="ln-2569"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IsSnow</span>      <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! Snow indicator, true=snow</span>
<a name="ln-2570"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutDryBulbTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly dry bulb temperature of outside air</span>
<a name="ln-2571"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutDewPointTemp</span><span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly Dew Point Temperature of outside air</span>
<a name="ln-2572"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutBaroPress</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly barometric pressure of outside air</span>
<a name="ln-2573"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutRelHum</span>      <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly relative humidity</span>
<a name="ln-2574"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindSpeed</span>      <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly wind speed of outside air</span>
<a name="ln-2575"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDir</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly wind direction of outside air</span>
<a name="ln-2576"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly sky temperature</span>
<a name="ln-2577"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorizIRSky</span>     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly Horizontal Infrared Radiation Intensity</span>
<a name="ln-2578"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BeamSolarRad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly direct normal solar irradiance</span>
<a name="ln-2579"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DifSolarRad</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly sky diffuse horizontal solar irradiance</span>
<a name="ln-2580"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Albedo</span>         <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Albedo</span>
<a name="ln-2581"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LiquidPrecip</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Liquid Precipitation</span>
<a name="ln-2582"></a>  <span class="k">END TYPE</span>
<a name="ln-2583"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2584"></a>  <span class="kt">INTEGER </span><span class="n">Hour</span>
<a name="ln-2585"></a>  <span class="kt">INTEGER </span><span class="n">TS</span>
<a name="ln-2586"></a>  <span class="kt">INTEGER </span><span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span>
<a name="ln-2587"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DryBulb</span><span class="p">,</span><span class="n">DewPoint</span><span class="p">,</span><span class="n">RelHum</span><span class="p">,</span><span class="n">AtmPress</span><span class="p">,</span><span class="n">ETHoriz</span><span class="p">,</span><span class="n">ETDirect</span><span class="p">,</span><span class="n">IRHoriz</span><span class="p">,</span><span class="n">GLBHoriz</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2588"></a>       <span class="n">DirectRad</span><span class="p">,</span><span class="n">DiffuseRad</span><span class="p">,</span><span class="n">GLBHorizIllum</span><span class="p">,</span><span class="n">DirectNrmIllum</span><span class="p">,</span><span class="n">DiffuseHorizIllum</span><span class="p">,</span><span class="n">ZenLum</span><span class="p">,</span><span class="n">WindDir</span><span class="p">,</span><span class="n">WindSpeed</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2589"></a>       <span class="n">TotalSkyCover</span><span class="p">,</span><span class="n">OpaqueSkyCover</span><span class="p">,</span><span class="n">Visibility</span><span class="p">,</span><span class="n">CeilHeight</span><span class="p">,</span><span class="n">PrecipWater</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2590"></a>       <span class="n">AerosolOptDepth</span><span class="p">,</span><span class="n">SnowDepth</span><span class="p">,</span><span class="n">DaysSinceLastSnow</span><span class="p">,</span><span class="n">Albedo</span><span class="p">,</span><span class="n">LiquidPrecip</span>
<a name="ln-2591"></a>  <span class="kt">INTEGER </span><span class="n">PresWeathObs</span>
<a name="ln-2592"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">PresWeathConds</span>
<a name="ln-2593"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span> <span class="n">WeatherDataLine</span>
<a name="ln-2594"></a>  <span class="kt">LOGICAL </span><span class="n">Ready</span>
<a name="ln-2595"></a>  <span class="kt">INTEGER </span><span class="n">CurTimeStep</span>
<a name="ln-2596"></a>  <span class="kt">INTEGER </span><span class="n">Item</span>
<a name="ln-2597"></a>
<a name="ln-2598"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">HourlyWeatherData</span><span class="p">)</span> <span class="n">Wthr</span>
<a name="ln-2599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">AVSC</span>
<a name="ln-2600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SkyTemp</span>
<a name="ln-2601"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">CurDayOfWeek</span>
<a name="ln-2602"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">UseDayOfWeek</span>
<a name="ln-2603"></a>  <span class="kt">LOGICAL </span><span class="n">SkipThisDay</span>  <span class="c">! Used when LeapYear is/is not in effect</span>
<a name="ln-2604"></a>  <span class="kt">LOGICAL </span><span class="n">TryAgain</span>
<a name="ln-2605"></a>  <span class="kt">INTEGER </span><span class="n">ReadStatus</span>
<a name="ln-2606"></a>  <span class="kt">INTEGER </span><span class="n">NumRewinds</span>
<a name="ln-2607"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span> <span class="n">BadRecord</span>
<a name="ln-2608"></a>  <span class="kt">LOGICAL </span><span class="n">ErrorsFound</span>
<a name="ln-2609"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">CurTime</span>
<a name="ln-2610"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HourRep</span>
<a name="ln-2611"></a>  <span class="kt">INTEGER </span><span class="n">OSky</span>
<a name="ln-2612"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TDewK</span>
<a name="ln-2613"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ESky</span>
<a name="ln-2614"></a>  <span class="kt">LOGICAL </span><span class="n">ErrorFound</span>
<a name="ln-2615"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="n">ErrOut</span>
<a name="ln-2616"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHourSet</span>  <span class="c">! for Interpolation</span>
<a name="ln-2617"></a>  <span class="kt">INTEGER </span><span class="n">NxtHour</span>
<a name="ln-2618"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WtNow</span>
<a name="ln-2619"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WtPrevHour</span>
<a name="ln-2620"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WgtHourNow</span>
<a name="ln-2621"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WgtPrevHour</span>
<a name="ln-2622"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WgtNextHour</span>
<a name="ln-2623"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrOutDryBulbTemp</span>
<a name="ln-2624"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrOutDewPointTemp</span>
<a name="ln-2625"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrOutBaroPress</span>
<a name="ln-2626"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrOutRelHum</span>
<a name="ln-2627"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrWindSpeed</span>
<a name="ln-2628"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrWindDir</span>
<a name="ln-2629"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrSkyTemp</span>
<a name="ln-2630"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrHorizIRSky</span>
<a name="ln-2631"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrBeamSolarRad</span>
<a name="ln-2632"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrDifSolarRad</span>
<a name="ln-2633"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrAlbedo</span>
<a name="ln-2634"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LastHrLiquidPrecip</span>
<a name="ln-2635"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">NextHrBeamSolarRad</span>
<a name="ln-2636"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">NextHrDifSolarRad</span>
<a name="ln-2637"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">NextHrLiquidPrecip</span>
<a name="ln-2638"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RecordDateMatch</span>
<a name="ln-2639"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay5Start</span><span class="p">,</span><span class="n">JDay5End</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">TWeekDay</span>
<a name="ln-2640"></a>
<a name="ln-2641"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DayToRead</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2642"></a>
<a name="ln-2643"></a><span class="c">! Checks whether Weather file contains just one year of data. If yes then rewind and position to first</span>
<a name="ln-2644"></a><span class="c">! day of weather file. The rest of code appropriately positions to the start day.</span>
<a name="ln-2645"></a>
<a name="ln-2646"></a>    <span class="n">Ready</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2647"></a>    <span class="n">NumRewinds</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2648"></a><span class="c">!     Must position file to proper day</span>
<a name="ln-2649"></a><span class="c">!     File already position to first data record</span>
<a name="ln-2650"></a><span class="c">!          Set Current Day of Week to &quot;start of Data Period&quot;</span>
<a name="ln-2651"></a>    <span class="n">CurTime</span><span class="o">=</span><span class="mf">1.d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumIntervalsPerHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-2652"></a>    <span class="n">CurDayOfWeek</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2653"></a>    <span class="n">WYear</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2654"></a>    <span class="n">WMonth</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2655"></a>    <span class="n">WDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2656"></a>    <span class="n">Whour</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2657"></a>    <span class="n">WMinute</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2658"></a>    <span class="n">LastHourSet</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2659"></a>    <span class="k">DO WHILE</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Ready</span><span class="p">)</span>
<a name="ln-2660"></a>      <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">DataFmt</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ReadStatus</span><span class="p">)</span> <span class="n">WeatherDataLine</span>
<a name="ln-2661"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">ReadStatus</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2662"></a>                <span class="c">! Reduce ugly code</span>
<a name="ln-2663"></a>            <span class="k">CALL </span><span class="n">InterpretWeatherDataLine</span><span class="p">(</span><span class="n">WeatherDataLine</span><span class="p">,</span><span class="n">ErrorFound</span><span class="p">,</span><span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2664"></a>                  <span class="n">DryBulb</span><span class="p">,</span><span class="n">DewPoint</span><span class="p">,</span><span class="n">RelHum</span><span class="p">,</span><span class="n">AtmPress</span><span class="p">,</span><span class="n">ETHoriz</span><span class="p">,</span><span class="n">ETDirect</span><span class="p">,</span><span class="n">IRHoriz</span><span class="p">,</span><span class="n">GLBHoriz</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-2665"></a>                  <span class="n">DirectRad</span><span class="p">,</span><span class="n">DiffuseRad</span><span class="p">,</span><span class="n">GLBHorizIllum</span><span class="p">,</span><span class="n">DirectNrmIllum</span><span class="p">,</span><span class="n">DiffuseHorizIllum</span><span class="p">,</span><span class="n">ZenLum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2666"></a>                  <span class="n">WindDir</span><span class="p">,</span><span class="n">WindSpeed</span><span class="p">,</span><span class="n">TotalSkyCover</span><span class="p">,</span><span class="n">OpaqueSkyCover</span><span class="p">,</span><span class="n">Visibility</span><span class="p">,</span><span class="n">CeilHeight</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-2667"></a>                  <span class="n">PresWeathObs</span><span class="p">,</span><span class="n">PresWeathConds</span><span class="p">,</span><span class="n">PrecipWater</span><span class="p">,</span><span class="n">AerosolOptDepth</span><span class="p">,</span><span class="n">SnowDepth</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2668"></a>                  <span class="n">DaysSinceLastSnow</span><span class="p">,</span><span class="n">Albedo</span><span class="p">,</span><span class="n">LiquidPrecip</span><span class="p">)</span>
<a name="ln-2669"></a>         <span class="n">ELSEIF</span><span class="p">(</span><span class="n">ReadStatus</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2670"></a><span class="k">           IF</span> <span class="p">(</span><span class="n">NumRewinds</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2671"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Multiple rewinds on EPW while searching for first day&#39;</span><span class="p">)</span>
<a name="ln-2672"></a>           <span class="k">ELSE</span>
<a name="ln-2673"></a><span class="k">             REWIND</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">)</span>
<a name="ln-2674"></a>             <span class="n">NumRewinds</span><span class="o">=</span><span class="n">NumRewinds</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2675"></a>             <span class="k">CALL </span><span class="n">SkipEPlusWFHeader</span>
<a name="ln-2676"></a>             <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">DataFmt</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ReadStatus</span><span class="p">)</span> <span class="n">WeatherDataLine</span>
<a name="ln-2677"></a>             <span class="k">CALL </span><span class="n">InterpretWeatherDataLine</span><span class="p">(</span><span class="n">WeatherDataLine</span><span class="p">,</span><span class="n">ErrorFound</span><span class="p">,</span><span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2678"></a>                    <span class="n">DryBulb</span><span class="p">,</span><span class="n">DewPoint</span><span class="p">,</span><span class="n">RelHum</span><span class="p">,</span><span class="n">AtmPress</span><span class="p">,</span><span class="n">ETHoriz</span><span class="p">,</span><span class="n">ETDirect</span><span class="p">,</span><span class="n">IRHoriz</span><span class="p">,</span><span class="n">GLBHoriz</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-2679"></a>                    <span class="n">DirectRad</span><span class="p">,</span><span class="n">DiffuseRad</span><span class="p">,</span><span class="n">GLBHorizIllum</span><span class="p">,</span><span class="n">DirectNrmIllum</span><span class="p">,</span><span class="n">DiffuseHorizIllum</span><span class="p">,</span><span class="n">ZenLum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2680"></a>                    <span class="n">WindDir</span><span class="p">,</span><span class="n">WindSpeed</span><span class="p">,</span><span class="n">TotalSkyCover</span><span class="p">,</span><span class="n">OpaqueSkyCover</span><span class="p">,</span><span class="n">Visibility</span><span class="p">,</span><span class="n">CeilHeight</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-2681"></a>                    <span class="n">PresWeathObs</span><span class="p">,</span><span class="n">PresWeathConds</span><span class="p">,</span><span class="n">PrecipWater</span><span class="p">,</span><span class="n">AerosolOptDepth</span><span class="p">,</span><span class="n">SnowDepth</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2682"></a>                    <span class="n">DaysSinceLastSnow</span><span class="p">,</span><span class="n">Albedo</span><span class="p">,</span><span class="n">LiquidPrecip</span><span class="p">)</span>
<a name="ln-2683"></a>
<a name="ln-2684"></a>           <span class="n">ENDIF</span>
<a name="ln-2685"></a>         <span class="n">ENDIF</span>
<a name="ln-2686"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ReadStatus</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2687"></a><span class="k">        </span><span class="n">BadRecord</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WYear</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WDay</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2688"></a>           <span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WHour</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMinute</span><span class="p">))</span>
<a name="ln-2689"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrOut</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">ReadStatus</span>
<a name="ln-2690"></a>        <span class="n">ErrOut</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrOut</span><span class="p">)</span>
<a name="ln-2691"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Error occured on EPW while searching for first day, stopped at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BadRecord</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2692"></a>                            <span class="s1">&#39; IO Error=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ReadStatus</span><span class="p">)),</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-2693"></a>      <span class="n">ENDIF</span>
<a name="ln-2694"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurDayOfWeek</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2695"></a><span class="k">        </span><span class="n">CurDayOfWeek</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="n">CurDayOfWeek</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2696"></a>      <span class="n">ENDIF</span>
<a name="ln-2697"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WMonth</span> <span class="o">==</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WDay</span> <span class="o">==</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">StartDay</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2698"></a>          <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">MatchYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2699"></a><span class="k">        </span><span class="n">RecordDateMatch</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2700"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WMonth</span> <span class="o">==</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WDay</span> <span class="o">==</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">StartDay</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2701"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">MatchYear</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WYear</span> <span class="o">==</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">StartYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2702"></a><span class="k">        </span><span class="n">RecordDateMatch</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2703"></a>      <span class="k">ELSE</span>
<a name="ln-2704"></a><span class="k">        </span><span class="n">RecordDateMatch</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2705"></a>      <span class="n">ENDIF</span>
<a name="ln-2706"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RecordDateMatch</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2707"></a><span class="k">        BACKSPACE</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">)</span>
<a name="ln-2708"></a>        <span class="n">Ready</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2709"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurDayOfWeek</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2710"></a><span class="k">          </span><span class="n">CurDayOfWeek</span><span class="o">=</span><span class="n">CurDayOfWeek</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2711"></a>        <span class="n">ENDIF</span>
<a name="ln-2712"></a>        <span class="c">! Do the range checks on the first set of fields -- no others.</span>
<a name="ln-2713"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2714"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DryBulb</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">9.9d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2715"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;DryBulb Temperature&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= -90&#39;</span><span class="p">,(</span><span class="n">Drybulb</span><span class="o">&gt;=-</span><span class="mi">9</span><span class="mf">0.0d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2716"></a>                        <span class="s1">&#39;&lt;= 70&#39;</span><span class="p">,(</span><span class="n">DryBulb</span> <span class="o">&lt;=</span><span class="mi">7</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DryBulb</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2717"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Dewpoint</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">9.9d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2718"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;DewPoint Temperature&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= -90&#39;</span><span class="p">,(</span><span class="n">Dewpoint</span><span class="o">&gt;=-</span><span class="mi">9</span><span class="mf">0.0d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2719"></a>                        <span class="s1">&#39;&lt;= 70&#39;</span><span class="p">,(</span><span class="n">Dewpoint</span> <span class="o">&lt;=</span><span class="mi">7</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Dewpoint</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2720"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2721"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;Relative Humidity&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt; 0&#39;</span><span class="p">,(</span><span class="n">RelHum</span><span class="o">&gt;=</span><span class="mf">0.0d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2722"></a>                        <span class="s1">&#39;&lt;= 110&#39;</span><span class="p">,(</span><span class="n">RelHum</span><span class="o">&lt;=</span><span class="mi">11</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RelHum</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2723"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AtmPress</span> <span class="o">&lt;</span> <span class="mi">99999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2724"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;Atmospheric Pressure&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt; 31000&#39;</span><span class="p">,(</span><span class="n">AtmPress</span><span class="o">&gt;</span><span class="mi">3100</span><span class="mf">0.0d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2725"></a>                          <span class="s1">&#39;&lt;=120000&#39;</span><span class="p">,(</span><span class="n">AtmPress</span><span class="o">&lt;=</span><span class="mi">12000</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AtmPress</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2726"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DirectRad</span> <span class="o">&lt;</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2727"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;Direct Radiation&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= 0&#39;</span><span class="p">,(</span><span class="n">DirectRad</span><span class="o">&gt;=</span><span class="mf">0.0d0</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2728"></a>             <span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2729"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DiffuseRad</span> <span class="o">&lt;</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2730"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;Diffuse Radiation&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= 0&#39;</span><span class="p">,(</span><span class="n">DiffuseRad</span><span class="o">&gt;=</span><span class="mf">0.0d0</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2731"></a>             <span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2732"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindDir</span> <span class="o">&lt;</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2733"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;Wind Direction&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=0&#39;</span><span class="p">,(</span><span class="n">WindDir</span><span class="o">&gt;=</span><span class="mf">0.0d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2734"></a>                        <span class="s1">&#39;&lt;=360&#39;</span><span class="p">,(</span><span class="n">WindDir</span><span class="o">&lt;=</span><span class="mi">36</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WindDir</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2735"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindSpeed</span> <span class="o">&lt;</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2736"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;Wind Speed&#39;</span><span class="p">,</span><span class="s1">&#39;WeatherFile&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=0&#39;</span><span class="p">,(</span><span class="n">WindSpeed</span><span class="o">&gt;=</span><span class="mf">0.0d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2737"></a>                        <span class="s1">&#39;&lt;=40&#39;</span><span class="p">,(</span><span class="n">WindSpeed</span><span class="o">&lt;=</span><span class="mi">4</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WindSpeed</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span><span class="p">)</span>
<a name="ln-2738"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2739"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Out of Range errors found with initial day of WeatherFile&#39;</span><span class="p">)</span>
<a name="ln-2740"></a>        <span class="n">ENDIF</span>
<a name="ln-2741"></a>      <span class="k">ELSE</span>
<a name="ln-2742"></a>      <span class="c">!  Must skip this day</span>
<a name="ln-2743"></a>        <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">NumIntervalsPerHour</span>
<a name="ln-2744"></a>          <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">DataFmt</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ReadStatus</span><span class="p">)</span> <span class="n">WeatherDataLine</span>
<a name="ln-2745"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ReadStatus</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2746"></a><span class="k">            READ</span><span class="p">(</span><span class="n">WeatherDataLine</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span>
<a name="ln-2747"></a>            <span class="n">BadRecord</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WYear</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WDay</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2748"></a>                      <span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WHour</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMinute</span><span class="p">))</span>
<a name="ln-2749"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Error occured on EPW while searching for first day, stopped at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BadRecord</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2750"></a>                                <span class="s1">&#39; IO Error=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ReadStatus</span><span class="p">)),</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-2751"></a>          <span class="n">ENDIF</span>
<a name="ln-2752"></a>        <span class="n">ENDDO</span>
<a name="ln-2753"></a>        <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">23</span><span class="o">*</span><span class="n">NumIntervalsPerHour</span>
<a name="ln-2754"></a>          <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">DataFmt</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ReadStatus</span><span class="p">)</span> <span class="n">WeatherDataLine</span>
<a name="ln-2755"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ReadStatus</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2756"></a><span class="k">            READ</span><span class="p">(</span><span class="n">WeatherDataLine</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span>
<a name="ln-2757"></a>            <span class="n">BadRecord</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WYear</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WDay</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2758"></a>                      <span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WHour</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMinute</span><span class="p">))</span>
<a name="ln-2759"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Error occured on EPW while searching for first day, stopped at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BadRecord</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2760"></a>                                <span class="s1">&#39; IO Error=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ReadStatus</span><span class="p">)),</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-2761"></a>          <span class="n">ENDIF</span>
<a name="ln-2762"></a>        <span class="n">ENDDO</span>
<a name="ln-2763"></a>      <span class="n">ENDIF</span>
<a name="ln-2764"></a>    <span class="n">ENDDO</span>
<a name="ln-2765"></a>
<a name="ln-2766"></a>   <span class="c">! Positioned to proper day</span>
<a name="ln-2767"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2768"></a><span class="k">      </span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">CurrentCycle</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">CurrentCycle</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2769"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2770"></a><span class="k">        CALL </span><span class="n">SetDayOfWeekInitialValues</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">CurDayOfWeek</span><span class="p">,</span><span class="n">UseDayOfWeek</span><span class="p">)</span>
<a name="ln-2771"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DaylightSavingIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2772"></a><span class="k">          CALL </span><span class="n">SetDSTDateRanges</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">DSTIndex</span><span class="p">)</span>
<a name="ln-2773"></a>        <span class="n">ENDIF</span>
<a name="ln-2774"></a>          <span class="k">CALL </span><span class="n">SetSpecialDayDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-2775"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">CurrentCycle</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2776"></a><span class="k">        CALL </span><span class="n">SetDayOfWeekInitialValues</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">CurDayOfWeek</span><span class="p">,</span><span class="n">UseDayOfWeek</span><span class="p">)</span>
<a name="ln-2777"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">SetWeekDays</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2778"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DaylightSavingIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2779"></a><span class="k">          CALL </span><span class="n">SetDSTDateRanges</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">,</span><span class="n">DSTIndex</span><span class="p">)</span>
<a name="ln-2780"></a>        <span class="n">ENDIF</span>
<a name="ln-2781"></a>          <span class="k">CALL </span><span class="n">SetSpecialDayDates</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-2782"></a>      <span class="k">ELSE</span>
<a name="ln-2783"></a><span class="k">        </span><span class="n">CurDayOfWeek</span><span class="o">=</span><span class="n">DayOfWeekTomorrow</span>
<a name="ln-2784"></a>      <span class="n">ENDIF</span>
<a name="ln-2785"></a>    <span class="k">ELSE</span>
<a name="ln-2786"></a><span class="k">      CALL </span><span class="n">SetDayOfWeekInitialValues</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">CurDayOfWeek</span><span class="p">,</span><span class="n">UseDayOfWeek</span><span class="p">)</span>
<a name="ln-2787"></a>    <span class="n">ENDIF</span>
<a name="ln-2788"></a>  <span class="n">ENDIF</span>
<a name="ln-2789"></a>
<a name="ln-2790"></a>  <span class="n">TryAgain</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2791"></a>  <span class="n">SkipThisDay</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2792"></a>
<a name="ln-2793"></a>  <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">TryAgain</span><span class="p">)</span>
<a name="ln-2794"></a>
<a name="ln-2795"></a>    <span class="n">TryAgain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2796"></a>
<a name="ln-2797"></a>    <span class="n">TomorrowOutDryBulbTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2798"></a>    <span class="n">TomorrowOutDewPointTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2799"></a>    <span class="n">TomorrowOutBaroPress</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2800"></a>    <span class="n">TomorrowOutRelHum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2801"></a>    <span class="n">TomorrowWindSpeed</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2802"></a>    <span class="n">TomorrowWindDir</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2803"></a>    <span class="n">TomorrowSkyTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2804"></a>    <span class="n">TomorrowHorizIRSky</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2805"></a>    <span class="n">TomorrowBeamSolarRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2806"></a>    <span class="n">TomorrowDifSolarRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2807"></a>    <span class="n">TomorrowAlbedo</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2808"></a>    <span class="n">TomorrowLiquidPrecip</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2809"></a>    <span class="n">TomorrowIsRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2810"></a>    <span class="n">TomorrowIsSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2811"></a>
<a name="ln-2812"></a>    <span class="k">DO </span><span class="n">Hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-2813"></a>      <span class="k">Do </span><span class="n">CurTimeStep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumIntervalsPerHour</span>
<a name="ln-2814"></a>        <span class="n">HourRep</span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Hour</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">CurTime</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CurTimeStep</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span>
<a name="ln-2815"></a>        <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">DataFmt</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ReadStatus</span><span class="p">)</span> <span class="n">WeatherDataLine</span>
<a name="ln-2816"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ReadStatus</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">WeatherDataLine</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-2817"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WeatherDataLine</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2818"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Hour</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2819"></a><span class="k">            </span><span class="n">ReadStatus</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-2820"></a>          <span class="k">ELSE</span>
<a name="ln-2821"></a><span class="k">            </span><span class="n">ReadStatus</span><span class="o">=</span><span class="mi">99</span>
<a name="ln-2822"></a>          <span class="n">ENDIF</span>
<a name="ln-2823"></a>        <span class="n">ENDIF</span>
<a name="ln-2824"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ReadStatus</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2825"></a><span class="k">          CALL </span><span class="n">InterpretWeatherDataLine</span><span class="p">(</span><span class="n">WeatherDataLine</span><span class="p">,</span><span class="n">ErrorFound</span><span class="p">,</span><span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2826"></a>                    <span class="n">DryBulb</span><span class="p">,</span><span class="n">DewPoint</span><span class="p">,</span><span class="n">RelHum</span><span class="p">,</span><span class="n">AtmPress</span><span class="p">,</span><span class="n">ETHoriz</span><span class="p">,</span><span class="n">ETDirect</span><span class="p">,</span><span class="n">IRHoriz</span><span class="p">,</span><span class="n">GLBHoriz</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-2827"></a>                    <span class="n">DirectRad</span><span class="p">,</span><span class="n">DiffuseRad</span><span class="p">,</span><span class="n">GLBHorizIllum</span><span class="p">,</span><span class="n">DirectNrmIllum</span><span class="p">,</span><span class="n">DiffuseHorizIllum</span><span class="p">,</span><span class="n">ZenLum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2828"></a>                    <span class="n">WindDir</span><span class="p">,</span><span class="n">WindSpeed</span><span class="p">,</span><span class="n">TotalSkyCover</span><span class="p">,</span><span class="n">OpaqueSkyCover</span><span class="p">,</span><span class="n">Visibility</span><span class="p">,</span><span class="n">CeilHeight</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-2829"></a>                    <span class="n">PresWeathObs</span><span class="p">,</span><span class="n">PresWeathConds</span><span class="p">,</span><span class="n">PrecipWater</span><span class="p">,</span><span class="n">AerosolOptDepth</span><span class="p">,</span><span class="n">SnowDepth</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2830"></a>                    <span class="n">DaysSinceLastSnow</span><span class="p">,</span><span class="n">Albedo</span><span class="p">,</span><span class="n">LiquidPrecip</span><span class="p">)</span>
<a name="ln-2831"></a>        <span class="k">ELSE</span>  <span class="c">! ReadStatus /=0</span>
<a name="ln-2832"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ReadStatus</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">NumDataPeriods</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Standard End-of-file, rewind and position to first day...</span>
<a name="ln-2833"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">NumDays</span> <span class="o">&gt;=</span> <span class="n">NumDaysInYear</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2834"></a><span class="k">              REWIND</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">)</span>
<a name="ln-2835"></a>              <span class="k">CALL </span><span class="n">SkipEPlusWFHeader</span>
<a name="ln-2836"></a>              <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">DataFmt</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ReadStatus</span><span class="p">)</span> <span class="n">WeatherDataLine</span>
<a name="ln-2837"></a>
<a name="ln-2838"></a>              <span class="k">CALL </span><span class="n">InterpretWeatherDataLine</span><span class="p">(</span><span class="n">WeatherDataLine</span><span class="p">,</span><span class="n">ErrorFound</span><span class="p">,</span><span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2839"></a>                        <span class="n">DryBulb</span><span class="p">,</span><span class="n">DewPoint</span><span class="p">,</span><span class="n">RelHum</span><span class="p">,</span><span class="n">AtmPress</span><span class="p">,</span><span class="n">ETHoriz</span><span class="p">,</span><span class="n">ETDirect</span><span class="p">,</span><span class="n">IRHoriz</span><span class="p">,</span><span class="n">GLBHoriz</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-2840"></a>                        <span class="n">DirectRad</span><span class="p">,</span><span class="n">DiffuseRad</span><span class="p">,</span><span class="n">GLBHorizIllum</span><span class="p">,</span><span class="n">DirectNrmIllum</span><span class="p">,</span><span class="n">DiffuseHorizIllum</span><span class="p">,</span><span class="n">ZenLum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2841"></a>                        <span class="n">WindDir</span><span class="p">,</span><span class="n">WindSpeed</span><span class="p">,</span><span class="n">TotalSkyCover</span><span class="p">,</span><span class="n">OpaqueSkyCover</span><span class="p">,</span><span class="n">Visibility</span><span class="p">,</span><span class="n">CeilHeight</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-2842"></a>                        <span class="n">PresWeathObs</span><span class="p">,</span><span class="n">PresWeathConds</span><span class="p">,</span><span class="n">PrecipWater</span><span class="p">,</span><span class="n">AerosolOptDepth</span><span class="p">,</span><span class="n">SnowDepth</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2843"></a>                        <span class="n">DaysSinceLastSnow</span><span class="p">,</span><span class="n">Albedo</span><span class="p">,</span><span class="n">LiquidPrecip</span><span class="p">)</span>
<a name="ln-2844"></a>            <span class="k">ELSE</span>
<a name="ln-2845"></a><span class="k">              </span><span class="n">BadRecord</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WYear</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WDay</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2846"></a>                      <span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WHour</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMinute</span><span class="p">))</span>
<a name="ln-2847"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;End-of-File encountered after &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BadRecord</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, starting from first day of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2848"></a>                                  <span class="s1">&#39;Weather File would not be &quot;next day&quot;&#39;</span><span class="p">)</span>
<a name="ln-2849"></a>            <span class="n">ENDIF</span>
<a name="ln-2850"></a>          <span class="k">ELSE</span>
<a name="ln-2851"></a><span class="k">            </span><span class="n">BadRecord</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WYear</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WDay</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2852"></a>                      <span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WHour</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMinute</span><span class="p">))</span>
<a name="ln-2853"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Unexpected error condition in middle of reading EPW file, stopped at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BadRecord</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2854"></a>                                 <span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-2855"></a>          <span class="n">ENDIF</span>
<a name="ln-2856"></a>        <span class="n">ENDIF</span>
<a name="ln-2857"></a>
<a name="ln-2858"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Hour</span> <span class="o">/=</span> <span class="n">Whour</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2859"></a><span class="k">            </span><span class="n">BadRecord</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WYear</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;/&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WDay</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-2860"></a>                      <span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WHour</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMinute</span><span class="p">))</span>
<a name="ln-2861"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Unexpected error condition in middle of reading EPW file, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BadRecord</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2862"></a>                                 <span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-2863"></a>        <span class="n">ENDIF</span>
<a name="ln-2864"></a>
<a name="ln-2865"></a><span class="c">!         Set possible missing values</span>
<a name="ln-2866"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ETHoriz</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ETHoriz</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2867"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ETDirect</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ETDirect</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2868"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IRHoriz</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">IRHoriz</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2869"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GLBHoriz</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">GLBHoriz</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2870"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayWeatherMissingDataWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2871"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DirectRad</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2872"></a><span class="k">            </span><span class="n">Missed</span><span class="p">%</span><span class="n">DirectRad</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">DirectRad</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2873"></a>          <span class="n">ENDIF</span>
<a name="ln-2874"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DiffuseRad</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2875"></a><span class="k">            </span><span class="n">Missed</span><span class="p">%</span><span class="n">DiffuseRad</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">DirectRad</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2876"></a>          <span class="n">ENDIF</span>
<a name="ln-2877"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DirectRad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2878"></a><span class="k">            </span><span class="n">DirectRad</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2879"></a>            <span class="n">OutOfRange</span><span class="p">%</span><span class="n">DirectRad</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DirectRad</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2880"></a>          <span class="n">ENDIF</span>
<a name="ln-2881"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DiffuseRad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2882"></a><span class="k">            </span><span class="n">DiffuseRad</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2883"></a>            <span class="n">OutOfRange</span><span class="p">%</span><span class="n">DiffuseRad</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DiffuseRad</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2884"></a>          <span class="n">ENDIF</span>
<a name="ln-2885"></a>        <span class="n">ENDIF</span>
<a name="ln-2886"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GLBHorizIllum</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">GLBHorizIllum</span><span class="o">=</span><span class="mi">99999</span><span class="mf">9.d0</span>
<a name="ln-2887"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DirectNrmIllum</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">DirectNrmIllum</span><span class="o">=</span><span class="mi">99999</span><span class="mf">9.d0</span>
<a name="ln-2888"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DiffuseHorizIllum</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">DiffuseHorizIllum</span><span class="o">=</span><span class="mi">99999</span><span class="mf">9.d0</span>
<a name="ln-2889"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZenLum</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ZenLum</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-2890"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AtmPress</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">AtmPress</span><span class="o">=</span><span class="mi">99999</span><span class="mf">9.d0</span>
<a name="ln-2891"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindSpeed</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">WindSpeed</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2892"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindDir</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">36</span><span class="mf">0.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">WindDir</span> <span class="o">&gt;</span> <span class="mi">36</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">WindDir</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2893"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TotalSkyCover</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">TotalSkyCover</span><span class="o">=</span><span class="mi">9</span><span class="mf">9.d0</span>
<a name="ln-2894"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">RelHum</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2895"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OpaqueSkyCover</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">OpaqueSkyCover</span><span class="o">=</span><span class="mi">9</span><span class="mf">9.d0</span>
<a name="ln-2896"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Visibility</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">Visibility</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2897"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CeilHeight</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">CeilHeight</span><span class="o">=</span><span class="mi">999</span><span class="mf">9.d0</span>
<a name="ln-2898"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PresWeathObs</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">PresWeathObs</span><span class="o">=</span><span class="mf">9.0d0</span>
<a name="ln-2899"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PrecipWater</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">PrecipWater</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2900"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AerosolOptDepth</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">AerosolOptDepth</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2901"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SnowDepth</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SnowDepth</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2902"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DaysSinceLastSnow</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">DaysSinceLastSnow</span><span class="o">=</span><span class="mi">9</span><span class="mf">9.d0</span>
<a name="ln-2903"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Albedo</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">Albedo</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2904"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">LiquidPrecip</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">LiquidPrecip</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-2905"></a>
<a name="ln-2906"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Hour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">CurTimeStep</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2907"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WMonth</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WDay</span> <span class="o">==</span> <span class="mi">29</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CurrentYearIsLeapYear</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2908"></a><span class="k">            </span><span class="n">EndDayOfMonth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">28</span>
<a name="ln-2909"></a>            <span class="n">SkipThisDay</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2910"></a>            <span class="n">TryAgain</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2911"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ReadEPlusWeatherForDay: Feb29 data encountered but will not be processed.&#39;</span><span class="p">)</span>
<a name="ln-2912"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2913"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...WeatherFile does not allow Leap Years. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2914"></a>                 <span class="s1">&#39;HOLIDAYS/DAYLIGHT SAVINGS header must indicate &quot;Yes&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2915"></a>            <span class="n">ENDIF</span>
<a name="ln-2916"></a>            <span class="k">CYCLE</span>
<a name="ln-2917"></a><span class="k">          </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WMonth</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WDay</span> <span class="o">==</span> <span class="mi">29</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">CurrentYearIsLeapYear</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2918"></a><span class="k">            </span><span class="n">TryAgain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2919"></a>            <span class="n">SkipThisDay</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2920"></a>          <span class="k">ELSE</span>
<a name="ln-2921"></a><span class="k">            </span><span class="n">TryAgain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2922"></a>            <span class="n">SkipThisDay</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2923"></a>          <span class="n">ENDIF</span>
<a name="ln-2924"></a>
<a name="ln-2925"></a>          <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">Year</span><span class="o">=</span><span class="n">WYear</span>
<a name="ln-2926"></a>          <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">Month</span><span class="o">=</span><span class="n">WMonth</span>
<a name="ln-2927"></a>          <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfMonth</span><span class="o">=</span><span class="n">WDay</span>
<a name="ln-2928"></a>          <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfYear</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">WMonth</span><span class="p">,</span><span class="n">Wday</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-2929"></a>          <span class="k">CALL </span><span class="n">CalculateDailySolarCoeffs</span><span class="p">(</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfYear</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">AVSC</span><span class="p">,</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">EquationOfTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2930"></a>                                         <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">SinSolarDeclinAngle</span><span class="p">,</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">CosSolarDeclinAngle</span><span class="p">)</span>
<a name="ln-2931"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurDayOfWeek</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2932"></a><span class="k">            </span><span class="n">CurDayOfWeek</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="n">CurDayOfWeek</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2933"></a>          <span class="n">ENDIF</span>
<a name="ln-2934"></a>          <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">CurDayOfWeek</span>
<a name="ln-2935"></a>          <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DaylightSavingIndex</span><span class="o">=</span><span class="n">DSTIndex</span><span class="p">(</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfYear</span><span class="p">)</span>
<a name="ln-2936"></a>          <span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">HolidayIndex</span><span class="o">=</span><span class="n">SpecialDayTypes</span><span class="p">(</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfYear</span><span class="p">)</span>
<a name="ln-2937"></a>        <span class="n">ENDIF</span>
<a name="ln-2938"></a>
<a name="ln-2939"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SkipThisDay</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2940"></a>
<a name="ln-2941"></a>        <span class="c">! Check out missing values</span>
<a name="ln-2942"></a>
<a name="ln-2943"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DryBulb</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">9.9d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2944"></a><span class="k">          </span><span class="n">DryBulb</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">DryBulb</span>
<a name="ln-2945"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">DryBulb</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">DryBulb</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2946"></a>        <span class="n">ENDIF</span>
<a name="ln-2947"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DryBulb</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">9</span><span class="mf">0.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DryBulb</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2948"></a><span class="k">          </span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DryBulb</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DryBulb</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2949"></a>        <span class="n">ENDIF</span>
<a name="ln-2950"></a>
<a name="ln-2951"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DewPoint</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">9.9d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2952"></a><span class="k">          </span><span class="n">DewPoint</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">DewPoint</span>
<a name="ln-2953"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">DewPoint</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">DewPoint</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2954"></a>        <span class="n">ENDIF</span>
<a name="ln-2955"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DewPoint</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">9</span><span class="mf">0.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DewPoint</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2956"></a><span class="k">          </span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DewPoint</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DewPoint</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2957"></a>        <span class="n">ENDIF</span>
<a name="ln-2958"></a>
<a name="ln-2959"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&gt;=</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2960"></a><span class="k">          </span><span class="n">RelHum</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">RelHumid</span>
<a name="ln-2961"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">RelHumid</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">RelHumid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2962"></a>        <span class="n">ENDIF</span>
<a name="ln-2963"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2964"></a><span class="k">          </span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">RelHumid</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">RelHumid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2965"></a>        <span class="n">ENDIF</span>
<a name="ln-2966"></a>
<a name="ln-2967"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AtmPress</span> <span class="o">&gt;=</span> <span class="mi">99999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2968"></a><span class="k">          </span><span class="n">AtmPress</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">StnPres</span>
<a name="ln-2969"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">StnPres</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">StnPres</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2970"></a>        <span class="n">ENDIF</span>
<a name="ln-2971"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AtmPress</span> <span class="o">&lt;=</span> <span class="mi">3100</span><span class="mf">0.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">AtmPress</span> <span class="o">&gt;</span> <span class="mi">12000</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2972"></a><span class="k">          </span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">StnPres</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">StnPres</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2973"></a>          <span class="n">AtmPress</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">StnPres</span>
<a name="ln-2974"></a>        <span class="n">ENDIF</span>
<a name="ln-2975"></a>
<a name="ln-2976"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindDir</span> <span class="o">&gt;=</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2977"></a><span class="k">          </span><span class="n">WindDir</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">WindDir</span>
<a name="ln-2978"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">WindDir</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">WindDir</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2979"></a>        <span class="n">ENDIF</span>
<a name="ln-2980"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindDir</span> <span class="o">&lt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">WindDir</span> <span class="o">&gt;</span> <span class="mi">36</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2981"></a><span class="k">          </span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindDir</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindDir</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2982"></a>        <span class="n">ENDIF</span>
<a name="ln-2983"></a>
<a name="ln-2984"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindSpeed</span> <span class="o">&gt;=</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2985"></a><span class="k">          </span><span class="n">WindSpeed</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">WindSpd</span>
<a name="ln-2986"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">WindSpd</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">WindSpd</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2987"></a>        <span class="n">ENDIF</span>
<a name="ln-2988"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WindSpeed</span> <span class="o">&lt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">WindSpeed</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2989"></a><span class="k">          </span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindSpd</span><span class="o">=</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindSpd</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2990"></a>        <span class="n">ENDIF</span>
<a name="ln-2991"></a>
<a name="ln-2992"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TotalSkyCover</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2993"></a><span class="k">          </span><span class="n">TotalSkyCover</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">TotSkyCvr</span>
<a name="ln-2994"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">TotSkyCvr</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">TotSkyCvr</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2995"></a>        <span class="n">ENDIF</span>
<a name="ln-2996"></a>
<a name="ln-2997"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OpaqueSkyCover</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2998"></a><span class="k">          </span><span class="n">OpaqueSkyCover</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">OpaqSkyCvr</span>
<a name="ln-2999"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">OpaqSkyCvr</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">OpaqSkyCvr</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3000"></a>        <span class="n">ENDIF</span>
<a name="ln-3001"></a>
<a name="ln-3002"></a>        <span class="c">! Some values are not used within EnergyPlus, don&#39;t keep stats on their missing data points.</span>
<a name="ln-3003"></a>
<a name="ln-3004"></a><span class="c">!        IF (Visibility &gt;= 9999.) THEN</span>
<a name="ln-3005"></a><span class="c">!          Visibility=Missing%Visibility</span>
<a name="ln-3006"></a><span class="c">!          Missed%Visibility=Missed%Visibility+1</span>
<a name="ln-3007"></a><span class="c">!        ENDIF</span>
<a name="ln-3008"></a>
<a name="ln-3009"></a><span class="c">!        IF (CeilHeight &gt;= 99999.) THEN</span>
<a name="ln-3010"></a><span class="c">!          CeilHeight=Missing%Ceiling</span>
<a name="ln-3011"></a><span class="c">!         Missed%Ceiling=Missed%Ceiling+1</span>
<a name="ln-3012"></a><span class="c">!        ENDIF</span>
<a name="ln-3013"></a>
<a name="ln-3014"></a><span class="c">!        IF (PrecipWater &gt;= 999.) THEN</span>
<a name="ln-3015"></a><span class="c">!          PrecipWater=Missing%PrecipWater</span>
<a name="ln-3016"></a><span class="c">!          Missed%PrecipWater=Missed%PrecipWater+1</span>
<a name="ln-3017"></a><span class="c">!        ENDIF</span>
<a name="ln-3018"></a>
<a name="ln-3019"></a><span class="c">!        IF (AerosolOptDepth &gt;= .999) THEN</span>
<a name="ln-3020"></a><span class="c">!          AerosolOptDepth=Missing%AerOptDepth</span>
<a name="ln-3021"></a><span class="c">!         Missed%AerOptDepth=Missed%AerOptDepth+1</span>
<a name="ln-3022"></a><span class="c">!        ENDIF</span>
<a name="ln-3023"></a>
<a name="ln-3024"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SnowDepth</span> <span class="o">&gt;=</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3025"></a><span class="k">          </span><span class="n">SnowDepth</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">SnowDepth</span>
<a name="ln-3026"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">SnowDepth</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">SnowDepth</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3027"></a>        <span class="n">ENDIF</span>
<a name="ln-3028"></a>
<a name="ln-3029"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Albedo</span> <span class="o">&gt;=</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3030"></a><span class="k">          </span><span class="n">Albedo</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">Albedo</span>
<a name="ln-3031"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">Albedo</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">Albedo</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3032"></a>        <span class="n">ENDIF</span>
<a name="ln-3033"></a>
<a name="ln-3034"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">LiquidPrecip</span> <span class="o">&gt;=</span> <span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3035"></a><span class="k">          </span><span class="n">LiquidPrecip</span><span class="o">=</span><span class="n">Missing</span><span class="p">%</span><span class="n">LiquidPrecip</span>
<a name="ln-3036"></a>          <span class="n">Missed</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3037"></a>          <span class="n">LiquidPrecip</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3038"></a>        <span class="n">ENDIF</span>
<a name="ln-3039"></a>
<a name="ln-3040"></a>
<a name="ln-3041"></a><span class="c">!        IF (DaysSinceLastSnow &gt;= 99) THEN</span>
<a name="ln-3042"></a><span class="c">!          DaysSinceLastSnow=Missing%DaysLastSnow</span>
<a name="ln-3043"></a><span class="c">!          Missed%DaysLastSnow=Missed%DaysLastSnow+1</span>
<a name="ln-3044"></a><span class="c">!        ENDIF</span>
<a name="ln-3045"></a>
<a name="ln-3046"></a>        <span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">DryBulb</span>
<a name="ln-3047"></a>        <span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">DewPoint</span>
<a name="ln-3048"></a>        <span class="n">TomorrowOutBaroPress</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">AtmPress</span>
<a name="ln-3049"></a>        <span class="n">TomorrowOutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">RelHum</span>
<a name="ln-3050"></a>        <span class="n">RelHum</span><span class="o">=</span><span class="n">RelHum</span><span class="o">*</span><span class="p">.</span><span class="mi">01</span><span class="n">d0</span>
<a name="ln-3051"></a>        <span class="n">TomorrowWindSpeed</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">WindSpeed</span>
<a name="ln-3052"></a>        <span class="n">TomorrowWindDir</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">WindDir</span>
<a name="ln-3053"></a>        <span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">LiquidPrecip</span>
<a name="ln-3054"></a>        <span class="n">TomorrowHorizIRSky</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">IRHoriz</span>
<a name="ln-3055"></a>
<a name="ln-3056"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3057"></a>          <span class="c">! Calculate sky temperature, use IRHoriz if not missing</span>
<a name="ln-3058"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IRHoriz</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3059"></a>            <span class="c">! Missing, use sky cover</span>
<a name="ln-3060"></a>            <span class="n">OSky</span><span class="o">=</span><span class="n">OpaqueSkyCover</span>
<a name="ln-3061"></a>            <span class="n">TDewK</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">DryBulb</span><span class="p">,</span><span class="n">DewPoint</span><span class="p">)</span><span class="o">+</span><span class="n">TKelvin</span>
<a name="ln-3062"></a>            <span class="n">ESky</span><span class="o">=</span> <span class="p">(.</span><span class="mi">787</span><span class="n">d0</span> <span class="o">+</span><span class="p">.</span><span class="mi">764</span><span class="n">d0</span><span class="o">*</span><span class="nb">LOG</span><span class="p">((</span><span class="n">TDewK</span><span class="p">)</span><span class="o">/</span><span class="n">TKelvin</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="p">.</span><span class="mi">0224</span><span class="n">d0</span><span class="o">*</span><span class="n">OSky</span> <span class="o">-</span> <span class="mf">0.0035d0</span><span class="o">*</span><span class="p">(</span><span class="n">OSky</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">.</span><span class="mi">00028</span><span class="n">d0</span><span class="o">*</span><span class="p">(</span><span class="n">OSky</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3063"></a>            <span class="n">SkyTemp</span><span class="o">=</span><span class="p">(</span><span class="n">DryBulb</span><span class="o">+</span><span class="n">TKelvin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ESky</span><span class="o">**</span><span class="p">.</span><span class="mi">25</span><span class="n">d0</span><span class="p">)</span><span class="o">-</span><span class="n">TKelvin</span>
<a name="ln-3064"></a>          <span class="k">ELSE</span>  <span class="c">! Valid IR from Sky</span>
<a name="ln-3065"></a>            <span class="n">SkyTemp</span><span class="o">=</span><span class="p">(</span><span class="n">IRHoriz</span><span class="o">/</span><span class="n">Sigma</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">25</span><span class="n">d0</span> <span class="o">-</span><span class="n">TKelvin</span>
<a name="ln-3066"></a>          <span class="n">ENDIF</span>
<a name="ln-3067"></a>        <span class="k">ELSE</span>
<a name="ln-3068"></a><span class="k">          </span><span class="n">SkyTemp</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! dealt with later</span>
<a name="ln-3069"></a>        <span class="n">ENDIF</span>
<a name="ln-3070"></a>
<a name="ln-3071"></a>        <span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">SkyTemp</span>
<a name="ln-3072"></a>
<a name="ln-3073"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ETHoriz</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="n">ETHoriz</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3074"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ETDirect</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="n">ETDirect</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3075"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GLBHoriz</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="n">GLBHoriz</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3076"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DirectRad</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="n">DirectRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3077"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DiffuseRad</span> <span class="o">&gt;=</span> <span class="mi">999</span><span class="mf">9.d0</span><span class="p">)</span> <span class="n">DiffuseRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3078"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GLBHorizIllum</span> <span class="o">&gt;=</span> <span class="mi">99990</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">GLBHorizIllum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3079"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DirectNrmIllum</span> <span class="o">&gt;=</span> <span class="mi">99990</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">DirectNrmIllum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3080"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DiffuseHorizIllum</span> <span class="o">&gt;=</span> <span class="mi">99990</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">DiffuseHorizIllum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3081"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZenLum</span> <span class="o">&gt;=</span> <span class="mi">9999</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">ZenLum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3082"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IgnoreSolarRadiation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3083"></a><span class="k">          </span><span class="n">GLBHoriz</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3084"></a>          <span class="n">DirectRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3085"></a>          <span class="n">DiffuseRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3086"></a>        <span class="n">ENDIF</span>
<a name="ln-3087"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IgnoreBeamRadiation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3088"></a><span class="k">          </span><span class="n">DirectRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3089"></a>        <span class="n">ENDIF</span>
<a name="ln-3090"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IgnoreDiffuseRadiation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3091"></a><span class="k">          </span><span class="n">DiffuseRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3092"></a>        <span class="n">ENDIF</span>
<a name="ln-3093"></a>
<a name="ln-3094"></a>        <span class="n">TomorrowBeamSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">DirectRad</span>
<a name="ln-3095"></a>        <span class="n">TomorrowDifSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="n">DiffuseRad</span>
<a name="ln-3096"></a>
<a name="ln-3097"></a>        <span class="n">TomorrowIsRain</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3098"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PresWeathObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3099"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PresWeathConds</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">9</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3100"></a>              <span class="n">PresWeathConds</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">9</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3101"></a>              <span class="n">PresWeathConds</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">9</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3102"></a>                <span class="n">TomorrowIsRain</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3103"></a>        <span class="k">ELSE</span>
<a name="ln-3104"></a><span class="k">          </span><span class="n">TomorrowIsRain</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3105"></a>        <span class="n">ENDIF</span>
<a name="ln-3106"></a>        <span class="n">TomorrowIsSnow</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">SnowDepth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3107"></a>
<a name="ln-3108"></a>         <span class="c">! default if rain but none on weather file</span>
<a name="ln-3109"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TomorrowIsRain</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3110"></a>            <span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-3111"></a>            <span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">CurTimeStep</span><span class="p">)</span><span class="o">=</span><span class="mf">2.0d0</span> <span class="c">! 2mm in an hour ~ .08 inch</span>
<a name="ln-3112"></a>
<a name="ln-3113"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">DryBulb</span><span class="o">=</span><span class="n">DryBulb</span>
<a name="ln-3114"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">DewPoint</span><span class="o">=</span><span class="n">DewPoint</span>
<a name="ln-3115"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">RelHumid</span><span class="o">=</span><span class="n">RelHum</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-3116"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">StnPres</span><span class="o">=</span><span class="n">AtmPress</span>
<a name="ln-3117"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">WindDir</span><span class="o">=</span><span class="n">WindDir</span>
<a name="ln-3118"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">WindSpd</span><span class="o">=</span><span class="n">WindSpeed</span>
<a name="ln-3119"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">TotSkyCvr</span><span class="o">=</span><span class="n">TotalSkyCover</span>
<a name="ln-3120"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">OpaqSkyCvr</span><span class="o">=</span><span class="n">OpaqueSkyCover</span>
<a name="ln-3121"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">Visibility</span><span class="o">=</span><span class="n">Visibility</span>
<a name="ln-3122"></a>        <span class="n">Missing</span><span class="p">%</span><span class="nb">Ceiling</span><span class="o">=</span><span class="n">CeilHeight</span>
<a name="ln-3123"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">PrecipWater</span><span class="o">=</span><span class="n">PrecipWater</span>
<a name="ln-3124"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">AerOptDepth</span><span class="o">=</span><span class="n">AerosolOptDepth</span>
<a name="ln-3125"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">SnowDepth</span><span class="o">=</span><span class="n">SnowDepth</span>
<a name="ln-3126"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">DaysLastSnow</span><span class="o">=</span><span class="n">DaysSinceLastSnow</span>
<a name="ln-3127"></a>        <span class="n">Missing</span><span class="p">%</span><span class="n">Albedo</span><span class="o">=</span><span class="n">Albedo</span>
<a name="ln-3128"></a><span class="c">!        Missing%LiquidPrecip=LiquidPrecip</span>
<a name="ln-3129"></a>
<a name="ln-3130"></a>      <span class="n">ENDDO</span>  <span class="c">! CurTimeStep Loop</span>
<a name="ln-3131"></a>
<a name="ln-3132"></a>    <span class="n">ENDDO</span>  <span class="c">! Hour Loop</span>
<a name="ln-3133"></a>
<a name="ln-3134"></a>  <span class="n">ENDDO</span>  <span class="c">! Try Again While Loop</span>
<a name="ln-3135"></a>
<a name="ln-3136"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BackSpaceAfterRead</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3137"></a><span class="k">    BACKSPACE</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">)</span>
<a name="ln-3138"></a>  <span class="n">ENDIF</span>
<a name="ln-3139"></a>
<a name="ln-3140"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumIntervalsPerHour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">NumOfTimeStepInHour</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3141"></a>    <span class="c">! Create interpolated weather for timestep orientation</span>
<a name="ln-3142"></a>    <span class="c">! First copy ts=1 (hourly) from data arrays to Wthr structure</span>
<a name="ln-3143"></a>    <span class="k">DO </span><span class="n">Hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-3144"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">OutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3145"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">OutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3146"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">OutBaroPress</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutBaroPress</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3147"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">OutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3148"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">WindSpeed</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowWindSpeed</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3149"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">WindDir</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowWindDir</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3150"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">SkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3151"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">HorizIRSky</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowHorizIRSky</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3152"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">BeamSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowBeamSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3153"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">DifSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowDifSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3154"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">IsRain</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowIsRain</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3155"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">IsSnow</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowIsSnow</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3156"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">Albedo</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowAlbedo</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3157"></a>      <span class="n">Wthr</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3158"></a>    <span class="n">ENDDO</span>
<a name="ln-3159"></a>
<a name="ln-3160"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">LastHourSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3161"></a>    <span class="c">! For first day of weather, all time steps of the first hour will be</span>
<a name="ln-3162"></a>    <span class="c">! equal to the first hour&#39;s value.</span>
<a name="ln-3163"></a>      <span class="n">LastHrOutDryBulbTemp</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutDryBulbTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3164"></a>      <span class="n">LastHrOutDewPointTemp</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutDewPointTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3165"></a>      <span class="n">LastHrOutBaroPress</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutBaroPress</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3166"></a>      <span class="n">LastHrOutRelHum</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutRelHum</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3167"></a>      <span class="n">LastHrWindSpeed</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">WindSpeed</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3168"></a>      <span class="n">LastHrWindDir</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">WindDir</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3169"></a>      <span class="n">LastHrSkyTemp</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">SkyTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3170"></a>      <span class="n">LastHrHorizIRSky</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">HorizIRSky</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3171"></a>      <span class="n">LastHrBeamSolarRad</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">BeamSolarRad</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3172"></a>      <span class="n">LastHrDifSolarRad</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">DifSolarRad</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3173"></a>      <span class="n">LastHrAlbedo</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">Albedo</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3174"></a>      <span class="n">LastHrLiquidPrecip</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3175"></a>      <span class="n">LastHourSet</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3176"></a>    <span class="n">ENDIF</span>
<a name="ln-3177"></a>
<a name="ln-3178"></a>    <span class="k">DO </span><span class="n">Hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-3179"></a>
<a name="ln-3180"></a>      <span class="n">NxtHour</span> <span class="o">=</span> <span class="n">Hour</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3181"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Hour</span> <span class="o">==</span> <span class="mi">24</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3182"></a><span class="k">        </span><span class="n">NxtHour</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3183"></a>      <span class="k">END IF</span>
<a name="ln-3184"></a><span class="k">      </span><span class="n">NextHrBeamSolarRad</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">BeamSolarRad</span><span class="p">(</span><span class="n">NxtHour</span><span class="p">)</span>
<a name="ln-3185"></a>      <span class="n">NextHrDifSolarRad</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">DifSolarRad</span><span class="p">(</span><span class="n">NxtHour</span><span class="p">)</span>
<a name="ln-3186"></a>      <span class="n">NextHrLiquidPrecip</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="p">(</span><span class="n">NxtHour</span><span class="p">)</span>
<a name="ln-3187"></a>
<a name="ln-3188"></a>      <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-3189"></a>
<a name="ln-3190"></a>        <span class="n">WtNow</span><span class="o">=</span><span class="n">Interpolation</span><span class="p">(</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-3191"></a>        <span class="n">WtPrevHour</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span><span class="n">WtNow</span>
<a name="ln-3192"></a>
<a name="ln-3193"></a>        <span class="c">! Do Solar &quot;weighting&quot;</span>
<a name="ln-3194"></a>
<a name="ln-3195"></a>        <span class="n">WgtHourNow</span><span class="o">=</span><span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-3196"></a>
<a name="ln-3197"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3198"></a><span class="k">          </span><span class="n">WgtNextHour</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">WgtHourNow</span>
<a name="ln-3199"></a>          <span class="n">WgtPrevHour</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3200"></a>        <span class="k">ELSE</span>
<a name="ln-3201"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WgtHourNow</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3202"></a>            <span class="c">!  It&#39;s at the half hour</span>
<a name="ln-3203"></a>            <span class="n">WgtNextHour</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3204"></a>            <span class="n">WgtPrevHour</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3205"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TS</span><span class="o">*</span><span class="n">TimeStepFraction</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">5</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3206"></a><span class="k">            </span><span class="n">WgtNextHour</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3207"></a>            <span class="n">WgtPrevHour</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">WgtHourNow</span>
<a name="ln-3208"></a>          <span class="k">ELSE</span>  <span class="c">! After the half hour</span>
<a name="ln-3209"></a>            <span class="n">WgtPrevHour</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3210"></a>            <span class="n">WgtNextHour</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">WgtHourNow</span>
<a name="ln-3211"></a>          <span class="n">ENDIF</span>
<a name="ln-3212"></a>        <span class="n">ENDIF</span>
<a name="ln-3213"></a>
<a name="ln-3214"></a>        <span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span> <span class="n">LastHrOutDryBulbTemp</span><span class="o">*</span><span class="n">WtPrevHour</span> <span class="p">&amp;</span>
<a name="ln-3215"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">OutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3216"></a>        <span class="n">TomorrowOutBaroPress</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>   <span class="o">=</span> <span class="n">LastHrOutBaroPress</span><span class="o">*</span><span class="n">WtPrevHour</span>   <span class="p">&amp;</span>
<a name="ln-3217"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">OutBaroPress</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3218"></a>        <span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span> <span class="n">LastHrOutDewPointTemp</span><span class="o">*</span><span class="n">WtPrevHour</span> <span class="p">&amp;</span>
<a name="ln-3219"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">OutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3220"></a>        <span class="n">TomorrowOutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>      <span class="o">=</span> <span class="n">LastHrOutRelHum</span><span class="o">*</span><span class="n">WtPrevHour</span>      <span class="p">&amp;</span>
<a name="ln-3221"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">OutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3222"></a>        <span class="n">TomorrowWindSpeed</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>      <span class="o">=</span> <span class="n">LastHrWindSpeed</span><span class="o">*</span><span class="n">WtPrevHour</span>      <span class="p">&amp;</span>
<a name="ln-3223"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">WindSpeed</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3224"></a>        <span class="n">TomorrowWindDir</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>        <span class="o">=</span> <span class="n">LastHrWindDir</span><span class="o">*</span><span class="n">WtPrevHour</span>        <span class="p">&amp;</span>
<a name="ln-3225"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">WindDir</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3226"></a>        <span class="n">TomorrowHorizIRSky</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>     <span class="o">=</span> <span class="n">LastHrHorizIRSky</span><span class="o">*</span><span class="n">WtPrevHour</span>        <span class="p">&amp;</span>
<a name="ln-3227"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">HorizIRSky</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3228"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3229"></a><span class="k">          </span><span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>        <span class="o">=</span> <span class="n">LastHrSkyTemp</span><span class="o">*</span><span class="n">WtPrevHour</span>        <span class="p">&amp;</span>
<a name="ln-3230"></a>                                            <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">SkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3231"></a>        <span class="n">ENDIF</span>
<a name="ln-3232"></a>        <span class="n">TomorrowDifSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>    <span class="o">=</span> <span class="n">LastHrDifSolarRad</span><span class="o">*</span><span class="n">WgtPrevHour</span>    <span class="p">&amp;</span>
<a name="ln-3233"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">DifSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WgtHourNow</span>  <span class="p">&amp;</span>
<a name="ln-3234"></a>                                          <span class="o">+</span> <span class="n">NextHrDifSolarRad</span><span class="o">*</span><span class="n">WgtNextHour</span>
<a name="ln-3235"></a>        <span class="n">TomorrowBeamSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>   <span class="o">=</span> <span class="n">LastHrBeamSolarRad</span><span class="o">*</span><span class="n">WgtPrevHour</span>   <span class="p">&amp;</span>
<a name="ln-3236"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">BeamSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WgtHourNow</span> <span class="p">&amp;</span>
<a name="ln-3237"></a>                                          <span class="o">+</span> <span class="n">NextHrBeamSolarRad</span><span class="o">*</span><span class="n">WgtNextHour</span>
<a name="ln-3238"></a>
<a name="ln-3239"></a>        <span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>   <span class="o">=</span> <span class="n">LastHrLiquidPrecip</span><span class="o">*</span><span class="n">WtPrevHour</span>        <span class="p">&amp;</span>
<a name="ln-3240"></a>                                          <span class="o">+</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span><span class="o">*</span><span class="n">WtNow</span>
<a name="ln-3241"></a>        <span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>   <span class="o">=</span> <span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3242"></a>
<a name="ln-3243"></a>        <span class="n">TomorrowIsRain</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>         <span class="o">=</span> <span class="p">(</span><span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">.</span><span class="mi">8</span><span class="n">d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span>  <span class="c">!Wthr%IsRain(Hour)</span>
<a name="ln-3244"></a>        <span class="n">TomorrowIsSnow</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>         <span class="o">=</span> <span class="n">Wthr</span><span class="p">%</span><span class="n">IsSnow</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3245"></a>      <span class="n">ENDDO</span>  <span class="c">! End of TS Loop</span>
<a name="ln-3246"></a>
<a name="ln-3247"></a>      <span class="n">LastHrOutDryBulbTemp</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3248"></a>      <span class="n">LastHrOutDewPointTemp</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3249"></a>      <span class="n">LastHrOutBaroPress</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutBaroPress</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3250"></a>      <span class="n">LastHrOutRelHum</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">OutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3251"></a>      <span class="n">LastHrWindSpeed</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">WindSpeed</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3252"></a>      <span class="n">LastHrWindDir</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">WindDir</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3253"></a>      <span class="n">LastHrSkyTemp</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">SkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3254"></a>      <span class="n">LastHrBeamSolarRad</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">BeamSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3255"></a>      <span class="n">LastHrDifSolarRad</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">DifSolarRad</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3256"></a>      <span class="n">LastHrAlbedo</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">Albedo</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3257"></a>      <span class="n">LastHrLiquidPrecip</span><span class="o">=</span><span class="n">Wthr</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="p">(</span><span class="n">Hour</span><span class="p">)</span>
<a name="ln-3258"></a>
<a name="ln-3259"></a>    <span class="n">ENDDO</span>  <span class="c">! End of Hour Loop</span>
<a name="ln-3260"></a>
<a name="ln-3261"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3262"></a><span class="k">      SELECT CASE</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">CalculationType</span><span class="p">)</span>
<a name="ln-3263"></a>
<a name="ln-3264"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">WP_ScheduleValue</span><span class="p">)</span>
<a name="ln-3265"></a>          <span class="k">CALL </span><span class="n">GetScheduleValuesForDay</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3266"></a>                              <span class="n">TomorrowSkyTemp</span><span class="p">,</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfYear</span><span class="p">,</span><span class="n">CurDayOfWeek</span><span class="p">)</span>
<a name="ln-3267"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">WP_DryBulbDelta</span><span class="p">)</span>
<a name="ln-3268"></a>          <span class="k">CALL </span><span class="n">GetScheduleValuesForDay</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3269"></a>                              <span class="n">TomorrowSkyTemp</span><span class="p">,</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfYear</span><span class="p">,</span><span class="n">CurDayOfWeek</span><span class="p">)</span>
<a name="ln-3270"></a>          <span class="k">DO </span><span class="n">Hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-3271"></a>            <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-3272"></a>              <span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">-</span><span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-3273"></a>            <span class="n">ENDDO</span>
<a name="ln-3274"></a>          <span class="n">ENDDO</span>
<a name="ln-3275"></a>
<a name="ln-3276"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">WP_DewPointDelta</span><span class="p">)</span>
<a name="ln-3277"></a>          <span class="k">CALL </span><span class="n">GetScheduleValuesForDay</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Environ</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3278"></a>                              <span class="n">TomorrowSkyTemp</span><span class="p">,</span><span class="n">TomorrowVariables</span><span class="p">%</span><span class="n">DayOfYear</span><span class="p">,</span><span class="n">CurDayOfWeek</span><span class="p">)</span>
<a name="ln-3279"></a>          <span class="k">DO </span><span class="n">Hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-3280"></a>            <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-3281"></a>              <span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">-</span><span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-3282"></a>            <span class="n">ENDDO</span>
<a name="ln-3283"></a>          <span class="n">ENDDO</span>
<a name="ln-3284"></a>
<a name="ln-3285"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3286"></a>
<a name="ln-3287"></a>      <span class="k">END SELECT</span>
<a name="ln-3288"></a>
<a name="ln-3289"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-3290"></a>  <span class="n">ENDIF</span>
<a name="ln-3291"></a>
<a name="ln-3292"></a>  <span class="k">RETURN</span>
<a name="ln-3293"></a>
<a name="ln-3294"></a><span class="k">CONTAINS</span>
<a name="ln-3295"></a><span class="k">  SUBROUTINE </span><span class="n">SetDayOfWeekInitialValues</span><span class="p">(</span><span class="n">EnvironDayOfWeek</span><span class="p">,</span><span class="n">CurDayOfWeek</span><span class="p">,</span><span class="n">UseDayOfWeek</span><span class="p">)</span>
<a name="ln-3296"></a>
<a name="ln-3297"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3298"></a>            <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-3299"></a>            <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-3300"></a>            <span class="c">!       MODIFIED       na</span>
<a name="ln-3301"></a>            <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3304"></a>            <span class="c">! Set of begin day of week for an environment.  Similar sets but slightly different</span>
<a name="ln-3305"></a>            <span class="c">! conditions.  Improve code readability by having three routine calls instead of three</span>
<a name="ln-3306"></a>            <span class="c">! IF blocks.</span>
<a name="ln-3307"></a>
<a name="ln-3308"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3309"></a>            <span class="c">! na</span>
<a name="ln-3310"></a>
<a name="ln-3311"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-3312"></a>            <span class="c">! na</span>
<a name="ln-3313"></a>
<a name="ln-3314"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-3315"></a>            <span class="c">! na</span>
<a name="ln-3316"></a>
<a name="ln-3317"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3318"></a>
<a name="ln-3319"></a>            <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3320"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnvironDayOfWeek</span> <span class="c">! Starting Day of Week for the (Weather) RunPeriod (User Input)</span>
<a name="ln-3321"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurDayOfWeek</span>     <span class="c">! Current Day of Week</span>
<a name="ln-3322"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UseDayOfWeek</span>     <span class="c">! hmmm does not appear to be used anywhere.</span>
<a name="ln-3323"></a>
<a name="ln-3324"></a>            <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3325"></a>            <span class="c">! na</span>
<a name="ln-3326"></a>
<a name="ln-3327"></a>            <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3328"></a>            <span class="c">! na</span>
<a name="ln-3329"></a>
<a name="ln-3330"></a>            <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3331"></a>            <span class="c">! na</span>
<a name="ln-3332"></a>
<a name="ln-3333"></a>            <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3334"></a>            <span class="c">! na</span>
<a name="ln-3335"></a>
<a name="ln-3336"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">EnvironDayOfWeek</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3337"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">EnvironDayOfWeek</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3338"></a><span class="k">        </span><span class="n">CurDayOfWeek</span><span class="o">=</span><span class="n">EnvironDayOfWeek</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3339"></a>      <span class="k">ELSE</span>
<a name="ln-3340"></a><span class="k">        </span><span class="n">CurDayOfWeek</span><span class="o">=</span><span class="n">EnvironDayOfWeek</span>
<a name="ln-3341"></a>      <span class="n">ENDIF</span>
<a name="ln-3342"></a>      <span class="n">UseDayOfWeek</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3343"></a>    <span class="k">ELSE</span>
<a name="ln-3344"></a><span class="k">      </span><span class="n">UseDayOfWeek</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3345"></a>    <span class="n">ENDIF</span>
<a name="ln-3346"></a>
<a name="ln-3347"></a>  <span class="k">RETURN</span>
<a name="ln-3348"></a>
<a name="ln-3349"></a><span class="k">  END SUBROUTINE </span><span class="n">SetDayOfWeekInitialValues</span>
<a name="ln-3350"></a>
<a name="ln-3351"></a><span class="k">END SUBROUTINE </span><span class="n">ReadEPlusWeatherForDay</span>
<a name="ln-3352"></a>
<a name="ln-3353"></a><span class="k">SUBROUTINE </span><span class="n">InterpretWeatherDataLine</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="n">ErrorFound</span><span class="p">,</span><span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">Whour</span><span class="p">,</span><span class="n">WMinute</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3354"></a>              <span class="n">RField1</span><span class="p">,</span><span class="n">RField2</span><span class="p">,</span><span class="n">RField3</span><span class="p">,</span><span class="n">RField4</span><span class="p">,</span><span class="n">RField5</span><span class="p">,</span><span class="n">RField6</span><span class="p">,</span><span class="n">RField7</span><span class="p">,</span><span class="n">RField8</span><span class="p">,</span><span class="n">RField9</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3355"></a>              <span class="n">RField10</span><span class="p">,</span><span class="n">RField11</span><span class="p">,</span><span class="n">RField12</span><span class="p">,</span><span class="n">RField13</span><span class="p">,</span><span class="n">RField14</span><span class="p">,</span><span class="n">RField15</span><span class="p">,</span><span class="n">RField16</span><span class="p">,</span><span class="n">RField17</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3356"></a>              <span class="n">RField18</span><span class="p">,</span><span class="n">RField19</span><span class="p">,</span><span class="n">RField20</span><span class="p">,</span><span class="n">WObs</span><span class="p">,</span><span class="n">WCodesArr</span><span class="p">,</span><span class="n">RField22</span><span class="p">,</span><span class="n">RField23</span><span class="p">,</span><span class="n">RField24</span><span class="p">,</span><span class="n">RField25</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3357"></a>              <span class="n">RField26</span><span class="p">,</span><span class="n">RField27</span><span class="p">)</span>
<a name="ln-3358"></a>
<a name="ln-3359"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3360"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-3361"></a>          <span class="c">!       DATE WRITTEN   April 2001</span>
<a name="ln-3362"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3363"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3364"></a>
<a name="ln-3365"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3366"></a>          <span class="c">! This subroutine interprets the EPW weather data line because comma delimited fields</span>
<a name="ln-3367"></a>          <span class="c">! may cause problems with some compilers.  (Particularly character variables in</span>
<a name="ln-3368"></a>          <span class="c">! comma delimited lines.</span>
<a name="ln-3369"></a>
<a name="ln-3370"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3371"></a>          <span class="c">! Field by field interpretation, eliminating the &quot;data source field&quot; which is also</span>
<a name="ln-3372"></a>          <span class="c">! likely to contain blanks.  Note that the &quot;Weatherconditions&quot; must be a 9 character</span>
<a name="ln-3373"></a>          <span class="c">! alpha field with no intervening blanks.</span>
<a name="ln-3374"></a>
<a name="ln-3375"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3376"></a>          <span class="c">! CALL InterpretWeatherDataLine(WeatherDataLine,ErrorFound,WYear,WMonth,WDay,WHour,WMinute,  &amp;</span>
<a name="ln-3377"></a>          <span class="c">!       DryBulb,DewPoint,RelHum,AtmPress,ETHoriz,ETDirect,IRHoriz,GLBHoriz,            &amp;</span>
<a name="ln-3378"></a>          <span class="c">!       DirectRad,DiffuseRad,GLBHorizIllum,DirectNrmIllum,DiffuseHorizIllum,ZenLum,    &amp;</span>
<a name="ln-3379"></a>          <span class="c">!       WindDir,WindSpeed,TotalSkyCover,OpaqueSkyCover,Visibility,CeilHeight,          &amp;</span>
<a name="ln-3380"></a>          <span class="c">!       PresWeathObs,PresWeathConds,PrecipWater,AerosolOptDepth,SnowDepth,DaysSinceLastSnow,</span>
<a name="ln-3381"></a>          <span class="c">!       Albedo,LiquidPrecipDepth)</span>
<a name="ln-3382"></a>
<a name="ln-3383"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3384"></a>          <span class="c">! na</span>
<a name="ln-3385"></a>
<a name="ln-3386"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3387"></a>
<a name="ln-3388"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3389"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Line</span>
<a name="ln-3390"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ErrorFound</span>
<a name="ln-3391"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WYear</span>
<a name="ln-3392"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WMonth</span>
<a name="ln-3393"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WDay</span>
<a name="ln-3394"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Whour</span>
<a name="ln-3395"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WMinute</span>
<a name="ln-3396"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField1</span>            <span class="c">!       DryBulb</span>
<a name="ln-3397"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField2</span>            <span class="c">!       DewPoint</span>
<a name="ln-3398"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField3</span>            <span class="c">!       RelHum</span>
<a name="ln-3399"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField4</span>            <span class="c">!       AtmPress</span>
<a name="ln-3400"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField5</span>            <span class="c">!       ETHoriz</span>
<a name="ln-3401"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField6</span>            <span class="c">!       ETDirect</span>
<a name="ln-3402"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField7</span>            <span class="c">!       IRHoriz</span>
<a name="ln-3403"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField8</span>            <span class="c">!       GLBHoriz</span>
<a name="ln-3404"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField9</span>            <span class="c">!       DirectRad</span>
<a name="ln-3405"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField10</span>           <span class="c">!       DiffuseRad</span>
<a name="ln-3406"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField11</span>           <span class="c">!       GLBHorizIllum</span>
<a name="ln-3407"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField12</span>           <span class="c">!       DirectNrmIllum</span>
<a name="ln-3408"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField13</span>           <span class="c">!       DiffuseHorizIllum</span>
<a name="ln-3409"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField14</span>           <span class="c">!       ZenLum</span>
<a name="ln-3410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField15</span>           <span class="c">!       WindDir</span>
<a name="ln-3411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField16</span>           <span class="c">!       WindSpeed</span>
<a name="ln-3412"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField17</span>           <span class="c">!       TotalSkyCover</span>
<a name="ln-3413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField18</span>           <span class="c">!       OpaqueSkyCover</span>
<a name="ln-3414"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField19</span>           <span class="c">!       Visibility</span>
<a name="ln-3415"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField20</span>           <span class="c">!       CeilHeight</span>
<a name="ln-3416"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WObs</span>               <span class="c">!       PresWeathObs</span>
<a name="ln-3417"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span><span class="n">WCodesArr</span>       <span class="c">!       PresWeathConds</span>
<a name="ln-3418"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField22</span>           <span class="c">!       PrecipWater</span>
<a name="ln-3419"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField23</span>           <span class="c">!       AerosolOptDepth</span>
<a name="ln-3420"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField24</span>           <span class="c">!       SnowDepth</span>
<a name="ln-3421"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField25</span>           <span class="c">!       DaysSinceLastSnow</span>
<a name="ln-3422"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField26</span>           <span class="c">!       Albedo</span>
<a name="ln-3423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RField27</span>           <span class="c">!       LiquidPrecip</span>
<a name="ln-3424"></a>
<a name="ln-3425"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3426"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValidDigits</span><span class="o">=</span><span class="s1">&#39;0123456789&#39;</span>
<a name="ln-3427"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3428"></a>          <span class="c">! na</span>
<a name="ln-3429"></a>
<a name="ln-3430"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3431"></a>          <span class="c">! na</span>
<a name="ln-3432"></a>
<a name="ln-3433"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3434"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">LEN</span><span class="p">(</span><span class="n">Line</span><span class="p">))</span> <span class="kd">::</span> <span class="n">SaveLine</span>
<a name="ln-3435"></a>  <span class="kt">INTEGER </span><span class="n">Pos</span>
<a name="ln-3436"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="n">PresWeathCodes</span>
<a name="ln-3437"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">RYear</span>
<a name="ln-3438"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">RMonth</span>
<a name="ln-3439"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">RDay</span>
<a name="ln-3440"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">RHour</span>
<a name="ln-3441"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">RMinute</span>
<a name="ln-3442"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="n">DateError</span>
<a name="ln-3443"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">RField21</span>
<a name="ln-3444"></a>  <span class="kt">INTEGER </span><span class="nb">Count</span>
<a name="ln-3445"></a><span class="nb">  </span><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">LCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3446"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DateInError</span>
<a name="ln-3447"></a>
<a name="ln-3448"></a>  <span class="n">LCount</span><span class="o">=</span><span class="n">LCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3449"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">StripCR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3450"></a><span class="k">    </span><span class="n">Pos</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-3451"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="p">:</span><span class="n">Pos</span><span class="p">))</span> <span class="o">==</span> <span class="n">iASCII_CR</span><span class="p">)</span> <span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="p">:</span><span class="n">Pos</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-3452"></a>  <span class="n">ENDIF</span>
<a name="ln-3453"></a>  <span class="n">ErrorFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3454"></a>  <span class="n">SaveLine</span><span class="o">=</span><span class="n">Line</span>   <span class="c">! in case of errors</span>
<a name="ln-3455"></a>
<a name="ln-3456"></a>  <span class="c">! Do the first five.  (To get to the DataSource field)</span>
<a name="ln-3457"></a>  <span class="k">READ</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span> <span class="n">RYear</span><span class="p">,</span><span class="n">RMonth</span><span class="p">,</span><span class="n">RDay</span><span class="p">,</span><span class="n">RHour</span><span class="p">,</span><span class="n">RMinute</span>
<a name="ln-3458"></a>  <span class="n">WYear</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RYear</span><span class="p">)</span>
<a name="ln-3459"></a>  <span class="n">WMonth</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RMonth</span><span class="p">)</span>
<a name="ln-3460"></a>  <span class="n">WDay</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RDay</span><span class="p">)</span>
<a name="ln-3461"></a>  <span class="n">WHour</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RHour</span><span class="p">)</span>
<a name="ln-3462"></a>  <span class="n">WMinute</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RMinute</span><span class="p">)</span>
<a name="ln-3463"></a>
<a name="ln-3464"></a>  <span class="n">DateInError</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3465"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WMonth</span> <span class="o">&gt;=</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WMonth</span> <span class="o">&lt;=</span><span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3466"></a>    <span class="c">! Month number is valid</span>
<a name="ln-3467"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WMonth</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3468"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WDay</span> <span class="o">&gt;</span> <span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3469"></a><span class="k">        </span><span class="n">DateInError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3470"></a>      <span class="n">ENDIF</span>
<a name="ln-3471"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WDay</span> <span class="o">&gt;</span> <span class="n">EndDayOfMonth</span><span class="p">(</span><span class="n">WMonth</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Whether actually used is determined by calling routine.</span>
<a name="ln-3472"></a>      <span class="n">DateInError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3473"></a>    <span class="n">ENDIF</span>
<a name="ln-3474"></a>  <span class="k">ELSE</span>
<a name="ln-3475"></a><span class="k">    </span><span class="n">DateInError</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3476"></a>  <span class="n">ENDIF</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DateInError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3479"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Reading Weather Data Line, Invalid Date, Year=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WYear</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3480"></a>        <span class="s1">&#39;, Month=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Day=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WDay</span><span class="p">)))</span>
<a name="ln-3481"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminates due to previous condition.&#39;</span><span class="p">)</span>
<a name="ln-3482"></a>  <span class="n">ENDIF</span>
<a name="ln-3483"></a>
<a name="ln-3484"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c">! WYear</span>
<a name="ln-3485"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3486"></a><span class="k">    GOTO </span><span class="mi">902</span>
<a name="ln-3487"></a>  <span class="n">ENDIF</span>
<a name="ln-3488"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3489"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c">! WMonth</span>
<a name="ln-3490"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3491"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c">! WDay</span>
<a name="ln-3492"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3493"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c">! WHour</span>
<a name="ln-3494"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3495"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c">! WMinute</span>
<a name="ln-3496"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3497"></a>
<a name="ln-3498"></a>  <span class="c">! Data Source/Integrity field -- ignore</span>
<a name="ln-3499"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3500"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3501"></a>
<a name="ln-3502"></a>  <span class="c">! Now read more numerics with List Directed I/O (note there is another &quot;character&quot; field lurking)</span>
<a name="ln-3503"></a>  <span class="k">READ</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField1</span><span class="p">,</span><span class="n">RField2</span><span class="p">,</span><span class="n">RField3</span><span class="p">,</span><span class="n">RField4</span><span class="p">,</span><span class="n">RField5</span><span class="p">,</span><span class="n">RField6</span><span class="p">,</span><span class="n">RField7</span><span class="p">,</span><span class="n">RField8</span><span class="p">,</span><span class="n">RField9</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-3504"></a>               <span class="n">RField10</span><span class="p">,</span><span class="n">RField11</span><span class="p">,</span><span class="n">RField12</span><span class="p">,</span><span class="n">RField13</span><span class="p">,</span><span class="n">RField14</span><span class="p">,</span><span class="n">RField15</span><span class="p">,</span><span class="n">RField16</span><span class="p">,</span><span class="n">RField17</span><span class="p">,</span><span class="n">RField18</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3505"></a>               <span class="n">RField19</span><span class="p">,</span><span class="n">RField20</span><span class="p">,</span><span class="n">RField21</span>
<a name="ln-3506"></a>  <span class="k">DO </span><span class="nb">Count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span>
<a name="ln-3507"></a>    <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3508"></a>    <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3509"></a>  <span class="n">ENDDO</span>
<a name="ln-3510"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3511"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Pos</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3512"></a><span class="k">    </span><span class="n">PresWeathCodes</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3513"></a>  <span class="k">ELSE</span>
<a name="ln-3514"></a><span class="k">    </span><span class="n">PresWeathCodes</span><span class="o">=</span><span class="s1">&#39;999999999&#39;</span>
<a name="ln-3515"></a>  <span class="n">ENDIF</span>
<a name="ln-3516"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3517"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3518"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3519"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3520"></a><span class="k">      READ</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField22</span>
<a name="ln-3521"></a>    <span class="k">ELSE</span>
<a name="ln-3522"></a><span class="k">      </span><span class="n">RField22</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3523"></a>    <span class="n">ENDIF</span>
<a name="ln-3524"></a>    <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3525"></a>    <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3526"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3527"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3528"></a><span class="k">        READ</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField23</span>
<a name="ln-3529"></a>      <span class="k">ELSE</span>
<a name="ln-3530"></a><span class="k">        </span><span class="n">RField23</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3531"></a>      <span class="n">ENDIF</span>
<a name="ln-3532"></a>      <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3533"></a>      <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3534"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3535"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3536"></a><span class="k">          READ</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField24</span>
<a name="ln-3537"></a>        <span class="k">ELSE</span>
<a name="ln-3538"></a><span class="k">          </span><span class="n">RField24</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3539"></a>        <span class="n">ENDIF</span>
<a name="ln-3540"></a>        <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3541"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3542"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3543"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3544"></a><span class="k">            READ</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField25</span>
<a name="ln-3545"></a>          <span class="k">ELSE</span>
<a name="ln-3546"></a><span class="k">            </span><span class="n">RField25</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3547"></a>          <span class="n">ENDIF</span>
<a name="ln-3548"></a>          <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3549"></a>          <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3550"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3551"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3552"></a><span class="k">              READ</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField26</span>
<a name="ln-3553"></a>            <span class="k">ELSE</span>
<a name="ln-3554"></a><span class="k">              </span><span class="n">RField26</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3555"></a>            <span class="n">ENDIF</span>
<a name="ln-3556"></a>            <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3557"></a>            <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3558"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3559"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3560"></a><span class="k">                READ</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField27</span>
<a name="ln-3561"></a>              <span class="k">ELSE</span>
<a name="ln-3562"></a><span class="k">                </span><span class="n">RField27</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3563"></a>              <span class="n">ENDIF</span>
<a name="ln-3564"></a>              <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-3565"></a>              <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-3566"></a>            <span class="k">ELSE</span>
<a name="ln-3567"></a><span class="k">              </span><span class="n">RField27</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3568"></a>            <span class="n">ENDIF</span>
<a name="ln-3569"></a>          <span class="k">ELSE</span>
<a name="ln-3570"></a><span class="k">            </span><span class="n">RField26</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3571"></a>            <span class="n">RField27</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3572"></a>          <span class="n">ENDIF</span>
<a name="ln-3573"></a>        <span class="k">ELSE</span>
<a name="ln-3574"></a><span class="k">          READ</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField25</span>
<a name="ln-3575"></a>          <span class="n">RField26</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3576"></a>          <span class="n">RField27</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3577"></a>        <span class="n">ENDIF</span>
<a name="ln-3578"></a>      <span class="k">ELSE</span>
<a name="ln-3579"></a><span class="k">        READ</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField24</span>
<a name="ln-3580"></a>        <span class="n">RField25</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3581"></a>        <span class="n">RField26</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3582"></a>        <span class="n">RField27</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3583"></a>      <span class="n">ENDIF</span>
<a name="ln-3584"></a>    <span class="k">ELSE</span>
<a name="ln-3585"></a><span class="k">      READ</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField23</span>
<a name="ln-3586"></a>      <span class="n">RField24</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3587"></a>      <span class="n">RField25</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3588"></a>      <span class="n">RField26</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3589"></a>      <span class="n">RField27</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3590"></a>    <span class="n">ENDIF</span>
<a name="ln-3591"></a>  <span class="k">ELSE</span>
<a name="ln-3592"></a><span class="k">    READ</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="n">err</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span> <span class="n">RField22</span>
<a name="ln-3593"></a>    <span class="n">RField23</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3594"></a>    <span class="n">RField24</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3595"></a>    <span class="n">RField25</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3596"></a>    <span class="n">RField26</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3597"></a>    <span class="n">RField27</span><span class="o">=</span><span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-3598"></a>  <span class="n">ENDIF</span>
<a name="ln-3599"></a><span class="c">!  READ(Line,*,err=903,end=903) RField22,RField23,RField24,RField25</span>
<a name="ln-3600"></a>
<a name="ln-3601"></a>  <span class="n">WObs</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RField21</span><span class="p">)</span>
<a name="ln-3602"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Obs Indicator indicates Weather Codes valid</span>
<a name="ln-3603"></a>    <span class="c">! Check for miscellaneous characters</span>
<a name="ln-3604"></a>    <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">PresWeathCodes</span><span class="p">,</span><span class="s1">&#39;&#39;&#39;&#39;</span><span class="p">)</span>
<a name="ln-3605"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-3606"></a>      <span class="n">PresWeathCodes</span><span class="p">(</span><span class="n">Pos</span><span class="p">:</span><span class="n">Pos</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-3607"></a>      <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">PresWeathCodes</span><span class="p">,</span><span class="s1">&#39;&#39;&#39;&#39;</span><span class="p">)</span>
<a name="ln-3608"></a>    <span class="n">ENDDO</span>
<a name="ln-3609"></a>    <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">PresWeathCodes</span><span class="p">,</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3610"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-3611"></a>      <span class="n">PresWeathCodes</span><span class="p">(</span><span class="n">Pos</span><span class="p">:</span><span class="n">Pos</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-3612"></a>      <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">PresWeathCodes</span><span class="p">,</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3613"></a>    <span class="n">ENDDO</span>
<a name="ln-3614"></a>    <span class="n">PresWeathCodes</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">PresWeathCodes</span><span class="p">)</span>
<a name="ln-3615"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">PresWeathCodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3616"></a><span class="k">      DO </span><span class="n">Pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span>
<a name="ln-3617"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">ValidDigits</span><span class="p">,</span><span class="n">PresWeathCodes</span><span class="p">(</span><span class="n">Pos</span><span class="p">:</span><span class="n">Pos</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">PresWeathCodes</span><span class="p">(</span><span class="n">Pos</span><span class="p">:</span><span class="n">Pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;9&#39;</span>
<a name="ln-3618"></a>      <span class="n">ENDDO</span>
<a name="ln-3619"></a>      <span class="k">READ</span><span class="p">(</span><span class="n">PresWeathCodes</span><span class="p">,</span><span class="s1">&#39;(9I1)&#39;</span><span class="p">)</span> <span class="n">WCodesArr</span>
<a name="ln-3620"></a>    <span class="k">ELSE</span>
<a name="ln-3621"></a><span class="k">      </span><span class="n">Missed</span><span class="p">%</span><span class="n">WeathCodes</span><span class="o">=</span><span class="n">Missed</span><span class="p">%</span><span class="n">WeathCodes</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3622"></a>      <span class="n">WCodesArr</span><span class="o">=</span><span class="mi">9</span>
<a name="ln-3623"></a>    <span class="n">ENDIF</span>
<a name="ln-3624"></a>  <span class="k">ELSE</span>
<a name="ln-3625"></a><span class="k">    </span><span class="n">WCodesArr</span><span class="o">=</span><span class="mi">9</span>
<a name="ln-3626"></a>  <span class="n">ENDIF</span>
<a name="ln-3627"></a>
<a name="ln-3628"></a>
<a name="ln-3629"></a>  <span class="k">RETURN</span>
<a name="ln-3630"></a>
<a name="ln-3631"></a><span class="k">  </span><span class="mi">900</span> <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid Date info in Weather Line&#39;</span><span class="p">)</span>
<a name="ln-3632"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entire Data Line=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SaveLine</span><span class="p">))</span>
<a name="ln-3633"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Error in Reading Weather Data&#39;</span><span class="p">)</span>
<a name="ln-3634"></a>
<a name="ln-3635"></a>  <span class="mi">901</span> <span class="k">WRITE</span><span class="p">(</span><span class="n">DateError</span><span class="p">,</span><span class="s2">&quot;(I4,&#39;/&#39;,I2,&#39;/&#39;,I2,&#39; Hour#=&#39;,I2,&#39; Min#=&#39;,I2)&quot;</span><span class="p">)</span> <span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span>
<a name="ln-3636"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid Weather Line at date=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DateError</span><span class="p">))</span>
<a name="ln-3637"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Full Data Line=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SaveLine</span><span class="p">))</span>
<a name="ln-3638"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Remainder of line=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">))</span>
<a name="ln-3639"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Error in Reading Weather Data&#39;</span><span class="p">)</span>
<a name="ln-3640"></a>
<a name="ln-3641"></a>  <span class="mi">902</span> <span class="k">WRITE</span><span class="p">(</span><span class="n">DateError</span><span class="p">,</span><span class="s2">&quot;(I4,&#39;/&#39;,I2,&#39;/&#39;,I2,&#39; Hour#=&#39;,I2,&#39; Min#=&#39;,I2)&quot;</span><span class="p">)</span> <span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span>
<a name="ln-3642"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid Weather Line (no commas) at date=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DateError</span><span class="p">))</span>
<a name="ln-3643"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Full Data Line=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SaveLine</span><span class="p">))</span>
<a name="ln-3644"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Remainder of line=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">))</span>
<a name="ln-3645"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Error in Reading Weather Data&#39;</span><span class="p">)</span>
<a name="ln-3646"></a>
<a name="ln-3647"></a>  <span class="mi">903</span> <span class="k">WRITE</span><span class="p">(</span><span class="n">DateError</span><span class="p">,</span><span class="s2">&quot;(I4,&#39;/&#39;,I2,&#39;/&#39;,I2,&#39; Hour#=&#39;,I2,&#39; Min#=&#39;,I2)&quot;</span><span class="p">)</span> <span class="n">WYear</span><span class="p">,</span><span class="n">WMonth</span><span class="p">,</span><span class="n">WDay</span><span class="p">,</span><span class="n">WHour</span><span class="p">,</span><span class="n">WMinute</span>
<a name="ln-3648"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid Weather Line at date=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DateError</span><span class="p">))</span>
<a name="ln-3649"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Full Data Line=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SaveLine</span><span class="p">))</span>
<a name="ln-3650"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Partial line read; Remainder of line=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">))</span>
<a name="ln-3651"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Error in Reading Weather Data&#39;</span><span class="p">)</span>
<a name="ln-3652"></a>
<a name="ln-3653"></a><span class="k">END SUBROUTINE </span><span class="n">InterpretWeatherDataLine</span>
<a name="ln-3654"></a>
<a name="ln-3655"></a><span class="k">SUBROUTINE </span><span class="n">SetUpDesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)</span>
<a name="ln-3656"></a>
<a name="ln-3657"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3658"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-3659"></a>          <span class="c">!       DATE WRITTEN   February 1977</span>
<a name="ln-3660"></a>          <span class="c">!       MODIFIED       June 1997 (RKS); May 2013 (LKL) add temperature profile for drybulb.</span>
<a name="ln-3661"></a>          <span class="c">!       RE-ENGINEERED  August 2003;LKL -- to generate timestep weather for design days.</span>
<a name="ln-3662"></a>
<a name="ln-3663"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3664"></a>          <span class="c">! This purpose of this subroutine is to convert the user supplied input</span>
<a name="ln-3665"></a>          <span class="c">! values for the design day parameters into an entire weather day</span>
<a name="ln-3666"></a>          <span class="c">! record.  This now bypasses any file I/O by keeping all of the</span>
<a name="ln-3667"></a>          <span class="c">! weather day record information in the local module level derived type</span>
<a name="ln-3668"></a>          <span class="c">! called DesignDay.</span>
<a name="ln-3669"></a>
<a name="ln-3670"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3671"></a>          <span class="c">! Methodology incorporates the design day setup from Tarp as appropriate.</span>
<a name="ln-3672"></a>
<a name="ln-3673"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3674"></a>          <span class="c">! ASHRAE Handbook of Fundamentals?</span>
<a name="ln-3675"></a>
<a name="ln-3676"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3677"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">JulianDay</span>
<a name="ln-3678"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">MakeUPPERcase</span>
<a name="ln-3679"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">GetSingleDayScheduleValues</span>
<a name="ln-3680"></a>
<a name="ln-3681"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3682"></a>
<a name="ln-3683"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3684"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnvrnNum</span>  <span class="c">! Environment number passed into the routine</span>
<a name="ln-3685"></a>
<a name="ln-3686"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3687"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">GlobalSolarConstant</span><span class="o">=</span><span class="mi">136</span><span class="mf">7.d0</span>
<a name="ln-3688"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZHGlobalSolarConstant</span><span class="o">=</span><span class="mi">135</span><span class="mf">5.d0</span>
<a name="ln-3689"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvDDHdFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;! &lt;Environment:Design Day Data&gt;, Max Dry-Bulb Temp {C}, &#39;,  &amp;</span>
<a name="ln-3690"></a><span class="s2">                                                      &amp; &#39;Temp Range {dC}, Temp Range Ind Type, &#39;,  &amp;</span>
<a name="ln-3691"></a><span class="s2">                                                      &amp; &#39;Hum Ind Value at Max Temp, Hum Ind Type,Pressure {Pa}, &#39;,  &amp;</span>
<a name="ln-3692"></a><span class="s2">                                                      &amp; &#39;Wind Direction {deg CW from N}, &#39;,   &amp;</span>
<a name="ln-3693"></a><span class="s2">                                                      &amp; &#39;Wind Speed {m/s}, Clearness, Rain, Snow&#39;)&quot;</span>
<a name="ln-3694"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvDDayFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;Environment:Design Day Data,&#39;)&quot;</span>
<a name="ln-3695"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDayMiscHdFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;! &lt;Environment:Design_Day_Misc&gt;,DayOfYear,ASHRAE A Coeff,&#39;,  &amp;</span>
<a name="ln-3696"></a><span class="s2">                                                      &amp; &#39;ASHRAE B Coeff,ASHRAE C Coeff,Solar Constant-Annual Variation,&#39;,  &amp;</span>
<a name="ln-3697"></a><span class="s2">                                                      &amp; &#39;Eq of Time {minutes}, Solar Declination Angle {deg}, Solar Model&#39;)&quot;</span>
<a name="ln-3698"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DDayMiscFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;Environment:Design_Day_Misc,&#39;,I3,&#39;,&#39;)&quot;</span>
<a name="ln-3699"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmta</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span>
<a name="ln-3700"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MnDyFmt</span><span class="o">=</span><span class="s2">&quot;(I2.2,&#39;/&#39;,I2.2)&quot;</span>
<a name="ln-3701"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_C0</span><span class="o">=</span><span class="p">.</span><span class="mi">5598</span><span class="n">d0</span>  <span class="c">!37.6865d0</span>
<a name="ln-3702"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_C1</span><span class="o">=</span><span class="p">.</span><span class="mi">4982</span><span class="n">d0</span>  <span class="c">!13.9263d0</span>
<a name="ln-3703"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_C2</span><span class="o">=-</span><span class="p">.</span><span class="mi">6762</span><span class="n">d0</span> <span class="c">!-20.2354d0</span>
<a name="ln-3704"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_C3</span><span class="o">=</span><span class="p">.</span><span class="mi">02842</span><span class="n">d0</span> <span class="c">!0.9695d0</span>
<a name="ln-3705"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_C4</span><span class="o">=-</span><span class="p">.</span><span class="mi">00317</span><span class="n">d0</span> <span class="c">!-0.2046d0</span>
<a name="ln-3706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_C5</span><span class="o">=</span><span class="p">.</span><span class="mi">014</span><span class="n">d0</span>    <span class="c">!-0.0980d0</span>
<a name="ln-3707"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_D</span><span class="o">=-</span><span class="mi">1</span><span class="mf">7.853d0</span>  <span class="c">!-10.8568d0</span>
<a name="ln-3708"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZhangHuangModCoeff_K</span><span class="o">=</span><span class="p">.</span><span class="mi">843</span><span class="n">d0</span>  <span class="c">!49.3112d0</span>
<a name="ln-3709"></a>
<a name="ln-3710"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3711"></a>          <span class="c">! na</span>
<a name="ln-3712"></a>
<a name="ln-3713"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3714"></a>  <span class="k">TYPE </span><span class="n">HourlyWeatherData</span>
<a name="ln-3715"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BeamSolarRad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly direct normal solar irradiance</span>
<a name="ln-3716"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DifSolarRad</span>    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Hourly sky diffuse horizontal solar irradiance</span>
<a name="ln-3717"></a>  <span class="k">END TYPE</span>
<a name="ln-3718"></a>
<a name="ln-3719"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3720"></a>  <span class="kt">INTEGER  </span><span class="n">Hour</span>
<a name="ln-3721"></a>  <span class="kt">INTEGER  </span><span class="n">TS</span>
<a name="ln-3722"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="n">A</span>             <span class="c">! Apparent solar irradiation at air mass = 0</span>
<a name="ln-3723"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="n">AVSC</span>          <span class="c">! Annual variation in the solar constant</span>
<a name="ln-3724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="n">B</span>             <span class="c">! Atmospheric extinction coefficient</span>
<a name="ln-3725"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="n">C</span>             <span class="c">! ASHRAE diffuse radiation factor</span>
<a name="ln-3726"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="n">ETR</span>           <span class="c">! radiation of an extraterrestrial normal surface, W/m2</span>
<a name="ln-3727"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="n">HO</span>            <span class="c">! Radiation on an extraterrestial horizontal surface</span>
<a name="ln-3728"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="n">KT</span>            <span class="c">! Radiation ratio</span>
<a name="ln-3729"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>         <span class="c">! Sun direction cosines</span>
<a name="ln-3730"></a>  <span class="kt">INTEGER </span><span class="n">CurrentYear</span>
<a name="ln-3731"></a>  <span class="kt">INTEGER </span><span class="n">OSky</span>                <span class="c">! Opaque Sky Cover (tenths)</span>
<a name="ln-3732"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HumidityRatio</span>     <span class="c">! Humidity Ratio -- when constant for day</span>
<a name="ln-3733"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TDewK</span>             <span class="c">! Dewpoint in Kelvin</span>
<a name="ln-3734"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ESky</span>              <span class="c">! Emissivitity of Sky</span>
<a name="ln-3735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CosZenith</span>         <span class="c">! Cosine of Zenith Angle of Sun</span>
<a name="ln-3736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TotHoriz</span>          <span class="c">! Total Radiation on Horizontal Surface</span>
<a name="ln-3737"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">GndReflet</span>         <span class="c">! Ground Reflectivity</span>
<a name="ln-3738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CurTime</span>           <span class="c">! For Solar Calcs</span>
<a name="ln-3739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetBulb</span>           <span class="c">! For calculating</span>
<a name="ln-3740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DBRange</span>           <span class="c">! working copy of dry-bulb daily range, C (or 1 if input is difference)</span>
<a name="ln-3741"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WBRange</span>           <span class="c">! working copy of wet-bulb daily range. C (or 1 if input is difference)</span>
<a name="ln-3742"></a>
<a name="ln-3743"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Date0</span>
<a name="ln-3744"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">PrintDDHeader</span>
<a name="ln-3745"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="n">AlpUseRain</span>
<a name="ln-3746"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="n">AlpUseSnow</span>
<a name="ln-3747"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">LastHrBeamSolarRad</span>     <span class="c">! Direct normal solar irradiance</span>
<a name="ln-3748"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">LastHrDifSolarRad</span>      <span class="c">! Sky diffuse horizontal solar irradiance</span>
<a name="ln-3749"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">NextHrBeamSolarRad</span>     <span class="c">! Direct normal solar irradiance</span>
<a name="ln-3750"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">NextHrDifSolarRad</span>      <span class="c">! Sky diffuse horizontal solar irradiance</span>
<a name="ln-3751"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstantHumidityRatio</span>
<a name="ln-3752"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">OutHumRat</span>
<a name="ln-3753"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WgtHourNow</span>
<a name="ln-3754"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WgtPrevHour</span>
<a name="ln-3755"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WgtNextHour</span>
<a name="ln-3756"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StringOut</span>
<a name="ln-3757"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">HourlyWeatherData</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Wthr</span>
<a name="ln-3758"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SaveWarmupFlag</span>
<a name="ln-3759"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GloHorzRad</span>
<a name="ln-3760"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ClearnessIndex_kt</span>
<a name="ln-3761"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ClearnessIndex_ktc</span>
<a name="ln-3762"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ClearnessIndex_kds</span>
<a name="ln-3763"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinSolarAltitude</span>
<a name="ln-3764"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotSkyCover</span>
<a name="ln-3765"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Hour1Ago</span><span class="p">,</span><span class="n">Hour3Ago</span>
<a name="ln-3766"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BeamRad</span><span class="p">,</span> <span class="n">DiffRad</span>     <span class="c">! working calculated beam and diffuse rad, W/m2</span>
<a name="ln-3767"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">testval</span>
<a name="ln-3768"></a><span class="c">!     For reporting purposes, set year to current system year</span>
<a name="ln-3769"></a>   <span class="n">SaveWarmupFlag</span><span class="o">=</span><span class="n">WarmupFlag</span>
<a name="ln-3770"></a>   <span class="n">WarmupFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3771"></a>
<a name="ln-3772"></a>   <span class="k">CALL </span><span class="nb">DATE_AND_TIME</span><span class="p">(</span><span class="n">Values</span><span class="o">=</span><span class="n">Date0</span><span class="p">)</span>
<a name="ln-3773"></a>   <span class="n">CurrentYear</span><span class="o">=</span><span class="n">Date0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3774"></a>
<a name="ln-3775"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3776"></a><span class="k">     </span><span class="n">PrintDDHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3777"></a>   <span class="n">ENDIF</span>
<a name="ln-3778"></a>
<a name="ln-3779"></a>   <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Year</span> <span class="o">=</span> <span class="n">CurrentYear</span> <span class="c">! f90 date_and_time implemented. full 4 digit year !+ 1900</span>
<a name="ln-3780"></a>   <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span>
<a name="ln-3781"></a>   <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span>
<a name="ln-3782"></a>   <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfYear</span> <span class="o">=</span> <span class="n">JulianDay</span><span class="p">(</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="p">,</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-3783"></a>   <span class="k">WRITE</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">,</span><span class="n">MnDyFmt</span><span class="p">)</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span>
<a name="ln-3784"></a>   <span class="n">EnvironmentName</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-3785"></a>   <span class="n">RunPeriodEnvironment</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3786"></a>          <span class="c">! Following builds Environment start/end for ASHRAE 55 warnings</span>
<a name="ln-3787"></a>   <span class="n">EnvironmentStartEnd</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span>
<a name="ln-3788"></a>
<a name="ln-3789"></a>   <span class="c">! Check that barometric pressure is within range</span>
<a name="ln-3790"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressureEntered</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3791"></a><span class="k">     IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="o">-</span><span class="n">StdBaroPress</span><span class="p">)</span><span class="o">/</span><span class="n">StdBaroPress</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! 10% off</span>
<a name="ln-3792"></a>       <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SetUpDesignDay: Entered DesignDay Barometric Pressure=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3793"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-3794"></a>                             <span class="s1">&#39; differs by more than 10% from Standard Barometric Pressure=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3795"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-3796"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in DesignDay=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3797"></a>                              <span class="s1">&#39;, Standard Pressure (based on elevation) will be used.&#39;</span><span class="p">)</span>
<a name="ln-3798"></a>       <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="o">=</span><span class="n">StdBaroPress</span>
<a name="ln-3799"></a>     <span class="n">ENDIF</span>
<a name="ln-3800"></a>   <span class="k">ELSE</span>
<a name="ln-3801"></a><span class="k">     </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="o">=</span><span class="n">StdBaroPress</span>
<a name="ln-3802"></a>   <span class="n">ENDIF</span>
<a name="ln-3803"></a>
<a name="ln-3804"></a>   <span class="c">! verify that design WB or DP &lt;= design DB</span>
<a name="ln-3805"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_Dewpoint</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DewpointNeedsSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3806"></a>     <span class="c">! dew-point</span>
<a name="ln-3807"></a>     <span class="n">testval</span><span class="o">=</span><span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-3808"></a>     <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="o">=</span><span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">testval</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-3809"></a>   <span class="n">ENDIF</span>
<a name="ln-3810"></a>
<a name="ln-3811"></a>   <span class="c">! Day of week defaults to Monday, if day type specified, then that is used.</span>
<a name="ln-3812"></a>   <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-3813"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayType</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span> <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayType</span>
<a name="ln-3814"></a>
<a name="ln-3815"></a>   <span class="c">! set Holiday as indicated by user input</span>
<a name="ln-3816"></a>   <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HolidayIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3817"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayType</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HolidayIndex</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayType</span><span class="o">-</span><span class="mi">7</span>
<a name="ln-3818"></a>
<a name="ln-3819"></a>   <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DaylightSavingIndex</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DSTIndicator</span>
<a name="ln-3820"></a>
<a name="ln-3821"></a>   <span class="c">!  Set up Solar parameters for day</span>
<a name="ln-3822"></a>   <span class="k">CALL </span><span class="n">CalculateDailySolarCoeffs</span><span class="p">(</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfYear</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">AVSC</span><span class="p">,</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">EquationOfTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3823"></a>                                 <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SinSolarDeclinAngle</span><span class="p">,</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">CosSolarDeclinAngle</span><span class="p">)</span>
<a name="ln-3824"></a>
<a name="ln-3825"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">PrintDDHeader</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3826"></a><span class="k">     WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvDDHdFormat</span><span class="p">)</span>
<a name="ln-3827"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">DDayMiscHdFormat</span><span class="p">)</span>
<a name="ln-3828"></a>     <span class="n">PrintDDHeader</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3829"></a>   <span class="n">ENDIF</span>
<a name="ln-3830"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DoWeatherInitReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3831"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RainInd</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3832"></a><span class="k">       </span><span class="n">AlpUseRain</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-3833"></a>     <span class="k">ELSE</span>
<a name="ln-3834"></a><span class="k">       </span><span class="n">AlpUseRain</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-3835"></a>     <span class="n">ENDIF</span>
<a name="ln-3836"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">SnowInd</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3837"></a><span class="k">       </span><span class="n">AlpUseSnow</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-3838"></a>     <span class="k">ELSE</span>
<a name="ln-3839"></a><span class="k">       </span><span class="n">AlpUseSnow</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-3840"></a>     <span class="n">ENDIF</span>
<a name="ln-3841"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">EnvDDayFormat</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-3842"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3843"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3844"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DailyDBRange</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3845"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3846"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3847"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">==</span> <span class="n">DDDBRangeType_Default</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3848"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;DefaultMultipliers,&#39;</span>
<a name="ln-3849"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">==</span> <span class="n">DDDBRangeType_Multiplier</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3850"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;MultiplierSchedule,&#39;</span>
<a name="ln-3851"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">==</span> <span class="n">DDDBRangeType_Profile</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3852"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;TemperatureProfile,&#39;</span>
<a name="ln-3853"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">==</span> <span class="n">DDDBRangeType_Difference</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3854"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;DifferenceSchedule,&#39;</span>
<a name="ln-3855"></a>     <span class="n">ENDIF</span>
<a name="ln-3856"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span>
<a name="ln-3857"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_Wetbulb</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3858"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;Wetbulb,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; {C},&#39;</span>
<a name="ln-3859"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_Dewpoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3860"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;Dewpoint,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; {C},&#39;</span>
<a name="ln-3861"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_Enthalpy</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3862"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;Enthalpy,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; {kJ/kg},&#39;</span>
<a name="ln-3863"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_HumRatio</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3864"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;HumidityRatio,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; {},&#39;</span>
<a name="ln-3865"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_RelHumSch</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3866"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;Schedule,&lt;schedule values from 0.0 to 100.0 {percent},&#39;</span>
<a name="ln-3867"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDef</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3868"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;WetBulbProfileDefaultMultipliers,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; {C},&#39;</span>
<a name="ln-3869"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDif</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3870"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;WetBulbProfileDifferenceSchedule,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; {C},&#39;</span>
<a name="ln-3871"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfMul</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3872"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;WetBulbProfileMultiplierSchedule,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; {C},&#39;</span>
<a name="ln-3873"></a>     <span class="n">ENDIF</span>
<a name="ln-3874"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-3875"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3876"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">WindDir</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-3877"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3878"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">WindSpeed</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3879"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3880"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">SkyClear</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3881"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3882"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="n">AlpUseRain</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="n">AlpUseSnow</span>
<a name="ln-3883"></a>
<a name="ln-3884"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">DDayMiscFormat</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfYear</span>
<a name="ln-3885"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3886"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3887"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3888"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3889"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3890"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3891"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AVSC</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3892"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3893"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">EquationOfTime</span><span class="o">*</span><span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3894"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3895"></a>     <span class="n">StringOut</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">ASIN</span><span class="p">(</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SinSolarDeclinAngle</span><span class="p">)</span><span class="o">/</span><span class="n">DegToRadians</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3896"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span>
<a name="ln-3897"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">ASHRAE_ClearSky</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3898"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;ASHRAEClearSky&#39;</span>
<a name="ln-3899"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">Zhang_Huang</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3900"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;ZhangHuang&#39;</span>
<a name="ln-3901"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">SolarModel_Schedule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3902"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;User supplied beam/diffuse from schedules&#39;</span>
<a name="ln-3903"></a>     <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">ASHRAE_Tau</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3904"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;ASHRAETau&#39;</span>
<a name="ln-3905"></a>     <span class="k">ELSE</span>
<a name="ln-3906"></a><span class="k">       </span><span class="n">StringOut</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span>
<a name="ln-3907"></a>     <span class="n">ENDIF</span>
<a name="ln-3908"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">StringOut</span><span class="p">)</span>
<a name="ln-3909"></a>   <span class="n">ENDIF</span>
<a name="ln-3910"></a>
<a name="ln-3911"></a>
<a name="ln-3912"></a>   <span class="c">! Must set up weather values for Design Day.  User can specify the &quot;humidity indicator&quot; as</span>
<a name="ln-3913"></a>   <span class="c">! Wetbulb, DewPoint or input the relative humidity schedule.  For both wetbulb and dewpoint indicators, the</span>
<a name="ln-3914"></a>   <span class="c">! humidity for the day will be constant, using the drybulb (max) and humidity indicator temperature to</span>
<a name="ln-3915"></a>   <span class="c">! set the values.  For the scheduled values, these are already set in the DDxxx array.</span>
<a name="ln-3916"></a>
<a name="ln-3917"></a>   <span class="n">CurrentTime</span><span class="o">=</span><span class="mi">2</span><span class="mf">5.0d0</span>
<a name="ln-3918"></a>
<a name="ln-3919"></a>   <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">HumIndType</span><span class="p">)</span>
<a name="ln-3920"></a>
<a name="ln-3921"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_Wetbulb</span><span class="p">)</span>
<a name="ln-3922"></a>     <span class="n">HumidityRatio</span><span class="o">=</span><span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-3923"></a>                          <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-3924"></a>                          <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">,</span><span class="s1">&#39;SetUpDesignDay:PsyWFnTdbTwbPb&#39;</span><span class="p">)</span>
<a name="ln-3925"></a>     <span class="n">ConstantHumidityRatio</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3926"></a>
<a name="ln-3927"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_Dewpoint</span><span class="p">)</span>
<a name="ln-3928"></a>     <span class="n">HumidityRatio</span><span class="o">=</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-3929"></a>                          <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">,</span><span class="s1">&#39;SetUpDesignDay:PsyWFnTdpPb&#39;</span><span class="p">)</span>
<a name="ln-3930"></a>     <span class="n">ConstantHumidityRatio</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3931"></a>
<a name="ln-3932"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_HumRatio</span><span class="p">)</span>
<a name="ln-3933"></a>     <span class="n">HumidityRatio</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span>
<a name="ln-3934"></a>     <span class="n">ConstantHumidityRatio</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3935"></a>
<a name="ln-3936"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_Enthalpy</span><span class="p">)</span>
<a name="ln-3937"></a>     <span class="n">HumidityRatio</span><span class="o">=</span><span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3938"></a>        <span class="s1">&#39;SetUpDesignDay:PsyWFnTdbH&#39;</span><span class="p">)</span>
<a name="ln-3939"></a>     <span class="n">ConstantHumidityRatio</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3940"></a>
<a name="ln-3941"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_RelHumSch</span><span class="p">)</span>
<a name="ln-3942"></a>     <span class="c">! nothing to do -- DDHumIndModifier already contains the scheduled Relative Humidity</span>
<a name="ln-3943"></a>     <span class="n">ConstantHumidityRatio</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3944"></a>     <span class="n">TomorrowOutRelHum</span><span class="o">=</span><span class="n">DDHumIndModifier</span><span class="p">(</span> <span class="n">EnvrnNum</span><span class="p">,:,:)</span>
<a name="ln-3945"></a>
<a name="ln-3946"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_WBProfDef</span><span class="p">,</span> <span class="n">DDHumIndType_WBProfDif</span><span class="p">,</span> <span class="n">DDHumIndType_WBProfMul</span><span class="p">)</span>
<a name="ln-3947"></a>     <span class="n">ConstantHumidityRatio</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3948"></a>
<a name="ln-3949"></a>   <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3950"></a>     <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetUpDesignDay: Invalid Humidity Indicator type&#39;</span><span class="p">)</span>
<a name="ln-3951"></a>     <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurred in Design Day=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="p">))</span>
<a name="ln-3952"></a>
<a name="ln-3953"></a>   <span class="k">END SELECT</span>
<a name="ln-3954"></a>
<a name="ln-3955"></a><span class="k">   IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">RainInd</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3956"></a><span class="k">     </span><span class="n">TomorrowIsRain</span><span class="p">(:,:)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3957"></a>     <span class="n">OSky</span><span class="o">=</span><span class="mi">10</span>
<a name="ln-3958"></a>     <span class="n">TomorrowLiquidPrecip</span><span class="o">=</span><span class="mf">3.0d0</span>
<a name="ln-3959"></a>   <span class="k">ELSE</span>
<a name="ln-3960"></a><span class="k">     </span><span class="n">TomorrowIsRain</span><span class="p">(:,:)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3961"></a>     <span class="n">OSky</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3962"></a>     <span class="n">TomorrowLiquidPrecip</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3963"></a>   <span class="n">ENDIF</span>
<a name="ln-3964"></a>
<a name="ln-3965"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SnowInd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3966"></a><span class="k">     </span><span class="n">TomorrowIsSnow</span><span class="p">(:,:)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3967"></a>     <span class="n">GndReflet</span><span class="o">=</span><span class="p">.</span><span class="mi">2</span><span class="n">d0</span>
<a name="ln-3968"></a>   <span class="k">ELSE</span>  <span class="c">! Snow</span>
<a name="ln-3969"></a>     <span class="n">TomorrowIsSnow</span><span class="p">(:,:)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3970"></a>     <span class="n">GndReflet</span> <span class="o">=</span> <span class="p">.</span><span class="mi">7</span><span class="n">d0</span>
<a name="ln-3971"></a>   <span class="n">ENDIF</span>
<a name="ln-3972"></a>
<a name="ln-3973"></a>   <span class="c">! Some values are constant</span>
<a name="ln-3974"></a>
<a name="ln-3975"></a>   <span class="n">TomorrowOutBaroPress</span><span class="p">(:,:)</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span>
<a name="ln-3976"></a>   <span class="n">TomorrowWindSpeed</span><span class="p">(:,:)</span>    <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-3977"></a>   <span class="n">TomorrowWindDir</span><span class="p">(:,:)</span>      <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WindDir</span>
<a name="ln-3978"></a>   <span class="n">TomorrowAlbedo</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3979"></a>
<a name="ln-3980"></a>   <span class="c">! resolve daily ranges</span>
<a name="ln-3981"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">==</span> <span class="n">DDDBRangeType_Difference</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3982"></a><span class="k">      </span><span class="n">DBRange</span> <span class="o">=</span> <span class="mf">1.d0</span>      <span class="c">! use unscaled multiplier values if difference</span>
<a name="ln-3983"></a>   <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">==</span> <span class="n">DDDBRangeType_Profile</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3984"></a><span class="k">      </span><span class="n">DBRange</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3985"></a>   <span class="k">ELSE</span>
<a name="ln-3986"></a><span class="k">      </span><span class="n">DBRange</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DailyDBRange</span>
<a name="ln-3987"></a>   <span class="n">ENDIF</span>
<a name="ln-3988"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDif</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3989"></a><span class="k">      </span><span class="n">WBRange</span> <span class="o">=</span> <span class="mf">1.d0</span>      <span class="c">! use unscaled multiplier values if difference</span>
<a name="ln-3990"></a>   <span class="k">ELSE</span>
<a name="ln-3991"></a><span class="k">      </span><span class="n">WBRange</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DailyWBRange</span>
<a name="ln-3992"></a>   <span class="n">ENDIF</span>
<a name="ln-3993"></a>
<a name="ln-3994"></a>   <span class="k">DO </span><span class="n">Hour</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-3995"></a>     <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-3996"></a>
<a name="ln-3997"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">/=</span> <span class="n">DDDBRangeType_Profile</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3998"></a>         <span class="c">! dry-bulb profile</span>
<a name="ln-3999"></a>         <span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span> <span class="o">-</span> <span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">*</span><span class="n">DBRange</span>
<a name="ln-4000"></a>       <span class="k">ELSE</span> <span class="c">! DesDayInput(EnvrnNum)%DBTempRangeType == DDDBRangeType_Profile</span>
<a name="ln-4001"></a>         <span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4002"></a>       <span class="n">ENDIF</span>
<a name="ln-4003"></a>
<a name="ln-4004"></a>
<a name="ln-4005"></a>       <span class="c">! wet-bulb - generate from profile, humidity ratio, or dew point</span>
<a name="ln-4006"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDef</span>         <span class="p">&amp;</span>
<a name="ln-4007"></a>        <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDif</span>       <span class="p">&amp;</span>
<a name="ln-4008"></a>        <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfMul</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4009"></a><span class="k">         </span><span class="n">WetBulb</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">-</span> <span class="n">DDHumIndModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">*</span><span class="n">WBRange</span>
<a name="ln-4010"></a>         <span class="n">WetBulb</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">WetBulb</span><span class="p">,</span> <span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">))</span>   <span class="c">! WB must be &lt;= DB</span>
<a name="ln-4011"></a>         <span class="n">OutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4012"></a>                              <span class="n">WetBulb</span><span class="p">,</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-4013"></a>         <span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">OutHumRat</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-4014"></a>         <span class="n">TomorrowOutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span><span class="n">OutHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4015"></a>                                               <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">,</span><span class="s1">&#39;WeatherManager&#39;</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-4016"></a>       <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ConstantHumidityRatio</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4017"></a>       <span class="c">!  Need Dew Point Temperature.  Use Relative Humidity to get Humidity Ratio, unless Humidity Ratio is constant</span>
<a name="ln-4018"></a>        <span class="c">!BG 9-26-07  moved following inside this IF statment; when HumIndType is &#39;Schedule&#39; HumidityRatio wasn&#39;t being initialized</span>
<a name="ln-4019"></a>         <span class="n">WetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span><span class="n">HumidityRatio</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4020"></a>         <span class="s1">&#39;WeatherManager.f90 subroutine SetUpDesignDay&#39;</span><span class="p">)</span>
<a name="ln-4021"></a>
<a name="ln-4022"></a>         <span class="n">OutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-4023"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">HumidityRatio</span> <span class="o">&gt;</span> <span class="n">OutHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4024"></a><span class="k">           </span><span class="n">WetBulb</span><span class="o">=</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4025"></a>         <span class="k">ELSE</span>
<a name="ln-4026"></a><span class="k">           </span><span class="n">OutHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4027"></a>                              <span class="n">WetBulb</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-4028"></a>         <span class="n">ENDIF</span>
<a name="ln-4029"></a>         <span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">OutHumRat</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-4030"></a>         <span class="n">TomorrowOutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">PsyRhFnTdbWPb</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span><span class="n">OutHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4031"></a>                                               <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">,</span><span class="s1">&#39;WeatherManager&#39;</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-4032"></a>       <span class="k">ELSE</span>
<a name="ln-4033"></a><span class="k">         </span><span class="n">HumidityRatio</span><span class="o">=</span><span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span><span class="n">DDHumIndModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4034"></a>                                               <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-4035"></a>         <span class="c">! TomorrowOutRelHum values set earlier</span>
<a name="ln-4036"></a>         <span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">HumidityRatio</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span><span class="p">)</span>
<a name="ln-4037"></a>       <span class="n">ENDIF</span>
<a name="ln-4038"></a>
<a name="ln-4039"></a>       <span class="c">! Determine Sky Temp ==&gt;</span>
<a name="ln-4040"></a>       <span class="c">! Function of DryBulb, DewPoint, OpaqueSkyCover</span>
<a name="ln-4041"></a>       <span class="c">! Calculate Sky IR</span>
<a name="ln-4042"></a>       <span class="c">!HIR = ESKY * SIGMA * (TOUT**4)</span>
<a name="ln-4043"></a>       <span class="c">!</span>
<a name="ln-4044"></a>       <span class="c">!where</span>
<a name="ln-4045"></a>       <span class="c">!</span>
<a name="ln-4046"></a>       <span class="c">!HIR = horizontal IR intensity (W/m2)</span>
<a name="ln-4047"></a>       <span class="c">!ESKY = sky emissivity</span>
<a name="ln-4048"></a>       <span class="c">!SIGMA = Stefan-Boltzmann constant = 5.6697e-8 W/m2-K4</span>
<a name="ln-4049"></a>       <span class="c">!TOUT = drybulb temperature (K)</span>
<a name="ln-4050"></a>       <span class="c">!</span>
<a name="ln-4051"></a>       <span class="c">!The sky emissivity is given by</span>
<a name="ln-4052"></a>       <span class="c">!</span>
<a name="ln-4053"></a>       <span class="c">!ESKY = [0.787 + 0.764*ln(TDEW/273)]*[1 + 0.0224*N - 0.0035*(N**2) + 0.00028*(N**3)]</span>
<a name="ln-4054"></a>       <span class="c">!</span>
<a name="ln-4055"></a>       <span class="c">!where</span>
<a name="ln-4056"></a>       <span class="c">!</span>
<a name="ln-4057"></a>       <span class="c">!TDEW = dewpoint temperature (K)</span>
<a name="ln-4058"></a>       <span class="c">!N = opaque sky cover (tenths)</span>
<a name="ln-4059"></a>       <span class="c">!</span>
<a name="ln-4060"></a>       <span class="c">!Example: Clear sky (N=0), TOUT = 273+20=293K, TDEW = 273+10=283K:</span>
<a name="ln-4061"></a>       <span class="c">!</span>
<a name="ln-4062"></a>       <span class="c">!ESKY = 0.787 + 0.764*0.036 = 0.815</span>
<a name="ln-4063"></a>       <span class="c">!HIR = 0.815*5.6697e-8*(293**4) = 340.6 W/m2</span>
<a name="ln-4064"></a>
<a name="ln-4065"></a>       <span class="c">!References:</span>
<a name="ln-4066"></a>       <span class="c">!</span>
<a name="ln-4067"></a>       <span class="c">!George N. Walton, &quot;Thermal Analysis Research Program Reference Manual,&quot;</span>
<a name="ln-4068"></a>       <span class="c">!NBSIR 83-2655, March 1983, p. 21.</span>
<a name="ln-4069"></a>       <span class="c">!</span>
<a name="ln-4070"></a>       <span class="c">!G. Clark and C. Allen, &quot;The Estimation of Atmospheric Radiation for Clear and</span>
<a name="ln-4071"></a>       <span class="c">!Cloudy Skies,&quot; Proc. 2nd National Passive Solar Conference (AS/ISES), 1978, pp. 675-678.</span>
<a name="ln-4072"></a>
<a name="ln-4073"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4074"></a><span class="k">         </span><span class="n">TDewK</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span><span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">))</span><span class="o">+</span><span class="n">TKelvin</span>
<a name="ln-4075"></a>         <span class="n">ESky</span><span class="o">=</span> <span class="p">(.</span><span class="mi">787</span><span class="n">d0</span> <span class="o">+</span><span class="p">.</span><span class="mi">764</span><span class="n">d0</span><span class="o">*</span><span class="nb">LOG</span><span class="p">((</span><span class="n">TDewK</span><span class="p">)</span><span class="o">/</span><span class="n">TKelvin</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="p">.</span><span class="mi">0224</span><span class="n">d0</span><span class="o">*</span><span class="n">OSky</span> <span class="o">-</span> <span class="mf">0.0035d0</span><span class="o">*</span><span class="p">(</span><span class="n">OSky</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">.</span><span class="mi">00028</span><span class="n">d0</span><span class="o">*</span><span class="p">(</span><span class="n">OSky</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4076"></a>         <span class="n">TomorrowHorizIRSky</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">Esky</span><span class="o">*</span><span class="n">Sigma</span><span class="o">*</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">+</span><span class="n">TKelvin</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<a name="ln-4077"></a>         <span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">+</span><span class="n">TKelvin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ESky</span><span class="o">**</span><span class="p">.</span><span class="mi">25</span><span class="n">d0</span><span class="p">)</span><span class="o">-</span><span class="n">TKelvin</span>
<a name="ln-4078"></a>       <span class="k">ELSE</span>
<a name="ln-4079"></a><span class="k">         </span><span class="n">TDewK</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">),</span><span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">))</span><span class="o">+</span><span class="n">TKelvin</span>
<a name="ln-4080"></a>         <span class="n">ESky</span><span class="o">=</span> <span class="p">(.</span><span class="mi">787</span><span class="n">d0</span> <span class="o">+</span><span class="p">.</span><span class="mi">764</span><span class="n">d0</span><span class="o">*</span><span class="nb">LOG</span><span class="p">((</span><span class="n">TDewK</span><span class="p">)</span><span class="o">/</span><span class="n">TKelvin</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="p">.</span><span class="mi">0224</span><span class="n">d0</span><span class="o">*</span><span class="n">OSky</span> <span class="o">-</span> <span class="mf">0.0035d0</span><span class="o">*</span><span class="p">(</span><span class="n">OSky</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">.</span><span class="mi">00028</span><span class="n">d0</span><span class="o">*</span><span class="p">(</span><span class="n">OSky</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4081"></a>         <span class="n">TomorrowHorizIRSky</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">Esky</span><span class="o">*</span><span class="n">Sigma</span><span class="o">*</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">+</span><span class="n">TKelvin</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<a name="ln-4082"></a>       <span class="n">ENDIF</span>
<a name="ln-4083"></a>
<a name="ln-4084"></a>       <span class="c">! Generate solar values for timestep</span>
<a name="ln-4085"></a>       <span class="c">!    working results = BeamRad and DiffRad</span>
<a name="ln-4086"></a>       <span class="c">!    stored to program globals at end of loop</span>
<a name="ln-4087"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">SolarModel_Schedule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4088"></a>         <span class="c">! scheduled: set value unconditionally (whether sun up or not)</span>
<a name="ln-4089"></a>         <span class="n">BeamRad</span><span class="o">=</span><span class="n">DDBeamSolarValues</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4090"></a>         <span class="n">DiffRad</span><span class="o">=</span><span class="n">DDDiffuseSolarValues</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4091"></a>       <span class="k">ELSE</span>
<a name="ln-4092"></a>
<a name="ln-4093"></a>       <span class="c">! calc time = fractional hour of day</span>
<a name="ln-4094"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4095"></a><span class="k">           </span><span class="n">CurTime</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">Hour</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">+</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TS</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">*</span><span class="n">TimeStepFraction</span>
<a name="ln-4096"></a>         <span class="k">ELSE</span>
<a name="ln-4097"></a><span class="k">           </span><span class="n">CurTime</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">+</span><span class="n">TS1TimeOffset</span>
<a name="ln-4098"></a>         <span class="n">ENDIF</span>
<a name="ln-4099"></a>
<a name="ln-4100"></a>         <span class="k">CALL </span><span class="n">CalculateSunDirectionCosines</span><span class="p">(</span><span class="n">CurTime</span><span class="p">,</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">EquationOfTime</span><span class="p">,</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SinSolarDeclinAngle</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4101"></a>                                         <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">CosSolarDeclinAngle</span><span class="p">,</span><span class="n">SUNCOS</span><span class="p">)</span>
<a name="ln-4102"></a>         <span class="n">CosZenith</span><span class="o">=</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4103"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">CosZenith</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4104"></a><span class="k">           </span><span class="n">BeamRad</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4105"></a>           <span class="n">DiffRad</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4106"></a>         <span class="k">ELSE</span>
<a name="ln-4107"></a><span class="k">           </span><span class="n">SinSolarAltitude</span><span class="o">=</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4108"></a>
<a name="ln-4109"></a>           <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span><span class="p">)</span>
<a name="ln-4110"></a>
<a name="ln-4111"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">Ashrae_ClearSky</span><span class="p">)</span>
<a name="ln-4112"></a>             <span class="n">TotHoriz</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SkyClear</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span> <span class="o">+</span> <span class="n">CosZenith</span><span class="p">)</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">B</span> <span class="o">/</span> <span class="n">CosZenith</span><span class="p">)</span>
<a name="ln-4113"></a>             <span class="n">HO</span><span class="o">=</span><span class="n">GlobalSolarConstant</span><span class="o">*</span><span class="n">AVSC</span><span class="o">*</span><span class="n">CosZenith</span>
<a name="ln-4114"></a>             <span class="n">KT</span><span class="o">=</span><span class="n">TotHoriz</span><span class="o">/</span><span class="n">HO</span>
<a name="ln-4115"></a>             <span class="n">KT</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">KT</span><span class="p">,.</span><span class="mi">75</span><span class="n">d0</span><span class="p">)</span>
<a name="ln-4116"></a>             <span class="n">DiffRad</span> <span class="o">=</span> <span class="n">TotHoriz</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0045d0</span> <span class="o">+</span> <span class="n">KT</span> <span class="o">*</span> <span class="p">(.</span><span class="mi">04349</span><span class="n">d0</span> <span class="o">+</span> <span class="n">KT</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.5227d0</span> <span class="o">+</span> <span class="mf">2.6313d0</span> <span class="o">*</span> <span class="n">KT</span><span class="p">)))</span>
<a name="ln-4117"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SkyClear</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.70d0</span><span class="p">)</span> <span class="n">DiffRad</span> <span class="o">=</span> <span class="n">TotHoriz</span><span class="o">*</span><span class="n">C</span><span class="o">/</span><span class="p">(</span><span class="n">C</span><span class="o">+</span><span class="n">CosZenith</span><span class="p">)</span>
<a name="ln-4118"></a>             <span class="n">BeamRad</span> <span class="o">=</span> <span class="p">(</span><span class="n">TotHoriz</span><span class="o">-</span><span class="n">DiffRad</span><span class="p">)</span><span class="o">/</span><span class="n">CosZenith</span>
<a name="ln-4119"></a>             <span class="n">DiffRad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">DiffRad</span><span class="p">)</span>
<a name="ln-4120"></a>             <span class="n">BeamRad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">BeamRad</span><span class="p">)</span>
<a name="ln-4121"></a>
<a name="ln-4122"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAE_Tau</span><span class="p">)</span>
<a name="ln-4123"></a>             <span class="n">ETR</span> <span class="o">=</span> <span class="n">GlobalSolarConstant</span><span class="o">*</span><span class="n">AVSC</span>      <span class="c">! extraterrestrial normal irrad, W/m2</span>
<a name="ln-4124"></a>             <span class="k">CALL </span><span class="n">ASHRAETauModel</span><span class="p">(</span> <span class="n">ETR</span><span class="p">,</span> <span class="n">CosZenith</span><span class="p">,</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TauB</span><span class="p">,</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TauD</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4125"></a>                  <span class="n">BeamRad</span><span class="p">,</span> <span class="n">DiffRad</span><span class="p">,</span> <span class="n">GloHorzRad</span><span class="p">)</span>
<a name="ln-4126"></a>
<a name="ln-4127"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">Zhang_Huang</span><span class="p">)</span>
<a name="ln-4128"></a>             <span class="n">Hour3Ago</span> <span class="o">=</span> <span class="nb">MOD</span><span class="p">(</span> <span class="n">Hour</span><span class="o">+</span><span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>       <span class="c">! hour 3 hours before</span>
<a name="ln-4129"></a>             <span class="n">TotSkyCover</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span> <span class="mf">1.0d0</span><span class="o">-</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SkyClear</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4130"></a>             <span class="n">GloHorzRad</span> <span class="o">=</span> <span class="p">(</span> <span class="n">ZHGlobalSolarConstant</span> <span class="o">*</span> <span class="n">SinSolarAltitude</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZhangHuangModCoeff_C0</span> <span class="p">&amp;</span>
<a name="ln-4131"></a>                 <span class="o">+</span> <span class="n">ZhangHuangModCoeff_C1</span> <span class="o">*</span> <span class="n">TotSkyCover</span> <span class="p">&amp;</span>
<a name="ln-4132"></a>                 <span class="o">+</span> <span class="n">ZhangHuangModCoeff_C2</span> <span class="o">*</span> <span class="p">(</span><span class="n">TotSkyCover</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-4133"></a>                 <span class="o">+</span> <span class="n">ZhangHuangModCoeff_C3</span> <span class="o">*</span> <span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">-</span> <span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour3Ago</span><span class="p">,</span><span class="n">TS</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-4134"></a>                 <span class="o">+</span> <span class="n">ZhangHuangModCoeff_C4</span> <span class="o">*</span> <span class="n">TomorrowOutRelHum</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4135"></a>                 <span class="o">+</span> <span class="n">ZhangHuangModCoeff_C5</span> <span class="o">*</span> <span class="n">TomorrowWindSpeed</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">))</span> <span class="o">+</span> <span class="n">ZhangHuangModCoeff_D</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4136"></a>                 <span class="o">/</span> <span class="n">ZhangHuangModCoeff_K</span>
<a name="ln-4137"></a>             <span class="n">GloHorzRad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span> <span class="n">GloHorzRad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4138"></a>             <span class="n">ClearnessIndex_kt</span><span class="o">=</span><span class="n">GloHorzRad</span><span class="o">/</span><span class="p">(</span><span class="n">GlobalSolarConstant</span> <span class="o">*</span> <span class="n">SinSolarAltitude</span><span class="p">)</span>
<a name="ln-4139"></a>  <span class="c">!          ClearnessIndex_kt=DesDayInput(EnvrnNum)%SkyClear</span>
<a name="ln-4140"></a>             <span class="n">ClearnessIndex_Ktc</span> <span class="o">=</span> <span class="mf">0.4268d0</span> <span class="o">+</span> <span class="mf">0.1934d0</span> <span class="o">*</span> <span class="n">SinSolarAltitude</span>
<a name="ln-4141"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">ClearnessIndex_Kt</span> <span class="o">&lt;</span> <span class="n">ClearnessIndex_Ktc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4142"></a><span class="k">               </span><span class="n">ClearnessIndex_Kds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.996d0</span> <span class="o">-</span><span class="mf">3.862d0</span><span class="o">*</span><span class="n">SinSolarAltitude</span> <span class="o">+</span><span class="mf">1.54d0</span><span class="o">*</span><span class="n">SinSolarAltitude</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4143"></a>                     <span class="n">ClearnessIndex_Kt</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-4144"></a>             <span class="k">ELSE</span>
<a name="ln-4145"></a><span class="k">               </span><span class="n">ClearnessIndex_Kds</span> <span class="o">=</span> <span class="n">ClearnessIndex_Kt</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.107d0</span> <span class="o">+</span> <span class="mf">0.03569d0</span> <span class="o">*</span> <span class="n">SinSolarAltitude</span> <span class="o">+</span> <span class="mf">1.681d0</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4146"></a>                     <span class="n">SinSolarAltitude</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ClearnessIndex_Kt</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-4147"></a>             <span class="n">ENDIF</span>
<a name="ln-4148"></a>             <span class="c">! Calculate direct normal radiation, W/m2</span>
<a name="ln-4149"></a>             <span class="n">BeamRad</span> <span class="o">=</span> <span class="n">ZHGlobalSolarConstant</span> <span class="o">*</span> <span class="n">SinSolarAltitude</span> <span class="o">*</span> <span class="n">ClearnessIndex_Kds</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4150"></a>                  <span class="p">((</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ClearnessIndex_Kt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ClearnessIndex_Kds</span><span class="p">))</span>
<a name="ln-4151"></a>             <span class="c">! Calculation diffuse horizontal radiation, W/m2</span>
<a name="ln-4152"></a>             <span class="n">DiffRad</span> <span class="o">=</span> <span class="n">ZHGlobalSolarConstant</span> <span class="o">*</span> <span class="n">SinSolarAltitude</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4153"></a>                  <span class="p">((</span><span class="n">ClearnessIndex_Kt</span> <span class="o">-</span> <span class="n">ClearnessIndex_Kds</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ClearnessIndex_Kds</span><span class="p">))</span>
<a name="ln-4154"></a>
<a name="ln-4155"></a>           <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4156"></a>         <span class="k">END SELECT</span>
<a name="ln-4157"></a><span class="k">       END IF</span>
<a name="ln-4158"></a><span class="k">     END IF</span>
<a name="ln-4159"></a>
<a name="ln-4160"></a>     <span class="c">! override result to 0 per environment var (for testing)</span>
<a name="ln-4161"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">IgnoreSolarRadiation</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">IgnoreBeamRadiation</span><span class="p">)</span> <span class="n">BeamRad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4162"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">IgnoreSolarRadiation</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">IgnoreDiffuseRadiation</span><span class="p">)</span> <span class="n">DiffRad</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">;</span>
<a name="ln-4163"></a>
<a name="ln-4164"></a>     <span class="n">TomorrowBeamSolarRad</span><span class="p">(</span> <span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span> <span class="n">BeamRad</span>
<a name="ln-4165"></a>     <span class="n">TomorrowDifSolarRad</span><span class="p">(</span> <span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>  <span class="o">=</span> <span class="n">DiffRad</span>
<a name="ln-4166"></a>
<a name="ln-4167"></a>     <span class="k">END DO</span>   <span class="c">! Timestep (TS) Loop</span>
<a name="ln-4168"></a>   <span class="n">ENDDO</span>  <span class="c">! Hour Loop</span>
<a name="ln-4169"></a>
<a name="ln-4170"></a>   <span class="c">! back-fill hour values from timesteps</span>
<a name="ln-4171"></a>   <span class="c">! hour values = integrated over hour ending at time of hour</span>
<a name="ln-4172"></a>   <span class="c">! insurance: hourly values not known to be needed</span>
<a name="ln-4173"></a>   <span class="k">DO </span><span class="n">Hour</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-4174"></a>     <span class="n">Hour1Ago</span> <span class="o">=</span> <span class="nb">MOD</span><span class="p">(</span> <span class="n">Hour</span><span class="o">+</span><span class="mi">22</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4175"></a>     <span class="n">BeamRad</span> <span class="o">=</span> <span class="p">(</span><span class="n">TomorrowBeamSolarRad</span><span class="p">(</span> <span class="n">Hour1Ago</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">TomorrowBeamSolarRad</span><span class="p">(</span> <span class="n">Hour</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-4176"></a>     <span class="n">DiffRad</span> <span class="o">=</span> <span class="p">(</span><span class="n">TomorrowDifSolarRad</span><span class="p">(</span>  <span class="n">Hour1Ago</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">TomorrowDifSolarRad</span><span class="p">(</span>  <span class="n">Hour</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-4177"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4178"></a><span class="k">        </span><span class="n">BeamRad</span> <span class="o">=</span> <span class="n">BeamRad</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span> <span class="n">TomorrowBeamSolarRad</span><span class="p">(</span> <span class="n">Hour</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NumOfTimeStepInHour</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4179"></a>        <span class="n">DiffRad</span> <span class="o">=</span> <span class="n">DiffRad</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span> <span class="n">TomorrowDifSolarRad</span><span class="p">(</span>  <span class="n">Hour</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NumOfTimeStepInHour</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4180"></a>     <span class="n">ENDIF</span>
<a name="ln-4181"></a>     <span class="n">Wthr</span><span class="p">%</span><span class="n">BeamSolarRad</span><span class="p">(</span> <span class="n">Hour</span><span class="p">)</span> <span class="o">=</span> <span class="n">BeamRad</span> <span class="o">/</span> <span class="n">NumOfTimeStepInHour</span>
<a name="ln-4182"></a>     <span class="n">Wthr</span><span class="p">%</span><span class="n">DifSolarRad</span><span class="p">(</span> <span class="n">Hour</span><span class="p">)</span>  <span class="o">=</span> <span class="n">DiffRad</span> <span class="o">/</span> <span class="n">NumOfTimeStepInHour</span>
<a name="ln-4183"></a>   <span class="k">END DO</span>
<a name="ln-4184"></a>
<a name="ln-4185"></a><span class="k">   IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4186"></a>
<a name="ln-4187"></a><span class="k">     SELECT CASE</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">CalculationType</span><span class="p">)</span>
<a name="ln-4188"></a>
<a name="ln-4189"></a>       <span class="k">CASE</span> <span class="p">(</span><span class="n">WP_ScheduleValue</span><span class="p">)</span>
<a name="ln-4190"></a>         <span class="k">CALL </span><span class="n">GetSingleDayScheduleValues</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4191"></a>                             <span class="n">TomorrowSkyTemp</span><span class="p">)</span>
<a name="ln-4192"></a>         <span class="n">DDSkyTempScheduleValues</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:)</span><span class="o">=</span><span class="n">TomorrowSkyTemp</span>
<a name="ln-4193"></a>       <span class="k">CASE</span> <span class="p">(</span><span class="n">WP_DryBulbDelta</span><span class="p">)</span>
<a name="ln-4194"></a>         <span class="k">CALL </span><span class="n">GetSingleDayScheduleValues</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4195"></a>                             <span class="n">TomorrowSkyTemp</span><span class="p">)</span>
<a name="ln-4196"></a>         <span class="n">DDSkyTempScheduleValues</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:)</span><span class="o">=</span><span class="n">TomorrowSkyTemp</span>
<a name="ln-4197"></a>         <span class="k">DO </span><span class="n">Hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-4198"></a>           <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-4199"></a>             <span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">-</span><span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4200"></a>           <span class="n">ENDDO</span>
<a name="ln-4201"></a>         <span class="n">ENDDO</span>
<a name="ln-4202"></a>
<a name="ln-4203"></a>       <span class="k">CASE</span> <span class="p">(</span><span class="n">WP_DewPointDelta</span><span class="p">)</span>
<a name="ln-4204"></a>         <span class="k">CALL </span><span class="n">GetSingleDayScheduleValues</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4205"></a>                             <span class="n">TomorrowSkyTemp</span><span class="p">)</span>
<a name="ln-4206"></a>         <span class="n">DDSkyTempScheduleValues</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:)</span><span class="o">=</span><span class="n">TomorrowSkyTemp</span>
<a name="ln-4207"></a>         <span class="k">DO </span><span class="n">Hour</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-4208"></a>           <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-4209"></a>             <span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">-</span><span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4210"></a>           <span class="n">ENDDO</span>
<a name="ln-4211"></a>         <span class="n">ENDDO</span>
<a name="ln-4212"></a>
<a name="ln-4213"></a>       <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4214"></a>
<a name="ln-4215"></a>     <span class="k">END SELECT</span>
<a name="ln-4216"></a>
<a name="ln-4217"></a><span class="k">   </span><span class="n">ENDIF</span>
<a name="ln-4218"></a>
<a name="ln-4219"></a>
<a name="ln-4220"></a>
<a name="ln-4221"></a>   <span class="n">WarmupFlag</span><span class="o">=</span><span class="n">SaveWarmupFlag</span>
<a name="ln-4222"></a>
<a name="ln-4223"></a>   <span class="k">RETURN</span>
<a name="ln-4224"></a>
<a name="ln-4225"></a><span class="k">END SUBROUTINE </span><span class="n">SetUpDesignDay</span>
<a name="ln-4226"></a>
<a name="ln-4227"></a><span class="c">!------------------------------------------------------------------------------</span>
<a name="ln-4228"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">AirMass</span><span class="p">(</span><span class="n">CosZen</span><span class="p">)</span>
<a name="ln-4229"></a>
<a name="ln-4230"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4231"></a>          <span class="c">!       AUTHOR         C Barnaby</span>
<a name="ln-4232"></a>          <span class="c">!       DATE WRITTEN   Nov 2010</span>
<a name="ln-4233"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4234"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4235"></a>
<a name="ln-4236"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4237"></a>          <span class="c">! Calculate relative air mass using Kasten and Young approximation</span>
<a name="ln-4238"></a>
<a name="ln-4239"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4240"></a>          <span class="c">! Eqn (16), ASHRAE HOF 2009, p. 14.9</span>
<a name="ln-4241"></a>
<a name="ln-4242"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4243"></a>          <span class="c">! ASHRAE HOF 2009 Chapter 14</span>
<a name="ln-4244"></a>          <span class="c">! Kasten, F and T. Young.  1989.  Revised optical air mass tables</span>
<a name="ln-4245"></a>          <span class="c">!   and approximating formula.  Applied Optics 28:4735-4738.</span>
<a name="ln-4246"></a>
<a name="ln-4247"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4248"></a>          <span class="c">! na</span>
<a name="ln-4249"></a>
<a name="ln-4250"></a>    <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4251"></a>
<a name="ln-4252"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4253"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosZen</span>    <span class="c">! COS( solar zenith), 0 - 1</span>
<a name="ln-4254"></a>
<a name="ln-4255"></a>
<a name="ln-4256"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4257"></a>          <span class="c">! na</span>
<a name="ln-4258"></a>
<a name="ln-4259"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4260"></a>          <span class="c">! na</span>
<a name="ln-4261"></a>
<a name="ln-4262"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4263"></a>          <span class="c">! na</span>
<a name="ln-4264"></a>
<a name="ln-4265"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4266"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunAltD</span>
<a name="ln-4267"></a>
<a name="ln-4268"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CosZen</span> <span class="o">&lt;=</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4269"></a><span class="k">        </span><span class="n">AirMass</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">7.07837343d0</span>   <span class="c">! limit value calc&#39;d with Excel</span>
<a name="ln-4270"></a>                                <span class="c">!  value increases little as CosZen -&gt; 0</span>
<a name="ln-4271"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CosZen</span> <span class="o">&gt;=</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4272"></a><span class="k">        </span><span class="n">AirMass</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-4273"></a>    <span class="k">ELSE</span>
<a name="ln-4274"></a>        <span class="c">! note: COS( Zen) = SIN( Alt)</span>
<a name="ln-4275"></a>        <span class="n">SunAltD</span> <span class="o">=</span> <span class="nb">ASIN</span><span class="p">(</span> <span class="n">CosZen</span><span class="p">)</span> <span class="o">/</span> <span class="n">DegToRadians</span>      <span class="c">! altitude, degrees</span>
<a name="ln-4276"></a>        <span class="n">AirMass</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="n">CosZen</span> <span class="o">+</span> <span class="mf">0.50572d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">6.07995d0</span> <span class="o">+</span> <span class="n">SunAltD</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.6364d0</span><span class="p">))</span>
<a name="ln-4277"></a>    <span class="k">END IF</span>
<a name="ln-4278"></a><span class="k">END FUNCTION </span><span class="n">AirMass</span>
<a name="ln-4279"></a><span class="c">!------------------------------------------------------------------------------</span>
<a name="ln-4280"></a><span class="k">SUBROUTINE </span><span class="n">ASHRAETauModel</span><span class="p">(</span> <span class="n">ETR</span><span class="p">,</span> <span class="n">CosZen</span><span class="p">,</span> <span class="n">TauB</span><span class="p">,</span> <span class="n">TauD</span><span class="p">,</span> <span class="n">IDirN</span><span class="p">,</span> <span class="n">IDifH</span><span class="p">,</span> <span class="n">IGlbH</span><span class="p">)</span>
<a name="ln-4281"></a>
<a name="ln-4282"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4283"></a>          <span class="c">!       AUTHOR         C Barnaby</span>
<a name="ln-4284"></a>          <span class="c">!       DATE WRITTEN   Nov 2010</span>
<a name="ln-4285"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4286"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4287"></a>
<a name="ln-4288"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4289"></a>          <span class="c">! Calculate clear-sky direct and diffuse irradiance using ASHRAE &quot;tau&quot; model</span>
<a name="ln-4290"></a>
<a name="ln-4291"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4292"></a>          <span class="c">! Eqns (17-18), ASHRAE HOF 2009, p. 14.9</span>
<a name="ln-4293"></a>
<a name="ln-4294"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4295"></a>          <span class="c">! ASHRAE HOF 2009 Chapter 14</span>
<a name="ln-4296"></a>
<a name="ln-4297"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4298"></a>          <span class="c">! na</span>
<a name="ln-4299"></a>
<a name="ln-4300"></a>    <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4301"></a>
<a name="ln-4302"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4303"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ETR</span>       <span class="c">! extraterrestrial normal irradiance, W/m2</span>
<a name="ln-4304"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosZen</span>    <span class="c">! COS( solar zenith angle), 0 - 1</span>
<a name="ln-4305"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TauB</span>      <span class="c">! beam tau factor</span>
<a name="ln-4306"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TauD</span>      <span class="c">! dif tau factor</span>
<a name="ln-4307"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IDirN</span>     <span class="c">! returned: direct (beam) irradiance on normal surface, W/m2</span>
<a name="ln-4308"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IDifH</span>     <span class="c">! returned: diffuse irradiance on horiz surface, W/m2</span>
<a name="ln-4309"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IGlbH</span>     <span class="c">! returned: global irradiance on horiz surface, W/m2</span>
<a name="ln-4310"></a>
<a name="ln-4311"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4312"></a>          <span class="c">! na</span>
<a name="ln-4313"></a>
<a name="ln-4314"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4315"></a>          <span class="c">! na</span>
<a name="ln-4316"></a>
<a name="ln-4317"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4318"></a>          <span class="c">! na</span>
<a name="ln-4319"></a>
<a name="ln-4320"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4321"></a>
<a name="ln-4322"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">AB</span><span class="p">,</span> <span class="n">AD</span>    <span class="c">! air mass exponents</span>
<a name="ln-4323"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">M</span>         <span class="c">! air mass</span>
<a name="ln-4324"></a>
<a name="ln-4325"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CosZen</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TauB</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TauD</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4326"></a><span class="k">        </span><span class="n">IDirN</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4327"></a>        <span class="n">IDifH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4328"></a>        <span class="n">IGlbH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4329"></a>    <span class="k">ELSE</span>
<a name="ln-4330"></a><span class="k">        </span><span class="n">AB</span> <span class="o">=</span> <span class="mf">1.219d0</span> <span class="o">-</span> <span class="mf">0.043d0</span><span class="o">*</span><span class="n">TauB</span> <span class="o">-</span> <span class="mf">0.151d0</span><span class="o">*</span><span class="n">TauD</span> <span class="o">-</span> <span class="mf">0.204d0</span><span class="o">*</span><span class="n">TauB</span><span class="o">*</span><span class="n">TauD</span>
<a name="ln-4331"></a>        <span class="n">AD</span> <span class="o">=</span> <span class="mf">0.202d0</span> <span class="o">+</span> <span class="mf">0.852d0</span><span class="o">*</span><span class="n">TauB</span> <span class="o">-</span> <span class="mf">0.007d0</span><span class="o">*</span><span class="n">Taud</span> <span class="o">-</span> <span class="mf">0.357d0</span><span class="o">*</span><span class="n">TauB</span><span class="o">*</span><span class="n">TauD</span>
<a name="ln-4332"></a>        <span class="n">M</span> <span class="o">=</span> <span class="n">AirMass</span><span class="p">(</span> <span class="n">CosZen</span><span class="p">)</span>
<a name="ln-4333"></a>        <span class="n">IDirN</span> <span class="o">=</span> <span class="n">ETR</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">TauB</span> <span class="o">*</span> <span class="n">M</span><span class="o">**</span><span class="n">AB</span><span class="p">)</span>
<a name="ln-4334"></a>        <span class="n">IDifH</span> <span class="o">=</span> <span class="n">ETR</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">TauD</span> <span class="o">*</span> <span class="n">M</span><span class="o">**</span><span class="n">AD</span><span class="p">)</span>
<a name="ln-4335"></a>        <span class="n">IGlbH</span> <span class="o">=</span> <span class="n">IDirN</span> <span class="o">*</span> <span class="n">CosZen</span> <span class="o">+</span> <span class="n">IDifH</span>
<a name="ln-4336"></a>    <span class="k">END IF</span>
<a name="ln-4337"></a>
<a name="ln-4338"></a><span class="k">END SUBROUTINE </span><span class="n">ASHRAETauModel</span>
<a name="ln-4339"></a>
<a name="ln-4340"></a><span class="k">SUBROUTINE </span><span class="n">AllocateWeatherData</span>
<a name="ln-4341"></a>
<a name="ln-4342"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4343"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4344"></a>          <span class="c">!       DATE WRITTEN   December 2000</span>
<a name="ln-4345"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4346"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4347"></a>
<a name="ln-4348"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4349"></a>          <span class="c">! This subroutine allocates the weather data structures (Today, Tomorrow,</span>
<a name="ln-4350"></a>          <span class="c">! Design Day) to the proper number of &quot;time steps in hour&quot; requested by the user.</span>
<a name="ln-4351"></a>          <span class="c">! Interpolation of data is done later after either setting up the design day (hourly</span>
<a name="ln-4352"></a>          <span class="c">! data) or reading in hourly weather data.</span>
<a name="ln-4353"></a>
<a name="ln-4354"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4355"></a>          <span class="c">! na</span>
<a name="ln-4356"></a>
<a name="ln-4357"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4358"></a>          <span class="c">! na</span>
<a name="ln-4359"></a>
<a name="ln-4360"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4361"></a>          <span class="c">! na</span>
<a name="ln-4362"></a>
<a name="ln-4363"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4364"></a>
<a name="ln-4365"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4366"></a>          <span class="c">! na</span>
<a name="ln-4367"></a>
<a name="ln-4368"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4369"></a>          <span class="c">! na</span>
<a name="ln-4370"></a>
<a name="ln-4371"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4372"></a>          <span class="c">! na</span>
<a name="ln-4373"></a>
<a name="ln-4374"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4375"></a>          <span class="c">! na</span>
<a name="ln-4376"></a>
<a name="ln-4377"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4378"></a>          <span class="c">! na</span>
<a name="ln-4379"></a>
<a name="ln-4380"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayIsRain</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4381"></a>  <span class="n">TodayIsRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4382"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayIsSnow</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4383"></a>  <span class="n">TodayIsSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4384"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayOutDryBulbTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4385"></a>  <span class="n">TodayOutDryBulbTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4386"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayOutDewPointTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4387"></a>  <span class="n">TodayOutDewPointTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4388"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayOutBaroPress</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4389"></a>  <span class="n">TodayOutBaroPress</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4390"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayOutRelHum</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4391"></a>  <span class="n">TodayOutRelHum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4392"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayWindSpeed</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4393"></a>  <span class="n">TodayWindSpeed</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4394"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayWindDir</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4395"></a>  <span class="n">TodayWindDir</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4396"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodaySkyTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4397"></a>  <span class="n">TodaySkyTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4398"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayHorizIRSky</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4399"></a>  <span class="n">TodayHorizIRSky</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4400"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayBeamSolarRad</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4401"></a>  <span class="n">TodayBeamSolarRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4402"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayDifSolarRad</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4403"></a>  <span class="n">TodayDifSolarRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4404"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayAlbedo</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4405"></a>  <span class="n">TodayAlbedo</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4406"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TodayLiquidPrecip</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4407"></a>  <span class="n">TodayLiquidPrecip</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4408"></a>
<a name="ln-4409"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowIsRain</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4410"></a>  <span class="n">TomorrowIsRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4411"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowIsSnow</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4412"></a>  <span class="n">TomorrowIsSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4413"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowOutDryBulbTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4414"></a>  <span class="n">TomorrowOutDryBulbTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4415"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowOutDewPointTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4416"></a>  <span class="n">TomorrowOutDewPointTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4417"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowOutBaroPress</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4418"></a>  <span class="n">TomorrowOutBaroPress</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4419"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowOutRelHum</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4420"></a>  <span class="n">TomorrowOutRelHum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4421"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowWindSpeed</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4422"></a>  <span class="n">TomorrowWindSpeed</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4423"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowWindDir</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4424"></a>  <span class="n">TomorrowWindDir</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4425"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowSkyTemp</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4426"></a>  <span class="n">TomorrowSkyTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4427"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowHorizIRSky</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4428"></a>  <span class="n">TomorrowHorizIRSky</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4429"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowBeamSolarRad</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4430"></a>  <span class="n">TomorrowBeamSolarRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4431"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowDifSolarRad</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4432"></a>  <span class="n">TomorrowDifSolarRad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4433"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowAlbedo</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4434"></a>  <span class="n">TomorrowAlbedo</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4435"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TomorrowLiquidPrecip</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-4436"></a>  <span class="n">TomorrowLiquidPrecip</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4437"></a>
<a name="ln-4438"></a>  <span class="k">RETURN</span>
<a name="ln-4439"></a>
<a name="ln-4440"></a><span class="k">END SUBROUTINE </span><span class="n">AllocateWeatherData</span>
<a name="ln-4441"></a>
<a name="ln-4442"></a><span class="k">SUBROUTINE </span><span class="n">CalculateDailySolarCoeffs</span><span class="p">(</span><span class="n">DayOfYear</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">AnnVarSolConstant</span><span class="p">,</span><span class="n">EquationOfTime</span><span class="p">,</span><span class="n">SineSolarDeclination</span><span class="p">,</span><span class="n">CosineSolarDeclination</span><span class="p">)</span>
<a name="ln-4443"></a>
<a name="ln-4444"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4445"></a>          <span class="c">!       AUTHOR         George Walton</span>
<a name="ln-4446"></a>          <span class="c">!       DATE WRITTEN   May 1985</span>
<a name="ln-4447"></a>          <span class="c">!       MODIFIED       1999 for EnergyPlus</span>
<a name="ln-4448"></a>          <span class="c">!       RE-ENGINEERED  2001; LKL; Remove need for English -&gt; SI conversion</span>
<a name="ln-4449"></a>          <span class="c">!                      Implement Tarp &quot;fix&quot; for Southern Hemisphere</span>
<a name="ln-4450"></a>
<a name="ln-4451"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4452"></a>          <span class="c">! This subroutine computes the daily solar coefficients used in other</span>
<a name="ln-4453"></a>          <span class="c">! calculations.  Specifically, this routine computes values of the solar declination, equation</span>
<a name="ln-4454"></a>          <span class="c">! of time, and ashrae sky coefficients a, b, and c for a given</span>
<a name="ln-4455"></a>          <span class="c">! day of the year.</span>
<a name="ln-4456"></a>
<a name="ln-4457"></a>
<a name="ln-4458"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4459"></a>          <span class="c">! The method is the same as that recommended in the ASHRAE loads</span>
<a name="ln-4460"></a>          <span class="c">! algorithms manual, except that the fourier series expressions</span>
<a name="ln-4461"></a>          <span class="c">! have been extended by two terms for greater accuracy.</span>
<a name="ln-4462"></a>          <span class="c">! coefficients for the new expressions were determined at USACERL</span>
<a name="ln-4463"></a>          <span class="c">! using data from the cited references.</span>
<a name="ln-4464"></a>
<a name="ln-4465"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4466"></a>          <span class="c">! J. L. Threlkeld, &quot;Thermal Environmental Engineering&quot;, 1970,</span>
<a name="ln-4467"></a>          <span class="c">! p.316, for declination and equation of time.</span>
<a name="ln-4468"></a>          <span class="c">! &quot;ASHRAE Handbook of Fundamentals&quot;, 1972, p.387 for sky</span>
<a name="ln-4469"></a>          <span class="c">! coefficients a, b, and c.</span>
<a name="ln-4470"></a>          <span class="c">! See SUN3 in SolarShading. See SUN2 in BLAST.  See SUN3 in Tarp.</span>
<a name="ln-4471"></a>
<a name="ln-4472"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4473"></a>          <span class="c">! na</span>
<a name="ln-4474"></a>
<a name="ln-4475"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4476"></a>
<a name="ln-4477"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4478"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DayOfYear</span>              <span class="c">! Day of year (1 - 366)</span>
<a name="ln-4479"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">A</span>                      <span class="c">! ASHRAE &quot;A&quot; - Apparent solar irradiation at air mass = 0 [W/M**2]</span>
<a name="ln-4480"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">B</span>                      <span class="c">! ASHRAE &quot;B&quot; - Atmospheric extinction coefficient</span>
<a name="ln-4481"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">C</span>                      <span class="c">! ASHRAE &quot;C&quot; - Diffuse radiation factor</span>
<a name="ln-4482"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AnnVarSolConstant</span>      <span class="c">! Annual variation in the solar constant</span>
<a name="ln-4483"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">EquationOfTime</span>         <span class="c">! Equation of Time</span>
<a name="ln-4484"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SineSolarDeclination</span>   <span class="c">! Sine of Solar Declination</span>
<a name="ln-4485"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CosineSolarDeclination</span> <span class="c">! Cosine of Solar Declination</span>
<a name="ln-4486"></a>
<a name="ln-4487"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4488"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DayCorrection</span><span class="o">=</span><span class="n">PI</span><span class="o">*</span><span class="mf">2.d0</span><span class="o">/</span><span class="mi">36</span><span class="mf">6.d0</span>
<a name="ln-4489"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SineSolDeclCoef</span> <span class="o">=</span> <span class="p">&amp;</span>  <span class="c">!Fitted coefficients of Fourier series</span>
<a name="ln-4490"></a>        <span class="p">(</span><span class="o">/</span> <span class="p">.</span><span class="mi">00561800</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">0657911</span><span class="n">d0</span><span class="p">,</span> <span class="o">-</span><span class="p">.</span><span class="mi">392779</span><span class="n">d0</span><span class="p">,</span>   <span class="p">.</span><span class="mi">00064440</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00618495</span><span class="n">d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! Sine of declination coefficients</span>
<a name="ln-4491"></a>          <span class="o">-</span><span class="p">.</span><span class="mi">00010101</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00007951</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00011691</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">00002096</span><span class="n">d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4492"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EqOfTimeCoef</span> <span class="o">=</span> <span class="p">&amp;</span>  <span class="c">!Fitted coefficients of Fourier Series</span>
<a name="ln-4493"></a>        <span class="p">(</span><span class="o">/</span> <span class="p">.</span><span class="mi">00021971</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">122649</span><span class="n">d0</span><span class="p">,</span>   <span class="p">.</span><span class="mi">00762856</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">156308</span><span class="n">d0</span><span class="p">,</span>  <span class="o">-</span><span class="p">.</span><span class="mi">0530028</span><span class="n">d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! Equation of Time coefficients</span>
<a name="ln-4494"></a>          <span class="o">-</span><span class="p">.</span><span class="mi">00388702</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00123978</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00270502</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00167992</span><span class="n">d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ASHRAE_A_Coef</span> <span class="o">=</span> <span class="p">&amp;</span>  <span class="c">!Fitted coefficients of Fourier Series</span>
<a name="ln-4496"></a>        <span class="p">(</span><span class="o">/</span>  <span class="mi">116</span><span class="mf">1.6685d0</span><span class="p">,</span> <span class="mf">1.1554d0</span><span class="p">,</span> <span class="mi">7</span><span class="mf">7.3575d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5359d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.7622d0</span><span class="p">,</span>         <span class="p">&amp;</span> <span class="c">! ASHRAE A Factor coefficients</span>
<a name="ln-4497"></a>            <span class="mf">0.9875d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.3924d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7445d0</span><span class="p">,</span> <span class="mf">1.1198d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4498"></a><span class="c">! English (original) units:</span>
<a name="ln-4499"></a><span class="c">!              368.49341,.366502,24.538624,-.169983,-1.193417,            &amp;</span>
<a name="ln-4500"></a><span class="c">!              .313261,-1.076093,-.543376,.355197 ,                       &amp;</span>
<a name="ln-4501"></a>
<a name="ln-4502"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ASHRAE_B_Coef</span> <span class="o">=</span> <span class="p">&amp;</span>  <span class="c">!Fitted coefficients of Fourier Series</span>
<a name="ln-4503"></a>        <span class="p">(</span><span class="o">/</span> <span class="p">.</span><span class="mi">171631</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00400448</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">0344923</span><span class="n">d0</span><span class="p">,.</span><span class="mi">00000209</span><span class="n">d0</span><span class="p">,.</span><span class="mi">00325428</span><span class="n">d0</span><span class="p">,</span>         <span class="p">&amp;</span> <span class="c">! ASHRAE B Factor coefficients</span>
<a name="ln-4504"></a>          <span class="o">-</span><span class="p">.</span><span class="mi">00085429</span><span class="n">d0</span><span class="p">,.</span><span class="mi">00229562</span><span class="n">d0</span><span class="p">,.</span><span class="mi">0009034</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">0011867</span><span class="n">d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4505"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ASHRAE_C_Coef</span> <span class="o">=</span> <span class="p">&amp;</span>  <span class="c">!Fitted coefficients of Fourier Series</span>
<a name="ln-4506"></a>        <span class="p">(</span><span class="o">/</span> <span class="p">.</span><span class="mi">0905151</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00322522</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">0407966</span><span class="n">d0</span><span class="p">,.</span><span class="mi">000104164</span><span class="n">d0</span><span class="p">,.</span><span class="mi">00745899</span><span class="n">d0</span><span class="p">,</span>        <span class="p">&amp;</span> <span class="c">! ASHRAE C Factor coefficients</span>
<a name="ln-4507"></a>          <span class="o">-</span><span class="p">.</span><span class="mi">00086461</span><span class="n">d0</span><span class="p">,.</span><span class="mi">0013111</span><span class="n">d0</span><span class="p">,.</span><span class="mi">000808275</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00170515</span><span class="n">d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4508"></a>
<a name="ln-4509"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4510"></a>          <span class="c">! na</span>
<a name="ln-4511"></a>
<a name="ln-4512"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4513"></a>          <span class="c">! na</span>
<a name="ln-4514"></a>
<a name="ln-4515"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4516"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">X</span>     <span class="c">! Day of Year in Radians (Computed from Input DayOfYear)</span>
<a name="ln-4517"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">CosX</span>  <span class="c">! COS(X)</span>
<a name="ln-4518"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">SinX</span> <span class="c">! SIN(X)</span>
<a name="ln-4519"></a>
<a name="ln-4520"></a>
<a name="ln-4521"></a>  <span class="n">X</span><span class="o">=</span><span class="n">DayCorrection</span><span class="o">*</span><span class="n">DayOfYear</span>   <span class="c">! Convert Julian date (Day of Year) to angle X</span>
<a name="ln-4522"></a>
<a name="ln-4523"></a>          <span class="c">! Calculate sines and cosines of X</span>
<a name="ln-4524"></a>  <span class="n">SinX</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-4525"></a>  <span class="n">CosX</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-4526"></a>
<a name="ln-4527"></a>  <span class="n">SineSolarDeclination</span> <span class="o">=</span> <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4528"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SinX</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-4529"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosX</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4530"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4531"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4532"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4533"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4534"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4535"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4536"></a>  <span class="n">CosineSolarDeclination</span><span class="o">=</span><span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SineSolarDeclination</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4537"></a>
<a name="ln-4538"></a>  <span class="n">EquationOfTime</span> <span class="o">=</span> <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4539"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SinX</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-4540"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosX</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4541"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4542"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4543"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4544"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4545"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4546"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4547"></a>
<a name="ln-4548"></a>  <span class="n">AnnVarSolConstant</span><span class="o">=</span><span class="mf">1.000047d0</span> <span class="o">+</span> <span class="p">.</span><span class="mi">000352615</span><span class="n">d0</span><span class="o">*</span><span class="n">SinX</span> <span class="o">+</span> <span class="p">.</span><span class="mi">0334454</span><span class="n">d0</span><span class="o">*</span><span class="n">CosX</span>
<a name="ln-4549"></a>
<a name="ln-4550"></a>  <span class="n">A</span> <span class="o">=</span> <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4551"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SinX</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-4552"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosX</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4553"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4554"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4555"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4556"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4557"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4558"></a>                   <span class="n">ASHRAE_A_Coef</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4559"></a>
<a name="ln-4560"></a><span class="c">!                        Compute B and C coefficients</span>
<a name="ln-4561"></a>
<a name="ln-4562"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Latitude</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4563"></a><span class="c">!                            If in southern hemisphere, compute B and C with a six month time shift.</span>
<a name="ln-4564"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">PI</span>
<a name="ln-4565"></a>    <span class="n">SinX</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-4566"></a>    <span class="n">CosX</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-4567"></a>  <span class="n">ENDIF</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a>  <span class="n">B</span> <span class="o">=</span> <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4570"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SinX</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-4571"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosX</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4572"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4573"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4574"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4575"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4576"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4577"></a>                   <span class="n">ASHRAE_B_Coef</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4578"></a>
<a name="ln-4579"></a>  <span class="n">C</span> <span class="o">=</span> <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4580"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SinX</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-4581"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosX</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4582"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4583"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4584"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4585"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4586"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4587"></a>                   <span class="n">ASHRAE_C_Coef</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SinX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">SinX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4588"></a>
<a name="ln-4589"></a>      <span class="k">RETURN</span>
<a name="ln-4590"></a>
<a name="ln-4591"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateDailySolarCoeffs</span>
<a name="ln-4592"></a>
<a name="ln-4593"></a><span class="k">SUBROUTINE </span><span class="n">CalculateSunDirectionCosines</span><span class="p">(</span><span class="n">TimeValue</span><span class="p">,</span><span class="n">EqOfTime</span><span class="p">,</span><span class="n">SinSolDeclin</span><span class="p">,</span><span class="n">CosSolDeclin</span><span class="p">,</span><span class="n">SUNCOS</span><span class="p">)</span>
<a name="ln-4594"></a>
<a name="ln-4595"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4596"></a>          <span class="c">!       AUTHOR         George Walton</span>
<a name="ln-4597"></a>          <span class="c">!       DATE WRITTEN   May 1975</span>
<a name="ln-4598"></a>          <span class="c">!       MODIFIED       1999 for EnergyPlus</span>
<a name="ln-4599"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4600"></a>
<a name="ln-4601"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4602"></a>          <span class="c">! This routine computes the solar direction cosines for hourly</span>
<a name="ln-4603"></a>          <span class="c">! radiation calculations.</span>
<a name="ln-4604"></a>
<a name="ln-4605"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4606"></a>          <span class="c">! na</span>
<a name="ln-4607"></a>
<a name="ln-4608"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4609"></a>          <span class="c">! &quot;NECAP Engineering Manual&quot;, 1974, p.3-117</span>
<a name="ln-4610"></a>
<a name="ln-4611"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4612"></a>          <span class="c">! na</span>
<a name="ln-4613"></a>
<a name="ln-4614"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4615"></a>
<a name="ln-4616"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4617"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TimeValue</span>       <span class="c">! Current Time of Day</span>
<a name="ln-4618"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">EqOfTime</span>        <span class="c">! Equation of Time</span>
<a name="ln-4619"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SinSolDeclin</span>    <span class="c">! Sine of Solar Declination</span>
<a name="ln-4620"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CosSolDeclin</span>    <span class="c">! Cosine of Solar Declination</span>
<a name="ln-4621"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4622"></a>
<a name="ln-4623"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4624"></a>          <span class="c">! na</span>
<a name="ln-4625"></a>
<a name="ln-4626"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4627"></a>          <span class="c">! na</span>
<a name="ln-4628"></a>
<a name="ln-4629"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4630"></a>          <span class="c">! na</span>
<a name="ln-4631"></a>
<a name="ln-4632"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4633"></a>         <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="nb">COSH</span>  <span class="c">! Cosine of hour angle</span>
<a name="ln-4634"></a>         <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="n">H</span>     <span class="c">! Hour angle (before noon = +)</span>
<a name="ln-4635"></a>
<a name="ln-4636"></a><span class="c">!                                      COMPUTE THE HOUR ANGLE</span>
<a name="ln-4637"></a>      <span class="n">H</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.d0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="mf">2.d0</span><span class="o">-</span><span class="p">(</span><span class="n">TimeValue</span><span class="o">+</span><span class="n">EqOfTime</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">TimeZoneMeridian</span><span class="o">-</span><span class="n">Longitude</span><span class="p">))</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-4638"></a>      <span class="nb">COSH</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-4639"></a><span class="c">!                                      COMPUTE THE COSINE OF THE</span>
<a name="ln-4640"></a><span class="c">!                                      SOLAR ZENITH ANGLE.</span>
<a name="ln-4641"></a><span class="c">!                                      This is also the Sine of the Solar Altitude Angle</span>
<a name="ln-4642"></a>
<a name="ln-4643"></a>      <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">SinSolDeclin</span><span class="o">*</span><span class="n">SinLatitude</span><span class="o">+</span><span class="n">CosSolDeclin</span><span class="o">*</span><span class="n">CosLatitude</span><span class="o">*</span><span class="nb">COSH</span>
<a name="ln-4644"></a>
<a name="ln-4645"></a><span class="nb">      </span><span class="k">IF</span><span class="p">(</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">THEN</span>     <span class="c">! If Sun above horizon, compute other direction cosines</span>
<a name="ln-4646"></a>        <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">SinSolDeclin</span><span class="o">*</span><span class="n">CosLatitude</span><span class="o">-</span><span class="n">CosSolDeclin</span><span class="o">*</span><span class="n">SinLatitude</span><span class="o">*</span><span class="nb">COSH</span>
<a name="ln-4647"></a><span class="nb">        </span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">CosSolDeclin</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-4648"></a>      <span class="k">ELSE</span>                             <span class="c">! Sun is down, set to 0.0</span>
<a name="ln-4649"></a>        <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4650"></a>        <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4651"></a>      <span class="n">ENDIF</span>
<a name="ln-4652"></a>
<a name="ln-4653"></a>  <span class="k">RETURN</span>
<a name="ln-4654"></a>
<a name="ln-4655"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateSunDirectionCosines</span>
<a name="ln-4656"></a>
<a name="ln-4657"></a><span class="k">SUBROUTINE </span><span class="n">DetermineSunUpDown</span><span class="p">(</span><span class="n">SunDirectionCosines</span><span class="p">)</span>
<a name="ln-4658"></a>
<a name="ln-4659"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4660"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4661"></a>          <span class="c">!       DATE WRITTEN   1999</span>
<a name="ln-4662"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4663"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4664"></a>
<a name="ln-4665"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4666"></a>          <span class="c">! This subroutine determines if the sun is up or down for the current</span>
<a name="ln-4667"></a>          <span class="c">! hour/timestep.</span>
<a name="ln-4668"></a>
<a name="ln-4669"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4670"></a>          <span class="c">! na</span>
<a name="ln-4671"></a>
<a name="ln-4672"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4673"></a>          <span class="c">! Sun routines from IBLAST, authored by Walton.</span>
<a name="ln-4674"></a>
<a name="ln-4675"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4676"></a>          <span class="c">! na</span>
<a name="ln-4677"></a>
<a name="ln-4678"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4679"></a>
<a name="ln-4680"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4681"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunDirectionCosines</span>
<a name="ln-4682"></a>
<a name="ln-4683"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4684"></a>          <span class="c">! na</span>
<a name="ln-4685"></a>
<a name="ln-4686"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4687"></a>          <span class="c">! na</span>
<a name="ln-4688"></a>
<a name="ln-4689"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4690"></a>          <span class="c">! na</span>
<a name="ln-4691"></a>
<a name="ln-4692"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4693"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">H</span>       <span class="c">! Hour angle (before noon = +)</span>
<a name="ln-4694"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SinAltitude</span><span class="p">,</span><span class="n">SolarAltitude</span><span class="p">,</span><span class="n">SolarAzimuth</span><span class="p">,</span><span class="n">SolarZenith</span>
<a name="ln-4695"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CosAzimuth</span><span class="p">,</span><span class="n">CosZenith</span>
<a name="ln-4696"></a><span class="c">!  REAL(r64) HAngle</span>
<a name="ln-4697"></a>
<a name="ln-4698"></a>          <span class="c">! COMPUTE THE HOUR ANGLE</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4701"></a><span class="k">    </span><span class="n">HrAngle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="mf">5.d0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="mf">2.d0</span><span class="o">-</span><span class="p">(</span><span class="n">CurrentTime</span><span class="o">+</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">EquationOfTime</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">TimeZoneMeridian</span><span class="o">-</span><span class="n">Longitude</span><span class="p">))</span>
<a name="ln-4702"></a>  <span class="k">ELSE</span>
<a name="ln-4703"></a><span class="k">    </span><span class="n">HrAngle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="mf">5.d0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="mf">2.d0</span><span class="o">-</span><span class="p">((</span><span class="n">CurrentTime</span><span class="o">+</span><span class="n">TS1TimeOffset</span><span class="p">)</span><span class="o">+</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">EquationOfTime</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">TimeZoneMeridian</span><span class="o">-</span><span class="n">Longitude</span><span class="p">))</span>
<a name="ln-4704"></a>  <span class="n">ENDIF</span>
<a name="ln-4705"></a>  <span class="n">H</span><span class="o">=</span><span class="n">HrAngle</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-4706"></a>
<a name="ln-4707"></a>          <span class="c">! Compute the Cosine of the Solar Zenith (Altitude) Angle.</span>
<a name="ln-4708"></a>  <span class="n">CosZenith</span><span class="o">=</span><span class="n">SinLatitude</span><span class="o">*</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">SinSolarDeclinAngle</span><span class="o">+</span><span class="n">CosLatitude</span><span class="o">*</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">CosSolarDeclinAngle</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-4709"></a>
<a name="ln-4710"></a>  <span class="n">SolarZenith</span><span class="o">=</span><span class="nb">ACOS</span><span class="p">(</span><span class="n">CosZenith</span><span class="p">)</span>
<a name="ln-4711"></a>  <span class="n">SinAltitude</span><span class="o">=</span><span class="n">CosLatitude</span><span class="o">*</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">CosSolarDeclinAngle</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">SinLatitude</span><span class="o">*</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">SinSolarDeclinAngle</span>
<a name="ln-4712"></a>  <span class="n">SolarAltitude</span><span class="o">=</span><span class="nb">ASIN</span><span class="p">(</span><span class="n">SinAltitude</span><span class="p">)</span>
<a name="ln-4713"></a>  <span class="n">CosAzimuth</span><span class="o">=-</span><span class="p">(</span><span class="n">SinLatitude</span><span class="o">*</span><span class="n">CosZenith</span><span class="o">-</span><span class="n">TodayVariables</span><span class="p">%</span><span class="n">SinSolarDeclinAngle</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CosLatitude</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SolarZenith</span><span class="p">))</span>
<a name="ln-4714"></a>  <span class="c">! Following because above can yield invalid cos value.  (e.g. at south pole)</span>
<a name="ln-4715"></a>  <span class="n">CosAzimuth</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">CosAzimuth</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4716"></a>  <span class="n">CosAzimuth</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">CosAzimuth</span><span class="p">)</span>
<a name="ln-4717"></a>  <span class="n">SolarAzimuth</span><span class="o">=</span><span class="nb">ACOS</span><span class="p">(</span><span class="n">CosAzimuth</span><span class="p">)</span>
<a name="ln-4718"></a>
<a name="ln-4719"></a>  <span class="n">SolarAltitudeAngle</span><span class="o">=</span><span class="n">SolarAltitude</span><span class="o">/</span><span class="n">DegToRadians</span>
<a name="ln-4720"></a>  <span class="n">SolarAzimuthAngle</span><span class="o">=</span><span class="n">SolarAzimuth</span><span class="o">/</span><span class="n">DegToRadians</span>
<a name="ln-4721"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HrAngle</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4722"></a><span class="k">    </span><span class="n">SolarAzimuthAngle</span><span class="o">=</span><span class="mi">36</span><span class="mf">0.d0</span><span class="o">-</span><span class="n">SolarAzimuthAngle</span>
<a name="ln-4723"></a>  <span class="n">ENDIF</span>
<a name="ln-4724"></a>
<a name="ln-4725"></a>  <span class="n">SunDirectionCosines</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosZenith</span>
<a name="ln-4726"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CosZenith</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4727"></a><span class="k">    </span><span class="n">SunIsUp</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4728"></a>    <span class="n">SunDirectionCosines</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4729"></a>    <span class="n">SunDirectionCosines</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4730"></a>  <span class="k">ELSE</span>
<a name="ln-4731"></a><span class="k">    </span><span class="n">SunIsUp</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4732"></a>    <span class="n">SunDirectionCosines</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">SinSolarDeclinAngle</span><span class="o">*</span><span class="n">CosLatitude</span>   <span class="p">&amp;</span>
<a name="ln-4733"></a>                             <span class="o">-</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">CosSolarDeclinAngle</span><span class="o">*</span><span class="n">SinLatitude</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-4734"></a>    <span class="n">SunDirectionCosines</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TodayVariables</span><span class="p">%</span><span class="n">CosSolarDeclinAngle</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-4735"></a>  <span class="n">ENDIF</span>
<a name="ln-4736"></a>
<a name="ln-4737"></a>  <span class="k">RETURN</span>
<a name="ln-4738"></a>
<a name="ln-4739"></a><span class="k">END SUBROUTINE </span><span class="n">DetermineSunUpDown</span>
<a name="ln-4740"></a>
<a name="ln-4741"></a>
<a name="ln-4742"></a><span class="k">SUBROUTINE </span><span class="n">OpenWeatherFile</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4743"></a>
<a name="ln-4744"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4745"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4746"></a>          <span class="c">!       DATE WRITTEN   June 1999</span>
<a name="ln-4747"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4748"></a>
<a name="ln-4749"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4750"></a>          <span class="c">! This subroutine checks to see if a weather file and what kind of weather file</span>
<a name="ln-4751"></a>          <span class="c">! exists in the working directory and calls appropriate routines to</span>
<a name="ln-4752"></a>          <span class="c">! open the files and set up for use.</span>
<a name="ln-4753"></a>
<a name="ln-4754"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4755"></a>          <span class="c">! na</span>
<a name="ln-4756"></a>
<a name="ln-4757"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4758"></a>          <span class="c">! na</span>
<a name="ln-4759"></a>
<a name="ln-4760"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4761"></a>          <span class="c">! na</span>
<a name="ln-4762"></a>
<a name="ln-4763"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4764"></a>
<a name="ln-4765"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4766"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-4767"></a>
<a name="ln-4768"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4769"></a>          <span class="c">! na</span>
<a name="ln-4770"></a>
<a name="ln-4771"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4772"></a>          <span class="c">! na</span>
<a name="ln-4773"></a>
<a name="ln-4774"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4775"></a>          <span class="c">! na</span>
<a name="ln-4776"></a>
<a name="ln-4777"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4778"></a>          <span class="c">! na</span>
<a name="ln-4779"></a>
<a name="ln-4780"></a>          <span class="c">! FLOW:</span>
<a name="ln-4781"></a>
<a name="ln-4782"></a>
<a name="ln-4783"></a>  <span class="k">INQUIRE</span><span class="p">(</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;in.epw&#39;</span><span class="p">,</span><span class="n">EXIST</span><span class="o">=</span><span class="n">WeatherFileExists</span><span class="p">)</span>
<a name="ln-4784"></a>
<a name="ln-4785"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WeatherFileExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4786"></a><span class="k">    CALL </span><span class="n">OpenEPlusWeatherFile</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-4787"></a>  <span class="n">ENDIF</span>
<a name="ln-4788"></a>
<a name="ln-4789"></a>  <span class="k">RETURN</span>
<a name="ln-4790"></a>
<a name="ln-4791"></a><span class="k">END SUBROUTINE </span><span class="n">OpenWeatherFile</span>
<a name="ln-4792"></a>
<a name="ln-4793"></a><span class="k">SUBROUTINE </span><span class="n">OpenEPlusWeatherFile</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ProcessHeader</span><span class="p">)</span>
<a name="ln-4794"></a>
<a name="ln-4795"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4796"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-4797"></a>          <span class="c">!       DATE WRITTEN   June 1999</span>
<a name="ln-4798"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4799"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4800"></a>
<a name="ln-4801"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4802"></a>          <span class="c">! This subroutine opens the EnergyPlus Weather File (in.epw) and processes</span>
<a name="ln-4803"></a>          <span class="c">! the initial header records.</span>
<a name="ln-4804"></a>
<a name="ln-4805"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4806"></a>          <span class="c">! List directed reads, as possible.</span>
<a name="ln-4807"></a>
<a name="ln-4808"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4809"></a>          <span class="c">! na</span>
<a name="ln-4810"></a>
<a name="ln-4811"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4812"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MakeUPPERCase</span>
<a name="ln-4813"></a>
<a name="ln-4814"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4815"></a>
<a name="ln-4816"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4817"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>     <span class="c">! Will be set to true if errors found</span>
<a name="ln-4818"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ProcessHeader</span>   <span class="c">! Set to true when headers should be processed (rather than just read)</span>
<a name="ln-4819"></a>
<a name="ln-4820"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4821"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AFormat</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-4822"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Header</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s2">&quot;LOCATION                &quot;</span><span class="p">,</span><span class="s2">&quot;DESIGN CONDITIONS       &quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4823"></a>                                                        <span class="s2">&quot;TYPICAL/EXTREME PERIODS &quot;</span><span class="p">,</span><span class="s2">&quot;GROUND TEMPERATURES     &quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4824"></a>                                                        <span class="s2">&quot;HOLIDAYS/DAYLIGHT SAVING&quot;</span><span class="p">,</span><span class="s2">&quot;COMMENTS 1              &quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4825"></a>                                                        <span class="s2">&quot;COMMENTS 2              &quot;</span><span class="p">,</span><span class="s2">&quot;DATA PERIODS            &quot;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-4826"></a>
<a name="ln-4827"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4828"></a>          <span class="c">! na</span>
<a name="ln-4829"></a>
<a name="ln-4830"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4831"></a>          <span class="c">! na</span>
<a name="ln-4832"></a>
<a name="ln-4833"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4834"></a>  <span class="kt">INTEGER </span><span class="n">GetNewUnitNumber</span>
<a name="ln-4835"></a>  <span class="kt">INTEGER </span><span class="n">Pos</span>
<a name="ln-4836"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span> <span class="n">Line</span>
<a name="ln-4837"></a>  <span class="kt">integer </span><span class="n">HdPos</span><span class="p">,</span><span class="n">HdLine</span>
<a name="ln-4838"></a>  <span class="kt">logical </span><span class="n">StillLooking</span>
<a name="ln-4839"></a>  <span class="kt">integer </span><span class="n">endcol</span>
<a name="ln-4840"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">FindNonSpace</span>
<a name="ln-4841"></a>  <span class="kt">LOGICAL </span><span class="n">EPWOpen</span>
<a name="ln-4842"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">unitnumber</span>
<a name="ln-4843"></a>
<a name="ln-4844"></a>  <span class="k">INQUIRE</span><span class="p">(</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;in.epw&#39;</span><span class="p">,</span><span class="n">NUMBER</span><span class="o">=</span><span class="n">unitnumber</span><span class="p">,</span><span class="n">OPENED</span><span class="o">=</span><span class="n">EPWOpen</span><span class="p">)</span>
<a name="ln-4845"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EPWOpen</span><span class="p">)</span> <span class="k">CLOSE</span><span class="p">(</span><span class="n">unitnumber</span><span class="p">)</span>
<a name="ln-4846"></a>
<a name="ln-4847"></a>  <span class="n">WeatherFileUnitNumber</span><span class="o">=</span><span class="n">GetNewUnitNumber</span><span class="p">()</span>
<a name="ln-4848"></a>  <span class="k">OPEN</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="k">File</span><span class="o">=</span><span class="s1">&#39;in.epw&#39;</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">9999</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">)</span>
<a name="ln-4849"></a>
<a name="ln-4850"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ProcessHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4851"></a>  <span class="c">! Read in Header Information</span>
<a name="ln-4852"></a>
<a name="ln-4853"></a>  <span class="c">! Headers should come in order</span>
<a name="ln-4854"></a>    <span class="n">HdLine</span><span class="o">=</span><span class="mi">1</span>   <span class="c">! Look for first Header</span>
<a name="ln-4855"></a>    <span class="n">StillLooking</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4856"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">StillLooking</span><span class="p">)</span>
<a name="ln-4857"></a>      <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">AFormat</span><span class="p">,</span><span class="k">END</span><span class="o">=</span><span class="mi">9998</span><span class="p">)</span> <span class="n">line</span>
<a name="ln-4858"></a>      <span class="n">endcol</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-4859"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">endcol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4860"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">))</span> <span class="o">==</span> <span class="n">iASCII_CR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4861"></a><span class="k">          </span><span class="n">StripCR</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4862"></a>          <span class="n">line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-4863"></a>        <span class="n">ENDIF</span>
<a name="ln-4864"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">))</span> <span class="o">==</span> <span class="n">iUnicode_end</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4865"></a><span class="k">          GOTO </span><span class="mi">9997</span>
<a name="ln-4866"></a>        <span class="n">ENDIF</span>
<a name="ln-4867"></a>      <span class="n">ENDIF</span>
<a name="ln-4868"></a>      <span class="n">Pos</span><span class="o">=</span><span class="n">FindNonSpace</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-4869"></a>      <span class="n">HdPos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Header</span><span class="p">(</span><span class="n">HdLine</span><span class="p">)))</span>
<a name="ln-4870"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="n">HdPos</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4871"></a><span class="c">!      line=MakeUPPERCase(line)</span>
<a name="ln-4872"></a>      <span class="k">CALL </span><span class="n">ProcessEPWHeader</span><span class="p">(</span><span class="n">Header</span><span class="p">(</span><span class="n">HdLine</span><span class="p">),</span><span class="n">line</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4873"></a>      <span class="n">HdLine</span><span class="o">=</span><span class="n">HdLine</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4874"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HdLine</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="n">StillLooking</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4875"></a>    <span class="n">ENDDO</span>
<a name="ln-4876"></a>  <span class="k">ELSE</span>  <span class="c">! Header already processed, just read</span>
<a name="ln-4877"></a>    <span class="k">CALL </span><span class="n">SkipEPLusWFHeader</span>
<a name="ln-4878"></a>  <span class="n">ENDIF</span>
<a name="ln-4879"></a>
<a name="ln-4880"></a>  <span class="k">RETURN</span>
<a name="ln-4881"></a>
<a name="ln-4882"></a><span class="k">  </span><span class="mi">9997</span> <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;OpenWeatherFile: EPW Weather File appears to be a Unicode or binary file.&#39;</span><span class="p">,</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-4883"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...This file cannot be read by this program. Please save as PC or Unix file and try again&#39;</span><span class="p">)</span>
<a name="ln-4884"></a>       <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminates due to previous condition.&#39;</span><span class="p">)</span>
<a name="ln-4885"></a>
<a name="ln-4886"></a>  <span class="mi">9998</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;OpenWeatherFile: Unexpected End-of-File on EPW Weather file, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4887"></a>                           <span class="s1">&#39;while reading header information, looking for header=&#39;</span><span class="o">//</span>          <span class="p">&amp;</span>
<a name="ln-4888"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">Header</span><span class="p">(</span><span class="n">HdLine</span><span class="p">)),</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-4889"></a>
<a name="ln-4890"></a>  <span class="mi">9999</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;OpenWeatherFile: Could not OPEN EPW Weather File&#39;</span><span class="p">,</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-4891"></a>
<a name="ln-4892"></a>  <span class="k">RETURN</span>
<a name="ln-4893"></a>
<a name="ln-4894"></a><span class="k">END SUBROUTINE </span><span class="n">OpenEPlusWeatherFile</span>
<a name="ln-4895"></a>
<a name="ln-4896"></a><span class="k">SUBROUTINE </span><span class="n">CloseWeatherFile</span>
<a name="ln-4897"></a>
<a name="ln-4898"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4899"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4900"></a>          <span class="c">!       DATE WRITTEN   February 2001</span>
<a name="ln-4901"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4902"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4903"></a>
<a name="ln-4904"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4905"></a>          <span class="c">! This subroutine closes the open weather file.</span>
<a name="ln-4906"></a>
<a name="ln-4907"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4908"></a>          <span class="c">! na</span>
<a name="ln-4909"></a>
<a name="ln-4910"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4911"></a>          <span class="c">! na</span>
<a name="ln-4912"></a>
<a name="ln-4913"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4914"></a>          <span class="c">! na</span>
<a name="ln-4915"></a>
<a name="ln-4916"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4917"></a>
<a name="ln-4918"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4919"></a>          <span class="c">! na</span>
<a name="ln-4920"></a>
<a name="ln-4921"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4922"></a>          <span class="c">! na</span>
<a name="ln-4923"></a>
<a name="ln-4924"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4925"></a>          <span class="c">! na</span>
<a name="ln-4926"></a>
<a name="ln-4927"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4928"></a>          <span class="c">! na</span>
<a name="ln-4929"></a>
<a name="ln-4930"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4931"></a>  <span class="kt">LOGICAL </span><span class="n">EPWOpen</span>
<a name="ln-4932"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">unitnumber</span>
<a name="ln-4933"></a>
<a name="ln-4934"></a>  <span class="c">!  Make sure it&#39;s open</span>
<a name="ln-4935"></a>
<a name="ln-4936"></a>  <span class="k">INQUIRE</span><span class="p">(</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;in.epw&#39;</span><span class="p">,</span><span class="n">NUMBER</span><span class="o">=</span><span class="n">unitnumber</span><span class="p">,</span><span class="n">OPENED</span><span class="o">=</span><span class="n">EPWOpen</span><span class="p">)</span>
<a name="ln-4937"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EPWOpen</span><span class="p">)</span> <span class="k">CLOSE</span><span class="p">(</span><span class="n">unitnumber</span><span class="p">)</span>
<a name="ln-4938"></a>
<a name="ln-4939"></a>  <span class="k">RETURN</span>
<a name="ln-4940"></a>
<a name="ln-4941"></a><span class="k">END SUBROUTINE </span><span class="n">CloseWeatherFile</span>
<a name="ln-4942"></a>
<a name="ln-4943"></a><span class="k">SUBROUTINE </span><span class="n">ResolveLocationInformation</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4944"></a>
<a name="ln-4945"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4946"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-4947"></a>          <span class="c">!       DATE WRITTEN   June 1997</span>
<a name="ln-4948"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4949"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4950"></a>
<a name="ln-4951"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4952"></a>          <span class="c">! This subroutine is currently the main interface between the old data</span>
<a name="ln-4953"></a>          <span class="c">! structure on the BLAST Weather file and the new data structure contained</span>
<a name="ln-4954"></a>          <span class="c">! in this module.  At some point, this subroutine will be converted</span>
<a name="ln-4955"></a>          <span class="c">! to read information directly from the new input file.</span>
<a name="ln-4956"></a>
<a name="ln-4957"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4958"></a>          <span class="c">! na</span>
<a name="ln-4959"></a>
<a name="ln-4960"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4961"></a>          <span class="c">! na</span>
<a name="ln-4962"></a>
<a name="ln-4963"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4964"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-4965"></a>
<a name="ln-4966"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4967"></a>
<a name="ln-4968"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4969"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>   <span class="c">! Set to true if no location evident</span>
<a name="ln-4970"></a>
<a name="ln-4971"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4972"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">LocHdFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;! &lt;Site:Location&gt;, Location Name, Latitude {N+/S- Deg}, Longitude {E+/W- Deg}, &#39;,  &amp;</span>
<a name="ln-4973"></a><span class="s2">                                                &amp; &#39; Time Zone Number {GMT+/-}, Elevation {m}, &#39;,  &amp;</span>
<a name="ln-4974"></a><span class="s2">                                                &amp; &#39; Standard Pressure at Elevation {Pa}, Standard RhoAir at Elevation&#39;)&quot;</span>
<a name="ln-4975"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">LocFormat</span><span class="o">=</span><span class="s2">&quot;(&#39;Site:Location&#39;,7(&#39;,&#39;,A))&quot;</span>
<a name="ln-4976"></a>
<a name="ln-4977"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4978"></a>          <span class="c">! na</span>
<a name="ln-4979"></a>
<a name="ln-4980"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4981"></a>          <span class="c">! na</span>
<a name="ln-4982"></a>
<a name="ln-4983"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4984"></a>          <span class="c">! na</span>
<a name="ln-4985"></a>
<a name="ln-4986"></a>          <span class="c">! FLOW:</span>
<a name="ln-4987"></a>
<a name="ln-4988"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">NumOfEnvrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WeatherFileExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4989"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">LocationGathered</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4990"></a>      <span class="c">! See if &quot;matching&quot; location</span>
<a name="ln-4991"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Latitude</span><span class="o">-</span><span class="n">WeatherFileLatitude</span><span class="p">)</span>    <span class="o">&gt;</span> <span class="mf">1.d0</span>   <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4992"></a>          <span class="nb">ABS</span><span class="p">(</span><span class="n">Longitude</span><span class="o">-</span><span class="n">WeatherFileLongitude</span><span class="p">)</span>    <span class="o">&gt;</span> <span class="mf">1.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4993"></a>          <span class="nb">ABS</span><span class="p">(</span><span class="n">TimeZoneNumber</span><span class="o">-</span><span class="n">WeatherFileTimeZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4994"></a>          <span class="nb">ABS</span><span class="p">(</span><span class="n">Elevation</span><span class="o">-</span><span class="n">WeatherFileElevation</span><span class="p">)</span><span class="o">/</span><span class="nb">Max</span><span class="p">(</span><span class="n">Elevation</span><span class="p">,</span><span class="mf">1.d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">10</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4995"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Weather file location will be used rather than entered (IDF) Location object.&#39;</span><span class="p">)</span>
<a name="ln-4996"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Location object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">LocationTitle</span><span class="p">))</span>
<a name="ln-4997"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Weather File Location=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WeatherFileLocationTitle</span><span class="p">))</span>
<a name="ln-4998"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..due to location differences, Latitude difference=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4999"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Latitude</span><span class="o">-</span><span class="n">WeatherFileLatitude</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] degrees, Longitude difference=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5000"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Longitude</span><span class="o">-</span><span class="n">WeatherFileLongitude</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] degrees.&#39;</span><span class="p">)</span>
<a name="ln-5001"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Time Zone difference=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5002"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TimeZoneNumber</span><span class="o">-</span><span class="n">WeatherFileTimeZone</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] hour(s), Elevation difference=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5003"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">Elevation</span><span class="o">-</span><span class="n">WeatherFileElevation</span><span class="p">)</span><span class="o">/</span><span class="nb">Max</span><span class="p">(</span><span class="n">Elevation</span><span class="p">,</span><span class="mf">1.d0</span><span class="p">))</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] percent,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5004"></a>              <span class="s1">&#39; [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Elevation</span><span class="o">-</span><span class="n">WeatherFileElevation</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] meters.&#39;</span><span class="p">)</span>
<a name="ln-5005"></a>      <span class="n">ENDIF</span>
<a name="ln-5006"></a>    <span class="n">ENDIF</span>
<a name="ln-5007"></a>
<a name="ln-5008"></a>    <span class="n">LocationTitle</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span>
<a name="ln-5009"></a>    <span class="n">Latitude</span> <span class="o">=</span> <span class="n">WeatherFileLatitude</span>
<a name="ln-5010"></a>    <span class="n">Longitude</span> <span class="o">=</span> <span class="n">WeatherFileLongitude</span>
<a name="ln-5011"></a>    <span class="n">TimeZoneNumber</span> <span class="o">=</span> <span class="n">WeatherFileTimeZone</span>
<a name="ln-5012"></a>    <span class="n">Elevation</span><span class="o">=</span><span class="n">WeatherFileElevation</span>
<a name="ln-5013"></a>  <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">LocationGathered</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5014"></a><span class="k">    </span><span class="n">LocationTitle</span><span class="o">=</span><span class="s1">&#39;Not Entered&#39;</span>
<a name="ln-5015"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No Location given. Must have location information for simulation.&#39;</span><span class="p">)</span>
<a name="ln-5016"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5017"></a>  <span class="k">END IF</span>
<a name="ln-5018"></a>
<a name="ln-5019"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5020"></a><span class="k">    </span><span class="n">StdBaroPress</span><span class="o">=</span><span class="mi">10</span><span class="mf">1.325d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="mf">2.25577d-05</span><span class="o">*</span><span class="n">Elevation</span><span class="p">)</span><span class="o">**</span><span class="mf">5.2559d0</span>
<a name="ln-5021"></a>    <span class="n">StdBaroPress</span><span class="o">=</span><span class="n">StdBaroPress</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.d0</span>
<a name="ln-5022"></a>    <span class="n">StdRhoAir</span><span class="o">=</span><span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">constant_twenty</span><span class="p">,</span><span class="n">constant_zero</span><span class="p">)</span>
<a name="ln-5023"></a>    <span class="c">! Write Final Location Information to the initialization output file</span>
<a name="ln-5024"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">LocHdFormat</span><span class="p">)</span>
<a name="ln-5025"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">LocFormat</span><span class="p">)</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">LocationTitle</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Latitude</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-5026"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Longitude</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-5027"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TimeZoneNumber</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-5028"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Elevation</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-5029"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-5030"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">StdRhoAir</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-5031"></a>  <span class="n">ENDIF</span>
<a name="ln-5032"></a>
<a name="ln-5033"></a>  <span class="k">RETURN</span>
<a name="ln-5034"></a>
<a name="ln-5035"></a><span class="k">END SUBROUTINE </span><span class="n">ResolveLocationInformation</span>
<a name="ln-5036"></a>
<a name="ln-5037"></a><span class="k">SUBROUTINE </span><span class="n">CheckLocationValidity</span>
<a name="ln-5038"></a>
<a name="ln-5039"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5040"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-5041"></a>          <span class="c">!       DATE WRITTEN   June 1997</span>
<a name="ln-5042"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5043"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5046"></a>          <span class="c">! This subroutine is checks to see whether the user specified location</span>
<a name="ln-5047"></a>          <span class="c">! or the weather file location (if one exists) is valid.  The standard</span>
<a name="ln-5048"></a>          <span class="c">! time meridian is also calculated and compared to the user supplied</span>
<a name="ln-5049"></a>          <span class="c">! or weather file time zone number.</span>
<a name="ln-5050"></a>
<a name="ln-5051"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5052"></a>          <span class="c">! na</span>
<a name="ln-5053"></a>
<a name="ln-5054"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5055"></a>          <span class="c">! Legacy subroutine CKBLDE.</span>
<a name="ln-5056"></a>
<a name="ln-5057"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5058"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-5059"></a>
<a name="ln-5060"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5061"></a>
<a name="ln-5062"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5063"></a>          <span class="c">! na</span>
<a name="ln-5064"></a>
<a name="ln-5065"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5066"></a>          <span class="c">! na</span>
<a name="ln-5067"></a>
<a name="ln-5068"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5069"></a>          <span class="c">! na</span>
<a name="ln-5070"></a>
<a name="ln-5071"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5072"></a>          <span class="c">! na</span>
<a name="ln-5073"></a>
<a name="ln-5074"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5075"></a>
<a name="ln-5076"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">LocationError</span>  <span class="c">! Set to true if there is a problem detected</span>
<a name="ln-5077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">StdTimeMerid</span>   <span class="c">! Standard time meridian</span>
<a name="ln-5078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Diffcalc</span>       <span class="c">! Difference between Standard Time Meridian and TimeZone</span>
<a name="ln-5079"></a>
<a name="ln-5080"></a>          <span class="c">! FLOW:</span>
<a name="ln-5081"></a>
<a name="ln-5082"></a>  <span class="n">LocationError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5083"></a>
<a name="ln-5084"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Latitude</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Longitude</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5085"></a>                             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeZoneNumber</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5086"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No location specified&#39;</span><span class="p">)</span>
<a name="ln-5087"></a>    <span class="n">LocationError</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5088"></a>  <span class="k">END IF</span>
<a name="ln-5089"></a>
<a name="ln-5090"></a><span class="k">  IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Latitude</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="mi">9</span><span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Latitude</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">9</span><span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5091"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Latitude must be between -90 and 90; Entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Latitude</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5092"></a>    <span class="n">LocationError</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5093"></a>  <span class="k">END IF</span>
<a name="ln-5094"></a>
<a name="ln-5095"></a><span class="k">  IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Longitude</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="mi">18</span><span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Longitude</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">18</span><span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5096"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Longitude must be between -180 and 180; Entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Longitude</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5097"></a>    <span class="n">LocationError</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5098"></a>  <span class="k">END IF</span>
<a name="ln-5099"></a>
<a name="ln-5100"></a><span class="k">  IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">TimeZoneNumber</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="mf">2.00d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeZoneNumber</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="mf">4.00d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5101"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Time Zone must be between -12 and +14; Entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TimeZoneNumber</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5102"></a>    <span class="n">LocationError</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5103"></a>  <span class="k">END IF</span>
<a name="ln-5104"></a>
<a name="ln-5105"></a><span class="k">  </span><span class="n">StdTimeMerid</span><span class="o">=</span><span class="n">GetSTM</span><span class="p">(</span><span class="n">Longitude</span><span class="p">)</span>    <span class="c">! Obtain the standard time meridian.</span>
<a name="ln-5106"></a>
<a name="ln-5107"></a>  <span class="c">! Bias at +/- 12 for StdTimeMerid</span>
<a name="ln-5108"></a><span class="c">!  IF (StdTimeMerid == -12.0 .and. TimeZoneNumber &gt; 0) THEN</span>
<a name="ln-5109"></a><span class="c">!    StdTimeMerid=12.0</span>
<a name="ln-5110"></a><span class="c">!  ELSEIF (StdTimeMerid == 12.0 .and. TimeZoneNumber &lt; 0) THEN</span>
<a name="ln-5111"></a><span class="c">!    StdTimeMerid=-12.0</span>
<a name="ln-5112"></a><span class="c">!  ENDIF</span>
<a name="ln-5113"></a>
<a name="ln-5114"></a>          <span class="c">! Compare the standard time meridian with the time zone number.  If</span>
<a name="ln-5115"></a>          <span class="c">! different, notify the user.  If StdTimeMerid couldn&#39;t be calculated,</span>
<a name="ln-5116"></a>          <span class="c">! produce an error message.</span>
<a name="ln-5117"></a>
<a name="ln-5118"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">StdTimeMerid</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="mf">2.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">StdTimeMerid</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5119"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TimeZoneNumber</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">StdTimeMerid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5120"></a><span class="k">      </span><span class="n">DiffCalc</span><span class="o">=</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TimeZoneNumber</span><span class="o">-</span><span class="n">StdTimeMerid</span><span class="p">)</span>
<a name="ln-5121"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DiffCalc</span> <span class="o">&gt;</span> <span class="mf">1.d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DiffCalc</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="mf">4.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5122"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DiffCalc</span> <span class="o">&lt;</span> <span class="mf">3.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5123"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Standard Time Meridian and Time Zone differ by more than 1, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5124"></a>             <span class="s1">&#39;Difference=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DiffCalc</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5125"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Solar Positions may be incorrect&#39;</span><span class="p">)</span>
<a name="ln-5126"></a>        <span class="k">ELSE</span>
<a name="ln-5127"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Standard Time Meridian and Time Zone differ by more than 2, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5128"></a>             <span class="s1">&#39;Difference=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DiffCalc</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5129"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Solar Positions will be incorrect&#39;</span><span class="p">)</span>
<a name="ln-5130"></a><span class="c">!          LocationError=.true.</span>
<a name="ln-5131"></a>        <span class="n">ENDIF</span>
<a name="ln-5132"></a>      <span class="n">ENDIF</span>
<a name="ln-5133"></a>    <span class="n">ENDIF</span>
<a name="ln-5134"></a>  <span class="k">ELSE</span>
<a name="ln-5135"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Unable to calculate the standard time meridian&#39;</span><span class="p">)</span>
<a name="ln-5136"></a>    <span class="n">LocationError</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5137"></a>  <span class="n">ENDIF</span>
<a name="ln-5138"></a>
<a name="ln-5139"></a>          <span class="c">! Error handling:  if there are any errors in the location information</span>
<a name="ln-5140"></a>          <span class="c">! the simulation must be terminated</span>
<a name="ln-5141"></a>
<a name="ln-5142"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">LocationError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5143"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Due to previous error condition, simulation terminated&#39;</span><span class="p">)</span>
<a name="ln-5144"></a>  <span class="n">ENDIF</span>
<a name="ln-5145"></a>
<a name="ln-5146"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TimeZoneNumber</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="mf">2.00d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5147"></a><span class="k">    </span><span class="n">TimeZoneMeridian</span><span class="o">=</span><span class="n">TimeZoneNumber</span><span class="o">*</span><span class="mi">1</span><span class="mf">5.d0</span>
<a name="ln-5148"></a>  <span class="k">ELSE</span>
<a name="ln-5149"></a><span class="k">    </span><span class="n">TimeZoneMeridian</span><span class="o">=</span><span class="n">TimeZoneNumber</span><span class="o">*</span><span class="mi">1</span><span class="mf">5.d0</span><span class="o">-</span><span class="mi">36</span><span class="mf">0.d0</span>
<a name="ln-5150"></a>  <span class="n">ENDIF</span>
<a name="ln-5151"></a>  <span class="n">SinLatitude</span><span class="o">=</span><span class="nb">SIN</span><span class="p">(</span><span class="n">DegToRadians</span><span class="o">*</span><span class="n">Latitude</span><span class="p">)</span>
<a name="ln-5152"></a>  <span class="n">CosLatitude</span><span class="o">=</span><span class="nb">COS</span><span class="p">(</span><span class="n">DegToRadians</span><span class="o">*</span><span class="n">Latitude</span><span class="p">)</span>
<a name="ln-5153"></a>
<a name="ln-5154"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Latitude</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Longitude</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeZoneNumber</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5155"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Did you realize that you have Latitude=0.0, Longitude=0.0 and TimeZone=0.0?&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5156"></a>                          <span class="s1">&#39;  Your building site is in the middle of the Atlantic Ocean.&#39;</span><span class="p">)</span>
<a name="ln-5157"></a>  <span class="n">ENDIF</span>
<a name="ln-5158"></a>
<a name="ln-5159"></a>  <span class="k">RETURN</span>
<a name="ln-5160"></a>
<a name="ln-5161"></a><span class="k">END SUBROUTINE </span><span class="n">CheckLocationValidity</span>
<a name="ln-5162"></a>
<a name="ln-5163"></a><span class="k">SUBROUTINE </span><span class="n">CheckWeatherFileValidity</span>
<a name="ln-5164"></a>
<a name="ln-5165"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5166"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-5167"></a>          <span class="c">!       DATE WRITTEN   February 1977</span>
<a name="ln-5168"></a>          <span class="c">!       MODIFIED       June 1997 (RKS)</span>
<a name="ln-5169"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5170"></a>
<a name="ln-5171"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5172"></a>          <span class="c">! This subroutine contains a portion of the legacy subroutine CKBLDE.</span>
<a name="ln-5173"></a>          <span class="c">! The main purpose of this routine is to check the validity of the</span>
<a name="ln-5174"></a>          <span class="c">! weather dates provided by the user and the attached weather file.</span>
<a name="ln-5175"></a>          <span class="c">! These functions may eventually be pushed to an interface.  This</span>
<a name="ln-5176"></a>          <span class="c">! routine also sends the weather file header information at the</span>
<a name="ln-5177"></a>          <span class="c">! Environment derived type.</span>
<a name="ln-5178"></a>
<a name="ln-5179"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5180"></a>          <span class="c">! na</span>
<a name="ln-5181"></a>
<a name="ln-5182"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5183"></a>          <span class="c">! Legacy subroutine CKBLDE.</span>
<a name="ln-5184"></a>
<a name="ln-5185"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5186"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span>
<a name="ln-5187"></a>
<a name="ln-5188"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5189"></a>
<a name="ln-5190"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5191"></a>          <span class="c">! na</span>
<a name="ln-5192"></a>
<a name="ln-5193"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5194"></a>          <span class="c">! na</span>
<a name="ln-5195"></a>
<a name="ln-5196"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5197"></a>          <span class="c">! na</span>
<a name="ln-5198"></a>
<a name="ln-5199"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5200"></a>          <span class="c">! na</span>
<a name="ln-5201"></a>
<a name="ln-5202"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5203"></a>          <span class="c">! na</span>
<a name="ln-5204"></a>
<a name="ln-5205"></a>          <span class="c">! FLOW:</span>
<a name="ln-5206"></a>
<a name="ln-5207"></a>  <span class="n">ErrorInWeatherFile</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5208"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WeatherFileExists</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! No weather file exists but the user requested one--print error message</span>
<a name="ln-5209"></a>
<a name="ln-5210"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DoWeathSim</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5211"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Weather Environment(s) requested, but no weather file found&#39;</span><span class="p">)</span>
<a name="ln-5212"></a>      <span class="n">ErrorInWeatherFile</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5213"></a>    <span class="n">ENDIF</span>
<a name="ln-5214"></a>
<a name="ln-5215"></a>  <span class="k">END IF</span>  <span class="c">! ... end of WeatherFileExists IF-THEN</span>
<a name="ln-5216"></a>
<a name="ln-5217"></a>  <span class="k">RETURN</span>
<a name="ln-5218"></a>
<a name="ln-5219"></a><span class="k">END SUBROUTINE </span><span class="n">CheckWeatherFileValidity</span>
<a name="ln-5220"></a>
<a name="ln-5221"></a><span class="k">SUBROUTINE </span><span class="n">ReportOutputFileHeaders</span>
<a name="ln-5222"></a>
<a name="ln-5223"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5224"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-5225"></a>          <span class="c">!       DATE WRITTEN   June 1997</span>
<a name="ln-5226"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5227"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5228"></a>
<a name="ln-5229"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5230"></a>          <span class="c">! This subroutine prints out the necessary header information required</span>
<a name="ln-5231"></a>          <span class="c">! by the EnergyPlus output file format.  This subroutine can be</span>
<a name="ln-5232"></a>          <span class="c">! replicated in any other modules which must send data to the output</span>
<a name="ln-5233"></a>          <span class="c">! file.</span>
<a name="ln-5234"></a>
<a name="ln-5235"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5236"></a>          <span class="c">! For each report, the report flag integer must be saved from the</span>
<a name="ln-5237"></a>          <span class="c">! global report number counter.  Then, the report counter must be</span>
<a name="ln-5238"></a>          <span class="c">! incremented.  Finally, the header information for the report must</span>
<a name="ln-5239"></a>          <span class="c">! be sent to the output file.</span>
<a name="ln-5240"></a>
<a name="ln-5241"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5242"></a>          <span class="c">! EnergyPlus Output Description document.</span>
<a name="ln-5243"></a>
<a name="ln-5244"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5245"></a>  <span class="k">USE </span><span class="n">OutputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepStampReportNbr</span><span class="p">,</span><span class="n">DailyStampReportNbr</span><span class="p">,</span><span class="n">MonthlyStampReportNbr</span><span class="p">,</span><span class="n">RunPeriodStampReportNbr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5246"></a>                             <span class="n">TimeStepStampReportChr</span><span class="p">,</span><span class="n">DailyStampReportChr</span><span class="p">,</span><span class="n">MonthlyStampReportChr</span><span class="p">,</span><span class="n">RunPeriodStampReportChr</span>
<a name="ln-5247"></a>
<a name="ln-5248"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5249"></a>
<a name="ln-5250"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5251"></a>          <span class="c">! na</span>
<a name="ln-5252"></a>
<a name="ln-5253"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5254"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">IntFmt</span><span class="o">=</span><span class="s2">&quot;(I3)&quot;</span>
<a name="ln-5255"></a>
<a name="ln-5256"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5257"></a>          <span class="c">! na</span>
<a name="ln-5258"></a>
<a name="ln-5259"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5260"></a>          <span class="c">! na</span>
<a name="ln-5261"></a>
<a name="ln-5262"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5263"></a>
<a name="ln-5264"></a>                                       <span class="c">! Format descriptor for the environment title</span>
<a name="ln-5265"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvironmentFormat</span> <span class="o">=</span> <span class="s2">&quot;(a,&#39;,5,Environment Title[],Latitude[deg],&quot;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5266"></a>                                 <span class="s2">&quot;Longitude[deg],Time Zone[],Elevation[m]&#39;)&quot;</span>
<a name="ln-5267"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>  <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TimeStepFormat</span>        <span class="o">=</span> <span class="s2">&quot;(a,&#39;,6,Day of Simulation[],Month[],Day of Month[],&quot;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5268"></a>                                 <span class="s2">&quot;DST Indicator[1=yes 0=no],Hour[],StartMinute[],EndMinute[],DayType&#39;)&quot;</span>
<a name="ln-5269"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>  <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DailyFormat</span>        <span class="o">=</span> <span class="s2">&quot;(a,&#39;,3,Cumulative Day of Simulation[],Month[],Day of Month[],&quot;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5270"></a>                                 <span class="s2">&quot;DST Indicator[1=yes 0=no],DayType  ! When Daily &#39;,A,&#39; Requested&#39;)&quot;</span>
<a name="ln-5271"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>  <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MonthlyFormat</span>        <span class="o">=</span> <span class="s2">&quot;(a,&#39;,2,Cumulative Days of Simulation[],Month[]&quot;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5272"></a>                                 <span class="s2">&quot;  ! When Monthly &#39;,A,&#39; Requested&#39;)&quot;</span>
<a name="ln-5273"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>  <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RunPeriodFormat</span>        <span class="o">=</span> <span class="s2">&quot;(a,&#39;,1,Cumulative Days of Simulation[]&quot;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5274"></a>                                 <span class="s2">&quot; ! When Run Period &#39;,A,&#39; Requested&#39;)&quot;</span>
<a name="ln-5275"></a>
<a name="ln-5276"></a>          <span class="c">! FLOW:</span>
<a name="ln-5277"></a>
<a name="ln-5278"></a>  <span class="k">CALL </span><span class="n">AssignReportNumber</span><span class="p">(</span><span class="n">EnvironmentReportNbr</span><span class="p">)</span>
<a name="ln-5279"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EnvironmentReportNbr</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!  problem</span>
<a name="ln-5280"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;ReportOutputFileHeaders: Assigned report number for Environment title is not 1.  Contact Support.&#39;</span><span class="p">)</span>
<a name="ln-5281"></a>  <span class="n">ENDIF</span>
<a name="ln-5282"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">EnvironmentReportChr</span><span class="p">,</span><span class="n">IntFmt</span><span class="p">)</span> <span class="n">EnvironmentReportNbr</span>
<a name="ln-5283"></a>  <span class="n">EnvironmentReportChr</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">EnvironmentReportChr</span><span class="p">)</span>
<a name="ln-5284"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileStandard</span><span class="p">,</span><span class="n">EnvironmentFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentReportChr</span><span class="p">)</span>
<a name="ln-5285"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileMeters</span><span class="p">,</span><span class="n">EnvironmentFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentReportChr</span><span class="p">)</span>
<a name="ln-5286"></a>
<a name="ln-5287"></a>  <span class="k">CALL </span><span class="n">AssignReportNumber</span><span class="p">(</span><span class="n">TimeStepStampReportNbr</span><span class="p">)</span>
<a name="ln-5288"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">TimeStepStampReportChr</span><span class="p">,</span><span class="n">IntFmt</span><span class="p">)</span> <span class="n">TimeStepStampReportNbr</span>
<a name="ln-5289"></a>  <span class="n">TimeStepStampReportChr</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">TimeStepStampReportChr</span><span class="p">)</span>
<a name="ln-5290"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileStandard</span><span class="p">,</span><span class="n">TimeStepFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TimeStepStampReportChr</span><span class="p">)</span>
<a name="ln-5291"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileMeters</span><span class="p">,</span><span class="n">TimeStepFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TimeStepStampReportChr</span><span class="p">)</span>
<a name="ln-5292"></a>
<a name="ln-5293"></a>  <span class="k">CALL </span><span class="n">AssignReportNumber</span><span class="p">(</span><span class="n">DailyStampReportNbr</span><span class="p">)</span>
<a name="ln-5294"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">DailyStampReportChr</span><span class="p">,</span><span class="n">IntFmt</span><span class="p">)</span> <span class="n">DailyStampReportNbr</span>
<a name="ln-5295"></a>  <span class="n">DailyStampReportChr</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">DailyStampReportChr</span><span class="p">)</span>
<a name="ln-5296"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileStandard</span><span class="p">,</span><span class="n">DailyFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DailyStampReportChr</span><span class="p">),</span><span class="s1">&#39;Report Variables&#39;</span>
<a name="ln-5297"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileMeters</span><span class="p">,</span><span class="n">DailyFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">DailyStampReportChr</span><span class="p">),</span><span class="s1">&#39;Meters&#39;</span>
<a name="ln-5298"></a>
<a name="ln-5299"></a>  <span class="k">CALL </span><span class="n">AssignReportNumber</span><span class="p">(</span><span class="n">MonthlyStampReportNbr</span><span class="p">)</span>
<a name="ln-5300"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">MonthlyStampReportChr</span><span class="p">,</span><span class="n">IntFmt</span><span class="p">)</span> <span class="n">MonthlyStampReportNbr</span>
<a name="ln-5301"></a>  <span class="n">MonthlyStampReportChr</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">MonthlyStampReportChr</span><span class="p">)</span>
<a name="ln-5302"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileStandard</span><span class="p">,</span><span class="n">MonthlyFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">MonthlyStampReportChr</span><span class="p">),</span><span class="s1">&#39;Report Variables&#39;</span>
<a name="ln-5303"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileMeters</span><span class="p">,</span><span class="n">MonthlyFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">MonthlyStampReportChr</span><span class="p">),</span><span class="s1">&#39;Meters&#39;</span>
<a name="ln-5304"></a>
<a name="ln-5305"></a>  <span class="k">CALL </span><span class="n">AssignReportNumber</span><span class="p">(</span><span class="n">RunPeriodStampReportNbr</span><span class="p">)</span>
<a name="ln-5306"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">RunPeriodStampReportChr</span><span class="p">,</span><span class="n">IntFmt</span><span class="p">)</span> <span class="n">RunPeriodStampReportNbr</span>
<a name="ln-5307"></a>  <span class="n">RunPeriodStampReportChr</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">RunPeriodStampReportChr</span><span class="p">)</span>
<a name="ln-5308"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileStandard</span><span class="p">,</span><span class="n">RunPeriodFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodStampReportChr</span><span class="p">),</span><span class="s1">&#39;Report Variables&#39;</span>
<a name="ln-5309"></a>  <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileMeters</span><span class="p">,</span><span class="n">RunPeriodFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodStampReportChr</span><span class="p">),</span><span class="s1">&#39;Meters&#39;</span>
<a name="ln-5310"></a>
<a name="ln-5311"></a>  <span class="k">RETURN</span>
<a name="ln-5312"></a>
<a name="ln-5313"></a><span class="k">END SUBROUTINE </span><span class="n">ReportOutputFileHeaders</span>
<a name="ln-5314"></a>
<a name="ln-5315"></a><span class="k">SUBROUTINE </span><span class="n">ReportWeatherAndTimeInformation</span><span class="p">(</span><span class="n">PrintEnvrnStamp</span><span class="p">)</span>
<a name="ln-5316"></a>
<a name="ln-5317"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5318"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-5319"></a>          <span class="c">!       DATE WRITTEN   June 1997</span>
<a name="ln-5320"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5321"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5322"></a>
<a name="ln-5323"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5324"></a>          <span class="c">! This subroutine is the main driver of the weather reporting.  This</span>
<a name="ln-5325"></a>          <span class="c">! routine is also responsible for printing the time and environment</span>
<a name="ln-5326"></a>          <span class="c">! stamps.</span>
<a name="ln-5327"></a>
<a name="ln-5328"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5329"></a>          <span class="c">! Reporting is only done for non-warmup days.  The environment stamp</span>
<a name="ln-5330"></a>          <span class="c">! is only reported at the beginning of an environment, but after the</span>
<a name="ln-5331"></a>          <span class="c">! warmup days (to allow all modules to print the report headers to the</span>
<a name="ln-5332"></a>          <span class="c">! output file.  This is controlled by the PrintEnvrnStamp variable</span>
<a name="ln-5333"></a>          <span class="c">! which is passed in and reset if necessary.</span>
<a name="ln-5334"></a>
<a name="ln-5335"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5336"></a>          <span class="c">! na</span>
<a name="ln-5337"></a>
<a name="ln-5338"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5339"></a><span class="c">!unused0909  USE DataSystemVariables, ONLY: ReportDuringWarmup</span>
<a name="ln-5340"></a>
<a name="ln-5341"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5342"></a>
<a name="ln-5343"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5344"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">PrintEnvrnStamp</span>   <span class="c">! Set to true when the environment header should be printed</span>
<a name="ln-5345"></a>
<a name="ln-5346"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5347"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EndOfHeaderFormat</span> <span class="o">=</span> <span class="s2">&quot;(&#39;End of Data Dictionary&#39;)&quot;</span>    <span class="c">! End of data dictionary marker</span>
<a name="ln-5348"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnvironmentStampFormat</span> <span class="o">=</span> <span class="s2">&quot;(a,&#39;,&#39;,a,3(&#39;,&#39;,f7.2),&#39;,&#39;,f7.2)&quot;</span> <span class="c">! Format descriptor for environ stamp</span>
<a name="ln-5349"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: TimeStampFormat = &quot;(i3,&#39;,&#39;,i4,&#39;,&#39;,i2,&#39;,&#39;,i2,&#39;,&#39;,i2)&quot; ! Format descriptor for the date/time stamp</span>
<a name="ln-5350"></a>
<a name="ln-5351"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5352"></a>          <span class="c">! na</span>
<a name="ln-5353"></a>
<a name="ln-5354"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5355"></a>          <span class="c">! na</span>
<a name="ln-5356"></a>
<a name="ln-5357"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5358"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Title</span>
<a name="ln-5359"></a>
<a name="ln-5360"></a>          <span class="c">! FLOW:</span>
<a name="ln-5361"></a>
<a name="ln-5362"></a>          <span class="c">! Report the time stamp and the current weather to the output file</span>
<a name="ln-5363"></a>
<a name="ln-5364"></a>  <span class="n">Title</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-5365"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Write the required output information</span>
<a name="ln-5366"></a>
<a name="ln-5367"></a>          <span class="c">! The first time through in a non-warmup day, the environment header</span>
<a name="ln-5368"></a>          <span class="c">! must be printed.  This must be done here and not in the generic</span>
<a name="ln-5369"></a>          <span class="c">! BeginEnvrnFlag block above because other modules in the simulation</span>
<a name="ln-5370"></a>          <span class="c">! must also print out header information.  This can be done during</span>
<a name="ln-5371"></a>          <span class="c">! the simulation warmup if the environment stamp printing is delayed</span>
<a name="ln-5372"></a>          <span class="c">! until the warmup is completed.  The stamp should only be printed once</span>
<a name="ln-5373"></a>          <span class="c">! per environment (set/reset of PrintEnvrnStamp).  In addition, before</span>
<a name="ln-5374"></a>          <span class="c">! the first environment, the end of the header block flag must also be</span>
<a name="ln-5375"></a>          <span class="c">! sent to the output file.</span>
<a name="ln-5376"></a>
<a name="ln-5377"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PrintEnvrnStamp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5378"></a>
<a name="ln-5379"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PrintEndDataDictionary</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DoOutputReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5380"></a><span class="k">        WRITE</span> <span class="p">(</span><span class="n">OutputFileStandard</span><span class="p">,</span><span class="n">EndOfHeaderFormat</span><span class="p">)</span>
<a name="ln-5381"></a>        <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileMeters</span><span class="p">,</span><span class="n">EndOfHeaderFormat</span><span class="p">)</span>
<a name="ln-5382"></a>        <span class="n">PrintEndDataDictionary</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5383"></a>      <span class="n">ENDIF</span>
<a name="ln-5384"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DoOutputReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5385"></a><span class="k">        WRITE</span> <span class="p">(</span><span class="n">OutputFileStandard</span><span class="p">,</span><span class="n">EnvironmentStampFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentReportChr</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5386"></a>                  <span class="nb">Trim</span><span class="p">(</span><span class="n">Title</span><span class="p">),</span><span class="n">Latitude</span><span class="p">,</span><span class="n">Longitude</span><span class="p">,</span><span class="n">TimeZoneNumber</span><span class="p">,</span><span class="n">Elevation</span>
<a name="ln-5387"></a>        <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileMeters</span><span class="p">,</span><span class="n">EnvironmentStampFormat</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentReportChr</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5388"></a>                  <span class="nb">Trim</span><span class="p">(</span><span class="n">Title</span><span class="p">),</span><span class="n">Latitude</span><span class="p">,</span><span class="n">Longitude</span><span class="p">,</span><span class="n">TimeZoneNumber</span><span class="p">,</span><span class="n">Elevation</span>
<a name="ln-5389"></a>        <span class="n">PrintEnvrnStamp</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5390"></a>      <span class="k">END IF</span>
<a name="ln-5391"></a>
<a name="ln-5392"></a><span class="k">    END IF</span>
<a name="ln-5393"></a><span class="k">  END IF</span>    <span class="c">! ... end of .NOT.WarmupFlag IF-THEN block.</span>
<a name="ln-5394"></a>
<a name="ln-5395"></a>  <span class="k">RETURN</span>
<a name="ln-5396"></a>
<a name="ln-5397"></a><span class="k">END SUBROUTINE </span><span class="n">ReportWeatherAndTimeInformation</span>
<a name="ln-5398"></a>
<a name="ln-5399"></a>
<a name="ln-5400"></a><span class="k">SUBROUTINE </span><span class="n">ReadUserWeatherInput</span>
<a name="ln-5401"></a>
<a name="ln-5402"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5403"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-5404"></a>          <span class="c">!       DATE WRITTEN   September 1997</span>
<a name="ln-5405"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-5406"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5407"></a>
<a name="ln-5408"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5409"></a>          <span class="c">! This subroutine is the main driver of the weather manager module.</span>
<a name="ln-5410"></a>          <span class="c">! It controls the assignment of weather related global variables as</span>
<a name="ln-5411"></a>          <span class="c">! well as the reads and writes for retrieving weather information.</span>
<a name="ln-5412"></a>
<a name="ln-5413"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5414"></a>          <span class="c">!</span>
<a name="ln-5415"></a>
<a name="ln-5416"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5417"></a>          <span class="c">! na</span>
<a name="ln-5418"></a>
<a name="ln-5419"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5420"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-5421"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span>
<a name="ln-5422"></a>
<a name="ln-5423"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5424"></a>
<a name="ln-5425"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5426"></a>          <span class="c">! na</span>
<a name="ln-5427"></a>
<a name="ln-5428"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5429"></a>          <span class="c">! na</span>
<a name="ln-5430"></a>
<a name="ln-5431"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5432"></a>          <span class="c">! na</span>
<a name="ln-5433"></a>
<a name="ln-5434"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5435"></a>          <span class="c">! na</span>
<a name="ln-5436"></a>
<a name="ln-5437"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5438"></a>   <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">Env</span>           <span class="c">! Environment Loop Counter</span>
<a name="ln-5439"></a>   <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5440"></a>   <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">RPD1</span>
<a name="ln-5441"></a>   <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">RPD2</span>
<a name="ln-5442"></a>   <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">RP</span>    <span class="c">! number of run periods</span>
<a name="ln-5443"></a>   <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">RPAW</span>  <span class="c">! number of run periods, actual weather</span>
<a name="ln-5444"></a>
<a name="ln-5445"></a>
<a name="ln-5446"></a>          <span class="c">! FLOW:</span>
<a name="ln-5447"></a>
<a name="ln-5448"></a>      <span class="c">!Get the number of design days and annual runs from user inpout</span>
<a name="ln-5449"></a>      <span class="n">TotDesDays</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;SizingPeriod:DesignDay&#39;</span><span class="p">)</span>
<a name="ln-5450"></a>      <span class="n">RPD1</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;SizingPeriod:WeatherFileDays&#39;</span><span class="p">)</span>
<a name="ln-5451"></a>      <span class="n">RPD2</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;SizingPeriod:WeatherFileConditionType&#39;</span><span class="p">)</span>
<a name="ln-5452"></a>      <span class="n">RP</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;RunPeriod&#39;</span><span class="p">)</span>
<a name="ln-5453"></a>      <span class="n">RPAW</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;RunPeriod:CustomRange&#39;</span><span class="p">)</span>
<a name="ln-5454"></a>      <span class="n">TotRunPers</span><span class="o">=</span><span class="n">RP</span><span class="o">+</span><span class="n">RPAW</span>
<a name="ln-5455"></a>      <span class="n">NumOfEnvrn</span><span class="o">=</span><span class="n">TotDesDays</span><span class="o">+</span><span class="n">TotRunPers</span><span class="o">+</span><span class="n">RPD1</span><span class="o">+</span><span class="n">RPD2</span>
<a name="ln-5456"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotRunPers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5457"></a><span class="k">        </span><span class="n">WeathSimReq</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5458"></a>      <span class="k">ELSE</span>
<a name="ln-5459"></a><span class="k">        </span><span class="n">WeathSimReq</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5460"></a>      <span class="n">ENDIF</span>
<a name="ln-5461"></a>
<a name="ln-5462"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">TotDesDays</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-5463"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">TotDesDays</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-5464"></a>
<a name="ln-5465"></a>      <span class="n">SPSiteScheduleNamePtr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5466"></a>      <span class="n">SPSiteScheduleUnits</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-5467"></a>
<a name="ln-5468"></a>      <span class="c">!Allocate the Design Day and Environment array to the # of DD&#39;s or/and</span>
<a name="ln-5469"></a>      <span class="c">! Annual runs on input file</span>
<a name="ln-5470"></a>      <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DesignDay</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">))</span>
<a name="ln-5471"></a>      <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">NumOfEnvrn</span><span class="p">))</span>
<a name="ln-5472"></a>
<a name="ln-5473"></a>      <span class="c">! Set all Environments to False and then the weather environment will be set</span>
<a name="ln-5474"></a>      <span class="c">!  in the get annual run data subroutine</span>
<a name="ln-5475"></a>      <span class="k">Do </span><span class="n">Env</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotDesDays</span>
<a name="ln-5476"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Env</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksDesignDay</span>
<a name="ln-5477"></a>      <span class="k">End Do</span>
<a name="ln-5478"></a><span class="k">      Do </span><span class="n">Env</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">RPD1</span><span class="o">+</span><span class="n">RPD2</span>
<a name="ln-5479"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DDOnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5480"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">TotDesDays</span><span class="o">+</span><span class="n">Env</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksRunPeriodDesign</span>
<a name="ln-5481"></a>          <span class="k">ELSE</span>
<a name="ln-5482"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">TotDesDays</span><span class="o">+</span><span class="n">Env</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksRunPeriodWeather</span>
<a name="ln-5483"></a>          <span class="n">ENDIF</span>
<a name="ln-5484"></a>      <span class="k">End Do</span>
<a name="ln-5485"></a><span class="k">      Do </span><span class="n">Env</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotRunPers</span>
<a name="ln-5486"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">TotDesDays</span><span class="o">+</span><span class="n">RPD1</span><span class="o">+</span><span class="n">RPD2</span><span class="o">+</span><span class="n">Env</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksRunPeriodWeather</span>
<a name="ln-5487"></a>      <span class="k">End Do</span>
<a name="ln-5488"></a>
<a name="ln-5489"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">TotDesDays</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5490"></a><span class="k">        CALL </span><span class="n">GetDesignDayData</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5491"></a>      <span class="n">ENDIF</span>
<a name="ln-5492"></a>
<a name="ln-5493"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RPD1</span> <span class="o">&gt;=</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RPD2</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5494"></a><span class="k">        CALL </span><span class="n">GetRunPeriodDesignData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5495"></a>      <span class="n">ENDIF</span>
<a name="ln-5496"></a>
<a name="ln-5497"></a>      <span class="c">!the last environment(s) is designated the weather environment if an annual run</span>
<a name="ln-5498"></a>      <span class="c">! is selected.  All of the design systems is done from the design day info</span>
<a name="ln-5499"></a>      <span class="c">! which will have to be completed to run the annual run.</span>
<a name="ln-5500"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotRunPers</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">FullAnnualRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5501"></a><span class="k">        CALL </span><span class="n">GetRunPeriodData</span><span class="p">(</span><span class="n">TotRunPers</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5502"></a>      <span class="n">ENDIF</span>
<a name="ln-5503"></a>
<a name="ln-5504"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RPD1</span> <span class="o">&gt;=</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RPD2</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">TotRunPers</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">FullAnnualRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5505"></a><span class="k">        CALL </span><span class="n">GetSpecialDayPeriodData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5506"></a>        <span class="k">CALL </span><span class="n">GetDSTData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5507"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IDFDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5508"></a><span class="k">          </span><span class="n">DST</span><span class="o">=</span><span class="n">IDFDST</span>
<a name="ln-5509"></a>        <span class="n">ENDIF</span>
<a name="ln-5510"></a>      <span class="n">ENDIF</span>
<a name="ln-5511"></a>
<a name="ln-5512"></a>      <span class="k">CALL </span><span class="n">GetLocationInfo</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5513"></a>
<a name="ln-5514"></a>      <span class="k">CALL </span><span class="n">GetGroundTemps</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5515"></a>
<a name="ln-5516"></a>      <span class="k">CALL </span><span class="n">GetGroundReflectances</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5517"></a>
<a name="ln-5518"></a>      <span class="k">CALL </span><span class="n">GetSnowGroundRefModifiers</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5519"></a>
<a name="ln-5520"></a>      <span class="k">CALL </span><span class="n">GetWaterMainsTemperatures</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5521"></a>
<a name="ln-5522"></a>      <span class="k">CALL </span><span class="n">GetWeatherStation</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5523"></a>
<a name="ln-5524"></a>      <span class="k">CALL </span><span class="n">SetupEnvironmentTypes</span>
<a name="ln-5525"></a>
<a name="ln-5526"></a>      <span class="k">CALL </span><span class="n">GetWeatherProperties</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5527"></a>
<a name="ln-5528"></a>      <span class="c">! Deallocate ones used for schedule pointers</span>
<a name="ln-5529"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SPSiteScheduleNamePtr</span><span class="p">)</span>
<a name="ln-5530"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SPSiteScheduleUnits</span><span class="p">)</span>
<a name="ln-5531"></a>
<a name="ln-5532"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5533"></a><span class="k">       CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;GetWeatherInput: Above errors cause termination&#39;</span><span class="p">)</span>
<a name="ln-5534"></a>     <span class="n">ENDIF</span>
<a name="ln-5535"></a>
<a name="ln-5536"></a>  <span class="k">RETURN</span>
<a name="ln-5537"></a>
<a name="ln-5538"></a><span class="k">END SUBROUTINE </span><span class="n">ReadUserWeatherInput</span>
<a name="ln-5539"></a>
<a name="ln-5540"></a><span class="k">SUBROUTINE </span><span class="n">GetRunPeriodData</span><span class="p">(</span><span class="n">TotRunPers</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5541"></a>
<a name="ln-5542"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5543"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-5544"></a>          <span class="c">!       DATE WRITTEN   October 1997</span>
<a name="ln-5545"></a>          <span class="c">!       MODIFIED       February 1999, Add multiple run periods, Change name.</span>
<a name="ln-5546"></a>          <span class="c">!                      March 2012, LKL, Add features to object; New &quot;actual weather&quot; object;</span>
<a name="ln-5547"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5548"></a>
<a name="ln-5549"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5550"></a>          <span class="c">! This subroutine gets the run period info from User input and the</span>
<a name="ln-5551"></a>          <span class="c">!  simulation dates</span>
<a name="ln-5552"></a>
<a name="ln-5553"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5554"></a>          <span class="c">!</span>
<a name="ln-5555"></a>
<a name="ln-5556"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5557"></a>          <span class="c">! na</span>
<a name="ln-5558"></a>
<a name="ln-5559"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5560"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetNumObjectsFound</span>
<a name="ln-5561"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span><span class="p">,</span><span class="n">TrimSigDigits</span>
<a name="ln-5562"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span>
<a name="ln-5563"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-5564"></a>
<a name="ln-5565"></a> <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5566"></a>
<a name="ln-5567"></a>         <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5568"></a> <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">TotRunPers</span>   <span class="c">! Total number of Run Periods requested</span>
<a name="ln-5569"></a> <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-5570"></a>
<a name="ln-5571"></a>         <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5572"></a>         <span class="c">! na</span>
<a name="ln-5573"></a>
<a name="ln-5574"></a>         <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5575"></a>         <span class="c">! na</span>
<a name="ln-5576"></a>
<a name="ln-5577"></a>         <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5578"></a>         <span class="c">! na</span>
<a name="ln-5579"></a>
<a name="ln-5580"></a>         <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5581"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlpha</span> <span class="c">! Number of alphas being input</span>
<a name="ln-5582"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumeric</span>  <span class="c">! Number of numbers being input</span>
<a name="ln-5583"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>           <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-5584"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-5585"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>               <span class="c">! Flag to verify name</span>
<a name="ln-5586"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>               <span class="c">! Flag for blank name</span>
<a name="ln-5587"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Count</span>
<a name="ln-5588"></a><span class="nb">  </span><span class="k">TYPE</span> <span class="p">(</span><span class="n">EnvironmentData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TempEnvironment</span> <span class="c">! Environment data</span>
<a name="ln-5589"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">RP</span>    <span class="c">! number of run periods</span>
<a name="ln-5590"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">RPAW</span>  <span class="c">! number of run periods, actual weather</span>
<a name="ln-5591"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">Ptr</span>
<a name="ln-5592"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">LocalLeapYearAdd</span>
<a name="ln-5593"></a>
<a name="ln-5594"></a>         <span class="c">! FLOW:</span>
<a name="ln-5595"></a>  <span class="n">RP</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;RunPeriod&#39;</span><span class="p">)</span>
<a name="ln-5596"></a>  <span class="n">RPAW</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;RunPeriod:CustomRange&#39;</span><span class="p">)</span>
<a name="ln-5597"></a>
<a name="ln-5598"></a>   <span class="c">!Call Input Get routine to retrieve annual run data</span>
<a name="ln-5599"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">TotRunPers</span><span class="p">))</span>
<a name="ln-5600"></a>
<a name="ln-5601"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;RunPeriod&#39;</span>
<a name="ln-5602"></a>  <span class="nb">count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5603"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5604"></a><span class="k">    </span><span class="n">LocalLeapYearAdd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5605"></a>  <span class="k">ELSE</span>
<a name="ln-5606"></a><span class="k">    </span><span class="n">LocalLeapYearAdd</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-5607"></a>  <span class="n">ENDIF</span>
<a name="ln-5608"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">RP</span>
<a name="ln-5609"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumeric</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5610"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5611"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-5612"></a>
<a name="ln-5613"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5614"></a><span class="k">      </span><span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5615"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5616"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">RunPeriodInput</span><span class="p">%</span><span class="n">Title</span><span class="p">,</span><span class="nb">Count</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-5617"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5618"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5619"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-5620"></a>      <span class="n">ENDIF</span>
<a name="ln-5621"></a>    <span class="n">ENDIF</span>
<a name="ln-5622"></a>
<a name="ln-5623"></a>    <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5624"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5625"></a>
<a name="ln-5626"></a>   <span class="c">!set the start and end day of month from user input</span>
<a name="ln-5627"></a>   <span class="c">! N1 , \field Begin Month</span>
<a name="ln-5628"></a>   <span class="c">! N2 , \field Begin Day of Month</span>
<a name="ln-5629"></a>   <span class="c">! N3 , \field End Month</span>
<a name="ln-5630"></a>   <span class="c">! N4 , \field End Day of Month</span>
<a name="ln-5631"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5632"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-5633"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span>   <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-5634"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span>   <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-5635"></a>
<a name="ln-5636"></a>    <span class="c">!  N5,  \field Number of Times Runperiod to be Repeated</span>
<a name="ln-5637"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5638"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">NumSimYears</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5639"></a>    <span class="k">ELSE</span>
<a name="ln-5640"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">NumSimYears</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-5641"></a>    <span class="n">ENDIF</span>
<a name="ln-5642"></a>
<a name="ln-5643"></a>    <span class="c">!  N6;  \field Start Year</span>
<a name="ln-5644"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5645"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">BeginYear</span> <span class="o">=</span> <span class="n">autocalculate</span>
<a name="ln-5646"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5647"></a>    <span class="k">ELSE</span>
<a name="ln-5648"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">BeginYear</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5649"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5650"></a>    <span class="n">ENDIF</span>
<a name="ln-5651"></a>
<a name="ln-5652"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullAnnualRun</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5653"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5654"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5655"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span>   <span class="o">=</span> <span class="mi">12</span>
<a name="ln-5656"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span>   <span class="o">=</span> <span class="mi">31</span>
<a name="ln-5657"></a>    <span class="n">ENDIF</span>
<a name="ln-5658"></a>
<a name="ln-5659"></a>
<a name="ln-5660"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">)</span>
<a name="ln-5661"></a>
<a name="ln-5662"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-5663"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5664"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5665"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5666"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5667"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5668"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5669"></a>        <span class="n">ENDIF</span>
<a name="ln-5670"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-5671"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5672"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5673"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5674"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5675"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5676"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5677"></a>        <span class="n">ENDIF</span>
<a name="ln-5678"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5679"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="o">+</span><span class="n">LocalLeapYearAdd</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5680"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5681"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5682"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5683"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5684"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5685"></a>        <span class="n">ENDIF</span>
<a name="ln-5686"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-5687"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5688"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5689"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5690"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5691"></a>    <span class="k">END SELECT</span>
<a name="ln-5692"></a>
<a name="ln-5693"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">)</span>
<a name="ln-5694"></a>
<a name="ln-5695"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-5696"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5697"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5698"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5699"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5700"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5701"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5702"></a>        <span class="n">ENDIF</span>
<a name="ln-5703"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-5704"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5705"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5706"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5707"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5708"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5709"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5710"></a>        <span class="n">ENDIF</span>
<a name="ln-5711"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5712"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="o">+</span><span class="n">LocalLeapYearAdd</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5713"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5714"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5715"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5716"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5717"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5718"></a>        <span class="n">ENDIF</span>
<a name="ln-5719"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-5720"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5721"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5722"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5723"></a>    <span class="k">END SELECT</span>
<a name="ln-5724"></a>
<a name="ln-5725"></a>    <span class="c">! A2 , \field Day of Week for Start Day</span>
<a name="ln-5726"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;USEWEATHERFILE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5727"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Defaults to Day of Week from Weather File</span>
<a name="ln-5728"></a>    <span class="k">ELSE</span>
<a name="ln-5729"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">DaysOfWeek</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-5730"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5731"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5732"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Day of Week) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5733"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; for Start is not Valid, DayofWeek from WeatherFile will be used.&#39;</span><span class="p">)</span>
<a name="ln-5734"></a>      <span class="n">ENDIF</span>
<a name="ln-5735"></a>    <span class="n">ENDIF</span>
<a name="ln-5736"></a>
<a name="ln-5737"></a>    <span class="c">! A3,  \field Use Weather File Holidays and Special Days</span>
<a name="ln-5738"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5739"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5740"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5741"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5742"></a>    <span class="k">ELSE</span>
<a name="ln-5743"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5744"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5745"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5746"></a>    <span class="n">ENDIF</span>
<a name="ln-5747"></a>
<a name="ln-5748"></a>    <span class="c">! A4,  \field Use Weather File Daylight Saving Period</span>
<a name="ln-5749"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5750"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5751"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5752"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5753"></a>    <span class="k">ELSE</span>
<a name="ln-5754"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5755"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5756"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5757"></a>    <span class="n">ENDIF</span>
<a name="ln-5758"></a>
<a name="ln-5759"></a>    <span class="c">! A5,  \field Apply Weekend Holiday Rule</span>
<a name="ln-5760"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5761"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5762"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5763"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5764"></a>    <span class="k">ELSE</span>
<a name="ln-5765"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5766"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5767"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5768"></a>    <span class="n">ENDIF</span>
<a name="ln-5769"></a>
<a name="ln-5770"></a>    <span class="c">! A6,  \field Use Weather File Rain Indicators</span>
<a name="ln-5771"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5772"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5773"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5774"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5775"></a>    <span class="k">ELSE</span>
<a name="ln-5776"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5777"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5778"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5779"></a>    <span class="n">ENDIF</span>
<a name="ln-5780"></a>
<a name="ln-5781"></a>    <span class="c">! A7,  \field Use Weather File Snow Indicators</span>
<a name="ln-5782"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5783"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5784"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5785"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5786"></a>    <span class="k">ELSE</span>
<a name="ln-5787"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5788"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5789"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5790"></a>    <span class="n">ENDIF</span>
<a name="ln-5791"></a>
<a name="ln-5792"></a>   <span class="c">! A8,  \field Increment Day of Week on repeat</span>
<a name="ln-5793"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5794"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5795"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5796"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5797"></a>    <span class="k">ELSE</span>
<a name="ln-5798"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5799"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5800"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5801"></a>    <span class="n">ENDIF</span>
<a name="ln-5802"></a>
<a name="ln-5803"></a>    <span class="c">!calculate the annual start and end dates from the user inputted month and day</span>
<a name="ln-5804"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDate</span> <span class="o">=</span> <span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-5805"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDate</span> <span class="o">=</span> <span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-5806"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5807"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5808"></a><span class="k">      CALL </span><span class="n">SetupWeekDaysByMonth</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5809"></a>                                <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-5810"></a>    <span class="n">ENDIF</span>
<a name="ln-5811"></a>  <span class="n">ENDDO</span>
<a name="ln-5812"></a>
<a name="ln-5813"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;RunPeriod:CustomRange&#39;</span>
<a name="ln-5814"></a>  <span class="nb">count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5815"></a>  <span class="k">DO </span><span class="n">Ptr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">RPAW</span>
<a name="ln-5816"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Ptr</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumeric</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5817"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5818"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-5819"></a>
<a name="ln-5820"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5821"></a><span class="k">      </span><span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5822"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5823"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">RunPeriodInput</span><span class="p">%</span><span class="n">Title</span><span class="p">,</span><span class="nb">Count</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-5824"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5825"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5826"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-5827"></a>      <span class="n">ENDIF</span>
<a name="ln-5828"></a>    <span class="n">ENDIF</span>
<a name="ln-5829"></a>
<a name="ln-5830"></a>    <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5831"></a>    <span class="n">Loop</span><span class="o">=</span><span class="n">RP</span><span class="o">+</span><span class="n">Ptr</span>
<a name="ln-5832"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5833"></a>
<a name="ln-5834"></a>   <span class="c">!set the start and end day of month from user input</span>
<a name="ln-5835"></a>   <span class="c">! N1 , \field Begin Month</span>
<a name="ln-5836"></a>   <span class="c">! N2 , \field Begin Day of Month</span>
<a name="ln-5837"></a>   <span class="c">! N3,  \field Start Year</span>
<a name="ln-5838"></a>   <span class="c">! N4 , \field End Month</span>
<a name="ln-5839"></a>   <span class="c">! N5 , \field End Day of Month</span>
<a name="ln-5840"></a>   <span class="c">! N6,  \field End Year</span>
<a name="ln-5841"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5842"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span>   <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-5843"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartYear</span>  <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-5844"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span>   <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-5845"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span>     <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-5846"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndYear</span>    <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5847"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5848"></a>
<a name="ln-5849"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullAnnualRun</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5850"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5851"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5852"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span>   <span class="o">=</span> <span class="mi">12</span>
<a name="ln-5853"></a>      <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span>   <span class="o">=</span> <span class="mi">31</span>
<a name="ln-5854"></a>    <span class="n">ENDIF</span>
<a name="ln-5855"></a>
<a name="ln-5856"></a>
<a name="ln-5857"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">)</span>
<a name="ln-5858"></a>
<a name="ln-5859"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-5860"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5861"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5862"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5863"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5864"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5865"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5866"></a>        <span class="n">ENDIF</span>
<a name="ln-5867"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-5868"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5869"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5870"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5871"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5872"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5873"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5874"></a>        <span class="n">ENDIF</span>
<a name="ln-5875"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5876"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="o">+</span><span class="n">LeapYearAdd</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5877"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5878"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5879"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5880"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5881"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5882"></a>        <span class="n">ENDIF</span>
<a name="ln-5883"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-5884"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5885"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5886"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5887"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5888"></a>    <span class="k">END SELECT</span>
<a name="ln-5889"></a>
<a name="ln-5890"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">)</span>
<a name="ln-5891"></a>
<a name="ln-5892"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-5893"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5894"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5895"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5896"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5897"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5898"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5899"></a>        <span class="n">ENDIF</span>
<a name="ln-5900"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-5901"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5902"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5903"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5904"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5905"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5906"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5907"></a>        <span class="n">ENDIF</span>
<a name="ln-5908"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5909"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="o">+</span><span class="n">LeapYearAdd</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5910"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5911"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5912"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Indicated &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-5913"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-5914"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5915"></a>        <span class="n">ENDIF</span>
<a name="ln-5916"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-5917"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5918"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5919"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5920"></a>    <span class="k">END SELECT</span>
<a name="ln-5921"></a>
<a name="ln-5922"></a>    <span class="c">! A2 , \field Day of Week for Start Day</span>
<a name="ln-5923"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;USEWEATHERFILE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5924"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Defaults to Day of Week from Weather File</span>
<a name="ln-5925"></a>    <span class="k">ELSE</span>
<a name="ln-5926"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">DaysOfWeek</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-5927"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5928"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5929"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Day of Week) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5930"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; for Start is not Valid, DayofWeek from WeatherFile will be used.&#39;</span><span class="p">)</span>
<a name="ln-5931"></a>      <span class="n">ENDIF</span>
<a name="ln-5932"></a>    <span class="n">ENDIF</span>
<a name="ln-5933"></a>
<a name="ln-5934"></a>    <span class="c">! A3,  \field Use Weather File Holidays and Special Days</span>
<a name="ln-5935"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5936"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5937"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5938"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5939"></a>    <span class="k">ELSE</span>
<a name="ln-5940"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5941"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5942"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5943"></a>    <span class="n">ENDIF</span>
<a name="ln-5944"></a>
<a name="ln-5945"></a>    <span class="c">! A4,  \field Use Weather File Daylight Saving Period</span>
<a name="ln-5946"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5947"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5948"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5949"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5950"></a>    <span class="k">ELSE</span>
<a name="ln-5951"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5952"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5953"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5954"></a>    <span class="n">ENDIF</span>
<a name="ln-5955"></a>
<a name="ln-5956"></a>    <span class="c">! A5,  \field Apply Weekend Holiday Rule</span>
<a name="ln-5957"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5958"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5959"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5960"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5961"></a>    <span class="k">ELSE</span>
<a name="ln-5962"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5963"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5964"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5965"></a>    <span class="n">ENDIF</span>
<a name="ln-5966"></a>
<a name="ln-5967"></a>    <span class="c">! A6,  \field Use Weather File Rain Indicators</span>
<a name="ln-5968"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5969"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5970"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5971"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5972"></a>    <span class="k">ELSE</span>
<a name="ln-5973"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5974"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5975"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5976"></a>    <span class="n">ENDIF</span>
<a name="ln-5977"></a>
<a name="ln-5978"></a>    <span class="c">! A7,  \field Use Weather File Snow Indicators</span>
<a name="ln-5979"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5980"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5981"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5982"></a><span class="k">      </span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5983"></a>    <span class="k">ELSE</span>
<a name="ln-5984"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5985"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-5986"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5987"></a>    <span class="n">ENDIF</span>
<a name="ln-5988"></a>
<a name="ln-5989"></a>    <span class="c">!calculate the annual start and end days from the user inputted month and day</span>
<a name="ln-5990"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5991"></a>    <span class="k">CALL </span><span class="n">JGDate</span><span class="p">(</span><span class="n">GregorianToJulian</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5992"></a>       <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartYear</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">)</span>
<a name="ln-5993"></a>    <span class="k">CALL </span><span class="n">JGDate</span><span class="p">(</span><span class="n">GregorianToJulian</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5994"></a>       <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndYear</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">)</span>
<a name="ln-5995"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-5996"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5997"></a><span class="k">      CALL </span><span class="n">SetupWeekDaysByMonth</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5998"></a>                                <span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-5999"></a>    <span class="n">ENDIF</span>
<a name="ln-6000"></a>  <span class="n">ENDDO</span>
<a name="ln-6001"></a>
<a name="ln-6002"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotRunPers</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">FullAnnualRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6003"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">)</span>
<a name="ln-6004"></a>    <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;No Run Periods input but Full Annual Simulation selected.  Adding Run Period to 1/1 through 12/31.&#39;</span><span class="p">)</span>
<a name="ln-6005"></a>    <span class="n">NumOfEnvrn</span><span class="o">=</span><span class="n">NumOfEnvrn</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6006"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TempEnvironment</span><span class="p">(</span><span class="n">NumOfEnvrn</span><span class="p">))</span>
<a name="ln-6007"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfEnvrn</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6008"></a><span class="k">      </span><span class="n">TempEnvironment</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfEnvrn</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfEnvrn</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6009"></a>    <span class="n">ENDIF</span>
<a name="ln-6010"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Environment</span><span class="p">)</span>
<a name="ln-6011"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">NumOfEnvrn</span><span class="p">))</span>
<a name="ln-6012"></a>    <span class="n">Environment</span><span class="o">=</span><span class="n">TempEnvironment</span>
<a name="ln-6013"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TempEnvironment</span><span class="p">)</span>
<a name="ln-6014"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">NumOfEnvrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksRunPeriodWeather</span>
<a name="ln-6015"></a>    <span class="n">TotRunPers</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6016"></a>    <span class="n">WeathSimReq</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6017"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">TotRunPers</span><span class="p">))</span>
<a name="ln-6018"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartDate</span> <span class="o">=</span> <span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-6019"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EndDate</span> <span class="o">=</span> <span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-6020"></a>    <span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6021"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6022"></a><span class="k">      CALL </span><span class="n">SetupWeekDaysByMonth</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6023"></a>                               <span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-6024"></a>    <span class="n">ENDIF</span>
<a name="ln-6025"></a>  <span class="n">ENDIF</span>
<a name="ln-6026"></a>
<a name="ln-6027"></a><span class="k">Return</span>
<a name="ln-6028"></a>
<a name="ln-6029"></a><span class="k">END SUBROUTINE </span><span class="n">GetRunPeriodData</span>
<a name="ln-6030"></a>
<a name="ln-6031"></a><span class="k">SUBROUTINE </span><span class="n">GetRunPeriodDesignData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6034"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-6035"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-6036"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6037"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6038"></a>
<a name="ln-6039"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6040"></a>          <span class="c">! This subroutine gets the run period design info from User input and the</span>
<a name="ln-6041"></a>          <span class="c">!  simulation dates</span>
<a name="ln-6042"></a>
<a name="ln-6043"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6044"></a>          <span class="c">!</span>
<a name="ln-6045"></a>
<a name="ln-6046"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6047"></a>          <span class="c">! na</span>
<a name="ln-6048"></a>
<a name="ln-6049"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6050"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItem</span><span class="p">,</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-6051"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span><span class="p">,</span><span class="n">TrimSigDigits</span>
<a name="ln-6052"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span>
<a name="ln-6053"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-6054"></a>
<a name="ln-6055"></a> <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6056"></a>
<a name="ln-6057"></a>         <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6058"></a> <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-6059"></a>
<a name="ln-6060"></a>         <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6061"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ValidNames</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s2">&quot;SUNDAY         &quot;</span><span class="p">,</span><span class="s2">&quot;MONDAY         &quot;</span><span class="p">,</span><span class="s2">&quot;TUESDAY        &quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6062"></a>                                                             <span class="s2">&quot;WEDNESDAY      &quot;</span><span class="p">,</span><span class="s2">&quot;THURSDAY       &quot;</span><span class="p">,</span><span class="s2">&quot;FRIDAY         &quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6063"></a>                                                             <span class="s2">&quot;SATURDAY       &quot;</span><span class="p">,</span><span class="s2">&quot;HOLIDAY        &quot;</span><span class="p">,</span><span class="s2">&quot;SUMMERDESIGNDAY&quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6064"></a>                                                             <span class="s2">&quot;WINTERDESIGNDAY&quot;</span><span class="p">,</span><span class="s2">&quot;CUSTOMDAY1     &quot;</span><span class="p">,</span><span class="s2">&quot;CUSTOMDAY2     &quot;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-6065"></a>
<a name="ln-6066"></a>         <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6067"></a>         <span class="c">! na</span>
<a name="ln-6068"></a>
<a name="ln-6069"></a>         <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6070"></a>         <span class="c">! na</span>
<a name="ln-6071"></a>
<a name="ln-6072"></a>         <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6073"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>   <span class="c">! Number of alphas being input</span>
<a name="ln-6074"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumerics</span>  <span class="c">! Number of Numerics being input</span>
<a name="ln-6075"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>           <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-6076"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-6077"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>               <span class="c">! Flag to verify name</span>
<a name="ln-6078"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>               <span class="c">! Flag for blank name</span>
<a name="ln-6079"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RPD1</span>
<a name="ln-6080"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RPD2</span>
<a name="ln-6081"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Count</span>
<a name="ln-6082"></a><span class="nb">  </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichPeriod</span>
<a name="ln-6083"></a><span class="c">!unused1208  CHARACTER(len=MaxNameLength) :: ThisObject</span>
<a name="ln-6084"></a>
<a name="ln-6085"></a>
<a name="ln-6086"></a>         <span class="c">! FLOW:</span>
<a name="ln-6087"></a>   <span class="c">!Call Input Get routine to retrieve annual run data</span>
<a name="ln-6088"></a>  <span class="n">RPD1</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;SizingPeriod:WeatherFileDays&#39;</span><span class="p">)</span>
<a name="ln-6089"></a>  <span class="n">RPD2</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;SizingPeriod:WeatherFileConditionType&#39;</span><span class="p">)</span>
<a name="ln-6090"></a>  <span class="n">TotRunDesPers</span><span class="o">=</span><span class="n">RPD1</span><span class="o">+</span><span class="n">RPD2</span>
<a name="ln-6091"></a>
<a name="ln-6092"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">RPD1</span><span class="o">+</span><span class="n">RPD2</span><span class="p">))</span>
<a name="ln-6093"></a>
<a name="ln-6094"></a>  <span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6095"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SizingPeriod:WeatherFileDays&#39;</span>
<a name="ln-6096"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">RPD1</span>
<a name="ln-6097"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumerics</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6098"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6099"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6100"></a>
<a name="ln-6101"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6102"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6103"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">RunPeriodDesignInput</span><span class="p">%</span><span class="n">Title</span><span class="p">,</span><span class="nb">Count</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-6104"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6105"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6106"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-6107"></a>    <span class="n">ENDIF</span>
<a name="ln-6108"></a>    <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6109"></a>    <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6110"></a>    <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">PeriodType</span><span class="o">=</span><span class="s1">&#39;User Selected WeatherFile RunPeriod (Design)&#39;</span>
<a name="ln-6111"></a>
<a name="ln-6112"></a>   <span class="c">!set the start and end day of month from user input</span>
<a name="ln-6113"></a>     <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span> <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6114"></a>     <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span>   <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6115"></a>     <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span>   <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-6116"></a>     <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span>     <span class="o">=</span> <span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-6117"></a>
<a name="ln-6118"></a>   <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">)</span>
<a name="ln-6119"></a>
<a name="ln-6120"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-6121"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6122"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6123"></a>           <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6124"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6125"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6126"></a>      <span class="n">ENDIF</span>
<a name="ln-6127"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-6128"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6129"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6130"></a>           <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6131"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6132"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6133"></a>      <span class="n">ENDIF</span>
<a name="ln-6134"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6135"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="o">+</span><span class="n">LeapYearAdd</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6136"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6137"></a>           <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Day of Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6138"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6139"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6140"></a>      <span class="n">ENDIF</span>
<a name="ln-6141"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-6142"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6143"></a>         <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6144"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6145"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6146"></a>   <span class="k">END SELECT</span>
<a name="ln-6147"></a>
<a name="ln-6148"></a><span class="k">   IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6149"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="mi">2</span> <span class="c">! Defaults to Monday</span>
<a name="ln-6150"></a>   <span class="k">ELSE</span>
<a name="ln-6151"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ValidNames</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-6152"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6153"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6154"></a>           <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Day of Week) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6155"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; for Start is not Valid, Monday will be Used.&#39;</span><span class="p">)</span>
<a name="ln-6156"></a>       <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="mi">2</span> <span class="c">! Defaults to Monday</span>
<a name="ln-6157"></a>     <span class="n">ENDIF</span>
<a name="ln-6158"></a>   <span class="n">ENDIF</span>
<a name="ln-6159"></a>
<a name="ln-6160"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6161"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6162"></a>   <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6163"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6164"></a>   <span class="k">ELSE</span>
<a name="ln-6165"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6166"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6167"></a>     <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6168"></a>   <span class="n">ENDIF</span>
<a name="ln-6169"></a>
<a name="ln-6170"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6171"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6172"></a>     <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6173"></a>   <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6174"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6175"></a>     <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6176"></a>   <span class="k">ELSE</span>
<a name="ln-6177"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6178"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6179"></a>     <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6180"></a>   <span class="n">ENDIF</span>
<a name="ln-6181"></a>
<a name="ln-6182"></a>   <span class="c">!calculate the annual start and end days from the user inputted month and day</span>
<a name="ln-6183"></a>   <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDate</span> <span class="o">=</span> <span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6184"></a>                                                      <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-6185"></a>   <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDate</span>   <span class="o">=</span> <span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6186"></a>                                                      <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-6187"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDate</span> <span class="o">&lt;=</span> <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6188"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDate</span><span class="o">-</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDate</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-6189"></a>                                   <span class="o">*</span> <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-6190"></a>   <span class="k">ELSE</span>
<a name="ln-6191"></a><span class="k">     </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="p">(</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span> <span class="o">-</span>   <span class="p">&amp;</span>
<a name="ln-6192"></a>                  <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDate</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDate</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6193"></a>                                   <span class="o">*</span> <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-6194"></a>   <span class="n">ENDIF</span>
<a name="ln-6195"></a>   <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6196"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6197"></a><span class="k">      CALL </span><span class="n">SetupWeekDaysByMonth</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6198"></a>                                <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-6199"></a>    <span class="n">ENDIF</span>
<a name="ln-6200"></a>  <span class="n">ENDDO</span>
<a name="ln-6201"></a>
<a name="ln-6202"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SizingPeriod:WeatherFileConditionType&#39;</span>
<a name="ln-6203"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">RPD2</span>
<a name="ln-6204"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumerics</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6205"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6206"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6207"></a>
<a name="ln-6208"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6209"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6210"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">RunPeriodDesignInput</span><span class="p">%</span><span class="n">Title</span><span class="p">,</span><span class="nb">Count</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Title&#39;</span><span class="p">)</span>
<a name="ln-6211"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6212"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6213"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-6214"></a>    <span class="n">ENDIF</span>
<a name="ln-6215"></a>    <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6216"></a>    <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6217"></a>    <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">PeriodType</span><span class="o">=</span><span class="s1">&#39;User Selected WeatherFile Typical/Extreme Period (Design)=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6218"></a>
<a name="ln-6219"></a>    <span class="c">! Period Selection</span>
<a name="ln-6220"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6221"></a><span class="k">      </span><span class="n">WhichPeriod</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">TypicalExtremePeriods</span><span class="p">%</span><span class="n">MatchValue</span><span class="p">,</span><span class="n">NumEPWTypExtSets</span><span class="p">)</span>
<a name="ln-6222"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WhichPeriod</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6223"></a><span class="k">        </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-6224"></a>        <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartMonth</span>
<a name="ln-6225"></a>        <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDate</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartJDay</span>
<a name="ln-6226"></a>        <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndDay</span>
<a name="ln-6227"></a>        <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndMonth</span>
<a name="ln-6228"></a>        <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDate</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndJDay</span>
<a name="ln-6229"></a>        <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">TotalDays</span>
<a name="ln-6230"></a>      <span class="k">ELSE</span>
<a name="ln-6231"></a><span class="k">        </span><span class="n">WhichPeriod</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">TypicalExtremePeriods</span><span class="p">%</span><span class="n">MatchValue1</span><span class="p">,</span><span class="n">NumEPWTypExtSets</span><span class="p">)</span>
<a name="ln-6232"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WhichPeriod</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6233"></a><span class="k">          </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-6234"></a>          <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartMonth</span>
<a name="ln-6235"></a>          <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDate</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartJDay</span>
<a name="ln-6236"></a>          <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndDay</span>
<a name="ln-6237"></a>          <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndMonth</span>
<a name="ln-6238"></a>          <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDate</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndJDay</span>
<a name="ln-6239"></a>          <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">TotalDays</span>
<a name="ln-6240"></a>          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6241"></a>               <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldnames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; matched to &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6242"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">MatchValue</span><span class="p">))</span>
<a name="ln-6243"></a>        <span class="k">ELSE</span>
<a name="ln-6244"></a><span class="k">          </span><span class="n">WhichPeriod</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">TypicalExtremePeriods</span><span class="p">%</span><span class="n">MatchValue2</span><span class="p">,</span><span class="n">NumEPWTypExtSets</span><span class="p">)</span>
<a name="ln-6245"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WhichPeriod</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6246"></a><span class="k">            </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-6247"></a>            <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartMonth</span>
<a name="ln-6248"></a>            <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDate</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">StartJDay</span>
<a name="ln-6249"></a>            <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndDay</span>
<a name="ln-6250"></a>            <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndMonth</span>
<a name="ln-6251"></a>            <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDate</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">EndJDay</span>
<a name="ln-6252"></a>            <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">TotalDays</span>
<a name="ln-6253"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6254"></a>                 <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldnames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; matched to &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6255"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">WhichPeriod</span><span class="p">)%</span><span class="n">MatchValue</span><span class="p">))</span>
<a name="ln-6256"></a>          <span class="k">ELSE</span>
<a name="ln-6257"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6258"></a>                 <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldnames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (not on Weather File)=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6259"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6260"></a>          <span class="n">ENDIF</span>
<a name="ln-6261"></a>        <span class="n">ENDIF</span>
<a name="ln-6262"></a>      <span class="n">ENDIF</span>
<a name="ln-6263"></a>    <span class="k">ELSE</span>
<a name="ln-6264"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6265"></a>           <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldnames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (blank).&#39;</span><span class="p">)</span>
<a name="ln-6266"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6267"></a>    <span class="n">ENDIF</span>
<a name="ln-6268"></a>
<a name="ln-6269"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6270"></a><span class="k">      </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="mi">2</span> <span class="c">! Defaults to Monday</span>
<a name="ln-6271"></a>    <span class="k">ELSE</span>
<a name="ln-6272"></a><span class="k">      </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ValidNames</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-6273"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6274"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6275"></a>            <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Day of Week) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6276"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; for Start is not Valid, Monday will be Used.&#39;</span><span class="p">)</span>
<a name="ln-6277"></a>        <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="mi">2</span> <span class="c">! Defaults to Monday</span>
<a name="ln-6278"></a>      <span class="n">ENDIF</span>
<a name="ln-6279"></a>    <span class="n">ENDIF</span>
<a name="ln-6280"></a>
<a name="ln-6281"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6282"></a><span class="k">      </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6283"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6284"></a><span class="k">      </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6285"></a>    <span class="k">ELSE</span>
<a name="ln-6286"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6287"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6288"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6289"></a>    <span class="n">ENDIF</span>
<a name="ln-6290"></a>
<a name="ln-6291"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6292"></a><span class="k">      </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6293"></a>      <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6294"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6295"></a><span class="k">      </span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6296"></a>      <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6297"></a>    <span class="k">ELSE</span>
<a name="ln-6298"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: object #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Loop</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6299"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-6300"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6301"></a>    <span class="n">ENDIF</span>
<a name="ln-6302"></a>    <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6303"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">DayOfWeek</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6304"></a><span class="k">      CALL </span><span class="n">SetupWeekDaysByMonth</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6305"></a>                                <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-6306"></a>    <span class="n">ENDIF</span>
<a name="ln-6307"></a>
<a name="ln-6308"></a>  <span class="n">ENDDO</span>
<a name="ln-6309"></a><span class="k">Return</span>
<a name="ln-6310"></a>
<a name="ln-6311"></a><span class="k">END SUBROUTINE </span><span class="n">GetRunPeriodDesignData</span>
<a name="ln-6312"></a>
<a name="ln-6313"></a><span class="k">SUBROUTINE </span><span class="n">GetSpecialDayPeriodData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6314"></a>
<a name="ln-6315"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6316"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-6317"></a>          <span class="c">!       DATE WRITTEN   June 2000</span>
<a name="ln-6318"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6319"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6320"></a>
<a name="ln-6321"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6322"></a>          <span class="c">! This subroutine reads any special day period data from the IDF and</span>
<a name="ln-6323"></a>          <span class="c">! processes it into the data structure that will drive the values</span>
<a name="ln-6324"></a>          <span class="c">! in the SpecialDayTypes array.</span>
<a name="ln-6325"></a>
<a name="ln-6326"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6327"></a>          <span class="c">! Processes the following IDD definition:</span>
<a name="ln-6328"></a>          <span class="c">!</span>
<a name="ln-6329"></a>          <span class="c">! SpecialDayPeriod,</span>
<a name="ln-6330"></a>          <span class="c">!      \memo This object sets up holidays/special days to be used during weather file</span>
<a name="ln-6331"></a>          <span class="c">!      \memo run periods.  (These are not used with DesignDay objects.)</span>
<a name="ln-6332"></a>          <span class="c">!      \memo Depending on the value in the run period, days on the weather file may also</span>
<a name="ln-6333"></a>          <span class="c">!      \memo be used.  However, the weather file specification will take precedence over</span>
<a name="ln-6334"></a>          <span class="c">!      \memo any specification shown here.  (No error message on duplicate days or overlapping</span>
<a name="ln-6335"></a>          <span class="c">!      \memo days).</span>
<a name="ln-6336"></a>          <span class="c">!  A1, \field Holiday Name</span>
<a name="ln-6337"></a>          <span class="c">!  A2, \field StartDate</span>
<a name="ln-6338"></a>          <span class="c">!      \memo  Dates can be several formats:</span>
<a name="ln-6339"></a>          <span class="c">!      \memo  &lt;number&gt;/&lt;number&gt;  (month/day)</span>
<a name="ln-6340"></a>          <span class="c">!      \memo  &lt;number&gt; Month</span>
<a name="ln-6341"></a>          <span class="c">!      \memo  Month &lt;number&gt;</span>
<a name="ln-6342"></a>          <span class="c">!      \memo Months are January, February, March, April, May, June, July, August, September, October, November, December</span>
<a name="ln-6343"></a>          <span class="c">!      \memo Months can be the first 3 letters of the month</span>
<a name="ln-6344"></a>          <span class="c">!        \note will eventually allow: 3 Monday April (meaning 3rd Monday in April)</span>
<a name="ln-6345"></a>          <span class="c">!  N1, \field duration (number of days)</span>
<a name="ln-6346"></a>          <span class="c">!  A3; \field SpecialDayType</span>
<a name="ln-6347"></a>          <span class="c">!        \note SpecialDayType selects the schedules appropriate for each day so labeled</span>
<a name="ln-6348"></a>          <span class="c">!        \type choice</span>
<a name="ln-6349"></a>          <span class="c">!        \key Holiday</span>
<a name="ln-6350"></a>          <span class="c">!        \key SummerDesignDay</span>
<a name="ln-6351"></a>          <span class="c">!        \key WinterDesignDay</span>
<a name="ln-6352"></a>          <span class="c">!        \key CustomDay1</span>
<a name="ln-6353"></a>          <span class="c">!        \key CustomDay2</span>
<a name="ln-6354"></a>
<a name="ln-6355"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6356"></a>          <span class="c">! na</span>
<a name="ln-6357"></a>
<a name="ln-6358"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6359"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-6360"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-6361"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-6362"></a>
<a name="ln-6363"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6364"></a>
<a name="ln-6365"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6366"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! will be set to true if severe errors are found in inputs</span>
<a name="ln-6367"></a>
<a name="ln-6368"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6369"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ValidDayTypes</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s2">&quot;HOLIDAY        &quot;</span><span class="p">,</span><span class="s2">&quot;SUMMERDESIGNDAY&quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6370"></a>                                                               <span class="s2">&quot;WINTERDESIGNDAY&quot;</span><span class="p">,</span><span class="s2">&quot;CUSTOMDAY1     &quot;</span><span class="p">,</span><span class="s2">&quot;CUSTOMDAY2     &quot;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-6371"></a>
<a name="ln-6372"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6373"></a>          <span class="c">! na</span>
<a name="ln-6374"></a>
<a name="ln-6375"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6376"></a>          <span class="c">! na</span>
<a name="ln-6377"></a>
<a name="ln-6378"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6379"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlphArray</span>
<a name="ln-6380"></a>  <span class="kt">INTEGER </span><span class="n">NumAlphas</span>
<a name="ln-6381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Duration</span>
<a name="ln-6382"></a>  <span class="kt">INTEGER </span><span class="n">NumNumbers</span>
<a name="ln-6383"></a>  <span class="kt">INTEGER </span><span class="n">NumSpecDays</span>
<a name="ln-6384"></a>  <span class="kt">INTEGER </span><span class="nb">Count</span>
<a name="ln-6385"></a><span class="nb">  </span><span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-6386"></a>  <span class="kt">INTEGER </span><span class="n">PMonth</span>
<a name="ln-6387"></a>  <span class="kt">INTEGER </span><span class="n">PDay</span>
<a name="ln-6388"></a>  <span class="kt">INTEGER </span><span class="n">PWeekDay</span>
<a name="ln-6389"></a>  <span class="kt">INTEGER </span><span class="n">DateType</span>
<a name="ln-6390"></a>  <span class="kt">INTEGER </span><span class="n">IOStat</span>
<a name="ln-6391"></a>  <span class="kt">INTEGER </span><span class="n">DayType</span>
<a name="ln-6392"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>               <span class="c">! Flag to verify name</span>
<a name="ln-6393"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>               <span class="c">! Flag for blank name</span>
<a name="ln-6394"></a>
<a name="ln-6395"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;RunPeriodControl:SpecialDays&#39;</span>
<a name="ln-6396"></a>  <span class="n">NumSpecDays</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6397"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! EPW already allocated the array</span>
<a name="ln-6398"></a>    <span class="nb">Count</span><span class="o">=</span><span class="n">NumSpecialDays</span><span class="o">-</span><span class="n">NumSpecDays</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6399"></a>  <span class="k">ELSE</span>
<a name="ln-6400"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">NumSpecDays</span><span class="p">))</span>
<a name="ln-6401"></a>    <span class="n">NumSpecialDays</span><span class="o">=</span><span class="n">NumSpecDays</span>
<a name="ln-6402"></a>    <span class="nb">Count</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6403"></a>  <span class="n">ENDIF</span>
<a name="ln-6404"></a>
<a name="ln-6405"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumSpecDays</span>
<a name="ln-6406"></a>
<a name="ln-6407"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Duration</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-6408"></a>
<a name="ln-6409"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SpecialDays</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-6410"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6411"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6412"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-6413"></a>    <span class="n">ENDIF</span>
<a name="ln-6414"></a>
<a name="ln-6415"></a>    <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6416"></a>
<a name="ln-6417"></a>    <span class="k">CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6418"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">==</span> <span class="n">MonthDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6419"></a><span class="k">      </span><span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DateType</span><span class="o">=</span><span class="n">DateType</span>
<a name="ln-6420"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Month</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-6421"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Day</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-6422"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6423"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">CompDate</span><span class="o">=</span><span class="n">PMonth</span><span class="o">*</span><span class="mi">32</span><span class="o">+</span><span class="n">PDay</span>
<a name="ln-6424"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WthrFile</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6425"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">/=</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6426"></a><span class="k">      </span><span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DateType</span><span class="o">=</span><span class="n">DateType</span>
<a name="ln-6427"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Month</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-6428"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Day</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-6429"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">=</span><span class="n">PWeekDay</span>
<a name="ln-6430"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">CompDate</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6431"></a>      <span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WthrFile</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6432"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">==</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6433"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6434"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6435"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6436"></a>    <span class="n">ENDIF</span>
<a name="ln-6437"></a>
<a name="ln-6438"></a>
<a name="ln-6439"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6440"></a><span class="k">      </span><span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Duration</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6441"></a>    <span class="k">ELSE</span>
<a name="ln-6442"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6443"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-6444"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6445"></a>    <span class="n">ENDIF</span>
<a name="ln-6446"></a>
<a name="ln-6447"></a>    <span class="n">DayType</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ValidDayTypes</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-6448"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DayType</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6449"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6450"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6451"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6452"></a>    <span class="k">ELSE</span>
<a name="ln-6453"></a><span class="k">      </span><span class="n">SpecialDays</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DayType</span><span class="o">=</span><span class="n">DayType</span>
<a name="ln-6454"></a>    <span class="n">ENDIF</span>
<a name="ln-6455"></a>    <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6456"></a>  <span class="n">ENDDO</span>
<a name="ln-6457"></a>
<a name="ln-6458"></a>  <span class="c">!CALL CalcSpecialDayTypes</span>
<a name="ln-6459"></a>
<a name="ln-6460"></a>  <span class="k">RETURN</span>
<a name="ln-6461"></a>
<a name="ln-6462"></a><span class="k">END SUBROUTINE </span><span class="n">GetSpecialDayPeriodData</span>
<a name="ln-6463"></a>
<a name="ln-6464"></a><span class="k">SUBROUTINE </span><span class="n">CalcSpecialDayTypes</span>
<a name="ln-6465"></a>
<a name="ln-6466"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6467"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-6468"></a>          <span class="c">!       DATE WRITTEN   June 2000</span>
<a name="ln-6469"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6470"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6471"></a>
<a name="ln-6472"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6473"></a>          <span class="c">! This subroutine creates the array of Special Day types used during</span>
<a name="ln-6474"></a>          <span class="c">! the simulation.</span>
<a name="ln-6475"></a>
<a name="ln-6476"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6477"></a>          <span class="c">! Sets up the SpecialDayTypes array that then is used during simulation.</span>
<a name="ln-6478"></a>          <span class="c">! Uses WFLeapYearInd to indicate Leap Year simulation runs.</span>
<a name="ln-6479"></a>
<a name="ln-6480"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6481"></a>          <span class="c">! na</span>
<a name="ln-6482"></a>
<a name="ln-6483"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6484"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span>
<a name="ln-6485"></a>
<a name="ln-6486"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6487"></a>
<a name="ln-6488"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6489"></a>          <span class="c">! na</span>
<a name="ln-6490"></a>
<a name="ln-6491"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6492"></a>          <span class="c">! na</span>
<a name="ln-6493"></a>
<a name="ln-6494"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6495"></a>          <span class="c">! na</span>
<a name="ln-6496"></a>
<a name="ln-6497"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6498"></a>          <span class="c">! na</span>
<a name="ln-6499"></a>
<a name="ln-6500"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6501"></a>  <span class="kt">INTEGER </span><span class="n">Loop</span>
<a name="ln-6502"></a>  <span class="kt">INTEGER </span><span class="n">Loop1</span>
<a name="ln-6503"></a>  <span class="kt">INTEGER </span><span class="n">JDay</span>
<a name="ln-6504"></a>  <span class="kt">INTEGER </span><span class="n">Warn</span>
<a name="ln-6505"></a>
<a name="ln-6506"></a>  <span class="n">SpecialDayTypes</span><span class="o">=</span><span class="mi">0</span>  <span class="c">! Initialize/Reset Special Day Types array</span>
<a name="ln-6507"></a>
<a name="ln-6508"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumSpecialDays</span>
<a name="ln-6509"></a>
<a name="ln-6510"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WthrFile</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6511"></a>
<a name="ln-6512"></a><span class="k">    </span><span class="n">Warn</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6513"></a>
<a name="ln-6514"></a>    <span class="n">JDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Month</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Day</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-6515"></a>
<a name="ln-6516"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Duration</span>
<a name="ln-6517"></a>      <span class="n">JDay</span><span class="o">=</span><span class="n">JDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6518"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">JDay</span> <span class="o">&gt;</span> <span class="mi">366</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6519"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SpecialDay=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6520"></a>                              <span class="s1">&#39; causes index of more than 366, ignoring those beyond 366&#39;</span><span class="p">)</span>
<a name="ln-6521"></a>      <span class="k">ELSE</span>
<a name="ln-6522"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SpecialDayTypes</span><span class="p">(</span><span class="n">JDay</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Warn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6523"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SpecialDay=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6524"></a>                                <span class="s1">&#39; attempted overwrite of previous set special day&#39;</span><span class="p">)</span>
<a name="ln-6525"></a>          <span class="n">Warn</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6526"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SpecialDayTypes</span><span class="p">(</span><span class="n">JDay</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6527"></a><span class="k">          </span><span class="n">SpecialDayTypes</span><span class="p">(</span><span class="n">JDay</span><span class="p">)</span><span class="o">=</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayType</span>
<a name="ln-6528"></a>        <span class="n">ENDIF</span>
<a name="ln-6529"></a>      <span class="n">ENDIF</span>
<a name="ln-6530"></a>    <span class="n">ENDDO</span>
<a name="ln-6531"></a>  <span class="n">ENDDO</span>
<a name="ln-6532"></a>
<a name="ln-6533"></a>  <span class="k">RETURN</span>
<a name="ln-6534"></a>
<a name="ln-6535"></a><span class="k">END SUBROUTINE </span><span class="n">CalcSpecialDayTypes</span>
<a name="ln-6536"></a>
<a name="ln-6537"></a><span class="k">SUBROUTINE </span><span class="n">GetDSTData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6538"></a>
<a name="ln-6539"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6540"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-6541"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-6542"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6543"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6544"></a>
<a name="ln-6545"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6546"></a>          <span class="c">! This subroutine gets a possible &quot;Daylight Saving Period&quot; from the IDF.  Using this</span>
<a name="ln-6547"></a>          <span class="c">! will overwrite any prior DST data.</span>
<a name="ln-6548"></a>
<a name="ln-6549"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6550"></a>          <span class="c">! Processes the following IDD definition:</span>
<a name="ln-6551"></a>          <span class="c">! DaylightSavingPeriod,</span>
<a name="ln-6552"></a>          <span class="c">!      \memo This object sets up the Daylight Saving period for any RunPeriod.</span>
<a name="ln-6553"></a>          <span class="c">!      \memo Ignores any DaylightSavingperiod values on the weather file and uses this definition.</span>
<a name="ln-6554"></a>          <span class="c">!      \memo (These are not used with DesignDay objects.)</span>
<a name="ln-6555"></a>          <span class="c">!  A1, \field StartDate</span>
<a name="ln-6556"></a>          <span class="c">!  A2, \field EndDate</span>
<a name="ln-6557"></a>          <span class="c">!      \memo  Dates can be several formats:</span>
<a name="ln-6558"></a>          <span class="c">!      \memo  &lt;number&gt;/&lt;number&gt;  (month/day)</span>
<a name="ln-6559"></a>          <span class="c">!      \memo  &lt;number&gt; &lt;Month&gt;</span>
<a name="ln-6560"></a>          <span class="c">!      \memo  &lt;Month&gt; &lt;number&gt;</span>
<a name="ln-6561"></a>          <span class="c">!      \memo &lt;Nth&gt; &lt;Weekday&gt; in &lt;Month)</span>
<a name="ln-6562"></a>          <span class="c">!      \memo Last &lt;WeekDay&gt; in &lt;Month&gt;</span>
<a name="ln-6563"></a>          <span class="c">!      \memo &lt;Month&gt; can be January, February, March, April, May, June, July, August, September,</span>
<a name="ln-6564"></a>                                      <span class="c">! October, November, December</span>
<a name="ln-6565"></a>          <span class="c">!      \memo Months can be the first 3 letters of the month</span>
<a name="ln-6566"></a>          <span class="c">!      \memo &lt;Weekday&gt; can be Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday</span>
<a name="ln-6567"></a>          <span class="c">!      \memo &lt;Nth&gt; can be 1 or 1st, 2 or 2nd, etc. up to 5(?)</span>
<a name="ln-6568"></a>
<a name="ln-6569"></a>
<a name="ln-6570"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6571"></a>          <span class="c">! na</span>
<a name="ln-6572"></a>
<a name="ln-6573"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6574"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-6575"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-6576"></a>
<a name="ln-6577"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6578"></a>
<a name="ln-6579"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6580"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! will be set to true if severe errors are found in inputs</span>
<a name="ln-6581"></a>
<a name="ln-6582"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6583"></a>          <span class="c">! na</span>
<a name="ln-6584"></a>
<a name="ln-6585"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6586"></a>          <span class="c">! na</span>
<a name="ln-6587"></a>
<a name="ln-6588"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6589"></a>          <span class="c">! na</span>
<a name="ln-6590"></a>
<a name="ln-6591"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6592"></a>  <span class="kt">INTEGER </span><span class="n">NumFound</span>
<a name="ln-6593"></a>  <span class="kt">INTEGER </span><span class="n">NumAlphas</span>
<a name="ln-6594"></a>  <span class="kt">INTEGER </span><span class="n">IOSTAT</span>
<a name="ln-6595"></a>  <span class="kt">INTEGER </span><span class="n">NumNumbers</span>
<a name="ln-6596"></a>
<a name="ln-6597"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;RunPeriodControl:DaylightSavingTime&#39;</span>
<a name="ln-6598"></a>  <span class="n">NumFound</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-6599"></a>
<a name="ln-6600"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFound</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6601"></a><span class="k">    CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6602"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6603"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6604"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6605"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Insufficient fields, must have Start AND End Dates&#39;</span><span class="p">)</span>
<a name="ln-6606"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6607"></a>    <span class="k">ELSE</span>  <span class="c">! Correct number of arguments</span>
<a name="ln-6608"></a>      <span class="k">CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">StMon</span><span class="p">,</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">StDay</span><span class="p">,</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">StWeekDay</span><span class="p">,</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">StDateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6609"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">StDateType</span> <span class="o">==</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6610"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-6611"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6612"></a>      <span class="n">ENDIF</span>
<a name="ln-6613"></a>      <span class="k">CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">EnMon</span><span class="p">,</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">EnDay</span><span class="p">,</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">EnWeekDay</span><span class="p">,</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">EnDateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6614"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IDFDST</span><span class="p">%</span><span class="n">EnDateType</span> <span class="o">==</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6615"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6616"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6617"></a>      <span class="n">ENDIF</span>
<a name="ln-6618"></a>      <span class="n">IDFDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6619"></a>    <span class="n">ENDIF</span>
<a name="ln-6620"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NumFound</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6621"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects in Input File, only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-6622"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6623"></a>  <span class="n">ENDIF</span>
<a name="ln-6624"></a>
<a name="ln-6625"></a>  <span class="k">RETURN</span>
<a name="ln-6626"></a>
<a name="ln-6627"></a><span class="k">END SUBROUTINE </span><span class="n">GetDSTData</span>
<a name="ln-6628"></a>
<a name="ln-6629"></a><span class="k">SUBROUTINE </span><span class="n">GetDesignDayData</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-6630"></a>
<a name="ln-6631"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6632"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-6633"></a>          <span class="c">!       DATE WRITTEN   September 1997</span>
<a name="ln-6634"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-6635"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6636"></a>
<a name="ln-6637"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6638"></a>          <span class="c">! This subroutine retrieves the design day info from user input file</span>
<a name="ln-6639"></a>          <span class="c">!  which is later to be used in the Setup Design Day Routine.</span>
<a name="ln-6640"></a>
<a name="ln-6641"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6642"></a>          <span class="c">!</span>
<a name="ln-6643"></a>
<a name="ln-6644"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6645"></a>          <span class="c">! SizingPeriod:DesignDay,</span>
<a name="ln-6646"></a>          <span class="c">!   A1, \field Name</span>
<a name="ln-6647"></a>          <span class="c">!   N1,  \field Month</span>
<a name="ln-6648"></a>          <span class="c">!   N2,  \field Day of Month</span>
<a name="ln-6649"></a>          <span class="c">!   A2,  \field Day Type</span>
<a name="ln-6650"></a>          <span class="c">!   N3,  \field Maximum Dry-Bulb Temperature</span>
<a name="ln-6651"></a>          <span class="c">!   N4,  \field Daily Dry-Bulb Temperature Range</span>
<a name="ln-6652"></a>          <span class="c">!   A3,  \field Dry-Bulb Temperature Range Modifier Type</span>
<a name="ln-6653"></a>          <span class="c">!   A4,  \field Dry-Bulb Temperature Range Modifier Day Schedule Name</span>
<a name="ln-6654"></a>          <span class="c">!   A5,  \field Humidity Condition Type</span>
<a name="ln-6655"></a>          <span class="c">!   N5,  \field Wetbulb or DewPoint at Maximum Dry-Bulb</span>
<a name="ln-6656"></a>          <span class="c">!   A6,  \field Humidity Condition Day Schedule Name</span>
<a name="ln-6657"></a>          <span class="c">!   N6,  \field Humidity Ratio at Maximum Dry-Bulb</span>
<a name="ln-6658"></a>          <span class="c">!   N7,  \field Enthalpy at Maximum Dry-Bulb  !will require units transition.</span>
<a name="ln-6659"></a>          <span class="c">!   N8,  \field Daily Wet-Bulb Temperature Range</span>
<a name="ln-6660"></a>          <span class="c">!   N9,  \field Barometric Pressure</span>
<a name="ln-6661"></a>          <span class="c">!   N10, \field Wind Speed</span>
<a name="ln-6662"></a>          <span class="c">!   N11, \field Wind Direction</span>
<a name="ln-6663"></a>          <span class="c">!   A7,  \field Rain Indicator</span>
<a name="ln-6664"></a>          <span class="c">!   A8,  \field Snow Indicator</span>
<a name="ln-6665"></a>          <span class="c">!   A9,  \field Daylight Saving Time Indicator</span>
<a name="ln-6666"></a>          <span class="c">!   A10, \field Solar Model Indicator</span>
<a name="ln-6667"></a>          <span class="c">!   A11, \field Beam Solar Day Schedule Name</span>
<a name="ln-6668"></a>          <span class="c">!   A12, \field Diffuse Solar Day Schedule Name</span>
<a name="ln-6669"></a>          <span class="c">!   N12, \field ASHRAE Clear Sky Optical Depth for Beam Irradiance (taub)</span>
<a name="ln-6670"></a>          <span class="c">!   N13, \field ASHRAE Clear Sky Optical Depth for Diffuse Irradiance (taud)</span>
<a name="ln-6671"></a>          <span class="c">!   N14; \field Sky Clearness</span>
<a name="ln-6672"></a>
<a name="ln-6673"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6674"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-6675"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">RangeCheck</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-6676"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">FindNumberInList</span>
<a name="ln-6677"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDayScheduleIndex</span><span class="p">,</span> <span class="n">GetSingleDayScheduleValues</span><span class="p">,</span> <span class="n">CheckDayScheduleValueMinMax</span>
<a name="ln-6678"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span>
<a name="ln-6679"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-6680"></a>
<a name="ln-6681"></a> <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6682"></a>
<a name="ln-6683"></a>         <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6684"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">TotDesDays</span>    <span class="c">! Total number of Design days to Setup</span>
<a name="ln-6685"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-6686"></a>
<a name="ln-6687"></a>         <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6688"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ValidNames</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;SUNDAY         &#39;</span><span class="p">,</span><span class="s1">&#39;MONDAY         &#39;</span><span class="p">,</span><span class="s1">&#39;TUESDAY        &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6689"></a>                                                             <span class="s1">&#39;WEDNESDAY      &#39;</span><span class="p">,</span><span class="s1">&#39;THURSDAY       &#39;</span><span class="p">,</span><span class="s1">&#39;FRIDAY         &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6690"></a>                                                             <span class="s1">&#39;SATURDAY       &#39;</span><span class="p">,</span><span class="s1">&#39;HOLIDAY        &#39;</span><span class="p">,</span><span class="s1">&#39;SUMMERDESIGNDAY&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6691"></a>                                                             <span class="s1">&#39;WINTERDESIGNDAY&#39;</span><span class="p">,</span><span class="s1">&#39;CUSTOMDAY1     &#39;</span><span class="p">,</span><span class="s1">&#39;CUSTOMDAY2     &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-6692"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">DDHumIndType_Count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HumidityIndicatingType</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-6693"></a>         <span class="p">(</span><span class="o">/</span><span class="s1">&#39;Wetbulb [C]                        &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6694"></a>           <span class="s1">&#39;Dewpoint [C]                       &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6695"></a>           <span class="s1">&#39;Enthalpy [J/kg]                    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6696"></a>           <span class="s1">&#39;Humidity Ratio []                  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6697"></a>           <span class="s1">&#39;Schedule []                        &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6698"></a>           <span class="s1">&#39;WetBulbProfileDefaultMultipliers []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6699"></a>           <span class="s1">&#39;WetBulbProfileDifferenceSchedule []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6700"></a>           <span class="s1">&#39;WetBulbProfileMultiplierSchedule []&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-6701"></a>
<a name="ln-6702"></a>
<a name="ln-6703"></a><span class="c">!  REAL(r64), PARAMETER, DIMENSION(24) :: DefaultTempRangeMult=(/ .87d0,.92d0,.96d0,.99d0,1.0d0,.98d0,.93d0,  &amp;</span>
<a name="ln-6704"></a><span class="c">!                   .84d0,.71d0,.56d0,.39d0,.23d0, .11d0,.03d0,.00d0,.03d0,.10d0,.21d0,.34d0,.47d0,.58d0,.68d0,.76d0,.82d0 /)</span>
<a name="ln-6705"></a>  <span class="c">! Below are the 2009 fractions, HOF, Chap 14, Table 6</span>
<a name="ln-6706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DefaultTempRangeMult</span><span class="o">=</span><span class="p">(</span><span class="o">/</span> <span class="p">.</span><span class="mi">88</span><span class="n">d0</span><span class="p">,.</span><span class="mi">92</span><span class="n">d0</span><span class="p">,.</span><span class="mi">95</span><span class="n">d0</span><span class="p">,.</span><span class="mi">98</span><span class="n">d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,.</span><span class="mi">98</span><span class="n">d0</span><span class="p">,.</span><span class="mi">91</span><span class="n">d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6707"></a>                   <span class="p">.</span><span class="mi">74</span><span class="n">d0</span><span class="p">,.</span><span class="mi">55</span><span class="n">d0</span><span class="p">,.</span><span class="mi">38</span><span class="n">d0</span><span class="p">,.</span><span class="mi">23</span><span class="n">d0</span><span class="p">,.</span><span class="mi">13</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">05</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.00d0</span><span class="p">,</span><span class="mf">0.00d0</span><span class="p">,.</span><span class="mi">06</span><span class="n">d0</span><span class="p">,.</span><span class="mi">14</span><span class="n">d0</span><span class="p">,.</span><span class="mi">24</span><span class="n">d0</span><span class="p">,.</span><span class="mi">39</span><span class="n">d0</span><span class="p">,.</span><span class="mi">50</span><span class="n">d0</span><span class="p">,.</span><span class="mi">59</span><span class="n">d0</span><span class="p">,.</span><span class="mi">68</span><span class="n">d0</span><span class="p">,.</span><span class="mi">75</span><span class="n">d0</span><span class="p">,.</span><span class="mi">82</span><span class="n">d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-6708"></a>
<a name="ln-6709"></a>         <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6710"></a>         <span class="c">! na</span>
<a name="ln-6711"></a>
<a name="ln-6712"></a>         <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6713"></a>         <span class="c">! na</span>
<a name="ln-6714"></a>
<a name="ln-6715"></a>         <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6716"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">EnvrnNum</span>      <span class="c">! Environment Loop to pass to Design Day Setup Routine</span>
<a name="ln-6717"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlpha</span> <span class="c">! Number of material alpha names being passed</span>
<a name="ln-6718"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumerics</span>  <span class="c">! Number of material properties being passed</span>
<a name="ln-6719"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>           <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-6720"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>               <span class="c">! Flag to verify name</span>
<a name="ln-6721"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>               <span class="c">! Flag for blank name</span>
<a name="ln-6722"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HrLoop</span>
<a name="ln-6723"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TSLoop</span>
<a name="ln-6724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">LastHrValue</span>
<a name="ln-6725"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WNow</span>
<a name="ln-6726"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WPrev</span>
<a name="ln-6727"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">testval</span>
<a name="ln-6728"></a>  <span class="kt">LOGICAL </span><span class="n">errflag</span>
<a name="ln-6729"></a>  <span class="kt">INTEGER </span><span class="n">DDLoop</span>
<a name="ln-6730"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">envTitle</span>
<a name="ln-6731"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span> <span class="kd">::</span> <span class="n">units</span>
<a name="ln-6732"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">schPtr</span>
<a name="ln-6733"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">MaxDryBulbEntered</span>
<a name="ln-6734"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PressureEntered</span>
<a name="ln-6735"></a>
<a name="ln-6736"></a>         <span class="c">! FLOW:</span>
<a name="ln-6737"></a>
<a name="ln-6738"></a>   <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">))</span><span class="c">! Allocate the array to the # of DD&#39;s</span>
<a name="ln-6739"></a>   <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-6740"></a>   <span class="n">DDDBRngModifier</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6741"></a>   <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DDHumIndModifier</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-6742"></a>   <span class="n">DDHumIndModifier</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6743"></a>   <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DDBeamSolarValues</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-6744"></a>   <span class="n">DDBeamSolarValues</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6745"></a>   <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DDDiffuseSolarValues</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-6746"></a>   <span class="n">DDDiffuseSolarValues</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6747"></a>   <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DDSkyTempScheduleValues</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-6748"></a>   <span class="n">DDSkyTempScheduleValues</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6749"></a>
<a name="ln-6750"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SPSiteDryBulbRangeModScheduleValue</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">))</span>
<a name="ln-6751"></a>   <span class="n">SPSiteDryBulbRangeModScheduleValue</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6752"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SPSiteHumidityConditionScheduleValue</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">))</span>
<a name="ln-6753"></a>   <span class="n">SPSiteHumidityConditionScheduleValue</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6754"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SPSiteBeamSolarScheduleValue</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">))</span>
<a name="ln-6755"></a>   <span class="n">SPSiteBeamSolarScheduleValue</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6756"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SPSiteDiffuseSolarScheduleValue</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">))</span>
<a name="ln-6757"></a>   <span class="n">SPSiteDiffuseSolarScheduleValue</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6758"></a>   <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SPSiteSkyTemperatureScheduleValue</span><span class="p">(</span><span class="n">TotDesDays</span><span class="p">))</span>
<a name="ln-6759"></a>   <span class="n">SPSiteSkyTemperatureScheduleValue</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6760"></a>
<a name="ln-6761"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">ReverseDD</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TotDesDays</span> <span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6762"></a><span class="k">     CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDesignDayData: Reverse Design Day requested but # Design Days &lt;=1&#39;</span><span class="p">)</span>
<a name="ln-6763"></a>   <span class="n">ENDIF</span>
<a name="ln-6764"></a>
<a name="ln-6765"></a>   <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SizingPeriod:DesignDay&#39;</span>
<a name="ln-6766"></a>   <span class="k">Do </span><span class="n">DDLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotDesDays</span>
<a name="ln-6767"></a>
<a name="ln-6768"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">ReverseDD</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6769"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">DDLoop</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TotDesDays</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6770"></a><span class="k">         </span><span class="n">EnvrnNum</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-6771"></a>       <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DDLoop</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6772"></a><span class="k">         </span><span class="n">EnvrnNum</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6773"></a>       <span class="k">ELSE</span>
<a name="ln-6774"></a><span class="k">         </span><span class="n">EnvrnNum</span><span class="o">=</span><span class="n">DDLoop</span>
<a name="ln-6775"></a>       <span class="n">ENDIF</span>
<a name="ln-6776"></a>     <span class="k">ELSE</span>
<a name="ln-6777"></a><span class="k">       </span><span class="n">EnvrnNum</span><span class="o">=</span><span class="n">DDLoop</span>
<a name="ln-6778"></a>     <span class="n">ENDIF</span>
<a name="ln-6779"></a>
<a name="ln-6780"></a>
<a name="ln-6781"></a>  <span class="c">!Call Input Get routine to retrieve design day data</span>
<a name="ln-6782"></a>    <span class="n">MaxDryBulbEntered</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6783"></a>    <span class="n">PressureEntered</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6784"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">DDLoop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumerics</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6785"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6786"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-6787"></a>
<a name="ln-6788"></a>          <span class="c">!   A1, \field Name</span>
<a name="ln-6789"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6790"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6791"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DesDayInput</span><span class="p">%</span><span class="n">Title</span><span class="p">,</span><span class="n">EnvrnNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-6792"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6793"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6794"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-6795"></a>    <span class="n">ENDIF</span>
<a name="ln-6796"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>            <span class="c">! Environment name</span>
<a name="ln-6797"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-6798"></a>
<a name="ln-6799"></a>          <span class="c">!   N3,  \field Maximum Dry-Bulb Temperature</span>
<a name="ln-6800"></a>          <span class="c">!   N4,  \field Daily Dry-Bulb Temperature Range</span>
<a name="ln-6801"></a>          <span class="c">!   N9,  \field Barometric Pressure</span>
<a name="ln-6802"></a>          <span class="c">!   N10, \field Wind Speed</span>
<a name="ln-6803"></a>          <span class="c">!   N11, \field Wind Direction</span>
<a name="ln-6804"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Maximum Dry-Bulb Temperature (C)</span>
<a name="ln-6805"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="n">MaxDryBulbEntered</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6806"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DailyDBRange</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>     <span class="c">! Daily dry-bulb temperature range (deltaC)</span>
<a name="ln-6807"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressBarom</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>       <span class="c">! Atmospheric/Barometric Pressure (Pascals)</span>
<a name="ln-6808"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="n">PressureEntered</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6809"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">PressureEntered</span><span class="o">=</span><span class="n">PressureEntered</span>
<a name="ln-6810"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WindSpeed</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>        <span class="c">! Wind Speed (m/s)</span>
<a name="ln-6811"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WindDir</span> <span class="o">=</span> <span class="nb">MOD</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">36</span><span class="mf">0.d0</span><span class="p">)</span><span class="c">! Wind Direction</span>
<a name="ln-6812"></a>                                                               <span class="c">! (degrees clockwise from North, N=0, E=90, S=180, W=270)</span>
<a name="ln-6813"></a>          <span class="c">!   N1,  \field Month</span>
<a name="ln-6814"></a>          <span class="c">!   N2,  \field Day of Month</span>
<a name="ln-6815"></a>          <span class="c">!   N12, \field ASHRAE Clear Sky Optical Depth for Beam Irradiance (taub)</span>
<a name="ln-6816"></a>          <span class="c">!   N13, \field ASHRAE Clear Sky Optical Depth for Diffuse Irradiance (taud)</span>
<a name="ln-6817"></a>          <span class="c">!   N8,  \field Daily Wet-Bulb Temperature Range</span>
<a name="ln-6818"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="o">=</span><span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>        <span class="c">! Month of Year ( 1 - 12 )</span>
<a name="ln-6819"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span><span class="o">=</span><span class="nb">Int</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>   <span class="c">! Day of Month ( 1 - 31 )</span>
<a name="ln-6820"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TauB</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>              <span class="c">! beam tau &gt;= 0</span>
<a name="ln-6821"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TauD</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>              <span class="c">! diffuse tau &gt;= 0</span>
<a name="ln-6822"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DailyWBRange</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>      <span class="c">! Daily wet-bulb temperature range (deltaC)</span>
<a name="ln-6823"></a>
<a name="ln-6824"></a>          <span class="c">!   N14; \field Sky Clearness</span>
<a name="ln-6825"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SkyClear</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>         <span class="c">! Sky Clearness (0 to 1)</span>
<a name="ln-6826"></a>
<a name="ln-6827"></a>          <span class="c">!   A7,  \field Rain Indicator</span>
<a name="ln-6828"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6829"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">RainInd</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6830"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6831"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">RainInd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6832"></a>    <span class="k">ELSE</span>
<a name="ln-6833"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6834"></a>         <span class="s1">&#39;&quot;, invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6835"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;No&quot; will be used.&#39;</span><span class="p">)</span>
<a name="ln-6836"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">RainInd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6837"></a>    <span class="n">ENDIF</span>
<a name="ln-6838"></a>
<a name="ln-6839"></a>          <span class="c">!   A8,  \field Snow Indicator</span>
<a name="ln-6840"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6841"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SnowInd</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6842"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6843"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SnowInd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6844"></a>    <span class="k">ELSE</span>
<a name="ln-6845"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6846"></a>         <span class="s1">&#39;&quot;, invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6847"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;No&quot; will be used.&#39;</span><span class="p">)</span>
<a name="ln-6848"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SnowInd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6849"></a>    <span class="n">ENDIF</span>
<a name="ln-6850"></a>
<a name="ln-6851"></a>          <span class="c">!   A3,  \field Dry-Bulb Temperature Range Modifier Type</span>
<a name="ln-6852"></a>    <span class="c">! check DB profile input</span>
<a name="ln-6853"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6854"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DefaultMultipliers&#39;</span>
<a name="ln-6855"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">=</span> <span class="n">DDDBRangeType_Default</span>
<a name="ln-6856"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Multiplier&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;MultiplierSchedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6857"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;MultiplierSchedule&#39;</span>
<a name="ln-6858"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">=</span> <span class="n">DDDBRangeType_Multiplier</span>
<a name="ln-6859"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[]&#39;</span>
<a name="ln-6860"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Difference&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Delta&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6861"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;DifferenceSchedule&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;DeltaSchedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6862"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DifferenceSchedule&#39;</span>
<a name="ln-6863"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">=</span> <span class="n">DDDBRangeType_Difference</span>
<a name="ln-6864"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[deltaC]&#39;</span>
<a name="ln-6865"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;DefaultMultipliers&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6866"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DefaultMultipliers&#39;</span>
<a name="ln-6867"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">=</span> <span class="n">DDDBRangeType_Default</span>
<a name="ln-6868"></a>      <span class="c">! Validate Temperature - Daily range</span>
<a name="ln-6869"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;TemperatureProfileSchedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6870"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;TemperatureProfileSchedule&#39;</span>
<a name="ln-6871"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">=</span> <span class="n">DDDBRangeType_Profile</span>
<a name="ln-6872"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span>
<a name="ln-6873"></a>    <span class="k">ELSE</span>
<a name="ln-6874"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-6875"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6876"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6877"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;invalid field&#39;</span>
<a name="ln-6878"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">=</span> <span class="n">DDDBRangeType_Default</span>
<a name="ln-6879"></a>    <span class="n">ENDIF</span>
<a name="ln-6880"></a>
<a name="ln-6881"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">/=</span> <span class="n">DDDBRangeType_Profile</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MaxDryBulbEntered</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6882"></a>        <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;invalid field&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6883"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-6884"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid blank field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-6885"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..this field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6886"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6887"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6888"></a>    <span class="n">ENDIF</span>
<a name="ln-6889"></a>
<a name="ln-6890"></a>    <span class="c">! Assume either &quot;multiplier&quot; option will make full use of range...</span>
<a name="ln-6891"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">/=</span> <span class="n">DDDBRangeType_Difference</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-6892"></a>        <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeTYpe</span> <span class="o">/=</span> <span class="n">DDDBRangeType_Profile</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6893"></a><span class="k">      </span><span class="n">testval</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="o">-</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DailyDBRange</span>
<a name="ln-6894"></a>      <span class="n">errflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6895"></a>      <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">errflag</span><span class="p">,</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= -90&#39;</span><span class="p">,(</span><span class="n">testval</span><span class="o">&gt;=-</span><span class="mi">9</span><span class="mf">0.d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6896"></a>                        <span class="s1">&#39;&lt;= 70&#39;</span><span class="p">,(</span><span class="n">testval</span> <span class="o">&lt;=</span><span class="mi">7</span><span class="mf">0.d0</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span>
<a name="ln-6897"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6898"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6899"></a>      <span class="n">ENDIF</span>
<a name="ln-6900"></a>    <span class="n">ENDIF</span>
<a name="ln-6901"></a>
<a name="ln-6902"></a>          <span class="c">!   A4,  \field Dry-Bulb Temperature Range Modifier Day Schedule Name</span>
<a name="ln-6903"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DBTempRangeType</span> <span class="o">/=</span> <span class="n">DDDBRangeType_Default</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6904"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6905"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span><span class="o">=</span><span class="n">GetDayScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-6906"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6907"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-6908"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6909"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6910"></a>        <span class="k">ELSE</span>
<a name="ln-6911"></a><span class="k">          CALL </span><span class="n">GetSingleDayScheduleValues</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span><span class="p">,</span><span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:))</span>
<a name="ln-6912"></a>          <span class="n">schPtr</span><span class="o">=</span><span class="n">FindNumberInList</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span><span class="p">,</span><span class="n">SPSiteScheduleNamePtr</span><span class="p">,</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span>
<a name="ln-6913"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">schPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6914"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6915"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span>
<a name="ln-6916"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-6917"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Drybulb Temperature Range Modifier Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6918"></a>               <span class="n">SPSiteDryBulbRangeModScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-6919"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">schPtr</span><span class="p">)</span><span class="o">/=</span> <span class="n">units</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6920"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6921"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span>
<a name="ln-6922"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-6923"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Drybulb Temperature Range Modifier Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6924"></a>               <span class="n">SPSiteDryBulbRangeModScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-6925"></a>          <span class="n">ENDIF</span>
<a name="ln-6926"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;MultiplierSchedule&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6927"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckDayScheduleValueMinMax</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6928"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-6929"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6930"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Specified [Schedule] Dry-bulb Range Multiplier Values are not within [0.0, 1.0]&#39;</span><span class="p">)</span>
<a name="ln-6931"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6932"></a>            <span class="n">ENDIF</span>
<a name="ln-6933"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;DifferenceSchedule&#39;</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! delta, must be &gt; 0.0</span>
<a name="ln-6934"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckDayScheduleValueMinMax</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TempRangeSchPtr</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6935"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-6936"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6937"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Some [Schedule] Dry-bulb Range Difference Values are &lt; 0.0 [would make max larger].&#39;</span><span class="p">)</span>
<a name="ln-6938"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6939"></a>            <span class="n">ENDIF</span>
<a name="ln-6940"></a>          <span class="n">ENDIF</span>
<a name="ln-6941"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;TemperatureProfileSchedule&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6942"></a><span class="k">            </span><span class="n">testval</span><span class="o">=</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:))</span>
<a name="ln-6943"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">MaxDryBulbEntered</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6944"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, data override.&#39;</span><span class="p">)</span>
<a name="ln-6945"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6946"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] will be overwritten.&#39;</span><span class="p">)</span>
<a name="ln-6947"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6948"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..with max value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">testval</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-6949"></a>            <span class="n">ENDIF</span>
<a name="ln-6950"></a>            <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="o">=</span><span class="n">testval</span>
<a name="ln-6951"></a>          <span class="n">ENDIF</span>
<a name="ln-6952"></a>          <span class="n">testval</span><span class="o">=</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:))</span>
<a name="ln-6953"></a>          <span class="n">testval</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="o">-</span><span class="n">testval</span>
<a name="ln-6954"></a>          <span class="n">errflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6955"></a>          <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= -90&#39;</span><span class="p">,(</span><span class="n">testval</span><span class="o">&gt;=-</span><span class="mi">9</span><span class="mf">0.d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6956"></a>                           <span class="s1">&#39;&lt;= 70&#39;</span><span class="p">,(</span><span class="n">testval</span> <span class="o">&lt;=</span><span class="mi">7</span><span class="mf">0.d0</span><span class="p">),</span><span class="n">WhatObjectName</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span>
<a name="ln-6957"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6958"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6959"></a>          <span class="n">ENDIF</span>
<a name="ln-6960"></a>        <span class="n">ENDIF</span>
<a name="ln-6961"></a>      <span class="k">ELSE</span>
<a name="ln-6962"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-6963"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-6964"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..required when &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; indicates &quot;SCHEDULE&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6965"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6966"></a>      <span class="n">ENDIF</span>
<a name="ln-6967"></a>    <span class="k">ELSE</span>
<a name="ln-6968"></a>      <span class="c">! Default dry-bulb temperature Range</span>
<a name="ln-6969"></a>      <span class="n">LastHrValue</span><span class="o">=</span><span class="n">DefaultTempRangeMult</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-6970"></a>      <span class="k">DO </span><span class="n">HrLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-6971"></a>        <span class="k">DO </span><span class="n">TSLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-6972"></a>          <span class="n">WNow</span><span class="o">=</span><span class="n">Interpolation</span><span class="p">(</span><span class="n">TSLoop</span><span class="p">)</span>
<a name="ln-6973"></a>          <span class="n">WPrev</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="n">WNow</span>
<a name="ln-6974"></a>          <span class="n">DDDBRngModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">HrLoop</span><span class="p">,</span><span class="n">TSLoop</span><span class="p">)</span><span class="o">=</span><span class="n">LastHrValue</span><span class="o">*</span><span class="n">WPrev</span><span class="o">+</span><span class="n">DefaultTempRangeMult</span><span class="p">(</span><span class="n">HrLoop</span><span class="p">)</span><span class="o">*</span><span class="n">WNow</span>
<a name="ln-6975"></a>        <span class="n">ENDDO</span>
<a name="ln-6976"></a>        <span class="n">LastHrValue</span><span class="o">=</span><span class="n">DefaultTempRangeMult</span><span class="p">(</span><span class="n">HrLoop</span><span class="p">)</span>
<a name="ln-6977"></a>      <span class="n">ENDDO</span>
<a name="ln-6978"></a>    <span class="n">ENDIF</span>
<a name="ln-6979"></a>
<a name="ln-6980"></a>          <span class="c">!   A5,  \field Humidity Condition Type</span>
<a name="ln-6981"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;WetBulb&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6982"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;WetBulb&#39;</span>
<a name="ln-6983"></a>          <span class="c">!   N5,  \field Wetbulb or DewPoint at Maximum Dry-Bulb</span>
<a name="ln-6984"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6985"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c">! Humidity Indicating Conditions at Max Dry-Bulb</span>
<a name="ln-6986"></a>      <span class="k">ELSE</span>
<a name="ln-6987"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-6988"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-6989"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-6990"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6991"></a>      <span class="n">ENDIF</span>
<a name="ln-6992"></a>      <span class="n">errflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6993"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_Wetbulb</span>
<a name="ln-6994"></a>      <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; - Wet-Bulb&#39;</span><span class="p">,</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= -90&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6995"></a>                     <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="o">&gt;=-</span><span class="mi">9</span><span class="mf">0.d0</span><span class="p">),</span><span class="s1">&#39;&lt;= 70&#39;</span><span class="p">,(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">&lt;=</span><span class="mi">7</span><span class="mf">0.d0</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-6996"></a>                     <span class="n">WhatObjectName</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span>
<a name="ln-6997"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6998"></a><span class="c">!        CALL ShowContinueError(TRIM(cCurrentModuleObject)//&#39;: Occured in &#39;//TRIM(DesDayInput(EnvrnNum)%Title))</span>
<a name="ln-6999"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7000"></a>      <span class="n">ENDIF</span>
<a name="ln-7001"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;DewPoint&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7002"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DewPoint&#39;</span>
<a name="ln-7003"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7004"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c">! Humidity Indicating Conditions at Max Dry-Bulb</span>
<a name="ln-7005"></a>      <span class="k">ELSE</span>
<a name="ln-7006"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7007"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7008"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7009"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7010"></a>      <span class="n">ENDIF</span>
<a name="ln-7011"></a>      <span class="n">errflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7012"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_Dewpoint</span>
<a name="ln-7013"></a>      <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; - Dew-Point&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= -90&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7014"></a>                     <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="o">&gt;=-</span><span class="mi">9</span><span class="mf">0.d0</span><span class="p">),</span><span class="s1">&#39;&lt;= 70&#39;</span><span class="p">,(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">&lt;=</span><span class="mi">7</span><span class="mf">0.d0</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-7015"></a>                      <span class="n">WhatObjectName</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span>
<a name="ln-7016"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7017"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7018"></a>      <span class="n">ENDIF</span>
<a name="ln-7019"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;HumidityRatio&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7020"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;HumidityRatio&#39;</span>
<a name="ln-7021"></a>          <span class="c">!   N6,  \field Humidity Ratio at Maximum Dry-Bulb</span>
<a name="ln-7022"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7023"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>       <span class="c">! Humidity Indicating Conditions at Max Dry-Bulb</span>
<a name="ln-7024"></a>      <span class="k">ELSE</span>
<a name="ln-7025"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7026"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7027"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7028"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7029"></a>      <span class="n">ENDIF</span>
<a name="ln-7030"></a>      <span class="n">errflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7031"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_HumRatio</span>
<a name="ln-7032"></a>      <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; - Humidity-Ratio&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= 0&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7033"></a>                     <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="o">&gt;=</span><span class="mf">0.d0</span><span class="p">),</span><span class="s1">&#39;&lt;= .03&#39;</span><span class="p">,(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">&lt;=</span><span class="p">.</span><span class="mi">03</span><span class="n">d0</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-7034"></a>                     <span class="n">WhatObjectName</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span>
<a name="ln-7035"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7036"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7037"></a>      <span class="n">ENDIF</span>
<a name="ln-7038"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Enthalpy&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7039"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;Enthalpy&#39;</span>
<a name="ln-7040"></a>          <span class="c">!   N7,  \field Enthalpy at Maximum Dry-Bulb  !will require units transition.</span>
<a name="ln-7041"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7042"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>       <span class="c">! Humidity Indicating Conditions at Max Dry-Bulb</span>
<a name="ln-7043"></a>      <span class="k">ELSE</span>
<a name="ln-7044"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7045"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7046"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7047"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7048"></a>      <span class="n">ENDIF</span>
<a name="ln-7049"></a>      <span class="n">errflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7050"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_Enthalpy</span>
<a name="ln-7051"></a>      <span class="k">CALL </span><span class="n">RangeCheck</span><span class="p">(</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; - Enthalpy&#39;</span><span class="p">,</span><span class="s1">&#39;SizingPeriod:DesignDay&#39;</span><span class="p">,</span><span class="s1">&#39;Severe&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;= 0.0&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7052"></a>                     <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="o">&gt;=</span><span class="mf">0.d0</span><span class="p">),</span><span class="s1">&#39;&lt;= 130000&#39;</span><span class="p">,(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">&lt;=</span><span class="mi">13000</span><span class="mf">0.d0</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-7053"></a>                      <span class="n">WhatObjectName</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span>
<a name="ln-7054"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7055"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7056"></a>      <span class="n">ENDIF</span>
<a name="ln-7057"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;RelativeHumiditySchedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7058"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;RelativeHumiditySchedule&#39;</span>
<a name="ln-7059"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_RelHumSch</span>
<a name="ln-7060"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[%]&#39;</span>
<a name="ln-7061"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;WetBulbProfileMultiplierSchedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7062"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;WetBulbProfileMultiplierSchedule&#39;</span>
<a name="ln-7063"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_WBProfMul</span>
<a name="ln-7064"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[]&#39;</span>
<a name="ln-7065"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7066"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c">! Humidity Indicating Conditions at Max Dry-Bulb</span>
<a name="ln-7067"></a>      <span class="k">ELSE</span>
<a name="ln-7068"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7069"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7070"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7071"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7072"></a>      <span class="n">ENDIF</span>
<a name="ln-7073"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;WetBulbProfileDifferenceSchedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7074"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;WetBulbProfileDifferenceSchedule&#39;</span>
<a name="ln-7075"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_WBProfDif</span>
<a name="ln-7076"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[]&#39;</span>
<a name="ln-7077"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7078"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c">! Humidity Indicating Conditions at Max Dry-Bulb</span>
<a name="ln-7079"></a>      <span class="k">ELSE</span>
<a name="ln-7080"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7081"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7082"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7083"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7084"></a>      <span class="n">ENDIF</span>
<a name="ln-7085"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;WetBulbProfileDefaultMultipliers&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7086"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;WetBulbProfileDefaultMultipliers&#39;</span>
<a name="ln-7087"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_WBProfDef</span>
<a name="ln-7088"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7089"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c">! Humidity Indicating Conditions at Max Dry-Bulb</span>
<a name="ln-7090"></a>      <span class="k">ELSE</span>
<a name="ln-7091"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7092"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7093"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7094"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7095"></a>      <span class="n">ENDIF</span>
<a name="ln-7096"></a>    <span class="k">ELSE</span>
<a name="ln-7097"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7098"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7099"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;WetBulb will be used. Maximum Dry Bulb will be used as WetBulb at Maximum Dry Bulb.&#39;</span><span class="p">)</span>
<a name="ln-7100"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;WetBulb&#39;</span>
<a name="ln-7101"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="o">=</span><span class="n">DDHumIndType_Wetbulb</span>
<a name="ln-7102"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-7103"></a>    <span class="n">ENDIF</span>
<a name="ln-7104"></a>
<a name="ln-7105"></a>    <span class="c">! resolve humidity schedule if needed</span>
<a name="ln-7106"></a>          <span class="c">!   A6,  \field Humidity Condition Day Schedule Name</span>
<a name="ln-7107"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_RelHumSch</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7108"></a>        <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfMul</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7109"></a>        <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDif</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7110"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7111"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7112"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7113"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..field is required when &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7114"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7115"></a>      <span class="k">ELSE</span>
<a name="ln-7116"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span><span class="o">=</span><span class="n">GetDayScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7117"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7118"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7119"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7120"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Default Humidity will be used (constant for day using Humidity Indicator Temp).&#39;</span><span class="p">)</span>
<a name="ln-7121"></a>          <span class="c">! reset HumIndType ?</span>
<a name="ln-7122"></a>        <span class="k">ELSE</span>
<a name="ln-7123"></a>
<a name="ln-7124"></a><span class="k">          CALL </span><span class="n">GetSingleDayScheduleValues</span><span class="p">(</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span><span class="p">,</span> <span class="n">DDHumIndModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:))</span>
<a name="ln-7125"></a>
<a name="ln-7126"></a>          <span class="n">schPtr</span><span class="o">=</span><span class="n">FindNumberInList</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span><span class="p">,</span><span class="n">SPSiteScheduleNamePtr</span><span class="p">,</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span>
<a name="ln-7127"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">schPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7128"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7129"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span>
<a name="ln-7130"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7131"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Humidity Condition Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7132"></a>               <span class="n">SPSiteHumidityConditionScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7133"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">schPtr</span><span class="p">)</span><span class="o">/=</span> <span class="n">units</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7134"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7135"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span>
<a name="ln-7136"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7137"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Humidity Condition Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7138"></a>               <span class="n">SPSiteHumidityConditionScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7139"></a>          <span class="n">ENDIF</span>
<a name="ln-7140"></a>
<a name="ln-7141"></a>
<a name="ln-7142"></a>          <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="p">)</span>
<a name="ln-7143"></a>
<a name="ln-7144"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_RelHumSch</span><span class="p">)</span>
<a name="ln-7145"></a>             <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckDayScheduleValueMinMax</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7146"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7147"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7148"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified [Scheduled] Relative Humidity Values are not within [0.0, 100.0]&#39;</span><span class="p">)</span>
<a name="ln-7149"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7150"></a>             <span class="n">ENDIF</span>
<a name="ln-7151"></a>
<a name="ln-7152"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_WBProfMul</span><span class="p">)</span>
<a name="ln-7153"></a>             <span class="c">! multiplier: use schedule value, check 0 &lt;= v &lt;= 1</span>
<a name="ln-7154"></a>             <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckDayScheduleValueMinMax</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7155"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7156"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7157"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Specified [Schedule] Wet-bulb Profile Range Multiplier Values are not within [0.0, 1.0]&#39;</span><span class="p">)</span>
<a name="ln-7158"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7159"></a>             <span class="n">ENDIF</span>
<a name="ln-7160"></a>
<a name="ln-7161"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">DDHumIndType_WBProfDif</span><span class="p">)</span>
<a name="ln-7162"></a>             <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckDayScheduleValueMinMax</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndSchPtr</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7163"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7164"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7165"></a>               <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Some [Schedule] Wet-bulb Profile Difference Values are &lt; 0.0 [would make max larger].&#39;</span><span class="p">)</span>
<a name="ln-7166"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7167"></a>             <span class="n">ENDIF</span>
<a name="ln-7168"></a>          <span class="k">END SELECT</span>
<a name="ln-7169"></a><span class="k">        END IF</span>
<a name="ln-7170"></a><span class="k">     END IF</span>
<a name="ln-7171"></a>
<a name="ln-7172"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDef</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7173"></a>      <span class="c">! re WetBulbProfileDefaultMultipliers</span>
<a name="ln-7174"></a>      <span class="n">LastHrValue</span><span class="o">=</span><span class="n">DefaultTempRangeMult</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-7175"></a>      <span class="k">DO </span><span class="n">HrLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-7176"></a>        <span class="k">DO </span><span class="n">TSLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-7177"></a>          <span class="n">WNow</span><span class="o">=</span><span class="n">Interpolation</span><span class="p">(</span><span class="n">TSLoop</span><span class="p">)</span>
<a name="ln-7178"></a>          <span class="n">WPrev</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="n">WNow</span>
<a name="ln-7179"></a>          <span class="n">DDHumIndModifier</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,</span><span class="n">HrLoop</span><span class="p">,</span><span class="n">TSLoop</span><span class="p">)</span><span class="o">=</span><span class="n">LastHrValue</span><span class="o">*</span><span class="n">WPrev</span><span class="o">+</span><span class="n">DefaultTempRangeMult</span><span class="p">(</span><span class="n">HrLoop</span><span class="p">)</span><span class="o">*</span><span class="n">WNow</span>
<a name="ln-7180"></a>        <span class="n">ENDDO</span>
<a name="ln-7181"></a>        <span class="n">LastHrValue</span><span class="o">=</span><span class="n">DefaultTempRangeMult</span><span class="p">(</span><span class="n">HrLoop</span><span class="p">)</span>
<a name="ln-7182"></a>      <span class="n">ENDDO</span>
<a name="ln-7183"></a>    <span class="c">! ELSE missing case?</span>
<a name="ln-7184"></a>    <span class="n">ENDIF</span>
<a name="ln-7185"></a>
<a name="ln-7186"></a>
<a name="ln-7187"></a>    <span class="c">! verify that design WB or DP &lt;= design DB</span>
<a name="ln-7188"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_Dewpoint</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-7189"></a>        <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_Wetbulb</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7190"></a>        <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfMul</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7191"></a>        <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDef</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7192"></a>        <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_WBProfDif</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7193"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">&gt;</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7194"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, range check data.&#39;</span><span class="p">)</span>
<a name="ln-7195"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Humidity Indicator Temperature at Max Temperature=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7196"></a>                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7197"></a>                   <span class="s1">&#39; &gt; Max DryBulb=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-7198"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7199"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Conditions for day will be set to Relative Humidity = 100%&#39;</span><span class="p">)</span>
<a name="ln-7200"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">==</span> <span class="n">DDHumIndType_Dewpoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7201"></a><span class="k">          </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DewpointNeedsSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7202"></a>        <span class="k">ELSE</span>
<a name="ln-7203"></a>          <span class="c">! wet-bulb</span>
<a name="ln-7204"></a>          <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span>
<a name="ln-7205"></a>        <span class="n">ENDIF</span>
<a name="ln-7206"></a>      <span class="n">ENDIF</span>
<a name="ln-7207"></a>    <span class="n">ENDIF</span>
<a name="ln-7208"></a>
<a name="ln-7209"></a>          <span class="c">!   A10, \field Solar Model Indicator</span>
<a name="ln-7210"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7211"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">=</span> <span class="n">ASHRAE_ClearSky</span>
<a name="ln-7212"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;ASHRAEClearSky&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;CLEARSKY&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7213"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">=</span> <span class="n">ASHRAE_ClearSky</span>
<a name="ln-7214"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;ZhangHuang&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7215"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">=</span> <span class="n">Zhang_Huang</span>
<a name="ln-7216"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;ASHRAETau&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7217"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">=</span> <span class="n">ASHRAE_Tau</span>
<a name="ln-7218"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Schedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7219"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">=</span> <span class="n">SolarModel_Schedule</span>
<a name="ln-7220"></a>    <span class="k">ELSE</span>
<a name="ln-7221"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7222"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7223"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Model used will be ASHRAE ClearSky&#39;</span><span class="p">)</span>
<a name="ln-7224"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">=</span> <span class="n">ASHRAE_ClearSky</span>
<a name="ln-7225"></a>    <span class="n">ENDIF</span>
<a name="ln-7226"></a>
<a name="ln-7227"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">SolarModel_Schedule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7228"></a>          <span class="c">!   A11, \field Beam Solar Day Schedule Name</span>
<a name="ln-7229"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7230"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">BeamSolarSchPtr</span><span class="o">=</span><span class="n">GetDayScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-7231"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">BeamSolarSchPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7232"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7233"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7234"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Required when &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; indicates &quot;Schedule&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7235"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7236"></a>        <span class="k">ELSE</span>
<a name="ln-7237"></a><span class="k">          CALL </span><span class="n">GetSingleDayScheduleValues</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">BeamSolarSchPtr</span><span class="p">,</span><span class="n">DDBeamSolarValues</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:))</span>
<a name="ln-7238"></a>          <span class="n">schPtr</span><span class="o">=</span><span class="n">FindNumberInList</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">BeamSolarSchPtr</span><span class="p">,</span><span class="n">SPSiteScheduleNamePtr</span><span class="p">,</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span>
<a name="ln-7239"></a>          <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[W/m2]&#39;</span>
<a name="ln-7240"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">schPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7241"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7242"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">BeamSolarSchPtr</span>
<a name="ln-7243"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7244"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Beam Solar Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7245"></a>               <span class="n">SPSiteBeamSolarScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-7246"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">schPtr</span><span class="p">)</span><span class="o">/=</span> <span class="n">units</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7247"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7248"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">BeamSolarSchPtr</span>
<a name="ln-7249"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7250"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Beam Solar Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7251"></a>               <span class="n">SPSiteBeamSolarScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-7252"></a>          <span class="n">ENDIF</span>
<a name="ln-7253"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckDayScheduleValueMinMax</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">BeamSolarSchPtr</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7254"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7255"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7256"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Specified [Schedule] Values are not &gt;= 0.0&#39;</span><span class="p">)</span>
<a name="ln-7257"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7258"></a>          <span class="n">ENDIF</span>
<a name="ln-7259"></a>        <span class="n">ENDIF</span>
<a name="ln-7260"></a>      <span class="k">ELSE</span>  <span class="c">! should have entered beam schedule</span>
<a name="ln-7261"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7262"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7263"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7264"></a>      <span class="n">ENDIF</span>
<a name="ln-7265"></a>          <span class="c">!   A12, \field Diffuse Solar Day Schedule Name</span>
<a name="ln-7266"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7267"></a><span class="k">        </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DiffuseSolarSchPtr</span><span class="o">=</span><span class="n">GetDayScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-7268"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DiffuseSolarSchPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7269"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7270"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7271"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Required when &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; indicates &quot;Schedule&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7272"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7273"></a>        <span class="k">ELSE</span>
<a name="ln-7274"></a><span class="k">          CALL </span><span class="n">GetSingleDayScheduleValues</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DiffuseSolarSchPtr</span><span class="p">,</span><span class="n">DDDiffuseSolarValues</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">,:,:))</span>
<a name="ln-7275"></a>          <span class="n">schPtr</span><span class="o">=</span><span class="n">FindNumberInList</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DiffuseSolarSchPtr</span><span class="p">,</span><span class="n">SPSiteScheduleNamePtr</span><span class="p">,</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span>
<a name="ln-7276"></a>          <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[W/m2]&#39;</span>
<a name="ln-7277"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">schPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7278"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7279"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DiffuseSolarSchPtr</span>
<a name="ln-7280"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7281"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Diffuse Solar Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7282"></a>               <span class="n">SPSiteDiffuseSolarScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-7283"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">schPtr</span><span class="p">)</span><span class="o">/=</span> <span class="n">units</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7284"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7285"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DiffuseSolarSchPtr</span>
<a name="ln-7286"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7287"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Diffuse Solar Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7288"></a>               <span class="n">SPSiteDiffuseSolarScheduleValue</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-7289"></a>          <span class="n">ENDIF</span>
<a name="ln-7290"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckDayScheduleValueMinMax</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DiffuseSolarSchPtr</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7291"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7292"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7293"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Specified [Schedule] Values are not &gt;= 0.0&#39;</span><span class="p">)</span>
<a name="ln-7294"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7295"></a>          <span class="n">ENDIF</span>
<a name="ln-7296"></a>        <span class="n">ENDIF</span>
<a name="ln-7297"></a>      <span class="k">ELSE</span>  <span class="c">! should have entered diffuse schedule</span>
<a name="ln-7298"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7299"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7300"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7301"></a>      <span class="n">ENDIF</span>
<a name="ln-7302"></a>    <span class="n">ENDIF</span>
<a name="ln-7303"></a>
<a name="ln-7304"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">SolarModel</span> <span class="o">==</span> <span class="n">ASHRAE_ClearSky</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7305"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7306"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7307"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-7308"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Zero clear sky (no solar) will be used.&#39;</span><span class="p">)</span>
<a name="ln-7309"></a>      <span class="n">ENDIF</span>
<a name="ln-7310"></a>    <span class="n">ENDIF</span>
<a name="ln-7311"></a>
<a name="ln-7312"></a>    <span class="c">! Validate Design Day Month</span>
<a name="ln-7313"></a>
<a name="ln-7314"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="p">)</span>
<a name="ln-7315"></a>
<a name="ln-7316"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7317"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7318"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7319"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7320"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7321"></a>           <span class="s1">&#39;], Month=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7322"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7323"></a>      <span class="n">ENDIF</span>
<a name="ln-7324"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-7325"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7326"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7327"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7328"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7329"></a>           <span class="s1">&#39;], Month=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7330"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7331"></a>      <span class="n">ENDIF</span>
<a name="ln-7332"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7333"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7334"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7335"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7336"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7337"></a>           <span class="s1">&#39;], Month=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7338"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7339"></a>      <span class="n">ENDIF</span>
<a name="ln-7340"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-7341"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7342"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; invalid (Month) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7343"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7344"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7345"></a>    <span class="k">END SELECT</span>
<a name="ln-7346"></a>
<a name="ln-7347"></a>          <span class="c">!   A9,  \field Daylight Saving Time Indicator</span>
<a name="ln-7348"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7349"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DSTIndicator</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7350"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7351"></a><span class="k">      </span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DSTIndicator</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7352"></a>    <span class="k">ELSE</span>
<a name="ln-7353"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7354"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;. &quot;No&quot; will be used.&#39;</span><span class="p">)</span>
<a name="ln-7355"></a>      <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DSTIndicator</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7356"></a>    <span class="n">ENDIF</span>
<a name="ln-7357"></a>
<a name="ln-7358"></a>          <span class="c">!   A2,  \field Day Type</span>
<a name="ln-7359"></a>    <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayType</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ValidNames</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7360"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayType</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7361"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid data.&#39;</span><span class="p">)</span>
<a name="ln-7362"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..invalid field: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7363"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid values are Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7364"></a>          <span class="s1">&#39;Holiday,SummerDesignDay,WinterDesignDay,CustomDay1,CustomDay2.&#39;</span><span class="p">)</span>
<a name="ln-7365"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7366"></a>    <span class="n">ENDIF</span>
<a name="ln-7367"></a>
<a name="ln-7368"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-7369"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksDesignDay</span>
<a name="ln-7370"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7371"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">StartMonth</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Month</span>
<a name="ln-7372"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">StartDay</span><span class="o">=</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfMonth</span>
<a name="ln-7373"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">StartMonth</span>
<a name="ln-7374"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-7375"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7376"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7377"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7378"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">StartJDay</span> <span class="o">=</span> <span class="n">DesignDay</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DayOfYear</span>
<a name="ln-7379"></a>    <span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">StartJDay</span>
<a name="ln-7380"></a>
<a name="ln-7381"></a>    <span class="c">!create predefined report on design day</span>
<a name="ln-7382"></a>    <span class="n">envTitle</span> <span class="o">=</span> <span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-7383"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDDmaxDB</span><span class="p">,</span><span class="n">envTitle</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">MaxDryBulb</span><span class="p">)</span>
<a name="ln-7384"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDDrange</span><span class="p">,</span><span class="n">envTitle</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">DailyDBRange</span><span class="p">)</span>
<a name="ln-7385"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span> <span class="o">/=</span> <span class="n">DDHumIndType_RelHumSch</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7386"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDDhumid</span><span class="p">,</span><span class="n">envTitle</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndValue</span><span class="p">)</span>
<a name="ln-7387"></a>    <span class="k">ELSE</span>
<a name="ln-7388"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDDhumid</span><span class="p">,</span><span class="n">envTitle</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
<a name="ln-7389"></a>    <span class="n">ENDIF</span>
<a name="ln-7390"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDDhumTyp</span><span class="p">,</span><span class="n">envTitle</span><span class="p">,</span><span class="n">HumidityIndicatingType</span><span class="p">(</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">HumIndType</span><span class="p">))</span>
<a name="ln-7391"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDDwindSp</span><span class="p">,</span><span class="n">envTitle</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WindSpeed</span><span class="p">)</span>
<a name="ln-7392"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDDwindDr</span><span class="p">,</span><span class="n">envTitle</span><span class="p">,</span><span class="n">DesDayInput</span><span class="p">(</span><span class="n">EnvrnNum</span><span class="p">)%</span><span class="n">WindDir</span><span class="p">)</span>
<a name="ln-7393"></a>  <span class="k">End Do</span>
<a name="ln-7394"></a><span class="k">Return</span>
<a name="ln-7395"></a>
<a name="ln-7396"></a><span class="k">END SUBROUTINE </span><span class="n">GetDesignDayData</span>
<a name="ln-7397"></a>
<a name="ln-7398"></a>
<a name="ln-7399"></a><span class="k">SUBROUTINE </span><span class="n">GetLocationInfo</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-7400"></a>
<a name="ln-7401"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7402"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-7403"></a>          <span class="c">!       DATE WRITTEN   October 1997</span>
<a name="ln-7404"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-7405"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7406"></a>
<a name="ln-7407"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7408"></a>          <span class="c">! This subroutine gets the location info from the IDF file; latitude,</span>
<a name="ln-7409"></a>          <span class="c">!  longitude and time zone number.</span>
<a name="ln-7410"></a>
<a name="ln-7411"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7412"></a>          <span class="c">!</span>
<a name="ln-7413"></a>
<a name="ln-7414"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7415"></a>          <span class="c">! na</span>
<a name="ln-7416"></a>
<a name="ln-7417"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7418"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-7419"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-7420"></a>
<a name="ln-7421"></a> <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7422"></a>
<a name="ln-7423"></a>         <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7424"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-7425"></a>
<a name="ln-7426"></a>         <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7427"></a>         <span class="c">! na</span>
<a name="ln-7428"></a>
<a name="ln-7429"></a>         <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7430"></a>         <span class="c">! na</span>
<a name="ln-7431"></a>
<a name="ln-7432"></a>         <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7433"></a>         <span class="c">! na</span>
<a name="ln-7434"></a>
<a name="ln-7435"></a>         <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7436"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LocNumAlpha</span> <span class="c">! Number of alpha names being passed</span>
<a name="ln-7437"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LocNumProp</span>  <span class="c">! Number of properties being passed</span>
<a name="ln-7438"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>           <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-7439"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LocNames</span> <span class="c">! Temp Array to transfer location info</span>
<a name="ln-7440"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LocProps</span> <span class="c">!Temporary array to transfer location info</span>
<a name="ln-7441"></a>  <span class="kt">INTEGER </span><span class="n">NumLocations</span>
<a name="ln-7442"></a>
<a name="ln-7443"></a>         <span class="c">! FLOW:</span>
<a name="ln-7444"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:Location&#39;</span>
<a name="ln-7445"></a>  <span class="n">NumLocations</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7446"></a>
<a name="ln-7447"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumLocations</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7448"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-7449"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7450"></a>  <span class="n">ENDIF</span>
<a name="ln-7451"></a>
<a name="ln-7452"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumLocations</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7453"></a>      <span class="c">!Call Input Get routine to retrieve Location information</span>
<a name="ln-7454"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">LocNames</span><span class="p">,</span><span class="n">LocNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7455"></a>                       <span class="n">LocProps</span><span class="p">,</span><span class="n">LocNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-7456"></a>
<a name="ln-7457"></a>   <span class="c">!set latitude, longitude, and time zone number variables</span>
<a name="ln-7458"></a>   <span class="n">LocationTitle</span> <span class="o">=</span> <span class="n">LocNames</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7459"></a>   <span class="n">Latitude</span> <span class="o">=</span> <span class="n">LocProps</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7460"></a>   <span class="n">Longitude</span><span class="o">=</span> <span class="n">LocProps</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7461"></a>   <span class="n">TimeZoneNumber</span> <span class="o">=</span> <span class="n">LocProps</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-7462"></a>   <span class="n">Elevation</span><span class="o">=</span><span class="n">LocProps</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-7463"></a>   <span class="n">LocationGathered</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7464"></a>  <span class="n">ENDIF</span>
<a name="ln-7465"></a>
<a name="ln-7466"></a><span class="k">Return</span>
<a name="ln-7467"></a>
<a name="ln-7468"></a><span class="k">END SUBROUTINE </span><span class="n">GetLocationInfo</span>
<a name="ln-7469"></a>
<a name="ln-7470"></a><span class="k">SUBROUTINE </span><span class="n">GetWeatherProperties</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-7471"></a>
<a name="ln-7472"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7473"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7474"></a>          <span class="c">!       DATE WRITTEN   July 2009</span>
<a name="ln-7475"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7476"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7477"></a>
<a name="ln-7478"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7479"></a>          <span class="c">! Weather properties are an advanced concept for simulation.  Primarily, these properties are</span>
<a name="ln-7480"></a>          <span class="c">! used in the test suite runs that have specific requirements for certain properties (such as</span>
<a name="ln-7481"></a>          <span class="c">! sky temperature).</span>
<a name="ln-7482"></a>
<a name="ln-7483"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7484"></a>          <span class="c">! na</span>
<a name="ln-7485"></a>
<a name="ln-7486"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7487"></a>          <span class="c">! WeatherProperty:SkyTemperature,</span>
<a name="ln-7488"></a>          <span class="c">!        \memo This object is used to override internal sky temperature calculations.</span>
<a name="ln-7489"></a>          <span class="c">!   A1,  \field Name</span>
<a name="ln-7490"></a>          <span class="c">!        \reference DesignDays</span>
<a name="ln-7491"></a>          <span class="c">!        \note leave blank for RunPeriods (until we name them)</span>
<a name="ln-7492"></a>          <span class="c">!        \note This field references the applicable design day or runperiod(s) if left blank.</span>
<a name="ln-7493"></a>          <span class="c">!   A2,  \field Calculation Type</span>
<a name="ln-7494"></a>          <span class="c">!        \type choice</span>
<a name="ln-7495"></a>          <span class="c">!        \key ScheduleValue</span>
<a name="ln-7496"></a>          <span class="c">!        \key DifferenceScheduleDryBulbValue</span>
<a name="ln-7497"></a>          <span class="c">!        \key DifferenceScheduleDewPointValue</span>
<a name="ln-7498"></a>          <span class="c">!        \key AlgorithmA</span>
<a name="ln-7499"></a>          <span class="c">!   A3;  \field Schedule Name</span>
<a name="ln-7500"></a>          <span class="c">!        \type object-list</span>
<a name="ln-7501"></a>          <span class="c">!        \object-list DayScheduleNames</span>
<a name="ln-7502"></a>          <span class="c">!        \object-list ScheduleNames</span>
<a name="ln-7503"></a>
<a name="ln-7504"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7505"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-7506"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span><span class="p">,</span><span class="n">GetDayScheduleIndex</span>
<a name="ln-7507"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-7508"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindNumberInList</span>
<a name="ln-7509"></a>
<a name="ln-7510"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7511"></a>
<a name="ln-7512"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7513"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-7514"></a>
<a name="ln-7515"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7516"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetWeatherProperties:&#39;</span>
<a name="ln-7517"></a>
<a name="ln-7518"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7519"></a>          <span class="c">! na</span>
<a name="ln-7520"></a>
<a name="ln-7521"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7522"></a>          <span class="c">! na</span>
<a name="ln-7523"></a>
<a name="ln-7524"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7525"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Item</span>
<a name="ln-7526"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOSTAT</span>
<a name="ln-7527"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlpha</span>
<a name="ln-7528"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumerics</span>
<a name="ln-7529"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOk</span>
<a name="ln-7530"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-7531"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>
<a name="ln-7532"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">envFound</span>
<a name="ln-7533"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Count</span>
<a name="ln-7534"></a><span class="nb">  </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">schPtr</span>
<a name="ln-7535"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">MultipleEnvironments</span>
<a name="ln-7536"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span> <span class="kd">::</span> <span class="n">units</span>
<a name="ln-7537"></a>
<a name="ln-7538"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;WeatherProperty:SkyTemperature&#39;</span>
<a name="ln-7539"></a>  <span class="n">NumWPSkyTemperatures</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7540"></a>
<a name="ln-7541"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">NumWPSkyTemperatures</span><span class="p">))</span>  <span class="c">! by default, not used.</span>
<a name="ln-7542"></a>
<a name="ln-7543"></a>  <span class="k">DO </span><span class="n">Item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumWPSkyTemperatures</span>
<a name="ln-7544"></a>    <span class="n">MultipleEnvironments</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7545"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumerics</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7546"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7547"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-7548"></a>
<a name="ln-7549"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-7550"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-7551"></a>        <span class="n">Found</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7552"></a>        <span class="k">DO </span><span class="nb">Count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfEnvrn</span>
<a name="ln-7553"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">/=</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7554"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7555"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7556"></a>               <span class="s1">&#39;&quot;, indicated Environment Name already assigned.&#39;</span><span class="p">)</span>
<a name="ln-7557"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7558"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Environment=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7559"></a>                  <span class="s1">&#39;&quot;, already using &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7560"></a>                  <span class="nb">trim</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7561"></a>            <span class="k">ELSE</span>
<a name="ln-7562"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Runperiod Environment, already using &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7563"></a>                  <span class="nb">trim</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7564"></a>            <span class="n">ENDIF</span>
<a name="ln-7565"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7566"></a>          <span class="k">ELSE</span>
<a name="ln-7567"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="o">=</span><span class="n">Item</span>
<a name="ln-7568"></a>            <span class="n">Found</span><span class="o">=</span><span class="nb">Count</span>
<a name="ln-7569"></a><span class="nb">          </span><span class="n">ENDIF</span>
<a name="ln-7570"></a>        <span class="n">ENDDO</span>
<a name="ln-7571"></a>        <span class="n">MultipleEnvironments</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7572"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7573"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetWeatherProperties: WeatherProperty:SkyTemperature=blank, no run periods found.&#39;</span><span class="p">)</span>
<a name="ln-7574"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...SkyTemperature will not be applied.&#39;</span><span class="p">)</span>
<a name="ln-7575"></a>          <span class="k">CYCLE</span>
<a name="ln-7576"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-7577"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span> <span class="c">! really a name</span>
<a name="ln-7578"></a>        <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Environment</span><span class="p">%</span><span class="n">Title</span><span class="p">,</span><span class="n">NumOfEnvrn</span><span class="p">)</span>
<a name="ln-7579"></a>        <span class="n">envFound</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-7580"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7581"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7582"></a>             <span class="s1">&#39;&quot;, invalid Environment Name referenced.&#39;</span><span class="p">)</span>
<a name="ln-7583"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...remainder of object not processed.&#39;</span><span class="p">)</span>
<a name="ln-7584"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7585"></a>          <span class="k">CYCLE</span>
<a name="ln-7586"></a><span class="k">        ELSE</span>
<a name="ln-7587"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">WP_Type1</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7588"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7589"></a>               <span class="s1">&#39;&quot;, indicated Environment Name already assigned.&#39;</span><span class="p">)</span>
<a name="ln-7590"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Environment=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7591"></a>                <span class="s1">&#39;&quot;, already using &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7592"></a>                <span class="nb">trim</span><span class="p">(</span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7593"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7594"></a>          <span class="k">ELSE</span>
<a name="ln-7595"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">WP_Type1</span><span class="o">=</span><span class="n">Item</span>
<a name="ln-7596"></a>          <span class="n">ENDIF</span>
<a name="ln-7597"></a>        <span class="n">ENDIF</span>
<a name="ln-7598"></a>    <span class="k">END SELECT</span>
<a name="ln-7599"></a>
<a name="ln-7600"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7601"></a><span class="k">      </span><span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7602"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7603"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WPSkyTemperature</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">Item</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-7604"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7605"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7606"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-7607"></a>      <span class="n">ENDIF</span>
<a name="ln-7608"></a>      <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>            <span class="c">! Name</span>
<a name="ln-7609"></a>    <span class="k">ELSE</span>
<a name="ln-7610"></a><span class="k">      </span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39;All RunPeriods&#39;</span>
<a name="ln-7611"></a>    <span class="n">ENDIF</span>
<a name="ln-7612"></a>    <span class="c">! Validate Calculation Type.</span>
<a name="ln-7613"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;ScheduleValue&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7614"></a><span class="k">      </span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">CalculationType</span><span class="o">=</span><span class="n">WP_ScheduleValue</span>
<a name="ln-7615"></a>      <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">IsSchedule</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7616"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span>
<a name="ln-7617"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;DifferenceScheduleDryBulbValue&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7618"></a><span class="k">      </span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">CalculationType</span><span class="o">=</span><span class="n">WP_DryBulbDelta</span>
<a name="ln-7619"></a>      <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">IsSchedule</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7620"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[deltaC]&#39;</span>
<a name="ln-7621"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;DifferenceScheduleDewPointValue&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7622"></a><span class="k">      </span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">CalculationType</span><span class="o">=</span><span class="n">WP_DewPointDelta</span>
<a name="ln-7623"></a>      <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">IsSchedule</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7624"></a>      <span class="n">units</span><span class="o">=</span><span class="s1">&#39;[deltaC]&#39;</span>
<a name="ln-7625"></a>    <span class="k">ELSE</span>
<a name="ln-7626"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7627"></a>        <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-7628"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered value=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, should be one of: &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7629"></a>        <span class="s1">&#39;ScheduleValue, DifferenceScheduleDryBulbValue, DifferenceScheduleDewPointValue.&#39;</span><span class="p">)</span>
<a name="ln-7630"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7631"></a>    <span class="n">ENDIF</span>
<a name="ln-7632"></a>
<a name="ln-7633"></a>    <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-7634"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-7635"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">==</span> <span class="n">ksRunPeriodDesign</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7636"></a><span class="k">      </span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-7637"></a>      <span class="c">! See if it&#39;s a schedule.</span>
<a name="ln-7638"></a>      <span class="n">Found</span><span class="o">=</span><span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7639"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7640"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7641"></a>          <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-7642"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Entered name=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7643"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Should be a full year schedule (&quot;Schedule:Year&quot;, &quot;Schedule:Compact&quot;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7644"></a>           <span class="s1">&#39; &quot;Schedule:File&quot;, or &quot;Schedule:Constant&quot; objects.&#39;</span><span class="p">)</span>
<a name="ln-7645"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7646"></a>      <span class="k">ELSE</span>
<a name="ln-7647"></a><span class="k">        </span><span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">IsSchedule</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7648"></a>        <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-7649"></a>      <span class="n">ENDIF</span>
<a name="ln-7650"></a>    <span class="k">ELSE</span>      <span class="c">! See if it&#39;s a valid schedule.</span>
<a name="ln-7651"></a>      <span class="n">Found</span><span class="o">=</span><span class="n">GetDayScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7652"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7653"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7654"></a>          <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-7655"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Entered name=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-7656"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Should be a single day schedule (&quot;Schedule:Day:Hourly&quot;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7657"></a>           <span class="s1">&#39; &quot;Schedule:Day:Interval&quot;, or &quot;Schedule:Day:List&quot; objects.&#39;</span><span class="p">)</span>
<a name="ln-7658"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7659"></a>      <span class="k">ELSE</span>
<a name="ln-7660"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">envFound</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7661"></a><span class="k">          </span><span class="n">schPtr</span><span class="o">=</span><span class="n">FindNumberInList</span><span class="p">(</span><span class="n">Found</span><span class="p">,</span><span class="n">SPSiteScheduleNamePtr</span><span class="p">,</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span>
<a name="ln-7662"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">schPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7663"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7664"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-7665"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7666"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Sky Temperature Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7667"></a>                 <span class="n">SPSiteSkyTemperatureScheduleValue</span><span class="p">(</span><span class="n">envFound</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7668"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">schPtr</span><span class="p">)</span><span class="o">/=</span> <span class="n">units</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7669"></a><span class="k">            </span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">=</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7670"></a>            <span class="n">SPSiteScheduleNamePtr</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-7671"></a>            <span class="n">SPSiteScheduleUnits</span><span class="p">(</span><span class="n">NumSPSiteScheduleNamePtrs</span><span class="p">)</span><span class="o">=</span><span class="n">units</span>
<a name="ln-7672"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Sizing Period Site Sky Temperature Schedule Value &#39;</span><span class="o">//</span><span class="n">units</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7673"></a>                 <span class="n">SPSiteSkyTemperatureScheduleValue</span><span class="p">(</span><span class="n">envFound</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7674"></a>          <span class="n">ENDIF</span>
<a name="ln-7675"></a>          <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">IsSchedule</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7676"></a>          <span class="n">WPSkyTemperature</span><span class="p">(</span><span class="n">Item</span><span class="p">)%</span><span class="n">SchedulePtr</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-7677"></a>        <span class="n">ENDIF</span>
<a name="ln-7678"></a>      <span class="n">ENDIF</span>
<a name="ln-7679"></a>    <span class="n">ENDIF</span>
<a name="ln-7680"></a>  <span class="n">ENDDO</span>
<a name="ln-7681"></a>
<a name="ln-7682"></a>  <span class="k">RETURN</span>
<a name="ln-7683"></a>
<a name="ln-7684"></a><span class="k">END SUBROUTINE </span><span class="n">GetWeatherProperties</span>
<a name="ln-7685"></a>
<a name="ln-7686"></a><span class="k">SUBROUTINE </span><span class="n">GetGroundTemps</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-7687"></a>
<a name="ln-7688"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7689"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-7690"></a>          <span class="c">!       DATE WRITTEN   October 1997</span>
<a name="ln-7691"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7692"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7693"></a>
<a name="ln-7694"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7695"></a>          <span class="c">! This file reads the Ground Temps from the input file and puts them</span>
<a name="ln-7696"></a>          <span class="c">!  in a new variable.</span>
<a name="ln-7697"></a>
<a name="ln-7698"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7699"></a>          <span class="c">! na</span>
<a name="ln-7700"></a>
<a name="ln-7701"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7702"></a>          <span class="c">! na</span>
<a name="ln-7703"></a>
<a name="ln-7704"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7705"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-7706"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-7707"></a>
<a name="ln-7708"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7709"></a>
<a name="ln-7710"></a>         <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7711"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-7712"></a>
<a name="ln-7713"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7714"></a>          <span class="c">! na</span>
<a name="ln-7715"></a>
<a name="ln-7716"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7717"></a>          <span class="c">! na</span>
<a name="ln-7718"></a>
<a name="ln-7719"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7720"></a>          <span class="c">! na</span>
<a name="ln-7721"></a>
<a name="ln-7722"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7723"></a>
<a name="ln-7724"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GndNumAlpha</span> <span class="c">! Number of construction alpha names being passed</span>
<a name="ln-7725"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GndNumProp</span>  <span class="c">! dummy variable for properties being passed</span>
<a name="ln-7726"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>      <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-7727"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">I</span>           <span class="c">! Loop counter variable</span>
<a name="ln-7728"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GndAlphas</span> <span class="c">! Construction Alpha names defined</span>
<a name="ln-7729"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GndProps</span> <span class="c">!Temporary array to transfer ground temperatures</span>
<a name="ln-7730"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">GenErrorMessage</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7731"></a>
<a name="ln-7732"></a>     <span class="c">! FLOW:</span>
<a name="ln-7733"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:GroundTemperature:BuildingSurface&#39;</span>
<a name="ln-7734"></a>  <span class="n">I</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7735"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7736"></a>     <span class="c">!Get the object names for each construction from the input processor</span>
<a name="ln-7737"></a>     <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GndAlphas</span><span class="p">,</span><span class="n">GndNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7738"></a>                      <span class="n">GndProps</span><span class="p">,</span><span class="n">GndNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-7739"></a>
<a name="ln-7740"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GndNumProp</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7741"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Less than 12 values entered.&#39;</span><span class="p">)</span>
<a name="ln-7742"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7743"></a>    <span class="n">ENDIF</span>
<a name="ln-7744"></a>
<a name="ln-7745"></a>    <span class="c">!Assign the ground temps to the variable</span>
<a name="ln-7746"></a>    <span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-7747"></a>      <span class="n">GroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GndProps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-7748"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="mf">5.d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="mf">5.d0</span><span class="p">)</span> <span class="n">GenErrorMessage</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7749"></a>    <span class="k">End Do</span>
<a name="ln-7750"></a>
<a name="ln-7751"></a><span class="k">    </span><span class="n">GroundTempObjInput</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7752"></a>
<a name="ln-7753"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7754"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-7755"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7756"></a>  <span class="k">ELSE</span>
<a name="ln-7757"></a><span class="k">    </span><span class="n">GroundTemps</span><span class="o">=</span><span class="mi">1</span><span class="mf">8.d0</span>
<a name="ln-7758"></a>  <span class="n">ENDIF</span>
<a name="ln-7759"></a>
<a name="ln-7760"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GenErrorMessage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7761"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Some values fall outside the range of 15-25C.&#39;</span><span class="p">)</span>
<a name="ln-7762"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;These values may be inappropriate.  Please consult the Input Output Reference for more details.&#39;</span><span class="p">)</span>
<a name="ln-7763"></a>  <span class="n">ENDIF</span>
<a name="ln-7764"></a>
<a name="ln-7765"></a>  <span class="c">! Write Final Ground Temp Information to the initialization output file</span>
<a name="ln-7766"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundTemperature:BuildingSurface&gt;, Months From Jan to Dec {C}&#39;</span>
<a name="ln-7767"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="s1">&#39;Site:GroundTemperature:BuildingSurface&#39;</span><span class="p">,(</span><span class="n">GroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7768"></a>  <span class="mi">720</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">12</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="n">F6</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-7769"></a>
<a name="ln-7770"></a>
<a name="ln-7771"></a>  <span class="c">!Added for ground temperatures for F and C factor defined surfaces</span>
<a name="ln-7772"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:GroundTemperature:FCfactorMethod&#39;</span>
<a name="ln-7773"></a>  <span class="n">I</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7774"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7775"></a><span class="k">     CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GndAlphas</span><span class="p">,</span><span class="n">GndNumAlpha</span><span class="p">,</span><span class="n">GndProps</span><span class="p">,</span><span class="n">GndNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-7776"></a>
<a name="ln-7777"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GndNumProp</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7778"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Less than 12 values entered.&#39;</span><span class="p">)</span>
<a name="ln-7779"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7780"></a>    <span class="n">ENDIF</span>
<a name="ln-7781"></a>
<a name="ln-7782"></a>    <span class="n">FCGroundTemps</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7783"></a>    <span class="c">! overwrite values read from weather file for the 0.5m set ground temperatures</span>
<a name="ln-7784"></a>    <span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-7785"></a>      <span class="n">GroundTempsFC</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GndProps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-7786"></a>    <span class="k">End Do</span>
<a name="ln-7787"></a>
<a name="ln-7788"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7789"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-7790"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7791"></a>
<a name="ln-7792"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">wthFCGroundTemps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7793"></a><span class="k">    </span><span class="n">FCGroundTemps</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7794"></a>  <span class="n">ENDIF</span>
<a name="ln-7795"></a>
<a name="ln-7796"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FCGroundTemps</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Write Ground Temp Information to the initialization output file</span>
<a name="ln-7797"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundTemperature:FCfactorMethod&gt;, Months From Jan to Dec {C}&#39;</span>
<a name="ln-7798"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="s1">&#39;Site:GroundTemperature:FCfactorMethod&#39;</span><span class="p">,(</span><span class="n">GroundTempsFC</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7799"></a>  <span class="n">ENDIF</span>
<a name="ln-7800"></a>
<a name="ln-7801"></a>
<a name="ln-7802"></a>  <span class="n">PubGroundTempSurfFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7803"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:GroundTemperature:Shallow&#39;</span>
<a name="ln-7804"></a>  <span class="n">I</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7805"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7806"></a>     <span class="c">!Get the object names for each construction from the input processor</span>
<a name="ln-7807"></a>     <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GndAlphas</span><span class="p">,</span><span class="n">GndNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7808"></a>                      <span class="n">GndProps</span><span class="p">,</span><span class="n">GndNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-7809"></a>
<a name="ln-7810"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GndNumProp</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7811"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Less than 12 values entered.&#39;</span><span class="p">)</span>
<a name="ln-7812"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7813"></a>    <span class="n">ENDIF</span>
<a name="ln-7814"></a>
<a name="ln-7815"></a>    <span class="c">!Assign the ground temps to the variable</span>
<a name="ln-7816"></a>    <span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-7817"></a>      <span class="n">SurfaceGroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GndProps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-7818"></a>    <span class="k">End Do</span>
<a name="ln-7819"></a>
<a name="ln-7820"></a><span class="k">    </span><span class="n">GroundTemp_SurfaceObjInput</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7821"></a>
<a name="ln-7822"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7823"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-7824"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7825"></a>  <span class="k">ELSE</span>
<a name="ln-7826"></a><span class="k">    </span><span class="n">SurfaceGroundTemps</span><span class="o">=</span><span class="mi">1</span><span class="mf">3.d0</span>
<a name="ln-7827"></a>  <span class="n">ENDIF</span>
<a name="ln-7828"></a>
<a name="ln-7829"></a>  <span class="c">! Write Final Ground Temp Information to the initialization output file</span>
<a name="ln-7830"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundTemperature:Shallow&gt;, Months From Jan to Dec {C}&#39;</span>
<a name="ln-7831"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="s1">&#39;Site:GroundTemperature:Shallow&#39;</span><span class="p">,(</span><span class="n">SurfaceGroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7832"></a>
<a name="ln-7833"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:GroundTemperature:Deep&#39;</span>
<a name="ln-7834"></a>  <span class="n">I</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7835"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7836"></a>     <span class="c">!Get the object names for each construction from the input processor</span>
<a name="ln-7837"></a>     <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GndAlphas</span><span class="p">,</span><span class="n">GndNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7838"></a>                      <span class="n">GndProps</span><span class="p">,</span><span class="n">GndNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-7839"></a>
<a name="ln-7840"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GndNumProp</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7841"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Less than 12 values entered.&#39;</span><span class="p">)</span>
<a name="ln-7842"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7843"></a>    <span class="n">ENDIF</span>
<a name="ln-7844"></a>
<a name="ln-7845"></a>    <span class="c">!Assign the ground temps to the variable</span>
<a name="ln-7846"></a>    <span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-7847"></a>      <span class="n">DeepGroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">GndProps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-7848"></a>    <span class="k">End Do</span>
<a name="ln-7849"></a>
<a name="ln-7850"></a><span class="k">    </span><span class="n">GroundTemp_DeepObjInput</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7851"></a>
<a name="ln-7852"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7853"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-7854"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7855"></a>  <span class="k">ELSE</span>
<a name="ln-7856"></a><span class="k">    </span><span class="n">DeepGroundTemps</span><span class="o">=</span><span class="mi">1</span><span class="mf">6.d0</span>
<a name="ln-7857"></a>  <span class="n">ENDIF</span>
<a name="ln-7858"></a>
<a name="ln-7859"></a>  <span class="c">! Write Final Ground Temp Information to the initialization output file</span>
<a name="ln-7860"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundTemperature:Deep&gt;, Months From Jan to Dec {C}&#39;</span>
<a name="ln-7861"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="s1">&#39;Site:GroundTemperature:Deep&#39;</span><span class="p">,(</span><span class="n">DeepGroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7862"></a>
<a name="ln-7863"></a>  <span class="c">!Assigning the ground temperature array to a public array for use in other subroutines</span>
<a name="ln-7864"></a>  <span class="c">!Main use is for PlantPipeHeatTransfer, where the buried pipe model needs to average</span>
<a name="ln-7865"></a>  <span class="c">! a full year&#39;s worth of data at the beginning of the simulation</span>
<a name="ln-7866"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">GroundTemp_SurfaceObjInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7867"></a><span class="k">    </span><span class="n">PubGroundTempSurfFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7868"></a>    <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span>
<a name="ln-7869"></a>      <span class="n">PubGroundTempSurface</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceGroundTemps</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-7870"></a>    <span class="k">END DO</span>
<a name="ln-7871"></a><span class="k">  END IF</span>
<a name="ln-7872"></a>
<a name="ln-7873"></a><span class="k">  RETURN</span>
<a name="ln-7874"></a>
<a name="ln-7875"></a><span class="k">END SUBROUTINE </span><span class="n">GetGroundTemps</span>
<a name="ln-7876"></a>
<a name="ln-7877"></a><span class="k">SUBROUTINE </span><span class="n">GetGroundReflectances</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-7878"></a>
<a name="ln-7879"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7880"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7881"></a>          <span class="c">!       DATE WRITTEN   March 2002</span>
<a name="ln-7882"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7883"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7884"></a>
<a name="ln-7885"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7886"></a>          <span class="c">! This file reads the Ground Reflectances from the input file (optional) and</span>
<a name="ln-7887"></a>          <span class="c">! places them in the monthly array.</span>
<a name="ln-7888"></a>
<a name="ln-7889"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7890"></a>          <span class="c">! na</span>
<a name="ln-7891"></a>
<a name="ln-7892"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7893"></a>          <span class="c">! na</span>
<a name="ln-7894"></a>
<a name="ln-7895"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7896"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-7897"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-7898"></a>
<a name="ln-7899"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7900"></a>
<a name="ln-7901"></a>         <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7902"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-7903"></a>
<a name="ln-7904"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7905"></a>          <span class="c">! na</span>
<a name="ln-7906"></a>
<a name="ln-7907"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7908"></a>          <span class="c">! na</span>
<a name="ln-7909"></a>
<a name="ln-7910"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7911"></a>          <span class="c">! na</span>
<a name="ln-7912"></a>
<a name="ln-7913"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7914"></a>
<a name="ln-7915"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GndNumAlpha</span> <span class="c">! Number of construction alpha names being passed</span>
<a name="ln-7916"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GndNumProp</span>  <span class="c">! dummy variable for properties being passed</span>
<a name="ln-7917"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>      <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-7918"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">I</span>           <span class="c">! Loop counter variable</span>
<a name="ln-7919"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GndAlphas</span> <span class="c">! Construction Alpha names defined</span>
<a name="ln-7920"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GndProps</span>                          <span class="c">!Temporary array to transfer ground reflectances</span>
<a name="ln-7921"></a>
<a name="ln-7922"></a>     <span class="c">! FLOW:</span>
<a name="ln-7923"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:GroundReflectance&#39;</span>
<a name="ln-7924"></a>  <span class="n">I</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-7925"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7926"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">GndProps</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-7927"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GndAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-7928"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7929"></a>       <span class="c">!Get the object names for each construction from the input processor</span>
<a name="ln-7930"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GndAlphas</span><span class="p">,</span><span class="n">GndNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7931"></a>                        <span class="n">GndProps</span><span class="p">,</span><span class="n">GndNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-7932"></a>
<a name="ln-7933"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GndNumProp</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7934"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Less than 12 values entered.&#39;</span><span class="p">)</span>
<a name="ln-7935"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7936"></a>      <span class="n">ENDIF</span>
<a name="ln-7937"></a>
<a name="ln-7938"></a>      <span class="c">!Assign the ground reflectances to the variable</span>
<a name="ln-7939"></a>      <span class="n">GroundReflectances</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="n">GndProps</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7940"></a>
<a name="ln-7941"></a>    <span class="k">ELSE</span>
<a name="ln-7942"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-7943"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7944"></a>    <span class="n">ENDIF</span>
<a name="ln-7945"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GndProps</span><span class="p">)</span>
<a name="ln-7946"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GndAlphas</span><span class="p">)</span>
<a name="ln-7947"></a>  <span class="n">ENDIF</span>
<a name="ln-7948"></a>
<a name="ln-7949"></a>  <span class="c">! Write Final Ground Reflectance Information to the initialization output file</span>
<a name="ln-7950"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundReflectance&gt;, Months From Jan to Dec {dimensionless}&#39;</span>
<a name="ln-7951"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="p">(</span><span class="n">GroundReflectances</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-7952"></a>  <span class="mi">720</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39; Site:GroundReflectance&#39;</span><span class="p">,</span><span class="mi">12</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="n">F5</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-7953"></a>
<a name="ln-7954"></a>  <span class="k">RETURN</span>
<a name="ln-7955"></a>
<a name="ln-7956"></a><span class="k">END SUBROUTINE </span><span class="n">GetGroundReflectances</span>
<a name="ln-7957"></a>
<a name="ln-7958"></a><span class="k">SUBROUTINE </span><span class="n">GetSnowGroundRefModifiers</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-7959"></a>
<a name="ln-7960"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7961"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7962"></a>          <span class="c">!       DATE WRITTEN   March 2002</span>
<a name="ln-7963"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7964"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7965"></a>
<a name="ln-7966"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7967"></a>          <span class="c">! This file reads the Snow Ground Reflectance Modifiers from the input file (optional) and</span>
<a name="ln-7968"></a>          <span class="c">! places them in the variables.</span>
<a name="ln-7969"></a>
<a name="ln-7970"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7971"></a>          <span class="c">! na</span>
<a name="ln-7972"></a>
<a name="ln-7973"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7974"></a>          <span class="c">! na</span>
<a name="ln-7975"></a>
<a name="ln-7976"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7977"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-7978"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-7979"></a>
<a name="ln-7980"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7981"></a>
<a name="ln-7982"></a>         <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7983"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-7984"></a>
<a name="ln-7985"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7986"></a>          <span class="c">! na</span>
<a name="ln-7987"></a>
<a name="ln-7988"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7989"></a>          <span class="c">! na</span>
<a name="ln-7990"></a>
<a name="ln-7991"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7992"></a>          <span class="c">! na</span>
<a name="ln-7993"></a>
<a name="ln-7994"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7995"></a>
<a name="ln-7996"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GndNumAlpha</span> <span class="c">! Number of construction alpha names being passed</span>
<a name="ln-7997"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GndNumProp</span>  <span class="c">! dummy variable for properties being passed</span>
<a name="ln-7998"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>      <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-7999"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">I</span>           <span class="c">! Loop counter variable</span>
<a name="ln-8000"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GndAlphas</span> <span class="c">! Construction Alpha names defined</span>
<a name="ln-8001"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GndProps</span>                          <span class="c">!Temporary array to transfer ground reflectances</span>
<a name="ln-8002"></a>
<a name="ln-8003"></a>     <span class="c">! FLOW:</span>
<a name="ln-8004"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:GroundReflectance:SnowModifier&#39;</span>
<a name="ln-8005"></a>  <span class="n">I</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8006"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8007"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">GndProps</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8008"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GndAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8009"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8010"></a>       <span class="c">!Get the object names for each construction from the input processor</span>
<a name="ln-8011"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">GndAlphas</span><span class="p">,</span><span class="n">GndNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8012"></a>                        <span class="n">GndProps</span><span class="p">,</span><span class="n">GndNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-8013"></a>
<a name="ln-8014"></a>      <span class="c">!Assign the ground reflectances to the variable</span>
<a name="ln-8015"></a>      <span class="n">SnowGndRefModifier</span><span class="o">=</span><span class="n">GndProps</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8016"></a>      <span class="n">SnowGndRefModifierForDayltg</span><span class="o">=</span><span class="n">GndProps</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8017"></a>
<a name="ln-8018"></a>    <span class="k">ELSE</span>
<a name="ln-8019"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-8020"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8021"></a>    <span class="n">ENDIF</span>
<a name="ln-8022"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GndProps</span><span class="p">)</span>
<a name="ln-8023"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GndAlphas</span><span class="p">)</span>
<a name="ln-8024"></a>  <span class="n">ENDIF</span>
<a name="ln-8025"></a>
<a name="ln-8026"></a>  <span class="c">! Write Final Ground Reflectance Modifier Information to the initialization output file</span>
<a name="ln-8027"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundReflectance:SnowModifier&gt;, Normal, Daylighting {dimensionless}&#39;</span>
<a name="ln-8028"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="n">SnowGndRefModifier</span><span class="p">,</span><span class="n">SnowGndRefModifierForDayltg</span>
<a name="ln-8029"></a>  <span class="mi">720</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39; Site:GroundReflectance:SnowModifier&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="n">F7</span><span class="p">.</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8030"></a>
<a name="ln-8031"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundReflectance:Snow&gt;, Months From Jan to Dec {dimensionless}&#39;</span>
<a name="ln-8032"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">721</span><span class="p">)</span> <span class="s1">&#39; Site:GroundReflectance:Snow&#39;</span><span class="p">,(</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="n">GroundReflectances</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">SnowGndRefModifier</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-8033"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Site:GroundReflectance:Snow:Daylighting&gt;, Months From Jan to Dec {dimensionless}&#39;</span>
<a name="ln-8034"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">721</span><span class="p">)</span> <span class="s1">&#39; Site:GroundReflectance:Snow:Daylighting&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8035"></a>                              <span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="n">GroundReflectances</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">SnowGndRefModifierForDayltg</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-8036"></a>  <span class="mi">721</span> <span class="k">Format</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">12</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="n">F5</span><span class="p">.</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8037"></a>  <span class="k">RETURN</span>
<a name="ln-8038"></a>
<a name="ln-8039"></a><span class="k">END SUBROUTINE </span><span class="n">GetSnowGroundRefModifiers</span>
<a name="ln-8040"></a>
<a name="ln-8041"></a>
<a name="ln-8042"></a><span class="k">SUBROUTINE </span><span class="n">GetWaterMainsTemperatures</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8043"></a>
<a name="ln-8044"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8045"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-8046"></a>          <span class="c">!       DATE WRITTEN   January 2005</span>
<a name="ln-8047"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8048"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8049"></a>
<a name="ln-8050"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8051"></a>          <span class="c">! Reads the input data for the WATER MAINS TEMPERATURES object.</span>
<a name="ln-8052"></a>
<a name="ln-8053"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8054"></a>          <span class="c">! na</span>
<a name="ln-8055"></a>
<a name="ln-8056"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8057"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-8058"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-8059"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-8060"></a>
<a name="ln-8061"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8062"></a>
<a name="ln-8063"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8064"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-8065"></a>
<a name="ln-8066"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8067"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">NumObjects</span>
<a name="ln-8068"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">NumAlphas</span> <span class="c">! Number of elements in the alpha array</span>
<a name="ln-8069"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">NumNums</span>   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-8070"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">IOStat</span>    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-8071"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">! Character string data</span>
<a name="ln-8072"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">! Numeric data</span>
<a name="ln-8073"></a>
<a name="ln-8074"></a>     <span class="c">! FLOW:</span>
<a name="ln-8075"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:WaterMainsTemperature&#39;</span>
<a name="ln-8076"></a>  <span class="n">NumObjects</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8077"></a>
<a name="ln-8078"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumObjects</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8079"></a><span class="k">    CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOStat</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8080"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8081"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-8082"></a>
<a name="ln-8083"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Schedule&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8084"></a><span class="k">      </span><span class="n">WaterMainsTempsMethod</span> <span class="o">=</span> <span class="n">ScheduleMethod</span>
<a name="ln-8085"></a>
<a name="ln-8086"></a>      <span class="n">WaterMainsTempsSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8087"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterMainsTempsSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8088"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8089"></a>           <span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-8090"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8091"></a>      <span class="k">END IF</span>
<a name="ln-8092"></a>
<a name="ln-8093"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Correlation&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8094"></a><span class="k">      </span><span class="n">WaterMainsTempsMethod</span> <span class="o">=</span> <span class="n">CorrelationMethod</span>
<a name="ln-8095"></a>
<a name="ln-8096"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8097"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Missing Annual Average and Maximum Difference fields.&#39;</span><span class="p">)</span>
<a name="ln-8098"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8099"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8100"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Missing Maximum Difference field.&#39;</span><span class="p">)</span>
<a name="ln-8101"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8102"></a>      <span class="k">ELSE</span>
<a name="ln-8103"></a><span class="k">        </span><span class="n">WaterMainsTempsAnnualAvgAirTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8104"></a>        <span class="n">WaterMainsTempsMaxDiffAirTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8105"></a>      <span class="k">END IF</span>
<a name="ln-8106"></a>
<a name="ln-8107"></a><span class="k">    ELSE</span>
<a name="ln-8108"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8109"></a>           <span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8110"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8111"></a>    <span class="k">END IF</span>
<a name="ln-8112"></a>
<a name="ln-8113"></a><span class="k">  ELSE IF</span> <span class="p">(</span><span class="n">NumObjects</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8114"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-8115"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8116"></a>  <span class="k">END IF</span>
<a name="ln-8117"></a>
<a name="ln-8118"></a><span class="k">  RETURN</span>
<a name="ln-8119"></a>
<a name="ln-8120"></a><span class="k">END SUBROUTINE </span><span class="n">GetWaterMainsTemperatures</span>
<a name="ln-8121"></a>
<a name="ln-8122"></a>
<a name="ln-8123"></a><span class="k">SUBROUTINE </span><span class="n">CalcWaterMainsTemp</span><span class="p">()</span>
<a name="ln-8124"></a>
<a name="ln-8125"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8126"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-8127"></a>          <span class="c">!       DATE WRITTEN   January 2005</span>
<a name="ln-8128"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8129"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8130"></a>
<a name="ln-8131"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8132"></a>          <span class="c">! Calculates the daily water mains temperature based on input data from the WATER MAINS TEMPERATURES object.</span>
<a name="ln-8133"></a>
<a name="ln-8134"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8135"></a>          <span class="c">! Water mains temperature is either taken from a schedule or calculated by a correlation.  The correlation</span>
<a name="ln-8136"></a>          <span class="c">! is fit to Fahrenheit units, so the air temperature values are first convert to F, then mains temperature</span>
<a name="ln-8137"></a>          <span class="c">! is calculated and converted back to C.</span>
<a name="ln-8138"></a>
<a name="ln-8139"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8140"></a>          <span class="c">! Correlation developed by Jay Burch and Craig Christensen at NREL, described in:</span>
<a name="ln-8141"></a>          <span class="c">! Hendron, R., Anderson, R., Christensen, C., Eastment, M., and Reeves, P.  2004.  &quot;Development of an Energy</span>
<a name="ln-8142"></a>          <span class="c">! Savings Benchmark for All Residential End-Uses&quot;, Proceedings of SimBuild 2004, IBPSA-USA National Conference,</span>
<a name="ln-8143"></a>          <span class="c">! Boulder, CO, August 4 - 6, 2004.</span>
<a name="ln-8144"></a>
<a name="ln-8145"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8146"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-8147"></a>
<a name="ln-8148"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8149"></a>
<a name="ln-8150"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tavg</span>    <span class="c">! Annual Average Outdoor Air Temperature (F)</span>
<a name="ln-8152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tdiff</span>   <span class="c">! Maximum difference in monthly average outdoor air temperatures (deltaF)</span>
<a name="ln-8153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ratio</span>   <span class="c">! Value used in correlation</span>
<a name="ln-8154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Lag</span>     <span class="c">! Value used in correlation</span>
<a name="ln-8155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Offset</span>  <span class="c">! Value used in correlation</span>
<a name="ln-8156"></a>
<a name="ln-8157"></a>     <span class="c">! FLOW:</span>
<a name="ln-8158"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">WaterMainsTempsMethod</span><span class="p">)</span>
<a name="ln-8159"></a>
<a name="ln-8160"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ScheduleMethod</span><span class="p">)</span>
<a name="ln-8161"></a>      <span class="n">WaterMainsTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterMainsTempsSchedule</span><span class="p">)</span>
<a name="ln-8162"></a>
<a name="ln-8163"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CorrelationMethod</span><span class="p">)</span>
<a name="ln-8164"></a>      <span class="c">! Convert C to F</span>
<a name="ln-8165"></a>      <span class="n">Tavg</span> <span class="o">=</span> <span class="n">WaterMainsTempsAnnualAvgAirTemp</span> <span class="o">*</span> <span class="p">(</span><span class="mf">9.0d0</span> <span class="o">/</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="mf">2.0d0</span>
<a name="ln-8166"></a>      <span class="n">Tdiff</span> <span class="o">=</span> <span class="n">WaterMainsTempsMaxDiffAirTemp</span> <span class="o">*</span> <span class="p">(</span><span class="mf">9.0d0</span> <span class="o">/</span> <span class="mf">5.0d0</span><span class="p">)</span>
<a name="ln-8167"></a>
<a name="ln-8168"></a>      <span class="n">Ratio</span> <span class="o">=</span> <span class="mf">0.4d0</span> <span class="o">+</span> <span class="mf">0.01d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tavg</span> <span class="o">-</span> <span class="mi">4</span><span class="mf">4.0d0</span><span class="p">)</span>
<a name="ln-8169"></a>      <span class="n">Lag</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.0d0</span> <span class="o">-</span> <span class="mf">1.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tavg</span> <span class="o">-</span> <span class="mi">4</span><span class="mf">4.0d0</span><span class="p">)</span>
<a name="ln-8170"></a>      <span class="n">Offset</span> <span class="o">=</span> <span class="mf">6.0d0</span>
<a name="ln-8171"></a>
<a name="ln-8172"></a>      <span class="n">WaterMainsTemp</span> <span class="o">=</span> <span class="n">Tavg</span> <span class="o">+</span> <span class="n">Offset</span> <span class="o">+</span> <span class="n">Ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tdiff</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-8173"></a>         <span class="nb">SIN</span><span class="p">((</span><span class="mf">0.986d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">DayOfYear</span> <span class="o">-</span> <span class="mi">1</span><span class="mf">5.0d0</span> <span class="o">-</span> <span class="n">Lag</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-8174"></a>
<a name="ln-8175"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterMainsTemp</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="n">WaterMainsTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">2.0d0</span>
<a name="ln-8176"></a>
<a name="ln-8177"></a>      <span class="c">! Convert F to C</span>
<a name="ln-8178"></a>      <span class="n">WaterMainsTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">WaterMainsTemp</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.0d0</span> <span class="o">/</span> <span class="mf">9.0d0</span><span class="p">)</span>
<a name="ln-8179"></a>
<a name="ln-8180"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-8181"></a>      <span class="n">WaterMainsTemp</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span>  <span class="c">! 50 F</span>
<a name="ln-8182"></a>
<a name="ln-8183"></a>  <span class="k">END SELECT</span>
<a name="ln-8184"></a>
<a name="ln-8185"></a><span class="k">  RETURN</span>
<a name="ln-8186"></a>
<a name="ln-8187"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWaterMainsTemp</span>
<a name="ln-8188"></a>
<a name="ln-8189"></a><span class="k">SUBROUTINE </span><span class="n">GetWeatherStation</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8190"></a>
<a name="ln-8191"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8192"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-8193"></a>          <span class="c">!       DATE WRITTEN   January 2006</span>
<a name="ln-8194"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8195"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8196"></a>
<a name="ln-8197"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8198"></a>          <span class="c">! Reads the input data for the WEATHER STATION object.</span>
<a name="ln-8199"></a>
<a name="ln-8200"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8201"></a>          <span class="c">! na</span>
<a name="ln-8202"></a>
<a name="ln-8203"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8204"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-8205"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-8206"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-8207"></a>
<a name="ln-8208"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8209"></a>
<a name="ln-8210"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8211"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-8212"></a>
<a name="ln-8213"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8214"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">NumObjects</span>
<a name="ln-8215"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">NumAlphas</span> <span class="c">! Number of elements in the alpha array</span>
<a name="ln-8216"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">NumNums</span>   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-8217"></a>  <span class="kt">INTEGER</span>                                   <span class="kd">::</span> <span class="n">IOStat</span>    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-8218"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">! Character string data</span>
<a name="ln-8219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">! Numeric data</span>
<a name="ln-8220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WeatherFileWindSensorHeight</span>  <span class="c">! Height of the wind sensor at the weather station, i.e., weather file</span>
<a name="ln-8221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WeatherFileWindExp</span>           <span class="c">! Exponent for the wind velocity profile at the weather station</span>
<a name="ln-8222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WeatherFileWindBLHeight</span>      <span class="c">! Boundary layer height for the wind velocity profile at the weather station (m)</span>
<a name="ln-8223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WeatherFileTempSensorHeight</span>  <span class="c">! Height of the air temperature sensor at the weather station (m)</span>
<a name="ln-8224"></a>
<a name="ln-8225"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8226"></a>          <span class="c">! na</span>
<a name="ln-8227"></a>
<a name="ln-8228"></a>     <span class="c">! FLOW:</span>
<a name="ln-8229"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Site:WeatherStation&#39;</span>
<a name="ln-8230"></a>  <span class="n">NumObjects</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8231"></a>
<a name="ln-8232"></a>  <span class="c">! Default conditions for a weather station in an open field at a height of 10 m. (These should match the IDD defaults.)</span>
<a name="ln-8233"></a>  <span class="n">WeatherFileWindSensorHeight</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-8234"></a>  <span class="n">WeatherFileWindExp</span> <span class="o">=</span> <span class="mf">0.14d0</span>
<a name="ln-8235"></a>  <span class="n">WeatherFileWindBLHeight</span> <span class="o">=</span> <span class="mi">27</span><span class="mf">0.0d0</span>
<a name="ln-8236"></a>  <span class="n">WeatherFileTempSensorHeight</span> <span class="o">=</span> <span class="mf">1.5d0</span>
<a name="ln-8237"></a>
<a name="ln-8238"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumObjects</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8239"></a><span class="k">    CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOStat</span><span class="p">)</span>
<a name="ln-8240"></a>
<a name="ln-8241"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">WeatherFileWindSensorHeight</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8242"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">WeatherFileWindExp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8243"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">WeatherFileWindBLHeight</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-8244"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="n">WeatherFileTempSensorHeight</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8245"></a>
<a name="ln-8246"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">NumObjects</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8247"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Too many objects entered. Only one allowed.&#39;</span><span class="p">)</span>
<a name="ln-8248"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8249"></a>  <span class="k">END IF</span>
<a name="ln-8250"></a>
<a name="ln-8251"></a><span class="k">  </span><span class="n">WeatherFileWindModCoeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">WeatherFileWindBLHeight</span> <span class="o">/</span> <span class="n">WeatherFileWindSensorHeight</span><span class="p">)</span> <span class="o">**</span> <span class="n">WeatherFileWindExp</span>
<a name="ln-8252"></a>  <span class="n">WeatherFileTempModCoeff</span> <span class="o">=</span> <span class="n">AtmosphericTempGradient</span> <span class="o">*</span> <span class="n">EarthRadius</span> <span class="o">*</span> <span class="n">WeatherFileTempSensorHeight</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-8253"></a>                                  <span class="p">(</span><span class="n">EarthRadius</span> <span class="o">+</span> <span class="n">WeatherFileTempSensorHeight</span><span class="p">)</span>
<a name="ln-8254"></a>
<a name="ln-8255"></a>  <span class="c">! Write to the initialization output file</span>
<a name="ln-8256"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Environment:Weather Station&gt;,Wind Sensor Height Above Ground {m},&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8257"></a>    <span class="s1">&#39;Wind Speed Profile Exponent {},Wind Speed Profile Boundary Layer Thickness {m},&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8258"></a>    <span class="s1">&#39;Air Temperature Sensor Height Above Ground {m},Wind Speed Modifier Coefficient [Internal],&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8259"></a>    <span class="s1">&#39;Temperature Modifier Coefficient [Internal]&#39;</span>
<a name="ln-8260"></a>
<a name="ln-8261"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WeatherFileWindSensorHeight</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WeatherFileWindExp</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a name="ln-8262"></a>     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WeatherFileWindBLHeight</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WeatherFileTempSensorHeight</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-8263"></a>     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WeatherFileWindModCoeff</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WeatherFileTempModCoeff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8264"></a>
<a name="ln-8265"></a><span class="mi">720</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;Environment:Weather Station&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-8266"></a>
<a name="ln-8267"></a>  <span class="k">RETURN</span>
<a name="ln-8268"></a>
<a name="ln-8269"></a><span class="k">END SUBROUTINE </span><span class="n">GetWeatherStation</span>
<a name="ln-8270"></a>
<a name="ln-8271"></a>
<a name="ln-8272"></a><span class="k">SUBROUTINE </span><span class="n">DayltgCurrentExtHorizIllum</span>
<a name="ln-8273"></a>
<a name="ln-8274"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8275"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8276"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-8277"></a>          <span class="c">!       MODIFIED       Nov98 (FW); Nov 2000 (FW)</span>
<a name="ln-8278"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8279"></a>
<a name="ln-8280"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8281"></a>          <span class="c">! CALCULATES EXTERIOR DAYLIGHT ILLUMINANCE AND LUMINOUS EFFICACY</span>
<a name="ln-8282"></a>
<a name="ln-8283"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8284"></a>          <span class="c">! CALLED by SetCurrentWeather.</span>
<a name="ln-8285"></a>          <span class="c">! CALCULATES THE CURRENT-TIME-STEP</span>
<a name="ln-8286"></a>          <span class="c">! ILLUMINANCE ON AN UNOBSTRUCTED HORIZONTAL SURFACE FROM THE</span>
<a name="ln-8287"></a>          <span class="c">! THE SKY AND FROM DIRECT SUN.</span>
<a name="ln-8288"></a>
<a name="ln-8289"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8290"></a>          <span class="c">! Based on DOE-2.1E subroutine DEXTIL.</span>
<a name="ln-8291"></a>
<a name="ln-8292"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8293"></a>          <span class="c">! na</span>
<a name="ln-8294"></a>
<a name="ln-8295"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8296"></a>
<a name="ln-8297"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8298"></a>          <span class="c">! na</span>
<a name="ln-8299"></a>
<a name="ln-8300"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8301"></a>          <span class="c">! na</span>
<a name="ln-8302"></a>
<a name="ln-8303"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8304"></a>          <span class="c">! na</span>
<a name="ln-8305"></a>
<a name="ln-8306"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8307"></a>          <span class="c">! na</span>
<a name="ln-8308"></a>
<a name="ln-8309"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8310"></a>
<a name="ln-8311"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SDIRH</span>                   <span class="c">! Exterior horizontal beam irradiance (W/m2)</span>
<a name="ln-8312"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SDIFH</span>                   <span class="c">! Exterior horizontal sky diffuse irradiance (W/m2)</span>
<a name="ln-8313"></a><span class="c">!REAL(r64)   :: PDIRLW                  ! Luminous efficacy (lum/W) of beam solar radiation</span>
<a name="ln-8314"></a><span class="c">!REAL(r64)   :: PDIFLW                  ! Luminous efficacy (lum/W) of sky diffuse solar radiation</span>
<a name="ln-8315"></a>
<a name="ln-8316"></a><span class="c">!              DIRECT AND DIFFUSE HORIZONTAL SOLAR IRRADIANCE (W/M2).</span>
<a name="ln-8317"></a><span class="c">!              SOLCOS(3), below, is the cosine of the solar zenith angle.</span>
<a name="ln-8318"></a><span class="c">!</span>
<a name="ln-8319"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8320"></a><span class="k">        </span><span class="n">SDIRH</span>  <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-8321"></a>        <span class="n">SDIFH</span>  <span class="o">=</span> <span class="n">DifSolarRad</span>
<a name="ln-8322"></a><span class="c">!              Fraction of sky covered by clouds</span>
<a name="ln-8323"></a>        <span class="n">CloudFraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">SDIFH</span><span class="o">/</span><span class="p">(</span><span class="n">SDIRH</span><span class="o">+</span><span class="n">SDIFH</span><span class="o">+</span><span class="mf">0.0001d0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-8324"></a><span class="c">!</span>
<a name="ln-8325"></a><span class="c">!              Luminous efficacy of sky diffuse solar and beam solar (lumens/W);</span>
<a name="ln-8326"></a><span class="c">!              Horizontal illuminance from sky and horizontal beam illuminance (lux)</span>
<a name="ln-8327"></a><span class="c">!              obtained from solar quantities on weather file and luminous efficacy.</span>
<a name="ln-8328"></a>
<a name="ln-8329"></a>        <span class="k">CALL </span><span class="n">DayltgLuminousEfficacy</span> <span class="p">(</span><span class="n">PDIFLW</span><span class="p">,</span><span class="n">PDIRLW</span><span class="p">)</span>
<a name="ln-8330"></a>        <span class="n">HISKF</span> <span class="o">=</span> <span class="n">SDIFH</span> <span class="o">*</span> <span class="n">PDIFLW</span>
<a name="ln-8331"></a>        <span class="n">HISUNF</span> <span class="o">=</span> <span class="n">SDIRH</span> <span class="o">*</span> <span class="n">PDIRLW</span>
<a name="ln-8332"></a>        <span class="n">HISUNFnorm</span> <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">PDIRLW</span>
<a name="ln-8333"></a>      <span class="k">ELSE</span>
<a name="ln-8334"></a><span class="k">        </span><span class="n">SDIRH</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8335"></a>        <span class="n">SDIFH</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8336"></a>        <span class="n">CloudFraction</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8337"></a>        <span class="n">PDIFLW</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8338"></a>        <span class="n">PDIRLW</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8339"></a>        <span class="n">HISKF</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8340"></a>        <span class="n">HISUNF</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8341"></a>        <span class="n">HISUNFnorm</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8342"></a>        <span class="n">SkyClearness</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8343"></a>        <span class="n">SkyBrightness</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8344"></a>      <span class="k">END IF</span>
<a name="ln-8345"></a>
<a name="ln-8346"></a><span class="k">      RETURN</span>
<a name="ln-8347"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgCurrentExtHorizIllum</span>
<a name="ln-8348"></a>
<a name="ln-8349"></a><span class="k">SUBROUTINE </span><span class="n">DayltgLuminousEfficacy</span> <span class="p">(</span><span class="n">DiffLumEff</span><span class="p">,</span><span class="n">DirLumEff</span><span class="p">)</span>
<a name="ln-8350"></a><span class="c">!</span>
<a name="ln-8351"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8352"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8353"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-8354"></a>          <span class="c">!       MODIFIED       August 2009, BG fixed upper bound for sky clearness bin 7</span>
<a name="ln-8355"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8356"></a>
<a name="ln-8357"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8358"></a>          <span class="c">! Uses diffuse horizontal solar irradiance, direct normal solar</span>
<a name="ln-8359"></a>          <span class="c">! irradiance, atmospheric moisture and sun position</span>
<a name="ln-8360"></a>          <span class="c">! to determine the luminous efficacy in lumens/watt</span>
<a name="ln-8361"></a>          <span class="c">! of sky diffuse solar radiation and direct normal solar radiation.</span>
<a name="ln-8362"></a>          <span class="c">! Based on an empirical method described in</span>
<a name="ln-8363"></a>          <span class="c">! R. Perez, P. Ineichen, R. Seals, J. Michalsky and R. Stewart,</span>
<a name="ln-8364"></a>          <span class="c">! &quot;Modeling daylight availability and irradiance components from direct</span>
<a name="ln-8365"></a>          <span class="c">! global irradiance components from direct and global irradiance,&quot;</span>
<a name="ln-8366"></a>          <span class="c">! Solar Energy 44 (1990) 271-289.</span>
<a name="ln-8367"></a>
<a name="ln-8368"></a>          <span class="c">! Called by DayltgCurrentExtHorizIllum.</span>
<a name="ln-8369"></a>
<a name="ln-8370"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8371"></a>          <span class="c">! na</span>
<a name="ln-8372"></a>
<a name="ln-8373"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8374"></a>
<a name="ln-8375"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8376"></a>          <span class="c">! na</span>
<a name="ln-8377"></a>
<a name="ln-8378"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8379"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADiffLumEff</span><span class="o">=</span>  <span class="p">&amp;</span>         <span class="c">! Diffuse luminous efficacy coefficients</span>
<a name="ln-8380"></a>      <span class="p">(</span><span class="o">/</span><span class="mi">9</span><span class="mf">7.24d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">7.22d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">4.97d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">2.39d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">0.71d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">6.42d0</span><span class="p">,</span> <span class="mi">14</span><span class="mf">1.88d0</span><span class="p">,</span> <span class="mi">15</span><span class="mf">2.23d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-8381"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BDiffLumEff</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-8382"></a>      <span class="p">(</span><span class="o">/-</span><span class="mf">0.46d0</span><span class="p">,</span> <span class="mf">1.15d0</span><span class="p">,</span>   <span class="mf">2.96d0</span><span class="p">,</span>   <span class="mf">5.59d0</span><span class="p">,</span>   <span class="mf">5.94d0</span><span class="p">,</span>   <span class="mf">3.83d0</span><span class="p">,</span>   <span class="mf">1.90d0</span><span class="p">,</span>   <span class="mf">0.35d0</span>  <span class="o">/</span><span class="p">)</span>
<a name="ln-8383"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CDiffLumEff</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-8384"></a>      <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.00d0</span><span class="p">,</span> <span class="mf">0.59d0</span><span class="p">,</span>   <span class="o">-</span><span class="mf">5.53d0</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="mf">3.95d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="mf">2.75d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="mf">6.15d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="mf">3.24d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">5.27d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-8385"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DDiffLumEff</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-8386"></a>      <span class="p">(</span><span class="o">/-</span><span class="mf">8.91d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.95d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.77d0</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="mf">3.90d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="mf">3.74d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="mf">8.83d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="mf">4.03d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.98d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-8387"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ADirLumEff</span><span class="o">=</span>   <span class="p">&amp;</span>         <span class="c">! Direct luminous efficacy coefficients</span>
<a name="ln-8388"></a>      <span class="p">(</span><span class="o">/</span><span class="mi">5</span><span class="mf">7.20d0</span><span class="p">,</span> <span class="mi">9</span><span class="mf">8.99d0</span><span class="p">,</span>  <span class="mi">10</span><span class="mf">9.83d0</span><span class="p">,</span> <span class="mi">11</span><span class="mf">0.34d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">6.36d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">7.19d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">5.75d0</span><span class="p">,</span> <span class="mi">10</span><span class="mf">1.18d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-8389"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BDirLumEff</span><span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-8390"></a>      <span class="p">(</span><span class="o">/-</span><span class="mf">4.55d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.46d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.90d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.84d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.97d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.25d0</span><span class="p">,</span>  <span class="mf">0.77d0</span><span class="p">,</span>   <span class="mf">1.58d0</span>  <span class="o">/</span><span class="p">)</span>
<a name="ln-8391"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CDirLumEff</span><span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-8392"></a>      <span class="p">(</span><span class="o">/-</span><span class="mf">2.98d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.21d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.71d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.99d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.75d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.51d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.26d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.10d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-8393"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DDirLumEff</span><span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-8394"></a>      <span class="p">(</span><span class="o">/</span><span class="mi">11</span><span class="mf">7.12d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">2.38d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.81d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.56d0</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.16d0</span><span class="p">,</span>  <span class="o">-</span><span class="mi">2</span><span class="mf">6.73d0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="mf">4.44d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.29d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-8395"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExtraDirNormIll</span><span class="o">=</span>  <span class="p">&amp;</span>     <span class="c">! Monthly exterrestrial direct normal illuminance (lum/m2)</span>
<a name="ln-8396"></a>      <span class="p">(</span><span class="o">/</span><span class="mi">13115</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">13061</span><span class="mf">3.d0</span><span class="p">,</span><span class="mi">12899</span><span class="mf">2.d0</span><span class="p">,</span><span class="mi">12681</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">12473</span><span class="mf">1.d0</span><span class="p">,</span><span class="mi">12324</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8397"></a>        <span class="mi">12265</span><span class="mf">2.d0</span><span class="p">,</span><span class="mi">12312</span><span class="mf">0.d0</span><span class="p">,</span><span class="mi">12457</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">12665</span><span class="mf">8.d0</span><span class="p">,</span><span class="mi">12881</span><span class="mf">4.d0</span><span class="p">,</span><span class="mi">13047</span><span class="mf">1.d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-8398"></a>
<a name="ln-8399"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8400"></a>          <span class="c">! na</span>
<a name="ln-8401"></a>
<a name="ln-8402"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8403"></a>          <span class="c">! na</span>
<a name="ln-8404"></a>
<a name="ln-8405"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8406"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">DirLumEff</span>               <span class="c">! Luminous efficacy of beam solar radiation (lum/W)</span>
<a name="ln-8407"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">DiffLumEff</span>              <span class="c">! Luminous efficacy of sky diffuse solar radiation (lum/W)</span>
<a name="ln-8408"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SunZenith</span>               <span class="c">! Solar zenith angle (radians)</span>
<a name="ln-8409"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SunAltitude</span>             <span class="c">! Solar altitude angle (radians)</span>
<a name="ln-8410"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SinSunAltitude</span>          <span class="c">! Sine of the solar altitude angle</span>
<a name="ln-8411"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Zeta</span>
<a name="ln-8412"></a><span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">ISkyClearness</span>           <span class="c">! Sky clearness bin</span>
<a name="ln-8413"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AirMass</span>                 <span class="c">! Relative optical air mass</span>
<a name="ln-8414"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AtmosMoisture</span>           <span class="c">! Atmospheric moisture (cm of precipitable water)</span>
<a name="ln-8415"></a>
<a name="ln-8416"></a>
<a name="ln-8417"></a>          <span class="c">! FLOW:</span>
<a name="ln-8418"></a><span class="c">!</span>
<a name="ln-8419"></a>
<a name="ln-8420"></a>
<a name="ln-8421"></a><span class="c">!</span>
<a name="ln-8422"></a>     <span class="n">SunZenith</span> <span class="o">=</span> <span class="nb">ACOS</span> <span class="p">(</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8423"></a>     <span class="n">SunAltitude</span> <span class="o">=</span> <span class="n">PiOvr2</span> <span class="o">-</span> <span class="n">SunZenith</span>
<a name="ln-8424"></a>     <span class="n">SinSunAltitude</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SunAltitude</span><span class="p">)</span>
<a name="ln-8425"></a><span class="c">!</span>
<a name="ln-8426"></a><span class="c">!              Clearness of sky. SkyClearness close to 1.0 corresponds to an overcast sky.</span>
<a name="ln-8427"></a><span class="c">!              SkyClearness &gt; 6 is a clear sky.</span>
<a name="ln-8428"></a><span class="c">!              DifSolarRad is the diffuse horizontal irradiance.</span>
<a name="ln-8429"></a><span class="c">!              BeamSolarRad is the direct normal irradiance.</span>
<a name="ln-8430"></a><span class="c">!</span>
<a name="ln-8431"></a>      <span class="n">Zeta</span> <span class="o">=</span> <span class="mf">1.041d0</span><span class="o">*</span><span class="n">SunZenith</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-8432"></a>      <span class="n">SkyClearness</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">+</span> <span class="n">BeamSolarRad</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Zeta</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">Zeta</span><span class="p">)</span>
<a name="ln-8433"></a>      <span class="n">AirMass</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="mf">0.1d0</span><span class="o">*</span><span class="n">Elevation</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.d0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">SinSunAltitude</span> <span class="o">+</span> <span class="mf">0.15d0</span><span class="o">/</span><span class="p">(</span><span class="n">SunAltitude</span><span class="o">/</span><span class="n">DegToRadians</span> <span class="o">+</span> <span class="mf">3.885d0</span><span class="p">)</span><span class="o">**</span><span class="mf">1.253d0</span><span class="p">)</span>
<a name="ln-8434"></a><span class="c">!</span>
<a name="ln-8435"></a><span class="c">!              In the following, 93.73 is the extraterrestrial luminous efficacy</span>
<a name="ln-8436"></a><span class="c">!</span>
<a name="ln-8437"></a>      <span class="n">SkyBrightness</span> <span class="o">=</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">*</span> <span class="mi">9</span><span class="mf">3.73d0</span><span class="p">)</span><span class="o">*</span> <span class="n">AirMass</span> <span class="o">/</span> <span class="n">ExtraDirNormIll</span><span class="p">(</span><span class="n">Month</span><span class="p">)</span>
<a name="ln-8438"></a><span class="c">!</span>
<a name="ln-8439"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">1.065d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8440"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-8441"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">1.065d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">1.23d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8442"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-8443"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">1.23d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">1.50d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8444"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-8445"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">1.50d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">1.95d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8446"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-8447"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">1.95d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">2.80d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8448"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-8449"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">2.80d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">4.50d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8450"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-8451"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">4.50d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SkyClearness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">6.20d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8452"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">7</span>
<a name="ln-8453"></a>      <span class="k">ELSE</span>
<a name="ln-8454"></a><span class="k">         </span><span class="n">ISkyClearness</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-8455"></a>      <span class="k">END IF</span>
<a name="ln-8456"></a><span class="c">!</span>
<a name="ln-8457"></a>      <span class="n">AtmosMoisture</span> <span class="o">=</span> <span class="nb">EXP</span> <span class="p">(</span><span class="mf">0.07d0</span><span class="o">*</span><span class="n">OutDewPointTemp</span> <span class="o">-</span> <span class="mf">0.075d0</span><span class="p">)</span>
<a name="ln-8458"></a><span class="c">!</span>
<a name="ln-8459"></a><span class="c">!              Sky diffuse luminous efficacy</span>
<a name="ln-8460"></a><span class="c">!</span>
<a name="ln-8461"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SkyBrightness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8462"></a><span class="k">         </span><span class="n">DiffLumEff</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8463"></a>      <span class="k">ELSE</span>
<a name="ln-8464"></a><span class="k">         </span><span class="n">DiffLumEff</span> <span class="o">=</span> <span class="n">ADiffLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span> <span class="o">+</span> <span class="n">BDiffLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span><span class="o">*</span><span class="n">AtmosMoisture</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8465"></a>                      <span class="n">CDiffLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span><span class="o">*</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8466"></a>                      <span class="n">DDiffLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span><span class="o">*</span><span class="nb">LOG</span><span class="p">(</span><span class="n">SkyBrightness</span><span class="p">)</span>
<a name="ln-8467"></a>      <span class="n">ENDIF</span>
<a name="ln-8468"></a><span class="c">!</span>
<a name="ln-8469"></a><span class="c">!              Direct normal luminous efficacy</span>
<a name="ln-8470"></a><span class="c">!</span>
<a name="ln-8471"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SkyBrightness</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8472"></a><span class="k">         </span><span class="n">DirLumEff</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8473"></a>      <span class="k">ELSE</span>
<a name="ln-8474"></a><span class="k">         </span><span class="n">DirLumEff</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">ADirLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span> <span class="o">+</span> <span class="n">BDirLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span><span class="o">*</span><span class="n">AtmosMoisture</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8475"></a>                       <span class="n">CDirLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span><span class="o">*</span><span class="nb">EXP</span><span class="p">(</span><span class="mf">5.73d0</span><span class="o">*</span><span class="n">SunZenith</span><span class="o">-</span><span class="mf">5.d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8476"></a>                       <span class="n">DDirLumEff</span><span class="p">(</span><span class="n">ISkyClearness</span><span class="p">)</span><span class="o">*</span><span class="n">SkyBrightness</span><span class="p">)</span>
<a name="ln-8477"></a>      <span class="n">ENDIF</span>
<a name="ln-8478"></a>
<a name="ln-8479"></a>      <span class="k">RETURN</span>
<a name="ln-8480"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgLuminousEfficacy</span>
<a name="ln-8481"></a>
<a name="ln-8482"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">Function </span><span class="n">GetSTM</span><span class="p">(</span><span class="n">Longitude</span><span class="p">)</span>
<a name="ln-8483"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8484"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-8485"></a>          <span class="c">!       DATE WRITTEN   August 2003</span>
<a name="ln-8486"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8487"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8488"></a>
<a name="ln-8489"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8490"></a>          <span class="c">! This function determines the &quot;standard time meridian&quot; from the input</span>
<a name="ln-8491"></a>          <span class="c">! longitude. Calculates the proper Meridian from Longitude.  This</span>
<a name="ln-8492"></a>          <span class="c">! value is needed for weather calculations so that the sun comes</span>
<a name="ln-8493"></a>          <span class="c">! up and goes down at the right times.</span>
<a name="ln-8494"></a>
<a name="ln-8495"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8496"></a>          <span class="c">! na</span>
<a name="ln-8497"></a>
<a name="ln-8498"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8499"></a>          <span class="c">! na</span>
<a name="ln-8500"></a>
<a name="ln-8501"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8502"></a>          <span class="c">! na</span>
<a name="ln-8503"></a>
<a name="ln-8504"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8505"></a>
<a name="ln-8506"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8507"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Longitude</span>  <span class="c">! Longitude from user input</span>
<a name="ln-8508"></a>
<a name="ln-8509"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8510"></a>          <span class="c">! na</span>
<a name="ln-8511"></a>
<a name="ln-8512"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8513"></a>          <span class="c">! na</span>
<a name="ln-8514"></a>
<a name="ln-8515"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8516"></a>          <span class="c">! na</span>
<a name="ln-8517"></a>
<a name="ln-8518"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8519"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">longl</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>  <span class="c">! Lower Longitude value for a Time Zone</span>
<a name="ln-8520"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">longh</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>  <span class="c">! Upper Longitude value for a Time Zone</span>
<a name="ln-8521"></a>      <span class="kt">INTEGER </span><span class="n">i</span>  <span class="c">! Loop variable</span>
<a name="ln-8522"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">temp</span>  <span class="c">! temporary value used to determine time zone</span>
<a name="ln-8523"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">tz</span>    <span class="c">! resultant tz meridian</span>
<a name="ln-8524"></a>
<a name="ln-8525"></a>      <span class="n">GetSTM</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8526"></a><span class="c">!</span>
<a name="ln-8527"></a>      <span class="n">longl</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">=-</span><span class="mf">7.5d0</span>
<a name="ln-8528"></a>      <span class="n">longh</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="mf">7.5d0</span>
<a name="ln-8529"></a>      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-8530"></a>        <span class="n">longl</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">longl</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="mf">5.d0</span>
<a name="ln-8531"></a>        <span class="n">longh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">longh</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="mf">5.d0</span>
<a name="ln-8532"></a>      <span class="n">enddo</span>
<a name="ln-8533"></a>      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-8534"></a>        <span class="n">longl</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">longl</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="mf">5.d0</span>
<a name="ln-8535"></a>        <span class="n">longh</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">longh</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="mf">5.d0</span>
<a name="ln-8536"></a>      <span class="n">enddo</span>
<a name="ln-8537"></a>      <span class="n">temp</span><span class="o">=</span><span class="n">Longitude</span>
<a name="ln-8538"></a>      <span class="n">temp</span><span class="o">=</span><span class="nb">mod</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">36</span><span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-8539"></a>
<a name="ln-8540"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">temp</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">temp</span><span class="o">=</span><span class="n">temp</span><span class="o">-</span><span class="mi">18</span><span class="mf">0.d0</span>
<a name="ln-8541"></a>      <span class="k">do </span><span class="n">i</span><span class="o">=-</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-8542"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">temp</span> <span class="o">&gt;</span> <span class="n">longl</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">temp</span> <span class="o">&lt;=</span> <span class="n">longh</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-8543"></a><span class="k">          </span><span class="n">tz</span><span class="o">=</span><span class="n">i</span>
<a name="ln-8544"></a>          <span class="n">tz</span><span class="o">=</span><span class="nb">mod</span><span class="p">(</span><span class="n">tz</span><span class="p">,</span><span class="mi">2</span><span class="mf">4.d0</span><span class="p">)</span>
<a name="ln-8545"></a>          <span class="n">GetSTM</span><span class="o">=</span><span class="n">tz</span>
<a name="ln-8546"></a>          <span class="k">exit</span>
<a name="ln-8547"></a><span class="k">        </span><span class="n">endif</span>
<a name="ln-8548"></a>      <span class="n">enddo</span>
<a name="ln-8549"></a>
<a name="ln-8550"></a>      <span class="k">RETURN</span>
<a name="ln-8551"></a><span class="c">!</span>
<a name="ln-8552"></a><span class="k">END FUNCTION </span><span class="n">GetSTM</span>
<a name="ln-8553"></a>
<a name="ln-8554"></a><span class="k">SUBROUTINE </span><span class="n">ProcessEPWHeader</span><span class="p">(</span><span class="n">HeaderString</span><span class="p">,</span><span class="n">Line</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8555"></a>
<a name="ln-8556"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8557"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-8558"></a>          <span class="c">!       DATE WRITTEN   December 1999</span>
<a name="ln-8559"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8560"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8561"></a>
<a name="ln-8562"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8563"></a>          <span class="c">! This subroutine processes each header line in the EPW weather file.</span>
<a name="ln-8564"></a>
<a name="ln-8565"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8566"></a>          <span class="c">! File is positioned to the correct line, then backspaced.  This routine</span>
<a name="ln-8567"></a>          <span class="c">! reads in the line and processes as appropriate.</span>
<a name="ln-8568"></a>
<a name="ln-8569"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8570"></a>          <span class="c">! na</span>
<a name="ln-8571"></a>
<a name="ln-8572"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8573"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ProcessNumber</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">MakeUPPERCase</span><span class="p">,</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-8574"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">JulianDay</span>
<a name="ln-8575"></a>
<a name="ln-8576"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8577"></a>
<a name="ln-8578"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8579"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeaderString</span>
<a name="ln-8580"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Line</span>
<a name="ln-8581"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-8582"></a>
<a name="ln-8583"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8584"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AFormat</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-8585"></a>
<a name="ln-8586"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8587"></a>          <span class="c">! na</span>
<a name="ln-8588"></a>
<a name="ln-8589"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8590"></a>          <span class="c">! na</span>
<a name="ln-8591"></a>
<a name="ln-8592"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8593"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Title</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-8594"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Count</span>
<a name="ln-8595"></a><span class="nb">  </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="n">WMO</span>
<a name="ln-8596"></a>  <span class="kt">INTEGER </span><span class="n">Pos</span>
<a name="ln-8597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Number</span>
<a name="ln-8598"></a>  <span class="kt">LOGICAL </span><span class="n">IOStatus</span>
<a name="ln-8599"></a>  <span class="kt">INTEGER </span><span class="n">PMonth</span><span class="p">,</span><span class="n">Pday</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">PYear</span><span class="p">,</span><span class="n">DateType</span>
<a name="ln-8600"></a>  <span class="kt">INTEGER </span><span class="n">NumHdArgs</span>
<a name="ln-8601"></a>  <span class="kt">LOGICAL </span><span class="n">ErrFlag</span>
<a name="ln-8602"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="n">ErrNum</span>
<a name="ln-8603"></a>  <span class="kt">INTEGER </span><span class="n">CurCount</span>
<a name="ln-8604"></a>  <span class="kt">INTEGER </span><span class="n">CurOne</span>
<a name="ln-8605"></a>  <span class="kt">INTEGER </span><span class="n">NumEPWHolidays</span>
<a name="ln-8606"></a>  <span class="kt">INTEGER </span><span class="n">NumGrndTemps</span>
<a name="ln-8607"></a>  <span class="kt">INTEGER </span><span class="n">endcol</span>
<a name="ln-8608"></a>  <span class="kt">INTEGER </span><span class="n">TropExtremeCount</span>  <span class="c">! because these can show up as &quot;no dry&quot; need to count and separate.</span>
<a name="ln-8609"></a>  <span class="kt">INTEGER </span><span class="n">actcount</span>
<a name="ln-8610"></a>  <span class="kt">LOGICAL </span><span class="n">errflag1</span>
<a name="ln-8611"></a>
<a name="ln-8612"></a>
<a name="ln-8613"></a>  <span class="c">! Strip off Header value from Line</span>
<a name="ln-8614"></a>  <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8615"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">HeaderString</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">))</span> <span class="o">/=</span> <span class="s1">&#39;COMMENTS&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8616"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid Header line in in.epw -- no commas&#39;</span><span class="p">)</span>
<a name="ln-8617"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Line=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">))</span>
<a name="ln-8618"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Previous conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-8619"></a>  <span class="n">ENDIF</span>
<a name="ln-8620"></a>  <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8621"></a>
<a name="ln-8622"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">HeaderString</span><span class="p">))</span>
<a name="ln-8623"></a>
<a name="ln-8624"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LOCATION&#39;</span><span class="p">)</span>
<a name="ln-8625"></a>  <span class="c">! LOCATION, A1 [City], A2 [State/Province/Region], A3 [Country],</span>
<a name="ln-8626"></a>  <span class="c">! A4 [Source], N1 [WMO], N2 [Latitude],</span>
<a name="ln-8627"></a>  <span class="c">! N3 [Longitude], N4 [Time Zone], N5 [Elevation {m}]</span>
<a name="ln-8628"></a>
<a name="ln-8629"></a>      <span class="n">NumHdArgs</span><span class="o">=</span><span class="mi">9</span>
<a name="ln-8630"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-8631"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">&lt;=</span> <span class="n">NumHdArgs</span><span class="p">)</span>
<a name="ln-8632"></a>        <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8633"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8634"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8635"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8636"></a><span class="k">            DO WHILE</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-8637"></a>              <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">AFormat</span><span class="p">)</span> <span class="n">Line</span>
<a name="ln-8638"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">StripCR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8639"></a><span class="k">                </span><span class="n">endcol</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8640"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">endcol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8641"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">))</span> <span class="o">==</span> <span class="n">iASCII_CR</span><span class="p">)</span> <span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-8642"></a>                <span class="n">ENDIF</span>
<a name="ln-8643"></a>              <span class="n">ENDIF</span>
<a name="ln-8644"></a>              <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8645"></a>              <span class="n">Line</span><span class="o">=</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8646"></a>              <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8647"></a>            <span class="n">ENDDO</span>
<a name="ln-8648"></a>          <span class="k">ELSE</span>
<a name="ln-8649"></a><span class="k">            </span><span class="n">Pos</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8650"></a>          <span class="n">ENDIF</span>
<a name="ln-8651"></a>        <span class="n">ENDIF</span>
<a name="ln-8652"></a>
<a name="ln-8653"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">Count</span><span class="p">)</span>
<a name="ln-8654"></a>
<a name="ln-8655"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8656"></a>            <span class="n">Title</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8657"></a>
<a name="ln-8658"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8659"></a>            <span class="n">Title</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8660"></a>
<a name="ln-8661"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-8662"></a>            <span class="n">WMO</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8663"></a>            <span class="n">Title</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; WMO#=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WMO</span><span class="p">)</span>
<a name="ln-8664"></a>
<a name="ln-8665"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-8666"></a>            <span class="n">Number</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-8667"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8668"></a><span class="k">              SELECT CASE</span> <span class="p">(</span><span class="nb">Count</span><span class="p">)</span>
<a name="ln-8669"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-8670"></a>                  <span class="n">WeatherFileLatitude</span><span class="o">=</span><span class="n">Number</span>
<a name="ln-8671"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-8672"></a>                  <span class="n">WeatherFileLongitude</span><span class="o">=</span><span class="n">Number</span>
<a name="ln-8673"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-8674"></a>                  <span class="n">WeatherFileTimeZone</span><span class="o">=</span><span class="n">Number</span>
<a name="ln-8675"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-8676"></a>                  <span class="n">WeatherFileElevation</span><span class="o">=</span><span class="n">Number</span>
<a name="ln-8677"></a>              <span class="k">END SELECT</span>
<a name="ln-8678"></a><span class="k">            ELSE</span>
<a name="ln-8679"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetEPWHeader:LOCATION, invalid numeric=&#39;</span><span class="o">//</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8680"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8681"></a>            <span class="n">ENDIF</span>
<a name="ln-8682"></a>        <span class="k">END SELECT</span>
<a name="ln-8683"></a><span class="k">        </span><span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8684"></a>        <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8685"></a>      <span class="n">ENDDO</span>
<a name="ln-8686"></a>      <span class="n">WeatherFileLocationTitle</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Title</span><span class="p">)</span>
<a name="ln-8687"></a>
<a name="ln-8688"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DESIGN CONDITIONS&#39;</span><span class="p">)</span>
<a name="ln-8689"></a>     <span class="c">! No action</span>
<a name="ln-8690"></a>
<a name="ln-8691"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;TYPICAL/EXTREME PERIODS&#39;</span><span class="p">)</span>
<a name="ln-8692"></a>      <span class="n">TropExtremeCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8693"></a>      <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8694"></a>      <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8695"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8696"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8697"></a><span class="k">          DO WHILE</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-8698"></a>            <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">AFormat</span><span class="p">)</span> <span class="n">Line</span>
<a name="ln-8699"></a>            <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8700"></a>            <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8701"></a>          <span class="n">ENDDO</span>
<a name="ln-8702"></a>        <span class="k">ELSE</span>
<a name="ln-8703"></a><span class="k">          </span><span class="n">Pos</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8704"></a>        <span class="n">ENDIF</span>
<a name="ln-8705"></a>      <span class="n">ENDIF</span>
<a name="ln-8706"></a>      <span class="n">NumEPWTypExtSets</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-8707"></a>      <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8708"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="n">NumEPWTypExtSets</span><span class="p">))</span>
<a name="ln-8709"></a>      <span class="n">TropExtremeCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8710"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-8711"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">&lt;=</span> <span class="n">NumEPWTypExtSets</span><span class="p">)</span>
<a name="ln-8712"></a>        <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8713"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8714"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8715"></a><span class="k">          </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8716"></a>          <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8717"></a>        <span class="k">ELSE</span>
<a name="ln-8718"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ProcessEPWHeader: Invalid Typical/Extreme Periods Header(WeatherFile)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8719"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8720"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...on processing Typical/Extreme period #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">Count</span><span class="p">)))</span>
<a name="ln-8721"></a>          <span class="n">NumEPWTypExtSets</span><span class="o">=</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-8722"></a>          <span class="k">EXIT</span>
<a name="ln-8723"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-8724"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8725"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8726"></a><span class="k">          </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TEType</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8727"></a>          <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8728"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TEType</span><span class="p">,</span><span class="s1">&#39;EXTREME&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8729"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">36</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8730"></a>                           <span class="s1">&#39;NO DRY SEASON - WEEK NEAR ANNUAL MAX&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8731"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoDrySeasonMax&#39;</span>
<a name="ln-8732"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">36</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8733"></a>                              <span class="s1">&#39;NO DRY SEASON - WEEK NEAR ANNUAL MIN&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8734"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoDrySeasonMin&#39;</span>
<a name="ln-8735"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">36</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8736"></a>                           <span class="s1">&#39;NO WET SEASON - WEEK NEAR ANNUAL MAX&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8737"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoWetSeasonMax&#39;</span>
<a name="ln-8738"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">36</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8739"></a>                              <span class="s1">&#39;NO WET SEASON - WEEK NEAR ANNUAL MIN&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8740"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoWetSeasonMin&#39;</span>
<a name="ln-8741"></a>            <span class="c">! to account for problems earlier in weather files:</span>
<a name="ln-8742"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;NO DRY&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8743"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">TropExtremeCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8744"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="s1">&#39;No Dry Season - Week Near Annual Max&#39;</span>
<a name="ln-8745"></a>                <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoDrySeasonMax&#39;</span>
<a name="ln-8746"></a>                <span class="n">TropExtremeCount</span><span class="o">=</span><span class="n">TropExtremeCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8747"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TropExtremeCount</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8748"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="s1">&#39;No Dry Season - Week Near Annual Min&#39;</span>
<a name="ln-8749"></a>                <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoDrySeasonMin&#39;</span>
<a name="ln-8750"></a>                <span class="n">TropExtremeCount</span><span class="o">=</span><span class="n">TropExtremeCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8751"></a>              <span class="n">ENDIF</span>
<a name="ln-8752"></a>            <span class="k">ELSE</span>  <span class="c">! make new short titles</span>
<a name="ln-8753"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;SUMMER&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8754"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Summer&#39;</span>
<a name="ln-8755"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;WINTER&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8756"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Winter&#39;</span>
<a name="ln-8757"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;TROPICAL HOT&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8758"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;TropicalHot&#39;</span>
<a name="ln-8759"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;TROPICAL COLD&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8760"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;TropicalCold&#39;</span>
<a name="ln-8761"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;AUTUMN&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8762"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Autumn&#39;</span>
<a name="ln-8763"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;NO DRY&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8764"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoDrySeason&#39;</span>
<a name="ln-8765"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;NO WET&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8766"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoWetSeason&#39;</span>
<a name="ln-8767"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;WET &#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8768"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;WetSeason&#39;</span>
<a name="ln-8769"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;DRY &#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8770"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;DrySeason&#39;</span>
<a name="ln-8771"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;SPRING&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8772"></a><span class="k">                </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Spring&#39;</span>
<a name="ln-8773"></a>              <span class="n">ENDIF</span>
<a name="ln-8774"></a>            <span class="n">ENDIF</span>
<a name="ln-8775"></a>          <span class="k">ELSE</span> <span class="c">! not extreme</span>
<a name="ln-8776"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;SUMMER&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8777"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Summer&#39;</span>
<a name="ln-8778"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;WINTER&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8779"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Winter&#39;</span>
<a name="ln-8780"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;TROPICAL HOT&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8781"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;TropicalHot&#39;</span>
<a name="ln-8782"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;TROPICAL COLD&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8783"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;TropicalCold&#39;</span>
<a name="ln-8784"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;AUTUMN&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8785"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Autumn&#39;</span>
<a name="ln-8786"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;NO DRY&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8787"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoDrySeason&#39;</span>
<a name="ln-8788"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;NO WET&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8789"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;NoWetSeason&#39;</span>
<a name="ln-8790"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;WET &#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8791"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;WetSeason&#39;</span>
<a name="ln-8792"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;DRY &#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8793"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;DrySeason&#39;</span>
<a name="ln-8794"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;SPRING&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8795"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="o">=</span><span class="s1">&#39;Spring&#39;</span>
<a name="ln-8796"></a>            <span class="n">ENDIF</span>
<a name="ln-8797"></a>          <span class="n">ENDIF</span>
<a name="ln-8798"></a>        <span class="k">ELSE</span>
<a name="ln-8799"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ProcessEPWHeader: Invalid Typical/Extreme Periods Header(WeatherFile)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8800"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Title</span><span class="p">)</span><span class="o">//</span><span class="n">Blank</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8801"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...on processing Typical/Extreme period #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">Count</span><span class="p">)))</span>
<a name="ln-8802"></a>          <span class="n">NumEPWTypExtSets</span><span class="o">=</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-8803"></a>          <span class="k">EXIT</span>
<a name="ln-8804"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-8805"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8806"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8807"></a><span class="k">          CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8808"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">/=</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8809"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PMonth</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PDay</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8810"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-8811"></a>              <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-8812"></a>            <span class="n">ENDIF</span>
<a name="ln-8813"></a>          <span class="k">ELSE</span>
<a name="ln-8814"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;ProcessEPWHeader: Invalid Typical/Extreme Periods Start Date Field(WeatherFile)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8815"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8816"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...on processing Typical/Extreme period #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">Count</span><span class="p">)))</span>
<a name="ln-8817"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8818"></a>          <span class="n">ENDIF</span>
<a name="ln-8819"></a>          <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8820"></a>        <span class="n">ENDIF</span>
<a name="ln-8821"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8822"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8823"></a><span class="k">          CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8824"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">/=</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8825"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PMonth</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PDay</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8826"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-8827"></a>              <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-8828"></a>            <span class="n">ENDIF</span>
<a name="ln-8829"></a>          <span class="k">ELSE</span>
<a name="ln-8830"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;ProcessEPWHeader: Invalid Typical/Extreme Periods End Date Field(WeatherFile)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8831"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8832"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...on processing Typical/Extreme period #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">Count</span><span class="p">)))</span>
<a name="ln-8833"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8834"></a>          <span class="n">ENDIF</span>
<a name="ln-8835"></a>          <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8836"></a>        <span class="k">ELSE</span> <span class="c">! Pos=0, probably last one</span>
<a name="ln-8837"></a>          <span class="k">CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-8838"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">/=</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8839"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PMonth</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PDay</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8840"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-8841"></a>              <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-8842"></a>            <span class="n">ENDIF</span>
<a name="ln-8843"></a>          <span class="k">ELSE</span>
<a name="ln-8844"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;ProcessEPWHeader: Invalid Typical/Extreme Periods End Date Field(WeatherFile)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8845"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8846"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8847"></a>          <span class="n">ENDIF</span>
<a name="ln-8848"></a>        <span class="n">ENDIF</span>
<a name="ln-8849"></a>        <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8850"></a>      <span class="n">ENDDO</span>
<a name="ln-8851"></a>      <span class="c">! Process periods to set up other values.</span>
<a name="ln-8852"></a>      <span class="k">DO </span><span class="nb">Count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumEPWTypExtSets</span>
<a name="ln-8853"></a>        <span class="c">! JulianDay (Month,Day,LeapYearValue)</span>
<a name="ln-8854"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span><span class="p">))</span>
<a name="ln-8855"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SUMMER&#39;</span><span class="p">)</span>
<a name="ln-8856"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TEType</span><span class="p">,</span><span class="s1">&#39;EXTREME&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8857"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;SummerExtreme&#39;</span>
<a name="ln-8858"></a>              <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue1</span><span class="o">=</span> <span class="s1">&#39;TropicalHot&#39;</span>
<a name="ln-8859"></a>              <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue2</span><span class="o">=</span> <span class="s1">&#39;NoDrySeasonMax&#39;</span>
<a name="ln-8860"></a>            <span class="k">ELSE</span>
<a name="ln-8861"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;SummerTypical&#39;</span>
<a name="ln-8862"></a>            <span class="n">ENDIF</span>
<a name="ln-8863"></a>
<a name="ln-8864"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;WINTER&#39;</span><span class="p">)</span>
<a name="ln-8865"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TEType</span><span class="p">,</span><span class="s1">&#39;EXTREME&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8866"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;WinterExtreme&#39;</span>
<a name="ln-8867"></a>              <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue1</span><span class="o">=</span> <span class="s1">&#39;TropicalCold&#39;</span>
<a name="ln-8868"></a>              <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue2</span><span class="o">=</span> <span class="s1">&#39;NoDrySeasonMin&#39;</span>
<a name="ln-8869"></a>            <span class="k">ELSE</span>
<a name="ln-8870"></a><span class="k">              </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;WinterTypical&#39;</span>
<a name="ln-8871"></a>            <span class="n">ENDIF</span>
<a name="ln-8872"></a>
<a name="ln-8873"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;AUTUMN&#39;</span><span class="p">)</span>
<a name="ln-8874"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;AutumnTypical&#39;</span>
<a name="ln-8875"></a>
<a name="ln-8876"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SPRING&#39;</span><span class="p">)</span>
<a name="ln-8877"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;SpringTypical&#39;</span>
<a name="ln-8878"></a>
<a name="ln-8879"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;WETSEASON&#39;</span><span class="p">)</span>
<a name="ln-8880"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;WetSeason&#39;</span>
<a name="ln-8881"></a>
<a name="ln-8882"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DRYSEASON&#39;</span><span class="p">)</span>
<a name="ln-8883"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;DrySeason&#39;</span>
<a name="ln-8884"></a>
<a name="ln-8885"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NOWETSEASON&#39;</span><span class="p">)</span>
<a name="ln-8886"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;NoWetSeason&#39;</span>
<a name="ln-8887"></a>
<a name="ln-8888"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NODRYSEASON&#39;</span><span class="p">)</span>
<a name="ln-8889"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;NoDrySeason&#39;</span>
<a name="ln-8890"></a>
<a name="ln-8891"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NODRYSEASONMAX&#39;</span><span class="p">,</span><span class="s1">&#39;NOWETSEASONMAX&#39;</span><span class="p">)</span>
<a name="ln-8892"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span>
<a name="ln-8893"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue1</span><span class="o">=</span> <span class="s1">&#39;TropicalHot&#39;</span>
<a name="ln-8894"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue2</span><span class="o">=</span> <span class="s1">&#39;SummerExtreme&#39;</span>
<a name="ln-8895"></a>
<a name="ln-8896"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NODRYSEASONMIN&#39;</span><span class="p">,</span><span class="s1">&#39;NOWETSEASONMIN&#39;</span><span class="p">)</span>
<a name="ln-8897"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ShortTitle</span>
<a name="ln-8898"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue1</span><span class="o">=</span> <span class="s1">&#39;TropicalCold&#39;</span>
<a name="ln-8899"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue2</span><span class="o">=</span> <span class="s1">&#39;WinterExtreme&#39;</span>
<a name="ln-8900"></a>
<a name="ln-8901"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;TROPICALHOT&#39;</span><span class="p">)</span>
<a name="ln-8902"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;TropicalHot&#39;</span>
<a name="ln-8903"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue1</span><span class="o">=</span> <span class="s1">&#39;SummerExtreme&#39;</span>
<a name="ln-8904"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue2</span><span class="o">=</span> <span class="s1">&#39;NoDrySeasonMax&#39;</span>
<a name="ln-8905"></a>
<a name="ln-8906"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;TROPICALCOLD&#39;</span><span class="p">)</span>
<a name="ln-8907"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;TropicalCold&#39;</span>
<a name="ln-8908"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue1</span><span class="o">=</span> <span class="s1">&#39;WinterExtreme&#39;</span>
<a name="ln-8909"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue2</span><span class="o">=</span> <span class="s1">&#39;NoDrySeasonMin&#39;</span>
<a name="ln-8910"></a>
<a name="ln-8911"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-8912"></a>            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">MatchValue</span> <span class="o">=</span> <span class="s1">&#39;Invalid - no match&#39;</span>
<a name="ln-8913"></a>
<a name="ln-8914"></a>        <span class="k">END SELECT</span>
<a name="ln-8915"></a><span class="k">        </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8916"></a>                                                         <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-8917"></a>        <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8918"></a>                                                         <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-8919"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span> <span class="o">&lt;=</span> <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8920"></a><span class="k">          </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">-</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8921"></a>        <span class="k">ELSE</span>
<a name="ln-8922"></a><span class="k">          </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span><span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-8923"></a>                            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span>
<a name="ln-8924"></a>        <span class="n">ENDIF</span>
<a name="ln-8925"></a>      <span class="n">ENDDO</span>
<a name="ln-8926"></a>
<a name="ln-8927"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GROUND TEMPERATURES&#39;</span><span class="p">)</span>
<a name="ln-8928"></a>      <span class="c">! Added for ground surfaces defined with F or c factor method. TH 7/2009</span>
<a name="ln-8929"></a>      <span class="c">! Assume the 0.5 m set of ground temperatures</span>
<a name="ln-8930"></a>      <span class="c">! or first set on a weather file, if any.</span>
<a name="ln-8931"></a>      <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8932"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8933"></a><span class="k">        </span><span class="n">NumGrndTemps</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-8934"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumGrndTemps</span> <span class="o">&gt;=</span><span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8935"></a><span class="k">          </span><span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8936"></a>          <span class="c">! skip depth, soil conductivity, soil density, soil specific heat</span>
<a name="ln-8937"></a>          <span class="k">do </span><span class="nb">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-8938"></a>            <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8939"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8940"></a><span class="k">              </span><span class="n">Line</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-8941"></a>              <span class="k">exit</span>
<a name="ln-8942"></a><span class="k">            </span><span class="n">endif</span>
<a name="ln-8943"></a>            <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8944"></a>          <span class="n">enddo</span>
<a name="ln-8945"></a>          <span class="n">GroundTempsFC</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8946"></a>          <span class="n">actcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8947"></a>          <span class="k">do </span><span class="nb">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span> <span class="c">! take the first set of ground temperatures.</span>
<a name="ln-8948"></a>            <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8949"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8950"></a><span class="k">              </span><span class="n">Number</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-8951"></a>              <span class="n">GroundTempsFC</span><span class="p">(</span><span class="nb">Count</span><span class="p">)</span> <span class="o">=</span> <span class="n">Number</span>
<a name="ln-8952"></a>              <span class="n">actcount</span><span class="o">=</span><span class="n">actcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8953"></a>            <span class="k">ELSE</span>
<a name="ln-8954"></a><span class="k">              IF</span> <span class="p">(</span><span class="nb">Len_Trim</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8955"></a><span class="k">                </span><span class="n">Number</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-8956"></a>                <span class="n">GroundTempsFC</span><span class="p">(</span><span class="nb">Count</span><span class="p">)</span> <span class="o">=</span> <span class="n">Number</span>
<a name="ln-8957"></a>                <span class="n">actcount</span><span class="o">=</span><span class="n">actcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8958"></a>              <span class="n">ENDIF</span>
<a name="ln-8959"></a>              <span class="k">EXIT</span>
<a name="ln-8960"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-8961"></a>            <span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-8962"></a>          <span class="n">ENDDO</span>
<a name="ln-8963"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">actcount</span> <span class="o">==</span> <span class="mi">12</span><span class="p">)</span> <span class="n">wthFCGroundTemps</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8964"></a>        <span class="n">ENDIF</span>
<a name="ln-8965"></a>      <span class="n">ENDIF</span>
<a name="ln-8966"></a>
<a name="ln-8967"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;HOLIDAYS/DAYLIGHT SAVING&#39;</span><span class="p">)</span>
<a name="ln-8968"></a>     <span class="c">!A1, \field LeapYear Observed</span>
<a name="ln-8969"></a>     <span class="c">! \type choice</span>
<a name="ln-8970"></a>     <span class="c">! \key Yes</span>
<a name="ln-8971"></a>     <span class="c">! \key No</span>
<a name="ln-8972"></a>     <span class="c">! \note Yes if Leap Year will be observed for this file</span>
<a name="ln-8973"></a>     <span class="c">! \note No if Leap Year days (29 Feb) should be ignored in this file</span>
<a name="ln-8974"></a>     <span class="c">!A2, \field Daylight Saving Start Day</span>
<a name="ln-8975"></a>     <span class="c">!A3, \field Daylight Saving End Day</span>
<a name="ln-8976"></a>     <span class="c">!N1, \field Number of Holidays</span>
<a name="ln-8977"></a>     <span class="c">!A4, \field Holiday 1 Name</span>
<a name="ln-8978"></a>     <span class="c">!A5, \field Holiday 1 Day</span>
<a name="ln-8979"></a>     <span class="c">! etc.</span>
<a name="ln-8980"></a>     <span class="c">! Start with Minimum number of NumHdArgs</span>
<a name="ln-8981"></a>      <span class="n">Line</span><span class="o">=</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8982"></a>      <span class="n">NumHdArgs</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-8983"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-8984"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">&lt;=</span> <span class="n">NumHdArgs</span><span class="p">)</span>
<a name="ln-8985"></a>        <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8986"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-8987"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8988"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8989"></a><span class="k">            DO WHILE</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-8990"></a>              <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">AFormat</span><span class="p">)</span> <span class="n">Line</span>
<a name="ln-8991"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">StripCR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8992"></a><span class="k">                </span><span class="n">endcol</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8993"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">endcol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8994"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">))</span> <span class="o">==</span> <span class="n">iASCII_CR</span><span class="p">)</span> <span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-8995"></a>                <span class="n">ENDIF</span>
<a name="ln-8996"></a>              <span class="n">ENDIF</span>
<a name="ln-8997"></a>              <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8998"></a>              <span class="n">Line</span><span class="o">=</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-8999"></a>              <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-9000"></a>            <span class="n">ENDDO</span>
<a name="ln-9001"></a>          <span class="k">ELSE</span>
<a name="ln-9002"></a><span class="k">            </span><span class="n">Pos</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9003"></a>          <span class="n">ENDIF</span>
<a name="ln-9004"></a>        <span class="n">ENDIF</span>
<a name="ln-9005"></a>
<a name="ln-9006"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">Count</span><span class="p">)</span>
<a name="ln-9007"></a>
<a name="ln-9008"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9009"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9010"></a><span class="c">!              LeapYear=.true.</span>
<a name="ln-9011"></a>              <span class="n">WFAllowsLeapYears</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9012"></a>              <span class="n">WFLeapYearInd</span><span class="o">=</span><span class="mi">0</span> <span class="c">!1</span>
<a name="ln-9013"></a>            <span class="k">ELSE</span>
<a name="ln-9014"></a><span class="c">!              LeapYear=.false.</span>
<a name="ln-9015"></a>              <span class="n">WFAllowsLeapYears</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9016"></a>              <span class="n">WFLeapYearInd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9017"></a>            <span class="n">ENDIF</span>
<a name="ln-9018"></a>
<a name="ln-9019"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9020"></a>            <span class="n">errflag1</span><span class="o">=</span><span class="n">ErrorsFound</span>
<a name="ln-9021"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9022"></a>            <span class="k">CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-9023"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">/=</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9024"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">PMonth</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PDay</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9025"></a><span class="k">                </span><span class="n">EPWDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9026"></a>              <span class="k">ELSE</span>
<a name="ln-9027"></a><span class="k">                </span><span class="n">EPWDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9028"></a>                <span class="n">EPWDST</span><span class="p">%</span><span class="n">StDateType</span><span class="o">=</span><span class="n">DateType</span>
<a name="ln-9029"></a>                <span class="n">EPWDST</span><span class="p">%</span><span class="n">StMon</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-9030"></a>                <span class="n">EPWDST</span><span class="p">%</span><span class="n">StDay</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-9031"></a>                <span class="n">EPWDST</span><span class="p">%</span><span class="n">STWeekDay</span><span class="o">=</span><span class="n">PWeekDay</span>
<a name="ln-9032"></a>              <span class="n">ENDIF</span>
<a name="ln-9033"></a>            <span class="k">ELSE</span>
<a name="ln-9034"></a><span class="k">              </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="n">errflag1</span>
<a name="ln-9035"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ProcessEPWHeader: Invalid Daylight Saving Period Start Date Field(WeatherFile)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9036"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9037"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...invalid header=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">HeaderString</span><span class="p">))</span>
<a name="ln-9038"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting Weather File DST to false.&#39;</span><span class="p">)</span>
<a name="ln-9039"></a>              <span class="n">EPWDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9040"></a>            <span class="n">ENDIF</span>
<a name="ln-9041"></a>
<a name="ln-9042"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-9043"></a>            <span class="k">CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-9044"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">EPWDaylightSaving</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9045"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">/=</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9046"></a><span class="k">                </span><span class="n">EPWDST</span><span class="p">%</span><span class="n">EnDateType</span><span class="o">=</span><span class="n">DateType</span>
<a name="ln-9047"></a>                <span class="n">EPWDST</span><span class="p">%</span><span class="n">EnMon</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-9048"></a>                <span class="n">EPWDST</span><span class="p">%</span><span class="n">EnDay</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-9049"></a>                <span class="n">EPWDST</span><span class="p">%</span><span class="n">EnWeekDay</span><span class="o">=</span><span class="n">PWeekDay</span>
<a name="ln-9050"></a>              <span class="k">ELSE</span>
<a name="ln-9051"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ProcessEPWHeader: Invalid Daylight Saving Period End Date Field(WeatherFile)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9052"></a>                                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9053"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Setting Weather File DST to false.&#39;</span><span class="p">)</span>
<a name="ln-9054"></a>                <span class="n">EPWDaylightSaving</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9055"></a>              <span class="n">ENDIF</span>
<a name="ln-9056"></a>              <span class="n">DST</span><span class="o">=</span><span class="n">EPWDST</span>
<a name="ln-9057"></a>            <span class="n">ENDIF</span>
<a name="ln-9058"></a>
<a name="ln-9059"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-9060"></a>            <span class="n">NumEPWHolidays</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-9061"></a>            <span class="n">NumSpecialDays</span><span class="o">=</span><span class="n">NumEPWHolidays</span><span class="o">+</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;RunPeriodControl:SpecialDays&#39;</span><span class="p">)</span>
<a name="ln-9062"></a>            <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">NumSpecialDays</span><span class="p">))</span>
<a name="ln-9063"></a>            <span class="n">NumHdArgs</span><span class="o">=</span><span class="mi">4</span><span class="o">+</span><span class="n">NumEPWHolidays</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-9064"></a>            <span class="n">CurCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9065"></a>
<a name="ln-9066"></a>          <span class="k">CASE</span><span class="p">(</span><span class="mi">5</span><span class="p">:)</span>
<a name="ln-9067"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="nb">Count</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9068"></a><span class="k">            </span><span class="n">CurCount</span><span class="o">=</span><span class="n">CurCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9069"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CurCount</span> <span class="o">&gt;</span> <span class="n">NumSpecialDays</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9070"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Too many SpecialDays&#39;</span><span class="p">)</span>
<a name="ln-9071"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9072"></a>            <span class="k">ELSE</span>
<a name="ln-9073"></a><span class="k">              </span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9074"></a>            <span class="n">ENDIF</span>
<a name="ln-9075"></a>            <span class="c">! Process name</span>
<a name="ln-9076"></a>          <span class="k">ELSE</span>
<a name="ln-9077"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurCount</span> <span class="o">&lt;=</span> <span class="n">NumSpecialDays</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9078"></a>            <span class="c">! Process date</span>
<a name="ln-9079"></a>              <span class="k">CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-9080"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">==</span> <span class="n">MonthDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9081"></a><span class="k">                </span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DateType</span><span class="o">=</span><span class="n">DateType</span>
<a name="ln-9082"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Month</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-9083"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Day</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-9084"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9085"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">CompDate</span><span class="o">=</span><span class="n">Pmonth</span><span class="o">*</span><span class="mi">32</span><span class="o">+</span><span class="n">Pday</span>
<a name="ln-9086"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Duration</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9087"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DayType</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9088"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">WthrFile</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9089"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">/=</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9090"></a><span class="k">                </span><span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DateType</span><span class="o">=</span><span class="n">DateType</span>
<a name="ln-9091"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Month</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-9092"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Day</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-9093"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">=</span><span class="n">PWeekDay</span>
<a name="ln-9094"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">CompDate</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9095"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Duration</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9096"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DayType</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9097"></a>                <span class="n">SpecialDays</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">WthrFile</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9098"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">==</span> <span class="n">InvalidDate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9099"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid SpecialDay Date Field(WeatherFile)=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9100"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9101"></a>              <span class="n">ENDIF</span>
<a name="ln-9102"></a>            <span class="n">ENDIF</span>
<a name="ln-9103"></a>          <span class="n">ENDIF</span>
<a name="ln-9104"></a>        <span class="k">END SELECT</span>
<a name="ln-9105"></a><span class="k">        </span><span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-9106"></a>        <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9107"></a>      <span class="n">ENDDO</span>
<a name="ln-9108"></a>      <span class="k">DO </span><span class="nb">Count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumEPWTypExtSets</span>
<a name="ln-9109"></a>        <span class="c">! JulianDay (Month,Day,LeapYearValue)</span>
<a name="ln-9110"></a>        <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9111"></a>                                                         <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9112"></a>        <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9113"></a>                                                         <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9114"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span> <span class="o">&lt;=</span> <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9115"></a><span class="k">          </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">-</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9116"></a>        <span class="k">ELSE</span>
<a name="ln-9117"></a><span class="k">          </span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span><span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-9118"></a>                            <span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">TypicalExtremePeriods</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">EndJDay</span>
<a name="ln-9119"></a>        <span class="n">ENDIF</span>
<a name="ln-9120"></a>      <span class="n">ENDDO</span>
<a name="ln-9121"></a>
<a name="ln-9122"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COMMENTS 1&#39;</span><span class="p">,</span><span class="s1">&#39;COMMENTS 2&#39;</span><span class="p">)</span>
<a name="ln-9123"></a>
<a name="ln-9124"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DATA PERIODS&#39;</span><span class="p">)</span>
<a name="ln-9125"></a><span class="c">!     N1, \field Number of Data Periods</span>
<a name="ln-9126"></a><span class="c">!     N2, \field Number of Records per hour</span>
<a name="ln-9127"></a><span class="c">!     A1, \field Data Period 1 Name/Description</span>
<a name="ln-9128"></a><span class="c">!     A2, \field Data Period 1 Start Day of Week</span>
<a name="ln-9129"></a><span class="c">!       \type choice</span>
<a name="ln-9130"></a><span class="c">!       \key  Sunday</span>
<a name="ln-9131"></a><span class="c">!       \key  Monday</span>
<a name="ln-9132"></a><span class="c">!       \key  Tuesday</span>
<a name="ln-9133"></a><span class="c">!       \key  Wednesday</span>
<a name="ln-9134"></a><span class="c">!       \key  Thursday</span>
<a name="ln-9135"></a><span class="c">!       \key  Friday</span>
<a name="ln-9136"></a><span class="c">!       \key  Saturday</span>
<a name="ln-9137"></a><span class="c">!     A3, \field Data Period 1 Start Day</span>
<a name="ln-9138"></a><span class="c">!     A4, \field Data Period 1 End Day</span>
<a name="ln-9139"></a>      <span class="n">Line</span><span class="o">=</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9140"></a>      <span class="n">NumHdArgs</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-9141"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9142"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">&lt;=</span> <span class="n">NumHdArgs</span><span class="p">)</span>
<a name="ln-9143"></a>        <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9144"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-9145"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9146"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9147"></a><span class="k">            DO WHILE</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-9148"></a>              <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">AFormat</span><span class="p">)</span> <span class="n">Line</span>
<a name="ln-9149"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">StripCR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9150"></a><span class="k">                </span><span class="n">endcol</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9151"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">endcol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9152"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">))</span> <span class="o">==</span> <span class="n">iASCII_CR</span><span class="p">)</span> <span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-9153"></a>                <span class="n">ENDIF</span>
<a name="ln-9154"></a>              <span class="n">ENDIF</span>
<a name="ln-9155"></a>              <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9156"></a>              <span class="n">Line</span><span class="o">=</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9157"></a>              <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-9158"></a>            <span class="n">ENDDO</span>
<a name="ln-9159"></a>          <span class="k">ELSE</span>
<a name="ln-9160"></a><span class="k">            </span><span class="n">Pos</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9161"></a>          <span class="n">ENDIF</span>
<a name="ln-9162"></a>        <span class="n">ENDIF</span>
<a name="ln-9163"></a>
<a name="ln-9164"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">Count</span><span class="p">)</span>
<a name="ln-9165"></a>
<a name="ln-9166"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9167"></a>          <span class="n">NumDataPeriods</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-9168"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">NumDataPeriods</span><span class="p">))</span>
<a name="ln-9169"></a>          <span class="n">NumHdArgs</span><span class="o">=</span><span class="n">NumHdArgs</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">NumDataPeriods</span>
<a name="ln-9170"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NumDataPeriods</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9171"></a><span class="k">            </span><span class="n">DataPeriods</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumDataPeriods</span><span class="p">)%</span><span class="n">NumDays</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9172"></a>          <span class="n">ENDIF</span>
<a name="ln-9173"></a>          <span class="n">CurCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9174"></a>
<a name="ln-9175"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9176"></a>          <span class="n">NumIntervalsPerHour</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-9177"></a><span class="c">!          IF (NumIntervalsPerHour /= 1) THEN</span>
<a name="ln-9178"></a><span class="c">!            CALL ShowSevereError(&#39;Process EPW: Not ready for more than one interval per hour&#39;)</span>
<a name="ln-9179"></a><span class="c">!            ErrorsFound=.true.</span>
<a name="ln-9180"></a><span class="c">!          ENDIF</span>
<a name="ln-9181"></a>
<a name="ln-9182"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">:)</span>
<a name="ln-9183"></a>          <span class="n">CurOne</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="nb">Count</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-9184"></a>
<a name="ln-9185"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">CurOne</span><span class="p">)</span>
<a name="ln-9186"></a>
<a name="ln-9187"></a>            <span class="k">CASE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-9188"></a>              <span class="c">! Description of Data Period</span>
<a name="ln-9189"></a>              <span class="n">CurCount</span><span class="o">=</span><span class="n">CurCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9190"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">CurCount</span> <span class="o">&gt;</span> <span class="n">NumDataPeriods</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9191"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Too many data periods&#39;</span><span class="p">)</span>
<a name="ln-9192"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9193"></a>              <span class="k">ELSE</span>
<a name="ln-9194"></a><span class="k">                </span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9195"></a>              <span class="n">ENDIF</span>
<a name="ln-9196"></a>
<a name="ln-9197"></a>            <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9198"></a>              <span class="c">! Start Day of Week</span>
<a name="ln-9199"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">CurCount</span> <span class="o">&lt;=</span> <span class="n">NumDataPeriods</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9200"></a><span class="k">                </span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9201"></a>                <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">WeekDay</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="n">DaysOfWeek</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-9202"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">WeekDay</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9203"></a><span class="k">                  WRITE</span><span class="p">(</span><span class="n">ErrNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">CurCount</span>
<a name="ln-9204"></a>                  <span class="n">ErrNum</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrNum</span><span class="p">)</span>
<a name="ln-9205"></a>                  <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Weather File -- Invalid Start Day of Week for Data Period #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ErrNum</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9206"></a>                                       <span class="s1">&#39;, Invalid day=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="p">))</span>
<a name="ln-9207"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9208"></a>                <span class="n">ENDIF</span>
<a name="ln-9209"></a>              <span class="n">ENDIF</span>
<a name="ln-9210"></a>
<a name="ln-9211"></a>            <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9212"></a>              <span class="c">! DataPeriod Start Day</span>
<a name="ln-9213"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">CurCount</span> <span class="o">&lt;=</span> <span class="n">NumDataPeriods</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9214"></a><span class="k">                CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">PYear</span><span class="p">)</span>
<a name="ln-9215"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">==</span> <span class="n">MonthDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9216"></a><span class="k">                  </span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StMon</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-9217"></a>                  <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StDay</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-9218"></a>                  <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StYear</span><span class="o">=</span><span class="n">PYear</span>
<a name="ln-9219"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">PYear</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">HasYearData</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9220"></a>                <span class="k">ELSE</span>
<a name="ln-9221"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Data Periods must be of the form &lt;DayOfYear&gt; or &lt;Month Day&gt; (WeatherFile), found=&#39;</span>  <span class="p">&amp;</span>
<a name="ln-9222"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9223"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9224"></a>                <span class="n">ENDIF</span>
<a name="ln-9225"></a>              <span class="n">ENDIF</span>
<a name="ln-9226"></a>
<a name="ln-9227"></a>            <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-9228"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">CurCount</span> <span class="o">&lt;=</span> <span class="n">NumDataPeriods</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9229"></a><span class="k">                CALL </span><span class="n">ProcessDateString</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">PMonth</span><span class="p">,</span><span class="n">PDay</span><span class="p">,</span><span class="n">PWeekDay</span><span class="p">,</span><span class="n">DateType</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">PYear</span><span class="p">)</span>
<a name="ln-9230"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DateType</span> <span class="o">==</span> <span class="n">MonthDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9231"></a><span class="k">                  </span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnMon</span><span class="o">=</span><span class="n">PMonth</span>
<a name="ln-9232"></a>                  <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnDay</span><span class="o">=</span><span class="n">PDay</span>
<a name="ln-9233"></a>                  <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnYear</span><span class="o">=</span><span class="n">PYear</span>
<a name="ln-9234"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">PYear</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">HasYearData</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9235"></a><span class="k">                    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Data Period (WeatherFile) - Start Date contains year. End Date does not.&#39;</span><span class="p">)</span>
<a name="ln-9236"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Assuming same year as Start Date for this data.&#39;</span><span class="p">)</span>
<a name="ln-9237"></a>                    <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnYear</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StYear</span>
<a name="ln-9238"></a>                  <span class="n">ENDIF</span>
<a name="ln-9239"></a>                <span class="k">ELSE</span>
<a name="ln-9240"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Data Periods must be of the form &lt;DayOfYear&gt; or &lt;Month Day&gt;, (WeatherFile) found=&#39;</span>  <span class="p">&amp;</span>
<a name="ln-9241"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9242"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9243"></a>                <span class="n">ENDIF</span>
<a name="ln-9244"></a>              <span class="n">ENDIF</span>
<a name="ln-9245"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StYear</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnYear</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9246"></a><span class="k">                </span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataStJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9247"></a>                <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataEnJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9248"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataStJDay</span> <span class="o">&lt;=</span> <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataEnJDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9249"></a><span class="k">                  </span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">NumDays</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataEnJDay</span><span class="o">-</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataStJDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9250"></a>                <span class="k">ELSE</span>
<a name="ln-9251"></a><span class="k">                  </span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">NumDays</span><span class="o">=</span><span class="p">(</span><span class="mi">365</span><span class="o">-</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataStJDay</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataEnJDay</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9252"></a>                <span class="n">ENDIF</span>
<a name="ln-9253"></a>              <span class="k">ELSE</span>  <span class="c">! weather file has actual year(s)</span>
<a name="ln-9254"></a>                <span class="k">CALL </span><span class="n">jgDate</span><span class="p">(</span><span class="n">GregorianToJulian</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataStJDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9255"></a>                   <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StYear</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StDay</span><span class="p">)</span>
<a name="ln-9256"></a>                <span class="k">CALL </span><span class="n">jgDate</span><span class="p">(</span><span class="n">GregorianToJulian</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataEnJDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9257"></a>                   <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnYear</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">EnDay</span><span class="p">)</span>
<a name="ln-9258"></a>                <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">NumDays</span><span class="o">=</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataEnJDay</span><span class="o">-</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">DataStJDay</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9259"></a>              <span class="n">ENDIF</span>
<a name="ln-9260"></a>              <span class="c">! Have processed the last item for this, can set up Weekdays for months</span>
<a name="ln-9261"></a>              <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9262"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9263"></a><span class="k">                CALL </span><span class="n">SetupWeekDaysByMonth</span><span class="p">(</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StMon</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">StDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9264"></a>                                          <span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">WeekDay</span><span class="p">,</span><span class="n">DataPeriods</span><span class="p">(</span><span class="n">CurCount</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="p">)</span>
<a name="ln-9265"></a>              <span class="n">ENDIF</span>
<a name="ln-9266"></a>
<a name="ln-9267"></a>          <span class="k">END SELECT</span>
<a name="ln-9268"></a><span class="k">        END SELECT</span>
<a name="ln-9269"></a><span class="k">        </span><span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-9270"></a>        <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9271"></a>       <span class="n">ENDDO</span>
<a name="ln-9272"></a>
<a name="ln-9273"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-9274"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Invalid EPW Header designation found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeaderString</span><span class="p">))</span>
<a name="ln-9275"></a>
<a name="ln-9276"></a>  <span class="k">END SELECT</span>
<a name="ln-9277"></a><span class="k">  RETURN</span>
<a name="ln-9278"></a>
<a name="ln-9279"></a><span class="k">END SUBROUTINE </span><span class="n">ProcessEPWHeader</span>
<a name="ln-9280"></a>
<a name="ln-9281"></a>
<a name="ln-9282"></a><span class="k">SUBROUTINE </span><span class="n">SkipEPlusWFHeader</span>
<a name="ln-9283"></a>
<a name="ln-9284"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9285"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-9286"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-9287"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9288"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9289"></a>
<a name="ln-9290"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9291"></a>          <span class="c">! This subroutine skips the initial header records on the EnergyPlus Weather File (in.epw).</span>
<a name="ln-9292"></a>
<a name="ln-9293"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9294"></a>          <span class="c">! List directed reads, as possible.</span>
<a name="ln-9295"></a>
<a name="ln-9296"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9297"></a>          <span class="c">! na</span>
<a name="ln-9298"></a>
<a name="ln-9299"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9300"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MakeUPPERCase</span><span class="p">,</span> <span class="n">ProcessNumber</span>
<a name="ln-9301"></a>
<a name="ln-9302"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9303"></a>
<a name="ln-9304"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9305"></a>          <span class="c">! na</span>
<a name="ln-9306"></a>
<a name="ln-9307"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9308"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AFormat</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-9309"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Header</span><span class="o">=</span><span class="s2">&quot;DATA PERIODS&quot;</span>
<a name="ln-9310"></a>
<a name="ln-9311"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9312"></a>          <span class="c">! na</span>
<a name="ln-9313"></a>
<a name="ln-9314"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9315"></a>          <span class="c">! na</span>
<a name="ln-9316"></a>
<a name="ln-9317"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9318"></a>  <span class="kt">INTEGER </span><span class="n">Pos</span>
<a name="ln-9319"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span> <span class="n">Line</span>
<a name="ln-9320"></a>  <span class="kt">integer </span><span class="n">HdPos</span>
<a name="ln-9321"></a>  <span class="kt">logical </span><span class="n">StillLooking</span>
<a name="ln-9322"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">FindNonSpace</span>
<a name="ln-9323"></a>  <span class="kt">INTEGER </span><span class="n">NumHdArgs</span>
<a name="ln-9324"></a>  <span class="kt">INTEGER </span><span class="nb">Count</span>
<a name="ln-9325"></a><span class="nb">  </span><span class="kt">INTEGER </span><span class="n">CurCount</span>
<a name="ln-9326"></a>  <span class="kt">INTEGER </span><span class="n">CurOne</span>
<a name="ln-9327"></a>  <span class="kt">INTEGER </span><span class="n">NumPeriods</span>
<a name="ln-9328"></a>  <span class="kt">LOGICAL </span><span class="n">IOStatus</span>
<a name="ln-9329"></a>  <span class="kt">INTEGER </span><span class="n">endcol</span>
<a name="ln-9330"></a>
<a name="ln-9331"></a>  <span class="c">! Read in Header Information</span>
<a name="ln-9332"></a>
<a name="ln-9333"></a>  <span class="c">! Headers should come in order</span>
<a name="ln-9334"></a>  <span class="n">StillLooking</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9335"></a>  <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">StillLooking</span><span class="p">)</span>
<a name="ln-9336"></a>    <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">AFormat</span><span class="p">,</span><span class="k">END</span><span class="o">=</span><span class="mi">9998</span><span class="p">)</span> <span class="n">line</span>
<a name="ln-9337"></a>    <span class="n">Pos</span><span class="o">=</span><span class="n">FindNonSpace</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-9338"></a>    <span class="n">line</span><span class="o">=</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-9339"></a>    <span class="n">HdPos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Header</span><span class="p">))</span>
<a name="ln-9340"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HdPos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-9341"></a><span class="k">  </span><span class="n">ENDDO</span>
<a name="ln-9342"></a>
<a name="ln-9343"></a><span class="c">! Dummy process Data Periods line</span>
<a name="ln-9344"></a><span class="c">!  &#39;DATA PERIODS&#39;</span>
<a name="ln-9345"></a><span class="c">!     N1, \field Number of Data Periods</span>
<a name="ln-9346"></a><span class="c">!     N2, \field Number of Records per hour</span>
<a name="ln-9347"></a><span class="c">!     A1, \field Data Period 1 Name/Description</span>
<a name="ln-9348"></a><span class="c">!     A2, \field Data Period 1 Start Day of Week</span>
<a name="ln-9349"></a><span class="c">!       \type choice</span>
<a name="ln-9350"></a><span class="c">!       \key  Sunday</span>
<a name="ln-9351"></a><span class="c">!       \key  Monday</span>
<a name="ln-9352"></a><span class="c">!       \key  Tuesday</span>
<a name="ln-9353"></a><span class="c">!       \key  Wednesday</span>
<a name="ln-9354"></a><span class="c">!       \key  Thursday</span>
<a name="ln-9355"></a><span class="c">!       \key  Friday</span>
<a name="ln-9356"></a><span class="c">!       \key  Saturday</span>
<a name="ln-9357"></a><span class="c">!     A3, \field Data Period 1 Start Day</span>
<a name="ln-9358"></a><span class="c">!     A4, \field Data Period 1 End Day</span>
<a name="ln-9359"></a>      <span class="n">NumHdArgs</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-9360"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9361"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">&lt;=</span> <span class="n">NumHdArgs</span><span class="p">)</span>
<a name="ln-9362"></a>        <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9363"></a>        <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-9364"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9365"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9366"></a><span class="k">            DO WHILE</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-9367"></a>              <span class="k">READ</span><span class="p">(</span><span class="n">WeatherFileUnitNumber</span><span class="p">,</span><span class="n">AFormat</span><span class="p">)</span> <span class="n">Line</span>
<a name="ln-9368"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">StripCR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9369"></a><span class="k">                </span><span class="n">endcol</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9370"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">endcol</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9371"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ICHAR</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">))</span> <span class="o">==</span> <span class="n">iASCII_CR</span><span class="p">)</span> <span class="n">Line</span><span class="p">(</span><span class="n">endcol</span><span class="p">:</span><span class="n">endcol</span><span class="p">)</span><span class="o">=</span><span class="n">Blank</span>
<a name="ln-9372"></a>                <span class="n">ENDIF</span>
<a name="ln-9373"></a>              <span class="n">ENDIF</span>
<a name="ln-9374"></a>              <span class="n">Line</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9375"></a>              <span class="n">Line</span><span class="o">=</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
<a name="ln-9376"></a>              <span class="n">Pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">Line</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-9377"></a>            <span class="n">ENDDO</span>
<a name="ln-9378"></a>          <span class="k">ELSE</span>
<a name="ln-9379"></a><span class="k">            </span><span class="n">Pos</span><span class="o">=</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9380"></a>          <span class="n">ENDIF</span>
<a name="ln-9381"></a>        <span class="n">ENDIF</span>
<a name="ln-9382"></a>
<a name="ln-9383"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">Count</span><span class="p">)</span>
<a name="ln-9384"></a>
<a name="ln-9385"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9386"></a>          <span class="n">NumPeriods</span><span class="o">=</span><span class="n">ProcessNumber</span><span class="p">(</span><span class="n">Line</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Pos</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">IOStatus</span><span class="p">)</span>
<a name="ln-9387"></a>          <span class="n">NumHdArgs</span><span class="o">=</span><span class="n">NumHdArgs</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">NumPeriods</span>
<a name="ln-9388"></a>          <span class="n">CurCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9389"></a>
<a name="ln-9390"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9391"></a>
<a name="ln-9392"></a>        <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">:)</span>
<a name="ln-9393"></a>          <span class="n">CurOne</span><span class="o">=</span><span class="nb">MOD</span><span class="p">(</span><span class="nb">Count</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-9394"></a>
<a name="ln-9395"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">CurOne</span><span class="p">)</span>
<a name="ln-9396"></a>
<a name="ln-9397"></a>            <span class="k">CASE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-9398"></a>              <span class="c">! Description of Data Period</span>
<a name="ln-9399"></a>              <span class="n">CurCount</span><span class="o">=</span><span class="n">CurCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9400"></a>
<a name="ln-9401"></a>            <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-9402"></a>
<a name="ln-9403"></a>          <span class="k">END SELECT</span>
<a name="ln-9404"></a><span class="k">        END SELECT</span>
<a name="ln-9405"></a><span class="k">        </span><span class="n">Line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">Pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-9406"></a>        <span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9407"></a>       <span class="n">ENDDO</span>
<a name="ln-9408"></a>
<a name="ln-9409"></a>  <span class="k">RETURN</span>
<a name="ln-9410"></a>
<a name="ln-9411"></a><span class="k">  </span><span class="mi">9998</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Unexpected End-of-File on EPW Weather file, while reading header information, looking for header=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9412"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">Header</span><span class="p">),</span><span class="n">OutputFileStandard</span><span class="p">)</span>
<a name="ln-9413"></a>
<a name="ln-9414"></a>  <span class="k">RETURN</span>
<a name="ln-9415"></a>
<a name="ln-9416"></a><span class="k">END SUBROUTINE </span><span class="n">SkipEPlusWFHeader</span>
<a name="ln-9417"></a>
<a name="ln-9418"></a><span class="k">SUBROUTINE </span><span class="n">ReportMissing_RangeData</span>
<a name="ln-9419"></a>
<a name="ln-9420"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9421"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-9422"></a>          <span class="c">!       DATE WRITTEN   January 2002</span>
<a name="ln-9423"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9424"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9425"></a>
<a name="ln-9426"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9427"></a>          <span class="c">! This subroutine reports the counts of missing/out of range data</span>
<a name="ln-9428"></a>          <span class="c">! for weather file environments.</span>
<a name="ln-9429"></a>
<a name="ln-9430"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9431"></a>          <span class="c">! na</span>
<a name="ln-9432"></a>
<a name="ln-9433"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9434"></a>          <span class="c">! na</span>
<a name="ln-9435"></a>
<a name="ln-9436"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9437"></a>          <span class="c">! na</span>
<a name="ln-9438"></a>
<a name="ln-9439"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9440"></a>
<a name="ln-9441"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9442"></a>          <span class="c">! na</span>
<a name="ln-9443"></a>
<a name="ln-9444"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9445"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MissString</span><span class="o">=</span><span class="s1">&#39;Missing Data Found on Weather Data File&#39;</span>
<a name="ln-9446"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">msFmt</span><span class="o">=</span><span class="s2">&quot;(&#39;Missing &#39;,A,&#39;, Number of items=&#39;,I5)&quot;</span>
<a name="ln-9447"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InvString</span><span class="o">=</span><span class="s1">&#39;Invalid Data Found on Weather Data File&#39;</span>
<a name="ln-9448"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ivFmt</span><span class="o">=</span><span class="s2">&quot;(&#39;Invalid &#39;,A,&#39;, Number of items=&#39;,I5)&quot;</span>
<a name="ln-9449"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RangeString</span><span class="o">=</span><span class="s1">&#39;Out of Range Data Found on Weather Data File&#39;</span>
<a name="ln-9450"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">rgFmt</span><span class="o">=</span><span class="s2">&quot;(&#39;Out of Range &#39;,A,&#39; [&#39;,A,&#39;,&#39;,A,&#39;], Number of items=&#39;,I5)&quot;</span>
<a name="ln-9451"></a>
<a name="ln-9452"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9453"></a>          <span class="c">! na</span>
<a name="ln-9454"></a>
<a name="ln-9455"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9456"></a>          <span class="c">! na</span>
<a name="ln-9457"></a>
<a name="ln-9458"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9459"></a>  <span class="kt">LOGICAL </span><span class="n">MissedHeader</span>
<a name="ln-9460"></a>  <span class="kt">LOGICAL </span><span class="n">OutOfRangeHeader</span>
<a name="ln-9461"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span> <span class="n">ErrString</span>
<a name="ln-9462"></a>
<a name="ln-9463"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayWeatherMissingDataWarnings</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-9464"></a>
<a name="ln-9465"></a><span class="k">  </span><span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9466"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">DryBulb</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9467"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9468"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9469"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9470"></a>    <span class="n">ENDIF</span>
<a name="ln-9471"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Dry Bulb Temperatures&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">DryBulb</span>
<a name="ln-9472"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9473"></a>  <span class="n">ENDIF</span>
<a name="ln-9474"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">StnPres</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9475"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9476"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9477"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9478"></a>    <span class="n">ENDIF</span>
<a name="ln-9479"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Atmospheric Pressure&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">StnPres</span>
<a name="ln-9480"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9481"></a>  <span class="n">ENDIF</span>
<a name="ln-9482"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">RelHumid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9483"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9484"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9485"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9486"></a>    <span class="n">ENDIF</span>
<a name="ln-9487"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Relative Humidity&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">RelHumid</span>
<a name="ln-9488"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9489"></a>  <span class="n">ENDIF</span>
<a name="ln-9490"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">DewPoint</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9491"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9492"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9493"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9494"></a>    <span class="n">ENDIF</span>
<a name="ln-9495"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Dew Point Temperatures&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">DewPoint</span>
<a name="ln-9496"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9497"></a>  <span class="n">ENDIF</span>
<a name="ln-9498"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">WindSpd</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9499"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9500"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9501"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9502"></a>    <span class="n">ENDIF</span>
<a name="ln-9503"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Wind Speed&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">WindSpd</span>
<a name="ln-9504"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9505"></a>  <span class="n">ENDIF</span>
<a name="ln-9506"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">WindDir</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9507"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9508"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9509"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9510"></a>    <span class="n">ENDIF</span>
<a name="ln-9511"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Wind Direction&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">WindDir</span>
<a name="ln-9512"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9513"></a>  <span class="n">ENDIF</span>
<a name="ln-9514"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">DirectRad</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9515"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9516"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9517"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9518"></a>    <span class="n">ENDIF</span>
<a name="ln-9519"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Direct Radiation&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">DirectRad</span>
<a name="ln-9520"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9521"></a>  <span class="n">ENDIF</span>
<a name="ln-9522"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">DiffuseRad</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9523"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9524"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9525"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9526"></a>    <span class="n">ENDIF</span>
<a name="ln-9527"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Diffuse Radiation&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">DiffuseRad</span>
<a name="ln-9528"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9529"></a>  <span class="n">ENDIF</span>
<a name="ln-9530"></a><span class="c">!  IF (Missed%Visibility&gt;0) THEN</span>
<a name="ln-9531"></a><span class="c">!    IF (.not. MissedHeader) THEN</span>
<a name="ln-9532"></a><span class="c">!      CALL ShowWarningError(MissString)</span>
<a name="ln-9533"></a><span class="c">!      MissedHeader=.true.</span>
<a name="ln-9534"></a><span class="c">!    ENDIF</span>
<a name="ln-9535"></a><span class="c">!    WRITE(ErrString,msFMT) &#39;Visibility&#39;,Missed%Visibility</span>
<a name="ln-9536"></a><span class="c">!    CALL ShowMessage(ErrString)</span>
<a name="ln-9537"></a><span class="c">!  ENDIF</span>
<a name="ln-9538"></a><span class="c">!  IF (Missed%AerOptDepth&gt;0) THEN</span>
<a name="ln-9539"></a><span class="c">!    IF (.not. MissedHeader) THEN</span>
<a name="ln-9540"></a><span class="c">!      CALL ShowWarningError(MissString)</span>
<a name="ln-9541"></a><span class="c">!      MissedHeader=.true.</span>
<a name="ln-9542"></a><span class="c">!    ENDIF</span>
<a name="ln-9543"></a><span class="c">!    WRITE(ErrString,msFMT) &#39;Aerosol Optical Depth&#39;,Missed%AerOptDepth</span>
<a name="ln-9544"></a><span class="c">!    CALL ShowMessage(ErrString)</span>
<a name="ln-9545"></a><span class="c">!  ENDIF</span>
<a name="ln-9546"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">TotSkyCvr</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9547"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9548"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9549"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9550"></a>    <span class="n">ENDIF</span>
<a name="ln-9551"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Total Sky Cover&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">TotSkyCvr</span>
<a name="ln-9552"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9553"></a>  <span class="n">ENDIF</span>
<a name="ln-9554"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">OpaqSkyCvr</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9555"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9556"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9557"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9558"></a>    <span class="n">ENDIF</span>
<a name="ln-9559"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Opaque Sky Cover&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">OpaqSkyCvr</span>
<a name="ln-9560"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9561"></a>  <span class="n">ENDIF</span>
<a name="ln-9562"></a><span class="c">!  IF (Missed%Ceiling&gt;0) THEN</span>
<a name="ln-9563"></a><span class="c">!    IF (.not. MissedHeader) THEN</span>
<a name="ln-9564"></a><span class="c">!      CALL ShowWarningError(MissString)</span>
<a name="ln-9565"></a><span class="c">!      MissedHeader=.true.</span>
<a name="ln-9566"></a><span class="c">!    ENDIF</span>
<a name="ln-9567"></a><span class="c">!    WRITE(ErrString,msFMT) &#39;Ceiling Height&#39;,Missed%Ceiling</span>
<a name="ln-9568"></a><span class="c">!    CALL ShowMessage(ErrString)</span>
<a name="ln-9569"></a><span class="c">!  ENDIF</span>
<a name="ln-9570"></a><span class="c">!  IF (Missed%PrecipWater&gt;0) THEN</span>
<a name="ln-9571"></a><span class="c">!    IF (.not. MissedHeader) THEN</span>
<a name="ln-9572"></a><span class="c">!      CALL ShowWarningError(MissString)</span>
<a name="ln-9573"></a><span class="c">!      MissedHeader=.true.</span>
<a name="ln-9574"></a><span class="c">!    ENDIF</span>
<a name="ln-9575"></a><span class="c">!    WRITE(ErrString,msFMT) &#39;Water Precipitation&#39;,Missed%PrecipWater</span>
<a name="ln-9576"></a><span class="c">!    CALL ShowMessage(ErrString)</span>
<a name="ln-9577"></a><span class="c">!  ENDIF</span>
<a name="ln-9578"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">SnowDepth</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9579"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9580"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9581"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9582"></a>    <span class="n">ENDIF</span>
<a name="ln-9583"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Snow Depth&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">SnowDepth</span>
<a name="ln-9584"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9585"></a>  <span class="n">ENDIF</span>
<a name="ln-9586"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">WeathCodes</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9587"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">InvString</span><span class="p">)</span>
<a name="ln-9588"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">ivFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Weather Codes&quot; (not equal 9 digits)&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">WeathCodes</span>
<a name="ln-9589"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9590"></a>  <span class="n">ENDIF</span>
<a name="ln-9591"></a><span class="c">!  IF (Missed%Albedo&gt;0) THEN</span>
<a name="ln-9592"></a><span class="c">!    IF (.not. MissedHeader) THEN</span>
<a name="ln-9593"></a><span class="c">!      CALL ShowWarningError(MissString)</span>
<a name="ln-9594"></a><span class="c">!      MissedHeader=.true.</span>
<a name="ln-9595"></a><span class="c">!    ENDIF</span>
<a name="ln-9596"></a><span class="c">!    WRITE(ErrString,msFMT) &#39;&quot;Albedo&quot;&#39;,Missed%Albedo</span>
<a name="ln-9597"></a><span class="c">!    CALL ShowMessage(ErrString)</span>
<a name="ln-9598"></a><span class="c">!  ENDIF</span>
<a name="ln-9599"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Missed</span><span class="p">%</span><span class="n">LiquidPrecip</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9600"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MissedHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9601"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">MissString</span><span class="p">)</span>
<a name="ln-9602"></a>      <span class="n">MissedHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9603"></a>    <span class="n">ENDIF</span>
<a name="ln-9604"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">msFMT</span><span class="p">)</span> <span class="s1">&#39;&quot;Liquid Precipitation Depth&quot;&#39;</span><span class="p">,</span><span class="n">Missed</span><span class="p">%</span><span class="n">LiquidPrecip</span>
<a name="ln-9605"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9606"></a>  <span class="n">ENDIF</span>
<a name="ln-9607"></a><span class="c">!  IF (Missed%DaysLastSnow&gt;0) THEN</span>
<a name="ln-9608"></a><span class="c">!    IF (.not. MissedHeader) THEN</span>
<a name="ln-9609"></a><span class="c">!      CALL ShowWarningError(MissString)</span>
<a name="ln-9610"></a><span class="c">!      MissedHeader=.true.</span>
<a name="ln-9611"></a><span class="c">!    ENDIF</span>
<a name="ln-9612"></a><span class="c">!    WRITE(ErrString,msFMT) &#39;Days Since Last Snow&#39;,Missed%DaysLastSnow</span>
<a name="ln-9613"></a><span class="c">!    CALL ShowMessage(ErrString)</span>
<a name="ln-9614"></a><span class="c">!  ENDIF</span>
<a name="ln-9615"></a>
<a name="ln-9616"></a>  <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9617"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DryBulb</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9618"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9619"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9620"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9621"></a>    <span class="n">ENDIF</span>
<a name="ln-9622"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Dry Bulb Temperatures&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=-90&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=70&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DryBulb</span>
<a name="ln-9623"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9624"></a>  <span class="n">ENDIF</span>
<a name="ln-9625"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">StnPres</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9626"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9627"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9628"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9629"></a>    <span class="n">ENDIF</span>
<a name="ln-9630"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Atmospheric Pressure&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;31000&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=120000&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">StnPres</span>
<a name="ln-9631"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9632"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;Out of Range values set to last good value&#39;</span><span class="p">)</span>
<a name="ln-9633"></a>  <span class="n">ENDIF</span>
<a name="ln-9634"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">RelHumid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9635"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9636"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9637"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9638"></a>    <span class="n">ENDIF</span>
<a name="ln-9639"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Relative Humidity&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=0&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=110&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">RelHumid</span>
<a name="ln-9640"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9641"></a>  <span class="n">ENDIF</span>
<a name="ln-9642"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DewPoint</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9643"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9644"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9645"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9646"></a>    <span class="n">ENDIF</span>
<a name="ln-9647"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Dew Point Temperatures&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=-90&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=70&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DewPoint</span>
<a name="ln-9648"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9649"></a>  <span class="n">ENDIF</span>
<a name="ln-9650"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindSpd</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9651"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9652"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9653"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9654"></a>    <span class="n">ENDIF</span>
<a name="ln-9655"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Wind Speed&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=0&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=40&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindSpd</span>
<a name="ln-9656"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9657"></a>  <span class="n">ENDIF</span>
<a name="ln-9658"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindDir</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9659"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9660"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9661"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9662"></a>    <span class="n">ENDIF</span>
<a name="ln-9663"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Wind Direction&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=0&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=360&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">WindDir</span>
<a name="ln-9664"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9665"></a>  <span class="n">ENDIF</span>
<a name="ln-9666"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DirectRad</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9667"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9668"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9669"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9670"></a>    <span class="n">ENDIF</span>
<a name="ln-9671"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Direct Radiation&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=0&#39;</span><span class="p">,</span><span class="s1">&#39;NoLimit&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DirectRad</span>
<a name="ln-9672"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9673"></a>  <span class="n">ENDIF</span>
<a name="ln-9674"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DiffuseRad</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9675"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">OutOfRangeHeader</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9676"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RangeString</span><span class="p">)</span>
<a name="ln-9677"></a>      <span class="n">OutOfRangeHeader</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9678"></a>    <span class="n">ENDIF</span>
<a name="ln-9679"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="n">rgFmt</span><span class="p">)</span> <span class="s1">&#39;Diffuse Radiation&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=0&#39;</span><span class="p">,</span><span class="s1">&#39;NoLimit&#39;</span><span class="p">,</span><span class="n">OutOfRange</span><span class="p">%</span><span class="n">DiffuseRad</span>
<a name="ln-9680"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)</span>
<a name="ln-9681"></a>  <span class="n">ENDIF</span>
<a name="ln-9682"></a>
<a name="ln-9683"></a>  <span class="k">RETURN</span>
<a name="ln-9684"></a>
<a name="ln-9685"></a><span class="k">END SUBROUTINE </span><span class="n">ReportMissing_RangeData</span>
<a name="ln-9686"></a>
<a name="ln-9687"></a><span class="k">SUBROUTINE </span><span class="n">SetupInterpolationValues</span>
<a name="ln-9688"></a>
<a name="ln-9689"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9690"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-9691"></a>          <span class="c">!       DATE WRITTEN   November 2002</span>
<a name="ln-9692"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9693"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9694"></a>
<a name="ln-9695"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9696"></a>          <span class="c">! This subroutine creates the &quot;interpolation&quot; values / weights that are used for</span>
<a name="ln-9697"></a>          <span class="c">! interpolating weather data from hourly down to the time step level.</span>
<a name="ln-9698"></a>
<a name="ln-9699"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9700"></a>          <span class="c">! Create arrays (InterpolationValues, SolarInterpolationValues) dependent on</span>
<a name="ln-9701"></a>          <span class="c">! Number of Time Steps in Hour.  This will be used in the &quot;SetCurrentWeather&quot; procedure.</span>
<a name="ln-9702"></a>
<a name="ln-9703"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9704"></a>          <span class="c">! na</span>
<a name="ln-9705"></a>
<a name="ln-9706"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9707"></a>          <span class="c">! na</span>
<a name="ln-9708"></a>
<a name="ln-9709"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9710"></a>
<a name="ln-9711"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9712"></a>          <span class="c">! na</span>
<a name="ln-9713"></a>
<a name="ln-9714"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9715"></a>          <span class="c">! na</span>
<a name="ln-9716"></a>
<a name="ln-9717"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9718"></a>          <span class="c">! na</span>
<a name="ln-9719"></a>
<a name="ln-9720"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9721"></a>          <span class="c">! na</span>
<a name="ln-9722"></a>
<a name="ln-9723"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9724"></a>  <span class="kt">INTEGER </span><span class="n">halfpoint</span>
<a name="ln-9725"></a>  <span class="kt">INTEGER </span><span class="n">hpoint</span>
<a name="ln-9726"></a>  <span class="kt">INTEGER </span><span class="n">tloop</span>
<a name="ln-9727"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">tweight</span>
<a name="ln-9728"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">tweight1</span>
<a name="ln-9729"></a>
<a name="ln-9730"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Interpolation</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-9731"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-9732"></a>  <span class="n">Interpolation</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9733"></a>  <span class="n">SolarInterpolation</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9734"></a>  <span class="n">halfpoint</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9735"></a>
<a name="ln-9736"></a>  <span class="k">do </span><span class="n">tloop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-9737"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9738"></a><span class="k">      </span><span class="n">tweight</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-9739"></a>    <span class="k">ELSE</span>
<a name="ln-9740"></a><span class="k">      </span><span class="n">tweight</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">tloop</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)))</span>
<a name="ln-9741"></a>    <span class="k">END IF</span>
<a name="ln-9742"></a>
<a name="ln-9743"></a><span class="k">    </span><span class="n">Interpolation</span><span class="p">(</span><span class="n">tloop</span><span class="p">)</span><span class="o">=</span><span class="n">tweight</span>
<a name="ln-9744"></a>
<a name="ln-9745"></a>  <span class="n">enddo</span>
<a name="ln-9746"></a>
<a name="ln-9747"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9748"></a>    <span class="c">! even number of time steps.</span>
<a name="ln-9749"></a>    <span class="n">halfpoint</span><span class="o">=</span><span class="n">NumOfTimeStepInHour</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-9750"></a>    <span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">halfpoint</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-9751"></a>    <span class="n">tweight</span><span class="o">=</span><span class="mf">1.d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9752"></a>    <span class="n">hpoint</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9753"></a>    <span class="k">do </span><span class="n">tloop</span><span class="o">=</span><span class="n">halfpoint</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-9754"></a>      <span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">tloop</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="n">hpoint</span><span class="o">*</span><span class="n">tweight</span>
<a name="ln-9755"></a>      <span class="n">hpoint</span><span class="o">=</span><span class="n">hpoint</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9756"></a>    <span class="n">enddo</span>
<a name="ln-9757"></a>    <span class="n">hpoint</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9758"></a>    <span class="k">do </span><span class="n">tloop</span><span class="o">=</span><span class="n">halfpoint</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-9759"></a>      <span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">tloop</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="n">hpoint</span><span class="o">*</span><span class="n">tweight</span>
<a name="ln-9760"></a>      <span class="n">hpoint</span><span class="o">=</span><span class="n">hpoint</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9761"></a>    <span class="n">enddo</span>
<a name="ln-9762"></a>  <span class="k">else</span>  <span class="c">! odd number of time steps</span>
<a name="ln-9763"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9764"></a><span class="k">      </span><span class="n">SolarInterpolation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="n">d0</span>
<a name="ln-9765"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9766"></a><span class="k">      </span><span class="n">tweight</span><span class="o">=</span><span class="mf">1.d0</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9767"></a>      <span class="n">SolarInterpolation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">5.0d0</span><span class="o">/</span><span class="mf">6.0d0</span>
<a name="ln-9768"></a>      <span class="n">SolarInterpolation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">5.0d0</span><span class="o">/</span><span class="mf">6.0d0</span>
<a name="ln-9769"></a>      <span class="n">SolarInterpolation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="n">d0</span>
<a name="ln-9770"></a>    <span class="k">else</span>
<a name="ln-9771"></a><span class="k">      </span><span class="n">tweight</span><span class="o">=</span><span class="mf">1.d0</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9772"></a>      <span class="n">halfpoint</span><span class="o">=</span><span class="n">NumOfTimeStepInHour</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-9773"></a>      <span class="n">tweight1</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">tweight</span><span class="o">/</span><span class="mf">2.d0</span>
<a name="ln-9774"></a>      <span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">halfpoint</span><span class="p">)</span><span class="o">=</span><span class="n">tweight1</span>
<a name="ln-9775"></a>      <span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">halfpoint</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">tweight1</span>
<a name="ln-9776"></a>      <span class="n">hpoint</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9777"></a>      <span class="k">do </span><span class="n">tloop</span><span class="o">=</span><span class="n">halfpoint</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-9778"></a>        <span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">tloop</span><span class="p">)</span><span class="o">=</span><span class="n">tweight1</span><span class="o">-</span><span class="n">hpoint</span><span class="o">*</span><span class="n">tweight</span>
<a name="ln-9779"></a>        <span class="n">hpoint</span><span class="o">=</span><span class="n">hpoint</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9780"></a>      <span class="n">enddo</span>
<a name="ln-9781"></a>      <span class="n">hpoint</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9782"></a>      <span class="k">do </span><span class="n">tloop</span><span class="o">=</span><span class="n">halfpoint</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-9783"></a>        <span class="n">SolarInterpolation</span><span class="p">(</span><span class="n">tloop</span><span class="p">)</span><span class="o">=</span><span class="n">tweight1</span><span class="o">-</span><span class="n">hpoint</span><span class="o">*</span><span class="n">tweight</span>
<a name="ln-9784"></a>        <span class="n">hpoint</span><span class="o">=</span><span class="n">hpoint</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9785"></a>      <span class="n">enddo</span>
<a name="ln-9786"></a>    <span class="n">endif</span>
<a name="ln-9787"></a>  <span class="n">endif</span>
<a name="ln-9788"></a>
<a name="ln-9789"></a>  <span class="k">RETURN</span>
<a name="ln-9790"></a>
<a name="ln-9791"></a><span class="k">END SUBROUTINE </span><span class="n">SetupInterpolationValues</span>
<a name="ln-9792"></a>
<a name="ln-9793"></a><span class="k">SUBROUTINE </span><span class="n">SetupEnvironmentTypes</span>
<a name="ln-9794"></a>
<a name="ln-9795"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9796"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-9797"></a>          <span class="c">!       DATE WRITTEN   October 2010</span>
<a name="ln-9798"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9799"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9800"></a>
<a name="ln-9801"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9802"></a>          <span class="c">! Make sure Environment derived type is set prior to getting</span>
<a name="ln-9803"></a>          <span class="c">! Weather Properties</span>
<a name="ln-9804"></a>
<a name="ln-9805"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9806"></a>          <span class="c">! na</span>
<a name="ln-9807"></a>
<a name="ln-9808"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9809"></a>          <span class="c">! na</span>
<a name="ln-9810"></a>
<a name="ln-9811"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9812"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InvJulianDay</span><span class="p">,</span> <span class="n">JulianDay</span><span class="p">,</span> <span class="n">BetweenDates</span>
<a name="ln-9813"></a>
<a name="ln-9814"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9815"></a>
<a name="ln-9816"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9817"></a>          <span class="c">! na</span>
<a name="ln-9818"></a>
<a name="ln-9819"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9820"></a>          <span class="c">! na</span>
<a name="ln-9821"></a>
<a name="ln-9822"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9823"></a>          <span class="c">! na</span>
<a name="ln-9824"></a>
<a name="ln-9825"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9826"></a>          <span class="c">! na</span>
<a name="ln-9827"></a>
<a name="ln-9828"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9829"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-9830"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop1</span>
<a name="ln-9831"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay1</span>
<a name="ln-9832"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JDay2</span>
<a name="ln-9833"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LocalLeapYearAdd</span>
<a name="ln-9834"></a>
<a name="ln-9835"></a>          <span class="c">! Transfer weather file information to the Environment derived type</span>
<a name="ln-9836"></a>      <span class="n">Envrn</span><span class="o">=</span><span class="n">TotDesDays</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9837"></a>      <span class="c">! Sizing Periods from Weather File</span>
<a name="ln-9838"></a>      <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotRunDesPers</span>
<a name="ln-9839"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span>
<a name="ln-9840"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-9841"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9842"></a>                                                  <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9843"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">TotalDays</span>
<a name="ln-9844"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span>
<a name="ln-9845"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span>
<a name="ln-9846"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9847"></a>                                                <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9848"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-9849"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span> <span class="o">&lt;=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9850"></a><span class="k">          </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-9851"></a>                                        <span class="o">*</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-9852"></a>        <span class="k">ELSE</span>
<a name="ln-9853"></a><span class="k">          </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="p">(</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-9854"></a>                                <span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">)</span> <span class="o">*</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-9855"></a>        <span class="n">ENDIF</span>
<a name="ln-9856"></a>        <span class="n">TotRunDesPersDays</span><span class="o">=</span><span class="n">TotRunDesPersDays</span><span class="o">+</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span>
<a name="ln-9857"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseDST</span>
<a name="ln-9858"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseHolidays</span>
<a name="ln-9859"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-9860"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">cKindOfEnvrn</span> <span class="o">=</span> <span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">PeriodType</span>
<a name="ln-9861"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksRunPeriodDesign</span>
<a name="ln-9862"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span>
<a name="ln-9863"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span>
<a name="ln-9864"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">SetWeekDays</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9865"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span>
<a name="ln-9866"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseRain</span>
<a name="ln-9867"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="n">RunPeriodDesignInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseSnow</span>
<a name="ln-9868"></a>        <span class="n">Envrn</span><span class="o">=</span><span class="n">Envrn</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9869"></a>      <span class="n">ENDDO</span>
<a name="ln-9870"></a>
<a name="ln-9871"></a>      <span class="c">! RunPeriods from weather file</span>
<a name="ln-9872"></a>      <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotRunPers</span>  <span class="c">! Run Periods.</span>
<a name="ln-9873"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span>
<a name="ln-9874"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span>
<a name="ln-9875"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span>
<a name="ln-9876"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span>
<a name="ln-9877"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-9878"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9879"></a><span class="k">          </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartYear</span>
<a name="ln-9880"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span><span class="o">=</span><span class="n">IsLeapYear</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartYear</span><span class="p">)</span>
<a name="ln-9881"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9882"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartYear</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartYear</span>
<a name="ln-9883"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndYear</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndYear</span>
<a name="ln-9884"></a>          <span class="k">CALL </span><span class="n">jgDate</span><span class="p">(</span><span class="n">GregorianToJulian</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9885"></a>             <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartYear</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">)</span>
<a name="ln-9886"></a>          <span class="k">CALL </span><span class="n">jgDate</span><span class="p">(</span><span class="n">GregorianToJulian</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9887"></a>             <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndYear</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">)</span>
<a name="ln-9888"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span>
<a name="ln-9889"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDate</span>
<a name="ln-9890"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDate</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-9891"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RawSimDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndDate</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartDate</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-9892"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MatchYear</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9893"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ActualWeather</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9894"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">BeginYear</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! std RunPeriod</span>
<a name="ln-9895"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9896"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9897"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! explicit set</span>
<a name="ln-9898"></a>            <span class="n">LocalLeapYearAdd</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9899"></a>          <span class="k">ELSE</span>
<a name="ln-9900"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! explicit set</span>
<a name="ln-9901"></a>            <span class="n">LocalLeapYearAdd</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9902"></a>          <span class="n">ENDIF</span>
<a name="ln-9903"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9904"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span>
<a name="ln-9905"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LocalLeapYearAdd</span><span class="p">)</span>
<a name="ln-9906"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LocalLeapYearAdd</span><span class="p">)</span>
<a name="ln-9907"></a>        <span class="c">! need message if isleapyear and wfleapyearind=0</span>
<a name="ln-9908"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span> <span class="o">&lt;=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9909"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RawSimDays</span><span class="o">=</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9910"></a>            <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-9911"></a>                                          <span class="o">*</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-9912"></a>          <span class="k">ELSE</span>
<a name="ln-9913"></a><span class="k">            </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RawSimDays</span><span class="o">=</span><span class="p">(</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9914"></a>                                                    <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">)</span>
<a name="ln-9915"></a>            <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="p">(</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span><span class="o">-</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9916"></a>                                                    <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9917"></a>                                          <span class="o">*</span> <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-9918"></a>          <span class="n">ENDIF</span>
<a name="ln-9919"></a>
<a name="ln-9920"></a>        <span class="k">ELSE</span> <span class="c">! Using Runperiod and StartYear option.</span>
<a name="ln-9921"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">BeginYear</span>
<a name="ln-9922"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">IsLeapYear</span><span class="o">=</span><span class="n">IsLeapYear</span><span class="p">(</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">CurrentYear</span><span class="p">)</span>
<a name="ln-9923"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TreatYearsAsConsecutive</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9924"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">RollDayTypeOnRepeat</span>
<a name="ln-9925"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">StartJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9926"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">EndJDay</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="n">LeapYearAdd</span><span class="p">)</span>
<a name="ln-9927"></a>          <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9928"></a>          <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">NumSimYears</span>
<a name="ln-9929"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsLeapYear</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">BeginYear</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">Loop1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WFAllowsLeapYears</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9930"></a><span class="k">              </span><span class="n">JDay1</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-9931"></a>              <span class="n">JDay2</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-9932"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">JDay1</span> <span class="o">&lt;=</span> <span class="n">JDay2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9933"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9934"></a>                  <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RawSimDays</span><span class="o">=</span><span class="p">(</span><span class="n">JDay2</span><span class="o">-</span><span class="n">Jday1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9935"></a>                <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">+</span><span class="p">(</span><span class="n">JDay2</span><span class="o">-</span><span class="n">Jday1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9936"></a>              <span class="k">ELSE</span>
<a name="ln-9937"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9938"></a>                   <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">RawSimDays</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="n">JDay1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">JDay2</span>
<a name="ln-9939"></a>                <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9940"></a>                   <span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="n">JDay1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">JDay2</span>
<a name="ln-9941"></a>              <span class="n">ENDIF</span>
<a name="ln-9942"></a>            <span class="k">ELSE</span>  <span class="c">! Leap Year</span>
<a name="ln-9943"></a>              <span class="n">JDay1</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">StartDay</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9944"></a>              <span class="n">JDay2</span><span class="o">=</span><span class="n">JulianDay</span><span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndMonth</span><span class="p">,</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">EndDay</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9945"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">JDay1</span> <span class="o">&lt;=</span> <span class="n">JDay2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9946"></a><span class="k">                </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">+</span><span class="p">(</span><span class="n">JDay2</span><span class="o">-</span><span class="n">Jday1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9947"></a>              <span class="k">ELSE</span>
<a name="ln-9948"></a><span class="k">                </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">=</span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">TotalDays</span><span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9949"></a>                   <span class="n">JulianDay</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">JDay1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">JDay2</span>
<a name="ln-9950"></a>              <span class="n">ENDIF</span>
<a name="ln-9951"></a>            <span class="n">ENDIF</span>
<a name="ln-9952"></a>          <span class="n">ENDDO</span>
<a name="ln-9953"></a>        <span class="n">ENDIF</span>
<a name="ln-9954"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseDST</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseDST</span>
<a name="ln-9955"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseHolidays</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseHolidays</span>
<a name="ln-9956"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Title</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9957"></a><span class="k">          </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">WeatherFileLocationTitle</span>
<a name="ln-9958"></a>        <span class="k">ELSE</span>
<a name="ln-9959"></a><span class="k">          </span><span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">Title</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">Title</span>
<a name="ln-9960"></a>        <span class="n">ENDIF</span>
<a name="ln-9961"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">cKindOfEnvrn</span> <span class="o">=</span> <span class="s1">&#39;WeatherFileRunPeriod&#39;</span>
<a name="ln-9962"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">KindOfEnvrn</span> <span class="o">=</span> <span class="n">ksRunPeriodWeather</span>
<a name="ln-9963"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">DayOfWeek</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">DayOfWeek</span>
<a name="ln-9964"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">MonWeekDay</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">MonWeekDay</span>
<a name="ln-9965"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">SetWeekDays</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9966"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ApplyWeekendRule</span>
<a name="ln-9967"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseRain</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseRain</span>
<a name="ln-9968"></a>        <span class="n">Environment</span><span class="p">(</span><span class="n">Envrn</span><span class="p">)%</span><span class="n">UseSnow</span><span class="o">=</span><span class="n">RunPeriodInput</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">UseSnow</span>
<a name="ln-9969"></a>        <span class="n">Envrn</span><span class="o">=</span><span class="n">Envrn</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9970"></a>      <span class="n">ENDDO</span>
<a name="ln-9971"></a>
<a name="ln-9972"></a>  <span class="k">RETURN</span>
<a name="ln-9973"></a>
<a name="ln-9974"></a><span class="k">END SUBROUTINE </span><span class="n">SetupEnvironmentTypes</span>
<a name="ln-9975"></a>
<a name="ln-9976"></a><span class="k">FUNCTION </span><span class="n">IsLeapYear</span><span class="p">(</span><span class="n">Year</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">YesNo</span><span class="p">)</span>
<a name="ln-9977"></a>
<a name="ln-9978"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9979"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-9980"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-9981"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9982"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9983"></a>
<a name="ln-9984"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9985"></a>          <span class="c">! From entered year returns true (Yes) if it&#39;s a leap year, false (no) if not.</span>
<a name="ln-9986"></a>
<a name="ln-9987"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9988"></a>          <span class="c">! na</span>
<a name="ln-9989"></a>
<a name="ln-9990"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9991"></a>          <span class="c">! na</span>
<a name="ln-9992"></a>
<a name="ln-9993"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9994"></a>          <span class="c">! na</span>
<a name="ln-9995"></a>
<a name="ln-9996"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9997"></a>
<a name="ln-9998"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9999"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Year</span>
<a name="ln-10000"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">YesNo</span>
<a name="ln-10001"></a>
<a name="ln-10002"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10003"></a>          <span class="c">! na</span>
<a name="ln-10004"></a>
<a name="ln-10005"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10006"></a>          <span class="c">! na</span>
<a name="ln-10007"></a>
<a name="ln-10008"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10009"></a>          <span class="c">! na</span>
<a name="ln-10010"></a>
<a name="ln-10011"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10012"></a>          <span class="c">! na</span>
<a name="ln-10013"></a>
<a name="ln-10014"></a>    <span class="n">YesNo</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10015"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">Year</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Potential Leap Year</span>
<a name="ln-10016"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">Year</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">MOD</span><span class="p">(</span><span class="n">Year</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10017"></a><span class="k">        </span><span class="n">YesNo</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10018"></a>      <span class="n">ENDIF</span>
<a name="ln-10019"></a>    <span class="n">ENDIF</span>
<a name="ln-10020"></a>  <span class="k">RETURN</span>
<a name="ln-10021"></a>
<a name="ln-10022"></a><span class="k">END FUNCTION </span><span class="n">IsLeapYear</span>
<a name="ln-10023"></a>
<a name="ln-10024"></a><span class="k">SUBROUTINE </span><span class="n">JGDate</span><span class="p">(</span><span class="n">jflag</span><span class="p">,</span><span class="n">jdate</span><span class="p">,</span><span class="n">gyyyy</span><span class="p">,</span><span class="n">gmm</span><span class="p">,</span><span class="n">gdd</span><span class="p">)</span>
<a name="ln-10025"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10026"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-10027"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-10028"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10029"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10030"></a>
<a name="ln-10031"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10032"></a>          <span class="c">! Subroutine JGDate is a gregorian date to actual julian date</span>
<a name="ln-10033"></a>          <span class="c">! converter.  the advantage of storing a julian date in the</span>
<a name="ln-10034"></a>          <span class="c">! jdate format rather than a 5 digit format is that any</span>
<a name="ln-10035"></a>          <span class="c">! number of days can be add or subtracted to jdate and</span>
<a name="ln-10036"></a>          <span class="c">! that result is a proper julian date.</span>
<a name="ln-10037"></a>
<a name="ln-10038"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10039"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-10040"></a>
<a name="ln-10041"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10042"></a>          <span class="c">! for discussion of this algorithm,</span>
<a name="ln-10043"></a>          <span class="c">! see cacm, vol 11, no 10, oct 1968, page 657</span>
<a name="ln-10044"></a>
<a name="ln-10045"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10046"></a>          <span class="c">! na</span>
<a name="ln-10047"></a>
<a name="ln-10048"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10049"></a>
<a name="ln-10050"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10051"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">jflag</span>   <span class="c">! indicates direction of conversion,</span>
<a name="ln-10052"></a>                     <span class="c">! 1 --&gt; gregorian (dd/mm/yyyy) to julian</span>
<a name="ln-10053"></a>                     <span class="c">! 2 --&gt; julian to gregorian.</span>
<a name="ln-10054"></a>
<a name="ln-10055"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">jdate</span>   <span class="c">! input/output julian date, typically a 7 or 8 digit integer</span>
<a name="ln-10056"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">gyyyy</span>   <span class="c">! input/output gregorian year, should be specified as 4 digits</span>
<a name="ln-10057"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">gmm</span>     <span class="c">! input/output gregorian month</span>
<a name="ln-10058"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">gdd</span>     <span class="c">! input/output gregorian day</span>
<a name="ln-10059"></a>
<a name="ln-10060"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10061"></a>          <span class="c">! na</span>
<a name="ln-10062"></a>
<a name="ln-10063"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10064"></a>          <span class="c">! na</span>
<a name="ln-10065"></a>
<a name="ln-10066"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10067"></a>          <span class="c">! na</span>
<a name="ln-10068"></a>
<a name="ln-10069"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10070"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tdate</span>   <span class="c">! integer*4 variable needed for double precision arithmetic</span>
<a name="ln-10071"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tyyyy</span>   <span class="c">! integer*4 variable needed for double precision arithmetic</span>
<a name="ln-10072"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tmm</span>     <span class="c">! integer*4 variable needed for double precision arithmetic</span>
<a name="ln-10073"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tdd</span>     <span class="c">! integer*4 variable needed for double precision arithmetic</span>
<a name="ln-10074"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">l</span>       <span class="c">! temporary variable used in conversion.</span>
<a name="ln-10075"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">n</span>       <span class="c">! temporary variable used in conversion.</span>
<a name="ln-10076"></a>
<a name="ln-10077"></a><span class="c">!</span>
<a name="ln-10078"></a><span class="c">!                                       gregorian to julian</span>
<a name="ln-10079"></a><span class="c">!</span>
<a name="ln-10080"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">jflag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10081"></a><span class="k">        </span><span class="n">tyyyy</span><span class="o">=</span><span class="n">gyyyy</span>
<a name="ln-10082"></a>        <span class="n">tmm</span><span class="o">=</span><span class="n">gmm</span>
<a name="ln-10083"></a>        <span class="n">tdd</span><span class="o">=</span><span class="n">gdd</span>
<a name="ln-10084"></a>        <span class="n">l</span><span class="o">=</span> <span class="p">(</span><span class="n">tmm</span> <span class="o">-</span> <span class="mi">14</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
<a name="ln-10085"></a>        <span class="n">jdate</span> <span class="o">=</span> <span class="n">tdd</span> <span class="o">-</span> <span class="mi">32075</span> <span class="o">+</span> <span class="mi">1461</span> <span class="o">*</span> <span class="p">(</span><span class="n">tyyyy</span> <span class="o">+</span> <span class="mi">4800</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">367</span> <span class="o">*</span> <span class="p">(</span><span class="n">tmm</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">l</span><span class="o">*</span><span class="mi">12</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">((</span><span class="n">tyyyy</span> <span class="o">+</span> <span class="mi">4900</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
<a name="ln-10086"></a>
<a name="ln-10087"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">jflag</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10088"></a><span class="c">!</span>
<a name="ln-10089"></a><span class="c">!                                       julian to gregorian</span>
<a name="ln-10090"></a><span class="c">!</span>
<a name="ln-10091"></a>        <span class="n">tdate</span> <span class="o">=</span> <span class="n">jdate</span>
<a name="ln-10092"></a>        <span class="n">l</span> <span class="o">=</span> <span class="n">tdate</span> <span class="o">+</span> <span class="mi">68569</span>
<a name="ln-10093"></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">l</span> <span class="o">/</span> <span class="mi">146097</span>
<a name="ln-10094"></a>        <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="p">(</span><span class="mi">146097</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
<a name="ln-10095"></a>        <span class="n">tyyyy</span> <span class="o">=</span> <span class="mi">4000</span><span class="o">*</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1461001</span>
<a name="ln-10096"></a>        <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">-</span> <span class="mi">1461</span><span class="o">*</span><span class="n">tyyyy</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">31</span>
<a name="ln-10097"></a>        <span class="n">tmm</span> <span class="o">=</span> <span class="mi">80</span><span class="o">*</span><span class="n">l</span> <span class="o">/</span> <span class="mi">2447</span>
<a name="ln-10098"></a>        <span class="n">tdd</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">2447</span><span class="o">*</span><span class="n">tmm</span> <span class="o">/</span> <span class="mi">80</span>
<a name="ln-10099"></a>        <span class="n">l</span> <span class="o">=</span> <span class="n">tmm</span><span class="o">/</span><span class="mi">11</span>
<a name="ln-10100"></a>        <span class="n">tmm</span> <span class="o">=</span> <span class="n">tmm</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">l</span>
<a name="ln-10101"></a>        <span class="n">tyyyy</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">49</span><span class="p">)</span> <span class="o">+</span> <span class="n">tyyyy</span> <span class="o">+</span> <span class="n">l</span>
<a name="ln-10102"></a><span class="c">!c</span>
<a name="ln-10103"></a>        <span class="n">gyyyy</span> <span class="o">=</span> <span class="n">tyyyy</span>
<a name="ln-10104"></a>        <span class="n">gdd</span>   <span class="o">=</span> <span class="n">tdd</span>
<a name="ln-10105"></a>        <span class="n">gmm</span>   <span class="o">=</span> <span class="n">tmm</span>
<a name="ln-10106"></a>
<a name="ln-10107"></a>      <span class="n">endif</span>
<a name="ln-10108"></a><span class="c">!c</span>
<a name="ln-10109"></a>      <span class="k">return</span>
<a name="ln-10110"></a>
<a name="ln-10111"></a><span class="k">END SUBROUTINE </span><span class="n">JGDate</span>
<a name="ln-10112"></a>
<a name="ln-10113"></a><span class="k">FUNCTION </span><span class="n">CalculateDayOfWeek</span><span class="p">(</span><span class="n">JulianDate</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">dayOfWeek</span><span class="p">)</span>
<a name="ln-10114"></a>
<a name="ln-10115"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10116"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-10117"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-10118"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10119"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10120"></a>
<a name="ln-10121"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10122"></a>          <span class="c">! Using Julian date (from jgdate calc), calculate the correct day of week.</span>
<a name="ln-10123"></a>
<a name="ln-10124"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10125"></a>          <span class="c">! Zeller&#39;s algorithm.</span>
<a name="ln-10126"></a>
<a name="ln-10127"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10128"></a>          <span class="c">! http://en.wikipedia.org/wiki/Zeller%27s_congruence</span>
<a name="ln-10129"></a>          <span class="c">! and other references around the web.</span>
<a name="ln-10130"></a>
<a name="ln-10131"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10132"></a>          <span class="c">! na</span>
<a name="ln-10133"></a>
<a name="ln-10134"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10135"></a>
<a name="ln-10136"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10137"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">JulianDate</span>   <span class="c">! from JGDate calculation</span>
<a name="ln-10138"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">dayOfWeek</span>    <span class="c">! EnergyPlus convention (1=Sunday, 2=Monday, etc)</span>
<a name="ln-10139"></a>
<a name="ln-10140"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10141"></a>          <span class="c">! na</span>
<a name="ln-10142"></a>
<a name="ln-10143"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10144"></a>          <span class="c">! na</span>
<a name="ln-10145"></a>
<a name="ln-10146"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10147"></a>          <span class="c">! na</span>
<a name="ln-10148"></a>
<a name="ln-10149"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10150"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">JulDate</span> <span class="c">! Julian date copy</span>
<a name="ln-10151"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Gyyyy</span>  <span class="c">! Gregorian yyyy</span>
<a name="ln-10152"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Gmm</span>    <span class="c">! Gregorian mm</span>
<a name="ln-10153"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Gdd</span>    <span class="c">! Gregorian dd</span>
<a name="ln-10154"></a>
<a name="ln-10155"></a>  <span class="n">JulDate</span> <span class="o">=</span> <span class="n">JulianDate</span>
<a name="ln-10156"></a>  <span class="k">CALL </span><span class="n">JGDate</span><span class="p">(</span><span class="n">JulianToGregorian</span><span class="p">,</span><span class="n">JulDate</span><span class="p">,</span><span class="n">Gyyyy</span><span class="p">,</span><span class="n">Gmm</span><span class="p">,</span><span class="n">Gdd</span><span class="p">)</span>
<a name="ln-10157"></a>
<a name="ln-10158"></a>  <span class="c">! Jan, Feb are 13, 14 months of previous year</span>
<a name="ln-10159"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Gmm</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10160"></a><span class="k">    </span><span class="n">Gmm</span><span class="o">=</span><span class="n">Gmm</span><span class="o">+</span><span class="mi">12</span>
<a name="ln-10161"></a>    <span class="n">Gyyyy</span><span class="o">=</span><span class="n">Gyyyy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-10162"></a>  <span class="n">ENDIF</span>
<a name="ln-10163"></a>
<a name="ln-10164"></a>  <span class="n">dayOfWeek</span> <span class="o">=</span> <span class="nb">MOD</span><span class="p">(</span><span class="n">Gdd</span> <span class="o">+</span> <span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="p">(</span><span class="n">Gmm</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gyyyy</span> <span class="o">+</span> <span class="p">(</span><span class="n">Gyyyy</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">Gyyyy</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Gyyyy</span><span class="o">/</span><span class="mi">400</span><span class="p">)</span> <span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<a name="ln-10165"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">dayOfWeek</span><span class="o">=</span><span class="mi">7</span>
<a name="ln-10166"></a>
<a name="ln-10167"></a>  <span class="k">RETURN</span>
<a name="ln-10168"></a>
<a name="ln-10169"></a><span class="k">END FUNCTION </span><span class="n">CalculateDayOfWeek</span>
<a name="ln-10170"></a>
<a name="ln-10171"></a><span class="c">!     NOTICE</span>
<a name="ln-10172"></a><span class="c">!</span>
<a name="ln-10173"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-10174"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-10175"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-10176"></a><span class="c">!</span>
<a name="ln-10177"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-10178"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-10179"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-10180"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-10181"></a><span class="c">!</span>
<a name="ln-10182"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-10183"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-10184"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-10185"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-10186"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-10187"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-10188"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-10189"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-10190"></a><span class="c">!     permit others to do so.</span>
<a name="ln-10191"></a><span class="c">!</span>
<a name="ln-10192"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-10193"></a><span class="c">!</span>
<a name="ln-10194"></a>
<a name="ln-10195"></a><span class="k">END MODULE </span><span class="n">WeatherManager</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
